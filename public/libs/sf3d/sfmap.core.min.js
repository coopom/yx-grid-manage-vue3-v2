!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=211)}([function(t,e,n){"use strict";function i(){}i.version="4.1.2.20230221",i.RelativePath="<<<WINDOW-LOCATION-ORIGIN-AND-CONTEXT>>>v4.0/",i.ProjectionType={wgs84:0,gcj02:1},i.LayerDataType={Terrain:0,Maptiles:1,Tileset:2,Gltf:3,Geojson:4},i.PropertyType={Position:0,Color:1,Float:2,Int:3,Boolean:4,Dictionary:5,Url:6,String:7,Trace:8,Array:9,Combine:10},i.PointCollectionType={Points:0,PolyLine:1,Polygon:2},e.a=i,window.Sf3d=i},function(t,e,n){"use strict";e.__esModule=!0;var i,r=n(137),o=(i=r)&&i.__esModule?i:{default:i};e.default=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return(0,o.default)(t)}},function(t,e,n){"use strict";e.__esModule=!0;var i,r=n(4),o=(i=r)&&i.__esModule?i:{default:i};e.default=o.default||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}},function(t,e,n){t.exports={default:n(124),__esModule:!0}},function(t,e,n){t.exports={default:n(120),__esModule:!0}},function(t,e,n){"use strict";e.__esModule=!0;var i=o(n(196)),r=o(n(6));function o(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e){if(Array.isArray(t))return t;if((0,i.default)(Object(t)))return function(t,e){var n=[],i=!0,o=!1,s=void 0;try{for(var a,l=(0,r.default)(t);!(i=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,s=t}finally{try{!i&&l.return&&l.return()}finally{if(o)throw s}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e,n){t.exports={default:n(150),__esModule:!0}},function(t,e,n){!function(t){"use strict";function e(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&I(i),r&&P(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function n(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r,s=n.bbox;if(!t)throw new Error("type is required");if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");switch(s&&I(s),t){case"Point":r=i(e).geometry;break;case"LineString":r=a(e).geometry;break;case"Polygon":r=o(e).geometry;break;case"MultiPoint":r=h(e).geometry;break;case"MultiLineString":r=c(e).geometry;break;case"MultiPolygon":r=p(e).geometry;break;default:throw new Error(t+" is invalid")}return s&&(r.bbox=s),r}function i(t,n,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!b(t[0])||!b(t[1]))throw new Error("coordinates must contain numbers");return e({type:"Point",coordinates:t},n,i)}function r(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return u(t.map((function(t){return i(t,e)})),n)}function o(t,n,i){if(!t)throw new Error("coordinates is required");for(var r=0;r<t.length;r++){var o=t[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++){if(0===r&&0===s&&!b(o[0][0])||!b(o[0][1]))throw new Error("coordinates must contain numbers");if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}}return e({type:"Polygon",coordinates:t},n,i)}function s(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return u(t.map((function(t){return o(t,e)})),n)}function a(t,n,i){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!b(t[0][1])||!b(t[0][1]))throw new Error("coordinates must contain numbers");return e({type:"LineString",coordinates:t},n,i)}function l(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return u(t.map((function(t){return a(t,e)})),n)}function u(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");n&&I(n),i&&P(i);var r={type:"FeatureCollection"};return i&&(r.id=i),n&&(r.bbox=n),r.features=t,r}function c(t,n,i){if(!t)throw new Error("coordinates is required");return e({type:"MultiLineString",coordinates:t},n,i)}function h(t,n,i){if(!t)throw new Error("coordinates is required");return e({type:"MultiPoint",coordinates:t},n,i)}function p(t,n,i){if(!t)throw new Error("coordinates is required");return e({type:"MultiPolygon",coordinates:t},n,i)}function f(t,n,i){if(!t)throw new Error("geometries is required");if(!Array.isArray(t))throw new Error("geometries must be an Array");return e({type:"GeometryCollection",geometries:t},n,i)}function d(t,e){if(null==t||isNaN(t))throw new Error("num is required");if(e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n}function g(t,e){if(null==t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=bo[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t*n}function y(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=bo[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t/n}function m(t,e){return v(y(t,e))}function _(t){if(null==t)throw new Error("bearing is required");var e=t%360;return e<0&&(e+=360),e}function v(t){if(null==t)throw new Error("radians is required");return t%(2*Math.PI)*180/Math.PI}function x(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function C(t,e,n){if(null==t)throw new Error("length is required");if(!(t>=0))throw new Error("length must be a positive number");return g(y(t,e),n||"kilometers")}function w(t,e,n){if(null==t)throw new Error("area is required");if(!(t>=0))throw new Error("area must be a positive number");var i=Io[e||"meters"];if(!i)throw new Error("invalid original units");var r=Io[n||"kilometers"];if(!r)throw new Error("invalid final units");return t/i*r}function b(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function E(t){return!!t&&t.constructor===Object}function I(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!b(t))throw new Error("bbox must only contain numbers")}))}function P(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function N(t,e,n){if(null!==t)for(var i,r,o,s,a,l,u,c,h=0,p=0,f=t.type,d="FeatureCollection"===f,g="Feature"===f,y=d?t.features.length:1,m=0;m<y;m++){a=(c=!!(u=d?t.features[m].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var _=0;_<a;_++){var v=0,x=0;if(null!==(s=c?u.geometries[_]:u)){l=s.coordinates;var C=s.type;switch(h=!n||"Polygon"!==C&&"MultiPolygon"!==C?0:1,C){case null:break;case"Point":e(l,p,m,v,x),p++,v++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++)e(l[i],p,m,v,x),p++,"MultiPoint"===C&&v++;"LineString"===C&&v++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(r=0;r<l[i].length-h;r++)e(l[i][r],p,m,v,x),p++;"MultiLineString"===C&&v++,"Polygon"===C&&x++}"Polygon"===C&&v++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for("MultiPolygon"===C&&(x=0),r=0;r<l[i].length;r++){for(o=0;o<l[i][r].length-h;o++)e(l[i][r][o],p,m,v,x),p++;x++}v++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)N(s.geometries[i],e,n);break;default:throw new Error("Unknown Geometry Type")}}}}}function S(t,e,n,i){var r=n;return N(t,(function(t,i,o,s,a){r=0===i&&void 0===n?t:e(r,t,i,o,s,a)}),i),r}function T(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)e(t.features[n].properties,n);break;case"Feature":e(t.properties,0)}}function L(t,e,n){var i=n;return T(t,(function(t,r){i=0===r&&void 0===n?t:e(i,t,r)})),i}function M(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)e(t.features[n],n)}function O(t,e,n){var i=n;return M(t,(function(t,r){i=0===r&&void 0===n?t:e(i,t,r)})),i}function R(t){var e=[];return N(t,(function(t){e.push(t)})),e}function A(t,e){var n,i,r,o,s,a,l,u,c,h,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(n=0;n<g;n++){for(a=f?t.features[n].geometry:d?t.geometry:t,u=f?t.features[n].properties:d?t.properties:{},c=f?t.features[n].bbox:d?t.bbox:void 0,h=f?t.features[n].id:d?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":e(o,p,u,c,h);break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)e(o.geometries[i],p,u,c,h);break;default:throw new Error("Unknown Geometry Type")}else e(null,p,u,c,h);p++}}function D(t,e,n){var i=n;return A(t,(function(t,r,o,s,a){i=0===r&&void 0===n?t:e(i,t,r,o,s,a)})),i}function F(t,n){A(t,(function(t,i,r,o,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return void n(e(t,r,{bbox:o,id:s}),i,0)}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}t.coordinates.forEach((function(t,o){n(e({type:a,coordinates:t},r),i,o)}))}))}function k(t,e,n){var i=n;return F(t,(function(t,r,o){i=0===r&&0===o&&void 0===n?t:e(i,t,r,o)})),i}function B(t,e){F(t,(function(t,n,i){var r=0;if(t.geometry){var o=t.geometry.type;"Point"!==o&&"MultiPoint"!==o&&S(t,(function(o,s,l,u,c,h){var p=a([o,s],t.properties);return e(p,n,i,h,r),r++,s}))}}))}function G(t,e,n){var i=n,r=!1;return B(t,(function(t,o,s,a,l){i=!1===r&&void 0===n?t:e(i,t,o,s,a,l),r=!0})),i}function j(t,e){if(!t)throw new Error("geojson is required");F(t,(function(t,n,i){if(null!==t.geometry){var r=t.geometry.type,o=t.geometry.coordinates;switch(r){case"LineString":e(t,n,i,0,0);break;case"Polygon":for(var s=0;s<o.length;s++)e(a(o[s],t.properties),n,i,s)}}}))}function z(t,e,n){var i=n;return j(t,(function(t,r,o,s){i=0===r&&void 0===n?t:e(i,t,r,o,s)})),i}function U(t){var e=[1/0,1/0,-1/0,-1/0];return N(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}function q(t){if(!t)throw new Error("obj is required");var e=V(t);if(e.length>1&&b(e[0])&&b(e[1]))return e;throw new Error("Coordinate is not a valid Point")}function V(t){if(!t)throw new Error("obj is required");var e;if(t.length?e=t:t.coordinates?e=t.coordinates:t.geometry&&t.geometry.coordinates&&(e=t.geometry.coordinates),e)return H(e),e;throw new Error("No valid coordinates")}function H(t){if(t.length>1&&b(t[0])&&b(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return H(t[0]);throw new Error("coordinates must only contain numbers")}function Y(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}function X(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}function W(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var i=0;i<t.features.length;i++){var r=t.features[i];if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}}function K(t){if(!t)throw new Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw new Error("geojson must be a valid Feature or Geometry Object")}function Z(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")}function J(t,e){if(!t)throw new Error((e||"geojson")+" is required");if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error((e||"geojson")+" is invalid")}function Q(t,e,n){n=n||{};for(var i=Object.keys(To),r=0;r<i.length;r++){var o=i[r],s=n[o];s=null!=s?s:To[o],Lo[o]=s}Lo.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+e);var a=function(t){var e=[],n=0;return t.rows,t.cols,t.cells.forEach((function(i,r){i.forEach((function(i,o){if(void 0!==i&&!function(t){return 5===t.cval||10===t.cval}(i)&&!tt(i)){var s=function(t,e,n){var i,r,o,s=t.length,a=[],l=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],u=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],c=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],h=(t[e][n],t[e][n]),p=h.cval,f=nt(h,o=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"][p]);a.push([n+f[0],e+f[1]]),f=nt(h,o=c[p]),a.push([n+f[0],e+f[1]]),et(h);for(var d=n+l[p],g=e+u[p],y=p;d>=0&&g>=0&&g<s&&(d!=n||g!=e)&&void 0!==(h=t[g][d]);){if(0===(p=h.cval)||15===p)return{path:a,info:"mergeable"};o=c[p],i=l[p],r=u[p],5!==p&&10!==p||(5===p?h.flipped?-1===u[y]?(o="left",i=-1,r=0):(o="right",i=1,r=0):-1===l[y]&&(o="bottom",i=0,r=-1):10===p&&(h.flipped?-1===l[y]?(o="top",i=0,r=1):(o="bottom",i=0,r=-1):1===u[y]&&(o="left",i=-1,r=0))),f=nt(h,o),a.push([d+f[0],g+f[1]]),et(h),d+=i,g+=r,y=p}return{path:a,info:"closed"}}(t.cells,r,o),a=!1;if("mergeable"===s.info)for(var l=s.path[s.path.length-1][0],u=s.path[s.path.length-1][1],c=n-1;c>=0;c--)if(Math.abs(e[c][0][0]-l)<=1e-7&&Math.abs(e[c][0][1]-u)<=1e-7){for(var h=s.path.length-2;h>=0;--h)e[c].unshift(s.path[h]);a=!0;break}a||(e[n++]=s.path)}}))})),e}(function(t,e){for(var n=t.length-1,i=t[0].length-1,r={rows:n,cols:i,cells:[]},o=0;o<n;++o){r.cells[o]=[];for(var s=0;s<i;++s){var a=0,l=t[o+1][s],u=t[o+1][s+1],c=t[o][s+1],h=t[o][s];if(!(isNaN(l)||isNaN(u)||isNaN(c)||isNaN(h))){a|=l>=e?8:0,a|=u>=e?4:0,a|=c>=e?2:0;var p,f,d,g,y=!1;if(5==(a|=h>=e?1:0)||10===a){var m=(l+u+c+h)/4;5===a&&m<e?(a=10,y=!0):10===a&&m<e&&(a=5,y=!0)}0!==a&&15!==a&&(p=f=d=g=.5,1===a?(d=1-$(e,l,h),f=1-$(e,c,h)):2===a?(f=$(e,h,c),g=1-$(e,u,c)):3===a?(d=1-$(e,l,h),g=1-$(e,u,c)):4===a?(p=$(e,l,u),g=$(e,c,u)):5===a?(p=$(e,l,u),g=$(e,c,u),f=1-$(e,c,h),d=1-$(e,l,h)):6===a?(f=$(e,h,c),p=$(e,l,u)):7===a?(d=1-$(e,l,h),p=$(e,l,u)):8===a?(d=$(e,h,l),p=1-$(e,u,l)):9===a?(f=1-$(e,c,h),p=1-$(e,u,l)):10===a?(p=1-$(e,u,l),g=1-$(e,u,c),f=$(e,h,c),d=$(e,h,l)):11===a?(p=1-$(e,u,l),g=1-$(e,u,c)):12===a?(d=$(e,h,l),g=$(e,c,u)):13===a?(f=1-$(e,c,h),g=$(e,c,u)):14===a?(d=$(e,h,l),f=$(e,h,c)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+a),r.cells[o][s]={cval:a,flipped:y,top:p,right:g,bottom:f,left:d})}}}return r}(t,e));return"function"==typeof Lo.successCallback&&Lo.successCallback(a),a}function $(t,e,n){return(t-e)/(n-e)}function tt(t){return 0===t.cval||15===t.cval}function et(t){tt(t)||5===t.cval||10===t.cval||(t.cval=15)}function nt(t,e){return"top"===e?[t.top,1]:"bottom"===e?[t.bottom,0]:"right"===e?[1,t.right]:"left"===e?[0,t.left]:void 0}function it(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function rt(t,e){if(!(this instanceof rt))return new rt(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function ot(t,e){st(t,0,t.children.length,e,t)}function st(t,e,n,i,r){r||(r=dt(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],at(r,t.leaf?i(o):o);return r}function at(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function lt(t,e){return t.minX-e.minX}function ut(t,e){return t.minY-e.minY}function ct(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function ht(t){return t.maxX-t.minX+(t.maxY-t.minY)}function pt(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function ft(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function dt(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function gt(t,e,n,i,r){for(var o,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=i||(o=e+Math.ceil((n-e)/i/2)*i,Mo(t,o,e,n,r),s.push(e,o,o,n))}function yt(t,e){return t(e={exports:{}},e.exports),e.exports}function mt(t,e){if(!(this instanceof mt))return new mt(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||function(t,e){return t<e?-1:t>e?1:0},this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function _t(t,e,n){e=Math.max(0,void 0===e?2:e),n=n||0;for(var i,r=function(t){for(var e=t[0],n=t[0],i=t[0],r=t[0],o=0;o<t.length;o++){var s=t[o];s[0]<e[0]&&(e=s),s[0]>i[0]&&(i=s),s[1]<n[1]&&(n=s),s[1]>r[1]&&(r=s)}var a=[e,n,i,r],l=a.slice();for(o=0;o<t.length;o++)Vo(t[o],a)||l.push(t[o]);var u=jo(l),c=[];for(o=0;o<u.length;o++)c.push(l[u[o]]);return c}(t),o=Oo(16,["[0]","[1]","[0]","[1]"]).load(t),s=[],a=0;a<r.length;a++){var l=r[a];o.remove(l),i=bt(l,i),s.push(i)}var u=Oo(16);for(a=0;a<s.length;a++)u.insert(wt(s[a]));for(var c=e*e,h=n*n;s.length;){var p=s.shift(),f=p.p,d=p.next.p,g=Et(f,d);if(!(g<h)){var y=g/c;(l=function(t,e,n,i,r,o,s){for(var a=new Uo(null,vt),l=t.data;l;){for(var u=0;u<l.children.length;u++){var c=l.children[u],h=l.leaf?It(c,n,i):function(t,e,n){if(xt(t,n)||xt(e,n))return 0;var i=Pt(t[0],t[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(0===i)return 0;var r=Pt(t[0],t[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(0===r)return 0;var o=Pt(t[0],t[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===o)return 0;var s=Pt(t[0],t[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===s?0:Math.min(i,r,o,s)}(n,i,c);h>o||a.push({node:c,dist:h})}for(;a.length&&!a.peek().node.children;){var p=a.pop(),f=p.node,d=It(f,e,n),g=It(f,i,r);if(p.dist<d&&p.dist<g&&Ct(n,f,s)&&Ct(i,f,s))return f}(l=a.pop())&&(l=l.node)}return null}(o,p.prev.p,f,d,p.next.next.p,y,u))&&Math.min(Et(l,f),Et(l,d))<=y&&(s.push(p),s.push(bt(l,p)),o.remove(l),u.remove(p),u.insert(wt(p)),u.insert(wt(p.next)))}}p=i;var m=[];do{m.push(p.p),p=p.next}while(p!==i);return m.push(p.p),m}function vt(t,e){return t.dist-e.dist}function xt(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function Ct(t,e,n){for(var i=Math.min(t[0],e[0]),r=Math.min(t[1],e[1]),o=Math.max(t[0],e[0]),s=Math.max(t[1],e[1]),a=n.search({minX:i,minY:r,maxX:o,maxY:s}),l=0;l<a.length;l++)if(function(t,e,n,i){return t!==i&&e!==n&&Ho(t,e,n)>0!=Ho(t,e,i)>0&&Ho(n,i,t)>0!=Ho(n,i,e)>0}(a[l].p,a[l].next.p,t,e))return!1;return!0}function wt(t){var e=t.p,n=t.next.p;return t.minX=Math.min(e[0],n[0]),t.minY=Math.min(e[1],n[1]),t.maxX=Math.max(e[0],n[0]),t.maxY=Math.max(e[1],n[1]),t}function bt(t,e){var n={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function Et(t,e){var n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}function It(t,e,n){var i=e[0],r=e[1],o=n[0]-i,s=n[1]-r;if(0!==o||0!==s){var a=((t[0]-i)*o+(t[1]-r)*s)/(o*o+s*s);a>1?(i=n[0],r=n[1]):a>0&&(i+=o*a,r+=s*a)}return(o=t[0]-i)*o+(s=t[1]-r)*s}function Pt(t,e,n,i,r,o,s,a){var l,u,c,h,p=n-t,f=i-e,d=s-r,g=a-o,y=t-r,m=e-o,_=p*p+f*f,v=p*d+f*g,x=d*d+g*g,C=p*y+f*m,w=d*y+g*m,b=_*x-v*v,E=b,I=b;0===b?(u=0,E=1,h=w,I=x):(h=_*w-v*C,(u=v*w-x*C)<0?(u=0,h=w,I=x):u>E&&(u=E,h=w+v,I=x)),h<0?(h=0,-C<0?u=0:-C>_?u=E:(u=-C,E=_)):h>I&&(h=I,-C+v<0?u=0:-C+v>_?u=E:(u=-C+v,E=_));var P=(1-(c=0===h?0:h/I))*r+c*s-((1-(l=0===u?0:u/E))*t+l*n),N=(1-c)*o+c*a-((1-l)*e+l*i);return P*P+N*N}function Nt(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.concavity||1/0,i=[];if(N(t,(function(t){i.push([t[0],t[1]])})),!i.length)return null;var r=Yo(i,n);return r.length>3?o([r]):null}function St(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var i=n.ignoreBoundary;if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=q(t),o=V(e),s=e.geometry?e.geometry.type:e.type,a=e.bbox;if(a&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,a))return!1;"Polygon"===s&&(o=[o]);for(var l=0,u=!1;l<o.length&&!u;l++)if(Tt(r,o[l][0],i)){for(var c=!1,h=1;h<o[l].length&&!c;)Tt(r,o[l][h],!i)&&(c=!0),h++;c||(u=!0)}return u}function Tt(t,e,n){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var s=e[r][0],a=e[r][1],l=e[o][0],u=e[o][1];if(t[1]*(s-l)+a*(l-t[0])+u*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!n;a>t[1]!=u>t[1]&&t[0]<(l-s)*(t[1]-a)/(u-a)+s&&(i=!i)}return i}function Lt(t,e){var n=[];return A(e,(function(e){M(t,(function(t){St(t,e)&&n.push(t)}))})),u(n)}function Mt(t,e){if("FeatureCollection"!==t.type)throw new Error("points must be a FeatureCollection");var n=!1;return u(function(t){if(t.length<3)return[];t.sort(Rt);for(var e,n,i,r,o,s,a=t.length-1,l=t[a].x,u=t[0].x,c=t[a].y,h=c;a--;)t[a].y<c&&(c=t[a].y),t[a].y>h&&(h=t[a].y);var p,f=u-l,d=h-c,g=f>d?f:d,y=.5*(u+l),m=.5*(h+c),_=[new Ot({x:y-20*g,y:m-g,__sentinel:!0},{x:y,y:m+20*g,__sentinel:!0},{x:y+20*g,y:m-g,__sentinel:!0})],v=[],x=[];for(a=t.length;a--;){for(x.length=0,p=_.length;p--;)(f=t[a].x-_[p].x)>0&&f*f>_[p].r?(v.push(_[p]),_.splice(p,1)):f*f+(d=t[a].y-_[p].y)*d>_[p].r||(x.push(_[p].a,_[p].b,_[p].b,_[p].c,_[p].c,_[p].a),_.splice(p,1));for(At(x),p=x.length;p;)n=x[--p],e=x[--p],i=t[a],r=n.x-e.x,o=n.y-e.y,s=2*(r*(i.y-n.y)-o*(i.x-n.x)),Math.abs(s)>1e-12&&_.push(new Ot(e,n,i))}for(Array.prototype.push.apply(v,_),a=v.length;a--;)(v[a].a.__sentinel||v[a].b.__sentinel||v[a].c.__sentinel)&&v.splice(a,1);return v}(t.features.map((function(t){var i={x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};return e?i.z=t.properties[e]:3===t.geometry.coordinates.length&&(n=!0,i.z=t.geometry.coordinates[2]),i}))).map((function(t){var e=[t.a.x,t.a.y],i=[t.b.x,t.b.y],r=[t.c.x,t.c.y],s={};return n?(e.push(t.a.z),i.push(t.b.z),r.push(t.c.z)):s={a:t.a.z,b:t.b.z,c:t.c.z},o([[e,i,r,e]],s)})))}function Ot(t,e,n){this.a=t,this.b=e,this.c=n;var i,r,o=e.x-t.x,s=e.y-t.y,a=n.x-t.x,l=n.y-t.y,u=o*(t.x+e.x)+s*(t.y+e.y),c=a*(t.x+n.x)+l*(t.y+n.y),h=2*(o*(n.y-e.y)-s*(n.x-e.x));this.x=(l*u-s*c)/h,this.y=(o*c-a*u)/h,i=this.x-t.x,r=this.y-t.y,this.r=i*i+r*r}function Rt(t,e){return e.x-t.x}function At(t){var e,n,i,r,o,s=t.length;t:for(;s;)for(n=t[--s],e=t[--s],i=s;i;)if(o=t[--i],r=t[--i],e===r&&n===o||e===o&&n===r){t.splice(s,2),t.splice(i,2),s-=2;continue t}}function Dt(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.units,r=q(t),o=q(e),s=x(o[1]-r[1]),a=x(o[0]-r[0]),l=x(r[1]),u=x(o[1]),c=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(l)*Math.cos(u);return g(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),i)}function Ft(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return kt(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}})),e.features=t.features.map((function(t){return kt(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Bt(t);default:throw new Error("unknown GeoJSON type")}}function kt(t){var e={type:"Feature"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}})),e.properties=function t(e){var n={};return e?(Object.keys(e).forEach((function(i){var r=e[i];"object"==typeof r?null===r?n[i]=null:r.length?n[i]=r.map((function(t){return t})):n[i]=t(r):n[i]=r})),n):n}(t.properties),e.geometry=Bt(t.geometry),e}function Bt(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return Bt(t)})),e):(e.coordinates=function t(e){return"object"!=typeof e[0]?e.slice():e.map((function(e){return t(e)}))}(t.coordinates),e)}function Gt(t,e){function n(t,e){e.length&&e.pop();for(var n=l[t<0?~t:t],i=0,r=n.length;i<r;++i)e.push(a(n[i],i));t<0&&Zo(e,r)}function i(t){return a(t)}function r(t){for(var e=[],i=0,r=t.length;i<r;++i)n(t[i],e);return e.length<2&&e.push(e[0]),e}function o(t){for(var e=r(t);e.length<4;)e.push(e[0]);return e}function s(t){return t.map(o)}var a=Ko(t.transform),l=t.arcs;return function t(e){var n,o=e.type;switch(o){case"GeometryCollection":return{type:o,geometries:e.geometries.map(t)};case"Point":n=i(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(i);break;case"LineString":n=r(e.arcs);break;case"MultiLineString":n=e.arcs.map(r);break;case"Polygon":n=s(e.arcs);break;case"MultiPolygon":n=e.arcs.map(s);break;default:return null}return{type:o,coordinates:n}}(e)}function jt(t,e){function n(t){t.forEach((function(e){e.forEach((function(e){(r[e=e<0?~e:e]||(r[e]=[])).push(t)}))})),o.push(t)}function i(e){return function(t){for(var e,n=-1,i=t.length,r=t[i-1],o=0;++n<i;)e=r,r=t[n],o+=e[0]*r[1]-e[1]*r[0];return Math.abs(o)}(Gt(t,{type:"Polygon",arcs:[e]}).coordinates[0])}var r={},o=[],s=[];return e.forEach((function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":n(e.arcs);break;case"MultiPolygon":e.arcs.forEach(n)}})),o.forEach((function(t){if(!t._){var e=[],n=[t];for(t._=1,s.push(e);t=n.pop();)e.push(t),t.forEach((function(t){t.forEach((function(t){r[t<0?~t:t].forEach((function(t){t._||(t._=1,n.push(t))}))}))}))}})),o.forEach((function(t){delete t._})),{type:"MultiPolygon",arcs:s.map((function(e){var n,o=[];if(e.forEach((function(t){t.forEach((function(t){t.forEach((function(t){r[t<0?~t:t].length<2&&o.push(t)}))}))})),(n=(o=Jo(t,o)).length)>1)for(var s,a,l=1,u=i(o[0]);l<n;++l)(s=i(o[l]))>u&&(a=o[0],o[0]=o[l],o[l]=a,u=s);return o}))}}function zt(t,e,n){for(var i,r=e+(n---e>>1);e<r;++e,--n)i=t[e],t[e]=t[n],t[n]=i}function Ut(t){return null==t?{type:null}:("FeatureCollection"===t.type?function(t){var e={type:"GeometryCollection",geometries:t.features.map(qt)};return null!=t.bbox&&(e.bbox=t.bbox),e}:"Feature"===t.type?qt:Vt)(t)}function qt(t){var e,n=Vt(t.geometry);for(e in null!=t.id&&(n.id=t.id),null!=t.bbox&&(n.bbox=t.bbox),t.properties){n.properties=t.properties;break}return n}function Vt(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(Vt)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}function Ht(t){var e,n=t[0],i=t[1];return i<n&&(e=n,n=i,i=e),n+31*i}function Yt(t,e){var n,i=t[0],r=t[1],o=e[0],s=e[1];return r<i&&(n=i,i=r,r=n),s<o&&(n=o,o=s,s=n),i===o&&r===s}function Xt(t){return t[0].toString()+","+t[1].toString()}function Wt(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==J(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=Ft(t));var i=function(t){var e={};F(t,(function(t){e[t.geometry.type]=!0}));var n=Object.keys(e);return 1===n.length?n[0]:null}(t);if(!i)throw new Error("geojson must be homogenous");switch(i){case"LineString":return function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==J(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=Ft(t));var i=[],r=z(t,(function(t,e){return function(t,e){var n,i=t.geometry.coordinates,r=e.geometry.coordinates,o=Xt(i[0]),s=Xt(i[i.length-1]),l=Xt(r[0]),u=Xt(r[r.length-1]);if(o===u)n=r.concat(i.slice(1));else if(l===s)n=i.concat(r.slice(1));else if(o===l)n=i.slice(1).reverse().concat(r);else{if(s!==u)return null;n=i.concat(r.reverse().slice(1))}return a(n)}(t,e)||(i.push(t),e)}));return r&&i.push(r),i.length?1===i.length?i[0]:c(i.map((function(t){return t.coordinates}))):null}(t,e);case"Polygon":return function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==J(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=Ft(t));var i=[];F(t,(function(t){i.push(t.geometry)}));var r=ss({geoms:f(i).geometry});return Qo(r,r.objects.geoms.geometries)}(t,e);default:throw new Error(i+" is not supported")}}function Kt(t,n){var i="object"==typeof n?n.mutate:n;if(!t)throw new Error("geojson is required");var r=J(t),o=[];switch(r){case"LineString":o=Zt(t);break;case"MultiLineString":case"Polygon":V(t).forEach((function(t){o.push(Zt(t))}));break;case"MultiPolygon":V(t).forEach((function(t){var e=[];t.forEach((function(t){e.push(Zt(t))})),o.push(e)}));break;case"Point":return t;case"MultiPoint":var s={};V(t).forEach((function(t){var e=t.join("-");s.hasOwnProperty(e)||(o.push(t),s[e]=!0)}));break;default:throw new Error(r+" geometry not supported")}return t.coordinates?!0===i?(t.coordinates=o,t):{type:r,coordinates:o}:!0===i?(t.geometry.coordinates=o,t):e({type:r,coordinates:o},t.properties,t.bbox,t.id)}function Zt(t){var e=V(t);if(2===e.length&&!function(t,e){return t[0]===e[0]&&t[1]===e[1]}(e[0],e[1]))return e;var n,i,r,o=[],s=e.length-1;o.push(e[0]);for(var a=1;a<s;a++)n=e[a-1],i=e[a],function(t,e,n){var i=n[0],r=n[1],o=t[0],s=t[1],a=e[0],l=e[1],u=a-o,c=l-s;return(i-o)*c-(r-s)*u==0&&(Math.abs(u)>=Math.abs(c)?u>0?o<=i&&i<=a:a<=i&&i<=o:c>0?s<=r&&r<=l:l<=r&&r<=s)}(n,r=e[a+1],i)||o.push(i);return o.push(r),o}function Jt(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}function Qt(t,e,n){var i=e.x,r=e.y,o=n.x-i,s=n.y-r;if(0!==o||0!==s){var a=((t.x-i)*o+(t.y-r)*s)/(o*o+s*s);a>1?(i=n.x,r=n.y):a>0&&(i+=o*a,r+=s*a)}return(o=t.x-i)*o+(s=t.y-r)*s}function $t(t,e,n){if(t.length<=2)return t;var i=void 0!==e?e*e:1;return function(t,e){var n=t.length-1,i=[t[0]];return function t(e,n,i,r,o){for(var s,a=r,l=n+1;l<i;l++){var u=Qt(e[l],e[n],e[i]);u>a&&(s=l,a=u)}a>r&&(s-n>1&&t(e,n,s,r,o),o.push(e[s]),i-s>1&&t(e,s,i,r,o))}(t,0,n,e,i),i.push(t[n]),i}(t=n?t:function(t,e){for(var n,i=t[0],r=[i],o=1,s=t.length;o<s;o++)Jt(n=t[o],i)>e&&(r.push(n),i=n);return i!==n&&r.push(n),r}(t,i),i)}function te(t,e,n){return $t(t.map((function(t){return{x:t[0],y:t[1],z:t[2]}})),e,n).map((function(t){return t.z?[t.x,t.y,t.z]:[t.x,t.y]}))}function ee(t,e,n){return t.map((function(t){var i=t.map((function(t){return{x:t[0],y:t[1]}}));if(i.length<4)throw new Error("invalid polygon");for(var r=$t(i,e,n).map((function(t){return[t.x,t.y]}));!function(t){return!(t.length<3||3===t.length&&t[2][0]===t[0][0]&&t[2][1]===t[0][1])}(r);)r=$t(i,e-=.01*e,n).map((function(t){return[t.x,t.y]}));return r[r.length-1][0]===r[0][0]&&r[r.length-1][1]===r[0][1]||r.push(r[0]),r}))}function ne(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.resolution||1e4,i=e.sharpness||.85;if(!t)throw new Error("line is required");if(!b(n))throw new Error("resolution must be an number");if(!b(i))throw new Error("sharpness must be an number");for(var r=[],o=new as({points:K(t).coordinates.map((function(t){return{x:t[0],y:t[1]}})),duration:n,sharpness:i}),s=0;s<o.duration;s+=10){var l=o.pos(s);Math.floor(s/100)%2==0&&r.push([l.x,l.y])}return a(r,t.properties)}function ie(t){I(t);var e=Number(t[0]),n=Number(t[1]),i=Number(t[2]),r=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var s=[e,n];return o([[s,[i,n],[i,r],[e,r],s]])}function re(t){return ie(U(t))}function oe(t){var e=t[0],n=t[1],i=t[2],r=t[3];if(Dt(t.slice(0,2),[i,n])>=Dt(t.slice(0,2),[e,r])){var o=(n+r)/2;return[e,o-(i-e)/2,i,o+(i-e)/2]}var s=(e+i)/2;return[s-(r-n)/2,n,s+(r-n)/2,r]}function se(t,e,n,r){if(!E(r=r||{}))throw new Error("options is invalid");var o=r.units,s=r.properties,a=q(t),l=x(a[0]),u=x(a[1]),c=x(n),h=y(e,o),p=Math.asin(Math.sin(u)*Math.cos(h)+Math.cos(u)*Math.sin(h)*Math.cos(c));return i([v(l+Math.atan2(Math.sin(c)*Math.sin(h)*Math.cos(u),Math.cos(h)-Math.sin(u)*Math.sin(p))),v(p)],s)}function ae(t,e,n){var i=(n=n||{}).steps||64,r=n.properties;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof i)throw new Error("steps must be a number");i=i||64,r=r||t.properties||{};for(var s=[],a=0;a<i;a++)s.push(se(t,e,-360*a/i,n).geometry.coordinates);return s.push(s[0]),o([s],r)}function le(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");if(!0===n.final)return function(t,e){var n=le(e,t);return(n+180)%360}(t,e);var i=q(t),r=q(e),o=x(i[0]),s=x(r[0]),a=x(i[1]),l=x(r[1]),u=Math.sin(s-o)*Math.cos(l),c=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(s-o);return v(Math.atan2(u,c))}function ue(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.properties;if(!t)throw new Error("geojson is required");var r=U(t);return i([(r[0]+r[2])/2,(r[1]+r[3])/2],n)}function ce(t,e){var n=0,r=0,o=0;return N(t,(function(t){n+=t[0],r+=t[1],o++}),!0),i([n/o,r/o],e)}function he(t){var e=[];return"FeatureCollection"===t.type?M(t,(function(t){N(t,(function(n){e.push(i(n,t.properties))}))})):N(t,(function(n){e.push(i(n,t.properties))})),u(e)}function pe(t,e,n){n=n||2;var i,r,o,s,a,l,u,c=e&&e.length,h=c?e[0]*n:t.length,p=fe(t,0,h,n,!0),f=[];if(!p)return f;if(c&&(p=function(t,e,n,i){var r,o,s,a=[];for(r=0,o=e.length;r<o;r++)(s=fe(t,e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),a.push(function(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}(s));for(a.sort(ge),r=0;r<a.length;r++)!function(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s){if(s=a,a===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===s)return n.prev;var l,u=n,c=n.x,h=n.y,p=1/0;for(i=n.next;i!==u;)r>=i.x&&i.x>=c&&r!==i.x&&me(o<h?r:s,o,c,h,o<h?s:r,o,i.x,i.y)&&((l=Math.abs(o-i.y)/(r-i.x))<p||l===p&&i.x>n.x)&&Ce(i,t)&&(n=i,p=l),i=i.next;return n}(t,e)){var n=we(e,t);de(n,n.next)}}(a[r],n),n=de(n,n.next);return n}(t,e,p,n)),t.length>80*n){i=o=t[0],r=s=t[1];for(var d=n;d<h;d+=n)(a=t[d])<i&&(i=a),(l=t[d+1])<r&&(r=l),a>o&&(o=a),l>s&&(s=l);u=0!==(u=Math.max(o-i,s-r))?1/u:0}return function t(e,n,i,r,o,s,a){if(e){!a&&s&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=ye(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,l,u=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ);e++);for(l=u;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(s>1)}(r)}(e,r,o,s);for(var l,u,c=e;e.prev!==e.next;)if(l=e.prev,u=e.next,s?function(t,e,n,i){var r=t.prev,o=t,s=t.next;if(_e(r,o,s)>=0)return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,l=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,u=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,c=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,h=ye(a,l,e,n,i),p=ye(u,c,e,n,i),f=t.nextZ;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&me(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&_e(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=t.prevZ;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&me(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&_e(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}(e,r,o,s):function(t){var e=t.prev,n=t,i=t.next;if(_e(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(me(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&_e(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}(e))n.push(l.i/i),n.push(e.i/i),n.push(u.i/i),Ee(e),e=u.next,c=u.next;else if((e=u)===c){a?1===a?t(e=function(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!ve(r,o)&&xe(r,i,i.next,o)&&Ce(r,o)&&Ce(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),Ee(i),Ee(i.next),i=t=o),i=i.next}while(i!==t);return i}(e,n,i),n,i,r,o,s,2):2===a&&function(e,n,i,r,o,s){var a=e;do{for(var l=a.next.next;l!==a.prev;){if(a.i!==l.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&xe(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&Ce(t,e)&&Ce(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)}(a,l)){var u=we(a,l);return a=de(a,a.next),u=de(u,u.next),t(a,n,i,r,o,s),void t(u,n,i,r,o,s)}l=l.next}a=a.next}while(a!==e)}(e,n,i,r,o,s):t(de(e),n,i,r,o,s,1);break}}}(p,f,n,i,r,u),f}function fe(t,e,n,i,r){var o,s;if(r===Pe(t,e,n,i)>0)for(o=e;o<n;o+=i)s=be(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=be(o,t[o],t[o+1],s);return s&&ve(s,s.next)&&(Ee(s),s=s.next),s}function de(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!ve(i,i.next)&&0!==_e(i.prev,i,i.next))i=i.next;else{if(Ee(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function ge(t,e){return t.x-e.x}function ye(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function me(t,e,n,i,r,o,s,a){return(r-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(i-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(r-s)*(i-a)>=0}function _e(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ve(t,e){return t.x===e.x&&t.y===e.y}function xe(t,e,n,i){return!!(ve(t,e)&&ve(n,i)||ve(t,i)&&ve(n,e))||_e(t,e,n)>0!=_e(t,e,i)>0&&_e(n,i,t)>0!=_e(n,i,e)>0}function Ce(t,e){return _e(t.prev,t,t.next)<0?_e(t,e,t.next)>=0&&_e(t,t.prev,e)>=0:_e(t,e,t.prev)<0||_e(t,t.next,e)<0}function we(t,e){var n=new Ie(t.i,t.x,t.y),i=new Ie(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function be(t,e,n,i){var r=new Ie(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ee(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ie(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Pe(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}function Ne(t){var e=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}(t),n=ls(e.vertices,e.holes,2),i=[],r=[];n.forEach((function(t,i){var o=n[i];r.push([e.vertices[2*o],e.vertices[2*o+1]])}));for(var s=0;s<r.length;s+=3){var a=r.slice(s,s+3);a.push(r[s]),i.push(o([a]))}return i}function Se(t,e){if(!t)throw new Error("targetPoint is required");if(!e)throw new Error("points is required");var n,i=1/0;return M(e,(function(e,r){var o=Dt(t,e);o<i&&((n=Ft(e)).properties.featureIndex=r,n.properties.distanceToPoint=o,i=o)})),n}function Te(t,e,n,i,r){!function t(e,n,i,r,o){for(;r>i;){if(r-i>600){var s=r-i+1,a=n-i+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(a-s/2<0?-1:1);t(e,n,Math.max(i,Math.floor(n-a*u/s+c)),Math.min(r,Math.floor(n+(s-a)*u/s+c)),o)}var h=e[n],p=i,f=r;for(Le(e,i,n),o(e[r],h)>0&&Le(e,i,r);p<f;){for(Le(e,p,f),p++,f--;o(e[p],h)<0;)p++;for(;o(e[f],h)>0;)f--}0===o(e[i],h)?Le(e,i,f):Le(e,++f,r),f<=n&&(i=f+1),n<=f&&(r=f-1)}}(t,e,n||0,i||t.length-1,r||function(t,e){return t<e?-1:t>e?1:0})}function Le(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function Me(t,e){if(!(this instanceof Me))return new Me(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function Oe(t,e){Re(t,0,t.children.length,e,t)}function Re(t,e,n,i,r){r||(r=ze(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],Ae(r,t.leaf?i(o):o);return r}function Ae(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function De(t,e){return t.minX-e.minX}function Fe(t,e){return t.minY-e.minY}function ke(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Be(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Ge(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function je(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function ze(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ue(t,e,n,i,r){for(var o,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=i||(Te(t,o=e+Math.ceil((n-e)/i/2)*i,e,n,r),s.push(e,o,o,n))}function qe(t){var e=Me(t);return e.insert=function(t){if(Array.isArray(t)){var e=t;(t=Ve(e)).bbox=e}else t.bbox=t.bbox?t.bbox:He(t);return Me.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){var n=Ve(t);n.bbox=t,e.push(n)})):M(t,(function(t){t.bbox=t.bbox?t.bbox:He(t),e.push(t)})),Me.prototype.load.call(this,e)},e.remove=function(t){if(Array.isArray(t)){var e=t;(t=Ve(e)).bbox=e}return Me.prototype.remove.call(this,t)},e.clear=function(){return Me.prototype.clear.call(this)},e.search=function(t){return{type:"FeatureCollection",features:Me.prototype.search.call(this,this.toBBox(t))}},e.collides=function(t){return Me.prototype.collides.call(this,this.toBBox(t))},e.all=function(){return{type:"FeatureCollection",features:Me.prototype.all.call(this)}},e.toJSON=function(){return Me.prototype.toJSON.call(this)},e.fromJSON=function(t){return Me.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;return{minX:(e=t.bbox?t.bbox:Array.isArray(t)&&4===t.length?t:He(t))[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}function Ve(t){var e=[t[0],t[1]],n=[t[0],t[3]],i=[t[2],t[3]];return{type:"Feature",bbox:t,properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],i,n,e]]}}}function He(t){var e=[1/0,1/0,-1/0,-1/0];return N(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}function Ye(t){if(!t)throw new Error("geojson is required");var e=[];return F(t,(function(t){!function(t,e){var n=[],i=t.geometry;switch(i.type){case"Polygon":n=V(i);break;case"LineString":n=[V(i)]}n.forEach((function(n){(function(t,e){var n=[];return t.reduce((function(t,i){var r=a([t,i],e);return r.bbox=function(t,e){var n=t[0],i=t[1],r=e[0],o=e[1];return[n<r?n:r,i<o?i:o,n>r?n:r,i>o?i:o]}(t,i),n.push(r),i})),n})(n,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}(t,e)})),u(e)}function Xe(t,n){var i={},r=[];if("LineString"===t.type&&(t=e(t)),"LineString"===n.type&&(n=e(n)),"Feature"===t.type&&"Feature"===n.type&&"LineString"===t.geometry.type&&"LineString"===n.geometry.type&&2===t.geometry.coordinates.length&&2===n.geometry.coordinates.length){var o=We(t,n);return o&&r.push(o),u(r)}var s=qe();return s.load(Ye(n)),M(Ye(t),(function(t){M(s.search(t),(function(e){var n=We(t,e);if(n){var o=V(n).join(",");i[o]||(i[o]=!0,r.push(n))}}))})),u(r)}function We(t,e){var n=V(t),r=V(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==r.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=n[0][0],s=n[0][1],a=n[1][0],l=n[1][1],u=r[0][0],c=r[0][1],h=r[1][0],p=r[1][1],f=(p-c)*(a-o)-(h-u)*(l-s);if(0===f)return null;var d=((h-u)*(s-c)-(p-c)*(o-u))/f,g=((a-o)*(s-c)-(l-s)*(o-u))/f;return d>=0&&d<=1&&g>=0&&g<=1?i([o+d*(a-o),s+d*(l-s)]):null}function Ke(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=t.geometry?t.geometry.type:t.type;if("LineString"!==r&&"MultiLineString"!==r)throw new Error("lines must be LineString or MultiLineString");var o=i([1/0,1/0],{dist:1/0}),s=0;return F(t,(function(t){for(var r=V(t),l=0;l<r.length-1;l++){var u=i(r[l]);u.properties.dist=Dt(e,u,n);var c=i(r[l+1]);c.properties.dist=Dt(e,c,n);var h=Dt(u,c,n),p=Math.max(u.properties.dist,c.properties.dist),f=le(u,c),d=se(e,p,f+90,n),g=se(e,p,f-90,n),y=Xe(a([d.geometry.coordinates,g.geometry.coordinates]),a([u.geometry.coordinates,c.geometry.coordinates])),m=null;y.features.length>0&&((m=y.features[0]).properties.dist=Dt(e,m,n),m.properties.location=s+Dt(u,m,n)),u.properties.dist<o.properties.dist&&((o=u).properties.index=l,o.properties.location=s),c.properties.dist<o.properties.dist&&((o=c).properties.index=l+1,o.properties.location=s+h),m&&m.properties.dist<o.properties.dist&&((o=m).properties.index=l),s+=h}})),o}function Ze(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i,r=n.final;if(!t)throw new Error("start point is required");if(!e)throw new Error("end point is required");return(i=r?Je(q(e),q(t)):Je(q(t),q(e)))>180?-(360-i):i}function Je(t,e){var n=x(t[1]),i=x(e[1]),r=x(e[0]-t[0]);r>Math.PI&&(r-=2*Math.PI),r<-Math.PI&&(r+=2*Math.PI);var o=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(n/2+Math.PI/4));return(v(Math.atan2(r,o))+360)%360}function Qe(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.units;if(!t)throw new Error("from point is required");if(!e)throw new Error("to point is required");var r=q(t),o=q(e);return o[0]+=o[0]-r[0]>180?-360:r[0]-o[0]>180?360:0,C(function(t,e,n){var i=n=void 0===n?wo:Number(n),r=t[1]*Math.PI/180,o=e[1]*Math.PI/180,s=o-r,a=Math.abs(e[0]-t[0])*Math.PI/180;a>Math.PI&&(a-=2*Math.PI);var l=Math.log(Math.tan(o/2+Math.PI/4)/Math.tan(r/2+Math.PI/4)),u=Math.abs(l)>1e-11?s/l:Math.cos(r);return Math.sqrt(s*s+u*u*a*a)*i}(r,o),"meters",i)}function $e(t,e){return en(t,"mercator",e)}function tn(t,e){return en(t,"wgs84",e)}function en(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.mutate;if(!t)throw new Error("geojson is required");return Array.isArray(t)&&b(t[0])?t="mercator"===e?nn(t):rn(t):(!0!==i&&(t=Ft(t)),N(t,(function(t){var n="mercator"===e?nn(t):rn(t);t[0]=n[0],t[1]=n[1]}))),t}function nn(t){var e=Math.PI/180,n=20037508.342789244,i=[6378137*(Math.abs(t[0])<=180?t[0]:t[0]-360*function(t){return t<0?-1:t>0?1:0}(t[0]))*e,6378137*Math.log(Math.tan(.25*Math.PI+.5*t[1]*e))];return i[0]>n&&(i[0]=n),i[0]<-n&&(i[0]=-n),i[1]>n&&(i[1]=n),i[1]<-n&&(i[1]=-n),i}function rn(t){var e=180/Math.PI;return[t[0]*e/6378137,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/6378137)))*e]}function on(t,n,r){if(!E(r=r||{}))throw new Error("options is invalid");if(!t)throw new Error("pt is required");if(Array.isArray(t)?t=i(t):"Point"===t.type?t=e(t):X(t,"Point","point"),!n)throw new Error("line is required");Array.isArray(n)?n=a(n):"LineString"===n.type?n=e(n):X(n,"LineString","line");var o=1/0,s=t.geometry.coordinates;return B(n,(function(t){var e=t.geometry.coordinates[0],n=t.geometry.coordinates[1],a=function(t,e,n,r){var o=r.mercator,s=!0!==o?Dt(e,t,r):sn(e,t,r),a=_(!0!==o?le(e,t):Ze(e,t)),l=_(!0!==o?le(e,n):Ze(e,n)),u=Math.abs(a-l);if(u>90)return s;var c=(l+180)%360,h=_(!0!==o?le(n,t):Ze(n,t)),p=Math.abs(h-c);return p>180&&(p=Math.abs(p-360)),p>90?!0!==o?Dt(t,n,r):sn(t,n,r):!0!==o?s*Math.sin(x(u)):function(t,e,n,r){var o=0;(Math.abs(t[0])>=180||Math.abs(e[0])>=180||Math.abs(n[0])>=180)&&(o=t[0]>0||e[0]>0||n[0]>0?-180:180);var s=i(n),a=tn(function(t,e,n){var i=t[0],r=t[1],o=e[0]-i,s=e[1]-r,a=((n[0]-i)*o+(n[1]-r)*s)/(o*o+s*s);return[i+a*o,r+a*s]}($e([t[0]+o,t[1]]),$e([e[0]+o,e[1]]),$e([n[0]+o,n[1]])));return 0!==o&&(a[0]-=o),Qe(s,a,r)}(e,n,t,r)}(s,e,n,r);o>a&&(o=a)})),o}function sn(t,e,n){var i=n.units,r=0;Math.abs(t[0])>=180&&(r=t[0]>0?-180:180),Math.abs(e[0])>=180&&(r=e[0]>0?-180:180);var o=$e([t[0]+r,t[1]]),s=$e([e[0]+r,e[1]]),a=function(t){return t*t},l=a(o[0]-s[0])+a(o[1]-s[1]);return C(Math.sqrt(l),"meters",i)}function an(t){for(var n=function(t){return"FeatureCollection"!==t.type?"Feature"!==t.type?u([e(t)]):u([t]):t}(t),r=ue(n),o=!1,s=0;!o&&s<n.features.length;){var a,l=n.features[s].geometry,c=!1;if("Point"===l.type)r.geometry.coordinates[0]===l.coordinates[0]&&r.geometry.coordinates[1]===l.coordinates[1]&&(o=!0);else if("MultiPoint"===l.type){var h=!1;for(a=0;!h&&a<l.coordinates.length;)r.geometry.coordinates[0]===l.coordinates[a][0]&&r.geometry.coordinates[1]===l.coordinates[a][1]&&(o=!0,h=!0),a++}else if("LineString"===l.type)for(a=0;!c&&a<l.coordinates.length-1;)ln(r.geometry.coordinates[0],r.geometry.coordinates[1],l.coordinates[a][0],l.coordinates[a][1],l.coordinates[a+1][0],l.coordinates[a+1][1])&&(c=!0,o=!0),a++;else if("MultiLineString"===l.type)for(var p=0;p<l.coordinates.length;){c=!1,a=0;for(var f=l.coordinates[p];!c&&a<f.length-1;)ln(r.geometry.coordinates[0],r.geometry.coordinates[1],f[a][0],f[a][1],f[a+1][0],f[a+1][1])&&(c=!0,o=!0),a++;p++}else"Polygon"!==l.type&&"MultiPolygon"!==l.type||St(r,l)&&(o=!0);s++}if(o)return r;var d=u([]);for(s=0;s<n.features.length;s++)d.features=d.features.concat(he(n.features[s]).features);return i(Se(r,d).geometry.coordinates)}function ln(t,e,n,i,r,o){return Math.sqrt((r-n)*(r-n)+(o-i)*(o-i))===Math.sqrt((t-n)*(t-n)+(e-i)*(e-i))+Math.sqrt((r-t)*(r-t)+(o-e)*(o-e))}function un(t){return D(t,(function(t,e){return t+function t(e){var n,i=0;switch(e.type){case"Polygon":return cn(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=cn(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}}(e)}),0)}function cn(t){var e=0;if(t&&t.length>0){e+=Math.abs(hn(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(hn(t[n]))}return e}function hn(t){var e,n,i,r,o,s,a=0,l=t.length;if(l>2){for(s=0;s<l;s++)s===l-2?(i=l-2,r=l-1,o=0):s===l-1?(i=l-1,r=0,o=1):(i=s,r=s+1,o=s+2),e=t[i],n=t[r],a+=(pn(t[o][0])-pn(e[0]))*Math.sin(pn(n[1]));a=a*hs*hs/2}return a}function pn(t){return t*Math.PI/180}function fn(t,e){if(!E(e=e||{}))throw new Error("options is invalid");if(!t)throw new Error("geojson is required");return G(t,(function(t,n){var i=n.geometry.coordinates;return t+Dt(i[0],i[1],e)}),0)}function dn(t,e,n,i){if(!E(i=i||{}))throw new Error("options is invalid");var r,o=[];if("Feature"===t.type)r=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");r=t.coordinates}for(var s,l,u,c=0,h=0;h<r.length&&!(e>=c&&h===r.length-1);h++){if(c>e&&0===o.length){if(!(s=e-c))return o.push(r[h]),a(o);l=le(r[h],r[h-1])-180,u=se(r[h],s,l,i),o.push(u.geometry.coordinates)}if(c>=n)return(s=n-c)?(l=le(r[h],r[h-1])-180,u=se(r[h],s,l,i),o.push(u.geometry.coordinates),a(o)):(o.push(r[h]),a(o));if(c>=e&&o.push(r[h]),h===r.length-1)return a(o);c+=Dt(r[h],r[h+1],i)}return a(r[r.length-1])}function gn(t,e,n){var i=(n=n||{}).ignoreEndVertices;if(!E(n))throw new Error("invalid options");if(!t)throw new Error("pt is required");if(!e)throw new Error("line is required");for(var r=q(t),o=V(e),s=0;s<o.length-1;s++){var a=!1;if(i&&(0===s&&(a="start"),s===o.length-2&&(a="end"),0===s&&s+1===o.length-1&&(a="both")),function(t,e,n,i){var r=n[0],o=n[1],s=t[0],a=t[1],l=e[0],u=e[1],c=l-s,h=u-a;return(n[0]-s)*h-(n[1]-a)*c==0&&(i?"start"===i?Math.abs(c)>=Math.abs(h)?c>0?s<r&&r<=l:l<=r&&r<s:h>0?a<o&&o<=u:u<=o&&o<a:"end"===i?Math.abs(c)>=Math.abs(h)?c>0?s<=r&&r<l:l<r&&r<=s:h>0?a<=o&&o<u:u<o&&o<=a:"both"===i?Math.abs(c)>=Math.abs(h)?c>0?s<r&&r<l:l<r&&r<s:h>0?a<o&&o<u:u<o&&o<a:void 0:Math.abs(c)>=Math.abs(h)?c>0?s<=r&&r<=l:l<=r&&r<=s:h>0?a<=o&&o<=u:u<=o&&o<=a)}(o[s],o[s+1],r,a))return!0}return!1}function yn(t,e){var n=J(t),i=J(e),r=K(t),o=K(e);switch(n){case"Point":switch(i){case"MultiPoint":return function(t,e){var n,i=!1;for(n=0;n<e.coordinates.length;n++)if(_n(e.coordinates[n],t.coordinates)){i=!0;break}return i}(r,o);case"LineString":return gn(r,o,{ignoreEndVertices:!0});case"Polygon":return St(r,o,{ignoreBoundary:!0});default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"MultiPoint":return function(t,e){for(var n=0;n<t.coordinates.length;n++){for(var i=!1,r=0;r<e.coordinates.length;r++)_n(t.coordinates[n],e.coordinates[r])&&(i=!0);if(!i)return!1}return!0}(r,o);case"LineString":return function(t,e){for(var n=!1,i=0;i<t.coordinates.length;i++){if(!gn(t.coordinates[i],e))return!1;n||(n=gn(t.coordinates[i],e,{ignoreEndVertices:!0}))}return n}(r,o);case"Polygon":return function(t,e){for(var n=!0,i=0;i<t.coordinates.length;i++){var r=St(t.coordinates[1],e);if(!r){n=!1;break}r=St(t.coordinates[1],e,{ignoreBoundary:!0})}return n&&r}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"LineString":return function(t,e){for(var n=0;n<t.coordinates.length;n++)if(!gn(t.coordinates[n],e))return!1;return!0}(r,o);case"Polygon":return function(t,e){if(!mn(U(e),U(t)))return!1;for(var n=!1,i=0;i<t.coordinates.length-1;i++){if(!St(t.coordinates[i],e))return!1;n||(n=St(t.coordinates[i],e,{ignoreBoundary:!0})),n||(n=St(function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}(t.coordinates[i],t.coordinates[i+1]),e,{ignoreBoundary:!0}))}return n}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Polygon":return function(t,e){var n=U(t);if(!mn(U(e),n))return!1;for(var i=0;i<t.coordinates[0].length;i++)if(!St(t.coordinates[0][i],e))return!1;return!0}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function mn(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function _n(t,e){return t[0]===e[0]&&t[1]===e[1]}function vn(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.mask,o=n.properties,s=[];if(null==e)throw new Error("cellSide is required");if(!b(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(r&&-1===["Polygon","MultiPolygon"].indexOf(J(r)))throw new Error("options.mask must be a (Multi)Polygon");for(var a=t[0],l=t[1],c=t[2],h=t[3],p=e/Dt([a,l],[c,l],n)*(c-a),f=e/Dt([a,l],[a,h],n)*(h-l),d=c-a,g=h-l,y=Math.floor(d/p),m=(g-Math.floor(g/f)*f)/2,_=a+(d-y*p)/2;_<=c;){for(var v=l+m;v<=h;){var x=i([_,v],o);r?yn(x,r)&&s.push(x):s.push(x),v+=f}_+=p}return u(s)}function xn(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.precision,i=e.coordinates,r=e.mutate;if(n=null==n||isNaN(n)?6:n,i=null==i||isNaN(i)?3:i,!t)throw new Error("<geojson> is required");if("number"!=typeof n)throw new Error("<precision> must be a number");if("number"!=typeof i)throw new Error("<coordinates> must be a number");!1!==r&&void 0!==r||(t=JSON.parse(JSON.stringify(t)));var o=Math.pow(10,n);return N(t,(function(t){!function(t,e,n){t.length>n&&t.splice(n,t.length);for(var i=0;i<t.length;i++)t[i]=Math.round(t[i]*e)/e}(t,o,i)})),t}function Cn(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!Cn(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1;return!0}function wn(t,e){if(void 0===e&&(e=!0),3!=t.length)throw new Error("This function requires an array of three points [x,y]");return(t[1][0]-t[0][0])*(t[2][1]-t[0][1])-(t[1][1]-t[0][1])*(t[2][0]-t[0][0])>=0==e}function bn(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!bn(t[n],e[n]))return!1}else if(t[n]!=e[n])return!1;return!0}function En(t,e){var n=[],i=qe();return F(e,(function(e){if(n.forEach((function(t,e){t.id=e})),n.length){var r=i.search(e);if(r.features.length){var o=Pn(e,r);n=n.filter((function(t){return t.id!==o.id})),i.remove(o),M(In(o,e),(function(t){n.push(t),i.insert(t)}))}}else(n=In(t,e).features).forEach((function(t){t.bbox||(t.bbox=oe(U(t)))})),i.load(u(n))})),u(n)}function In(t,e){var n=[],i=V(t)[0],r=V(t)[t.geometry.coordinates.length-1];if(Nn(i,q(e))||Nn(r,q(e)))return u([t]);var o=qe(),s=Ye(t);o.load(s);var l=o.search(e);if(!l.features.length)return u([t]);var c=Pn(e,l),h=O(s,(function(t,i,r){var o=V(i)[1],s=q(e);return r===c.id?(t.push(s),n.push(a(t)),Nn(s,o)?[s]:[s,o]):(t.push(o),t)}),[i]);return h.length>1&&n.push(a(h)),u(n)}function Pn(t,e){if(!e.features.length)throw new Error("lines must contain features");if(1===e.features.length)return e.features[0];var n,i=1/0;return M(e,(function(e){var r=Ke(e,t).properties.dist;r<i&&(n=e,i=r)})),n}function Nn(t,e){return t[0]===e[0]&&t[1]===e[1]}function Sn(t,e,n,i,r){if(!E(r=r||{}))throw new Error("options is invalid");var o=r.steps,s=r.units;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if(null==n)throw new Error("bearing1 is required");if(null==i)throw new Error("bearing2 is required");if("object"!=typeof r)throw new Error("options must be an object");o=o||64;var l=Tn(n),u=Tn(i),c=t.properties;if(l===u)return a(ae(t,e,r).geometry.coordinates[0],c);for(var h=l,p=l<u?u:u+360,f=h,d=[],g=0;f<p;)d.push(se(t,e,f,s).geometry.coordinates),f=h+360*++g/o;return f>p&&d.push(se(t,e,p,s).geometry.coordinates),a(d,c)}function Tn(t){var e=t%360;return e<0&&(e+=360),e}function Ln(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.properties,i=J(t),r=V(t);if(n=n||t.properties||{},!r.length)throw new Error("polygon must contain coordinates");switch(i){case"Polygon":return Mn(r,n);case"MultiPolygon":var o=[];return r.forEach((function(t){o.push(Mn(t,n))})),u(o);default:throw new Error("geom "+i+" not supported")}}function Mn(t,e){return t.length>1?c(t,e):a(t[0],e)}function On(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.properties,i=e.autoComplete,r=e.orderCoords;if(!t)throw new Error("lines is required");switch(i=void 0===i||i,r=void 0===r||r,J(t)){case"FeatureCollection":case"GeometryCollection":var o=[];return(t.features?t.features:t.geometries).forEach((function(t){o.push(V(Rn(t,{},i,r)))})),p(o,n)}return Rn(t,n,i,r)}function Rn(t,e,n,i){e=e||t.properties||{};var r=V(t),s=J(t);if(!r.length)throw new Error("line must contain coordinates");switch(s){case"LineString":return n&&(r=An(r)),o([r],e);case"MultiLineString":var l=[],u=0;return r.forEach((function(t){if(n&&(t=An(t)),i){var e=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.abs(e-i)*Math.abs(n-r)}(U(a(t)));e>u?(l.unshift(t),u=e):l.push(t)}else l.push(t)})),o(l,e);default:throw new Error("geometry type "+s+" is not supported")}}function An(t){var e=t[0],n=e[0],i=e[1],r=t[t.length-1],o=r[0],s=r[1];return n===o&&i===s||t.push(e),t}function Dn(t,e,n){var i,r,o,s,a,l=t.length,u=kn(t[0],e),c=[];for(n||(n=[]),i=1;i<l;i++){for(r=t[i-1],s=a=kn(o=t[i],e);;){if(!(u|s)){c.push(r),s!==a?(c.push(o),i<l-1&&(n.push(c),c=[])):i===l-1&&c.push(o);break}if(u&s)break;u?u=kn(r=Fn(r,o,u,e),e):s=kn(o=Fn(r,o,s,e),e)}u=a}return c.length&&n.push(c),n}function Fn(t,e,n,i){return 8&n?[t[0]+(e[0]-t[0])*(i[3]-t[1])/(e[1]-t[1]),i[3]]:4&n?[t[0]+(e[0]-t[0])*(i[1]-t[1])/(e[1]-t[1]),i[1]]:2&n?[i[2],t[1]+(e[1]-t[1])*(i[2]-t[0])/(e[0]-t[0])]:1&n?[i[0],t[1]+(e[1]-t[1])*(i[0]-t[0])/(e[0]-t[0])]:null}function kn(t,e){var n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function Bn(t,e){for(var n=[],i=0;i<t.length;i++){var r=Cs.polygon(t[i],e);r.length>0&&(r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]||r.push(r[0]),r.length>=4&&n.push(r))}return n}function Gn(t){return"[object Arguments]"===Object.prototype.toString.call(t)}function jn(t,e,n){return n||(n={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?(n.strict,t===e):function(t,e,n){var i,r;if(zn(t)||zn(e))return!1;if(t.prototype!==e.prototype)return!1;if(Gn(t))return!!Gn(e)&&jn(t=ws.call(t),e=ws.call(e),n);if(Un(t)){if(!Un(e))return!1;if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}try{var o=Object.keys(t),s=Object.keys(e)}catch(t){return!1}if(o.length!==s.length)return!1;for(o.sort(),s.sort(),i=o.length-1;i>=0;i--)if(o[i]!==s[i])return!1;for(i=o.length-1;i>=0;i--)if(!jn(t[r=o[i]],e[r],n))return!1;return typeof t==typeof e}(t,e,n))}function zn(t){return null==t}function Un(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0])}function qn(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i,r=n.tolerance||0,o=[],s=qe();return s.load(Ye(t)),B(e,(function(t){var e=!1;M(s.search(t),(function(n){if(!1===e){var o=V(t).sort(),s=V(n).sort();jn(o,s)||(0===r?gn(o[0],n)&&gn(o[1],n):Ke(n,o[0]).properties.dist<=r&&Ke(n,o[1]).properties.dist<=r)?(e=!0,i=i?Vn(i,t):t):(0===r?gn(s[0],t)&&gn(s[1],t):Ke(t,s[0]).properties.dist<=r&&Ke(t,s[1]).properties.dist<=r)&&(i=i?Vn(i,n):n)}})),!1===e&&i&&(o.push(i),i=void 0)})),i&&o.push(i),u(o)}function Vn(t,e){var n=V(e),i=V(t),r=i[0],o=i[i.length-1],s=t.geometry.coordinates;return jn(n[0],r)?s.unshift(n[1]):jn(n[0],o)?s.push(n[1]):jn(n[1],r)?s.unshift(n[0]):jn(n[1],o)&&s.push(n[0]),t}function Hn(t){var e=t%360;return e<0&&(e+=360),e}function Yn(t,e,n,r){if(!E(r=r||{}))throw new Error("options is invalid");var o=r.units,s=r.properties;if(!t)throw new Error("origin is required");if(null==e)throw new Error("distance is required");if(null==n)throw new Error("bearing is required");if(!(e>=0))throw new Error("distance must be greater than 0");var a=C(e,o,"meters"),l=q(t),u=function(t,e,n,i){var r=e/(i=void 0===i?wo:Number(i)),o=t[0]*Math.PI/180,s=x(t[1]),a=x(n),l=r*Math.cos(a),u=s+l;Math.abs(u)>Math.PI/2&&(u=u>0?Math.PI-u:-Math.PI-u);var c=Math.log(Math.tan(u/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),h=Math.abs(c)>1e-11?l/c:Math.cos(s);return[(180*(o+r*Math.sin(a)/h)/Math.PI+540)%360-180,180*u/Math.PI]}(l,a,n);return u[0]+=u[0]-l[0]>180?-360:l[0]-u[0]>180?360:0,i(u,s)}function Xn(t,e,n,i,r,o){for(var s=0;s<t.length;s++){var a=t[s],l=t[s+1];s===t.length-1&&(l=t[0]),i=Wn(a,l,e),n<=0&&i>0?function(t,e,n){return Wn(t,e,n)<0}(e,a,r)||(r=a):n>0&&i<=0&&(function(t,e,n){return Wn(t,e,n)>0}(e,a,o)||(o=a)),n=i}return[r,o]}function Wn(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function Kn(t){if(!t)throw new Error("line is required");var e=t.geometry?t.geometry.type:t.type;if(!Array.isArray(t)&&"LineString"!==e)throw new Error("geometry must be a LineString");for(var n,i,r=V(t),o=0,s=1;s<r.length;)n=i||r[0],o+=((i=r[s])[0]-n[0])*(i[1]+n[1]),s++;return o>0}function Zn(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return A(t,(function(t){Zn(t,e)})),t;case"LineString":return Jn(V(t),e),t;case"Polygon":return Qn(V(t),e),t;case"MultiLineString":return V(t).forEach((function(t){Jn(t,e)})),t;case"MultiPolygon":return V(t).forEach((function(t){Qn(t,e)})),t;case"Point":case"MultiPoint":return t}}function Jn(t,e){Kn(t)===e&&t.reverse()}function Qn(t,e){Kn(t[0])!==e&&t[0].reverse();for(var n=1;n<t.length;n++)Kn(t[n])===e&&t[n].reverse()}function $n(t,e,n,i){i=i||{};for(var r=Object.keys(bs),o=0;o<r.length;o++){var s=r[o],a=i[s];a=null!=a?a:bs[s],Es[s]=a}Es.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+e+":"+(e+n)+"]");var l,u=function(t,e,n){for(var i=t.length-1,r=t[0].length-1,o={rows:i,cols:r,cells:[]},s=e+Math.abs(n),a=0;a<i;++a){o.cells[a]=[];for(var l=0;l<r;++l){var u=0,c=t[a+1][l],h=t[a+1][l+1],p=t[a][l+1],f=t[a][l];if(!(isNaN(c)||isNaN(h)||isNaN(p)||isNaN(f))){u|=c<e?0:c>s?128:64,u|=h<e?0:h>s?32:16,u|=p<e?0:p>s?8:4;var d=+(u|=f<e?0:f>s?2:1),g=0;if(17===u||18===u||33===u||34===u||38===u||68===u||72===u||98===u||102===u||132===u||136===u||137===u||152===u||153===u){var y=(c+h+p+f)/4;g=y>s?2:y<e?0:1,34===u?1===g?u=35:0===g&&(u=136):136===u?1===g?(u=35,g=4):0===g&&(u=34):17===u?1===g?(u=155,g=4):0===g&&(u=153):68===u?1===g?(u=103,g=4):0===g&&(u=102):153===u?1===g&&(u=155):102===u?1===g&&(u=103):152===u?g<2&&(u=156,g=1):137===u?g<2&&(u=139,g=1):98===u?g<2&&(u=99,g=1):38===u?g<2&&(u=39,g=1):18===u?g>0?(u=156,g=4):u=152:33===u?g>0?(u=139,g=4):u=137:72===u?g>0?(u=99,g=4):u=98:132===u&&(g>0?(u=39,g=4):u=38)}if(0!=u&&170!=u){var m,_,v,x,C,w,b,E;m=_=v=x=C=w=b=E=.5;var I=[];1===u?(v=1-ti(e,p,f),E=1-ti(e,c,f),I.push(ca[u])):169===u?(v=ti(s,f,p),E=ti(s,f,c),I.push(ca[u])):4===u?(w=1-ti(e,h,p),x=ti(e,f,p),I.push(la[u])):166===u?(w=ti(s,p,h),x=1-ti(s,p,f),I.push(la[u])):16===u?(C=ti(e,p,h),_=ti(e,c,h),I.push(aa[u])):154===u?(C=1-ti(s,h,p),_=1-ti(s,h,c),I.push(aa[u])):64===u?(b=ti(e,f,c),m=1-ti(e,h,c),I.push(pa[u])):106===u?(b=1-ti(s,c,f),m=ti(s,c,h),I.push(pa[u])):168===u?(x=ti(s,f,p),v=ti(e,f,p),E=ti(e,f,c),b=ti(s,f,c),I.push(ua[u]),I.push(ca[u])):2===u?(x=1-ti(e,p,f),v=1-ti(s,p,f),E=1-ti(s,c,f),b=1-ti(e,c,f),I.push(ua[u]),I.push(ca[u])):162===u?(C=ti(s,p,h),w=ti(e,p,h),x=1-ti(e,p,f),v=1-ti(s,p,f),I.push(ua[u]),I.push(ca[u])):8===u?(C=1-ti(e,h,p),w=1-ti(s,h,p),x=ti(s,f,p),v=ti(e,f,p),I.push(aa[u]),I.push(la[u])):138===u?(C=1-ti(e,h,p),w=1-ti(s,h,p),m=1-ti(s,h,c),_=1-ti(e,h,c),I.push(aa[u]),I.push(la[u])):32===u?(C=ti(s,p,h),w=ti(e,p,h),m=ti(e,c,h),_=ti(s,c,h),I.push(aa[u]),I.push(la[u])):42===u?(E=1-ti(s,c,f),b=1-ti(e,c,f),m=ti(e,c,h),_=ti(s,c,h),I.push(ha[u]),I.push(pa[u])):128===u&&(E=ti(e,f,c),b=ti(s,f,c),m=1-ti(s,h,c),_=1-ti(e,h,c),I.push(ha[u]),I.push(pa[u])),5===u?(w=1-ti(e,h,p),E=1-ti(e,c,f),I.push(la[u])):165===u?(w=ti(s,p,h),E=ti(s,f,c),I.push(la[u])):20===u?(x=ti(e,f,p),_=ti(e,c,h),I.push(ua[u])):150===u?(x=1-ti(s,p,f),_=1-ti(s,h,c),I.push(ua[u])):80===u?(C=ti(e,p,h),b=ti(e,f,c),I.push(aa[u])):90===u?(C=1-ti(s,h,p),b=1-ti(s,c,f),I.push(aa[u])):65===u?(v=1-ti(e,p,f),m=1-ti(e,h,c),I.push(ca[u])):105===u?(v=ti(s,f,p),m=ti(s,c,h),I.push(ca[u])):160===u?(C=ti(s,p,h),w=ti(e,p,h),E=ti(e,f,c),b=ti(s,f,c),I.push(aa[u]),I.push(la[u])):10===u?(C=1-ti(e,h,p),w=1-ti(s,h,p),E=1-ti(s,c,f),b=1-ti(e,c,f),I.push(aa[u]),I.push(la[u])):130===u?(x=1-ti(e,p,f),v=1-ti(s,p,f),m=1-ti(s,h,c),_=1-ti(e,h,c),I.push(ua[u]),I.push(ca[u])):40===u?(x=ti(s,f,p),v=ti(e,f,p),m=ti(e,c,h),_=ti(s,c,h),I.push(ua[u]),I.push(ca[u])):101===u?(w=ti(s,p,h),m=ti(s,c,h),I.push(la[u])):69===u?(w=1-ti(e,h,p),m=1-ti(e,h,c),I.push(la[u])):149===u?(E=ti(s,f,c),_=1-ti(s,h,c),I.push(ha[u])):21===u?(E=1-ti(e,c,f),_=ti(e,c,h),I.push(ha[u])):86===u?(x=1-ti(s,p,f),b=1-ti(s,c,f),I.push(ua[u])):84===u?(x=ti(e,f,p),b=ti(e,f,c),I.push(ua[u])):89===u?(C=1-ti(s,h,p),v=ti(s,f,p),I.push(ca[u])):81===u?(C=ti(e,p,h),v=1-ti(e,p,f),I.push(ca[u])):96===u?(C=ti(s,p,h),w=ti(e,p,h),b=ti(e,f,c),m=ti(s,c,h),I.push(aa[u]),I.push(la[u])):74===u?(C=1-ti(e,h,p),w=1-ti(s,h,p),b=1-ti(s,c,f),m=1-ti(e,h,c),I.push(aa[u]),I.push(la[u])):24===u?(C=1-ti(s,h,p),x=ti(s,f,p),v=ti(e,f,p),_=ti(e,c,h),I.push(aa[u]),I.push(ca[u])):146===u?(C=ti(e,p,h),x=1-ti(e,p,f),v=1-ti(s,p,f),_=1-ti(s,h,c),I.push(aa[u]),I.push(ca[u])):6===u?(w=1-ti(e,h,p),x=1-ti(s,p,f),E=1-ti(s,c,f),b=1-ti(e,c,f),I.push(la[u]),I.push(ua[u])):164===u?(w=ti(s,p,h),x=ti(e,f,p),E=ti(e,f,c),b=ti(s,f,c),I.push(la[u]),I.push(ua[u])):129===u?(v=1-ti(e,p,f),E=ti(s,f,c),m=1-ti(s,h,c),_=1-ti(e,h,c),I.push(ca[u]),I.push(ha[u])):41===u?(v=ti(s,f,p),E=1-ti(e,c,f),m=ti(e,c,h),_=ti(s,c,h),I.push(ca[u]),I.push(ha[u])):66===u?(x=1-ti(e,p,f),v=1-ti(s,p,f),b=1-ti(s,c,f),m=1-ti(e,h,c),I.push(ua[u]),I.push(ca[u])):104===u?(x=ti(s,f,p),v=ti(e,f,p),b=ti(e,f,c),m=ti(s,c,h),I.push(ca[u]),I.push(fa[u])):144===u?(C=ti(e,p,h),E=ti(e,f,c),b=ti(s,f,c),_=1-ti(s,h,c),I.push(aa[u]),I.push(pa[u])):26===u?(C=1-ti(s,h,p),E=1-ti(s,c,f),b=1-ti(e,c,f),_=ti(e,c,h),I.push(aa[u]),I.push(pa[u])):36===u?(w=ti(s,p,h),x=ti(e,f,p),m=ti(e,c,h),_=ti(s,c,h),I.push(la[u]),I.push(ua[u])):134===u?(w=1-ti(e,h,p),x=1-ti(s,p,f),m=1-ti(s,h,c),_=1-ti(e,h,c),I.push(la[u]),I.push(ua[u])):9===u?(C=1-ti(e,h,p),w=1-ti(s,h,p),v=ti(s,f,p),E=1-ti(e,c,f),I.push(aa[u]),I.push(la[u])):161===u?(C=ti(s,p,h),w=ti(e,p,h),v=1-ti(e,p,f),E=ti(s,f,c),I.push(aa[u]),I.push(la[u])):37===u?(w=ti(s,p,h),E=1-ti(e,c,f),m=ti(e,c,h),_=ti(s,c,h),I.push(la[u]),I.push(ha[u])):133===u?(w=1-ti(e,h,p),E=ti(s,f,c),m=1-ti(s,h,c),_=1-ti(e,h,c),I.push(la[u]),I.push(ha[u])):148===u?(x=ti(e,f,p),E=ti(e,f,c),b=ti(s,f,c),_=1-ti(s,h,c),I.push(ua[u]),I.push(pa[u])):22===u?(x=1-ti(s,p,f),E=1-ti(s,c,f),b=1-ti(e,c,f),_=ti(e,c,h),I.push(ua[u]),I.push(pa[u])):82===u?(C=ti(e,p,h),x=1-ti(e,p,f),v=1-ti(s,p,f),b=1-ti(s,c,f),I.push(aa[u]),I.push(ca[u])):88===u?(C=1-ti(s,h,p),x=ti(s,f,p),v=ti(e,f,p),b=ti(e,f,c),I.push(aa[u]),I.push(ca[u])):73===u?(C=1-ti(e,h,p),w=1-ti(s,h,p),v=ti(s,f,p),m=1-ti(e,h,c),I.push(aa[u]),I.push(la[u])):97===u?(C=ti(s,p,h),w=ti(e,p,h),v=1-ti(e,p,f),m=ti(s,c,h),I.push(aa[u]),I.push(la[u])):145===u?(C=ti(e,p,h),v=1-ti(e,p,f),E=ti(s,f,c),_=1-ti(s,h,c),I.push(aa[u]),I.push(ha[u])):25===u?(C=1-ti(s,h,p),v=ti(s,f,p),E=1-ti(e,c,f),_=ti(e,c,h),I.push(aa[u]),I.push(ha[u])):70===u?(w=1-ti(e,h,p),x=1-ti(s,p,f),b=1-ti(s,c,f),m=1-ti(e,h,c),I.push(la[u]),I.push(ua[u])):100===u?(w=ti(s,p,h),x=ti(e,f,p),b=ti(e,f,c),m=ti(s,c,h),I.push(la[u]),I.push(ua[u])):34===u?(0===g?(C=1-ti(e,h,p),w=1-ti(s,h,p),x=ti(s,f,p),v=ti(e,f,p),E=ti(e,f,c),b=ti(s,f,c),m=1-ti(s,h,c),_=1-ti(e,h,c)):(C=ti(s,p,h),w=ti(e,p,h),x=1-ti(e,p,f),v=1-ti(s,p,f),E=1-ti(s,c,f),b=1-ti(e,c,f),m=ti(e,c,h),_=ti(s,c,h)),I.push(aa[u]),I.push(la[u]),I.push(ha[u]),I.push(pa[u])):35===u?(4===g?(C=1-ti(e,h,p),w=1-ti(s,h,p),x=ti(s,f,p),v=ti(e,f,p),E=ti(e,f,c),b=ti(s,f,c),m=1-ti(s,h,c),_=1-ti(e,h,c)):(C=ti(s,p,h),w=ti(e,p,h),x=1-ti(e,p,f),v=1-ti(s,p,f),E=1-ti(s,c,f),b=1-ti(e,c,f),m=ti(e,c,h),_=ti(s,c,h)),I.push(aa[u]),I.push(la[u]),I.push(ca[u]),I.push(pa[u])):136===u?(0===g?(C=ti(s,p,h),w=ti(e,p,h),x=1-ti(e,p,f),v=1-ti(s,p,f),E=1-ti(s,c,f),b=1-ti(e,c,f),m=ti(e,c,h),_=ti(s,c,h)):(C=1-ti(e,h,p),w=1-ti(s,h,p),x=ti(s,f,p),v=ti(e,f,p),E=ti(e,f,c),b=ti(s,f,c),m=1-ti(s,h,c),_=1-ti(e,h,c)),I.push(aa[u]),I.push(la[u]),I.push(ha[u]),I.push(pa[u])):153===u?(0===g?(C=ti(e,p,h),v=1-ti(e,p,f),E=1-ti(e,c,f),_=ti(e,c,h)):(C=1-ti(s,h,p),v=ti(s,f,p),E=ti(s,f,c),_=1-ti(s,h,c)),I.push(aa[u]),I.push(ca[u])):102===u?(0===g?(w=1-ti(e,h,p),x=ti(e,f,p),b=ti(e,f,c),m=1-ti(e,h,c)):(w=ti(s,p,h),x=1-ti(s,p,f),b=1-ti(s,c,f),m=ti(s,c,h)),I.push(la[u]),I.push(pa[u])):155===u?(4===g?(C=ti(e,p,h),v=1-ti(e,p,f),E=1-ti(e,c,f),_=ti(e,c,h)):(C=1-ti(s,h,p),v=ti(s,f,p),E=ti(s,f,c),_=1-ti(s,h,c)),I.push(aa[u]),I.push(ha[u])):103===u?(4===g?(w=1-ti(e,h,p),x=ti(e,f,p),b=ti(e,f,c),m=1-ti(e,h,c)):(w=ti(s,p,h),x=1-ti(s,p,f),b=1-ti(s,c,f),m=ti(s,c,h)),I.push(la[u]),I.push(ua[u])):152===u?(0===g?(C=ti(e,p,h),x=1-ti(e,p,f),v=1-ti(s,p,f),E=1-ti(s,c,f),b=1-ti(e,c,f),_=ti(e,c,h)):(C=1-ti(s,h,p),x=ti(s,f,p),v=ti(e,f,p),E=ti(e,f,c),b=ti(s,f,c),_=1-ti(s,h,c)),I.push(aa[u]),I.push(ua[u]),I.push(ca[u])):156===u?(4===g?(C=ti(e,p,h),x=1-ti(e,p,f),v=1-ti(s,p,f),E=1-ti(s,c,f),b=1-ti(e,c,f),_=ti(e,c,h)):(C=1-ti(s,h,p),x=ti(s,f,p),v=ti(e,f,p),E=ti(e,f,c),b=ti(s,f,c),_=1-ti(s,h,c)),I.push(aa[u]),I.push(ca[u]),I.push(pa[u])):137===u?(0===g?(C=ti(s,p,h),w=ti(e,p,h),v=1-ti(e,p,f),E=1-ti(e,c,f),m=ti(e,c,h),_=ti(s,c,h)):(C=1-ti(e,h,p),w=1-ti(s,h,p),v=ti(s,f,p),E=ti(s,f,c),m=1-ti(s,h,c),_=1-ti(e,h,c)),I.push(aa[u]),I.push(la[u]),I.push(ca[u])):139===u?(4===g?(C=ti(s,p,h),w=ti(e,p,h),v=1-ti(e,p,f),E=1-ti(e,c,f),m=ti(e,c,h),_=ti(s,c,h)):(C=1-ti(e,h,p),w=1-ti(s,h,p),v=ti(s,f,p),E=ti(s,f,c),m=1-ti(s,h,c),_=1-ti(e,h,c)),I.push(aa[u]),I.push(la[u]),I.push(ha[u])):98===u?(0===g?(C=1-ti(e,h,p),w=1-ti(s,h,p),x=ti(s,f,p),v=ti(e,f,p),b=ti(e,f,c),m=1-ti(e,h,c)):(C=ti(s,p,h),w=ti(e,p,h),x=1-ti(e,p,f),v=1-ti(s,p,f),b=1-ti(s,c,f),m=ti(s,c,h)),I.push(aa[u]),I.push(la[u]),I.push(pa[u])):99===u?(4===g?(C=1-ti(e,h,p),w=1-ti(s,h,p),x=ti(s,f,p),v=ti(e,f,p),b=ti(e,f,c),m=1-ti(e,h,c)):(C=ti(s,p,h),w=ti(e,p,h),x=1-ti(e,p,f),v=1-ti(s,p,f),b=1-ti(s,c,f),m=ti(s,c,h)),I.push(aa[u]),I.push(la[u]),I.push(ca[u])):38===u?(0===g?(w=1-ti(e,h,p),x=ti(e,f,p),E=ti(e,f,c),b=ti(s,f,c),m=1-ti(s,h,c),_=1-ti(e,h,c)):(w=ti(s,p,h),x=1-ti(s,p,f),E=1-ti(s,c,f),b=1-ti(e,c,f),m=ti(e,c,h),_=ti(s,c,h)),I.push(la[u]),I.push(ha[u]),I.push(pa[u])):39===u?(4===g?(w=1-ti(e,h,p),x=ti(e,f,p),E=ti(e,f,c),b=ti(s,f,c),m=1-ti(s,h,c),_=1-ti(e,h,c)):(w=ti(s,p,h),x=1-ti(s,p,f),E=1-ti(s,c,f),b=1-ti(e,c,f),m=ti(e,c,h),_=ti(s,c,h)),I.push(la[u]),I.push(ua[u]),I.push(pa[u])):85===u&&(C=1,w=0,x=1,v=0,E=0,b=1,m=0,_=1),(m<0||m>1||_<0||_>1||C<0||C>1||x<0||x>1||E<0||E>1||b<0||b>1)&&console.log("MarchingSquaresJS-isoBands: "+u+" "+d+" "+c+","+h+","+p+","+f+" "+g+" "+m+" "+_+" "+C+" "+w+" "+x+" "+v+" "+E+" "+b),o.cells[a][l]={cval:u,cval_real:d,flipped:g,topleft:m,topright:_,righttop:C,rightbottom:w,bottomright:x,bottomleft:v,leftbottom:E,lefttop:b,edges:I}}}}}return o}(t,e,n);return Es.polygons?(Es.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),l=function(t){var e=[],n=0;return t.cells.forEach((function(t,i){t.forEach((function(t,r){if(void 0!==t){var o=ga[t.cval](t);"object"==typeof o&&ei(o)?"object"==typeof o[0]&&ei(o[0])?"object"==typeof o[0][0]&&ei(o[0][0])?o.forEach((function(t){t.forEach((function(t){t[0]+=r,t[1]+=i})),e[n++]=t})):(o.forEach((function(t){t[0]+=r,t[1]+=i})),e[n++]=o):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}}))})),e}(u)):(Es.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),l=function(t){for(var e=[],n=t.rows,i=t.cols,r=[],o=0;o<n;o++)for(var s=0;s<i;s++)if(void 0!==t.cells[o][s]&&t.cells[o][s].edges.length>0){var a=function(t){if(t.edges.length>0){var e=t.edges[t.edges.length-1],n=t.cval_real;switch(e){case 0:return n&Ps?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 1:return n&Ns?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 2:return n&Ns?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 3:return n&Ss?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 4:return n&Ps?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 5:return n&Ns?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 6:return n&Ns?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 7:return n&Ss?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 8:return n&Ns?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.righttop],x:-1,y:0,o:1};case 9:return n&Ss?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 10:return n&Ss?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.righttop],x:-1,y:0,o:1};case 11:return n&Is?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 12:return n&Ns?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 13:return n&Ss?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 14:return n&Ss?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 15:return n&Is?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 16:return n&Ns?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 17:return n&Is?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 18:return n&Ss?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 19:return n&Is?{p:[t.bottomleft,0],x:0,y:1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 20:return n&Is?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 21:return n&Ps?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.topright,1],x:0,y:-1,o:1};case 22:return n&Is?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 23:return n&Ps?{p:[0,t.lefttop],x:1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t)}}return null}(t.cells[o][s]),l=null,u=s,c=o;null!==a&&r.push([a.p[0]+u,a.p[1]+c]);do{if(null===(l=function(t,e,n,i){var r,o,s,a,l,u=t.cval;switch(e){case-1:switch(i){case 0:r=la[u],s=Bs[u],a=Gs[u],l=js[u];break;default:r=aa[u],s=Ds[u],a=Fs[u],l=ks[u]}break;case 1:switch(i){case 0:r=ha[u],s=Zs[u],a=Js[u],l=Qs[u];break;default:r=pa[u],s=Xs[u],a=Ws[u],l=Ks[u]}break;default:switch(n){case-1:switch(i){case 0:r=fa[u],s=Ts[u],a=Ls[u],l=Ms[u];break;default:r=da[u],s=Os[u],a=Rs[u],l=As[u]}break;case 1:switch(i){case 0:r=ca[u],s=zs[u],a=Us[u],l=qs[u];break;default:r=ua[u],s=Vs[u],a=Hs[u],l=Ys[u]}}}if(o=t.edges.indexOf(r),void 0===t.edges[o])return null;switch(function(t,e){delete t.edges[e];for(var n=e+1;n<t.edges.length;n++)t.edges[n-1]=t.edges[n];t.edges.pop()}(t,o),u=t.cval_real,r){case 0:u&Ps?(e=t.topleft,n=1):(e=1,n=t.righttop);break;case 1:u&Ns?(e=1,n=t.rightbottom):(e=t.topleft,n=1);break;case 2:u&Ns?(e=t.topleft,n=1):(e=t.bottomright,n=0);break;case 3:u&Ss?(e=t.bottomleft,n=0):(e=t.topleft,n=1);break;case 4:u&Ps?(e=t.topright,n=1):(e=1,n=t.righttop);break;case 5:u&Ns?(e=1,n=t.rightbottom):(e=t.topright,n=1);break;case 6:u&Ns?(e=t.topright,n=1):(e=t.bottomright,n=0);break;case 7:u&Ss?(e=t.bottomleft,n=0):(e=t.topright,n=1);break;case 8:u&Ns?(e=1,n=t.righttop):(e=t.bottomright,n=0);break;case 9:u&Ss?(e=t.bottomleft,n=0):(e=1,n=t.righttop);break;case 10:u&Ss?(e=1,n=t.righttop):(e=0,n=t.leftbottom);break;case 11:u&Is?(e=0,n=t.lefttop):(e=1,n=t.righttop);break;case 12:u&Ns?(e=1,n=t.rightbottom):(e=t.bottomright,n=0);break;case 13:u&Ss?(e=t.bottomleft,n=0):(e=1,n=t.rightbottom);break;case 14:u&Ss?(e=1,n=t.rightbottom):(e=0,n=t.leftbottom);break;case 15:u&Is?(e=0,n=t.lefttop):(e=1,n=t.rightbottom);break;case 16:u&Ns?(e=0,n=t.leftbottom):(e=t.bottomright,n=0);break;case 17:u&Is?(e=0,n=t.lefttop):(e=t.bottomright,n=0);break;case 18:u&Ss?(e=t.bottomleft,n=0):(e=0,n=t.leftbottom);break;case 19:u&Is?(e=0,n=t.lefttop):(e=t.bottomleft,n=0);break;case 20:u&Is?(e=0,n=t.leftbottom):(e=t.topleft,n=1);break;case 21:u&Ps?(e=t.topright,n=1):(e=0,n=t.leftbottom);break;case 22:u&Is?(e=0,n=t.lefttop):(e=t.topleft,n=1);break;case 23:u&Ps?(e=t.topright,n=1):(e=0,n=t.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t),null}return void 0!==e&&void 0!==n&&void 0!==s&&void 0!==a&&void 0!==l||(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(t),console.log(e+" "+n+" "+s+" "+a+" "+l)),{p:[e,n],x:s,y:a,o:l}}(t.cells[c][u],a.x,a.y,a.o)))break;if(r.push([l.p[0]+u,l.p[1]+c]),u+=l.x,a=l,(c+=l.y)<0||c>=n||u<0||u>=i||void 0===t.cells[c][u]){var h=function(t,e,n,i,r,o){for(var s=t.cells[n][e],a=s.cval_real,l=e+i,u=n+r,c=[],h=!1;!h;){if(void 0===t.cells[u]||void 0===t.cells[u][l])if(u-=r,l-=i,a=(s=t.cells[u][l]).cval_real,-1===r)if(0===o)if(a&Ss)c.push([l,u]),i=-1,r=0,o=0;else{if(!(a&Ns)){c.push([l+s.bottomright,u]),i=0,r=1,o=1,h=!0;break}c.push([l+1,u]),i=1,r=0,o=0}else{if(!(a&Ss)){if(a&Ns){c.push([l+s.bottomright,u]),i=0,r=1,o=1,h=!0;break}c.push([l+s.bottomleft,u]),i=0,r=1,o=0,h=!0;break}c.push([l,u]),i=-1,r=0,o=0}else if(1===r)if(0===o){if(!(a&Ps)){if(a&Is){c.push([l+s.topleft,u+1]),i=0,r=-1,o=0,h=!0;break}c.push([l+s.topright,u+1]),i=0,r=-1,o=1,h=!0;break}c.push([l+1,u+1]),i=1,r=0,o=1}else c.push([l+1,u+1]),i=1,r=0,o=1;else if(-1===i)if(0===o){if(!(a&Is)){if(a&Ss){c.push([l,u+s.leftbottom]),i=1,r=0,o=0,h=!0;break}c.push([l,u+s.lefttop]),i=1,r=0,o=1,h=!0;break}c.push([l,u+1]),i=0,r=1,o=0}else{if(!(a&Is)){console.log("MarchingSquaresJS-isoBands: wtf");break}c.push([l,u+1]),i=0,r=1,o=0}else{if(1!==i){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===o){if(!(a&Ns)){c.push([l+1,u+s.rightbottom]),i=-1,r=0,o=0,h=!0;break}c.push([l+1,u]),i=0,r=-1,o=1}else{if(!(a&Ns)){if(a&Ps){c.push([l+1,u+s.righttop]),i=-1,r=0,o=1;break}c.push([l+1,u+s.rightbottom]),i=-1,r=0,o=0,h=!0;break}c.push([l+1,u]),i=0,r=-1,o=1}}else if(a=(s=t.cells[u][l]).cval_real,-1===i)if(0===o)if(void 0!==t.cells[u-1]&&void 0!==t.cells[u-1][l])i=0,r=-1,o=1;else{if(!(a&Ss)){c.push([l+s.bottomright,u]),i=0,r=1,o=1,h=!0;break}c.push([l,u])}else{if(!(a&Is)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+l+","+u);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===i){if(0===o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[u+1]&&void 0!==t.cells[u+1][l])i=0,r=1,o=0;else{if(!(a&Ps)){c.push([l+s.topleft,u+1]),i=0,r=-1,o=0,h=!0;break}c.push([l+1,u+1]),i=1,r=0,o=1}}else if(-1===r){if(1!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[u][l+1])i=1,r=0,o=1;else{if(!(a&Ns)){c.push([l+1,u+s.righttop]),i=-1,r=0,o=1,h=!0;break}c.push([l+1,u]),i=0,r=-1,o=1}}else{if(1!==r){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[u][l-1])i=-1,r=0,o=0;else{if(!(a&Is)){c.push([l,u+s.leftbottom]),i=1,r=0,o=0,h=!0;break}c.push([l,u+1]),i=0,r=1,o=0}}if(u+=r,(l+=i)===e&&u===n)break}return{path:c,i:l,j:u,x:i,y:r,o:o}}(t,u-=l.x,c-=l.y,l.x,l.y,l.o);if(null===h)break;h.path.forEach((function(t){r.push(t)})),u=h.i,c=h.j,a=h}}while(void 0!==t.cells[c][u]&&t.cells[c][u].edges.length>0);e.push(r),r=[],t.cells[o][s].edges.length>0&&s--}return e}(u)),"function"==typeof Es.successCallback&&Es.successCallback(l),l}function ti(t,e,n){return(t-e)/(n-e)}function ei(t){return t.constructor.toString().indexOf("Array")>-1}function ni(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.pivot,r=n.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("angle is required");return 0===e||(i||(i=ce(t)),!1!==r&&void 0!==r||(t=Ft(t)),N(t,(function(t){var n=Ze(i,t)+e,r=Qe(i,t),o=V(Yn(i,r,n));t[0]=o[0],t[1]=o[1]}))),t}function ii(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.origin,r=n.mutate;if(!t)throw new Error("geojson required");if("number"!=typeof e||0===e)throw new Error("invalid factor");var o=Array.isArray(i)||"object"==typeof i;return!0!==r&&(t=Ft(t)),"FeatureCollection"!==t.type||o?ri(t,e,i):(M(t,(function(n,r){t.features[r]=ri(n,e,i)})),t)}function ri(t,e,n){var r="Point"===J(t);return n=function(t,e){if(null!=e||(e="centroid"),Array.isArray(e)||"object"==typeof e)return q(e);var n=t.bbox?t.bbox:U(t),r=n[0],o=n[1],s=n[2],a=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return i([r,o]);case"se":case"southeast":case"eastsouth":case"bottomright":return i([s,o]);case"nw":case"northwest":case"westnorth":case"topleft":return i([r,a]);case"ne":case"northeast":case"eastnorth":case"topright":return i([s,a]);case"center":return ue(t);case void 0:case null:case"centroid":return ce(t);default:throw new Error("invalid origin")}}(t,n),1===e||r||N(t,(function(t){var i=Qe(n,t),r=Ze(n,t),o=V(Yn(n,i*e,r));t[0]=o[0],t[1]=o[1],3===t.length&&(t[2]*=e)})),t}function oi(t){var e=t[0],n=t[1];return[n[0]-e[0],n[1]-e[1]]}function si(t,e){return t[0]*e[1]-e[0]*t[1]}function ai(t,e,n){var i=[],r=m(e,n),o=V(t),s=[];return o.forEach((function(t,e){if(e!==o.length-1){var n=function(t,e,n){var i=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),r=t[0]+n*(e[1]-t[1])/i,o=e[0]+n*(e[1]-t[1])/i;return[[r,t[1]+n*(t[0]-e[0])/i],[o,e[1]+n*(t[0]-e[0])/i]]}(t,o[e+1],r);if(i.push(n),e>0){var a=i[e-1],l=function(t,e){return!function(t,e){return 0===si(oi(t),oi(e))}(t,e)&&function(t,e){var n=t[0],i=oi(t),r=e[0],o=oi(e),s=si(i,o);return function(t,e){return[t[0]+e[0],t[1]+e[1]]}(n,function(t,e){return[t*e[0],t*e[1]]}(si(function(t,e){return[t[0]-e[0],t[1]-e[1]]}(r,n),o)/s,i))}(t,e)}(n,a);!1!==l&&(a[1]=l,n[0]=l),s.push(a[0]),e===o.length-2&&(s.push(n[0]),s.push(n[1]))}2===o.length&&(s.push(n[0]),s.push(n[1]))}})),a(s,t.properties)}function li(t,e,n){var i=e[0]-t[0],r=e[1]-t[1],o=n[0]-e[0],s=n[1]-e[1];return Math.sign(i*s-o*r)}function ui(t,e){return e.geometry.coordinates[0].every((function(e){return St(i(e),t)}))}function ci(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(function(t,e,n){var i=n[0]-t[0],r=n[1]-t[1],o=e[0]-t[0],s=e[1]-t[1];return i*s-r*o==0&&(Math.abs(o)>=Math.abs(s)?o>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:s>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1])}(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function hi(t,e){return Xe(e,Ln(t)).features.length>0}function pi(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function fi(t,e){return t[0]===e[0]&&t[1]===e[1]}function di(t,e){for(var n=!1,i=!1,r=t.coordinates.length,o=0;o<r&&!n&&!i;){for(var s=0;s<e.coordinates.length-1;s++){var a=!0;0!==s&&s!==e.coordinates.length-2||(a=!1),mi(e.coordinates[s],e.coordinates[s+1],t.coordinates[o],a)?n=!0:i=!0}o++}return n&&i}function gi(t,e){return Xe(t,Ln(e)).features.length>0}function yi(t,e){for(var n=!1,r=!1,o=t.coordinates[0].length,s=0;s<o&&n&&r;)St(i(t.coordinates[0][s]),e)?n=!0:r=!0,s++;return r&&r}function mi(t,e,n,i){var r=n[0]-t[0],o=n[1]-t[1],s=e[0]-t[0],a=e[1]-t[1];return 0==r*a-o*s&&(i?Math.abs(s)>=Math.abs(a)?s>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:a>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]:Math.abs(s)>=Math.abs(a)?s>0?t[0]<n[0]&&n[0]<e[0]:e[0]<n[0]&&n[0]<t[0]:a>0?t[1]<n[1]&&n[1]<e[1]:e[1]<n[1]&&n[1]<t[1])}function _i(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function vi(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function xi(t,e){return ba(t,e,{strict:!0})}function Ci(t,e){if(!t)throw new Error("feature1 is required");if(!e)throw new Error("feature2 is required");var n=J(t);if(n!==J(e))throw new Error("features must be of the same type");if("Point"===n)throw new Error("Point geometry not supported");if(new Ia({precision:6}).compare(t,e))return!1;var i=0;switch(n){case"MultiPoint":var r=R(t),o=R(e);r.forEach((function(t){o.forEach((function(e){t[0]===e[0]&&t[1]===e[1]&&i++}))}));break;case"LineString":case"MultiLineString":B(t,(function(t){B(e,(function(e){qn(t,e).features.length&&i++}))}));break;case"Polygon":case"MultiPolygon":B(t,(function(t){B(e,(function(e){Xe(t,e).features.length&&i++}))}))}return i>0}function wi(t,e,n){n=n||[];for(var i=0;i<t;i++)n[i]=e;return n}function bi(t,e){if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error("Invalid GeoJSON object for "+e)}function Ei(t){for(var e=t,n=[];e.parent;)n.unshift(e),e=e.parent;return n}function Ii(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var n=0;n<t.length;n++){this.grid[n]=[];for(var i=0,r=t[n];i<r.length;i++){var o=new Pi(n,i,r[i]);this.grid[n][i]=o,this.nodes.push(o)}}this.init()}function Pi(t,e,n){this.x=t,this.y=e,this.weight=n}function Ni(t){this.content=[],this.scoreFunction=t}function Si(t){return t[0]}function Ti(t){return t[1]}function Li(){this._=null}function Mi(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Oi(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function Ri(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function Ai(t){for(;t.L;)t=t.L;return t}function Di(t,e,n,i){var r=[null,null],o=Ua.push(r)-1;return r.left=t,r.right=e,n&&ki(r,t,e,n),i&&ki(r,e,t,i),ja[t.index].halfedges.push(o),ja[e.index].halfedges.push(o),r}function Fi(t,e,n){var i=[e,n];return i.left=t,i}function ki(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function Bi(t,e,n,i,r){var o,s=t[0],a=t[1],l=s[0],u=s[1],c=0,h=1,p=a[0]-l,f=a[1]-u;if(o=e-l,p||!(o>0)){if(o/=p,p<0){if(o<c)return;o<h&&(h=o)}else if(p>0){if(o>h)return;o>c&&(c=o)}if(o=i-l,p||!(o<0)){if(o/=p,p<0){if(o>h)return;o>c&&(c=o)}else if(p>0){if(o<c)return;o<h&&(h=o)}if(o=n-u,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>c&&(c=o)}if(o=r-u,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<h&&(h=o)}return!(c>0||h<1)||(c>0&&(t[0]=[l+c*p,u+c*f]),h<1&&(t[1]=[l+h*p,u+h*f]),!0)}}}}}function Gi(t,e,n,i,r){var o=t[1];if(o)return!0;var s,a,l=t[0],u=t.left,c=t.right,h=u[0],p=u[1],f=c[0],d=c[1],g=(h+f)/2,y=(p+d)/2;if(d===p){if(g<e||g>=i)return;if(h>f){if(l){if(l[1]>=r)return}else l=[g,n];o=[g,r]}else{if(l){if(l[1]<n)return}else l=[g,r];o=[g,n]}}else if(a=y-(s=(h-f)/(d-p))*g,s<-1||s>1)if(h>f){if(l){if(l[1]>=r)return}else l=[(n-a)/s,n];o=[(r-a)/s,r]}else{if(l){if(l[1]<n)return}else l=[(r-a)/s,r];o=[(n-a)/s,n]}else if(p<d){if(l){if(l[0]>=i)return}else l=[e,s*e+a];o=[i,s*i+a]}else{if(l){if(l[0]<e)return}else l=[i,s*i+a];o=[e,s*e+a]}return t[0]=l,t[1]=o,!0}function ji(t,e){var n=t.site,i=e.left,r=e.right;return n===r&&(r=i,i=n),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(n===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function zi(t,e){return e[+(e.left!==t.site)]}function Ui(t,e){return e[+(e.left===t.site)]}function qi(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var s=r[0],a=r[1],l=i[0]-s,u=i[1]-a,c=o[0]-s,h=o[1]-a,p=2*(l*h-u*c);if(!(p>=-Ya)){var f=l*l+u*u,d=c*c+h*h,g=(h*f-u*d)/p,y=(l*d-c*f)/p,m=qa.pop()||new function(){Mi(this),this.x=this.y=this.arc=this.site=this.cy=null};m.arc=t,m.site=r,m.x=g+s,m.y=(m.cy=y+a)+Math.sqrt(g*g+y*y),t.circle=m;for(var _=null,v=za._;v;)if(m.y<v.y||m.y===v.y&&m.x<=v.x){if(!v.L){_=v.P;break}v=v.L}else{if(!v.R){_=v;break}v=v.R}za.insert(_,m),_||(Ba=m)}}}}function Vi(t){var e=t.circle;e&&(e.P||(Ba=e.N),za.remove(e),qa.push(e),Mi(e),t.circle=null)}function Hi(t){var e=Va.pop()||new function(){Mi(this),this.edge=this.site=this.circle=null};return e.site=t,e}function Yi(t){Vi(t),Ga.remove(t),Va.push(t),Mi(t)}function Xi(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],o=t.P,s=t.N,a=[t];Yi(t);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<Ha&&Math.abs(i-l.circle.cy)<Ha;)o=l.P,a.unshift(l),Yi(l),l=o;a.unshift(l),Vi(l);for(var u=s;u.circle&&Math.abs(n-u.circle.x)<Ha&&Math.abs(i-u.circle.cy)<Ha;)s=u.N,a.push(u),Yi(u),u=s;a.push(u),Vi(u);var c,h=a.length;for(c=1;c<h;++c)u=a[c],l=a[c-1],ki(u.edge,l.site,u.site,r);l=a[0],(u=a[h-1]).edge=Di(l.site,u.site,null,r),qi(l),qi(u)}function Wi(t){for(var e,n,i,r,o=t[0],s=t[1],a=Ga._;a;)if((i=Ki(a,s)-o)>Ha)a=a.L;else{if(!((r=o-function(t,e){var n=t.N;if(n)return Ki(n,e);var i=t.site;return i[1]===e?i[0]:1/0}(a,s))>Ha)){i>-Ha?(e=a.P,n=a):r>-Ha?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}!function(t){ja[t.index]={site:t,halfedges:[]}}(t);var l=Hi(t);if(Ga.insert(e,l),e||n){if(e===n)return Vi(e),n=Hi(e.site),Ga.insert(l,n),l.edge=n.edge=Di(e.site,l.site),qi(e),void qi(n);if(n){Vi(e),Vi(n);var u=e.site,c=u[0],h=u[1],p=t[0]-c,f=t[1]-h,d=n.site,g=d[0]-c,y=d[1]-h,m=2*(p*y-f*g),_=p*p+f*f,v=g*g+y*y,x=[(y*_-f*v)/m+c,(p*v-g*_)/m+h];ki(n.edge,u,d,x),l.edge=Di(u,t,null,x),n.edge=Di(t,d,null,x),qi(e),qi(n)}else l.edge=Di(e.site,l.site)}}function Ki(t,e){var n=t.site,i=n[0],r=n[1],o=r-e;if(!o)return i;var s=t.P;if(!s)return-1/0;var a=(n=s.site)[0],l=n[1],u=l-e;if(!u)return a;var c=a-i,h=1/o-1/u,p=c/u;return h?(-p+Math.sqrt(p*p-2*h*(c*c/(-2*u)-l+u/2+r-o/2)))/h+i:(i+a)/2}function Zi(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function Ji(t,e){return e[1]-t[1]||e[0]-t[0]}function Qi(t,e){var n,i,r,o=t.sort(Ji).pop();for(Ua=[],ja=new Array(t.length),Ga=new Li,za=new Li;;)if(r=Ba,o&&(!r||o[1]<r.y||o[1]===r.y&&o[0]<r.x))o[0]===n&&o[1]===i||(Wi(o),n=o[0],i=o[1]),o=t.pop();else{if(!r)break;Xi(r.arc)}if(function(){for(var t,e,n,i,r=0,o=ja.length;r<o;++r)if((t=ja[r])&&(i=(e=t.halfedges).length)){var s=new Array(i),a=new Array(i);for(n=0;n<i;++n)s[n]=n,a[n]=ji(t,Ua[e[n]]);for(s.sort((function(t,e){return a[e]-a[t]})),n=0;n<i;++n)a[n]=e[s[n]];for(n=0;n<i;++n)e[n]=a[n]}}(),e){var s=+e[0][0],a=+e[0][1],l=+e[1][0],u=+e[1][1];!function(t,e,n,i){for(var r,o=Ua.length;o--;)Gi(r=Ua[o],t,e,n,i)&&Bi(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>Ha||Math.abs(r[0][1]-r[1][1])>Ha)||delete Ua[o]}(s,a,l,u),function(t,e,n,i){var r,o,s,a,l,u,c,h,p,f,d,g,y=ja.length,m=!0;for(r=0;r<y;++r)if(o=ja[r]){for(s=o.site,a=(l=o.halfedges).length;a--;)Ua[l[a]]||l.splice(a,1);for(a=0,u=l.length;a<u;)d=(f=Ui(o,Ua[l[a]]))[0],g=f[1],h=(c=zi(o,Ua[l[++a%u]]))[0],p=c[1],(Math.abs(d-h)>Ha||Math.abs(g-p)>Ha)&&(l.splice(a,0,Ua.push(Fi(s,f,Math.abs(d-t)<Ha&&i-g>Ha?[t,Math.abs(h-t)<Ha?p:i]:Math.abs(g-i)<Ha&&n-d>Ha?[Math.abs(p-i)<Ha?h:n,i]:Math.abs(d-n)<Ha&&g-e>Ha?[n,Math.abs(h-n)<Ha?p:e]:Math.abs(g-e)<Ha&&d-t>Ha?[Math.abs(p-e)<Ha?h:t,e]:null))-1),++u);u&&(m=!1)}if(m){var _,v,x,C=1/0;for(r=0,m=null;r<y;++r)(o=ja[r])&&(x=(_=(s=o.site)[0]-t)*_+(v=s[1]-e)*v)<C&&(C=x,m=o);if(m){var w=[t,e],b=[t,i],E=[n,i],I=[n,e];m.halfedges.push(Ua.push(Fi(s=m.site,w,b))-1,Ua.push(Fi(s,b,E))-1,Ua.push(Fi(s,E,I))-1,Ua.push(Fi(s,I,w))-1)}}for(r=0;r<y;++r)(o=ja[r])&&(o.halfedges.length||delete ja[r])}(s,a,l,u)}this.edges=Ua,this.cells=ja,Ga=za=Ua=ja=null}function $i(t){return(t=t.slice()).push(t[0]),o([t])}function tr(t,e,n,i){var r=(i=i||{}).steps||64,s=i.units||"kilometers",a=i.angle||0,l=i.pivot||t,u=i.properties||t.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!E(i))throw new Error("options must be an object");if(!b(r))throw new Error("steps must be a number");if(!b(a))throw new Error("angle must be a number");var c=q(t);if("degrees"===s)var h=x(a);else e=Yn(t,e,90,{units:s}),n=Yn(t,n,0,{units:s}),e=q(e)[0]-c[0],n=q(n)[1]-c[1];for(var p=[],f=0;f<r;f+=1){var d=-360*f/r,g=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(er(d),2)),y=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(er(d),2));if(d<-90&&d>=-270&&(g=-g),d<-180&&d>=-360&&(y=-y),"degrees"===s){var m=g*Math.cos(h)+y*Math.sin(h),_=y*Math.cos(h)-g*Math.sin(h);g=m,y=_}p.push([g+c[0],y+c[1]])}return p.push(p[0]),"degrees"===s?o([p],u):ni(o([p],u),a,{pivot:l})}function er(t){var e=t*Math.PI/180;return Math.tan(e)}function nr(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.properties,r=e.weight;if(!t)throw new Error("geojson is required");var o=0,s=0,a=0;return A(t,(function(t,e,n){var i=n[r];if(!b(i=null==i?1:i))throw new Error("weight value must be a number for feature index "+e);(i=Number(i))>0&&N(t,(function(t){o+=t[0]*i,s+=t[1]*i,a+=i}))})),i([o/a,s/a],n)}function ir(t,e,n,r){var o=n.properties.tolerance||.001,s=0,a=0,l=0,u=0;if(M(n,(function(e){var n=e.properties.weight,i=null==n?1:n;if(!b(i=Number(i)))throw new Error("weight value must be a number");if(i>0){u+=1;var r=i*Dt(e,t);0===r&&(r=1);var o=i/r;s+=e.geometry.coordinates[0]*o,a+=e.geometry.coordinates[1]*o,l+=o}})),u<1)throw new Error("no features to measure");var c=s/l,h=a/l;return 1===u||0===r||Math.abs(c-e[0])<o&&Math.abs(h-e[1])<o?i([c,h],{medianCandidates:n.properties.medianCandidates}):(n.properties.medianCandidates.push([c,h]),ir([c,h],t,n,r-1))}function rr(t,e){return{x:t[0]-e[0],y:t[1]-e[1]}}function or(t){if(E(t)&&(t=t.bbox),t&&!Array.isArray(t))throw new Error("bbox is invalid");return t?function(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}(t):[360*ur(),180*ur()]}function sr(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.bbox;null!=t||(t=1);for(var r=[],o=0;o<t;o++)r.push(i(or(n)));return u(r)}function ar(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.num_vertices,r=e.max_radial_length;null!=t||(t=1),b(i)||(i=10),b(r)||(r=10);for(var s=[],a=0;a<t;a++){var l=[],c=Array.apply(null,new Array(i+1)).map(Math.random);c.forEach((function(t,e,n){n[e]=e>0?t+n[e-1]:t})),c.forEach((function(t){t=2*t*Math.PI/c[c.length-1];var e=Math.random();l.push([e*r*Math.sin(t),e*r*Math.cos(t)])})),l[l.length-1]=l[0],l=l.map(function(t){return function(e){return[e[0]+t[0],e[1]+t[1]]}}(or(n))),s.push(o([l]))}return u(s)}function lr(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.num_vertices,r=e.max_length,o=e.max_rotation;null!=t||(t=1),(!b(i)||i<2)&&(i=10),b(r)||(r=1e-4),b(o)||(o=Math.PI/8);for(var s=[],l=0;l<t;l++){for(var c=[or(n)],h=0;h<i-1;h++){var p=(0===h?2*Math.random()*Math.PI:Math.tan((c[h][1]-c[h-1][1])/(c[h][0]-c[h-1][0])))+(Math.random()-.5)*o*2,f=Math.random()*r;c.push([c[h][0]+f*Math.cos(p),c[h][1]+f*Math.sin(p)])}s.push(a(c))}return u(s)}function ur(){return Math.random()-.5}function cr(t,e){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("filter is required");var n=[];return M(t,(function(t){dr(t.properties,e)&&n.push(t)})),u(n)}function hr(t,e,n){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("property is required");for(var i=fr(t,e),r=Object.keys(i),o=0;o<r.length;o++){for(var s=r[o],a=i[s],l=[],c=0;c<a.length;c++)l.push(t.features[a[c]]);n(u(l),s,o)}}function pr(t,e,n,i){var r=i;return hr(t,e,(function(t,e,o){r=0===o&&void 0===i?t:n(r,t,e,o)})),r}function fr(t,e){var n={};return M(t,(function(t,i){var r=t.properties||{};if(r.hasOwnProperty(e)){var o=r[e];n.hasOwnProperty(o)?n[o].push(i):n[o]=[i]}})),n}function dr(t,e){if(void 0===t)return!1;var n=typeof e;if("number"===n||"string"===n)return t.hasOwnProperty(e);if(Array.isArray(e)){for(var i=0;i<e.length;i++)if(!dr(t,e[i]))return!1;return!0}return gr(t,e)}function gr(t,e){for(var n=Object.keys(e),i=0;i<n.length;i++){var r=n[i];if(t[r]!==e[r])return!1}return!0}function yr(t,e){if(!e)return{};if(!e.length)return{};for(var n={},i=0;i<e.length;i++){var r=e[i];t.hasOwnProperty(r)&&(n[r]=t[r])}return n}function mr(){}function _r(t){this.message=t||""}function vr(t){this.message=t||""}function xr(){}function Cr(t){return null===t?fu:t.color}function wr(t){return null===t?null:t.parent}function br(t,e){null!==t&&(t.color=e)}function Er(t){return null===t?null:t.left}function Ir(t){return null===t?null:t.right}function Pr(){this.root_=null,this.size_=0}function Nr(){}function Sr(){this.array_=[],arguments[0]instanceof Ql&&this.addAll(arguments[0])}function Tr(){}function Lr(t){this.message=t||""}function Mr(){this.array_=[]}function Or(t){switch(t.type){case"Polygon":return un(t)>1?t:null;case"MultiPolygon":var e=[];if(F(t,(function(t){un(t)>1&&e.push(t.geometry.coordinates)})),e.length)return{type:"MultiPolygon",coordinates:e}}}function Rr(){this.reset()}function Ar(t,e,n){var i=t.s=e+n,r=i-e,o=i-r;t.t=e-o+(n-r)}function Dr(t){return t>1?vf:t<-1?-vf:Math.asin(t)}function Fr(){}function kr(t,e){t&&Af.hasOwnProperty(t.type)&&Af[t.type](t,e)}function Br(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function Gr(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Br(t[n],e,1);e.polygonEnd()}function jr(t){return[Pf(t[1],t[0]),Dr(t[2])]}function zr(t){var e=t[0],n=t[1],i=Nf(n);return[i*Nf(e),i*Lf(e),Lf(n)]}function Ur(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function qr(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Vr(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Hr(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Yr(t){var e=Mf(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Xr(t,e){return[t>_f?t-Cf:t<-_f?t+Cf:t,e]}function Wr(t,e,n){return(t%=Cf)?e||n?Ff(Zr(t),Jr(e,n)):Zr(t):e||n?Jr(e,n):Xr}function Kr(t){return function(e,n){return[(e+=t)>_f?e-Cf:e<-_f?e+Cf:e,n]}}function Zr(t){var e=Kr(t);return e.invert=Kr(-t),e}function Jr(t,e){function n(t,e){var n=Nf(e),a=Nf(t)*n,l=Lf(t)*n,u=Lf(e),c=u*i+a*r;return[Pf(l*o-c*s,a*i-u*r),Dr(c*o+l*s)]}var i=Nf(t),r=Lf(t),o=Nf(e),s=Lf(e);return n.invert=function(t,e){var n=Nf(e),a=Nf(t)*n,l=Lf(t)*n,u=Lf(e),c=u*o-l*s;return[Pf(l*o+u*s,a*i+c*r),Dr(c*i-a*r)]},n}function Qr(t,e){(e=zr(e))[0]-=t,Yr(e);var n=function(t){return t>1?0:t<-1?_f:Math.acos(t)}(-e[1]);return((-e[2]<0?-n:n)+Cf-mf)%Cf}function $r(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function to(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function eo(t,e,n,i){function r(r,o){return t<=r&&r<=n&&e<=o&&o<=i}function o(r,o,a,u){var c=0,h=0;if(null==r||(c=s(r,a))!==(h=s(o,a))||l(r,o)<0^a>0)do{u.point(0===c||3===c?t:n,c>1?i:e)}while((c=(c+a+4)%4)!==h);else u.point(o[0],o[1])}function s(i,r){return Ef(i[0]-t)<mf?r>0?0:3:Ef(i[0]-n)<mf?r>0?2:1:Ef(i[1]-e)<mf?r>0?1:0:r>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var n=s(t,1),i=s(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){function l(t,e){r(t,e)&&C.point(t,e)}function u(o,s){var a=r(o,s);if(h&&p.push([o,s]),v)f=o,d=s,g=a,v=!1,a&&(C.lineStart(),C.point(o,s));else if(a&&_)C.point(o,s);else{var l=[y=Math.max(Vf,Math.min(qf,y)),m=Math.max(Vf,Math.min(qf,m))],u=[o=Math.max(Vf,Math.min(qf,o)),s=Math.max(Vf,Math.min(qf,s))];Bf(l,u,t,e,n,i)?(_||(C.lineStart(),C.point(l[0],l[1])),C.point(u[0],u[1]),a||C.lineEnd(),x=!1):a&&(C.lineStart(),C.point(o,s),x=!1)}y=o,m=s,_=a}var c,h,p,f,d,g,y,m,_,v,x,C=s,w=kf(),b={point:l,lineStart:function(){b.point=u,h&&h.push(p=[]),v=!0,_=!1,y=m=NaN},lineEnd:function(){c&&(u(f,d),g&&_&&w.rejoin(),c.push(w.result())),b.point=l,_&&C.lineEnd()},polygonStart:function(){C=w,c=[],h=[],x=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,r=h.length;n<r;++n)for(var o,s,a=h[n],l=1,u=a.length,c=a[0],p=c[0],f=c[1];l<u;++l)o=p,s=f,p=(c=a[l])[0],f=c[1],s<=i?f>i&&(p-o)*(i-s)>(f-s)*(t-o)&&++e:f<=i&&(p-o)*(i-s)<(f-s)*(t-o)&&--e;return e}(),n=x&&e,r=(c=Uf(c)).length;(n||r)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),r&&jf(c,a,e,o,s),s.polygonEnd()),C=s,c=h=p=null}};return b}}function no(t){return t.length>1}function io(t,e){return((t=t.x)[0]<0?t[1]-vf-mf:vf-t[1])-((e=e.x)[0]<0?e[1]-vf-mf:vf-e[1])}function ro(t){return function(e){var n=new oo;for(var i in t)n[i]=t[i];return n.stream=e,n}}function oo(){}function so(t,e,n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),Df(n,t.stream(Jf));var s=Jf.result(),a=Math.min(i/(s[1][0]-s[0][0]),r/(s[1][1]-s[0][1])),l=+e[0][0]+(i-a*(s[1][0]+s[0][0]))/2,u=+e[0][1]+(r-a*(s[1][1]+s[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([l,u])}function ao(t,e){return[t,Tf(Of((vf+e)/2))]}function lo(t,e){return[Tf(Of((vf+e)/2)),-t]}function uo(t,n,i,r){var o=t.properties||{},s="Feature"===t.type?t.geometry:t;if("GeometryCollection"===s.type){var a=[];return A(t,(function(t){var e=uo(t,n,i,r);e&&a.push(e)})),u(a)}var l,c=U(t),h=c[1]>50&&c[3]>50;l=h?{type:s.type,coordinates:co(s.coordinates,po(s))}:$e(s);var p,f=(new nc).read(l),d=g(y(n,i),"meters"),m=Xh.bufferOp(f,d);if(!function t(e){return Array.isArray(e[0])?t(e[0]):isNaN(e[0])}((m=(new ic).write(m)).coordinates))return(p=h?{type:m.type,coordinates:ho(m.coordinates,po(s))}:tn(m)).geometry?p:e(p,o)}function co(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return co(t,e)}))}function ho(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return ho(t,e)}))}function po(t){var e=ue(t).geometry.coordinates.reverse(),n=e.map((function(t){return-t}));return rd().center(e).rotate(n).scale(wo)}function fo(){for(var t=new nc,e=t.read(JSON.stringify(arguments[0].geometry)),n=1;n<arguments.length;n++)e=df.union(e,t.read(JSON.stringify(arguments[n].geometry)));return{type:"Feature",geometry:e=(new ic).write(e),properties:arguments[0].properties}}function go(t,n){var i=K(t),r=K(n);if(Kt(xn(r,{precision:4})).coordinates[0].length<4)return null;if(Kt(xn(i,{precision:4})).coordinates[0].length<4)return null;var o=new nc,s=o.read(xn(i)),a=o.read(xn(r)),l=of.intersection(s,a);return l.isEmpty()?null:e((new ic).write(l))}function yo(t,e){return function(t,e,n){var i,r;if(!Array.isArray(e))throw new Error("Get closest expects an array as second argument");return e.forEach((function(e,n){var o=function(t,e){return t-e}(e,t);o>=0&&(void 0===r||o<r)&&(r=o,i=n)})),i}(t,e)}function mo(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.properties||{},r=n.triangles,s=n.mask;if(null==e)throw new Error("cellSide is required");if(!b(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(s&&-1===["Polygon","MultiPolygon"].indexOf(J(s)))throw new Error("options.mask must be a (Multi)Polygon");var a=t[0],l=t[1],c=t[2],h=t[3],p=(l+h)/2,f=(a+c)/2,d=2*e/Dt([a,p],[c,p],n)*(c-a),g=2*e/Dt([f,l],[f,h],n)*(h-l),y=d/2,m=2*y,_=Math.sqrt(3)/2*g,v=c-a,x=h-l,C=.75*m,w=_,I=(v-m)/(m-y/2),P=Math.floor(I),N=(P*C-y/2-v)/2-y/2+C/2,S=Math.floor((x-_)/_),T=(x-S*_)/2,L=S*_-x>_/2;L&&(T-=_/4);for(var M=[],O=[],R=0;R<6;R++){var A=2*Math.PI/6*R;M.push(Math.cos(A)),O.push(Math.sin(A))}for(var D=[],F=0;F<=P;F++)for(var k=0;k<=S;k++){var B=F%2==1;if(!(0===k&&B||0===k&&L)){var G=F*C+a-N,j=k*w+l+T;if(B&&(j-=_/2),!0===r)(function(t,e,n,i,r,s){for(var a=[],l=0;l<6;l++){var u=[];u.push(t),u.push([t[0]+e*r[l],t[1]+n*s[l]]),u.push([t[0]+e*r[(l+1)%6],t[1]+n*s[(l+1)%6]]),u.push(t),a.push(o([u],i))}return a})([G,j],d/2,g/2,i,M,O).forEach((function(t){s?go(s,t)&&D.push(t):D.push(t)}));else{var z=function(t,e,n,i,r,s){for(var a=[],l=0;l<6;l++){var u=t[0]+e*r[l],c=t[1]+n*s[l];a.push([u,c])}return a.push(a[0].slice()),o([a],i)}([G,j],d/2,g/2,i,M,O);s?go(s,z)&&D.push(z):D.push(z)}}}return u(D)}function _o(t){if(t.features.length<=1)return t;var e=function(t){var e=Oo(),n=[];return F(t,(function(t,e){var i=U(t);n.push({minX:i[0],minY:i[1],maxX:i[2],maxY:i[3],geojson:t,index:e})})),e.load(n),e}(t),n=[],i={};return F(t,(function(t,r){if(i[r])return!0;for(e.remove({index:r},vo),i[r]=!0;;){var o=U(t),s=e.search({minX:o[0],minY:o[1],maxX:o[2],maxY:o[3]});if(s.length>0){var a=s.map((function(t){return i[t.index]=!0,e.remove({index:t.index},vo),t.geojson}));a.push(t),t=fo.apply(this,a)}if(0===s.length)break}n.push(t)})),u(n)}function vo(t,e){return t.index===e.index}function xo(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.properties,r=n.mask,s=[];if(null==e)throw new Error("cellSide is required");if(!b(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(r&&-1===["Polygon","MultiPolygon"].indexOf(J(r)))throw new Error("options.mask must be a (Multi)Polygon");for(var a=t[0],l=t[1],c=t[2],h=t[3],p=e/Dt([a,l],[c,l],n)*(c-a),f=e/Dt([a,l],[a,h],n)*(h-l),d=c-a,g=h-l,y=Math.floor(d/p),m=Math.floor(g/f),_=(g-m*f)/2,v=a+(d-y*p)/2,x=0;x<y;x++){for(var C=l+_,w=0;w<m;w++){var I=o([[[v,C],[v,C+f],[v+p,C+f],[v+p,C],[v,C]]],i);r?go(r,I)&&s.push(I):s.push(I),C+=f}v+=p}return u(s)}function Co(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.properties,r=n.mask,s=[];if(null==e)throw new Error("cellSide is required");if(!b(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(r&&-1===["Polygon","MultiPolygon"].indexOf(J(r)))throw new Error("options.mask must be a (Multi)Polygon");for(var a=e/Dt([t[0],t[1]],[t[2],t[1]],n)*(t[2]-t[0]),l=e/Dt([t[0],t[1]],[t[0],t[3]],n)*(t[3]-t[1]),c=0,h=t[0];h<=t[2];){for(var p=0,f=t[1];f<=t[3];){var d=null,g=null;c%2==0&&p%2==0?(d=o([[[h,f],[h,f+l],[h+a,f],[h,f]]],i),g=o([[[h,f+l],[h+a,f+l],[h+a,f],[h,f+l]]],i)):c%2==0&&p%2==1?(d=o([[[h,f],[h+a,f+l],[h+a,f],[h,f]]],i),g=o([[[h,f],[h,f+l],[h+a,f+l],[h,f]]],i)):p%2==0&&c%2==1?(d=o([[[h,f],[h,f+l],[h+a,f+l],[h,f]]],i),g=o([[[h,f],[h+a,f+l],[h+a,f],[h,f]]],i)):p%2==1&&c%2==1&&(d=o([[[h,f],[h,f+l],[h+a,f],[h,f]]],i),g=o([[[h,f+l],[h+a,f+l],[h+a,f],[h,f+l]]],i)),r?(go(r,d)&&s.push(d),go(r,g)&&s.push(g)):(s.push(d),s.push(g)),f+=l,p++}c++,h+=a}return u(s)}var wo=6371008.8,bo={meters:wo,metres:wo,millimeters:1e3*wo,millimetres:1e3*wo,centimeters:100*wo,centimetres:100*wo,kilometers:wo/1e3,kilometres:wo/1e3,miles:wo/1609.344,nauticalmiles:wo/1852,inches:39.37*wo,yards:wo/1.0936,feet:3.28084*wo,radians:1,degrees:wo/111325},Eo={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:.001,kilometres:.001,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/wo,degrees:1/111325},Io={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006},Po=Object.freeze({earthRadius:wo,factors:bo,unitsFactors:Eo,areaFactors:Io,feature:e,geometry:n,point:i,points:r,polygon:o,polygons:s,lineString:a,lineStrings:l,featureCollection:u,multiLineString:c,multiPoint:h,multiPolygon:p,geometryCollection:f,round:d,radiansToLength:g,lengthToRadians:y,lengthToDegrees:m,bearingToAzimuth:_,radiansToDegrees:v,degreesToRadians:x,convertLength:C,convertArea:w,isNumber:b,isObject:E,validateBBox:I,validateId:P,radians2degrees:function(){throw new Error("method has been renamed to `radiansToDegrees`")},degrees2radians:function(){throw new Error("method has been renamed to `degreesToRadians`")},distanceToDegrees:function(){throw new Error("method has been renamed to `lengthToDegrees`")},distanceToRadians:function(){throw new Error("method has been renamed to `lengthToRadians`")},radiansToDistance:function(){throw new Error("method has been renamed to `radiansToLength`")},bearingToAngle:function(){throw new Error("method has been renamed to `bearingToAzimuth`")},convertDistance:function(){throw new Error("method has been renamed to `convertLength`")}}),No=Object.freeze({coordEach:N,coordReduce:S,propEach:T,propReduce:L,featureEach:M,featureReduce:O,coordAll:R,geomEach:A,geomReduce:D,flattenEach:F,flattenReduce:k,segmentEach:B,segmentReduce:G,lineEach:j,lineReduce:z}),So=Object.freeze({getCoord:q,getCoords:V,containsNumber:H,geojsonType:Y,featureOf:X,collectionOf:W,getGeom:K,getGeomType:Z,getType:J}),To={successCallback:null,verbose:!1},Lo={},Mo=function t(e,n,i,r,o){for(i=i||0,r=r||e.length-1,o=o||function(t,e){return t<e?-1:t>e?1:0};r>i;){if(r-i>600){var s=r-i+1,a=n-i+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(a-s/2<0?-1:1);t(e,n,Math.max(i,Math.floor(n-a*u/s+c)),Math.min(r,Math.floor(n+(s-a)*u/s+c)),o)}var h=e[n],p=i,f=r;for(it(e,i,n),o(e[r],h)>0&&it(e,i,r);p<f;){for(it(e,p,f),p++,f--;o(e[p],h)<0;)p++;for(;o(e[f],h)>0;)f--}0===o(e[i],h)?it(e,i,f):it(e,++f,r),f<=n&&(i=f+1),n<=f&&(r=f-1)}},Oo=rt;rt.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!ft(t,e))return n;for(var r,o,s,a,l=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],ft(t,a=e.leaf?i(s):s)&&(e.leaf?n.push(s):pt(t,a)?this._all(s,n):l.push(s));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!ft(t,e))return!1;for(var i,r,o,s,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],ft(t,s=e.leaf?n(o):o)){if(e.leaf||pt(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=dt([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,s=this.data,a=this.toBBox(t),l=[],u=[];s||l.length;){if(s||(s=l.pop(),i=l[l.length-1],n=u.pop(),o=!0),s.leaf&&-1!==(r=function(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}(t,s.children,e)))return s.children.splice(r,1),l.push(s),this._condense(l),this;o||s.leaf||!pt(s,a)?i?(n++,s=i.children[n],o=!1):s=null:(l.push(s),u.push(n),n=0,i=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:lt,compareMinY:ut,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,s=this._maxEntries;if(o<=s)return ot(r=dt(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(r=dt([])).leaf=!1,r.height=i;var a,l,u,c,h=Math.ceil(o/s),p=h*Math.ceil(Math.sqrt(s));for(gt(t,e,n,p,this.compareMinX),a=e;a<=n;a+=p)for(gt(t,a,u=Math.min(a+p-1,n),h,this.compareMinY),l=a;l<=u;l+=h)c=Math.min(l+h-1,u),r.children.push(this._build(t,l,c,i-1));return ot(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,s,a,l,u,c,h;i.push(e),!e.leaf&&i.length-1!==n;){for(c=h=1/0,r=0,o=e.children.length;r<o;r++)l=ct(s=e.children[r]),(u=function(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}(t,s)-l)<h?(h=u,c=l<c?l:c,a=s):u===h&&l<c&&(c=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),at(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),s=dt(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,ot(n,this.toBBox),ot(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=dt([t,e]),this.data.height=t.height+1,this.data.leaf=!1,ot(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,s,a,l,u,c;for(l=u=1/0,i=e;i<=n-e;i++)s=function(t,e){var n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-n)*Math.max(0,o-i)}(r=st(t,0,i,this.toBBox),o=st(t,i,n,this.toBBox)),a=ct(r)+ct(o),s<l?(l=s,c=i,u=a<u?a:u):s===l&&a<u&&(u=a,c=i);return c},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:lt,r=t.leaf?this.compareMinY:ut;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,s=this.toBBox,a=st(t,0,e,s),l=st(t,n-e,n,s),u=ht(a)+ht(l);for(r=e;r<n-e;r++)o=t.children[r],at(a,t.leaf?s(o):o),u+=ht(a);for(r=n-e-1;r>=e;r--)o=t.children[r],at(l,t.leaf?s(o):o),u+=ht(l);return u},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)at(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():ot(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var Ro=function(t,e,n){var i=t*e,r=Ao*t,o=r-(r-t),s=t-o,a=Ao*e,l=a-(a-e),u=e-l,c=s*u-(i-o*l-s*l-o*u);return n?(n[0]=c,n[1]=i,n):[c,i]},Ao=+(Math.pow(2,27)+1),Do=function(t,e){var n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);return r?[r,n]:[n]}(t[0],e[0]);var r,o,s=new Array(n+i),a=0,l=0,u=0,c=Math.abs,h=t[l],p=c(h),f=e[u],d=c(f);p<d?(o=h,(l+=1)<n&&(p=c(h=t[l]))):(o=f,(u+=1)<i&&(d=c(f=e[u]))),l<n&&p<d||u>=i?(r=h,(l+=1)<n&&(p=c(h=t[l]))):(r=f,(u+=1)<i&&(d=c(f=e[u])));for(var g,y,m=r+o,_=m-r,v=o-_,x=v,C=m;l<n&&u<i;)p<d?(r=h,(l+=1)<n&&(p=c(h=t[l]))):(r=f,(u+=1)<i&&(d=c(f=e[u]))),(v=(o=x)-(_=(m=r+o)-r))&&(s[a++]=v),x=C-((g=C+m)-(y=g-C))+(m-y),C=g;for(;l<n;)(v=(o=x)-(_=(m=(r=h)+o)-r))&&(s[a++]=v),x=C-((g=C+m)-(y=g-C))+(m-y),C=g,(l+=1)<n&&(h=t[l]);for(;u<i;)(v=(o=x)-(_=(m=(r=f)+o)-r))&&(s[a++]=v),x=C-((g=C+m)-(y=g-C))+(m-y),C=g,(u+=1)<i&&(f=e[u]);return x&&(s[a++]=x),C&&(s[a++]=C),a||(s[a++]=0),s.length=a,s},Fo=function(t,e,n){var i=t+e,r=i-t,o=e-r,s=t-(i-r);return n?(n[0]=s+o,n[1]=i,n):[s+o,i]},ko=function(t,e){var n=t.length;if(1===n){var i=Ro(t[0],e);return i[0]?i:[i[1]]}var r=new Array(2*n),o=[.1,.1],s=[.1,.1],a=0;Ro(t[0],e,o),o[0]&&(r[a++]=o[0]);for(var l=1;l<n;++l){Ro(t[l],e,s);var u=o[1];Fo(u,s[0],o),o[0]&&(r[a++]=o[0]);var c=s[1],h=o[1],p=c+h,f=h-(p-c);o[1]=p,f&&(r[a++]=f)}return o[1]&&(r[a++]=o[1]),0===a&&(r[a++]=0),r.length=a,r},Bo=function(t,e){var n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);return r?[r,n]:[n]}(t[0],-e[0]);var r,o,s=new Array(n+i),a=0,l=0,u=0,c=Math.abs,h=t[l],p=c(h),f=-e[u],d=c(f);p<d?(o=h,(l+=1)<n&&(p=c(h=t[l]))):(o=f,(u+=1)<i&&(d=c(f=-e[u]))),l<n&&p<d||u>=i?(r=h,(l+=1)<n&&(p=c(h=t[l]))):(r=f,(u+=1)<i&&(d=c(f=-e[u])));for(var g,y,m=r+o,_=m-r,v=o-_,x=v,C=m;l<n&&u<i;)p<d?(r=h,(l+=1)<n&&(p=c(h=t[l]))):(r=f,(u+=1)<i&&(d=c(f=-e[u]))),(v=(o=x)-(_=(m=r+o)-r))&&(s[a++]=v),x=C-((g=C+m)-(y=g-C))+(m-y),C=g;for(;l<n;)(v=(o=x)-(_=(m=(r=h)+o)-r))&&(s[a++]=v),x=C-((g=C+m)-(y=g-C))+(m-y),C=g,(l+=1)<n&&(h=t[l]);for(;u<i;)(v=(o=x)-(_=(m=(r=f)+o)-r))&&(s[a++]=v),x=C-((g=C+m)-(y=g-C))+(m-y),C=g,(u+=1)<i&&(f=-e[u]);return x&&(s[a++]=x),C&&(s[a++]=C),a||(s[a++]=0),s.length=a,s},Go=yt((function(t){function e(t,e){for(var n=new Array(t.length-1),i=1;i<t.length;++i)for(var r=n[i-1]=new Array(t.length-1),o=0,s=0;o<t.length;++o)o!==e&&(r[s++]=t[i][o]);return n}function n(t){return 1&t?"-":""}function i(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",i(t.slice(0,e)),",",i(t.slice(e)),")"].join("")}function r(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var o=[],s=0;s<t.length;++s)o.push(["scale(",i(r(e(t,s))),",",n(s),t[0][s],")"].join(""));return o}function o(t){for(var n=[],o=[],s=function(t){for(var e=new Array(t),n=0;n<t;++n){e[n]=new Array(t);for(var i=0;i<t;++i)e[n][i]=["m",i,"[",t-n-1,"]"].join("")}return e}(t),a=[],l=0;l<t;++l)0==(1&l)?n.push.apply(n,r(e(s,l))):o.push.apply(o,r(e(s,l))),a.push("m"+l);var u=i(n),c=i(o),h="orientation"+t+"Exact",p=["function ",h,"(",a.join(),"){var p=",u,",n=",c,",d=sub(p,n);return d[d.length-1];};return ",h].join("");return new Function("sum","prod","scale","sub",p)(Do,Ro,ko,Bo)}var s=o(3),a=o(4),l=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var i,r=(t[1]-n[1])*(e[0]-n[0]),o=(t[0]-n[0])*(e[1]-n[1]),a=r-o;if(r>0){if(o<=0)return a;i=r+o}else{if(!(r<0))return a;if(o>=0)return a;i=-(r+o)}var l=33306690738754716e-32*i;return a>=l||a<=-l?a:s(t,e,n)},function(t,e,n,i){var r=t[0]-i[0],o=e[0]-i[0],s=n[0]-i[0],l=t[1]-i[1],u=e[1]-i[1],c=n[1]-i[1],h=t[2]-i[2],p=e[2]-i[2],f=n[2]-i[2],d=o*c,g=s*u,y=s*l,m=r*c,_=r*u,v=o*l,x=h*(d-g)+p*(y-m)+f*(_-v),C=7771561172376103e-31*((Math.abs(d)+Math.abs(g))*Math.abs(h)+(Math.abs(y)+Math.abs(m))*Math.abs(p)+(Math.abs(_)+Math.abs(v))*Math.abs(f));return x>C||-x>C?x:a(t,e,n,i)}];!function(){for(;l.length<=5;)l.push(o(l.length));for(var e=[],n=["slow"],i=0;i<=5;++i)e.push("a"+i),n.push("o"+i);var r=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(i=2;i<=5;++i)r.push("case ",i,":return o",i,"(",e.slice(0,i).join(),");");r.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),n.push(r.join(""));var s=Function.apply(void 0,n);for(t.exports=s.apply(void 0,[function(t){var e=l[t.length];return e||(e=l[t.length]=o(t.length)),e.apply(void 0,t)}].concat(l)),i=0;i<=5;++i)t.exports[i]=l[i]}()})),jo=function(t){var e=t.length;if(e<3){for(var n=new Array(e),i=0;i<e;++i)n[i]=i;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:n}var r=new Array(e);for(i=0;i<e;++i)r[i]=i;r.sort((function(e,n){return t[e][0]-t[n][0]||t[e][1]-t[n][1]}));var o=[r[0],r[1]],s=[r[0],r[1]];for(i=2;i<e;++i){for(var a=r[i],l=t[a],u=o.length;u>1&&zo(t[o[u-2]],t[o[u-1]],l)<=0;)u-=1,o.pop();for(o.push(a),u=s.length;u>1&&zo(t[s[u-2]],t[s[u-1]],l)>=0;)u-=1,s.pop();s.push(a)}n=new Array(s.length+o.length-2);for(var c=0,h=(i=0,o.length);i<h;++i)n[c++]=o[i];for(var p=s.length-2;p>0;--p)n[c++]=s[p];return n},zo=Go[3],Uo=mt,qo=mt;mt.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,i=e[t];t>0;){var r=t-1>>1,o=e[r];if(n(i,o)>=0)break;e[t]=o,t=r}e[t]=i},_down:function(t){for(var e=this.data,n=this.compare,i=this.length>>1,r=e[t];t<i;){var o=1+(t<<1),s=o+1,a=e[o];if(s<this.length&&n(e[s],a)<0&&(o=s,a=e[s]),n(a,r)>=0)break;e[t]=a,t=o}e[t]=r}},Uo.default=qo;var Vo=function(t,e){for(var n=t[0],i=t[1],r=!1,o=0,s=e.length-1;o<e.length;s=o++){var a=e[o][0],l=e[o][1],u=e[s][0],c=e[s][1];l>i!=c>i&&n<(u-a)*(i-l)/(c-l)+a&&(r=!r)}return r},Ho=Go[3],Yo=_t,Xo=_t;Yo.default=Xo;var Wo=function(t){return t},Ko=function(t){if(null==t)return Wo;var e,n,i=t.scale[0],r=t.scale[1],o=t.translate[0],s=t.translate[1];return function(t,a){a||(e=n=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*i+o,c[1]=(n+=t[1])*r+s;l<u;)c[l]=t[l],++l;return c}},Zo=function(t,e){for(var n,i=t.length,r=i-e;r<--i;)n=t[r],t[r++]=t[i],t[i]=n},Jo=function(t,e){function n(t,e){for(var n in t){var r=t[n];delete e[r.start],delete r.start,delete r.end,r.forEach((function(t){i[t<0?~t:t]=1})),s.push(r)}}var i={},r={},o={},s=[],a=-1;return e.forEach((function(n,i){var r,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(r=e[++a],e[a]=n,e[i]=r)})),e.forEach((function(e){var n,i,s=function(e){var n,i=t.arcs[e<0?~e:e],r=i[0];return t.transform?(n=[0,0],i.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=i[i.length-1],e<0?[n,r]:[r,n]}(e),a=s[0],l=s[1];if(n=o[a])if(delete o[n.end],n.push(e),n.end=l,i=r[l]){delete r[i.start];var u=i===n?n:n.concat(i);r[u.start=n.start]=o[u.end=i.end]=u}else r[n.start]=o[n.end]=n;else if(n=r[l])if(delete r[n.start],n.unshift(e),n.start=a,i=o[a]){delete o[i.end];var c=i===n?n:i.concat(n);r[c.start=i.start]=o[c.end=n.end]=c}else r[n.start]=o[n.end]=n;else r[(n=[e]).start=a]=o[n.end=l]=n})),n(o,r),n(r,o),e.forEach((function(t){i[t<0?~t:t]||s.push([t])})),s},Qo=function(t){return Gt(t,jt.apply(this,arguments))},$o=function(t,e,n,i,r,o){3===arguments.length&&(i=o=Array,r=null);for(var s=new i(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),a=new o(t),l=t-1,u=0;u<t;++u)s[u]=r;return{set:function(i,o){for(var u=e(i)&l,c=s[u],h=0;c!=r;){if(n(c,i))return a[u]=o;if(++h>=t)throw new Error("full hashmap");c=s[u=u+1&l]}return s[u]=i,a[u]=o,o},maybeSet:function(i,o){for(var u=e(i)&l,c=s[u],h=0;c!=r;){if(n(c,i))return a[u];if(++h>=t)throw new Error("full hashmap");c=s[u=u+1&l]}return s[u]=i,a[u]=o,o},get:function(i,o){for(var u=e(i)&l,c=s[u],h=0;c!=r;){if(n(c,i))return a[u];if(++h>=t)break;c=s[u=u+1&l]}return o},keys:function(){for(var t=[],e=0,n=s.length;e<n;++e){var i=s[e];i!=r&&t.push(i)}return t}}},ts=function(t,e){return t[0]===e[0]&&t[1]===e[1]},es=new ArrayBuffer(16),ns=new Float64Array(es),is=new Uint32Array(es),rs=function(t){ns[0]=t[0],ns[1]=t[1];var e=is[0]^is[1];return 2147483647&(e<<5^e>>7^is[2]^is[3])},os=function(t){var e,n,i,r=function(t){function e(t,e,n,i){if(p[n]!==t){p[n]=t;var r=f[n];if(r>=0){var o=d[n];r===e&&o===i||r===i&&o===e||(++y,g[n]=1)}else f[n]=e,d[n]=i}}function n(t){return rs(l[t])}function i(t,e){return ts(l[t],l[e])}var r,o,s,a,l=t.coordinates,u=t.lines,c=t.rings,h=function(){for(var t=$o(1.4*l.length,n,i,Int32Array,-1,Int32Array),e=new Int32Array(l.length),r=0,o=l.length;r<o;++r)e[r]=t.maybeSet(r,r);return e}(),p=new Int32Array(l.length),f=new Int32Array(l.length),d=new Int32Array(l.length),g=new Int8Array(l.length),y=0;for(r=0,o=l.length;r<o;++r)p[r]=f[r]=d[r]=-1;for(r=0,o=u.length;r<o;++r){var m=u[r],_=m[0],v=m[1];for(s=h[_],a=h[++_],++y,g[s]=1;++_<=v;)e(r,s,s=a,a=h[_]);++y,g[a]=1}for(r=0,o=l.length;r<o;++r)p[r]=-1;for(r=0,o=c.length;r<o;++r){var x=c[r],C=x[0]+1,w=x[1];for(e(r,h[w-1],s=h[C-1],a=h[C]);++C<=w;)e(r,s,s=a,a=h[C])}p=f=d=null;var b,E=function(t,e,n,i,r){3===arguments.length&&(i=Array,r=null);for(var o=new i(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),s=t-1,a=0;a<t;++a)o[a]=r;return{add:function(i){for(var a=e(i)&s,l=o[a],u=0;l!=r;){if(n(l,i))return!0;if(++u>=t)throw new Error("full hashset");l=o[a=a+1&s]}return o[a]=i,!0},has:function(i){for(var a=e(i)&s,l=o[a],u=0;l!=r;){if(n(l,i))return!0;if(++u>=t)break;l=o[a=a+1&s]}return!1},values:function(){for(var t=[],e=0,n=o.length;e<n;++e){var i=o[e];i!=r&&t.push(i)}return t}}}(1.4*y,rs,ts);for(r=0,o=l.length;r<o;++r)g[b=h[r]]&&E.add(l[b]);return E}(t),o=t.coordinates,s=t.lines,a=t.rings;for(n=0,i=s.length;n<i;++n)for(var l=s[n],u=l[0],c=l[1];++u<c;)r.has(o[u])&&(e={0:u,1:l[1]},l[1]=u,l=l.next=e);for(n=0,i=a.length;n<i;++n)for(var h=a[n],p=h[0],f=p,d=h[1],g=r.has(o[p]);++f<d;)r.has(o[f])&&(g?(e={0:f,1:h[1]},h[1]=f,h=h.next=e):(function(t,e,n,i){zt(t,e,n),zt(t,e,e+i),zt(t,e+i,n)}(o,p,d,d-f),o[d]=o[p],g=!0,f=p));return t},ss=function(t,e){function n(t){t&&c.hasOwnProperty(t.type)&&c[t.type](t)}function i(t){var e=[];do{var n=u.get(t);e.push(t[0]<t[1]?n:~n)}while(t=t.next);return e}function r(t){return t.map(i)}var o=function(t){function e(t){null!=t&&u.hasOwnProperty(t.type)&&u[t.type](t)}function n(t){var e=t[0],n=t[1];e<o&&(o=e),e>a&&(a=e),n<s&&(s=n),n>l&&(l=n)}function i(t){t.forEach(n)}function r(t){t.forEach(i)}var o=1/0,s=1/0,a=-1/0,l=-1/0,u={GeometryCollection:function(t){t.geometries.forEach(e)},Point:function(t){n(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(n)},LineString:function(t){i(t.arcs)},MultiLineString:function(t){t.arcs.forEach(i)},Polygon:function(t){t.arcs.forEach(i)},MultiPolygon:function(t){t.arcs.forEach(r)}};for(var c in t)e(t[c]);return a>=o&&l>=s?[o,s,a,l]:void 0}(t=function(t){var e,n={};for(e in t)n[e]=Ut(t[e]);return n}(t)),s=e>0&&o&&function(t,e,n){function i(t){return[Math.round((t[0]-u)*f),Math.round((t[1]-c)*d)]}function r(t,e){for(var n,i,r,o,s,a=-1,l=0,h=t.length,p=new Array(h);++a<h;)n=t[a],o=Math.round((n[0]-u)*f),s=Math.round((n[1]-c)*d),o===i&&s===r||(p[l++]=[i=o,r=s]);for(p.length=l;l<e;)l=p.push([p[0][0],p[0][1]]);return p}function o(t){return r(t,2)}function s(t){return r(t,4)}function a(t){return t.map(s)}function l(t){null!=t&&g.hasOwnProperty(t.type)&&g[t.type](t)}var u=e[0],c=e[1],h=e[2],p=e[3],f=h-u?(n-1)/(h-u):1,d=p-c?(n-1)/(p-c):1,g={GeometryCollection:function(t){t.geometries.forEach(l)},Point:function(t){t.coordinates=i(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(i)},LineString:function(t){t.arcs=o(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(o)},Polygon:function(t){t.arcs=a(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(a)}};for(var y in t)l(t[y]);return{scale:[1/f,1/d],translate:[u,c]}}(t,o,e),a=function(t){function e(t){var e,n,i,r,o,s,a,l;if(i=f.get(e=u[t[0]]))for(a=0,l=i.length;a<l;++a)if(function(t,e){var n=t[0],i=e[0],r=t[1];if(n-r!=i-e[1])return!1;for(;n<=r;++n,++i)if(!ts(u[n],u[i]))return!1;return!0}(r=i[a],t))return t[0]=r[0],void(t[1]=r[1]);if(o=f.get(n=u[t[1]]))for(a=0,l=o.length;a<l;++a)if(function(t,e){var n=t[0],i=e[0],r=t[1],o=e[1];if(n-r!=i-o)return!1;for(;n<=r;++n,--o)if(!ts(u[n],u[o]))return!1;return!0}(s=o[a],t))return t[1]=s[0],void(t[0]=s[1]);i?i.push(t):f.set(e,[t]),o?o.push(t):f.set(n,[t]),d.push(t)}function n(t,e){var n=t[0],i=e[0],o=t[1]-n;if(o!==e[1]-i)return!1;for(var s=r(t),a=r(e),l=0;l<o;++l)if(!ts(u[n+(l+s)%o],u[i+(l+a)%o]))return!1;return!0}function i(t,e){var n=t[0],i=e[0],o=t[1],s=e[1],a=o-n;if(a!==s-i)return!1;for(var l=r(t),c=a-r(e),h=0;h<a;++h)if(!ts(u[n+(h+l)%a],u[s-(h+c)%a]))return!1;return!0}function r(t){for(var e=t[0],n=t[1],i=e,r=i,o=u[i];++i<n;){var s=u[i];(s[0]<o[0]||s[0]===o[0]&&s[1]<o[1])&&(r=i,o=s)}return r-e}var o,s,a,l,u=t.coordinates,c=t.lines,h=t.rings,p=c.length+h.length;for(delete t.lines,delete t.rings,a=0,l=c.length;a<l;++a)for(o=c[a];o=o.next;)++p;for(a=0,l=h.length;a<l;++a)for(s=h[a];s=s.next;)++p;var f=$o(2*p*1.4,rs,ts),d=t.arcs=[];for(a=0,l=c.length;a<l;++a){o=c[a];do{e(o)}while(o=o.next)}for(a=0,l=h.length;a<l;++a)if((s=h[a]).next)do{e(s)}while(s=s.next);else!function(t){var e,o,s,a,l;if(o=f.get(u[t[0]]))for(a=0,l=o.length;a<l;++a){if(n(s=o[a],t))return t[0]=s[0],void(t[1]=s[1]);if(i(s,t))return t[0]=s[1],void(t[1]=s[0])}if(o=f.get(e=u[t[0]+r(t)]))for(a=0,l=o.length;a<l;++a){if(n(s=o[a],t))return t[0]=s[0],void(t[1]=s[1]);if(i(s,t))return t[0]=s[1],void(t[1]=s[0])}o?o.push(t):f.set(e,[t]),d.push(t)}(s);return t}(os(function(t){function e(t){t&&u.hasOwnProperty(t.type)&&u[t.type](t)}function n(t){for(var e=0,n=t.length;e<n;++e)l[++o]=t[e];var i={0:o-n+1,1:o};return s.push(i),i}function i(t){for(var e=0,n=t.length;e<n;++e)l[++o]=t[e];var i={0:o-n+1,1:o};return a.push(i),i}function r(t){return t.map(i)}var o=-1,s=[],a=[],l=[],u={GeometryCollection:function(t){t.geometries.forEach(e)},LineString:function(t){t.arcs=n(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(n)},Polygon:function(t){t.arcs=t.arcs.map(i)},MultiPolygon:function(t){t.arcs=t.arcs.map(r)}};for(var c in t)e(t[c]);return{type:"Topology",coordinates:l,lines:s,rings:a,objects:t}}(t))),l=a.coordinates,u=$o(1.4*a.arcs.length,Ht,Yt);t=a.objects,a.bbox=o,a.arcs=a.arcs.map((function(t,e){return u.set(t,e),l.slice(t[0],t[1]+1)})),delete a.coordinates,l=null;var c={GeometryCollection:function(t){t.geometries.forEach(n)},LineString:function(t){t.arcs=i(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(i)},Polygon:function(t){t.arcs=t.arcs.map(i)},MultiPolygon:function(t){t.arcs=t.arcs.map(r)}};for(var h in t)n(t[h]);return s&&(a.transform=s,a.arcs=function(t){for(var e=-1,n=t.length;++e<n;){for(var i,r,o=t[e],s=0,a=1,l=o.length,u=o[0],c=u[0],h=u[1];++s<l;)i=(u=o[s])[0],r=u[1],i===c&&r===h||(o[a++]=[i-c,r-h],c=i,h=r);1===a&&(o[a++]=[0,0]),o.length=a}return t}(a.arcs)),a},as=function(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],i=this.points[e+1];this.centers.push({x:(n.x+i.x)/2,y:(n.y+i.y)/2,z:(n.z+i.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),e=0;e<this.centers.length-1;e++){n=this.centers[e],i=this.centers[e+1];var r=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,s=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+s)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};as.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var i=0;i<this.duration;i+=10){var r=this.pos(i);Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)+(r.z-n.z)*(r.z-n.z))>t&&(e.push(i),n=r)}return e},as.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},as.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(n>=1)return this.points[this.length-1];var i=Math.floor((this.points.length-1)*n);return function(t,e,n,i,r){var o=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:r.x*o[0]+i.x*o[1]+n.x*o[2]+e.x*o[3],y:r.y*o[0]+i.y*o[1]+n.y*o[2]+e.y*o[3],z:r.z*o[0]+i.z*o[1]+n.z*o[2]+e.z*o[3]}}((this.length-1)*n-i,this.points[i],this.controls[i][1],this.controls[i+1][0],this.points[i+1])};var ls=pe,us=pe;pe.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(Pe(t,0,o,n));if(r)for(var a=0,l=e.length;a<l;a++){var u=e[a]*n,c=a<l-1?e[a+1]*n:t.length;s-=Math.abs(Pe(t,u,c,n))}var h=0;for(a=0;a<i.length;a+=3){var p=i[a]*n,f=i[a+1]*n,d=i[a+2]*n;h+=Math.abs((t[p]-t[d])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[d+1]-t[p+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},pe.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n},ls.default=us,Me.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!je(t,e))return n;for(var r,o,s,a,l=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],je(t,a=e.leaf?i(s):s)&&(e.leaf?n.push(s):Ge(t,a)?this._all(s,n):l.push(s));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!je(t,e))return!1;for(var i,r,o,s,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],je(t,s=e.leaf?n(o):o)){if(e.leaf||Ge(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=ze([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,s=this.data,a=this.toBBox(t),l=[],u=[];s||l.length;){if(s||(s=l.pop(),i=l[l.length-1],n=u.pop(),o=!0),s.leaf&&-1!==(r=function(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}(t,s.children,e)))return s.children.splice(r,1),l.push(s),this._condense(l),this;o||s.leaf||!Ge(s,a)?i?(n++,s=i.children[n],o=!1):s=null:(l.push(s),u.push(n),n=0,i=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:De,compareMinY:Fe,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,s=this._maxEntries;if(o<=s)return Oe(r=ze(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(r=ze([])).leaf=!1,r.height=i;var a,l,u,c,h=Math.ceil(o/s),p=h*Math.ceil(Math.sqrt(s));for(Ue(t,e,n,p,this.compareMinX),a=e;a<=n;a+=p)for(Ue(t,a,u=Math.min(a+p-1,n),h,this.compareMinY),l=a;l<=u;l+=h)c=Math.min(l+h-1,u),r.children.push(this._build(t,l,c,i-1));return Oe(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,s,a,l,u,c,h;i.push(e),!e.leaf&&i.length-1!==n;){for(c=h=1/0,r=0,o=e.children.length;r<o;r++)l=ke(s=e.children[r]),(u=function(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}(t,s)-l)<h?(h=u,c=l<c?l:c,a=s):u===h&&l<c&&(c=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),Ae(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),s=ze(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,Oe(n,this.toBBox),Oe(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=ze([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Oe(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,s,a,l,u,c;for(l=u=1/0,i=e;i<=n-e;i++)s=function(t,e){var n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-n)*Math.max(0,o-i)}(r=Re(t,0,i,this.toBBox),o=Re(t,i,n,this.toBBox)),a=ke(r)+ke(o),s<l?(l=s,c=i,u=a<u?a:u):s===l&&a<u&&(u=a,c=i);return c},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:De,r=t.leaf?this.compareMinY:Fe;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,s=this.toBBox,a=Re(t,0,e,s),l=Re(t,n-e,n,s),u=Be(a)+Be(l);for(r=e;r<n-e;r++)o=t.children[r],Ae(a,t.leaf?s(o):o),u+=Be(a);for(r=n-e-1;r>=e;r--)o=t.children[r],Ae(l,t.leaf?s(o):o),u+=Be(l);return u},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)Ae(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():Oe(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var cs=Object.freeze({toMercator:$e,toWgs84:tn}),hs=6378137,ps=function(t){function e(){for(var t=[],e=0;e<d.features.length;e++)-1==d.features[e].properties.parent&&t.push(e);if(t.length>1)for(e=0;e<t.length;e++){for(var n=-1,i=0;i<d.features.length;i++)t[e]!=i&&St(d.features[t[e]].geometry.coordinates[0][0],d.features[i],{ignoreBoundary:!0})&&un(d.features[i])<1/0&&(n=i);d.features[t[e]].properties.parent=n}}function n(){for(var t=0;t<d.features.length;t++)if(-1==d.features[t].properties.parent){var e=d.features[t].properties.winding;d.features[t].properties.netWinding=e,i(t,e)}}function i(t,e){for(var n=0;n<d.features.length;n++)if(d.features[n].properties.parent==t){var r=e+d.features[n].properties.winding;d.features[n].properties.netWinding=r,i(n,r)}}if("Feature"!=t.type)throw new Error("The input must a geojson object of type Feature");if(void 0===t.geometry||null==t.geometry)throw new Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=t.geometry.type)throw new Error("The input must be a geojson Polygon");for(var r=t.geometry.coordinates.length,s=[],a=0;a<r;a++){var l=t.geometry.coordinates[a];bn(l[0],l[l.length-1])||l.push(l[0]),s.push.apply(s,l.slice(0,l.length-1))}if(!function(t){for(var e={},n=1,i=0,r=t.length;i<r;++i){if(e.hasOwnProperty(t[i])){n=0;break}e[t[i]]=1}return n}(s))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var c=s.length,h=function(t,e,n){function i(t,n,i,r){var l,u,c=o[t][n],h=o[t][n+1],p=o[i][r],f=o[i][r+1],d=function(t,e,n,i){if(Cn(t,n)||Cn(t,i)||Cn(e,n)||Cn(i,n))return null;var r=t[0],o=t[1],s=e[0],a=e[1],l=n[0],u=n[1],c=i[0],h=i[1],p=(r-s)*(u-h)-(o-a)*(l-c);return 0===p?null:[((r*a-o*s)*(l-c)-(r-s)*(l*h-u*c))/p,((r*a-o*s)*(u-h)-(o-a)*(l*h-u*c))/p]}(c,h,p,f);if(null!==d&&(l=h[0]!==c[0]?(d[0]-c[0])/(h[0]-c[0]):(d[1]-c[1])/(h[1]-c[1]),u=f[0]!==p[0]?(d[0]-p[0])/(f[0]-p[0]):(d[1]-p[1])/(f[1]-p[1]),!(l>=1||l<=0||u>=1||u<=0))){var g=d,y=!a[g];y&&(a[g]=!0),e?s.push(e(d,t,n,c,h,l,i,r,p,f,u,y)):s.push(d)}}function r(t,e){var n,i,r,s,a=o[t][e],l=o[t][e+1];return a[0]<l[0]?(n=a[0],i=l[0]):(n=l[0],i=a[0]),a[1]<l[1]?(r=a[1],s=l[1]):(r=l[1],s=a[1]),{minX:n,minY:r,maxX:i,maxY:s,ring:t,edge:e}}if("Polygon"!==t.geometry.type)throw new Error("The input feature must be a Polygon");void 0===n&&(n=1);var o=t.geometry.coordinates,s=[],a={};if(n){for(var l=[],u=0;u<o.length;u++)for(var c=0;c<o[u].length-1;c++)l.push(r(u,c));var h=Oo();h.load(l)}for(var p=0;p<o.length;p++)for(var f=0;f<o[p].length-1;f++)if(n)h.search(r(p,f)).forEach((function(t){var e=t.ring,n=t.edge;i(p,f,e,n)}));else for(var d=0;d<o.length;d++)for(var g=0;g<o[d].length-1;g++)i(p,f,d,g);return e||(s={type:"Feature",geometry:{type:"MultiPoint",coordinates:s}}),s}(t,(function(t,e,n,i,r,o,s,a,l,u,c,h){return[t,e,n,i,r,o,s,a,l,u,c,h]})),p=h.length;if(0==p){var f=[];for(a=0;a<r;a++)f.push(o([t.geometry.coordinates[a]],{parent:-1,winding:function(t){for(var e=0,n=0;n<t.length-1;n++)t[n][0]<t[e][0]&&(e=n);if(wn([t[(e-1).modulo(t.length-1)],t[e],t[(e+1).modulo(t.length-1)]],!0))var i=1;else i=-1;return i}(t.geometry.coordinates[a])}));var d=u(f);return e(),n(),d}var g=[],y=[];for(a=0;a<r;a++){g.push([]);for(var m=0;m<t.geometry.coordinates[a].length-1;m++)g[a].push([new fs(t.geometry.coordinates[a][(m+1).modulo(t.geometry.coordinates[a].length-1)],1,[a,m],[a,(m+1).modulo(t.geometry.coordinates[a].length-1)],void 0)]),y.push(new ds(t.geometry.coordinates[a][m],[a,(m-1).modulo(t.geometry.coordinates[a].length-1)],[a,m],void 0,void 0,!1,!0))}for(a=0;a<p;a++)g[h[a][1]][h[a][2]].push(new fs(h[a][0],h[a][5],[h[a][1],h[a][2]],[h[a][6],h[a][7]],void 0)),h[a][11]&&y.push(new ds(h[a][0],[h[a][1],h[a][2]],[h[a][6],h[a][7]],void 0,void 0,!0,!0));var _=y.length;for(a=0;a<g.length;a++)for(m=0;m<g[a].length;m++)g[a][m].sort((function(t,e){return t.param<e.param?-1:1}));var v=[];for(a=0;a<_;a++)v.push({minX:y[a].coord[0],minY:y[a].coord[1],maxX:y[a].coord[0],maxY:y[a].coord[1],index:a});var x=Oo();for(x.load(v),a=0;a<g.length;a++)for(m=0;m<g[a].length;m++)for(var C=0;C<g[a][m].length;C++){b=C==g[a][m].length-1?g[a][(m+1).modulo(t.geometry.coordinates[a].length-1)][0].coord:g[a][m][C+1].coord;var w=x.search({minX:b[0],minY:b[1],maxX:b[0],maxY:b[1]})[0];g[a][m][C].nxtIsectAlongEdgeIn=w.index}for(a=0;a<g.length;a++)for(m=0;m<g[a].length;m++)for(C=0;C<g[a][m].length;C++){var b=g[a][m][C].coord,E=(w=x.search({minX:b[0],minY:b[1],maxX:b[0],maxY:b[1]})[0]).index;E<c?y[E].nxtIsectAlongRingAndEdge2=g[a][m][C].nxtIsectAlongEdgeIn:bn(y[E].ringAndEdge1,g[a][m][C].ringAndEdgeIn)?y[E].nxtIsectAlongRingAndEdge1=g[a][m][C].nxtIsectAlongEdgeIn:y[E].nxtIsectAlongRingAndEdge2=g[a][m][C].nxtIsectAlongEdgeIn}var I=[];for(a=0,m=0;m<r;m++){var P=a;for(C=0;C<t.geometry.coordinates[m].length-1;C++)y[a].coord[0]<y[P].coord[0]&&(P=a),a++;var N=y[P].nxtIsectAlongRingAndEdge2;for(C=0;C<y.length;C++)if(y[C].nxtIsectAlongRingAndEdge1==P||y[C].nxtIsectAlongRingAndEdge2==P){var S=C;break}var T=wn([y[S].coord,y[P].coord,y[N].coord],!0)?1:-1;I.push({isect:P,parent:-1,winding:T})}for(I.sort((function(t,e){return y[t.isect].coord>y[e.isect].coord?-1:1})),f=[];I.length>0;){var L=I.pop(),M=L.isect,O=L.parent,R=L.winding,A=f.length,D=[y[M].coord],F=M;if(y[M].ringAndEdge1Walkable)var k=y[M].ringAndEdge1,B=y[M].nxtIsectAlongRingAndEdge1;else k=y[M].ringAndEdge2,B=y[M].nxtIsectAlongRingAndEdge2;for(;!bn(y[M].coord,y[B].coord);){D.push(y[B].coord);var G=void 0;for(a=0;a<I.length;a++)if(I[a].isect==B){G=a;break}if(null!=G&&I.splice(G,1),bn(k,y[B].ringAndEdge1)){if(k=y[B].ringAndEdge2,y[B].ringAndEdge2Walkable=!1,y[B].ringAndEdge1Walkable){var j={isect:B};wn([y[F].coord,y[B].coord,y[y[B].nxtIsectAlongRingAndEdge2].coord],1==R)?(j.parent=O,j.winding=-R):(j.parent=A,j.winding=R),I.push(j)}F=B,B=y[B].nxtIsectAlongRingAndEdge2}else k=y[B].ringAndEdge1,y[B].ringAndEdge1Walkable=!1,y[B].ringAndEdge2Walkable&&(j={isect:B},wn([y[F].coord,y[B].coord,y[y[B].nxtIsectAlongRingAndEdge1].coord],1==R)?(j.parent=O,j.winding=-R):(j.parent=A,j.winding=R),I.push(j)),F=B,B=y[B].nxtIsectAlongRingAndEdge1}D.push(y[B].coord),f.push(o([D],{index:A,parent:O,winding:R,netWinding:void 0}))}return d=u(f),e(),n(),d},fs=function(t,e,n,i,r){this.coord=t,this.param=e,this.ringAndEdgeIn=n,this.ringAndEdgeOut=i,this.nxtIsectAlongEdgeIn=r},ds=function(t,e,n,i,r,o,s){this.coord=t,this.ringAndEdge1=e,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=i,this.nxtIsectAlongRingAndEdge2=r,this.ringAndEdge1Walkable=o,this.ringAndEdge2Walkable=s};Number.prototype.modulo=function(t){return(this%t+t)%t};var gs=Math.PI/180,ys=180/Math.PI,ms=function(t,e){this.lon=t,this.lat=e,this.x=gs*t,this.y=gs*e};ms.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},ms.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new ms(e,t)};var _s=function(){this.coords=[],this.length=0};_s.prototype.move_to=function(t){this.length++,this.coords.push(t)};var vs=function(t){this.properties=t||{},this.geometries=[]};vs.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},vs.prototype.wkt=function(){for(var t="",e="LINESTRING(",n=function(t){e+=t[0]+" "+t[1]+","},i=0;i<this.geometries.length;i++){if(0===this.geometries[i].coords.length)return"LINESTRING(empty)";this.geometries[i].coords.forEach(n),t+=e.substring(0,e.length-1)+")"}return t};var xs=function(t,e,n){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new ms(t.x,t.y),this.end=new ms(e.x,e.y),this.properties=n||{};var i=this.start.x-this.end.x,r=this.start.y-this.end.y,o=Math.pow(Math.sin(r/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(i/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};xs.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),n=Math.sin(t*this.g)/Math.sin(this.g),i=e*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),r=e*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),o=e*Math.sin(this.start.y)+n*Math.sin(this.end.y),s=ys*Math.atan2(o,Math.sqrt(Math.pow(i,2)+Math.pow(r,2)));return[ys*Math.atan2(r,i),s]},xs.prototype.Arc=function(t,e){var n=[];if(!t||t<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var i=1/(t-1),r=0;r<t;++r){var o=i*r,s=this.interpolate(o);n.push(s)}for(var a=!1,l=0,u=e&&e.offset?e.offset:10,c=180-u,h=-180+u,p=360-u,f=1;f<n.length;++f){var d=n[f-1][0],g=n[f][0],y=Math.abs(g-d);y>p&&(g>c&&d<h||d>c&&g<h)?a=!0:y>l&&(l=y)}var m=[];if(a&&l<u){var _=[];m.push(_);for(var v=0;v<n.length;++v){var x=parseFloat(n[v][0]);if(v>0&&Math.abs(x-n[v-1][0])>p){var C=parseFloat(n[v-1][0]),w=parseFloat(n[v-1][1]),b=parseFloat(n[v][0]),E=parseFloat(n[v][1]);if(C>-180&&C<h&&180===b&&v+1<n.length&&n[v-1][0]>-180&&n[v-1][0]<h){_.push([-180,n[v][1]]),v++,_.push([n[v][0],n[v][1]]);continue}if(C>c&&C<180&&-180===b&&v+1<n.length&&n[v-1][0]>c&&n[v-1][0]<180){_.push([180,n[v][1]]),v++,_.push([n[v][0],n[v][1]]);continue}if(C<h&&b>c){var I=C;C=b,b=I;var P=w;w=E,E=P}if(C>c&&b<h&&(b+=360),C<=180&&b>=180&&C<b){var N=(180-C)/(b-C),S=N*E+(1-N)*w;_.push([n[v-1][0]>c?180:-180,S]),(_=[]).push([n[v-1][0]>c?-180:180,S]),m.push(_)}else _=[],m.push(_);_.push([x,n[v][1]])}else _.push([n[v][0],n[v][1]])}}else{var T=[];m.push(T);for(var L=0;L<n.length;++L)T.push([n[L][0],n[L][1]])}for(var M=new vs(this.properties),O=0;O<m.length;++O){var R=new _s;M.geometries.push(R);for(var A=m[O],D=0;D<A.length;++D)R.move_to(A[D])}return M};var Cs=Dn;Dn.polyline=Dn,Dn.polygon=function(t,e){var n,i,r,o,s,a,l;for(i=1;i<=8;i*=2){for(n=[],o=!(kn(r=t[t.length-1],e)&i),s=0;s<t.length;s++)(l=!(kn(a=t[s],e)&i))!==o&&n.push(Fn(r,a,i,e)),l&&n.push(a),r=a,o=l;if(!(t=n).length)break}return n};var ws=Array.prototype.slice,bs={successCallback:null,verbose:!1,polygons:!1},Es={},Is=64,Ps=16,Ns=4,Ss=1,Ts=[],Ls=[],Ms=[],Os=[],Rs=[],As=[],Ds=[],Fs=[],ks=[],Bs=[],Gs=[],js=[],zs=[],Us=[],qs=[],Vs=[],Hs=[],Ys=[],Xs=[],Ws=[],Ks=[],Zs=[],Js=[],Qs=[];Ds[85]=Bs[85]=-1,Fs[85]=Gs[85]=0,ks[85]=js[85]=1,Xs[85]=Zs[85]=1,Ws[85]=Js[85]=0,Ks[85]=Qs[85]=1,Ts[85]=Os[85]=0,Ls[85]=Rs[85]=-1,Ms[85]=qs[85]=0,Vs[85]=zs[85]=0,Hs[85]=Us[85]=1,As[85]=Ys[85]=1,Zs[1]=Zs[169]=0,Js[1]=Js[169]=-1,Qs[1]=Qs[169]=0,zs[1]=zs[169]=-1,Us[1]=Us[169]=0,qs[1]=qs[169]=0,Bs[4]=Bs[166]=0,Gs[4]=Gs[166]=-1,js[4]=js[166]=1,Vs[4]=Vs[166]=1,Hs[4]=Hs[166]=0,Ys[4]=Ys[166]=0,Ds[16]=Ds[154]=0,Fs[16]=Fs[154]=1,ks[16]=ks[154]=1,Os[16]=Os[154]=1,Rs[16]=Rs[154]=0,As[16]=As[154]=1,Xs[64]=Xs[106]=0,Ws[64]=Ws[106]=1,Ks[64]=Ks[106]=0,Ts[64]=Ts[106]=-1,Ls[64]=Ls[106]=0,Ms[64]=Ms[106]=1,Xs[2]=Xs[168]=0,Ws[2]=Ws[168]=-1,Ks[2]=Ks[168]=1,Zs[2]=Zs[168]=0,Js[2]=Js[168]=-1,Qs[2]=Qs[168]=0,zs[2]=zs[168]=-1,Us[2]=Us[168]=0,qs[2]=qs[168]=0,Vs[2]=Vs[168]=-1,Hs[2]=Hs[168]=0,Ys[2]=Ys[168]=1,Ds[8]=Ds[162]=0,Fs[8]=Fs[162]=-1,ks[8]=ks[162]=0,Bs[8]=Bs[162]=0,Gs[8]=Gs[162]=-1,js[8]=js[162]=1,zs[8]=zs[162]=1,Us[8]=Us[162]=0,qs[8]=qs[162]=1,Vs[8]=Vs[162]=1,Hs[8]=Hs[162]=0,Ys[8]=Ys[162]=0,Ds[32]=Ds[138]=0,Fs[32]=Fs[138]=1,ks[32]=ks[138]=1,Bs[32]=Bs[138]=0,Gs[32]=Gs[138]=1,js[32]=js[138]=0,Ts[32]=Ts[138]=1,Ls[32]=Ls[138]=0,Ms[32]=Ms[138]=0,Os[32]=Os[138]=1,Rs[32]=Rs[138]=0,As[32]=As[138]=1,Zs[128]=Zs[42]=0,Js[128]=Js[42]=1,Qs[128]=Qs[42]=1,Xs[128]=Xs[42]=0,Ws[128]=Ws[42]=1,Ks[128]=Ks[42]=0,Ts[128]=Ts[42]=-1,Ls[128]=Ls[42]=0,Ms[128]=Ms[42]=1,Os[128]=Os[42]=-1,Rs[128]=Rs[42]=0,As[128]=As[42]=0,Bs[5]=Bs[165]=-1,Gs[5]=Gs[165]=0,js[5]=js[165]=0,Zs[5]=Zs[165]=1,Js[5]=Js[165]=0,Qs[5]=Qs[165]=0,Vs[20]=Vs[150]=0,Hs[20]=Hs[150]=1,Ys[20]=Ys[150]=1,Os[20]=Os[150]=0,Rs[20]=Rs[150]=-1,As[20]=As[150]=1,Ds[80]=Ds[90]=-1,Fs[80]=Fs[90]=0,ks[80]=ks[90]=1,Xs[80]=Xs[90]=1,Ws[80]=Ws[90]=0,Ks[80]=Ks[90]=1,zs[65]=zs[105]=0,Us[65]=Us[105]=1,qs[65]=qs[105]=0,Ts[65]=Ts[105]=0,Ls[65]=Ls[105]=-1,Ms[65]=Ms[105]=0,Ds[160]=Ds[10]=-1,Fs[160]=Fs[10]=0,ks[160]=ks[10]=1,Bs[160]=Bs[10]=-1,Gs[160]=Gs[10]=0,js[160]=js[10]=0,Zs[160]=Zs[10]=1,Js[160]=Js[10]=0,Qs[160]=Qs[10]=0,Xs[160]=Xs[10]=1,Ws[160]=Ws[10]=0,Ks[160]=Ks[10]=1,Vs[130]=Vs[40]=0,Hs[130]=Hs[40]=1,Ys[130]=Ys[40]=1,zs[130]=zs[40]=0,Us[130]=Us[40]=1,qs[130]=qs[40]=0,Ts[130]=Ts[40]=0,Ls[130]=Ls[40]=-1,Ms[130]=Ms[40]=0,Os[130]=Os[40]=0,Rs[130]=Rs[40]=-1,As[130]=As[40]=1,Bs[37]=Bs[133]=0,Gs[37]=Gs[133]=1,js[37]=js[133]=1,Zs[37]=Zs[133]=0,Js[37]=Js[133]=1,Qs[37]=Qs[133]=0,Ts[37]=Ts[133]=-1,Ls[37]=Ls[133]=0,Ms[37]=Ms[133]=0,Os[37]=Os[133]=1,Rs[37]=Rs[133]=0,As[37]=As[133]=0,Vs[148]=Vs[22]=-1,Hs[148]=Hs[22]=0,Ys[148]=Ys[22]=0,Zs[148]=Zs[22]=0,Js[148]=Js[22]=-1,Qs[148]=Qs[22]=1,Xs[148]=Xs[22]=0,Ws[148]=Ws[22]=1,Ks[148]=Ks[22]=1,Os[148]=Os[22]=-1,Rs[148]=Rs[22]=0,As[148]=As[22]=1,Ds[82]=Ds[88]=0,Fs[82]=Fs[88]=-1,ks[82]=ks[88]=1,Vs[82]=Vs[88]=1,Hs[82]=Hs[88]=0,Ys[82]=Ys[88]=1,zs[82]=zs[88]=-1,Us[82]=Us[88]=0,qs[82]=qs[88]=1,Xs[82]=Xs[88]=0,Ws[82]=Ws[88]=-1,Ks[82]=Ks[88]=0,Ds[73]=Ds[97]=0,Fs[73]=Fs[97]=1,ks[73]=ks[97]=0,Bs[73]=Bs[97]=0,Gs[73]=Gs[97]=-1,js[73]=js[97]=0,zs[73]=zs[97]=1,Us[73]=Us[97]=0,qs[73]=qs[97]=0,Ts[73]=Ts[97]=1,Ls[73]=Ls[97]=0,Ms[73]=Ms[97]=1,Ds[145]=Ds[25]=0,Fs[145]=Fs[25]=-1,ks[145]=ks[25]=0,zs[145]=zs[25]=1,Us[145]=Us[25]=0,qs[145]=qs[25]=1,Zs[145]=Zs[25]=0,Js[145]=Js[25]=1,Qs[145]=Qs[25]=1,Os[145]=Os[25]=-1,Rs[145]=Rs[25]=0,As[145]=As[25]=0,Bs[70]=Bs[100]=0,Gs[70]=Gs[100]=1,js[70]=js[100]=0,Vs[70]=Vs[100]=-1,Hs[70]=Hs[100]=0,Ys[70]=Ys[100]=1,Xs[70]=Xs[100]=0,Ws[70]=Ws[100]=-1,Ks[70]=Ks[100]=1,Ts[70]=Ts[100]=1,Ls[70]=Ls[100]=0,Ms[70]=Ms[100]=0,Bs[101]=Bs[69]=0,Gs[101]=Gs[69]=1,js[101]=js[69]=0,Ts[101]=Ts[69]=1,Ls[101]=Ls[69]=0,Ms[101]=Ms[69]=0,Zs[149]=Zs[21]=0,Js[149]=Js[21]=1,Qs[149]=Qs[21]=1,Os[149]=Os[21]=-1,Rs[149]=Rs[21]=0,As[149]=As[21]=0,Vs[86]=Vs[84]=-1,Hs[86]=Hs[84]=0,Ys[86]=Ys[84]=1,Xs[86]=Xs[84]=0,Ws[86]=Ws[84]=-1,Ks[86]=Ks[84]=1,Ds[89]=Ds[81]=0,Fs[89]=Fs[81]=-1,ks[89]=ks[81]=0,zs[89]=zs[81]=1,Us[89]=Us[81]=0,qs[89]=qs[81]=1,Ds[96]=Ds[74]=0,Fs[96]=Fs[74]=1,ks[96]=ks[74]=0,Bs[96]=Bs[74]=-1,Gs[96]=Gs[74]=0,js[96]=js[74]=1,Xs[96]=Xs[74]=1,Ws[96]=Ws[74]=0,Ks[96]=Ks[74]=0,Ts[96]=Ts[74]=1,Ls[96]=Ls[74]=0,Ms[96]=Ms[74]=1,Ds[24]=Ds[146]=0,Fs[24]=Fs[146]=-1,ks[24]=ks[146]=1,Vs[24]=Vs[146]=1,Hs[24]=Hs[146]=0,Ys[24]=Ys[146]=1,zs[24]=zs[146]=0,Us[24]=Us[146]=1,qs[24]=qs[146]=1,Os[24]=Os[146]=0,Rs[24]=Rs[146]=-1,As[24]=As[146]=0,Bs[6]=Bs[164]=-1,Gs[6]=Gs[164]=0,js[6]=js[164]=1,Vs[6]=Vs[164]=-1,Hs[6]=Hs[164]=0,Ys[6]=Ys[164]=0,Zs[6]=Zs[164]=0,Js[6]=Js[164]=-1,Qs[6]=Qs[164]=1,Xs[6]=Xs[164]=1,Ws[6]=Ws[164]=0,Ks[6]=Ks[164]=0,zs[129]=zs[41]=0,Us[129]=Us[41]=1,qs[129]=qs[41]=1,Zs[129]=Zs[41]=0,Js[129]=Js[41]=1,Qs[129]=Qs[41]=0,Ts[129]=Ts[41]=-1,Ls[129]=Ls[41]=0,Ms[129]=Ms[41]=0,Os[129]=Os[41]=0,Rs[129]=Rs[41]=-1,As[129]=As[41]=0,Vs[66]=Vs[104]=0,Hs[66]=Hs[104]=1,Ys[66]=Ys[104]=0,zs[66]=zs[104]=-1,Us[66]=Us[104]=0,qs[66]=qs[104]=1,Xs[66]=Xs[104]=0,Ws[66]=Ws[104]=-1,Ks[66]=Ks[104]=0,Ts[66]=Ts[104]=0,Ls[66]=Ls[104]=-1,Ms[66]=Ms[104]=1,Ds[144]=Ds[26]=-1,Fs[144]=Fs[26]=0,ks[144]=ks[26]=0,Zs[144]=Zs[26]=1,Js[144]=Js[26]=0,Qs[144]=Qs[26]=1,Xs[144]=Xs[26]=0,Ws[144]=Ws[26]=1,Ks[144]=Ks[26]=1,Os[144]=Os[26]=-1,Rs[144]=Rs[26]=0,As[144]=As[26]=1,Bs[36]=Bs[134]=0,Gs[36]=Gs[134]=1,js[36]=js[134]=1,Vs[36]=Vs[134]=0,Hs[36]=Hs[134]=1,Ys[36]=Ys[134]=0,Ts[36]=Ts[134]=0,Ls[36]=Ls[134]=-1,Ms[36]=Ms[134]=1,Os[36]=Os[134]=1,Rs[36]=Rs[134]=0,As[36]=As[134]=0,Ds[9]=Ds[161]=-1,Fs[9]=Fs[161]=0,ks[9]=ks[161]=0,Bs[9]=Bs[161]=0,Gs[9]=Gs[161]=-1,js[9]=js[161]=0,zs[9]=zs[161]=1,Us[9]=Us[161]=0,qs[9]=qs[161]=0,Zs[9]=Zs[161]=1,Js[9]=Js[161]=0,Qs[9]=Qs[161]=1,Ds[136]=0,Fs[136]=1,ks[136]=1,Bs[136]=0,Gs[136]=1,js[136]=0,Vs[136]=-1,Hs[136]=0,Ys[136]=1,zs[136]=-1,Us[136]=0,qs[136]=0,Zs[136]=0,Js[136]=-1,Qs[136]=0,Xs[136]=0,Ws[136]=-1,Ks[136]=1,Ts[136]=1,Ls[136]=0,Ms[136]=0,Os[136]=1,Rs[136]=0,As[136]=1,Ds[34]=0,Fs[34]=-1,ks[34]=0,Bs[34]=0,Gs[34]=-1,js[34]=1,Vs[34]=1,Hs[34]=0,Ys[34]=0,zs[34]=1,Us[34]=0,qs[34]=1,Zs[34]=0,Js[34]=1,Qs[34]=1,Xs[34]=0,Ws[34]=1,Ks[34]=0,Ts[34]=-1,Ls[34]=0,Ms[34]=1,Os[34]=-1,Rs[34]=0,As[34]=0,Ds[35]=0,Fs[35]=1,ks[35]=1,Bs[35]=0,Gs[35]=-1,js[35]=1,Vs[35]=1,Hs[35]=0,Ys[35]=0,zs[35]=-1,Us[35]=0,qs[35]=0,Zs[35]=0,Js[35]=-1,Qs[35]=0,Xs[35]=0,Ws[35]=1,Ks[35]=0,Ts[35]=-1,Ls[35]=0,Ms[35]=1,Os[35]=1,Rs[35]=0,As[35]=1,Ds[153]=0,Fs[153]=1,ks[153]=1,zs[153]=-1,Us[153]=0,qs[153]=0,Zs[153]=0,Js[153]=-1,Qs[153]=0,Os[153]=1,Rs[153]=0,As[153]=1,Bs[102]=0,Gs[102]=-1,js[102]=1,Vs[102]=1,Hs[102]=0,Ys[102]=0,Xs[102]=0,Ws[102]=1,Ks[102]=0,Ts[102]=-1,Ls[102]=0,Ms[102]=1,Ds[155]=0,Fs[155]=-1,ks[155]=0,zs[155]=1,Us[155]=0,qs[155]=1,Zs[155]=0,Js[155]=1,Qs[155]=1,Os[155]=-1,Rs[155]=0,As[155]=0,Bs[103]=0,Gs[103]=1,js[103]=0,Vs[103]=-1,Hs[103]=0,Ys[103]=1,Xs[103]=0,Ws[103]=-1,Ks[103]=1,Ts[103]=1,Ls[103]=0,Ms[103]=0,Ds[152]=0,Fs[152]=1,ks[152]=1,Vs[152]=-1,Hs[152]=0,Ys[152]=1,zs[152]=-1,Us[152]=0,qs[152]=0,Zs[152]=0,Js[152]=-1,Qs[152]=0,Xs[152]=0,Ws[152]=-1,Ks[152]=1,Os[152]=1,Rs[152]=0,As[152]=1,Ds[156]=0,Fs[156]=-1,ks[156]=1,Vs[156]=1,Hs[156]=0,Ys[156]=1,zs[156]=-1,Us[156]=0,qs[156]=0,Zs[156]=0,Js[156]=-1,Qs[156]=0,Xs[156]=0,Ws[156]=1,Ks[156]=1,Os[156]=-1,Rs[156]=0,As[156]=1,Ds[137]=0,Fs[137]=1,ks[137]=1,Bs[137]=0,Gs[137]=1,js[137]=0,zs[137]=-1,Us[137]=0,qs[137]=0,Zs[137]=0,Js[137]=-1,Qs[137]=0,Ts[137]=1,Ls[137]=0,Ms[137]=0,Os[137]=1,Rs[137]=0,As[137]=1,Ds[139]=0,Fs[139]=1,ks[139]=1,Bs[139]=0,Gs[139]=-1,js[139]=0,zs[139]=1,Us[139]=0,qs[139]=0,Zs[139]=0,Js[139]=1,Qs[139]=0,Ts[139]=-1,Ls[139]=0,Ms[139]=0,Os[139]=1,Rs[139]=0,As[139]=1,Ds[98]=0,Fs[98]=-1,ks[98]=0,Bs[98]=0,Gs[98]=-1,js[98]=1,Vs[98]=1,Hs[98]=0,Ys[98]=0,zs[98]=1,Us[98]=0,qs[98]=1,Xs[98]=0,Ws[98]=1,Ks[98]=0,Ts[98]=-1,Ls[98]=0,Ms[98]=1,Ds[99]=0,Fs[99]=1,ks[99]=0,Bs[99]=0,Gs[99]=-1,js[99]=1,Vs[99]=1,Hs[99]=0,Ys[99]=0,zs[99]=-1,Us[99]=0,qs[99]=1,Xs[99]=0,Ws[99]=-1,Ks[99]=0,Ts[99]=1,Ls[99]=0,Ms[99]=1,Bs[38]=0,Gs[38]=-1,js[38]=1,Vs[38]=1,Hs[38]=0,Ys[38]=0,Zs[38]=0,Js[38]=1,Qs[38]=1,Xs[38]=0,Ws[38]=1,Ks[38]=0,Ts[38]=-1,Ls[38]=0,Ms[38]=1,Os[38]=-1,Rs[38]=0,As[38]=0,Bs[39]=0,Gs[39]=1,js[39]=1,Vs[39]=-1,Hs[39]=0,Ys[39]=0,Zs[39]=0,Js[39]=-1,Qs[39]=1,Xs[39]=0,Ws[39]=1,Ks[39]=0,Ts[39]=-1,Ls[39]=0,Ms[39]=1,Os[39]=1,Rs[39]=0,As[39]=0;var $s=function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},ta=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},ea=function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},na=function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},ia=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},ra=function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},oa=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},sa=function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},aa=[],la=[],ua=[],ca=[],ha=[],pa=[],fa=[],da=[];ca[1]=ha[1]=18,ca[169]=ha[169]=18,ua[4]=la[4]=12,ua[166]=la[166]=12,aa[16]=da[16]=4,aa[154]=da[154]=4,pa[64]=fa[64]=22,pa[106]=fa[106]=22,ua[2]=pa[2]=17,ca[2]=ha[2]=18,ua[168]=pa[168]=17,ca[168]=ha[168]=18,aa[8]=ca[8]=9,la[8]=ua[8]=12,aa[162]=ca[162]=9,la[162]=ua[162]=12,aa[32]=da[32]=4,la[32]=fa[32]=1,aa[138]=da[138]=4,la[138]=fa[138]=1,ha[128]=da[128]=21,pa[128]=fa[128]=22,ha[42]=da[42]=21,pa[42]=fa[42]=22,la[5]=ha[5]=14,la[165]=ha[165]=14,ua[20]=da[20]=6,ua[150]=da[150]=6,aa[80]=pa[80]=11,aa[90]=pa[90]=11,ca[65]=fa[65]=3,ca[105]=fa[105]=3,aa[160]=pa[160]=11,la[160]=ha[160]=14,aa[10]=pa[10]=11,la[10]=ha[10]=14,ua[130]=da[130]=6,ca[130]=fa[130]=3,ua[40]=da[40]=6,ca[40]=fa[40]=3,la[101]=fa[101]=1,la[69]=fa[69]=1,ha[149]=da[149]=21,ha[21]=da[21]=21,ua[86]=pa[86]=17,ua[84]=pa[84]=17,aa[89]=ca[89]=9,aa[81]=ca[81]=9,aa[96]=fa[96]=0,la[96]=pa[96]=15,aa[74]=fa[74]=0,la[74]=pa[74]=15,aa[24]=ua[24]=8,ca[24]=da[24]=7,aa[146]=ua[146]=8,ca[146]=da[146]=7,la[6]=pa[6]=15,ua[6]=ha[6]=16,la[164]=pa[164]=15,ua[164]=ha[164]=16,ca[129]=da[129]=7,ha[129]=fa[129]=20,ca[41]=da[41]=7,ha[41]=fa[41]=20,ua[66]=fa[66]=2,ca[66]=pa[66]=19,ua[104]=fa[104]=2,ca[104]=pa[104]=19,aa[144]=ha[144]=10,pa[144]=da[144]=23,aa[26]=ha[26]=10,pa[26]=da[26]=23,la[36]=da[36]=5,ua[36]=fa[36]=2,la[134]=da[134]=5,ua[134]=fa[134]=2,aa[9]=ha[9]=10,la[9]=ca[9]=13,aa[161]=ha[161]=10,la[161]=ca[161]=13,la[37]=da[37]=5,ha[37]=fa[37]=20,la[133]=da[133]=5,ha[133]=fa[133]=20,ua[148]=ha[148]=16,pa[148]=da[148]=23,ua[22]=ha[22]=16,pa[22]=da[22]=23,aa[82]=ua[82]=8,ca[82]=pa[82]=19,aa[88]=ua[88]=8,ca[88]=pa[88]=19,aa[73]=fa[73]=0,la[73]=ca[73]=13,aa[97]=fa[97]=0,la[97]=ca[97]=13,aa[145]=ca[145]=9,ha[145]=da[145]=21,aa[25]=ca[25]=9,ha[25]=da[25]=21,la[70]=fa[70]=1,ua[70]=pa[70]=17,la[100]=fa[100]=1,ua[100]=pa[100]=17,aa[34]=ca[34]=9,la[34]=ua[34]=12,ha[34]=da[34]=21,pa[34]=fa[34]=22,aa[136]=da[136]=4,la[136]=fa[136]=1,ua[136]=pa[136]=17,ca[136]=ha[136]=18,aa[35]=da[35]=4,la[35]=ua[35]=12,ca[35]=ha[35]=18,pa[35]=fa[35]=22,aa[153]=da[153]=4,ca[153]=ha[153]=18,la[102]=ua[102]=12,pa[102]=fa[102]=22,aa[155]=ca[155]=9,ha[155]=da[155]=23,la[103]=fa[103]=1,ua[103]=pa[103]=17,aa[152]=da[152]=4,ua[152]=pa[152]=17,ca[152]=ha[152]=18,aa[156]=ua[156]=8,ca[156]=ha[156]=18,pa[156]=da[156]=23,aa[137]=da[137]=4,la[137]=fa[137]=1,ca[137]=ha[137]=18,aa[139]=da[139]=4,la[139]=ca[139]=13,ha[139]=fa[139]=20,aa[98]=ca[98]=9,la[98]=ua[98]=12,pa[98]=fa[98]=22,aa[99]=fa[99]=0,la[99]=ua[99]=12,ca[99]=pa[99]=19,la[38]=ua[38]=12,ha[38]=da[38]=21,pa[38]=fa[38]=22,la[39]=da[39]=5,ua[39]=ha[39]=16,pa[39]=fa[39]=22;var ga=[];ga[1]=ga[169]=$s,ga[4]=ga[166]=ta,ga[16]=ga[154]=ea,ga[64]=ga[106]=na,ga[168]=ga[2]=ia,ga[162]=ga[8]=ra,ga[138]=ga[32]=oa,ga[42]=ga[128]=sa,ga[5]=ga[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},ga[20]=ga[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},ga[80]=ga[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},ga[65]=ga[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},ga[160]=ga[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},ga[130]=ga[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},ga[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},ga[101]=ga[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},ga[149]=ga[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},ga[86]=ga[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},ga[89]=ga[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},ga[96]=ga[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},ga[24]=ga[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},ga[6]=ga[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},ga[129]=ga[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},ga[66]=ga[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},ga[144]=ga[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},ga[36]=ga[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},ga[9]=ga[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},ga[37]=ga[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},ga[148]=ga[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},ga[82]=ga[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},ga[73]=ga[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},ga[145]=ga[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},ga[70]=ga[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},ga[34]=function(t){return[sa(t),ra(t)]},ga[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},ga[136]=function(t){return[oa(t),ia(t)]},ga[153]=function(t){return[ea(t),$s(t)]},ga[102]=function(t){return[ta(t),na(t)]},ga[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},ga[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},ga[152]=function(t){return[ea(t),ia(t)]},ga[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},ga[137]=function(t){return[oa(t),$s(t)]},ga[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},ga[98]=function(t){return[ra(t),na(t)]},ga[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},ga[38]=function(t){return[ta(t),sa(t)]},ga[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]};var ya=function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1};ya.buildId=function(t){return t.join(",")},ya.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter((function(e){return e.from.id!==t.from.id}))},ya.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter((function(e){return e.to.id!==t.to.id}))},ya.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},ya.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort((function(e,n){var i=e.to,r=n.to;if(i.coordinates[0]-t.coordinates[0]>=0&&r.coordinates[0]-t.coordinates[0]<0)return 1;if(i.coordinates[0]-t.coordinates[0]<0&&r.coordinates[0]-t.coordinates[0]>=0)return-1;if(i.coordinates[0]-t.coordinates[0]==0&&r.coordinates[0]-t.coordinates[0]==0)return i.coordinates[1]-t.coordinates[1]>=0||r.coordinates[1]-t.coordinates[1]>=0?i.coordinates[1]-r.coordinates[1]:r.coordinates[1]-i.coordinates[1];var o=li(t.coordinates,i.coordinates,r.coordinates);return o<0?1:o>0?-1:Math.pow(i.coordinates[0]-t.coordinates[0],2)+Math.pow(i.coordinates[1]-t.coordinates[1],2)-(Math.pow(r.coordinates[0]-t.coordinates[0],2)+Math.pow(r.coordinates[1]-t.coordinates[1],2))})),this.outerEdgesSorted=!0)},ya.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},ya.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},ya.prototype.addInnerEdge=function(t){this.innerEdges.push(t)};var ma=function(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)};ma.prototype.getSymetric=function(){return this.symetric||(this.symetric=new ma(this.to,this.from),this.symetric.symetric=this),this.symetric},ma.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},ma.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},ma.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},ma.prototype.toLineString=function(){return a([this.from.coordinates,this.to.coordinates])},ma.prototype.compareTo=function(t){return li(t.from.coordinates,t.to.coordinates,this.to.coordinates)};var _a=function(){this.edges=[],this.polygon=void 0,this.envelope=void 0},va={length:{configurable:!0}};_a.prototype.push=function(t){this[this.edges.length]=t,this.edges.push(t),this.polygon=this.envelope=void 0},_a.prototype.get=function(t){return this.edges[t]},va.length.get=function(){return this.edges.length},_a.prototype.forEach=function(t){this.edges.forEach(t)},_a.prototype.map=function(t){return this.edges.map(t)},_a.prototype.some=function(t){return this.edges.some(t)},_a.prototype.isValid=function(){return!0},_a.prototype.isHole=function(){var t=this,e=this.edges.reduce((function(e,n,i){return n.from.coordinates[1]>t.edges[e].from.coordinates[1]&&(e=i),e}),0),n=(0===e?this.length:e)-1,i=(e+1)%this.length,r=li(this.edges[n].from.coordinates,this.edges[e].from.coordinates,this.edges[i].from.coordinates);return 0===r?this.edges[n].from.coordinates[0]>this.edges[i].from.coordinates[0]:r>0},_a.prototype.toMultiPoint=function(){return h(this.edges.map((function(t){return t.from.coordinates})))},_a.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map((function(t){return t.from.coordinates}));return t.push(this.edges[0].from.coordinates),this.polygon=o([t])},_a.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=re(this.toPolygon())},_a.findEdgeRingContaining=function(t,e){var n,r,o=t.getEnvelope();return e.forEach((function(e){var s=e.getEnvelope();if(r&&(n=r.getEnvelope()),!function(t,e){var n=t.geometry.coordinates.map((function(t){return t[0]})),i=t.geometry.coordinates.map((function(t){return t[1]})),r=e.geometry.coordinates.map((function(t){return t[0]})),o=e.geometry.coordinates.map((function(t){return t[1]}));return Math.max(null,n)===Math.max(null,r)&&Math.max(null,i)===Math.max(null,o)&&Math.min(null,n)===Math.min(null,r)&&Math.min(null,i)===Math.min(null,o)}(s,o)&&ui(s,o)){var a=t.map((function(t){return t.from.coordinates})).find((function(t){return!e.some((function(e){return function(t,e){return t[0]===e[0]&&t[1]===e[1]}(t,e.from.coordinates)}))}));a&&e.inside(i(a))&&(r&&!ui(n,s)||(r=e))}})),r},_a.prototype.inside=function(t){return St(t,this.toPolygon())},Object.defineProperties(_a.prototype,va);var xa=function(){this.edges=[],this.nodes={}};xa.fromGeoJson=function(t){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(t);var e=new xa;return F(t,(function(t){X(t,"LineString","Graph::fromGeoJson"),S(t,(function(t,n){if(t){var i=e.getNode(t),r=e.getNode(n);e.addEdge(i,r)}return n}))})),e},xa.prototype.getNode=function(t){var e=ya.buildId(t),n=this.nodes[e];return n||(n=this.nodes[e]=new ya(t)),n},xa.prototype.addEdge=function(t,e){var n=new ma(t,e),i=n.getSymetric();this.edges.push(n),this.edges.push(i)},xa.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map((function(e){return t.nodes[e]})).forEach((function(e){return t._removeIfDangle(e)}))},xa.prototype._removeIfDangle=function(t){var e=this;if(t.innerEdges.length<=1){var n=t.getOuterEdges().map((function(t){return t.to}));this.removeNode(t),n.forEach((function(t){return e._removeIfDangle(t)}))}},xa.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach((function(e){e.label===e.symetric.label&&(t.removeEdge(e.symetric),t.removeEdge(e))}))},xa.prototype._computeNextCWEdges=function(t){var e=this;void 0===t?Object.keys(this.nodes).forEach((function(t){return e._computeNextCWEdges(e.nodes[t])})):t.getOuterEdges().forEach((function(e,n){t.getOuterEdge((0===n?t.getOuterEdges().length:n)-1).symetric.next=e}))},xa.prototype._computeNextCCWEdges=function(t,e){for(var n,i,r=t.getOuterEdges(),o=r.length-1;o>=0;--o){var s=r[o],a=s.symetric,l=void 0,u=void 0;s.label===e&&(l=s),a.label===e&&(u=a),l&&u&&(u&&(i=u),l&&(i&&(i.next=l,i=void 0),n||(n=l)))}i&&(i.next=n)},xa.prototype._findLabeledEdgeRings=function(){var t=[],e=0;return this.edges.forEach((function(n){if(!(n.label>=0)){t.push(n);var i=n;do{i.label=e,i=i.next}while(!n.isEqual(i));e++}})),t},xa.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach((function(t){t.label=void 0})),this._findLabeledEdgeRings().forEach((function(e){t._findIntersectionNodes(e).forEach((function(n){t._computeNextCCWEdges(n,e.label)}))}));var e=[];return this.edges.forEach((function(n){n.ring||e.push(t._findEdgeRing(n))})),e},xa.prototype._findIntersectionNodes=function(t){var e=[],n=t,i=function(){var i=0;n.from.getOuterEdges().forEach((function(e){e.label===t.label&&++i})),i>1&&e.push(n.from),n=n.next};do{i()}while(!t.isEqual(n));return e},xa.prototype._findEdgeRing=function(t){var e=t,n=new _a;do{n.push(e),e.ring=n,e=e.next}while(!t.isEqual(e));return n},xa.prototype.removeNode=function(t){var e=this;t.getOuterEdges().forEach((function(t){return e.removeEdge(t)})),t.innerEdges.forEach((function(t){return e.removeEdge(t)})),delete this.nodes[t.id]},xa.prototype.removeEdge=function(t){this.edges=this.edges.filter((function(e){return!e.isEqual(t)})),t.deleteEdge()};var Ca=yt((function(t,e){function n(t){var e=[];for(var n in t)e.push(n);return e}(t.exports="function"==typeof Object.keys?Object.keys:n).shim=n})),wa=(Ca.shim,yt((function(t,e){function n(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function i(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}var r="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();(e=t.exports=r?n:i).supported=n,e.unsupported=i}))),ba=(wa.supported,wa.unsupported,yt((function(t){function e(t){return null==t}function n(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0])}var i=Array.prototype.slice,r=t.exports=function(t,o,s){return s||(s={}),t===o||(t instanceof Date&&o instanceof Date?t.getTime()===o.getTime():!t||!o||"object"!=typeof t&&"object"!=typeof o?s.strict?t===o:t==o:function(t,o,s){var a,l;if(e(t)||e(o))return!1;if(t.prototype!==o.prototype)return!1;if(wa(t))return!!wa(o)&&(t=i.call(t),o=i.call(o),r(t,o,s));if(n(t)){if(!n(o))return!1;if(t.length!==o.length)return!1;for(a=0;a<t.length;a++)if(t[a]!==o[a])return!1;return!0}try{var u=Ca(t),c=Ca(o)}catch(t){return!1}if(u.length!=c.length)return!1;for(u.sort(),c.sort(),a=u.length-1;a>=0;a--)if(u[a]!=c[a])return!1;for(a=u.length-1;a>=0;a--)if(l=u[a],!r(t[l],o[l],s))return!1;return typeof t==typeof o}(t,o,s))}}))),Ea=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:xi};Ea.prototype.compare=function(t,e){if(t.type!==e.type||!vi(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var n=this,i=_i(t),r=_i(e);return i.every((function(t){return this.some((function(e){return n.compare(t,e)}))}),r)}}return!1},Ea.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toFixed(this.precision)!==e[n].toFixed(this.precision))return!1;return!0},Ea.prototype.compareLine=function(t,e,n,i){if(!vi(t,e))return!1;var r=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!i||this.compareCoord(r[0],o[0])||(o=this.fixStartIndex(o,r))){var s=this.compareCoord(r[n],o[n]);return this.direction||s?this.comparePath(r,o):!!this.compareCoord(r[n],o[o.length-(1+n)])&&this.comparePath(r.slice().reverse(),o)}},Ea.prototype.fixStartIndex=function(t,e){for(var n,i=-1,r=0;r<t.length;r++)if(this.compareCoord(t[r],e[0])){i=r;break}return i>=0&&(n=[].concat(t.slice(i,t.length),t.slice(1,i+1))),n},Ea.prototype.comparePath=function(t,e){var n=this;return t.every((function(t,e){return n.compareCoord(t,this[e])}),e)},Ea.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var n=t.coordinates.slice(1,t.coordinates.length),i=e.coordinates.slice(1,e.coordinates.length),r=this;return n.every((function(t){return this.some((function(e){return r.compareLine(t,e,1,!0)}))}),i)}return!1},Ea.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},Ea.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},Ea.prototype.removePseudo=function(t){return t};var Ia=Ea,Pa=yt((function(t){function e(t,e,n,i){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,e,n,i)}e.prototype.run=function(t,e,n,i){this._init(t,e,n,i);for(var r=0;r<this._datasetLength;r++)if(1!==this._visited[r]){this._visited[r]=1;var o=this._regionQuery(r);if(o.length<this.minPts)this.noise.push(r);else{var s=this.clusters.length;this.clusters.push([]),this._addToCluster(r,s),this._expandCluster(s,o)}}return this.clusters},e.prototype._init=function(t,e,n,i){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}e&&(this.epsilon=e),n&&(this.minPts=n),i&&(this.distance=i)},e.prototype._expandCluster=function(t,e){for(var n=0;n<e.length;n++){var i=e[n];if(1!==this._visited[i]){this._visited[i]=1;var r=this._regionQuery(i);r.length>=this.minPts&&(e=this._mergeArrays(e,r))}1!==this._assigned[i]&&this._addToCluster(i,t)}},e.prototype._addToCluster=function(t,e){this.clusters[e].push(t),this._assigned[t]=1},e.prototype._regionQuery=function(t){for(var e=[],n=0;n<this._datasetLength;n++)this.distance(this.dataset[t],this.dataset[n])<this.epsilon&&e.push(n);return e},e.prototype._mergeArrays=function(t,e){for(var n=e.length,i=0;i<n;i++){var r=e[i];t.indexOf(r)<0&&t.push(r)}return t},e.prototype._euclideanDistance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;)n+=(t[i]-e[i])*(t[i]-e[i]);return Math.sqrt(n)},t.exports&&(t.exports=e)})),Na=yt((function(t){function e(t,e,n){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,e,n)}e.prototype.init=function(t,e,n){this.assignments=[],this.centroids=[],void 0!==t&&(this.dataset=t),void 0!==e&&(this.k=e),void 0!==n&&(this.distance=n)},e.prototype.run=function(t,e){this.init(t,e);for(var n=this.dataset.length,i=0;i<this.k;i++)this.centroids[i]=this.randomCentroid();for(var r=!0;r;){r=this.assign();for(var o=0;o<this.k;o++){for(var s=new Array(c),a=0,l=0;l<c;l++)s[l]=0;for(var u=0;u<n;u++){var c=this.dataset[u].length;if(o===this.assignments[u]){for(l=0;l<c;l++)s[l]+=this.dataset[u][l];a++}}if(a>0){for(l=0;l<c;l++)s[l]/=a;this.centroids[o]=s}else this.centroids[o]=this.randomCentroid(),r=!0}}return this.getClusters()},e.prototype.randomCentroid=function(){var t,e,n=this.dataset.length-1;do{e=Math.round(Math.random()*n),t=this.dataset[e]}while(this.centroids.indexOf(t)>=0);return t},e.prototype.assign=function(){for(var t,e=!1,n=this.dataset.length,i=0;i<n;i++)(t=this.argmin(this.dataset[i],this.centroids,this.distance))!=this.assignments[i]&&(this.assignments[i]=t,e=!0);return e},e.prototype.getClusters=function(){for(var t,e=new Array(this.k),n=0;n<this.assignments.length;n++)void 0===e[t=this.assignments[n]]&&(e[t]=[]),e[t].push(n);return e},e.prototype.argmin=function(t,e,n){for(var i,r=Number.MAX_VALUE,o=0,s=e.length,a=0;a<s;a++)(i=n(t,e[a]))<r&&(r=i,o=a);return o},e.prototype.distance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;){var r=t[i]-e[i];n+=r*r}return Math.sqrt(n)},t.exports&&(t.exports=e)})),Sa=yt((function(t){function e(t,e,n){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,e,n)}e.prototype.insert=function(t,e){for(var n=this._queue.length,i=n;i--;){var r=this._priorities[i];"desc"===this._sorting?e>r&&(n=i):e<r&&(n=i)}this._insertAt(t,e,n)},e.prototype.remove=function(t){for(var e=this._queue.length;e--;)if(t===this._queue[e]){this._queue.splice(e,1),this._priorities.splice(e,1);break}},e.prototype.forEach=function(t){this._queue.forEach(t)},e.prototype.getElements=function(){return this._queue},e.prototype.getElementPriority=function(t){return this._priorities[t]},e.prototype.getPriorities=function(){return this._priorities},e.prototype.getElementsWithPriorities=function(){for(var t=[],e=0,n=this._queue.length;e<n;e++)t.push([this._queue[e],this._priorities[e]]);return t},e.prototype._init=function(t,e,n){if(t&&e){if(this._queue=[],this._priorities=[],t.length!==e.length)throw new Error("Arrays must have the same length");for(var i=0;i<t.length;i++)this.insert(t[i],e[i])}n&&(this._sorting=n)},e.prototype._insertAt=function(t,e,n){this._queue.length===n?(this._queue.push(t),this._priorities.push(e)):(this._queue.splice(n,0,t),this._priorities.splice(n,0,e))},t.exports&&(t.exports=e)})),Ta=yt((function(t){function e(t,e,n,i){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,n,i)}if(t.exports)var n=Sa;e.prototype.run=function(t,e,i,r){this._init(t,e,i,r);for(var o=0,s=this.dataset.length;o<s;o++)if(1!==this._processed[o]){this._processed[o]=1,this.clusters.push([o]);var a=this.clusters.length-1;this._orderedList.push(o);var l=new n(null,null,"asc"),u=this._regionQuery(o);void 0!==this._distanceToCore(o)&&(this._updateQueue(o,u,l),this._expandCluster(a,l))}return this.clusters},e.prototype.getReachabilityPlot=function(){for(var t=[],e=0,n=this._orderedList.length;e<n;e++){var i=this._orderedList[e],r=this._reachability[i];t.push([i,r])}return t},e.prototype._init=function(t,e,n,i){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),n&&(this.minPts=n),i&&(this.distance=i)},e.prototype._updateQueue=function(t,e,n){var i=this;this._coreDistance=this._distanceToCore(t),e.forEach((function(e){if(void 0===i._processed[e]){var r=i.distance(i.dataset[t],i.dataset[e]),o=Math.max(i._coreDistance,r);void 0===i._reachability[e]?(i._reachability[e]=o,n.insert(e,o)):o<i._reachability[e]&&(i._reachability[e]=o,n.remove(e),n.insert(e,o))}}))},e.prototype._expandCluster=function(t,e){for(var n=e.getElements(),i=0,r=n.length;i<r;i++){var o=n[i];if(void 0===this._processed[o]){var s=this._regionQuery(o);this._processed[o]=1,this.clusters[t].push(o),this._orderedList.push(o),void 0!==this._distanceToCore(o)&&(this._updateQueue(o,s,e),this._expandCluster(t,e))}}},e.prototype._distanceToCore=function(t){for(var e=this.epsilon,n=0;n<e;n++)if(this._regionQuery(t,n).length>=this.minPts)return n},e.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var n=[],i=0,r=this.dataset.length;i<r;i++)this.distance(this.dataset[t],this.dataset[i])<e&&n.push(i);return n},e.prototype._euclideanDistance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;)n+=(t[i]-e[i])*(t[i]-e[i]);return Math.sqrt(n)},t.exports&&(t.exports=e)})),La=yt((function(t){t.exports&&(t.exports={DBSCAN:Pa,KMEANS:Na,OPTICS:Ta,PriorityQueue:Sa})})),Ma=(La.DBSCAN,La.KMEANS,La.OPTICS,La.PriorityQueue,function(t,e,n){for(var i=t.length,r=0,o=0;o<i;o++){var s=(t[o]||0)-(e[o]||0);r+=s*s}return n?Math.sqrt(r):r}),Oa=Ma,Ra=function(t,e,n){var i=Math.abs(t-e);return n?i:i*i},Aa=Ma,Da=function(t,e,n,i){var r=[],o=[],s=[],a=[],l=!1,u=i||1e4,c=t.length,h=t[0].length,p=h>0,f=[];if(n)r="kmrand"==n?function(t,e){for(var n={},i=[],r=e<<2,o=t.length,s=t[0].length>0;i.length<e&&r-- >0;){var a=t[Math.floor(Math.random()*o)],l=s?a.join("_"):""+a;n[l]||(n[l]=!0,i.push(a))}if(i.length<e)throw new Error("Error initializating clusters");return i}(t,e):"kmpp"==n?function(t,e){var n=t[0].length?Oa:Ra,i=[],r=t.length,o=t[0].length>0,s=t[Math.floor(Math.random()*r)];for(o&&s.join("_"),i.push(s);i.length<e;){for(var a=[],l=i.length,u=0,c=[],h=0;h<r;h++){for(var p=1/0,f=0;f<l;f++){var d=n(t[h],i[f]);d<=p&&(p=d)}a[h]=p}for(var g=0;g<r;g++)u+=a[g];for(var y=0;y<r;y++)c[y]={i:y,v:t[y],pr:a[y]/u,cs:0};c.sort((function(t,e){return t.pr-e.pr})),c[0].cs=c[0].pr;for(var m=1;m<r;m++)c[m].cs=c[m-1].cs+c[m].pr;for(var _=Math.random(),v=0;v<r-1&&c[v++].cs<_;);i.push(c[v-1].v)}return i}(t,e):n;else for(var d={};r.length<e;){var g=Math.floor(Math.random()*c);d[g]||(d[g]=!0,r.push(t[g]))}do{wi(e,0,f);for(var y=0;y<c;y++){for(var m=1/0,_=0,v=0;v<e;v++)(a=p?Aa(t[y],r[v]):Math.abs(t[y]-r[v]))<=m&&(m=a,_=v);s[y]=_,f[_]++}for(var x=[],C=(o=[],0);C<e;C++)x[C]=p?wi(h,0,x[C]):0,o[C]=r[C];if(p){for(var w=0;w<e;w++)r[w]=[];for(var b=0;b<c;b++)for(var E=x[s[b]],I=t[b],P=0;P<h;P++)E[P]+=I[P];l=!0;for(var N=0;N<e;N++){for(var S=r[N],T=x[N],L=o[N],M=f[N],O=0;O<h;O++)S[O]=T[O]/M||0;if(l)for(var R=0;R<h;R++)if(L[R]!=S[R]){l=!1;break}}}else{for(var A=0;A<c;A++)x[s[A]]+=t[A];for(var D=0;D<e;D++)r[D]=x[D]/f[D]||0;l=!0;for(var F=0;F<e;F++)if(o[F]!=r[F]){l=!1;break}}l=l||--u<=0}while(!l);return{it:1e4-u,k:e,idxs:s,centroids:r}},Fa={search:function(t,e,n,i){t.cleanDirty();var r=(i=i||{}).heuristic||Fa.heuristics.manhattan,o=i.closest||!1,s=new Ni((function(t){return t.f})),a=e;for(e.h=r(e,n),s.push(e);s.size()>0;){var l=s.pop();if(l===n)return Ei(l);l.closed=!0;for(var u=t.neighbors(l),c=0,h=u.length;c<h;++c){var p=u[c];if(!p.closed&&!p.isWall()){var f=l.g+p.getCost(l),d=p.visited;(!d||f<p.g)&&(p.visited=!0,p.parent=l,p.h=p.h||r(p,n),p.g=f,p.f=p.g+p.h,t.markDirty(p),o&&(p.h<a.h||p.h===a.h&&p.g<a.g)&&(a=p),d?s.rescoreElement(p):s.push(p))}}}return o?Ei(a):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var n=Math.sqrt(2),i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return 1*(i+r)+(n-2)*Math.min(i,r)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};Ii.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)Fa.cleanNode(this.nodes[t])},Ii.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)Fa.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},Ii.prototype.markDirty=function(t){this.dirtyNodes.push(t)},Ii.prototype.neighbors=function(t){var e=[],n=t.x,i=t.y,r=this.grid;return r[n-1]&&r[n-1][i]&&e.push(r[n-1][i]),r[n+1]&&r[n+1][i]&&e.push(r[n+1][i]),r[n]&&r[n][i-1]&&e.push(r[n][i-1]),r[n]&&r[n][i+1]&&e.push(r[n][i+1]),this.diagonal&&(r[n-1]&&r[n-1][i-1]&&e.push(r[n-1][i-1]),r[n+1]&&r[n+1][i-1]&&e.push(r[n+1][i-1]),r[n-1]&&r[n-1][i+1]&&e.push(r[n-1][i+1]),r[n+1]&&r[n+1][i+1]&&e.push(r[n+1][i+1])),e},Ii.prototype.toString=function(){for(var t,e,n,i,r=[],o=this.grid,s=0,a=o.length;s<a;s++){for(t=[],n=0,i=(e=o[s]).length;n<i;n++)t.push(e[n].weight);r.push(t.join(" "))}return r.join("\n")},Pi.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},Pi.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},Pi.prototype.isWall=function(){return 0===this.weight},Ni.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),n=this.content.pop();e!==this.content.length-1&&(this.content[e]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];t>0;){var n=(t+1>>1)-1,i=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(i)))break;this.content[n]=e,this.content[t]=i,t=n}},bubbleUp:function(t){for(var e=this.content.length,n=this.content[t],i=this.scoreFunction(n);;){var r,o=t+1<<1,s=o-1,a=null;if(s<e){var l=this.content[s];(r=this.scoreFunction(l))<i&&(a=s)}if(o<e){var u=this.content[o];this.scoreFunction(u)<(null===a?i:r)&&(a=o)}if(null===a)break;this.content[t]=this.content[a],this.content[a]=n,t=a}}};var ka=function(t){return function(){return t}};Li.prototype={constructor:Li,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Ai(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(Oi(this,n),n=(t=n).U),n.C=!1,i.C=!0,Ri(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(Ri(this,n),n=(t=n).U),n.C=!1,i.C=!0,Oi(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,s=t.R;if(n=o?s?Ai(s):o:s,r?r.L===t?r.L=n:r.R=n:this._=n,o&&s?(i=n.C,n.C=t.C,n.L=o,o.U=n,n!==s?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=s,s.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,Oi(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Ri(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,Oi(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,Ri(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Oi(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,Ri(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}};var Ba,Ga,ja,za,Ua,qa=[],Va=[],Ha=1e-6,Ya=1e-12;Qi.prototype={constructor:Qi,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return zi(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,i){if(o=(r=n.halfedges).length)for(var r,o,s,a=n.site,l=-1,u=e[r[o-1]],c=u.left===a?u.right:u.left;++l<o;)s=c,c=(u=e[r[l]]).left===a?u.right:u.left,s&&c&&i<s.index&&i<c.index&&Zi(a,s,c)<0&&t.push([a.data,s.data,c.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var i,r,o=this,s=o._found||0,a=o.cells.length;!(r=o.cells[s]);)if(++s>=a)return null;var l=t-r.site[0],u=e-r.site[1],c=l*l+u*u;do{r=o.cells[i=s],s=null,r.halfedges.forEach((function(n){var i=o.edges[n],a=i.left;if(a!==r.site&&a||(a=i.right)){var l=t-a[0],u=e-a[1],h=l*l+u*u;h<c&&(c=h,s=a.index)}}))}while(null!==s);return o._found=i,null==n||c<=n*n?r.site:null}};var Xa=Object.freeze({randomPosition:or,randomPoint:sr,randomPolygon:ar,randomLineString:lr}),Wa=Object.freeze({getCluster:cr,clusterEach:hr,clusterReduce:pr,createBins:fr,applyFilter:dr,propertiesContainsFilter:gr,filterProperties:yr});"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,i=1 in arguments&&parseInt(Number(arguments[1]),10)||0;i=i<0?Math.max(n+i,0):Math.min(i,n);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(r=r<0?Math.max(n+arguments[2],0):Math.min(r,n);i<r;)e[i]=t,++i;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var Ka=function(){};Ka.prototype.interfaces_=function(){return[]},Ka.prototype.getClass=function(){return Ka},Ka.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var Za=function(){},Ja=function(){},Qa={MAX_VALUE:{configurable:!0}};Ja.isNaN=function(t){return Number.isNaN(t)},Ja.doubleToLongBits=function(t){return t},Ja.longBitsToDouble=function(t){return t},Ja.isInfinite=function(t){return!Number.isFinite(t)},Qa.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(Ja,Qa);var $a=function(){},tl=function(){},el=function(){},nl=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},il={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};nl.prototype.setOrdinate=function(t,e){switch(t){case nl.X:this.x=e;break;case nl.Y:this.y=e;break;case nl.Z:this.z=e;break;default:throw new Za("Invalid ordinate index: "+t)}},nl.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!Ka.equalsWithTolerance(this.x,e.x,n)&&!!Ka.equalsWithTolerance(this.y,e.y,n)}},nl.prototype.getOrdinate=function(t){switch(t){case nl.X:return this.x;case nl.Y:return this.y;case nl.Z:return this.z}throw new Za("Invalid ordinate index: "+t)},nl.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||Ja.isNaN(this.z))&&Ja.isNaN(t.z)},nl.prototype.equals=function(t){return t instanceof nl&&this.equals2D(t)},nl.prototype.equalInZ=function(t,e){return Ka.equalsWithTolerance(this.z,t.z,e)},nl.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},nl.prototype.clone=function(){},nl.prototype.copy=function(){return new nl(this)},nl.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},nl.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},nl.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},nl.prototype.hashCode=function(){var t=17;return 37*(t=37*t+nl.hashCode(this.x))+nl.hashCode(this.y)},nl.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},nl.prototype.interfaces_=function(){return[$a,tl,mr]},nl.prototype.getClass=function(){return nl},nl.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=Ja.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},il.DimensionalComparator.get=function(){return rl},il.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},il.NULL_ORDINATE.get=function(){return Ja.NaN},il.X.get=function(){return 0},il.Y.get=function(){return 1},il.Z.get=function(){return 2},Object.defineProperties(nl,il);var rl=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new Za("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};rl.prototype.compare=function(t,e){var n=t,i=e,r=rl.compare(n.x,i.x);if(0!==r)return r;var o=rl.compare(n.y,i.y);return 0!==o?o:this._dimensionsToTest<=2?0:rl.compare(n.z,i.z)},rl.prototype.interfaces_=function(){return[el]},rl.prototype.getClass=function(){return rl},rl.compare=function(t,e){return t<e?-1:t>e?1:Ja.isNaN(t)?Ja.isNaN(e)?0:-1:Ja.isNaN(e)?1:0};var ol=function(){};ol.prototype.create=function(){},ol.prototype.interfaces_=function(){return[]},ol.prototype.getClass=function(){return ol};var sl=function(){},al={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};sl.prototype.interfaces_=function(){return[]},sl.prototype.getClass=function(){return sl},sl.toLocationSymbol=function(t){switch(t){case sl.EXTERIOR:return"e";case sl.BOUNDARY:return"b";case sl.INTERIOR:return"i";case sl.NONE:return"-"}throw new Za("Unknown location value: "+t)},al.INTERIOR.get=function(){return 0},al.BOUNDARY.get=function(){return 1},al.EXTERIOR.get=function(){return 2},al.NONE.get=function(){return-1},Object.defineProperties(sl,al);var ll=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},ul=function(){},cl={LOG_10:{configurable:!0}};ul.prototype.interfaces_=function(){return[]},ul.prototype.getClass=function(){return ul},ul.log10=function(t){var e=Math.log(t);return Ja.isInfinite(e)||Ja.isNaN(e)?e:e/ul.LOG_10},ul.min=function(t,e,n,i){var r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r},ul.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],o=arguments[2];return i<r?r:i>o?o:i}},ul.wrap=function(t,e){return t<0?e- -t%e:t%e},ul.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=t;return e>i&&(i=e),n>i&&(i=n),i}if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],l=r;return o>l&&(l=o),s>l&&(l=s),a>l&&(l=a),l}},ul.average=function(t,e){return(t+e)/2},cl.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(ul,cl);var hl=function(t){this.str=t};hl.prototype.append=function(t){this.str+=t},hl.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},hl.prototype.toString=function(t){return this.str};var pl=function(t){this.value=t};pl.prototype.intValue=function(){return this.value},pl.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},pl.isNaN=function(t){return Number.isNaN(t)};var fl=function(){};fl.isWhitespace=function(t){return t<=32&&t>=0||127===t},fl.toUpperCase=function(t){return t.toUpperCase()};var dl=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else if("string"==typeof arguments[0]){var i=arguments[0];t.call(this,t.parse(i))}}else if(2===arguments.length){var r=arguments[0],o=arguments[1];this.init(r,o)}},gl={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};dl.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},dl.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),i=dl.magnitude(n._hi),r=dl.TEN.pow(i);(n=n.divide(r)).gt(dl.TEN)?(n=n.divide(dl.TEN),i+=1):n.lt(dl.ONE)&&(n=n.multiply(dl.TEN),i-=1);for(var o=i+1,s=new hl,a=dl.MAX_PRINT_DIGITS-1,l=0;l<=a;l++){t&&l===o&&s.append(".");var u=Math.trunc(n._hi);if(u<0)break;var c=!1,h=0;u>9?(c=!0,h="9"):h="0"+u,s.append(h),n=n.subtract(dl.valueOf(u)).multiply(dl.TEN),c&&n.selfAdd(dl.TEN);var p=!0,f=dl.magnitude(n._hi);if(f<0&&Math.abs(f)>=a-l&&(p=!1),!p)break}return e[0]=i,s.toString()},dl.prototype.sqr=function(){return this.multiply(this)},dl.prototype.doubleValue=function(){return this._hi+this._lo},dl.prototype.subtract=function(){if(arguments[0]instanceof dl){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},dl.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},dl.prototype.isZero=function(){return 0===this._hi&&0===this._lo},dl.prototype.selfSubtract=function(){if(arguments[0]instanceof dl){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},dl.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},dl.prototype.min=function(t){return this.le(t)?this:t},dl.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof dl){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=null,o=null,s=null,a=null,l=null,u=null,c=null,h=null;return l=this._hi/n,h=(r=(u=dl.SPLIT*l)-(r=u-l))*(s=(h=dl.SPLIT*n)-(s=h-n))-(c=l*n)+r*(a=n-s)+(o=l-r)*s+o*a,h=l+(u=(this._hi-c-h+this._lo-l*i)/n),this._hi=h,this._lo=l-h+u,this}},dl.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},dl.prototype.divide=function(){if(arguments[0]instanceof dl){var t=arguments[0],e=null,n=null,i=null,r=null,o=null,s=null,a=null,l=null;return n=(o=this._hi/t._hi)-(e=(s=dl.SPLIT*o)-(e=s-o)),l=e*(i=(l=dl.SPLIT*t._hi)-(i=l-t._hi))-(a=o*t._hi)+e*(r=t._hi-i)+n*i+n*r,s=(this._hi-a-l+this._lo-o*t._lo)/t._hi,new dl(l=o+s,o-l+s)}if("number"==typeof arguments[0]){var u=arguments[0];return Ja.isNaN(u)?dl.createNaN():dl.copy(this).selfDivide(u,0)}},dl.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},dl.prototype.pow=function(t){if(0===t)return dl.valueOf(1);var e=new dl(this),n=dl.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),(i/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},dl.prototype.ceil=function(){if(this.isNaN())return dl.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new dl(t,e)},dl.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},dl.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},dl.prototype.setValue=function(){if(arguments[0]instanceof dl){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},dl.prototype.max=function(t){return this.ge(t)?this:t},dl.prototype.sqrt=function(){if(this.isZero())return dl.valueOf(0);if(this.isNegative())return dl.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=dl.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)},dl.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof dl){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,i=null,r=null,o=null,s=null,a=null;return o=(r=this._hi+e)-(s=r-this._hi),i=(a=(o=e-s+(this._hi-o))+this._lo)+(r-(n=r+a)),this._hi=n+i,this._lo=i+(n-this._hi),this}}else if(2===arguments.length){var l=arguments[0],u=arguments[1],c=null,h=null,p=null,f=null,d=null,g=null,y=null;f=this._hi+l,h=this._lo+u,d=f-(g=f-this._hi),p=h-(y=h-this._lo);var m=(c=f+(g=(d=l-g+(this._hi-d))+h))+(g=(p=u-y+(this._lo-p))+(g+(f-c))),_=g+(c-m);return this._hi=m,this._lo=_,this}},dl.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof dl){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=null,o=null,s=null,a=null,l=null,u=null;r=(l=dl.SPLIT*this._hi)-this._hi,u=dl.SPLIT*n,r=l-r,o=this._hi-r,s=u-n;var c=(l=this._hi*n)+(u=r*(s=u-s)-l+r*(a=n-s)+o*s+o*a+(this._hi*i+this._lo*n)),h=u+(r=l-c);return this._hi=c,this._lo=h,this}},dl.prototype.selfSqr=function(){return this.selfMultiply(this)},dl.prototype.floor=function(){if(this.isNaN())return dl.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new dl(t,e)},dl.prototype.negate=function(){return this.isNaN()?this:new dl(-this._hi,-this._lo)},dl.prototype.clone=function(){},dl.prototype.multiply=function(){if(arguments[0]instanceof dl){var t=arguments[0];return t.isNaN()?dl.createNaN():dl.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return Ja.isNaN(e)?dl.createNaN():dl.copy(this).selfMultiply(e,0)}},dl.prototype.isNaN=function(){return Ja.isNaN(this._hi)},dl.prototype.intValue=function(){return Math.trunc(this._hi)},dl.prototype.toString=function(){var t=dl.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},dl.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+dl.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var o=i-n.length;r=n+dl.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},dl.prototype.reciprocal=function(){var t,e,n,i,r=null,o=null,s=null,a=null;t=(n=1/this._hi)-(r=(s=dl.SPLIT*n)-(r=s-n)),o=(a=dl.SPLIT*this._hi)-this._hi;var l=n+(s=(1-(i=n*this._hi)-(a=r*(o=a-o)-i+r*(e=this._hi-o)+t*o+t*e)-n*this._lo)/this._hi);return new dl(l,n-l+s)},dl.prototype.toSciNotation=function(){if(this.isZero())return dl.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=dl.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var r="";n.length>1&&(r=n.substring(1));var o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i},dl.prototype.abs=function(){return this.isNaN()?dl.NaN:this.isNegative()?this.negate():new dl(this)},dl.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},dl.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},dl.prototype.add=function(){if(arguments[0]instanceof dl){var t=arguments[0];return dl.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return dl.copy(this).selfAdd(e)}},dl.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof dl){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._hi=n,this._lo=i}},dl.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},dl.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},dl.prototype.trunc=function(){return this.isNaN()?dl.NaN:this.isPositive()?this.floor():this.ceil()},dl.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},dl.prototype.interfaces_=function(){return[mr,$a,tl]},dl.prototype.getClass=function(){return dl},dl.sqr=function(t){return dl.valueOf(t).selfMultiply(t)},dl.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return dl.parse(t)}if("number"==typeof arguments[0]){var e=arguments[0];return new dl(e)}},dl.sqrt=function(t){return dl.valueOf(t).sqrt()},dl.parse=function(t){for(var e=0,n=t.length;fl.isWhitespace(t.charAt(e));)e++;var i=!1;if(e<n){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(i=!0))}for(var o=new dl,s=0,a=0,l=0;!(e>=n);){var u=t.charAt(e);if(e++,fl.isDigit(u)){var c=u-"0";o.selfMultiply(dl.TEN),o.selfAdd(c),s++}else{if("."!==u){if("e"===u||"E"===u){var h=t.substring(e);try{l=pl.parseInt(h)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+h+" in string "+t):e}break}throw new Error("Unexpected character '"+u+"' at position "+e+" in string "+t)}a=s}}var p=o,f=s-a-l;if(0===f)p=o;else if(f>0){var d=dl.TEN.pow(f);p=o.divide(d)}else if(f<0){var g=dl.TEN.pow(-f);p=o.multiply(g)}return i?p.negate():p},dl.createNaN=function(){return new dl(Ja.NaN,Ja.NaN)},dl.copy=function(t){return new dl(t)},dl.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i},dl.stringOfChar=function(t,e){for(var n=new hl,i=0;i<e;i++)n.append(t);return n.toString()},gl.PI.get=function(){return new dl(3.141592653589793,12246467991473532e-32)},gl.TWO_PI.get=function(){return new dl(6.283185307179586,24492935982947064e-32)},gl.PI_2.get=function(){return new dl(1.5707963267948966,6123233995736766e-32)},gl.E.get=function(){return new dl(2.718281828459045,14456468917292502e-32)},gl.NaN.get=function(){return new dl(Ja.NaN,Ja.NaN)},gl.EPS.get=function(){return 123259516440783e-46},gl.SPLIT.get=function(){return 134217729},gl.MAX_PRINT_DIGITS.get=function(){return 32},gl.TEN.get=function(){return dl.valueOf(10)},gl.ONE.get=function(){return dl.valueOf(1)},gl.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},gl.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(dl,gl);var yl=function(){},ml={DP_SAFE_EPSILON:{configurable:!0}};yl.prototype.interfaces_=function(){return[]},yl.prototype.getClass=function(){return yl},yl.orientationIndex=function(t,e,n){var i=yl.orientationIndexFilter(t,e,n);if(i<=1)return i;var r=dl.valueOf(e.x).selfAdd(-t.x),o=dl.valueOf(e.y).selfAdd(-t.y),s=dl.valueOf(n.x).selfAdd(-e.x),a=dl.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},yl.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},yl.intersection=function(t,e,n,i){var r=dl.valueOf(i.y).selfSubtract(n.y).selfMultiply(dl.valueOf(e.x).selfSubtract(t.x)),o=dl.valueOf(i.x).selfSubtract(n.x).selfMultiply(dl.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=dl.valueOf(i.x).selfSubtract(n.x).selfMultiply(dl.valueOf(t.y).selfSubtract(n.y)),l=dl.valueOf(i.y).selfSubtract(n.y).selfMultiply(dl.valueOf(t.x).selfSubtract(n.x)),u=a.subtract(l).selfDivide(s).doubleValue(),c=dl.valueOf(t.x).selfAdd(dl.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),h=dl.valueOf(e.x).selfSubtract(t.x).selfMultiply(dl.valueOf(t.y).selfSubtract(n.y)),p=dl.valueOf(e.y).selfSubtract(t.y).selfMultiply(dl.valueOf(t.x).selfSubtract(n.x)),f=h.subtract(p).selfDivide(s).doubleValue(),d=dl.valueOf(n.y).selfAdd(dl.valueOf(i.y).selfSubtract(n.y).selfMultiply(f)).doubleValue();return new nl(c,d)},yl.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=r-o;if(r>0){if(o<=0)return yl.signum(s);i=r+o}else{if(!(r<0))return yl.signum(s);if(o>=0)return yl.signum(s);i=-r-o}var a=yl.DP_SAFE_EPSILON*i;return s>=a||-s>=a?yl.signum(s):2},yl.signum=function(t){return t>0?1:t<0?-1:0},ml.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(yl,ml);var _l=function(){},vl={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};vl.X.get=function(){return 0},vl.Y.get=function(){return 1},vl.Z.get=function(){return 2},vl.M.get=function(){return 3},_l.prototype.setOrdinate=function(t,e,n){},_l.prototype.size=function(){},_l.prototype.getOrdinate=function(t,e){},_l.prototype.getCoordinate=function(){},_l.prototype.getCoordinateCopy=function(t){},_l.prototype.getDimension=function(){},_l.prototype.getX=function(t){},_l.prototype.clone=function(){},_l.prototype.expandEnvelope=function(t){},_l.prototype.copy=function(){},_l.prototype.getY=function(t){},_l.prototype.toCoordinateArray=function(){},_l.prototype.interfaces_=function(){return[tl]},_l.prototype.getClass=function(){return _l},Object.defineProperties(_l,vl);var xl=function(){},Cl=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(xl),wl=function(){};wl.arraycopy=function(t,e,n,i,r){for(var o=0,s=e;s<e+r;s++)n[i+o]=t[s],o++},wl.getProperty=function(t){return{"line.separator":"\n"}[t]};var bl=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.x=n,this.y=i,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],o=arguments[1];this.x=r.y*o.w-o.y*r.w,this.y=o.x*r.w-r.x*o.w,this.w=r.x*o.y-o.x*r.y}else if(arguments[0]instanceof nl&&arguments[1]instanceof nl){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2];this.x=l,this.y=u,this.w=c}else if(4===arguments.length){var h=arguments[0],p=arguments[1],f=arguments[2],d=arguments[3],g=h.y-p.y,y=p.x-h.x,m=h.x*p.y-p.x*h.y,_=f.y-d.y,v=d.x-f.x,x=f.x*d.y-d.x*f.y;this.x=y*x-v*m,this.y=_*m-g*x,this.w=g*v-_*y}};bl.prototype.getY=function(){var t=this.y/this.w;if(Ja.isNaN(t)||Ja.isInfinite(t))throw new Cl;return t},bl.prototype.getX=function(){var t=this.x/this.w;if(Ja.isNaN(t)||Ja.isInfinite(t))throw new Cl;return t},bl.prototype.getCoordinate=function(){var t=new nl;return t.x=this.getX(),t.y=this.getY(),t},bl.prototype.interfaces_=function(){return[]},bl.prototype.getClass=function(){return bl},bl.intersection=function(t,e,n,i){var r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-i.y,l=i.x-n.x,u=n.x*i.y-i.x*n.y,c=r*l-a*o,h=(o*u-l*s)/c,p=(a*s-r*u)/c;if(Ja.isNaN(h)||Ja.isInfinite(h)||Ja.isNaN(p)||Ja.isInfinite(p))throw new Cl;return new nl(h,p)};var El=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof nl){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],l=arguments[3];this.init(o,s,a,l)}},Il={serialVersionUID:{configurable:!0}};El.prototype.getArea=function(){return this.getWidth()*this.getHeight()},El.prototype.equals=function(t){if(!(t instanceof El))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},El.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new El;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new El(e,i,n,r)},El.prototype.isNull=function(){return this._maxx<this._minx},El.prototype.getMaxX=function(){return this._maxx},El.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof nl){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof El){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&i>=this._miny&&i<=this._maxy}},El.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof El){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof nl){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||i>this._maxy||i<this._miny)}},El.prototype.getMinY=function(){return this._miny},El.prototype.getMinX=function(){return this._minx},El.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof nl){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof El){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=i,this._maxy=i):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}},El.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},El.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},El.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},El.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},El.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},El.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},El.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},El.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},El.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},El.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof El){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof nl){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},El.prototype.centre=function(){return this.isNull()?null:new nl((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},El.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof nl){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof El){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];r<o?(this._minx=r,this._maxx=o):(this._minx=o,this._maxx=r),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},El.prototype.getMaxY=function(){return this._maxy},El.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},El.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+nl.hashCode(this._minx))+nl.hashCode(this._maxx))+nl.hashCode(this._miny))+nl.hashCode(this._maxy)},El.prototype.interfaces_=function(){return[$a,mr]},El.prototype.getClass=function(){return El},El.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),l=Math.max(o.x,s.x),u=Math.min(i.x,r.x),c=Math.max(i.x,r.x);return!(u>l||c<a||(a=Math.min(o.y,s.y),l=Math.max(o.y,s.y),u=Math.min(i.y,r.y),c=Math.max(i.y,r.y),u>l||c<a))}},Il.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(El,Il);var Pl={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Nl=function(t){this.geometryFactory=t||new Zu};Nl.prototype.read=function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=Pl.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=Pl.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],Tl[n]&&(e=Tl[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},Nl.prototype.write=function(t){return this.extractGeometry(t)},Nl.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Sl[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+Sl[e].apply(this,[t])+")"};var Sl={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Sl.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Sl.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(Sl.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(Sl.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Sl.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Sl.linestring.apply(this,[t._shell])+")");for(var n=0,i=t._holes.length;n<i;++n)e.push("("+Sl.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Sl.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},Tl={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(Pl.spaces);return this.geometryFactory.createPoint(new nl(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Pl.trimParens,"$1"),i.push(Tl.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(Pl.spaces),i.push(new nl(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(Pl.spaces),i.push(new nl(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(Pl.parenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Pl.trimParens,"$1"),i.push(Tl.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,o=t.trim().split(Pl.parenComma),s=[],a=0,l=o.length;a<l;++a)e=o[a].replace(Pl.trimParens,"$1"),n=Tl.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n._points),0===a?r=i:s.push(i);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(Pl.doubleParenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Pl.trimParens,"$1"),i.push(Tl.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;i<r;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}},Ll=function(t){this.parser=new Nl(t)};Ll.prototype.write=function(t){return this.parser.write(t)},Ll.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var Ml=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),Ol=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ml),Rl=function(){};Rl.prototype.interfaces_=function(){return[]},Rl.prototype.getClass=function(){return Rl},Rl.shouldNeverReachHere=function(){if(0===arguments.length)Rl.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new Ol("Should never reach here"+(null!==t?": "+t:""))}},Rl.isTrue=function(){var t;if(1===arguments.length)Rl.isTrue(arguments[0],null);else if(2===arguments.length&&(t=arguments[1],!arguments[0]))throw null===t?new Ol:new Ol(t)},Rl.equals=function(){var t,e,n;if(2===arguments.length)Rl.equals(t=arguments[0],e=arguments[1],null);else if(3===arguments.length&&(t=arguments[0],n=arguments[2],!(e=arguments[1]).equals(t)))throw new Ol("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var Al=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new nl,this._intPt[1]=new nl,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},Dl={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Al.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},Al.prototype.getTopologySummary=function(){var t=new hl;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},Al.prototype.computeIntersection=function(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)},Al.prototype.getIntersectionNum=function(){return this._result},Al.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},Al.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},Al.prototype.setPrecisionModel=function(t){this._precisionModel=t},Al.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},Al.prototype.getIntersection=function(t){return this._intPt[t]},Al.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},Al.prototype.hasIntersection=function(){return this._result!==Al.NO_INTERSECTION},Al.prototype.getEdgeDistance=function(t,e){return Al.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},Al.prototype.isCollinear=function(){return this._result===Al.COLLINEAR_INTERSECTION},Al.prototype.toString=function(){return Ll.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Ll.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},Al.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},Al.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},Al.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},Al.prototype.interfaces_=function(){return[]},Al.prototype.getClass=function(){return Al},Al.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=i>r?i:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=i>r?s:a)||t.equals(e)||(o=Math.max(s,a))}return Rl.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},Al.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);return Rl.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},Dl.DONT_INTERSECT.get=function(){return 0},Dl.DO_INTERSECT.get=function(){return 1},Dl.COLLINEAR.get=function(){return 2},Dl.NO_INTERSECTION.get=function(){return 0},Dl.POINT_INTERSECTION.get=function(){return 1},Dl.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(Al,Dl);var Fl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new El(this._inputLines[0][0],this._inputLines[0][1]),n=new El(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],n=arguments[1],i=arguments[2];if(this._isProper=!1,El.intersects(n,i,e)&&0===Gl.orientationIndex(n,i,e)&&0===Gl.orientationIndex(i,n,e))return this._isProper=!0,(e.equals(n)||e.equals(i))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},e.prototype.safeHCoordinateIntersection=function(t,n,i,r){var o=null;try{o=bl.intersection(t,n,i,r)}catch(s){if(!(s instanceof Cl))throw s;o=e.nearestEndpoint(t,n,i,r)}return o},e.prototype.intersection=function(t,n,i,r){var o=this.intersectionWithNormalization(t,n,i,r);return this.isInSegmentEnvelopes(o)||(o=new nl(e.nearestEndpoint(t,n,i,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,n,i){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(n)<o&&(r=n,o=Math.abs(n)),Math.abs(i)<o&&(r=i),r},e.prototype.checkDD=function(t,e,n,i,r){var o=yl.intersection(t,e,n,i),s=this.isInSegmentEnvelopes(o);wl.out.println("DD in env = "+s+"  --------------------- "+o),r.distance(o)>1e-4&&wl.out.println("Distance = "+r.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,n,i){var r=new nl(t),o=new nl(e),s=new nl(n),a=new nl(i),l=new nl;this.normalizeToEnvCentre(r,o,s,a,l);var u=this.safeHCoordinateIntersection(r,o,s,a);return u.x+=l.x,u.y+=l.y,u},e.prototype.computeCollinearIntersection=function(e,n,i,r){var o=El.intersects(e,n,i),s=El.intersects(e,n,r),a=El.intersects(i,r,e),l=El.intersects(i,r,n);return o&&s?(this._intPt[0]=i,this._intPt[1]=r,t.COLLINEAR_INTERSECTION):a&&l?(this._intPt[0]=e,this._intPt[1]=n,t.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||s||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&l?(this._intPt[0]=i,this._intPt[1]=n,!i.equals(n)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||o||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&l?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||o||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,n,i,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,u=n.x<i.x?n.x:i.x,c=n.y<i.y?n.y:i.y,h=n.x>i.x?n.x:i.x,p=n.y>i.y?n.y:i.y,f=((o>u?o:u)+(a<h?a:h))/2,d=((s>c?s:c)+(l<p?l:p))/2;r.x=f,r.y=d,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},e.prototype.computeIntersect=function(e,n,i,r){if(this._isProper=!1,!El.intersects(e,n,i,r))return t.NO_INTERSECTION;var o=Gl.orientationIndex(e,n,i),s=Gl.orientationIndex(e,n,r);if(o>0&&s>0||o<0&&s<0)return t.NO_INTERSECTION;var a=Gl.orientationIndex(i,r,e),l=Gl.orientationIndex(i,r,n);return a>0&&l>0||a<0&&l<0?t.NO_INTERSECTION:0===o&&0===s&&0===a&&0===l?this.computeCollinearIntersection(e,n,i,r):(0===o||0===s||0===a||0===l?(this._isProper=!1,e.equals2D(i)||e.equals2D(r)?this._intPt[0]=e:n.equals2D(i)||n.equals2D(r)?this._intPt[0]=n:0===o?this._intPt[0]=new nl(i):0===s?this._intPt[0]=new nl(r):0===a?this._intPt[0]=new nl(e):0===l&&(this._intPt[0]=new nl(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,i,r)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,n,i){var r=t,o=Gl.distancePointLine(t,n,i),s=Gl.distancePointLine(e,n,i);return s<o&&(o=s,r=e),(s=Gl.distancePointLine(n,t,e))<o&&(o=s,r=n),(s=Gl.distancePointLine(i,t,e))<o&&(o=s,r=i),r},e}(Al),kl=function(){};kl.prototype.interfaces_=function(){return[]},kl.prototype.getClass=function(){return kl},kl.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return kl.signOfDet2x2(i,r,o,s)},kl.signOfDet2x2=function(t,e,n,i){var r=null,o=null,s=null;if(r=1,0===t||0===i)return 0===e||0===n?0:e>0?n>0?-r:r:n>0?r:-r;if(0===e||0===n)return i>0?t>0?r:-r:t>0?-r:r;if(e>0?i>0?e<=i||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):e<=-i?(r=-r,n=-n,i=-i):(o=t,t=-n,n=o,o=e,e=-i,i=o):i>0?-e<=i?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):e>=i?(t=-t,e=-e,n=-n,i=-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,i=o),t>0){if(!(n>0))return r;if(!(t<=n))return r}else{if(n>0)return-r;if(!(t>=n))return-r;r=-r,t=-t,n=-n}for(;;){if((i-=(s=Math.floor(n/t))*e)<0)return-r;if(i>e)return r;if(t>(n-=s*t)+n){if(e<i+i)return r}else{if(e>i+i)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if((e-=(s=Math.floor(t/n))*i)<0)return r;if(e>i)return-r;if(n>(t-=s*n)+t){if(i<e+e)return-r}else{if(i>e+e)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var Bl=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};Bl.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,l=kl.signOfDet2x2(r,o,s,a);if(0===l)return this._isPointOnSegment=!0,null;a<o&&(l=-l),l>0&&this._crossingCount++}},Bl.prototype.isPointInPolygon=function(){return this.getLocation()!==sl.EXTERIOR},Bl.prototype.getLocation=function(){return this._isPointOnSegment?sl.BOUNDARY:this._crossingCount%2==1?sl.INTERIOR:sl.EXTERIOR},Bl.prototype.isOnSegment=function(){return this._isPointOnSegment},Bl.prototype.interfaces_=function(){return[]},Bl.prototype.getClass=function(){return Bl},Bl.locatePointInRing=function(){if(arguments[0]instanceof nl&&ll(arguments[1],_l)){for(var t=arguments[0],e=arguments[1],n=new Bl(t),i=new nl,r=new nl,o=1;o<e.size();o++)if(e.getCoordinate(o,i),e.getCoordinate(o-1,r),n.countSegment(i,r),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof nl&&arguments[1]instanceof Array){for(var s=arguments[0],a=arguments[1],l=new Bl(s),u=1;u<a.length;u++){var c=a[u],h=a[u-1];if(l.countSegment(c,h),l.isOnSegment())return l.getLocation()}return l.getLocation()}};var Gl=function(){},jl={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Gl.prototype.interfaces_=function(){return[]},Gl.prototype.getClass=function(){return Gl},Gl.orientationIndex=function(t,e,n){return yl.orientationIndex(t,e,n)},Gl.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,o=t[i+1].y;e+=r*(t[i-1].y-o)}return e/2}if(ll(arguments[0],_l)){var s=arguments[0],a=s.size();if(a<3)return 0;var l=new nl,u=new nl,c=new nl;s.getCoordinate(0,u),s.getCoordinate(1,c);var h=u.x;c.x-=h;for(var p=0,f=1;f<a-1;f++)l.y=u.y,u.x=c.x,u.y=c.y,s.getCoordinate(f+1,c),c.x-=h,p+=u.x*(l.y-c.y);return p/2}},Gl.distanceLineLine=function(t,e,n,i){if(t.equals(e))return Gl.distancePointLine(t,n,i);if(n.equals(i))return Gl.distancePointLine(i,t,e);var r=!1;if(El.intersects(t,e,n,i)){var o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===o)r=!0;else{var s=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,l=s/o;(l<0||l>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?ul.min(Gl.distancePointLine(t,n,i),Gl.distancePointLine(e,n,i),Gl.distancePointLine(n,t,e),Gl.distancePointLine(i,t,e)):0},Gl.isPointInRing=function(t,e){return Gl.locatePointInRing(t,e)!==sl.EXTERIOR},Gl.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new nl;t.getCoordinate(0,i);for(var r=i.x,o=i.y,s=1;s<e;s++){t.getCoordinate(s,i);var a=i.x,l=i.y,u=a-r,c=l-o;n+=Math.sqrt(u*u+c*c),r=a,o=l}return n},Gl.isCCW=function(t){var e=t.length-1;if(e<3)throw new Za("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,r=1;r<=e;r++){var o=t[r];o.y>n.y&&(n=o,i=r)}var s=i;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(n)&&s!==i);var a=i;do{a=(a+1)%e}while(t[a].equals2D(n)&&a!==i);var l=t[s],u=t[a];if(l.equals2D(n)||u.equals2D(n)||l.equals2D(u))return!1;var c=Gl.computeOrientation(l,n,u);return 0===c?l.x>u.x:c>0},Gl.locatePointInRing=function(t,e){return Bl.locatePointInRing(t,e)},Gl.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},Gl.computeOrientation=function(t,e,n){return Gl.orientationIndex(t,e,n)},Gl.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new Za("Line array must contain at least one vertex");for(var n=t.distance(e[0]),i=0;i<e.length-1;i++){var r=Gl.distancePointLine(t,e[i],e[i+1]);r<n&&(n=r)}return n}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var l=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),u=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/l;if(u<=0)return o.distance(s);if(u>=1)return o.distance(a);var c=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/l;return Math.abs(c)*Math.sqrt(l)}},Gl.isOnLine=function(t,e){for(var n=new Fl,i=1;i<e.length;i++){var r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1},jl.CLOCKWISE.get=function(){return-1},jl.RIGHT.get=function(){return Gl.CLOCKWISE},jl.COUNTERCLOCKWISE.get=function(){return 1},jl.LEFT.get=function(){return Gl.COUNTERCLOCKWISE},jl.COLLINEAR.get=function(){return 0},jl.STRAIGHT.get=function(){return Gl.COLLINEAR},Object.defineProperties(Gl,jl);var zl=function(){};zl.prototype.filter=function(t){},zl.prototype.interfaces_=function(){return[]},zl.prototype.getClass=function(){return zl};var Ul=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},ql={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Ul.prototype.isGeometryCollection=function(){return this.getSortIndex()===Ul.SORTINDEX_GEOMETRYCOLLECTION},Ul.prototype.getFactory=function(){return this._factory},Ul.prototype.getGeometryN=function(t){return this},Ul.prototype.getArea=function(){return 0},Ul.prototype.isRectangle=function(){return!1},Ul.prototype.equals=function(){if(arguments[0]instanceof Ul){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof Ul))return!1;var n=e;return this.equalsExact(n)}},Ul.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},Ul.prototype.geometryChanged=function(){this.apply(Ul.geometryChangedFilter)},Ul.prototype.geometryChangedAction=function(){this._envelope=null},Ul.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},Ul.prototype.getLength=function(){return 0},Ul.prototype.getNumGeometries=function(){return 1},Ul.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,i)}},Ul.prototype.getUserData=function(){return this._userData},Ul.prototype.getSRID=function(){return this._SRID},Ul.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},Ul.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===Ul.SORTINDEX_GEOMETRYCOLLECTION)throw new Za("This method does not support GeometryCollection arguments")},Ul.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},Ul.prototype.norm=function(){var t=this.copy();return t.normalize(),t},Ul.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},Ul.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new El(this._envelope)},Ul.prototype.setSRID=function(t){this._SRID=t},Ul.prototype.setUserData=function(t){this._userData=t},Ul.prototype.compare=function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),o=i.next(),s=r.compareTo(o);if(0!==s)return s}return n.hasNext()?1:i.hasNext()?-1:0},Ul.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},Ul.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Ul.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Ul.SORTINDEX_MULTIPOINT||this.getSortIndex()===Ul.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Ul.SORTINDEX_MULTIPOLYGON},Ul.prototype.interfaces_=function(){return[tl,$a,mr]},Ul.prototype.getClass=function(){return Ul},Ul.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},Ul.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},ql.serialVersionUID.get=function(){return 0x799ea46522854c00},ql.SORTINDEX_POINT.get=function(){return 0},ql.SORTINDEX_MULTIPOINT.get=function(){return 1},ql.SORTINDEX_LINESTRING.get=function(){return 2},ql.SORTINDEX_LINEARRING.get=function(){return 3},ql.SORTINDEX_MULTILINESTRING.get=function(){return 4},ql.SORTINDEX_POLYGON.get=function(){return 5},ql.SORTINDEX_MULTIPOLYGON.get=function(){return 6},ql.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},ql.geometryChangedFilter.get=function(){return Vl},Object.defineProperties(Ul,ql);var Vl=function(){};Vl.interfaces_=function(){return[zl]},Vl.filter=function(t){t.geometryChangedAction()};var Hl=function(){};Hl.prototype.filter=function(t){},Hl.prototype.interfaces_=function(){return[]},Hl.prototype.getClass=function(){return Hl};var Yl=function(){},Xl={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Yl.prototype.isInBoundary=function(t){},Yl.prototype.interfaces_=function(){return[]},Yl.prototype.getClass=function(){return Yl},Xl.Mod2BoundaryNodeRule.get=function(){return Wl},Xl.EndPointBoundaryNodeRule.get=function(){return Kl},Xl.MultiValentEndPointBoundaryNodeRule.get=function(){return Zl},Xl.MonoValentEndPointBoundaryNodeRule.get=function(){return Jl},Xl.MOD2_BOUNDARY_RULE.get=function(){return new Wl},Xl.ENDPOINT_BOUNDARY_RULE.get=function(){return new Kl},Xl.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Zl},Xl.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Jl},Xl.OGC_SFS_BOUNDARY_RULE.get=function(){return Yl.MOD2_BOUNDARY_RULE},Object.defineProperties(Yl,Xl);var Wl=function(){};Wl.prototype.isInBoundary=function(t){return t%2==1},Wl.prototype.interfaces_=function(){return[Yl]},Wl.prototype.getClass=function(){return Wl};var Kl=function(){};Kl.prototype.isInBoundary=function(t){return t>0},Kl.prototype.interfaces_=function(){return[Yl]},Kl.prototype.getClass=function(){return Kl};var Zl=function(){};Zl.prototype.isInBoundary=function(t){return t>1},Zl.prototype.interfaces_=function(){return[Yl]},Zl.prototype.getClass=function(){return Zl};var Jl=function(){};Jl.prototype.isInBoundary=function(t){return 1===t},Jl.prototype.interfaces_=function(){return[Yl]},Jl.prototype.getClass=function(){return Jl};var Ql=function(){};Ql.prototype.add=function(){},Ql.prototype.addAll=function(){},Ql.prototype.isEmpty=function(){},Ql.prototype.iterator=function(){},Ql.prototype.size=function(){},Ql.prototype.toArray=function(){},Ql.prototype.remove=function(){};var $l=function(t){function e(e){t.call(this),this.message=e||""}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={name:{configurable:!0}};return n.name.get=function(){return"IndexOutOfBoundsException"},Object.defineProperties(e,n),e}(Error),tu=function(){};tu.prototype.hasNext=function(){},tu.prototype.next=function(){},tu.prototype.remove=function(){};var eu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(Ql);(_r.prototype=new Error).name="NoSuchElementException";var nu=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ql&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,Ql]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new iu(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new $l;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(eu),iu=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new _r;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(tu),ru=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.ensureCapacity(n.length),this.add(n,i)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=!1,r=e.iterator();r.hasNext();)this.add(r.next(),n),i=!0;return i}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),n=0;n<this.size();n++)e.add(n,this.get(n).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],i=arguments[1];return this.add(n,i,!0),!0}if(arguments[0]instanceof nl&&"boolean"==typeof arguments[1]){var r=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(r))return null;t.prototype.add.call(this,r)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1];return this.add(o,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var a=arguments[0],l=arguments[1];if(arguments[2])for(var u=0;u<a.length;u++)this.add(a[u],l);else for(var c=a.length-1;c>=0;c--)this.add(a[c],l);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof nl){var h=arguments[0],p=arguments[1];if(!arguments[2]){var f=this.size();if(f>0){if(h>0&&this.get(h-1).equals2D(p))return null;if(h<f&&this.get(h).equals2D(p))return null}}t.prototype.add.call(this,h,p)}}else if(4===arguments.length){var d=arguments[0],g=arguments[1],y=arguments[2],m=arguments[3],_=1;y>m&&(_=-1);for(var v=y;v!==m;v+=_)this.add(d[v],g);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new nl(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(nu),ou=function(){},su={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};su.ForwardComparator.get=function(){return au},su.BidirectionalComparator.get=function(){return lu},su.coordArrayType.get=function(){return new Array(0).fill(null)},ou.prototype.interfaces_=function(){return[]},ou.prototype.getClass=function(){return ou},ou.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},ou.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(ou.indexOf(i,e)<0)return i}return null},ou.scroll=function(t,e){var n=ou.indexOf(e,t);if(n<0)return null;var i=new Array(t.length).fill(null);wl.arraycopy(t,n,i,0,t.length-n),wl.arraycopy(t,0,i,t.length-n,n),wl.arraycopy(i,0,t,0,t.length)},ou.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var s=0;s<i.length;s++)if(0!==o.compare(i[s],r[s]))return!1;return!0}},ou.intersection=function(t,e){for(var n=new ru,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},ou.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},ou.removeRepeatedPoints=function(t){return ou.hasRepeatedPoints(t)?new ru(t,!1).toCoordinateArray():t},ou.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},ou.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(i[r++]=t[o]);return i},ou.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new nl(t[n]);return e}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],l=0;l<a;l++)o[s+l]=new nl(i[r+l])},ou.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},ou.envelope=function(t){for(var e=new El,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},ou.toCoordinateArray=function(t){return t.toArray(ou.coordArrayType)},ou.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},ou.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},ou.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},ou.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},ou.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},ou.extract=function(t,e,n){e=ul.clamp(e,0,t.length);var i=(n=ul.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var o=0,s=e;s<=n;s++)r[o++]=t[s];return r},Object.defineProperties(ou,su);var au=function(){};au.prototype.compare=function(t,e){return ou.compare(t,e)},au.prototype.interfaces_=function(){return[el]},au.prototype.getClass=function(){return au};var lu=function(){};lu.prototype.compare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=ou.compare(n,i);return ou.isEqualReversed(n,i)?0:r},lu.prototype.OLDcompare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=ou.increasingDirection(n),o=ou.increasingDirection(i),s=r>0?0:n.length-1,a=o>0?0:n.length-1,l=0;l<n.length;l++){var u=n[s].compareTo(i[a]);if(0!==u)return u;s+=r,a+=o}return 0},lu.prototype.interfaces_=function(){return[el]},lu.prototype.getClass=function(){return lu};var uu=function(){};uu.prototype.get=function(){},uu.prototype.put=function(){},uu.prototype.size=function(){},uu.prototype.values=function(){},uu.prototype.entrySet=function(){};var cu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(uu);(vr.prototype=new Error).name="OperationNotSupported",(xr.prototype=new Ql).contains=function(){};var hu=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ql&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new pu(this)},e}(xr),pu=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new _r;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new vr},e}(tu),fu=0;(Pr.prototype=new cu).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},Pr.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:fu,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,(i=t.compareTo(r.key))<0)r=r.left;else{if(!(i>0)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:n,color:fu,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},Pr.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(wr(t)===Er(wr(wr(t)))){var e=Ir(wr(wr(t)));1===Cr(e)?(br(wr(t),fu),br(e,fu),br(wr(wr(t)),1),t=wr(wr(t))):(t===Ir(wr(t))&&(t=wr(t),this.rotateLeft(t)),br(wr(t),fu),br(wr(wr(t)),1),this.rotateRight(wr(wr(t))))}else{var n=Er(wr(wr(t)));1===Cr(n)?(br(wr(t),fu),br(n,fu),br(wr(wr(t)),1),t=wr(wr(t))):(t===Er(wr(t))&&(t=wr(t),this.rotateRight(t)),br(wr(t),fu),br(wr(wr(t)),1),this.rotateLeft(wr(wr(t))))}this.root_.color=fu},Pr.prototype.values=function(){var t=new nu,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=Pr.successor(e));)t.add(e.value);return t},Pr.prototype.entrySet=function(){var t=new hu,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=Pr.successor(e));)t.add(e);return t},Pr.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},Pr.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},Pr.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},Pr.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,i=t;null!==n&&i===n.right;)i=n,n=n.parent;return n},Pr.prototype.size=function(){return this.size_};var du=function(){};du.prototype.interfaces_=function(){return[]},du.prototype.getClass=function(){return du},Nr.prototype=new xr,(Sr.prototype=new Nr).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},Sr.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},Sr.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},Sr.prototype.remove=function(t){throw new vr},Sr.prototype.size=function(){return this.array_.length},Sr.prototype.isEmpty=function(){return 0===this.array_.length},Sr.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},Sr.prototype.iterator=function(){return new gu(this)};var gu=function(t){this.treeSet_=t,this.position_=0};gu.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new _r;return this.treeSet_.array_[this.position_++]},gu.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},gu.prototype.remove=function(){throw new vr};var yu=function(){};yu.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)i=function(t,e){return t.compareTo(e)},r.sort(i);else if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])},yu.asList=function(t){for(var e=new nu,n=0,i=t.length;n<i;n++)e.add(t[n]);return e};var mu=function(){},_u={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};_u.P.get=function(){return 0},_u.L.get=function(){return 1},_u.A.get=function(){return 2},_u.FALSE.get=function(){return-1},_u.TRUE.get=function(){return-2},_u.DONTCARE.get=function(){return-3},_u.SYM_FALSE.get=function(){return"F"},_u.SYM_TRUE.get=function(){return"T"},_u.SYM_DONTCARE.get=function(){return"*"},_u.SYM_P.get=function(){return"0"},_u.SYM_L.get=function(){return"1"},_u.SYM_A.get=function(){return"2"},mu.prototype.interfaces_=function(){return[]},mu.prototype.getClass=function(){return mu},mu.toDimensionSymbol=function(t){switch(t){case mu.FALSE:return mu.SYM_FALSE;case mu.TRUE:return mu.SYM_TRUE;case mu.DONTCARE:return mu.SYM_DONTCARE;case mu.P:return mu.SYM_P;case mu.L:return mu.SYM_L;case mu.A:return mu.SYM_A}throw new Za("Unknown dimension value: "+t)},mu.toDimensionValue=function(t){switch(fl.toUpperCase(t)){case mu.SYM_FALSE:return mu.FALSE;case mu.SYM_TRUE:return mu.TRUE;case mu.SYM_DONTCARE:return mu.DONTCARE;case mu.SYM_P:return mu.P;case mu.SYM_L:return mu.L;case mu.SYM_A:return mu.A}throw new Za("Unknown dimension symbol: "+t)},Object.defineProperties(mu,_u);var vu=function(){};vu.prototype.filter=function(t){},vu.prototype.interfaces_=function(){return[]},vu.prototype.getClass=function(){return vu};var xu=function(){};xu.prototype.filter=function(t,e){},xu.prototype.isDone=function(){},xu.prototype.isGeometryChanged=function(){},xu.prototype.interfaces_=function(){return[]},xu.prototype.getClass=function(){return xu};var Cu=function(t){function e(e,n){if(t.call(this,n),this._geometries=e||[],t.hasNullElements(this._geometries))throw new Za("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new El,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var i=this._geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e;if(this._geometries.length!==i._geometries.length)return!1;for(var r=0;r<this._geometries.length;r++)if(!this._geometries[r].equalsExact(i._geometries[r],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();yu.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=mu.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=mu.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new Sr(yu.asList(this._geometries)),n=new Sr(yu.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o=i,s=this.getNumGeometries(),a=o.getNumGeometries(),l=0;l<s&&l<a;){var u=this.getGeometryN(l),c=o.getGeometryN(l),h=u.compareToSameClass(c,r);if(0!==h)return h;l++}return l<s?1:l<a?-1:0}},e.prototype.apply=function(){if(ll(arguments[0],Hl))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(ll(arguments[0],xu)){var n=arguments[0];if(0===this._geometries.length)return null;for(var i=0;i<this._geometries.length&&(this._geometries[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(ll(arguments[0],vu)){var r=arguments[0];r.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(r)}else if(ll(arguments[0],zl)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),Rl.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var n=0;n<this._geometries.length;n++)e._geometries[n]=this._geometries[n].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,n),e}(Ul),wu=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Ul.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?mu.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new bu(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[du]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,n),e}(Cu),bu=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=Yl.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=i}};bu.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},bu.prototype.getBoundary=function(){return this._geom instanceof Su?this.boundaryLineString(this._geom):this._geom instanceof wu?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},bu.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},bu.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},bu.prototype.computeBoundaryCoordinates=function(t){var e=new nu;this._endpointMap=new Pr;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return ou.toCoordinateArray(e)},bu.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Eu,this._endpointMap.put(t,e)),e.count++},bu.prototype.interfaces_=function(){return[]},bu.prototype.getClass=function(){return bu},bu.getBoundary=function(){if(1===arguments.length){var t=arguments[0];return new bu(t).getBoundary()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new bu(e,n).getBoundary()}};var Eu=function(){this.count=null};Eu.prototype.interfaces_=function(){return[]},Eu.prototype.getClass=function(){return Eu};var Iu=function(){},Pu={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Iu.prototype.interfaces_=function(){return[]},Iu.prototype.getClass=function(){return Iu},Iu.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;i<e;i++)n[i]=t;return String(n)},Iu.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o="",s=new function(){}(new function(){}(Iu.getStackTrace(i))),a=0;a<r;a++)try{o+=s.readLine()+Iu.NEWLINE}catch(t){if(!(t instanceof Tr))throw t;Rl.shouldNeverReachHere()}return o}},Iu.split=function(t,e){for(var n=e.length,i=new nu,r=""+t,o=r.indexOf(e);o>=0;){var s=r.substring(0,o);i.add(s),o=(r=r.substring(o+n)).indexOf(e)}r.length>0&&i.add(r);for(var a=new Array(i.size()).fill(null),l=0;l<a.length;l++)a[l]=i.get(l);return a},Iu.toString=function(){if(1===arguments.length){var t=arguments[0];return Iu.SIMPLE_ORDINATE_FORMAT.format(t)}},Iu.spaces=function(t){return Iu.chars(" ",t)},Pu.NEWLINE.get=function(){return wl.getProperty("line.separator")},Pu.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(Iu,Pu);var Nu=function(){};Nu.prototype.interfaces_=function(){return[]},Nu.prototype.getClass=function(){return Nu},Nu.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),o=0;o<r;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))},Nu.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,_l.X)===t.getOrdinate(e-1,_l.X)&&t.getOrdinate(0,_l.Y)===t.getOrdinate(e-1,_l.Y)},Nu.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),r=0;r<n;r++)for(var o=0;o<i;o++){var s=t.getOrdinate(r,o),a=e.getOrdinate(r,o);if(!(t.getOrdinate(r,o)===e.getOrdinate(r,o)||Ja.isNaN(s)&&Ja.isNaN(a)))return!1}return!0},Nu.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(Nu.copy(e,0,i,0,r),r>0)for(var o=r;o<n;o++)Nu.copy(e,r-1,i,o,1);return i},Nu.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;i<=n;i++)Nu.swap(t,i,e-i)},Nu.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},Nu.copy=function(t,e,n,i,r){for(var o=0;o<r;o++)Nu.copyCoord(t,e+o,n,i+o)},Nu.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new hl;i.append("(");for(var r=0;r<e;r++){r>0&&i.append(" ");for(var o=0;o<n;o++)o>0&&i.append(","),i.append(Iu.toString(t.getOrdinate(r,o)))}return i.append(")"),i.toString()}},Nu.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Nu.createClosedRing(t,e,4):e.getOrdinate(0,_l.X)===e.getOrdinate(n-1,_l.X)&&e.getOrdinate(0,_l.Y)===e.getOrdinate(n-1,_l.Y)?e:Nu.createClosedRing(t,e,n+1)},Nu.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();Nu.copy(e,0,i,0,r);for(var o=r;o<n;o++)Nu.copy(e,0,i,o,1);return i};var Su=function(t){function e(e,n){t.call(this,n),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new El:this._points.expandEnvelope(new El)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e;if(this._points.size()!==i._points.size())return!1;for(var r=0;r<this._points.size();r++)if(!this.equal(this._points.getCoordinate(r),i._points.getCoordinate(r),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&Nu.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?mu.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return Gl.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Nu.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}},e.prototype.apply=function(){if(ll(arguments[0],Hl))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(ll(arguments[0],xu)){var n=arguments[0];if(0===this._points.size())return null;for(var i=0;i<this._points.size()&&(n.filter(this._points,i),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else(ll(arguments[0],vu)||ll(arguments[0],zl))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new bu(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new Za("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[du]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(Ul),Tu=function(){};Tu.prototype.interfaces_=function(){return[]},Tu.prototype.getClass=function(){return Tu};var Lu=function(t){function e(e,n){t.call(this,n),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new El;var t=new El;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),n))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return mu.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(ll(arguments[0],Hl)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(ll(arguments[0],xu)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(ll(arguments[0],vu)||ll(arguments[0],zl))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),Rl.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Tu]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,n),e}(Ul),Mu=function(){};Mu.prototype.interfaces_=function(){return[]},Mu.prototype.getClass=function(){return Mu};var Ou=function(t){function e(e,n,i){if(t.call(this,i),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===n&&(n=[]),t.hasNullElements(n))throw new Za("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(n))throw new Za("shell is empty but holes are not");this._shell=e,this._holes=n}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(Gl.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(Gl.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var l=t.getX(a),u=t.getY(a);if(l!==o==(u!==s))return!1;o=l,s=u}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e,r=this._shell,o=i._shell;if(!r.equalsExact(o,n))return!1;if(this._holes.length!==i._holes.length)return!1;for(var s=0;s<this._holes.length;s++)if(!this._holes[s].equalsExact(i._holes[s],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);yu.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);wl.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=ou.minCoordinate(e.getCoordinates());ou.scroll(i,r),wl.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],Gl.isCCW(e.getCoordinates())===n&&ou.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[0],r=arguments[1],o=i,s=this._shell,a=o._shell,l=s.compareToSameClass(a,r);if(0!==l)return l;for(var u=this.getNumInteriorRing(),c=o.getNumInteriorRing(),h=0;h<u&&h<c;){var p=this.getInteriorRingN(h),f=o.getInteriorRingN(h),d=p.compareToSameClass(f,r);if(0!==d)return d;h++}return h<u?1:h<c?-1:0}},e.prototype.apply=function(t){if(ll(t,Hl)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(ll(t,xu)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(ll(t,vu))t.filter(this);else if(ll(t,zl)){t.filter(this),this._shell.apply(t);for(var i=0;i<this._holes.length;i++)this._holes[i].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var n=0;n<this._holes.length;n++)e._holes[n]=this._holes[n].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),i=0;i<n.length;i++)n[i]=this._holes[i].copy();return new e(t,n,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[Mu]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(Ul),Ru=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Ul.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return mu.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Tu]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,n),e}(Cu),Au=function(t){function e(e,n){e instanceof nl&&n instanceof Zu&&(e=n.getCoordinateSequenceFactory().create(e)),t.call(this,e,n),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Ul.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return mu.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return Nu.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new Za("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new Za("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(Su),Du=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Ul.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new nu,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Mu]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(Cu),Fu=function(t){this._factory=t||null,this._isUserDataCopied=!1},ku={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Fu.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},Fu.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},Fu.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof Cu?this.editGeometryCollection(t,e):t instanceof Ou?this.editPolygon(t,e):t instanceof Lu||t instanceof Su?e.edit(t,this._factory):(Rl.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},Fu.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),i=new nu,r=0;r<n.getNumGeometries();r++){var o=this.edit(n.getGeometryN(r),e);null===o||o.isEmpty()||i.add(o)}return n.getClass()===Ru?this._factory.createMultiPoint(i.toArray([])):n.getClass()===wu?this._factory.createMultiLineString(i.toArray([])):n.getClass()===Du?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))},Fu.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this._factory.createPolygon();for(var r=new nu,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(i,r.toArray([]))},Fu.prototype.interfaces_=function(){return[]},Fu.prototype.getClass=function(){return Fu},Fu.GeometryEditorOperation=function(){},ku.NoOpGeometryOperation.get=function(){return Bu},ku.CoordinateOperation.get=function(){return Gu},ku.CoordinateSequenceOperation.get=function(){return ju},Object.defineProperties(Fu,ku);var Bu=function(){};Bu.prototype.edit=function(t,e){return t},Bu.prototype.interfaces_=function(){return[Fu.GeometryEditorOperation]},Bu.prototype.getClass=function(){return Bu};var Gu=function(){};Gu.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof Au?e.createLinearRing(n):t instanceof Su?e.createLineString(n):t instanceof Lu?n.length>0?e.createPoint(n[0]):e.createPoint():t},Gu.prototype.interfaces_=function(){return[Fu.GeometryEditorOperation]},Gu.prototype.getClass=function(){return Gu};var ju=function(){};ju.prototype.edit=function(t,e){return t instanceof Au?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Su?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Lu?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},ju.prototype.interfaces_=function(){return[Fu.GeometryEditorOperation]},ju.prototype.getClass=function(){return ju};var zu=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new nl}else if(ll(arguments[0],_l)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var i=0;i<this._coordinates.length;i++)this._coordinates[i]=n.getCoordinateCopy(i)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],o=arguments[1];this._coordinates=r,this._dimension=o,null===r&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=a;for(var l=0;l<s;l++)this._coordinates[l]=new nl}},Uu={serialVersionUID:{configurable:!0}};zu.prototype.setOrdinate=function(t,e,n){switch(e){case _l.X:this._coordinates[t].x=n;break;case _l.Y:this._coordinates[t].y=n;break;case _l.Z:this._coordinates[t].z=n;break;default:throw new Za("invalid ordinateIndex")}},zu.prototype.size=function(){return this._coordinates.length},zu.prototype.getOrdinate=function(t,e){switch(e){case _l.X:return this._coordinates[t].x;case _l.Y:return this._coordinates[t].y;case _l.Z:return this._coordinates[t].z}return Ja.NaN},zu.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},zu.prototype.getCoordinateCopy=function(t){return new nl(this._coordinates[t])},zu.prototype.getDimension=function(){return this._dimension},zu.prototype.getX=function(t){return this._coordinates[t].x},zu.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new zu(t,this._dimension)},zu.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},zu.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new zu(t,this._dimension)},zu.prototype.toString=function(){if(this._coordinates.length>0){var t=new hl(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},zu.prototype.getY=function(t){return this._coordinates[t].y},zu.prototype.toCoordinateArray=function(){return this._coordinates},zu.prototype.interfaces_=function(){return[_l,mr]},zu.prototype.getClass=function(){return zu},Uu.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(zu,Uu);var qu=function(){},Vu={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};qu.prototype.readResolve=function(){return qu.instance()},qu.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new zu(t)}if(ll(arguments[0],_l)){var e=arguments[0];return new zu(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return i>3&&(i=3),i<2?new zu(n):new zu(n,i)}},qu.prototype.interfaces_=function(){return[ol,mr]},qu.prototype.getClass=function(){return qu},qu.instance=function(){return qu.instanceObject},Vu.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},Vu.instanceObject.get=function(){return new qu},Object.defineProperties(qu,Vu);var Hu=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new nu,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var t=new hu;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(uu),Yu=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Wu){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}},Xu={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Yu.prototype.equals=function(t){if(!(t instanceof Yu))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},Yu.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new pl(n).compareTo(new pl(i))},Yu.prototype.getScale=function(){return this._scale},Yu.prototype.isFloating=function(){return this._modelType===Yu.FLOATING||this._modelType===Yu.FLOATING_SINGLE},Yu.prototype.getType=function(){return this._modelType},Yu.prototype.toString=function(){var t="UNKNOWN";return this._modelType===Yu.FLOATING?t="Floating":this._modelType===Yu.FLOATING_SINGLE?t="Floating-Single":this._modelType===Yu.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},Yu.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return Ja.isNaN(t)||this._modelType===Yu.FLOATING_SINGLE?t:this._modelType===Yu.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof nl){var e=arguments[0];if(this._modelType===Yu.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},Yu.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===Yu.FLOATING?t=16:this._modelType===Yu.FLOATING_SINGLE?t=6:this._modelType===Yu.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},Yu.prototype.setScale=function(t){this._scale=Math.abs(t)},Yu.prototype.interfaces_=function(){return[mr,$a]},Yu.prototype.getClass=function(){return Yu},Yu.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},Xu.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},Xu.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(Yu,Xu);var Wu=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},Ku={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Wu.prototype.readResolve=function(){return Wu.nameToTypeMap.get(this._name)},Wu.prototype.toString=function(){return this._name},Wu.prototype.interfaces_=function(){return[mr]},Wu.prototype.getClass=function(){return Wu},Ku.serialVersionUID.get=function(){return-552860263173159e4},Ku.nameToTypeMap.get=function(){return new Hu},Object.defineProperties(Wu,Ku),Yu.Type=Wu,Yu.FIXED=new Wu("FIXED"),Yu.FLOATING=new Wu("FLOATING"),Yu.FLOATING_SINGLE=new Wu("FLOATING SINGLE");var Zu=function t(){this._precisionModel=new Yu,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?ll(arguments[0],ol)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Yu&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Ju={serialVersionUID:{configurable:!0}};Zu.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new nl(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new nl(t.getMinX(),t.getMinY()),new nl(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new nl(t.getMinX(),t.getMinY()),new nl(t.getMinX(),t.getMaxY()),new nl(t.getMaxX(),t.getMaxY()),new nl(t.getMaxX(),t.getMinY()),new nl(t.getMinX(),t.getMinY())]),null)},Zu.prototype.createLineString=function(t){return t?t instanceof Array?new Su(this.getCoordinateSequenceFactory().create(t),this):ll(t,_l)?new Su(t,this):void 0:new Su(this.getCoordinateSequenceFactory().create([]),this)},Zu.prototype.createMultiLineString=function(){if(0===arguments.length)return new wu(null,this);if(1===arguments.length){var t=arguments[0];return new wu(t,this)}},Zu.prototype.buildGeometry=function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(Zu.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof Ou)return this.createMultiPolygon(Zu.toPolygonArray(t));if(a instanceof Su)return this.createMultiLineString(Zu.toLineStringArray(t));if(a instanceof Lu)return this.createMultiPoint(Zu.toPointArray(t));Rl.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},Zu.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},Zu.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof nl){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(ll(arguments[0],_l)){var e=arguments[0];return new Lu(e,this)}}},Zu.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},Zu.prototype.createPolygon=function(){if(0===arguments.length)return new Ou(null,null,this);if(1===arguments.length){if(ll(arguments[0],_l)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Au){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return new Ou(i,r,this)}},Zu.prototype.getSRID=function(){return this._SRID},Zu.prototype.createGeometryCollection=function(){if(0===arguments.length)return new Cu(null,this);if(1===arguments.length){var t=arguments[0];return new Cu(t,this)}},Zu.prototype.createGeometry=function(t){return new Fu(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},Zu.prototype.getPrecisionModel=function(){return this._precisionModel},Zu.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(ll(arguments[0],_l)){var e=arguments[0];return new Au(e,this)}}},Zu.prototype.createMultiPolygon=function(){if(0===arguments.length)return new Du(null,this);if(1===arguments.length){var t=arguments[0];return new Du(t,this)}},Zu.prototype.createMultiPoint=function(){if(0===arguments.length)return new Ru(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new Ru(t,this)}if(arguments[0]instanceof Array){var e=arguments[0];return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(ll(arguments[0],_l)){var n=arguments[0];if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var i=new Array(n.size()).fill(null),r=0;r<n.size();r++){var o=this.getCoordinateSequenceFactory().create(1,n.getDimension());Nu.copy(n,r,o,0,1),i[r]=this.createPoint(o)}return this.createMultiPoint(i)}}},Zu.prototype.interfaces_=function(){return[mr]},Zu.prototype.getClass=function(){return Zu},Zu.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Zu.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},Zu.getDefaultCoordinateSequenceFactory=function(){return qu.instance()},Zu.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Zu.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Zu.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Zu.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Zu.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Zu.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Zu.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},Ju.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(Zu,Ju);var Qu=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],$u=function(t){this.geometryFactory=t||new Zu};$u.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!tc[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==Qu.indexOf(n)?tc[n].apply(this,[e.coordinates]):"GeometryCollection"===n?tc[n].apply(this,[e.geometries]):tc[n].apply(this,[e])},$u.prototype.write=function(t){var e=t.getGeometryType();if(!ec[e])throw new Error("Geometry is not supported");return ec[e].apply(this,[t])};var tc={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!tc[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=tc.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new nl(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new nl(t[0],t[1]),new nl(t[2],t[1]),new nl(t[2],t[3]),new nl(t[0],t[3]),new nl(t[0],t[1])])},Point:function(t){var e=new nl(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(tc.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=tc.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(tc.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=tc.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var o=t[r],s=tc.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(tc.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},ec={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:ec.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=ec.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(ec.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=ec.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=ec.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var i=0;i<t._holes.length;++i){var r=t._holes[i],o=ec.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=ec.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=i.getGeometryType();e.push(ec[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}},nc=function(t){this.geometryFactory=t||new Zu,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new $u(this.geometryFactory)};nc.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Yu.FIXED&&this.reducePrecision(e),e},nc.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var ic=function(){this.parser=new $u(this.geometryFactory)};ic.prototype.write=function(t){return this.parser.write(t)};var rc=function(){},oc={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};rc.prototype.interfaces_=function(){return[]},rc.prototype.getClass=function(){return rc},rc.opposite=function(t){return t===rc.LEFT?rc.RIGHT:t===rc.RIGHT?rc.LEFT:t},oc.ON.get=function(){return 0},oc.LEFT.get=function(){return 1},oc.RIGHT.get=function(){return 2},Object.defineProperties(rc,oc),(Lr.prototype=new Error).name="EmptyStackException",(Mr.prototype=new eu).add=function(t){return this.array_.push(t),!0},Mr.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},Mr.prototype.push=function(t){return this.array_.push(t),t},Mr.prototype.pop=function(t){if(0===this.array_.length)throw new Lr;return this.array_.pop()},Mr.prototype.peek=function(){if(0===this.array_.length)throw new Lr;return this.array_[this.array_.length-1]},Mr.prototype.empty=function(){return 0===this.array_.length},Mr.prototype.isEmpty=function(){return this.empty()},Mr.prototype.search=function(t){return this.array_.indexOf(t)},Mr.prototype.size=function(){return this.array_.length},Mr.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var sc=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};sc.prototype.getCoordinate=function(){return this._minCoord},sc.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},sc.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();Rl.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],i=Gl.computeOrientation(this._minCoord,n,e),r=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===Gl.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===Gl.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)},sc.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=rc.LEFT;return n[e].y<n[e+1].y&&(i=rc.RIGHT),i},sc.prototype.getEdge=function(){return this._orientedDe},sc.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},sc.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},sc.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}Rl.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===rc.LEFT&&(this._orientedDe=this._minDe.getSym())},sc.prototype.interfaces_=function(){return[]},sc.prototype.getClass=function(){return sc};var ac=function(t){function e(n,i){t.call(this,e.msgWithCoord(n,i)),this.pt=i?new nl(i):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}(Ml),lc=function(){this.array_=[]};lc.prototype.addLast=function(t){this.array_.push(t)},lc.prototype.removeFirst=function(){return this.array_.shift()},lc.prototype.isEmpty=function(){return 0===this.array_.length};var uc=function(){this._finder=null,this._dirEdgeList=new nu,this._nodes=new nu,this._rightMostCoord=null,this._env=null,this._finder=new sc};uc.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},uc.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},uc.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new ac("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},uc.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(rc.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},uc.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},uc.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(rc.RIGHT)>=1&&e.getDepth(rc.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},uc.prototype.computeDepths=function(t){var e=new hu,n=new lc,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},uc.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},uc.prototype.getEnvelope=function(){if(null===this._env){for(var t=new El,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this._env=t}return this._env},uc.prototype.addReachable=function(t){var e=new Mr;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},uc.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(rc.LEFT,t.getDepth(rc.RIGHT)),e.setDepth(rc.RIGHT,t.getDepth(rc.LEFT))},uc.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}},uc.prototype.getNodes=function(){return this._nodes},uc.prototype.getDirectedEdges=function(){return this._dirEdgeList},uc.prototype.interfaces_=function(){return[$a]},uc.prototype.getClass=function(){return uc};var cc=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[rc.ON]=n}else if(arguments[0]instanceof t){var i=arguments[0];if(this.init(i.location.length),null!==i)for(var r=0;r<this.location.length;r++)this.location[r]=i.location[r]}}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.init(3),this.location[rc.ON]=o,this.location[rc.LEFT]=s,this.location[rc.RIGHT]=a}};cc.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},cc.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==sl.NONE)return!1;return!0},cc.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===sl.NONE&&(this.location[e]=t)},cc.prototype.isLine=function(){return 1===this.location.length},cc.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[rc.ON]=this.location[rc.ON],e[rc.LEFT]=sl.NONE,e[rc.RIGHT]=sl.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===sl.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},cc.prototype.getLocations=function(){return this.location},cc.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[rc.LEFT];this.location[rc.LEFT]=this.location[rc.RIGHT],this.location[rc.RIGHT]=t},cc.prototype.toString=function(){var t=new hl;return this.location.length>1&&t.append(sl.toLocationSymbol(this.location[rc.LEFT])),t.append(sl.toLocationSymbol(this.location[rc.ON])),this.location.length>1&&t.append(sl.toLocationSymbol(this.location[rc.RIGHT])),t.toString()},cc.prototype.setLocations=function(t,e,n){this.location[rc.ON]=t,this.location[rc.LEFT]=e,this.location[rc.RIGHT]=n},cc.prototype.get=function(t){return t<this.location.length?this.location[t]:sl.NONE},cc.prototype.isArea=function(){return this.location.length>1},cc.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===sl.NONE)return!0;return!1},cc.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(rc.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},cc.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(sl.NONE)},cc.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},cc.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},cc.prototype.interfaces_=function(){return[]},cc.prototype.getClass=function(){return cc};var hc=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new cc(e),this.elt[1]=new cc(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new cc(n.elt[0]),this.elt[1]=new cc(n.elt[1])}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.elt[0]=new cc(sl.NONE),this.elt[1]=new cc(sl.NONE),this.elt[i].setLocation(r)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new cc(o,s,a),this.elt[1]=new cc(o,s,a)}else if(4===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2],h=arguments[3];this.elt[0]=new cc(sl.NONE,sl.NONE,sl.NONE),this.elt[1]=new cc(sl.NONE,sl.NONE,sl.NONE),this.elt[l].setLocations(u,c,h)}};hc.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},hc.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},hc.prototype.isNull=function(t){return this.elt[t].isNull()},hc.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},hc.prototype.isLine=function(t){return this.elt[t].isLine()},hc.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new cc(t.elt[e]):this.elt[e].merge(t.elt[e])},hc.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},hc.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(rc.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},hc.prototype.toString=function(){var t=new hl;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},hc.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},hc.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},hc.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(rc.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},hc.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},hc.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},hc.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new cc(this.elt[t].location[0]))},hc.prototype.interfaces_=function(){return[]},hc.prototype.getClass=function(){return hc},hc.toLineLabel=function(t){for(var e=new hc(sl.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var pc=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new nu,this._pts=new nu,this._label=new hc(sl.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new nu,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};pc.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=Gl.isCCW(this._ring.getCoordinates())},pc.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},pc.prototype.computePoints=function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new ac("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new ac("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var i=e.getLabel();Rl.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},pc.prototype.getLinearRing=function(){return this._ring},pc.prototype.getCoordinate=function(t){return this._pts.get(t)},pc.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},pc.prototype.addPoints=function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var o=r;o<i.length;o++)this._pts.add(i[o])}else{var s=i.length-2;n&&(s=i.length-1);for(var a=s;a>=0;a--)this._pts.add(i[a])}},pc.prototype.isHole=function(){return this._isHole},pc.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},pc.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!Gl.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},pc.prototype.addHole=function(t){this._holes.add(t)},pc.prototype.isShell=function(){return null===this._shell},pc.prototype.getLabel=function(){return this._label},pc.prototype.getEdges=function(){return this._edges},pc.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},pc.prototype.getShell=function(){return this._shell},pc.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=e.getLocation(n,rc.RIGHT);if(i===sl.NONE)return null;if(this._label.getLocation(n)===sl.NONE)return this._label.setLocation(n,i),null}},pc.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},pc.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},pc.prototype.interfaces_=function(){return[]},pc.prototype.getClass=function(){return pc};var fc=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(pc),dc=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new nu,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new fc(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(pc),gc=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};gc.prototype.setVisited=function(t){this._isVisited=t},gc.prototype.setInResult=function(t){this._isInResult=t},gc.prototype.isCovered=function(){return this._isCovered},gc.prototype.isCoveredSet=function(){return this._isCoveredSet},gc.prototype.setLabel=function(t){this._label=t},gc.prototype.getLabel=function(){return this._label},gc.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},gc.prototype.updateIM=function(t){Rl.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},gc.prototype.isInResult=function(){return this._isInResult},gc.prototype.isVisited=function(){return this._isVisited},gc.prototype.interfaces_=function(){return[]},gc.prototype.getClass=function(){return gc};var yc=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],n=arguments[1];this._coord=e,this._edges=n,this._label=new hc(0,sl.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var n=sl.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==sl.BOUNDARY&&(n=i)}return n},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],n=arguments[1];null===this._label?this._label=new hc(e,n):this._label.setLocation(e,n)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof hc)for(var n=arguments[0],i=0;i<2;i++){var r=this.computeMergedLocation(n,i);this._label.getLocation(i)===sl.NONE&&this._label.setLocation(i,r)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=sl.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case sl.BOUNDARY:n=sl.INTERIOR;break;case sl.INTERIOR:default:n=sl.BOUNDARY}this._label.setLocation(t,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(gc),mc=function(){this.nodeMap=new Pr,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};mc.prototype.find=function(t){return this.nodeMap.get(t)},mc.prototype.addNode=function(){if(arguments[0]instanceof nl){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof yc){var n=arguments[0],i=this.nodeMap.get(n.getCoordinate());return null===i?(this.nodeMap.put(n.getCoordinate(),n),n):(i.mergeLabel(n),i)}},mc.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},mc.prototype.iterator=function(){return this.nodeMap.values().iterator()},mc.prototype.values=function(){return this.nodeMap.values()},mc.prototype.getBoundaryNodes=function(t){for(var e=new nu,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===sl.BOUNDARY&&e.add(i)}return e},mc.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},mc.prototype.interfaces_=function(){return[]},mc.prototype.getClass=function(){return mc};var _c=function(){},vc={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};_c.prototype.interfaces_=function(){return[]},_c.prototype.getClass=function(){return _c},_c.isNorthern=function(t){return t===_c.NE||t===_c.NW},_c.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},_c.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},_c.isInHalfPlane=function(t,e){return e===_c.SE?t===_c.SE||t===_c.SW:t===e||t===e+1},_c.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new Za("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?_c.NE:_c.SE:e>=0?_c.NW:_c.SW}if(arguments[0]instanceof nl&&arguments[1]instanceof nl){var n=arguments[0],i=arguments[1];if(i.x===n.x&&i.y===n.y)throw new Za("Cannot compute the quadrant for two identical points "+n);return i.x>=n.x?i.y>=n.y?_c.NE:_c.SE:i.y>=n.y?_c.NW:_c.SW}},vc.NE.get=function(){return 0},vc.NW.get=function(){return 1},vc.SW.get=function(){return 2},vc.SE.get=function(){return 3},Object.defineProperties(_c,vc);var xc=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];this._edge=e,this.init(n,i),this._label=null}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this._edge=r,this.init(o,s),this._label=a}};xc.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:Gl.computeOrientation(t._p0,t._p1,this._p1)},xc.prototype.getDy=function(){return this._dy},xc.prototype.getCoordinate=function(){return this._p0},xc.prototype.setNode=function(t){this._node=t},xc.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},xc.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},xc.prototype.getDirectedCoordinate=function(){return this._p1},xc.prototype.getDx=function(){return this._dx},xc.prototype.getLabel=function(){return this._label},xc.prototype.getEdge=function(){return this._edge},xc.prototype.getQuadrant=function(){return this._quadrant},xc.prototype.getNode=function(){return this._node},xc.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},xc.prototype.computeLabel=function(t){},xc.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=_c.quadrant(this._dx,this._dy),Rl.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},xc.prototype.interfaces_=function(){return[$a]},xc.prototype.getClass=function(){return xc};var Cc=function(t){function e(){var e=arguments[0],n=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=n,n)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var i=e.getNumPoints()-1;this.init(e.getCoordinate(i),e.getCoordinate(i-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new hc(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new ac("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,rc.LEFT)===sl.INTERIOR&&this._label.getLocation(e,rc.RIGHT)===sl.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[rc.LEFT]+"/"+this._depth[rc.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,sl.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,sl.EXTERIOR);return t&&e&&n},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===rc.LEFT&&(i=-1);var r=rc.opposite(t),o=e+n*i;this.setDepth(t,e),this.setDepth(r,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===sl.EXTERIOR&&e===sl.INTERIOR?1:t===sl.INTERIOR&&e===sl.EXTERIOR?-1:0},e}(xc),wc=function(){};wc.prototype.createNode=function(t){return new yc(t,null)},wc.prototype.interfaces_=function(){return[]},wc.prototype.getClass=function(){return wc};var bc=function(){if(this._edges=new nu,this._nodes=null,this._edgeEndList=new nu,0===arguments.length)this._nodes=new mc(new wc);else if(1===arguments.length){var t=arguments[0];this._nodes=new mc(t)}};bc.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},bc.prototype.find=function(t){return this._nodes.find(t)},bc.prototype.addNode=function(){if(arguments[0]instanceof yc){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof nl){var e=arguments[0];return this._nodes.addNode(e)}},bc.prototype.getNodeIterator=function(){return this._nodes.iterator()},bc.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},bc.prototype.debugPrintln=function(t){wl.out.println(t)},bc.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===sl.BOUNDARY},bc.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},bc.prototype.matchInSameDirection=function(t,e,n,i){return!!t.equals(n)&&Gl.computeOrientation(t,e,i)===Gl.COLLINEAR&&_c.quadrant(t,e)===_c.quadrant(n,i)},bc.prototype.getEdgeEnds=function(){return this._edgeEndList},bc.prototype.debugPrint=function(t){wl.out.print(t)},bc.prototype.getEdgeIterator=function(){return this._edges.iterator()},bc.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},bc.prototype.insertEdge=function(t){this._edges.add(t)},bc.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},bc.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var i=new Cc(n,!0),r=new Cc(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},bc.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},bc.prototype.getNodes=function(){return this._nodes.values()},bc.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},bc.prototype.interfaces_=function(){return[]},bc.prototype.getClass=function(){return bc},bc.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var Ec=function(){this._geometryFactory=null,this._shellList=new nu;var t=arguments[0];this._geometryFactory=t};Ec.prototype.sortShellsAndHoles=function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},Ec.prototype.computePolygons=function(t){for(var e=new nu,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);e.add(i)}return e},Ec.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new ac("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},Ec.prototype.buildMinimalEdgeRings=function(t,e,n){for(var i=new nu,r=t.iterator();r.hasNext();){var o=r.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else i.add(o)}return i},Ec.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},Ec.prototype.buildMaximalEdgeRings=function(t){for(var e=new nu,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new dc(i,this._geometryFactory);e.add(r),r.setInResult()}}return e},Ec.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},Ec.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Ec.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var l=a.next(),u=l.getLinearRing(),c=u.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var h=!1;c.contains(i)&&Gl.isPointInRing(r,u.getCoordinates())&&(h=!0),h&&(null===o||s.contains(c))&&(o=l)}return o},Ec.prototype.findShell=function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return Rl.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},Ec.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];bc.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new nu,o=this.buildMinimalEdgeRings(i,this._shellList,r);this.sortShellsAndHoles(o,this._shellList,r),this.placeFreeHoles(this._shellList,r)}},Ec.prototype.interfaces_=function(){return[]},Ec.prototype.getClass=function(){return Ec};var Ic=function(){};Ic.prototype.getBounds=function(){},Ic.prototype.interfaces_=function(){return[]},Ic.prototype.getClass=function(){return Ic};var Pc=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};Pc.prototype.getItem=function(){return this._item},Pc.prototype.getBounds=function(){return this._bounds},Pc.prototype.interfaces_=function(){return[Ic,mr]},Pc.prototype.getClass=function(){return Pc};var Nc=function(){this._size=null,this._items=null,this._size=0,this._items=new nu,this._items.add(null)};Nc.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},Nc.prototype.size=function(){return this._size},Nc.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},Nc.prototype.clear=function(){this._size=0,this._items.clear()},Nc.prototype.isEmpty=function(){return 0===this._size},Nc.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Nc.prototype.interfaces_=function(){return[]},Nc.prototype.getClass=function(){return Nc};var Sc=function(){};Sc.prototype.visitItem=function(t){},Sc.prototype.interfaces_=function(){return[]},Sc.prototype.getClass=function(){return Sc};var Tc=function(){};Tc.prototype.insert=function(t,e){},Tc.prototype.remove=function(t,e){},Tc.prototype.query=function(){},Tc.prototype.interfaces_=function(){return[]},Tc.prototype.getClass=function(){return Tc};var Lc=function(){if(this._childBoundables=new nu,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Mc={serialVersionUID:{configurable:!0}};Lc.prototype.getLevel=function(){return this._level},Lc.prototype.size=function(){return this._childBoundables.size()},Lc.prototype.getChildBoundables=function(){return this._childBoundables},Lc.prototype.addChildBoundable=function(t){Rl.isTrue(null===this._bounds),this._childBoundables.add(t)},Lc.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Lc.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Lc.prototype.interfaces_=function(){return[Ic,mr]},Lc.prototype.getClass=function(){return Lc},Mc.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Lc,Mc);var Oc=function(){};Oc.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},Oc.min=function(t){return Oc.sort(t),t.get(0)},Oc.sort=function(t,e){var n=t.toArray();e?yu.sort(n,e):yu.sort(n);for(var i=t.iterator(),r=0,o=n.length;r<o;r++)i.next(),i.set(n[r])},Oc.singletonList=function(t){var e=new nu;return e.add(t),e};var Rc=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};Rc.prototype.expandToQueue=function(t,e){var n=Rc.isComposite(this._boundable1),i=Rc.isComposite(this._boundable2);if(n&&i)return Rc.area(this._boundable1)>Rc.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new Za("neither boundable is composite")},Rc.prototype.isLeaves=function(){return!(Rc.isComposite(this._boundable1)||Rc.isComposite(this._boundable2))},Rc.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},Rc.prototype.expand=function(t,e,n,i){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),s=new Rc(o,e,this._itemDistance);s.getDistance()<i&&n.add(s)}},Rc.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},Rc.prototype.getDistance=function(){return this._distance},Rc.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Rc.prototype.interfaces_=function(){return[$a]},Rc.prototype.getClass=function(){return Rc},Rc.area=function(t){return t.getBounds().getArea()},Rc.isComposite=function(t){return t instanceof Lc};var Ac=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new nu,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];Rl.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},Dc={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Ac.prototype.getNodeCapacity=function(){return this._nodeCapacity},Ac.prototype.lastNode=function(t){return t.get(t.size()-1)},Ac.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Lc?t+=this.size(n):n instanceof Pc&&(t+=1)}return t}},Ac.prototype.removeItem=function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof Pc&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},Ac.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new nu:t}if(1===arguments.length){for(var e=arguments[0],n=new nu,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof Lc){var o=this.itemsTree(r);null!==o&&n.add(o)}else r instanceof Pc?n.add(r.getItem()):Rl.shouldNeverReachHere()}return n.size()<=0?null:n}},Ac.prototype.insert=function(t,e){Rl.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Pc(t,e))},Ac.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new nu;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(Rl.isTrue(n>-2),i.getLevel()===n)return r.add(i),null;for(var o=i.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof Lc?this.boundablesAtLevel(n,s,r):(Rl.isTrue(s instanceof Pc),-1===n&&r.add(s))}return null}},Ac.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new nu;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,i)}else if(3===arguments.length)if(ll(arguments[2],Sc)&&arguments[0]instanceof Object&&arguments[1]instanceof Lc)for(var r=arguments[0],o=arguments[1],s=arguments[2],a=o.getChildBoundables(),l=0;l<a.size();l++){var u=a.get(l);this.getIntersectsOp().intersects(u.getBounds(),r)&&(u instanceof Lc?this.query(r,u,s):u instanceof Pc?s.visitItem(u.getItem()):Rl.shouldNeverReachHere())}else if(ll(arguments[2],eu)&&arguments[0]instanceof Object&&arguments[1]instanceof Lc)for(var c=arguments[0],h=arguments[1],p=arguments[2],f=h.getChildBoundables(),d=0;d<f.size();d++){var g=f.get(d);this.getIntersectsOp().intersects(g.getBounds(),c)&&(g instanceof Lc?this.query(c,g,p):g instanceof Pc?p.add(g.getItem()):Rl.shouldNeverReachHere())}},Ac.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},Ac.prototype.getRoot=function(){return this.build(),this._root},Ac.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=this.removeItem(i,r);if(o)return!0;for(var s=null,a=i.getChildBoundables().iterator();a.hasNext();){var l=a.next();if(this.getIntersectsOp().intersects(l.getBounds(),n)&&l instanceof Lc&&(o=this.remove(n,l,r))){s=l;break}}return null!==s&&s.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(s),o}},Ac.prototype.createHigherLevels=function(t,e){Rl.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},Ac.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Lc){var i=this.depth(n);i>t&&(t=i)}}return t+1}},Ac.prototype.createParentBoundables=function(t,e){Rl.isTrue(!t.isEmpty());var n=new nu;n.add(this.createNode(e));var i=new nu(t);Oc.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var o=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},Ac.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},Ac.prototype.interfaces_=function(){return[mr]},Ac.prototype.getClass=function(){return Ac},Ac.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},Dc.IntersectsOp.get=function(){return Fc},Dc.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},Dc.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(Ac,Dc);var Fc=function(){},kc=function(){};kc.prototype.distance=function(t,e){},kc.prototype.interfaces_=function(){return[]},kc.prototype.getClass=function(){return kc};var Bc=function(t){function e(n){n=n||e.DEFAULT_NODE_CAPACITY,t.call(this,n)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return e.prototype.createParentBoundablesFromVerticalSlices=function(t,e){Rl.isTrue(t.length>0);for(var n=new nu,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},e.prototype.createNode=function(t){return new Gc(t)},e.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},e.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],n=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,n)},e.prototype.getIntersectsOp=function(){return e.intersectsOp},e.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){i[o]=new nu;for(var s=0;r.hasNext()&&s<n;){var a=r.next();i[o].add(a),s++}}return i},e.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];t.prototype.query.call(this,n,i)}else if(3===arguments.length)if(ll(arguments[2],Sc)&&arguments[0]instanceof Object&&arguments[1]instanceof Lc){var r=arguments[0],o=arguments[1],s=arguments[2];t.prototype.query.call(this,r,o,s)}else if(ll(arguments[2],eu)&&arguments[0]instanceof Object&&arguments[1]instanceof Lc){var a=arguments[0],l=arguments[1],u=arguments[2];t.prototype.query.call(this,a,l,u)}},e.prototype.getComparator=function(){return e.yComparator},e.prototype.createParentBoundablesFromVerticalSlice=function(e,n){return t.prototype.createParentBoundables.call(this,e,n)},e.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.prototype.remove.call(this,e,n)}return t.prototype.remove.apply(this,arguments)},e.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},e.prototype.createParentBoundables=function(t,n){Rl.isTrue(!t.isEmpty());var i=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new nu(t);Oc.sort(r,e.xComparator);var o=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(i))));return this.createParentBoundablesFromVerticalSlices(o,n)},e.prototype.nearestNeighbour=function(){if(1===arguments.length){if(ll(arguments[0],kc)){var t=arguments[0],n=new Rc(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(n)}if(arguments[0]instanceof Rc){var i=arguments[0];return this.nearestNeighbour(i,Ja.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof e&&ll(arguments[1],kc)){var r=arguments[0],o=arguments[1],s=new Rc(this.getRoot(),r.getRoot(),o);return this.nearestNeighbour(s)}if(arguments[0]instanceof Rc&&"number"==typeof arguments[1]){var a=arguments[0],l=arguments[1],u=null,c=new Nc;for(c.add(a);!c.isEmpty()&&l>0;){var h=c.poll(),p=h.getDistance();if(p>=l)break;h.isLeaves()?(l=p,u=h):h.expandToQueue(c,l)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length){var f=arguments[0],d=arguments[1],g=arguments[2],y=new Pc(f,d),m=new Rc(this.getRoot(),y,g);return this.nearestNeighbour(m)[0]}},e.prototype.interfaces_=function(){return[Tc,mr]},e.prototype.getClass=function(){return e},e.centreX=function(t){return e.avg(t.getMinX(),t.getMaxX())},e.avg=function(t,e){return(t+e)/2},e.centreY=function(t){return e.avg(t.getMinY(),t.getMaxY())},n.STRtreeNode.get=function(){return Gc},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[el]},compare:function(n,i){return t.compareDoubles(e.centreX(n.getBounds()),e.centreX(i.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[el]},compare:function(n,i){return t.compareDoubles(e.centreY(n.getBounds()),e.centreY(i.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(e,n),e}(Ac),Gc=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new El(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Lc),jc=function(){};jc.prototype.interfaces_=function(){return[]},jc.prototype.getClass=function(){return jc},jc.relativeSign=function(t,e){return t<e?-1:t>e?1:0},jc.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=jc.relativeSign(e.x,n.x),r=jc.relativeSign(e.y,n.y);switch(t){case 0:return jc.compareValue(i,r);case 1:return jc.compareValue(r,i);case 2:return jc.compareValue(r,-i);case 3:return jc.compareValue(-i,r);case 4:return jc.compareValue(-i,-r);case 5:return jc.compareValue(-r,-i);case 6:return jc.compareValue(-r,i);case 7:return jc.compareValue(i,-r)}return Rl.shouldNeverReachHere("invalid octant value"),0},jc.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var zc=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new nl(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))};zc.prototype.getCoordinate=function(){return this.coord},zc.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},zc.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:jc.compare(this._segmentOctant,this.coord,e.coord)},zc.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},zc.prototype.isInterior=function(){return this._isInterior},zc.prototype.interfaces_=function(){return[$a]},zc.prototype.getClass=function(){return zc};var Uc=function(){this._nodeMap=new Pr,this._edge=null;var t=arguments[0];this._edge=t};Uc.prototype.getSplitCoordinates=function(){var t=new ru;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},Uc.prototype.addCollapsedNodes=function(){var t=new nu;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},Uc.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Uc.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(new pl(e+1))}},Uc.prototype.addEdgeCoordinates=function(t,e,n){var i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new nl(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));r&&n.add(new nl(e.coord))},Uc.prototype.iterator=function(){return this._nodeMap.values().iterator()},Uc.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},Uc.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},Uc.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new pl(e[0])),i=r}},Uc.prototype.getEdge=function(){return this._edge},Uc.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},Uc.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new nl(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return r&&(o[s]=new nl(e.coord)),new Yc(o,this._edge.getData())},Uc.prototype.add=function(t,e){var n=new zc(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(Rl.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)},Uc.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new Ml("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new Ml("bad split edge end point at "+r)},Uc.prototype.interfaces_=function(){return[]},Uc.prototype.getClass=function(){return Uc};var qc=function(){};qc.prototype.interfaces_=function(){return[]},qc.prototype.getClass=function(){return qc},qc.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new Za("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),i=Math.abs(e);return t>=0?e>=0?n>=i?0:1:n>=i?7:6:e>=0?n>=i?3:2:n>=i?4:5}if(arguments[0]instanceof nl&&arguments[1]instanceof nl){var r=arguments[0],o=arguments[1],s=o.x-r.x,a=o.y-r.y;if(0===s&&0===a)throw new Za("Cannot compute the octant for two identical points "+r);return qc.octant(s,a)}};var Vc=function(){};Vc.prototype.getCoordinates=function(){},Vc.prototype.size=function(){},Vc.prototype.getCoordinate=function(t){},Vc.prototype.isClosed=function(){},Vc.prototype.setData=function(t){},Vc.prototype.getData=function(){},Vc.prototype.interfaces_=function(){return[]},Vc.prototype.getClass=function(){return Vc};var Hc=function(){};Hc.prototype.addIntersection=function(t,e){},Hc.prototype.interfaces_=function(){return[Vc]},Hc.prototype.getClass=function(){return Hc};var Yc=function(){this._nodeList=new Uc(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Yc.prototype.getCoordinates=function(){return this._pts},Yc.prototype.size=function(){return this._pts.length},Yc.prototype.getCoordinate=function(t){return this._pts[t]},Yc.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Yc.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},Yc.prototype.setData=function(t){this._data=t},Yc.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:qc.octant(t,e)},Yc.prototype.getData=function(){return this._data},Yc.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[3],o=new nl(n.getIntersection(r));this.addIntersection(o,i)}},Yc.prototype.toString=function(){return Ll.toLineString(new zu(this._pts))},Yc.prototype.getNodeList=function(){return this._nodeList},Yc.prototype.addIntersectionNode=function(t,e){var n=e,i=n+1;if(i<this._pts.length){var r=this._pts[i];t.equals2D(r)&&(n=i)}return this._nodeList.add(t,n)},Yc.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},Yc.prototype.interfaces_=function(){return[Hc]},Yc.prototype.getClass=function(){return Yc},Yc.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new nu;return Yc.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(i)};var Xc=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new nl,this.p1=new nl;else if(1===arguments.length){var t=arguments[0];this.p0=new nl(t.p0),this.p1=new nl(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3];this.p0=new nl(e,n),this.p1=new nl(i,r)}},Wc={serialVersionUID:{configurable:!0}};Xc.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Xc.prototype.orientationIndex=function(){if(arguments[0]instanceof Xc){var t=arguments[0],e=Gl.orientationIndex(this.p0,this.p1,t.p0),n=Gl.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof nl){var i=arguments[0];return Gl.orientationIndex(this.p0,this.p1,i)}},Xc.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},Xc.prototype.isVertical=function(){return this.p0.x===this.p1.x},Xc.prototype.equals=function(t){if(!(t instanceof Xc))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},Xc.prototype.intersection=function(t){var e=new Fl;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},Xc.prototype.project=function(){if(arguments[0]instanceof nl){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new nl(t);var e=this.projectionFactor(t),n=new nl;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof Xc){var i=arguments[0],r=this.projectionFactor(i.p0),o=this.projectionFactor(i.p1);if(r>=1&&o>=1)return null;if(r<=0&&o<=0)return null;var s=this.project(i.p0);r<0&&(s=this.p0),r>1&&(s=this.p1);var a=this.project(i.p1);return o<0&&(a=this.p0),o>1&&(a=this.p1),new Xc(s,a)}},Xc.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Xc.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Xc.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},Xc.prototype.distancePerpendicular=function(t){return Gl.distancePointLinePerpendicular(t,this.p0,this.p1)},Xc.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Xc.prototype.midPoint=function(){return Xc.midPoint(this.p0,this.p1)},Xc.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?Ja.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},Xc.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=Ja.MAX_VALUE,r=null,o=this.closestPoint(t.p0);i=o.distance(t.p0),n[0]=o,n[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<i&&(i=r,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<i&&(i=r,n[0]=this.p0,n[1]=a);var l=t.closestPoint(this.p1);return(r=l.distance(this.p1))<i&&(i=r,n[0]=this.p1,n[1]=l),n},Xc.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},Xc.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Xc.prototype.getLength=function(){return this.p0.distance(this.p1)},Xc.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},Xc.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},Xc.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},Xc.prototype.lineIntersection=function(t){try{return bl.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof Cl))throw t}return null},Xc.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Xc.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,l=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,l=e*o/s}return new nl(n-l,i+a)},Xc.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},Xc.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||Ja.isNaN(e))&&(e=1),e},Xc.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Xc.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Xc.prototype.distance=function(){if(arguments[0]instanceof Xc){var t=arguments[0];return Gl.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof nl){var e=arguments[0];return Gl.distancePointLine(e,this.p0,this.p1)}},Xc.prototype.pointAlong=function(t){var e=new nl;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},Xc.prototype.hashCode=function(){var t=Ja.doubleToLongBits(this.p0.x);t^=31*Ja.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=Ja.doubleToLongBits(this.p1.x);return n^=31*Ja.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},Xc.prototype.interfaces_=function(){return[$a,mr]},Xc.prototype.getClass=function(){return Xc},Xc.midPoint=function(t,e){return new nl((t.x+e.x)/2,(t.y+e.y)/2)},Wc.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Xc,Wc);var Kc=function(){this.tempEnv1=new El,this.tempEnv2=new El,this._overlapSeg1=new Xc,this._overlapSeg2=new Xc};Kc.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t.getLineSegment(e,this._overlapSeg1),n.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},Kc.prototype.interfaces_=function(){return[]},Kc.prototype.getClass=function(){return Kc};var Zc=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i};Zc.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},Zc.prototype.computeSelect=function(t,e,n,i){var r=this._pts[e],o=this._pts[n];if(i.tempEnv1.init(r,o),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,i),s<n&&this.computeSelect(t,s,n,i)},Zc.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},Zc.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},Zc.prototype.setId=function(t){this._id=t},Zc.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},Zc.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new El(t,e)}return this._env},Zc.prototype.getEndIndex=function(){return this._end},Zc.prototype.getStartIndex=function(){return this._start},Zc.prototype.getContext=function(){return this._context},Zc.prototype.getId=function(){return this._id},Zc.prototype.computeOverlapsInternal=function(t,e,n,i,r,o){var s=this._pts[t],a=this._pts[e],l=n._pts[i],u=n._pts[r];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(l,u),!o.tempEnv1.intersects(o.tempEnv2))return null;var c=Math.trunc((t+e)/2),h=Math.trunc((i+r)/2);t<c&&(i<h&&this.computeOverlapsInternal(t,c,n,i,h,o),h<r&&this.computeOverlapsInternal(t,c,n,h,r,o)),c<e&&(i<h&&this.computeOverlapsInternal(c,e,n,i,h,o),h<r&&this.computeOverlapsInternal(c,e,n,h,r,o))},Zc.prototype.interfaces_=function(){return[]},Zc.prototype.getClass=function(){return Zc};var Jc=function(){};Jc.prototype.interfaces_=function(){return[]},Jc.prototype.getClass=function(){return Jc},Jc.getChainStartIndices=function(t){var e=0,n=new nu;n.add(new pl(e));do{var i=Jc.findChainEnd(t,e);n.add(new pl(i)),e=i}while(e<t.length-1);return Jc.toIntArray(n)},Jc.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=_c.quadrant(t[n],t[n+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||_c.quadrant(t[r-1],t[r])===i);)r++;return r-1},Jc.getChains=function(){if(1===arguments.length){var t=arguments[0];return Jc.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new nu,r=Jc.getChainStartIndices(e),o=0;o<r.length-1;o++){var s=new Zc(e,r[o],r[o+1],n);i.add(s)}return i}},Jc.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var Qc=function(){};Qc.prototype.computeNodes=function(t){},Qc.prototype.getNodedSubstrings=function(){},Qc.prototype.interfaces_=function(){return[]},Qc.prototype.getClass=function(){return Qc};var $c=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};$c.prototype.setSegmentIntersector=function(t){this._segInt=t},$c.prototype.interfaces_=function(){return[Qc]},$c.prototype.getClass=function(){return $c};var th=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new nu,this._index=new Bc,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return Yc.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=Jc.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new eh(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this._index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return eh},Object.defineProperties(e,n),e}($c),eh=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3],o=e.getContext(),s=i.getContext();this._si.processIntersections(o,n,s,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Kc),nh=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(i)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}},ih={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};nh.prototype.getEndCapStyle=function(){return this._endCapStyle},nh.prototype.isSingleSided=function(){return this._isSingleSided},nh.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=nh.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=nh.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==nh.JOIN_ROUND&&(this._quadrantSegments=nh.DEFAULT_QUADRANT_SEGMENTS)},nh.prototype.getJoinStyle=function(){return this._joinStyle},nh.prototype.setJoinStyle=function(t){this._joinStyle=t},nh.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},nh.prototype.getSimplifyFactor=function(){return this._simplifyFactor},nh.prototype.getQuadrantSegments=function(){return this._quadrantSegments},nh.prototype.setEndCapStyle=function(t){this._endCapStyle=t},nh.prototype.getMitreLimit=function(){return this._mitreLimit},nh.prototype.setMitreLimit=function(t){this._mitreLimit=t},nh.prototype.setSingleSided=function(t){this._isSingleSided=t},nh.prototype.interfaces_=function(){return[]},nh.prototype.getClass=function(){return nh},nh.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},ih.CAP_ROUND.get=function(){return 1},ih.CAP_FLAT.get=function(){return 2},ih.CAP_SQUARE.get=function(){return 3},ih.JOIN_ROUND.get=function(){return 1},ih.JOIN_MITRE.get=function(){return 2},ih.JOIN_BEVEL.get=function(){return 3},ih.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},ih.DEFAULT_MITRE_LIMIT.get=function(){return 5},ih.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(nh,ih);var rh=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Gl.COUNTERCLOCKWISE,this._inputLine=t||null},oh={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};rh.prototype.isDeletable=function(t,e,n,i){var r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(r,o,s)&&!!this.isShallow(r,o,s,i)&&this.isShallowSampled(r,o,t,n,i)},rh.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;n<this._inputLine.length;){var r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=rh.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},rh.prototype.isShallowConcavity=function(t,e,n,i){return Gl.computeOrientation(t,e,n)===this._angleOrientation&&Gl.distancePointLine(e,t,n)<i},rh.prototype.isShallowSampled=function(t,e,n,i,r){var o=Math.trunc((i-n)/rh.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=n;s<i;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},rh.prototype.isConcave=function(t,e,n){return Gl.computeOrientation(t,e,n)===this._angleOrientation},rh.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=Gl.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},rh.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===rh.DELETE;)e++;return e},rh.prototype.isShallow=function(t,e,n,i){return Gl.distancePointLine(e,t,n)<i},rh.prototype.collapseLine=function(){for(var t=new ru,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==rh.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},rh.prototype.interfaces_=function(){return[]},rh.prototype.getClass=function(){return rh},rh.simplify=function(t,e){return new rh(t).simplify(e)},oh.INIT.get=function(){return 0},oh.DELETE.get=function(){return 1},oh.KEEP.get=function(){return 1},oh.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(rh,oh);var sh=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new nu},ah={COORDINATE_ARRAY_TYPE:{configurable:!0}};sh.prototype.getCoordinates=function(){return this._ptList.toArray(sh.COORDINATE_ARRAY_TYPE)},sh.prototype.setPrecisionModel=function(t){this._precisionModel=t},sh.prototype.addPt=function(t){var e=new nl(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},sh.prototype.revere=function(){},sh.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var i=t.length-1;i>=0;i--)this.addPt(t[i])},sh.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},sh.prototype.toString=function(){return(new Zu).createLineString(this.getCoordinates()).toString()},sh.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new nl(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},sh.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},sh.prototype.interfaces_=function(){return[]},sh.prototype.getClass=function(){return sh},ah.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(sh,ah);var lh=function(){},uh={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};lh.prototype.interfaces_=function(){return[]},lh.prototype.getClass=function(){return lh},lh.toDegrees=function(t){return 180*t/Math.PI},lh.normalize=function(t){for(;t>Math.PI;)t-=lh.PI_TIMES_2;for(;t<=-Math.PI;)t+=lh.PI_TIMES_2;return t},lh.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},lh.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0},lh.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0},lh.interiorAngle=function(t,e,n){var i=lh.angle(e,t),r=lh.angle(e,n);return Math.abs(r-i)},lh.normalizePositive=function(t){if(t<0){for(;t<0;)t+=lh.PI_TIMES_2;t>=lh.PI_TIMES_2&&(t=0)}else{for(;t>=lh.PI_TIMES_2;)t-=lh.PI_TIMES_2;t<0&&(t=0)}return t},lh.angleBetween=function(t,e,n){var i=lh.angle(e,t),r=lh.angle(e,n);return lh.diff(i,r)},lh.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},lh.toRadians=function(t){return t*Math.PI/180},lh.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?lh.COUNTERCLOCKWISE:n<0?lh.CLOCKWISE:lh.NONE},lh.angleBetweenOriented=function(t,e,n){var i=lh.angle(e,t),r=lh.angle(e,n)-i;return r<=-Math.PI?r+lh.PI_TIMES_2:r>Math.PI?r-lh.PI_TIMES_2:r},uh.PI_TIMES_2.get=function(){return 2*Math.PI},uh.PI_OVER_2.get=function(){return Math.PI/2},uh.PI_OVER_4.get=function(){return Math.PI/4},uh.COUNTERCLOCKWISE.get=function(){return Gl.COUNTERCLOCKWISE},uh.CLOCKWISE.get=function(){return Gl.CLOCKWISE},uh.NONE.get=function(){return Gl.COLLINEAR},Object.defineProperties(lh,uh);var ch=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Xc,this._seg1=new Xc,this._offset0=new Xc,this._offset1=new Xc,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new Fl,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===nh.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)},hh={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};ch.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=Gl.computeOrientation(this._s0,this._s1,this._s2),i=n===Gl.CLOCKWISE&&this._side===rc.LEFT||n===Gl.COUNTERCLOCKWISE&&this._side===rc.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},ch.prototype.addLineEndCap=function(t,e){var n=new Xc(t,e),i=new Xc;this.computeOffsetSegment(n,rc.LEFT,this._distance,i);var r=new Xc;this.computeOffsetSegment(n,rc.RIGHT,this._distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case nh.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,Gl.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case nh.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case nh.CAP_SQUARE:var l=new nl;l.x=Math.abs(this._distance)*Math.cos(a),l.y=Math.abs(this._distance)*Math.sin(a);var u=new nl(i.p1.x+l.x,i.p1.y+l.y),c=new nl(r.p1.x+l.x,r.p1.y+l.y);this._segList.addPt(u),this._segList.addPt(c)}},ch.prototype.getCoordinates=function(){return this._segList.getCoordinates()},ch.prototype.addMitreJoin=function(t,e,n,i){var r=!0,o=null;try{o=bl.intersection(e.p0,e.p1,n.p0,n.p1),(i<=0?1:o.distance(t)/Math.abs(i))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof Cl))throw t;o=new nl(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())},ch.prototype.addFilletCorner=function(t,e,n,i,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),l=n.x-t.x,u=n.y-t.y,c=Math.atan2(u,l);i===Gl.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,c,i,r),this._segList.addPt(n)},ch.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*ch.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===nh.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===nh.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},ch.prototype.createSquare=function(t){this._segList.addPt(new nl(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new nl(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new nl(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new nl(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},ch.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},ch.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},ch.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},ch.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},ch.prototype.addLimitedMitreJoin=function(t,e,n,i){var r=this._seg0.p1,o=lh.angle(r,this._seg0.p0),s=lh.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=lh.normalize(o+s),l=lh.normalize(a+Math.PI),u=i*n,c=n-u*Math.abs(Math.sin(s)),h=r.x+u*Math.cos(l),p=r.y+u*Math.sin(l),f=new nl(h,p),d=new Xc(r,f),g=d.pointAlongOffset(1,c),y=d.pointAlongOffset(1,-c);this._side===rc.LEFT?(this._segList.addPt(g),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(g))},ch.prototype.computeOffsetSegment=function(t,e,n,i){var r=e===rc.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),l=r*n*o/a,u=r*n*s/a;i.p0.x=t.p0.x-u,i.p0.y=t.p0.y+l,i.p1.x=t.p1.x-u,i.p1.y=t.p1.y+l},ch.prototype.addFilletArc=function(t,e,n,i,r){var o=i===Gl.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var l=s/a,u=0,c=new nl;u<s;){var h=e+o*u;c.x=t.x+r*Math.cos(h),c.y=t.y+r*Math.sin(h),this._segList.addPt(c),u+=l}},ch.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*ch.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new nl((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var i=new nl((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},ch.prototype.createCircle=function(t){var e=new nl(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},ch.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},ch.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new sh,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*ch.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},ch.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===nh.JOIN_BEVEL||this._bufParams.getJoinStyle()===nh.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Gl.CLOCKWISE,this._distance))},ch.prototype.closeRing=function(){this._segList.closeRing()},ch.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},ch.prototype.interfaces_=function(){return[]},ch.prototype.getClass=function(){return ch},hh.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},hh.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},hh.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},hh.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(ch,hh);var ph=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};ph.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var o=r.getCoordinates();return n&&ou.reverse(o),o},ph.prototype.computeSingleSidedBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var r=rh.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],rc.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{n.addSegments(t,!1);var a=rh.simplify(t,i),l=a.length-1;n.initSideSegments(a[0],a[1],rc.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment(),n.closeRing()},ph.prototype.computeRingBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);e===rc.RIGHT&&(i=-i);var r=rh.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(var s=1;s<=o;s++){var a=1!==s;n.addNextSegment(r[s],a)}n.closeRing()},ph.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),i=rh.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],rc.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(i[o],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var s=rh.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],rc.LEFT);for(var l=a-2;l>=0;l--)e.addNextSegment(s[l],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},ph.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case nh.CAP_ROUND:e.createCircle(t);break;case nh.CAP_SQUARE:e.createSquare(t)}},ph.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},ph.prototype.getBufferParameters=function(){return this._bufParams},ph.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},ph.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return ph.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},ph.prototype.computeOffsetCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){var r=rh.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],rc.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{var a=rh.simplify(t,i),l=a.length-1;n.initSideSegments(a[0],a[1],rc.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment()},ph.prototype.getSegGen=function(t){return new ch(this._precisionModel,this._bufParams,t)},ph.prototype.interfaces_=function(){return[]},ph.prototype.getClass=function(){return ph},ph.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new nl(t[n]);return e};var fh=function(){this._subgraphs=null,this._seg=new Xc,this._cga=new Gl;var t=arguments[0];this._subgraphs=t},dh={DepthSegment:{configurable:!0}};fh.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new nu,n=this._subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(ll(arguments[2],eu)&&arguments[0]instanceof nl&&arguments[1]instanceof Cc){for(var o=arguments[0],s=arguments[1],a=arguments[2],l=s.getEdge().getCoordinates(),u=0;u<l.length-1;u++)if(this._seg.p0=l[u],this._seg.p1=l[u+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||Gl.computeOrientation(this._seg.p0,this._seg.p1,o)===Gl.RIGHT)){var c=s.getDepth(rc.LEFT);this._seg.p0.equals(l[u])||(c=s.getDepth(rc.RIGHT));var h=new gh(this._seg,c);a.add(h)}}else if(ll(arguments[2],eu)&&arguments[0]instanceof nl&&ll(arguments[1],eu))for(var p=arguments[0],f=arguments[1],d=arguments[2],g=f.iterator();g.hasNext();){var y=g.next();y.isForward()&&this.findStabbedSegments(p,y,d)}},fh.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Oc.min(e)._leftDepth},fh.prototype.interfaces_=function(){return[]},fh.prototype.getClass=function(){return fh},dh.DepthSegment.get=function(){return gh},Object.defineProperties(fh,dh);var gh=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new Xc(t),this._leftDepth=e};gh.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n||0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},gh.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},gh.prototype.toString=function(){return this._upwardSeg.toString()},gh.prototype.interfaces_=function(){return[$a]},gh.prototype.getClass=function(){return gh};var yh=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};yh.prototype.area=function(){return yh.area(this.p0,this.p1,this.p2)},yh.prototype.signedArea=function(){return yh.signedArea(this.p0,this.p1,this.p2)},yh.prototype.interpolateZ=function(t){if(null===t)throw new Za("Supplied point is null.");return yh.interpolateZ(t,this.p0,this.p1,this.p2)},yh.prototype.longestSideLength=function(){return yh.longestSideLength(this.p0,this.p1,this.p2)},yh.prototype.isAcute=function(){return yh.isAcute(this.p0,this.p1,this.p2)},yh.prototype.circumcentre=function(){return yh.circumcentre(this.p0,this.p1,this.p2)},yh.prototype.area3D=function(){return yh.area3D(this.p0,this.p1,this.p2)},yh.prototype.centroid=function(){return yh.centroid(this.p0,this.p1,this.p2)},yh.prototype.inCentre=function(){return yh.inCentre(this.p0,this.p1,this.p2)},yh.prototype.interfaces_=function(){return[]},yh.prototype.getClass=function(){return yh},yh.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},yh.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},yh.det=function(t,e,n,i){return t*i-e*n},yh.interpolateZ=function(t,e,n,i){var r=e.x,o=e.y,s=n.x-r,a=i.x-r,l=n.y-o,u=i.y-o,c=s*u-a*l,h=t.x-r,p=t.y-o,f=(u*h-a*p)/c,d=(-l*h+s*p)/c;return e.z+f*(n.z-e.z)+d*(i.z-e.z)},yh.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),o=n.distance(t),s=i;return r>s&&(s=r),o>s&&(s=o),s},yh.isAcute=function(t,e,n){return!!lh.isAcute(t,e,n)&&!!lh.isAcute(e,n,t)&&!!lh.isAcute(n,t,e)},yh.circumcentre=function(t,e,n){var i=n.x,r=n.y,o=t.x-i,s=t.y-r,a=e.x-i,l=e.y-r,u=2*yh.det(o,s,a,l),c=yh.det(s,o*o+s*s,l,a*a+l*l),h=yh.det(o,o*o+s*s,a,a*a+l*l);return new nl(i-c/u,r+h/u)},yh.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y,r=new bl(t.x+n/2,t.y+i/2,1),o=new bl(t.x-i+n/2,t.y+n+i/2,1);return new bl(r,o)},yh.angleBisector=function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new nl(t.x+r*o,t.y+r*s)},yh.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,l=n.z-t.z,u=r*l-o*a,c=o*s-i*l,h=i*a-r*s,p=u*u+c*c+h*h;return Math.sqrt(p)/2},yh.centroid=function(t,e,n){var i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new nl(i,r)},yh.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),o=t.distance(e),s=i+r+o,a=(i*t.x+r*e.x+o*n.x)/s,l=(i*t.y+r*e.y+o*n.y)/s;return new nl(a,l)};var mh=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new nu;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};mh.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,sl.EXTERIOR,sl.INTERIOR)},mh.prototype.addPolygon=function(t){var e=this._distance,n=rc.LEFT;this._distance<0&&(e=-this._distance,n=rc.RIGHT);var i=t.getExteriorRing(),r=ou.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,sl.EXTERIOR,sl.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=ou.removeRepeatedPoints(s.getCoordinates());this._distance>0&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,rc.opposite(n),sl.INTERIOR,sl.EXTERIOR)}},mh.prototype.isTriangleErodedCompletely=function(t,e){var n=new yh(t[0],t[1],t[2]),i=n.inCentre();return Gl.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},mh.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=ou.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,sl.EXTERIOR,sl.INTERIOR)},mh.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var i=new Yc(t,new hc(0,sl.BOUNDARY,e,n));this._curveList.add(i)},mh.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},mh.prototype.addPolygonRing=function(t,e,n,i,r){if(0===e&&t.length<Au.MINIMUM_VALID_SIZE)return null;var o=i,s=r;t.length>=Au.MINIMUM_VALID_SIZE&&Gl.isCCW(t)&&(o=r,s=i,n=rc.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},mh.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Ou?this.addPolygon(t):t instanceof Su?this.addLineString(t):t instanceof Lu?this.addPoint(t):(t instanceof Ru||t instanceof wu||t instanceof Du||t instanceof Cu)&&this.addCollection(t)},mh.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r},mh.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},mh.prototype.interfaces_=function(){return[]},mh.prototype.getClass=function(){return mh};var _h=function(){};_h.prototype.locate=function(t){},_h.prototype.interfaces_=function(){return[]},_h.prototype.getClass=function(){return _h};var vh=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};vh.prototype.next=function(){if(this._atStart)return this._atStart=!1,vh.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new _r;var t=this._parent.getGeometryN(this._index++);return t instanceof Cu?(this._subcollectionIterator=new vh(t),this._subcollectionIterator.next()):t},vh.prototype.remove=function(){throw new Error(this.getClass().getName())},vh.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},vh.prototype.interfaces_=function(){return[tu]},vh.prototype.getClass=function(){return vh},vh.isAtomic=function(t){return!(t instanceof Cu)};var xh=function(){this._geom=null;var t=arguments[0];this._geom=t};xh.prototype.locate=function(t){return xh.locate(t,this._geom)},xh.prototype.interfaces_=function(){return[_h]},xh.prototype.getClass=function(){return xh},xh.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&Gl.isPointInRing(t,e.getCoordinates())},xh.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!xh.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(xh.isPointInRing(t,r))return!1}return!0},xh.containsPoint=function(t,e){if(e instanceof Ou)return xh.containsPointInPolygon(t,e);if(e instanceof Cu)for(var n=new vh(e);n.hasNext();){var i=n.next();if(i!==e&&xh.containsPoint(t,i))return!0}return!1},xh.locate=function(t,e){return e.isEmpty()?sl.EXTERIOR:xh.containsPoint(t,e)?sl.INTERIOR:sl.EXTERIOR};var Ch=function(){this._edgeMap=new Pr,this._edgeList=null,this._ptInAreaLocation=[sl.NONE,sl.NONE]};Ch.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},Ch.prototype.propagateSideLabels=function(t){for(var e=sl.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,rc.LEFT)!==sl.NONE&&(e=i.getLocation(t,rc.LEFT))}if(e===sl.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,rc.ON)===sl.NONE&&a.setLocation(t,rc.ON,r),a.isArea(t)){var l=a.getLocation(t,rc.LEFT),u=a.getLocation(t,rc.RIGHT);if(u!==sl.NONE){if(u!==r)throw new ac("side location conflict",s.getCoordinate());l===sl.NONE&&Rl.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=l}else Rl.isTrue(a.getLocation(t,rc.LEFT)===sl.NONE,"found single null side"),a.setLocation(t,rc.RIGHT,r),a.setLocation(t,rc.LEFT,r)}}},Ch.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},Ch.prototype.print=function(t){wl.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},Ch.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Ch.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,rc.LEFT);Rl.isTrue(i!==sl.NONE,"Found unlabelled area edge");for(var r=i,o=this.iterator();o.hasNext();){var s=o.next().getLabel();Rl.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,rc.LEFT),l=s.getLocation(t,rc.RIGHT);if(a===l)return!1;if(l!==r)return!1;r=a}return!0},Ch.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},Ch.prototype.iterator=function(){return this.getEdges().iterator()},Ch.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new nu(this._edgeMap.values())),this._edgeList},Ch.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===sl.NONE&&(this._ptInAreaLocation[t]=xh.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},Ch.prototype.toString=function(){var t=new hl;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},Ch.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},Ch.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===sl.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),l=0;l<2;l++)if(a.isAnyNull(l)){var u=sl.NONE;if(e[l])u=sl.EXTERIOR;else{var c=s.getCoordinate();u=this.getLocation(l,c,t)}a.setAllLocationsIfNull(l,u)}},Ch.prototype.getDegree=function(){return this._edgeMap.size()},Ch.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},Ch.prototype.interfaces_=function(){return[]},Ch.prototype.getClass=function(){return Ch};var wh=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var r=this._resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new ac("no outgoing dirEdge found",this.getCoordinate());Rl.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return _c.isNorthern(r)&&_c.isNorthern(o)?n:_c.isNorthern(r)||_c.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:(Rl.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},e.prototype.print=function(t){wl.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new nu;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(rc.LEFT),i=t.getDepth(rc.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new ac("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[0],s=arguments[1],a=arguments[2],l=o;l<s;l++){var u=this._edgeList.get(l);u.setEdgeDepths(rc.RIGHT,a),a=u.getDepth(rc.LEFT)}return a}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,i=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;r>=0;r--){var o=this._resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(Rl.isTrue(null!==e,"found null for first outgoing dirEdge"),Rl.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],i=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===n&&i++;return i}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=sl.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=sl.INTERIOR;break}if(i.isInResult()){t=sl.EXTERIOR;break}}}if(t===sl.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===sl.INTERIOR):(s.isInResult()&&(r=sl.EXTERIOR),a.isInResult()&&(r=sl.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new hc(sl.NONE);for(var n=this.iterator();n.hasNext();)for(var i=n.next().getEdge().getLabel(),r=0;r<2;r++){var o=i.getLocation(r);o!==sl.INTERIOR&&o!==sl.BOUNDARY||this._label.setLocation(r,sl.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ch),bh=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new yc(t,new wh)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(wc),Eh=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Eh.prototype.compareTo=function(t){var e=t;return Eh.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Eh.prototype.interfaces_=function(){return[$a]},Eh.prototype.getClass=function(){return Eh},Eh.orientation=function(t){return 1===ou.increasingDirection(t)},Eh.compareOriented=function(t,e,n,i){for(var r=e?1:-1,o=i?1:-1,s=e?t.length:-1,a=i?n.length:-1,l=e?0:t.length-1,u=i?0:n.length-1;;){var c=t[l].compareTo(n[u]);if(0!==c)return c;var h=(l+=r)===s,p=(u+=o)===a;if(h&&!p)return-1;if(!h&&p)return 1;if(h&&p)return 0}};var Ih=function(){this._edges=new nu,this._ocaMap=new Pr};Ih.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)r>0&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},Ih.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Ih.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Ih.prototype.iterator=function(){return this._edges.iterator()},Ih.prototype.getEdges=function(){return this._edges},Ih.prototype.get=function(t){return this._edges.get(t)},Ih.prototype.findEqualEdge=function(t){var e=new Eh(t.getCoordinates());return this._ocaMap.get(e)},Ih.prototype.add=function(t){this._edges.add(t);var e=new Eh(t.getCoordinates());this._ocaMap.put(e,t)},Ih.prototype.interfaces_=function(){return[]},Ih.prototype.getClass=function(){return Ih};var Ph=function(){};Ph.prototype.processIntersections=function(t,e,n,i){},Ph.prototype.isDone=function(){},Ph.prototype.interfaces_=function(){return[]},Ph.prototype.getClass=function(){return Ph};var Nh=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Nh.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(Nh.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},Nh.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Nh.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Nh.prototype.getLineIntersector=function(){return this._li},Nh.prototype.hasProperIntersection=function(){return this._hasProper},Nh.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Nh.prototype.hasIntersection=function(){return this._hasIntersection},Nh.prototype.isDone=function(){return!1},Nh.prototype.hasInteriorIntersection=function(){return this._hasInterior},Nh.prototype.interfaces_=function(){return[Ph]},Nh.prototype.getClass=function(){return Nh},Nh.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Sh=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new nl(t),this.segmentIndex=e,this.dist=n};Sh.prototype.getSegmentIndex=function(){return this.segmentIndex},Sh.prototype.getCoordinate=function(){return this.coord},Sh.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Sh.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},Sh.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Sh.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Sh.prototype.getDistance=function(){return this.dist},Sh.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Sh.prototype.interfaces_=function(){return[$a]},Sh.prototype.getClass=function(){return Sh};var Th=function(){this._nodeMap=new Pr,this.edge=null;var t=arguments[0];this.edge=t};Th.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Th.prototype.iterator=function(){return this._nodeMap.values().iterator()},Th.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},Th.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Th.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new nl(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new Ah(o,new hc(this.edge._label))},Th.prototype.add=function(t,e,n){var i=new Sh(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)},Th.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Th.prototype.interfaces_=function(){return[]},Th.prototype.getClass=function(){return Th};var Lh=function(){};Lh.prototype.getChainStartIndices=function(t){var e=0,n=new nu;n.add(new pl(e));do{var i=this.findChainEnd(t,e);n.add(new pl(i)),e=i}while(e<t.length-1);return Lh.toIntArray(n)},Lh.prototype.findChainEnd=function(t,e){for(var n=_c.quadrant(t[e],t[e+1]),i=e+1;i<t.length&&_c.quadrant(t[i-1],t[i])===n;)i++;return i-1},Lh.prototype.interfaces_=function(){return[]},Lh.prototype.getClass=function(){return Lh},Lh.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var Mh=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new El,this.env2=new El;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Lh;this.startIndex=e.getChainStartIndices(this.pts)};Mh.prototype.getCoordinates=function(){return this.pts},Mh.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},Mh.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},Mh.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],l=arguments[4],u=arguments[5],c=this.pts[r],h=this.pts[o],p=s.pts[a],f=s.pts[l];if(o-r==1&&l-a==1)return u.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(c,h),this.env2.init(p,f),!this.env1.intersects(this.env2))return null;var d=Math.trunc((r+o)/2),g=Math.trunc((a+l)/2);r<d&&(a<g&&this.computeIntersectsForChain(r,d,s,a,g,u),g<l&&this.computeIntersectsForChain(r,d,s,g,l,u)),d<o&&(a<g&&this.computeIntersectsForChain(d,o,s,a,g,u),g<l&&this.computeIntersectsForChain(d,o,s,g,l,u))}},Mh.prototype.getStartIndexes=function(){return this.startIndex},Mh.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},Mh.prototype.interfaces_=function(){return[]},Mh.prototype.getClass=function(){return Mh};var Oh=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},Rh={NULL_VALUE:{configurable:!0}};Oh.prototype.getDepth=function(t,e){return this._depth[t][e]},Oh.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},Oh.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==Oh.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===Oh.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._depth[i][r]===Oh.NULL_VALUE}},Oh.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}},Oh.prototype.getDelta=function(t){return this._depth[t][rc.RIGHT]-this._depth[t][rc.LEFT]},Oh.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?sl.EXTERIOR:sl.INTERIOR},Oh.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},Oh.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var i=t.getLocation(e,n);i!==sl.EXTERIOR&&i!==sl.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=Oh.depthAtLocation(i):this._depth[e][n]+=Oh.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],o=arguments[1];arguments[2]===sl.INTERIOR&&this._depth[r][o]++}},Oh.prototype.interfaces_=function(){return[]},Oh.prototype.getClass=function(){return Oh},Oh.depthAtLocation=function(t){return t===sl.EXTERIOR?0:t===sl.INTERIOR?1:Oh.NULL_VALUE},Rh.NULL_VALUE.get=function(){return-1},Object.defineProperties(Oh,Rh);var Ah=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Th(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Oh,this._depthDelta=0,1===arguments.length){var n=arguments[0];e.call(this,n,null)}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.pts=i,this._label=r}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,hc.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var i=!0,r=!0,o=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(n.pts[s])||(i=!1),this.pts[s].equals2D(n.pts[--o])||(r=!1),!i&&!r)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Mh(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new El;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,n,i){var r=new nl(t.getIntersection(i)),o=e,s=t.getEdgeDistance(n,i),a=o+1;if(a<this.pts.length){var l=this.pts[a];r.equals2D(l)&&(o=a,s=0)}this.eiList.add(r,o,s)},e.prototype.toString=function(){var t=new hl;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],n=arguments[1];n.setAtLeastIfValid(e.getLocation(0,rc.ON),e.getLocation(1,rc.ON),1),e.isArea()&&(n.setAtLeastIfValid(e.getLocation(0,rc.LEFT),e.getLocation(1,rc.LEFT),2),n.setAtLeastIfValid(e.getLocation(0,rc.RIGHT),e.getLocation(1,rc.RIGHT),2))},e}(gc),Dh=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Ih,this._bufParams=t||null};Dh.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},Dh.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new hc(t.getLabel())).flip(),n.merge(i);var r=Dh.depthDelta(i),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(Dh.depthDelta(t.getLabel()))},Dh.prototype.buildSubgraphs=function(t,e){for(var n=new nu,i=t.iterator();i.hasNext();){var r=i.next(),o=r.getRightmostCoordinate(),s=new fh(n).getDepth(o);r.computeDepth(s),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},Dh.prototype.createSubgraphs=function(t){for(var e=new nu,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new uc;r.create(i),e.add(r)}}return Oc.sort(e,Oc.reverseOrder()),e},Dh.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Dh.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new th,n=new Fl;return n.setPrecisionModel(t),e.setSegmentIntersector(new Nh(n)),e},Dh.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new ph(n,this._bufParams),r=new mh(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new bc(new bh),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new Ec(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},Dh.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new Ah(r.getCoordinates(),new hc(s));this.insertUniqueEdge(a)}}},Dh.prototype.setNoder=function(t){this._workingNoder=t},Dh.prototype.interfaces_=function(){return[]},Dh.prototype.getClass=function(){return Dh},Dh.depthDelta=function(t){var e=t.getLocation(0,rc.LEFT),n=t.getLocation(0,rc.RIGHT);return e===sl.INTERIOR&&n===sl.EXTERIOR?1:e===sl.EXTERIOR&&n===sl.INTERIOR?-1:0},Dh.convertSegStrings=function(t){for(var e=new Zu,n=new nu;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)};var Fh=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=arguments[3];this._noder=n,this._scaleFactor=i,this._offsetX=r,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};Fh.prototype.rescale=function(){if(ll(arguments[0],Ql))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],i=0;i<n.length;i++)n[i].x=n[i].x/this._scaleFactor+this._offsetX,n[i].y=n[i].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&wl.out.println(n)}},Fh.prototype.scale=function(){if(ll(arguments[0],Ql)){for(var t=arguments[0],e=new nu,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Yc(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],o=new Array(r.length).fill(null),s=0;s<r.length;s++)o[s]=new nl(Math.round((r[s].x-this._offsetX)*this._scaleFactor),Math.round((r[s].y-this._offsetY)*this._scaleFactor),r[s].z);return ou.removeRepeatedPoints(o)}},Fh.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},Fh.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},Fh.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},Fh.prototype.interfaces_=function(){return[Qc]},Fh.prototype.getClass=function(){return Fh};var kh=function(){this._li=new Fl,this._segStrings=null;var t=arguments[0];this._segStrings=t},Bh={fact:{configurable:!0}};kh.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1].iterator();i.hasNext();)for(var r=i.next().getCoordinates(),o=1;o<r.length-1;o++)if(r[o].equals(n))throw new Ml("found endpt/interior pt intersection at index "+o+" :pt "+n)},kh.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=r.getCoordinates(),a=o.getCoordinates(),l=0;l<s.length-1;l++)for(var u=0;u<a.length-1;u++)this.checkInteriorIntersections(r,l,o,u);else if(4===arguments.length){var c=arguments[0],h=arguments[1],p=arguments[2],f=arguments[3];if(c===p&&h===f)return null;var d=c.getCoordinates()[h],g=c.getCoordinates()[h+1],y=p.getCoordinates()[f],m=p.getCoordinates()[f+1];if(this._li.computeIntersection(d,g,y,m),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,d,g)||this.hasInteriorIntersection(this._li,y,m)))throw new Ml("found non-noded intersection at "+d+"-"+g+" and "+y+"-"+m)}},kh.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},kh.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),i=0;i<n.length-2;i++)this.checkCollapse(n[i],n[i+1],n[i+2])},kh.prototype.hasInteriorIntersection=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},kh.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new Ml("found non-noded collapse at "+kh.fact.createLineString([t,e,n]))},kh.prototype.interfaces_=function(){return[]},kh.prototype.getClass=function(){return kh},Bh.fact.get=function(){return new Zu},Object.defineProperties(kh,Bh);var Gh=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new Za("Scale factor must be non-zero");1!==e&&(this._pt=new nl(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new nl,this._p1Scaled=new nl),this.initCorners(this._pt)},jh={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Gh.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>i||this._maxy<r||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return Rl.isTrue(!(s&&a),"Found bad envelope test"),a},Gh.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new nl(this._maxx,this._maxy),this._corner[1]=new nl(this._minx,this._maxy),this._corner[2]=new nl(this._minx,this._miny),this._corner[3]=new nl(this._maxx,this._miny)},Gh.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},Gh.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},Gh.prototype.getCoordinate=function(){return this._originalPt},Gh.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},Gh.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=Gh.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new El(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},Gh.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},Gh.prototype.intersectsToleranceSquare=function(t,e){var n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&i||t.equals(this._pt)||e.equals(this._pt)))))},Gh.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},Gh.prototype.interfaces_=function(){return[]},Gh.prototype.getClass=function(){return Gh},jh.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(Gh,jh);var zh=function(){this.tempEnv1=new El,this.selectedSegment=new Xc};zh.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},zh.prototype.interfaces_=function(){return[]},zh.prototype.getClass=function(){return zh};var Uh=function(){this._index=null;var t=arguments[0];this._index=t},qh={HotPixelSnapAction:{configurable:!0}};Uh.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),o=new Vh(e,n,i);return this._index.query(r,{interfaces_:function(){return[Sc]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},Uh.prototype.interfaces_=function(){return[]},Uh.prototype.getClass=function(){return Uh},qh.HotPixelSnapAction.get=function(){return Vh},Object.defineProperties(Uh,qh);var Vh=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._hotPixel=e,this._parentEdge=n,this._hotPixelVertexIndex=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[0],n=arguments[1],i=e.getContext();if(null!==this._parentEdge&&i===this._parentEdge&&n===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(i,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(zh),Hh=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new nu};Hh.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}},Hh.prototype.isDone=function(){return!1},Hh.prototype.getInteriorIntersections=function(){return this._interiorIntersections},Hh.prototype.interfaces_=function(){return[Ph]},Hh.prototype.getClass=function(){return Hh};var Yh=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new Fl,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};Yh.prototype.checkCorrectness=function(t){var e=Yc.getNodedSubstrings(t),n=new kh(e);try{n.checkValid()}catch(t){if(!(t instanceof xl))throw t;t.printStackTrace()}},Yh.prototype.getNodedSubstrings=function(){return Yc.getNodedSubstrings(this._nodedSegStrings)},Yh.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},Yh.prototype.findInteriorIntersections=function(t,e){var n=new Hh(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},Yh.prototype.computeVertexSnaps=function(){if(ll(arguments[0],Ql))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof Yc)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var o=new Gh(i[r],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,r)&&n.addIntersection(i[r],r)}},Yh.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new th,this._pointSnapper=new Uh(this._noder.getIndex()),this.snapRound(t,this._li)},Yh.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new Gh(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}},Yh.prototype.interfaces_=function(){return[Qc]},Yh.prototype.getClass=function(){return Yh};var Xh=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new nh,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},Wh={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Xh.prototype.bufferFixedPrecision=function(t){var e=new Fh(new Yh(new Yu(1)),t.getScale()),n=new Dh(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},Xh.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=Xh.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof ac))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],i=Xh.precisionScaleFactor(this._argGeom,this._distance,n),r=new Yu(i);this.bufferFixedPrecision(r)}},Xh.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Yu.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},Xh.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},Xh.prototype.bufferOriginalPrecision=function(){try{var t=new Dh(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof Ml))throw t;this._saveException=t}},Xh.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},Xh.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},Xh.prototype.interfaces_=function(){return[]},Xh.prototype.getClass=function(){return Xh},Xh.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Xh(t).getResultGeometry(e)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Ul&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1],r=arguments[2],o=new Xh(n);return o.setQuadrantSegments(r),o.getResultGeometry(i)}if(arguments[2]instanceof nh&&arguments[0]instanceof Ul&&"number"==typeof arguments[1]){var s=arguments[0],a=arguments[1],l=arguments[2];return new Xh(s,l).getResultGeometry(a)}}else if(4===arguments.length){var u=arguments[0],c=arguments[1],h=arguments[2],p=arguments[3],f=new Xh(u);return f.setQuadrantSegments(h),f.setEndCapStyle(p),f.getResultGeometry(c)}},Xh.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=ul.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},Wh.CAP_ROUND.get=function(){return nh.CAP_ROUND},Wh.CAP_BUTT.get=function(){return nh.CAP_FLAT},Wh.CAP_FLAT.get=function(){return nh.CAP_FLAT},Wh.CAP_SQUARE.get=function(){return nh.CAP_SQUARE},Wh.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(Xh,Wh);var Kh=function(){this._pt=[new nl,new nl],this._distance=Ja.NaN,this._isNull=!0};Kh.prototype.getCoordinates=function(){return this._pt},Kh.prototype.getCoordinate=function(t){return this._pt[t]},Kh.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},Kh.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},Kh.prototype.getDistance=function(){return this._distance},Kh.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},Kh.prototype.interfaces_=function(){return[]},Kh.prototype.getClass=function(){return Kh};var Zh=function(){};Zh.prototype.interfaces_=function(){return[]},Zh.prototype.getClass=function(){return Zh},Zh.computeDistance=function(){if(arguments[2]instanceof Kh&&arguments[0]instanceof Su&&arguments[1]instanceof nl)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=t.getCoordinates(),r=new Xc,o=0;o<i.length-1;o++){r.setCoordinates(i[o],i[o+1]);var s=r.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Kh&&arguments[0]instanceof Ou&&arguments[1]instanceof nl){var a=arguments[0],l=arguments[1],u=arguments[2];Zh.computeDistance(a.getExteriorRing(),l,u);for(var c=0;c<a.getNumInteriorRing();c++)Zh.computeDistance(a.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof Kh&&arguments[0]instanceof Ul&&arguments[1]instanceof nl){var h=arguments[0],p=arguments[1],f=arguments[2];if(h instanceof Su)Zh.computeDistance(h,p,f);else if(h instanceof Ou)Zh.computeDistance(h,p,f);else if(h instanceof Cu)for(var d=h,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);Zh.computeDistance(y,p,f)}else f.setMinimum(h.getCoordinate(),p)}else if(arguments[2]instanceof Kh&&arguments[0]instanceof Xc&&arguments[1]instanceof nl){var m=arguments[0],_=arguments[1],v=arguments[2],x=m.closestPoint(_);v.setMinimum(x,_)}};var Jh=function(t){this._maxPtDist=new Kh,this._inputGeom=t||null},Qh={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Jh.prototype.computeMaxMidpointDistance=function(t){var e=new tp(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},Jh.prototype.computeMaxVertexDistance=function(t){var e=new $h(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},Jh.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},Jh.prototype.getDistancePoints=function(){return this._maxPtDist},Jh.prototype.interfaces_=function(){return[]},Jh.prototype.getClass=function(){return Jh},Qh.MaxPointDistanceFilter.get=function(){return $h},Qh.MaxMidpointDistanceFilter.get=function(){return tp},Object.defineProperties(Jh,Qh);var $h=function(t){this._maxPtDist=new Kh,this._minPtDist=new Kh,this._geom=t||null};$h.prototype.filter=function(t){this._minPtDist.initialize(),Zh.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},$h.prototype.getMaxPointDistance=function(){return this._maxPtDist},$h.prototype.interfaces_=function(){return[Hl]},$h.prototype.getClass=function(){return $h};var tp=function(t){this._maxPtDist=new Kh,this._minPtDist=new Kh,this._geom=t||null};tp.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=new nl((n.x+i.x)/2,(n.y+i.y)/2);this._minPtDist.initialize(),Zh.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},tp.prototype.isDone=function(){return!1},tp.prototype.isGeometryChanged=function(){return!1},tp.prototype.getMaxPointDistance=function(){return this._maxPtDist},tp.prototype.interfaces_=function(){return[xu]},tp.prototype.getClass=function(){return tp};var ep=function(t){this._comps=t||null};ep.prototype.filter=function(t){t instanceof Ou&&this._comps.add(t)},ep.prototype.interfaces_=function(){return[vu]},ep.prototype.getClass=function(){return ep},ep.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return ep.getPolygons(t,new nu)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Ou?n.add(e):e instanceof Cu&&e.apply(new ep(n)),n}};var np=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};np.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof Au){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Su&&this._lines.add(t)},np.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},np.prototype.interfaces_=function(){return[zl]},np.prototype.getClass=function(){return np},np.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(np.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(np.getLines(e,n))}},np.getLines=function(){if(1===arguments.length){var t=arguments[0];return np.getLines(t,!1)}if(2===arguments.length){if(ll(arguments[0],Ql)&&ll(arguments[1],Ql)){for(var e=arguments[0],n=arguments[1],i=e.iterator();i.hasNext();){var r=i.next();np.getLines(r,n)}return n}if(arguments[0]instanceof Ul&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1],a=new nu;return o.apply(new np(a,s)),a}if(arguments[0]instanceof Ul&&ll(arguments[1],Ql)){var l=arguments[0],u=arguments[1];return l instanceof Su?u.add(l):l.apply(new np(u)),u}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&ll(arguments[0],Ql)&&ll(arguments[1],Ql)){for(var c=arguments[0],h=arguments[1],p=arguments[2],f=c.iterator();f.hasNext();){var d=f.next();np.getLines(d,h,p)}return h}if("boolean"==typeof arguments[2]&&arguments[0]instanceof Ul&&ll(arguments[1],Ql)){var g=arguments[0],y=arguments[1],m=arguments[2];return g.apply(new np(y,m)),y}}};var ip=function(){if(this._boundaryRule=Yl.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new Za("Rule must be non-null");this._boundaryRule=t}};ip.prototype.locateInternal=function(){if(arguments[0]instanceof nl&&arguments[1]instanceof Ou){var t=arguments[0],e=arguments[1];if(e.isEmpty())return sl.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===sl.EXTERIOR)return sl.EXTERIOR;if(i===sl.BOUNDARY)return sl.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r),s=this.locateInPolygonRing(t,o);if(s===sl.INTERIOR)return sl.EXTERIOR;if(s===sl.BOUNDARY)return sl.BOUNDARY}return sl.INTERIOR}if(arguments[0]instanceof nl&&arguments[1]instanceof Su){var a=arguments[0],l=arguments[1];if(!l.getEnvelopeInternal().intersects(a))return sl.EXTERIOR;var u=l.getCoordinates();return l.isClosed()||!a.equals(u[0])&&!a.equals(u[u.length-1])?Gl.isOnLine(a,u)?sl.INTERIOR:sl.EXTERIOR:sl.BOUNDARY}if(arguments[0]instanceof nl&&arguments[1]instanceof Lu){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?sl.INTERIOR:sl.EXTERIOR}},ip.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?Gl.locatePointInRing(t,e.getCoordinates()):sl.EXTERIOR},ip.prototype.intersects=function(t,e){return this.locate(t,e)!==sl.EXTERIOR},ip.prototype.updateLocationInfo=function(t){t===sl.INTERIOR&&(this._isIn=!0),t===sl.BOUNDARY&&this._numBoundaries++},ip.prototype.computeLocation=function(t,e){if(e instanceof Lu&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Su)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Ou)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof wu)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof Du)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof Cu)for(var l=new vh(e);l.hasNext();){var u=l.next();u!==e&&this.computeLocation(t,u)}},ip.prototype.locate=function(t,e){return e.isEmpty()?sl.EXTERIOR:e instanceof Su||e instanceof Ou?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?sl.BOUNDARY:this._numBoundaries>0||this._isIn?sl.INTERIOR:sl.EXTERIOR)},ip.prototype.interfaces_=function(){return[]},ip.prototype.getClass=function(){return ip};var rp=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var e=arguments[0],n=arguments[1];t.call(this,e,t.INSIDE_AREA,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._component=i,this._segIndex=r,this._pt=o}},op={INSIDE_AREA:{configurable:!0}};rp.prototype.isInsideArea=function(){return this._segIndex===rp.INSIDE_AREA},rp.prototype.getCoordinate=function(){return this._pt},rp.prototype.getGeometryComponent=function(){return this._component},rp.prototype.getSegmentIndex=function(){return this._segIndex},rp.prototype.interfaces_=function(){return[]},rp.prototype.getClass=function(){return rp},op.INSIDE_AREA.get=function(){return-1},Object.defineProperties(rp,op);var sp=function(t){this._pts=t||null};sp.prototype.filter=function(t){t instanceof Lu&&this._pts.add(t)},sp.prototype.interfaces_=function(){return[vu]},sp.prototype.getClass=function(){return sp},sp.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Lu?Oc.singletonList(t):sp.getPoints(t,new nu)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Lu?n.add(e):e instanceof Cu&&e.apply(new sp(n)),n}};var ap=function(){this._locations=null;var t=arguments[0];this._locations=t};ap.prototype.filter=function(t){(t instanceof Lu||t instanceof Su||t instanceof Ou)&&this._locations.add(new rp(t,0,t.getCoordinate()))},ap.prototype.interfaces_=function(){return[vu]},ap.prototype.getClass=function(){return ap},ap.getLocations=function(t){var e=new nu;return t.apply(new ap(e)),e};var lp=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new ip,this._minDistanceLocation=null,this._minDistance=Ja.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=i,this._terminateDistance=r}};lp.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=ep.getPolygons(this._geom[e]);if(r.size()>0){var o=ap.getLocations(this._geom[i]);if(this.computeContainmentDistance(o,r,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&ll(arguments[0],eu)&&ll(arguments[1],eu)){for(var s=arguments[0],a=arguments[1],l=arguments[2],u=0;u<s.size();u++)for(var c=s.get(u),h=0;h<a.size();h++)if(this.computeContainmentDistance(c,a.get(h),l),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof rp&&arguments[1]instanceof Ou){var p=arguments[0],f=arguments[1],d=arguments[2],g=p.getCoordinate();if(sl.EXTERIOR!==this._ptLocator.locate(g,f))return this._minDistance=0,d[0]=p,d[1]=new rp(f,g),null}},lp.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},lp.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=np.getLines(this._geom[0]),n=np.getLines(this._geom[1]),i=sp.getPoints(this._geom[0]),r=sp.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},lp.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},lp.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},lp.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},lp.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Su&&arguments[1]instanceof Lu){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),o=0;o<i.length-1;o++){var s=Gl.distancePointLine(r,i[o],i[o+1]);if(s<this._minDistance){this._minDistance=s;var a=new Xc(i[o],i[o+1]).closestPoint(r);n[0]=new rp(t,o,a),n[1]=new rp(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Su&&arguments[1]instanceof Su){var l=arguments[0],u=arguments[1],c=arguments[2];if(l.getEnvelopeInternal().distance(u.getEnvelopeInternal())>this._minDistance)return null;for(var h=l.getCoordinates(),p=u.getCoordinates(),f=0;f<h.length-1;f++)for(var d=0;d<p.length-1;d++){var g=Gl.distanceLineLine(h[f],h[f+1],p[d],p[d+1]);if(g<this._minDistance){this._minDistance=g;var y=new Xc(h[f],h[f+1]),m=new Xc(p[d],p[d+1]),_=y.closestPoints(m);c[0]=new rp(l,f,_[0]),c[1]=new rp(u,d,_[1])}if(this._minDistance<=this._terminateDistance)return null}}},lp.prototype.computeMinDistancePoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o),a=r.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new rp(r,0,r.getCoordinate()),n[1]=new rp(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},lp.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new Za("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},lp.prototype.computeMinDistanceLines=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},lp.prototype.interfaces_=function(){return[]},lp.prototype.getClass=function(){return lp},lp.distance=function(t,e){return new lp(t,e).distance()},lp.isWithinDistance=function(t,e,n){return new lp(t,e,n).distance()<=n},lp.nearestPoints=function(t,e){return new lp(t,e).nearestPoints()};var up=function(){this._pt=[new nl,new nl],this._distance=Ja.NaN,this._isNull=!0};up.prototype.getCoordinates=function(){return this._pt},up.prototype.getCoordinate=function(t){return this._pt[t]},up.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},up.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},up.prototype.toString=function(){return Ll.toLineString(this._pt[0],this._pt[1])},up.prototype.getDistance=function(){return this._distance},up.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},up.prototype.interfaces_=function(){return[]},up.prototype.getClass=function(){return up};var cp=function(){};cp.prototype.interfaces_=function(){return[]},cp.prototype.getClass=function(){return cp},cp.computeDistance=function(){if(arguments[2]instanceof up&&arguments[0]instanceof Su&&arguments[1]instanceof nl)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=new Xc,r=t.getCoordinates(),o=0;o<r.length-1;o++){i.setCoordinates(r[o],r[o+1]);var s=i.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof up&&arguments[0]instanceof Ou&&arguments[1]instanceof nl){var a=arguments[0],l=arguments[1],u=arguments[2];cp.computeDistance(a.getExteriorRing(),l,u);for(var c=0;c<a.getNumInteriorRing();c++)cp.computeDistance(a.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof up&&arguments[0]instanceof Ul&&arguments[1]instanceof nl){var h=arguments[0],p=arguments[1],f=arguments[2];if(h instanceof Su)cp.computeDistance(h,p,f);else if(h instanceof Ou)cp.computeDistance(h,p,f);else if(h instanceof Cu)for(var d=h,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);cp.computeDistance(y,p,f)}else f.setMinimum(h.getCoordinate(),p)}else if(arguments[2]instanceof up&&arguments[0]instanceof Xc&&arguments[1]instanceof nl){var m=arguments[0],_=arguments[1],v=arguments[2],x=m.closestPoint(_);v.setMinimum(x,_)}};var hp=function(){this._g0=null,this._g1=null,this._ptDist=new up,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},pp={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};hp.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},hp.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new Za("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},hp.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},hp.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},hp.prototype.computeOrientedDistance=function(t,e,n){var i=new fp(e);if(t.apply(i),n.setMaximum(i.getMaxPointDistance()),this._densifyFrac>0){var r=new dp(e,this._densifyFrac);t.apply(r),n.setMaximum(r.getMaxPointDistance())}},hp.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},hp.prototype.interfaces_=function(){return[]},hp.prototype.getClass=function(){return hp},hp.distance=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new hp(t,e).distance()}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new hp(n,i);return o.setDensifyFraction(r),o.distance()}},pp.MaxPointDistanceFilter.get=function(){return fp},pp.MaxDensifiedByFractionDistanceFilter.get=function(){return dp},Object.defineProperties(hp,pp);var fp=function(){this._maxPtDist=new up,this._minPtDist=new up,this._euclideanDist=new cp,this._geom=null;var t=arguments[0];this._geom=t};fp.prototype.filter=function(t){this._minPtDist.initialize(),cp.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},fp.prototype.getMaxPointDistance=function(){return this._maxPtDist},fp.prototype.interfaces_=function(){return[Hl]},fp.prototype.getClass=function(){return fp};var dp=function(){this._maxPtDist=new up,this._minPtDist=new up,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};dp.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=(i.x-n.x)/this._numSubSegs,o=(i.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=n.x+s*r,l=n.y+s*o,u=new nl(a,l);this._minPtDist.initialize(),cp.computeDistance(this._geom,u,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},dp.prototype.isDone=function(){return!1},dp.prototype.isGeometryChanged=function(){return!1},dp.prototype.getMaxPointDistance=function(){return this._maxPtDist},dp.prototype.interfaces_=function(){return[xu]},dp.prototype.getClass=function(){return dp};var gp=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},yp={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};gp.prototype.checkMaximumDistance=function(t,e,n){var i=new hp(e,t);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var r=i.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Ll.toLineString(r[0],r[1])+")"}},gp.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=gp.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),gp.VERBOSE&&wl.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},gp.prototype.checkNegativeValid=function(){if(!(this._input instanceof Ou||this._input instanceof Du||this._input instanceof Cu))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},gp.prototype.getErrorIndicator=function(){return this._errorIndicator},gp.prototype.checkMinimumDistance=function(t,e,n){var i=new lp(t,e,n);if(this._minDistanceFound=i.distance(),this._minDistanceFound<n){this._isValid=!1;var r=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Ll.toLineString(r[0],r[1])+" )"}},gp.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},gp.prototype.getErrorLocation=function(){return this._errorLocation},gp.prototype.getPolygonLines=function(t){for(var e=new nu,n=new np(e),i=ep.getPolygons(t).iterator();i.hasNext();)i.next().apply(n);return t.getFactory().buildGeometry(e)},gp.prototype.getErrorMessage=function(){return this._errMsg},gp.prototype.interfaces_=function(){return[]},gp.prototype.getClass=function(){return gp},yp.VERBOSE.get=function(){return!1},yp.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(gp,yp);var mp=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},_p={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};mp.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},mp.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*mp.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new El(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new El(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},mp.prototype.checkDistance=function(){var t=new gp(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},mp.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},mp.prototype.checkPolygonal=function(){this._result instanceof Ou||this._result instanceof Du||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},mp.prototype.getErrorIndicator=function(){return this._errorIndicator},mp.prototype.getErrorLocation=function(){return this._errorLocation},mp.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},mp.prototype.report=function(t){if(!mp.VERBOSE)return null;wl.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},mp.prototype.getErrorMessage=function(){return this._errorMsg},mp.prototype.interfaces_=function(){return[]},mp.prototype.getClass=function(){return mp},mp.isValidMsg=function(t,e,n){var i=new mp(t,e,n);return i.isValid()?null:i.getErrorMessage()},mp.isValid=function(t,e,n){return!!new mp(t,e,n).isValid()},_p.VERBOSE.get=function(){return!1},_p.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(mp,_p);var vp=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};vp.prototype.getCoordinates=function(){return this._pts},vp.prototype.size=function(){return this._pts.length},vp.prototype.getCoordinate=function(t){return this._pts[t]},vp.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},vp.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:qc.octant(this.getCoordinate(t),this.getCoordinate(t+1))},vp.prototype.setData=function(t){this._data=t},vp.prototype.getData=function(){return this._data},vp.prototype.toString=function(){return Ll.toLineString(new zu(this._pts))},vp.prototype.interfaces_=function(){return[Vc]},vp.prototype.getClass=function(){return vp};var xp=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new nu,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};xp.prototype.getInteriorIntersection=function(){return this._interiorIntersection},xp.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},xp.prototype.getIntersectionSegments=function(){return this._intSegments},xp.prototype.count=function(){return this._intersectionCount},xp.prototype.getIntersections=function(){return this._intersections},xp.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},xp.prototype.setKeepIntersections=function(t){this._keepIntersections=t},xp.prototype.processIntersections=function(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,i))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},xp.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},xp.prototype.hasIntersection=function(){return null!==this._interiorIntersection},xp.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},xp.prototype.interfaces_=function(){return[Ph]},xp.prototype.getClass=function(){return xp},xp.createAllIntersectionsFinder=function(t){var e=new xp(t);return e.setFindAllIntersections(!0),e},xp.createAnyIntersectionFinder=function(t){return new xp(t)},xp.createIntersectionCounter=function(t){var e=new xp(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var Cp=function(){this._li=new Fl,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};Cp.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Cp.prototype.getIntersections=function(){return this._segInt.getIntersections()},Cp.prototype.isValid=function(){return this.execute(),this._isValid},Cp.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Cp.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new xp(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new th;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Cp.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new ac(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Cp.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Ll.toLineString(t[0],t[1])+" and "+Ll.toLineString(t[2],t[3])},Cp.prototype.interfaces_=function(){return[]},Cp.prototype.getClass=function(){return Cp},Cp.computeIntersections=function(t){var e=new Cp(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var wp=function t(){this._nv=null;var e=arguments[0];this._nv=new Cp(t.toSegmentStrings(e))};wp.prototype.checkValid=function(){this._nv.checkValid()},wp.prototype.interfaces_=function(){return[]},wp.prototype.getClass=function(){return wp},wp.toSegmentStrings=function(t){for(var e=new nu,n=t.iterator();n.hasNext();){var i=n.next();e.add(new vp(i.getCoordinates(),i))}return e},wp.checkValid=function(t){new wp(t).checkValid()};var bp=function(t){this._mapOp=t};bp.prototype.map=function(t){for(var e=new nu,n=0;n<t.getNumGeometries();n++){var i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(Zu.toGeometryArray(e))},bp.prototype.interfaces_=function(){return[]},bp.prototype.getClass=function(){return bp},bp.map=function(t,e){return new bp(e).map(t)};var Ep=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new nu,this._resultLineList=new nu;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};Ep.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},Ep.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},Ep.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Ep.prototype.collectLineEdge=function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!of.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},Ep.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},Ep.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},Ep.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(i),n.setInResult(!0)}},Ep.prototype.collectBoundaryTouchEdge=function(t,e,n){var i=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(Rl.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(of.isResultOfOp(i,e)&&e===of.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},Ep.prototype.interfaces_=function(){return[]},Ep.prototype.getClass=function(){return Ep};var Ip=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new nu;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Ip.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Ip.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==of.INTERSECTION)){var i=n.getLabel();of.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},Ip.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Ip.prototype.interfaces_=function(){return[]},Ip.prototype.getClass=function(){return Ip};var Pp=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Pp.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Pp.prototype.transformPolygon=function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof Au&&!i.isEmpty()||(n=!1);for(var r=new nu,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof Au||(n=!1),r.add(s))}if(n)return this._factory.createPolygon(i,r.toArray([]));var a=new nu;return null!==i&&a.add(i),a.addAll(r),this._factory.buildGeometry(a)},Pp.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Pp.prototype.getInputGeometry=function(){return this._inputGeom},Pp.prototype.transformMultiLineString=function(t,e){for(var n=new nu,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Pp.prototype.transformCoordinates=function(t,e){return this.copy(t)},Pp.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Pp.prototype.transformMultiPoint=function(t,e){for(var n=new nu,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Pp.prototype.transformMultiPolygon=function(t,e){for(var n=new nu,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Pp.prototype.copy=function(t){return t.copy()},Pp.prototype.transformGeometryCollection=function(t,e){for(var n=new nu,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Zu.toGeometryArray(n)):this._factory.buildGeometry(n)},Pp.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Lu)return this.transformPoint(t,null);if(t instanceof Ru)return this.transformMultiPoint(t,null);if(t instanceof Au)return this.transformLinearRing(t,null);if(t instanceof Su)return this.transformLineString(t,null);if(t instanceof wu)return this.transformMultiLineString(t,null);if(t instanceof Ou)return this.transformPolygon(t,null);if(t instanceof Du)return this.transformMultiPolygon(t,null);if(t instanceof Cu)return this.transformGeometryCollection(t,null);throw new Za("Unknown Geometry subtype: "+t.getClass().getName())},Pp.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var i=n.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},Pp.prototype.interfaces_=function(){return[]},Pp.prototype.getClass=function(){return Pp};var Np=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Xc,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Su&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];t.call(this,e.getCoordinates(),n)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var i=arguments[0],r=arguments[1];this._srcPts=i,this._isClosed=t.isClosed(i),this._snapTolerance=r}};Np.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;i<n;i++){var r=t.get(i),o=this.findSnapForVertex(r,e);null!==o&&(t.set(i,new nl(o)),0===i&&this._isClosed&&t.set(t.size()-1,new nl(o)))}},Np.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},Np.prototype.snapTo=function(t){var e=new ru(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Np.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;i<n;i++){var r=e[i],o=this.findSegmentIndexToSnap(r,t);o>=0&&t.add(o+1,new nl(r),!1)}},Np.prototype.findSegmentIndexToSnap=function(t,e){for(var n=Ja.MAX_VALUE,i=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,i=r)}return i},Np.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Np.prototype.interfaces_=function(){return[]},Np.prototype.getClass=function(){return Np},Np.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var Sp=function(t){this._srcGeom=t||null},Tp={SNAP_PRECISION_FACTOR:{configurable:!0}};Sp.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new Lp(e,n).transform(this._srcGeom)},Sp.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),i=new Lp(t,n,!0).transform(this._srcGeom),r=i;return e&&ll(r,Mu)&&(r=i.buffer(0)),r},Sp.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},Sp.prototype.extractTargetCoordinates=function(t){for(var e=new Sr,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},Sp.prototype.computeMinimumSegmentLength=function(t){for(var e=Ja.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);i<e&&(e=i)}return e},Sp.prototype.interfaces_=function(){return[]},Sp.prototype.getClass=function(){return Sp},Sp.snap=function(t,e,n){var i=new Array(2).fill(null),r=new Sp(t);i[0]=r.snapTo(e,n);var o=new Sp(e);return i[1]=o.snapTo(i[0],n),i},Sp.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=Sp.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===Yu.FIXED){var i=1/n.getScale()*2/1.415;i>e&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min(Sp.computeOverlaySnapTolerance(r),Sp.computeOverlaySnapTolerance(o))}},Sp.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Sp.SNAP_PRECISION_FACTOR},Sp.snapToSelf=function(t,e,n){return new Sp(t).snapToSelf(e,n)},Tp.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Sp,Tp);var Lp=function(t){function e(e,n,i){t.call(this),this._snapTolerance=e||null,this._snapPts=n||null,this._isSelfSnap=void 0!==i&&i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var n=new Np(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Pp),Mp=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Mp.prototype.getCommon=function(){return Ja.longBitsToDouble(this._commonBits)},Mp.prototype.add=function(t){var e=Ja.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Mp.signExpBits(this._commonBits),this._isFirst=!1,null):Mp.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Mp.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Mp.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Mp.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=Ja.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+Ja.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}},Mp.prototype.interfaces_=function(){return[]},Mp.prototype.getClass=function(){return Mp},Mp.getBit=function(t,e){return 0!=(t&1<<e)?1:0},Mp.signExpBits=function(t){return t>>52},Mp.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},Mp.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;i>=0;i--){if(Mp.getBit(t,i)!==Mp.getBit(e,i))return n;n++}return 52};var Op=function(){this._commonCoord=null,this._ccFilter=new Ap},Rp={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Op.prototype.addCommonBits=function(t){var e=new Dp(this._commonCoord);t.apply(e),t.geometryChanged()},Op.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new nl(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new Dp(e);return t.apply(n),t.geometryChanged(),t},Op.prototype.getCommonCoordinate=function(){return this._commonCoord},Op.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},Op.prototype.interfaces_=function(){return[]},Op.prototype.getClass=function(){return Op},Rp.CommonCoordinateFilter.get=function(){return Ap},Rp.Translater.get=function(){return Dp},Object.defineProperties(Op,Rp);var Ap=function(){this._commonBitsX=new Mp,this._commonBitsY=new Mp};Ap.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},Ap.prototype.getCommonCoordinate=function(){return new nl(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},Ap.prototype.interfaces_=function(){return[Hl]},Ap.prototype.getClass=function(){return Ap};var Dp=function(){this.trans=null;var t=arguments[0];this.trans=t};Dp.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},Dp.prototype.isDone=function(){return!1},Dp.prototype.isGeometryChanged=function(){return!0},Dp.prototype.interfaces_=function(){return[xu]},Dp.prototype.getClass=function(){return Dp};var Fp=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};Fp.prototype.selfSnap=function(t){return new Sp(t).snapTo(t,this._snapTolerance)},Fp.prototype.removeCommonBits=function(t){this._cbr=new Op,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},Fp.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},Fp.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=of.overlayOp(e[0],e[1],t);return this.prepareResult(n)},Fp.prototype.checkValid=function(t){t.isValid()||wl.out.println("Snapped geometry is invalid")},Fp.prototype.computeSnapTolerance=function(){this._snapTolerance=Sp.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Fp.prototype.snap=function(t){var e=this.removeCommonBits(t);return Sp.snap(e[0],e[1],this._snapTolerance)},Fp.prototype.interfaces_=function(){return[]},Fp.prototype.getClass=function(){return Fp},Fp.overlayOp=function(t,e,n){return new Fp(t,e).getResultGeometry(n)},Fp.union=function(t,e){return Fp.overlayOp(t,e,of.UNION)},Fp.intersection=function(t,e){return Fp.overlayOp(t,e,of.INTERSECTION)},Fp.symDifference=function(t,e){return Fp.overlayOp(t,e,of.SYMDIFFERENCE)},Fp.difference=function(t,e){return Fp.overlayOp(t,e,of.DIFFERENCE)};var kp=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};kp.prototype.getResultGeometry=function(t){var e=null,n=!1,i=null;try{e=of.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof Ml))throw t;i=t}if(!n)try{e=Fp.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof Ml?i:t}return e},kp.prototype.interfaces_=function(){return[]},kp.prototype.getClass=function(){return kp},kp.overlayOp=function(t,e,n){return new kp(t,e).getResultGeometry(n)},kp.union=function(t,e){return kp.overlayOp(t,e,of.UNION)},kp.intersection=function(t,e){return kp.overlayOp(t,e,of.INTERSECTION)},kp.symDifference=function(t,e){return kp.overlayOp(t,e,of.SYMDIFFERENCE)},kp.difference=function(t,e){return kp.overlayOp(t,e,of.DIFFERENCE)};var Bp=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};Bp.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},Bp.prototype.interfaces_=function(){return[]},Bp.prototype.getClass=function(){return Bp};var Gp=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=i,this._xValue=r,this._obj=o}},jp={INSERT:{configurable:!0},DELETE:{configurable:!0}};Gp.prototype.isDelete=function(){return this._eventType===Gp.DELETE},Gp.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},Gp.prototype.getObject=function(){return this._obj},Gp.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},Gp.prototype.getInsertEvent=function(){return this._insertEvent},Gp.prototype.isInsert=function(){return this._eventType===Gp.INSERT},Gp.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},Gp.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},Gp.prototype.interfaces_=function(){return[$a]},Gp.prototype.getClass=function(){return Gp},jp.INSERT.get=function(){return 1},jp.DELETE.get=function(){return 2},Object.defineProperties(Gp,jp);var zp=function(){};zp.prototype.interfaces_=function(){return[]},zp.prototype.getClass=function(){return zp};var Up=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};Up.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(Up.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},Up.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Up.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},Up.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Up.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1},Up.prototype.hasProperIntersection=function(){return this._hasProper},Up.prototype.hasIntersection=function(){return this._hasIntersection},Up.prototype.isDone=function(){return this._isDone},Up.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},Up.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},Up.prototype.addIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},Up.prototype.interfaces_=function(){return[]},Up.prototype.getClass=function(){return Up},Up.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var qp=function(t){function e(){t.call(this),this.events=new nu,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){Oc.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof Up&&ll(arguments[0],eu)&&ll(arguments[1],eu)){var i=arguments[0],r=arguments[1],o=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&ll(arguments[0],eu)&&arguments[1]instanceof Up){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var o=new Bp(n,r),s=new Gp(e,n.getMinX(r),o);this.events.add(s),this.events.add(new Gp(n.getMaxX(r),s))}},e.prototype.processOverlaps=function(t,e,n,i){for(var r=n.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(r.computeIntersections(a,i),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();){var o=r.next();this.addEdge(o,i)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(zp),Vp=function(){this._min=Ja.POSITIVE_INFINITY,this._max=Ja.NEGATIVE_INFINITY},Hp={NodeComparator:{configurable:!0}};Vp.prototype.getMin=function(){return this._min},Vp.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},Vp.prototype.getMax=function(){return this._max},Vp.prototype.toString=function(){return Ll.toLineString(new nl(this._min,0),new nl(this._max,0))},Vp.prototype.interfaces_=function(){return[]},Vp.prototype.getClass=function(){return Vp},Hp.NodeComparator.get=function(){return Yp},Object.defineProperties(Vp,Hp);var Yp=function(){};Yp.prototype.compare=function(t,e){var n=t,i=e,r=(n._min+n._max)/2,o=(i._min+i._max)/2;return r<o?-1:r>o?1:0},Yp.prototype.interfaces_=function(){return[el]},Yp.prototype.getClass=function(){return Yp};var Xp=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],n=arguments[1],i=arguments[2];this._min=e,this._max=n,this._item=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Vp),Wp=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],n=arguments[1];this._node1=e,this._node2=n,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Vp),Kp=function(){this._leaves=new nu,this._root=null,this._level=0};Kp.prototype.buildTree=function(){Oc.sort(this._leaves,new Vp.NodeComparator);for(var t=this._leaves,e=null,n=new nu;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},Kp.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new Xp(t,e,n))},Kp.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},Kp.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},Kp.prototype.printNode=function(t){wl.out.println(Ll.toLineString(new nl(t._min,this._level),new nl(t._max,this._level)))},Kp.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},Kp.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new Wp(t.get(n),t.get(n+1));e.add(r)}}},Kp.prototype.interfaces_=function(){return[]},Kp.prototype.getClass=function(){return Kp};var Zp=function(){this._items=new nu};Zp.prototype.visitItem=function(t){this._items.add(t)},Zp.prototype.getItems=function(){return this._items},Zp.prototype.interfaces_=function(){return[Sc]},Zp.prototype.getClass=function(){return Zp};var Jp=function(){this._index=null;var t=arguments[0];if(!ll(t,Mu))throw new Za("Argument must be Polygonal");this._index=new tf(t)},Qp={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Jp.prototype.locate=function(t){var e=new Bl(t),n=new $p(e);return this._index.query(t.y,t.y,n),e.getLocation()},Jp.prototype.interfaces_=function(){return[_h]},Jp.prototype.getClass=function(){return Jp},Qp.SegmentVisitor.get=function(){return $p},Qp.IntervalIndexedGeometry.get=function(){return tf},Object.defineProperties(Jp,Qp);var $p=function(){this._counter=null;var t=arguments[0];this._counter=t};$p.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},$p.prototype.interfaces_=function(){return[Sc]},$p.prototype.getClass=function(){return $p};var tf=function(){this._index=new Kp;var t=arguments[0];this.init(t)};tf.prototype.init=function(t){for(var e=np.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},tf.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new Xc(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}},tf.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new Zp;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._index.query(i,r,o)}},tf.prototype.interfaces_=function(){return[]},tf.prototype.getClass=function(){return tf};var ef=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new Hu,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new ip,2===arguments.length){var e=arguments[0],n=arguments[1],i=Yl.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=n,this._boundaryNodeRule=i,null!==n&&this.add(n)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this._argIndex=r,this._parentGeom=o,this._boundaryNodeRule=s,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,n){var i=this._nodes.addNode(n).getLabel(),r=1;i.getLocation(t,rc.ON)===sl.BOUNDARY&&r++;var o=e.determineBoundary(this._boundaryNodeRule,r);i.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new Up(n,!0,!1);o.setIsDoneIfProperInt(r);var s=this.createEdgeSetIntersector(),a=this._parentGeom instanceof Au||this._parentGeom instanceof Ou||this._parentGeom instanceof Du,l=i||!a;return s.computeIntersections(this._edges,o,l),this.addSelfIntersectionNodes(this._argIndex),o}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,n){var i=new Up(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Lu){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,sl.INTERIOR)}else if(arguments[0]instanceof nl){var e=arguments[0];this.insertPoint(this._argIndex,e,sl.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),sl.EXTERIOR,sl.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,sl.INTERIOR,sl.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],sl.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],sl.BOUNDARY)},e.prototype.addLineString=function(t){var e=ou.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new Ah(e,new hc(this._argIndex,sl.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),Rl.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===sl.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},e.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var i=ou.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var r=e,o=n;Gl.isCCW(i)&&(r=n,o=e);var s=new Ah(i,new hc(this._argIndex,sl.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,i[0],sl.BOUNDARY)},e.prototype.insertPoint=function(t,e,n){var i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new hc(t,n):r.setLocation(t,n)},e.prototype.createEdgeSetIntersector=function(){return new qp},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,i)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof Du&&(this._useBoundaryDeterminationRule=!1),e instanceof Ou)this.addPolygon(e);else if(e instanceof Su)this.addLineString(e);else if(e instanceof Lu)this.addPoint(e);else if(e instanceof Ru)this.addCollection(e);else if(e instanceof wu)this.addCollection(e);else if(e instanceof Du)this.addCollection(e);else{if(!(e instanceof Cu))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},e.prototype.locate=function(t){return ll(this._parentGeom,Mu)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new Jp(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?sl.BOUNDARY:sl.INTERIOR},e}(bc),nf=function(){if(this._li=new Fl,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new ef(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=Yl.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new ef(0,e,i),this._arg[1]=new ef(1,n,i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];r.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new ef(0,r,s),this._arg[1]=new ef(1,o,s)}};nf.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},nf.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},nf.prototype.interfaces_=function(){return[]},nf.prototype.getClass=function(){return nf};var rf=function(){};rf.prototype.interfaces_=function(){return[]},rf.prototype.getClass=function(){return rf},rf.map=function(){if(arguments[0]instanceof Ul&&ll(arguments[1],rf.MapOp)){for(var t=arguments[0],e=arguments[1],n=new nu,i=0;i<t.getNumGeometries();i++){var r=e.map(t.getGeometryN(i));null!==r&&n.add(r)}return t.getFactory().buildGeometry(n)}if(ll(arguments[0],Ql)&&ll(arguments[1],rf.MapOp)){for(var o=arguments[0],s=arguments[1],a=new nu,l=o.iterator();l.hasNext();){var u=l.next(),c=s.map(u);null!==c&&a.add(c)}return a}},rf.MapOp=function(){};var of=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n),this._ptLocator=new ip,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Ih,this._resultPolyList=new nu,this._resultLineList=new nu,this._resultPointList=new nu,this._graph=new bc(new bh),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new hc(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,n,i,r){var o=new nu;return o.addAll(t),o.addAll(n),o.addAll(i),o.isEmpty()?e.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this._ptLocator.locate(t,i)!==sl.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new nu,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new nu;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),wp.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new Ec(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var i=new Ep(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);var r=new Ip(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var i=n.next(),r=i.getLabel();r.isArea()&&!i.isInteriorAreaEdge()&&e.isResultOfOp(r.getLocation(0,rc.RIGHT),r.getLocation(1,rc.RIGHT),t)&&i.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(Rl.isTrue(!i.isNull(r,rc.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,rc.LEFT,i.getLocation(r,rc.LEFT)),Rl.isTrue(!i.isNull(r,rc.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,rc.RIGHT,i.getLocation(r,rc.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(nf);of.overlayOp=function(t,e,n){return new of(t,e).getResultGeometry(n)},of.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return of.createEmptyResult(of.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return bp.map(t,{interfaces_:function(){return[rf.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),kp.overlayOp(t,e,of.INTERSECTION)},of.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return of.createEmptyResult(of.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),kp.overlayOp(t,e,of.SYMDIFFERENCE)},of.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),o=-1;switch(t){case of.INTERSECTION:o=Math.min(i,r);break;case of.UNION:o=Math.max(i,r);break;case of.DIFFERENCE:o=i;break;case of.SYMDIFFERENCE:o=Math.max(i,r)}return o},of.createEmptyResult=function(t,e,n,i){var r=null;switch(of.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},of.difference=function(t,e){return t.isEmpty()?of.createEmptyResult(of.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),kp.overlayOp(t,e,of.DIFFERENCE))},of.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return of.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];switch(r===sl.BOUNDARY&&(r=sl.INTERIOR),o===sl.BOUNDARY&&(o=sl.INTERIOR),s){case of.INTERSECTION:return r===sl.INTERIOR&&o===sl.INTERIOR;case of.UNION:return r===sl.INTERIOR||o===sl.INTERIOR;case of.DIFFERENCE:return r===sl.INTERIOR&&o!==sl.INTERIOR;case of.SYMDIFFERENCE:return r===sl.INTERIOR&&o!==sl.INTERIOR||r!==sl.INTERIOR&&o===sl.INTERIOR}return!1}},of.INTERSECTION=1,of.UNION=2,of.DIFFERENCE=3,of.SYMDIFFERENCE=4;var sf=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new ip,this._seg=new Xc;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};sf.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),i=0;i<n.size()-1;i++)if(n.getCoordinate(i,this._seg.p0),n.getCoordinate(i+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},sf.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?sl.BOUNDARY:this._ptLocator.locate(t,this._g)},sf.prototype.extractLinework=function(t){var e=new af;t.apply(e);var n=e.getLinework(),i=Zu.toLineStringArray(n);return t.getFactory().createMultiLineString(i)},sf.prototype.interfaces_=function(){return[]},sf.prototype.getClass=function(){return sf};var af=function(){this._linework=null,this._linework=new nu};af.prototype.getLinework=function(){return this._linework},af.prototype.filter=function(t){if(t instanceof Ou){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},af.prototype.interfaces_=function(){return[vu]},af.prototype.getClass=function(){return af};var lf=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};lf.prototype.extractPoints=function(t,e,n){for(var i=t.getCoordinates(),r=0;r<i.length-1;r++)this.computeOffsetPoints(i[r],i[r+1],e,n)},lf.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},lf.prototype.getPoints=function(t){for(var e=new nu,n=np.getLines(this._g).iterator();n.hasNext();){var i=n.next();this.extractPoints(i,t,e)}return e},lf.prototype.computeOffsetPoints=function(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,s=Math.sqrt(r*r+o*o),a=n*r/s,l=n*o/s,u=(e.x+t.x)/2,c=(e.y+t.y)/2;if(this._doLeft){var h=new nl(u-l,c+a);i.add(h)}if(this._doRight){var p=new nl(u+l,c-a);i.add(p)}},lf.prototype.interfaces_=function(){return[]},lf.prototype.getClass=function(){return lf};var uf=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new nu;var e=arguments[0],n=arguments[1],i=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,i],this._locFinder=[new sf(this._geom[0],this._boundaryDistanceTolerance),new sf(this._geom[1],this._boundaryDistanceTolerance),new sf(this._geom[2],this._boundaryDistanceTolerance)]},cf={TOLERANCE:{configurable:!0}};uf.prototype.reportResult=function(t,e,n){wl.out.println("Overlay result invalid - A:"+sl.toLocationSymbol(e[0])+" B:"+sl.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+sl.toLocationSymbol(e[2]))},uf.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},uf.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._location[0]=this._locFinder[0].getLocation(r),this._location[1]=this._locFinder[1].getLocation(r),this._location[2]=this._locFinder[2].getLocation(r),!!uf.hasLocation(this._location,sl.BOUNDARY)||this.isValidResult(i,this._location)}},uf.prototype.addTestPts=function(t){var e=new lf(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},uf.prototype.isValidResult=function(t,e){var n=of.isResultOfOp(e[0],e[1],t),i=!(n^e[2]===sl.INTERIOR);return i||this.reportResult(t,e,n),i},uf.prototype.getInvalidLocation=function(){return this._invalidLocation},uf.prototype.interfaces_=function(){return[]},uf.prototype.getClass=function(){return uf},uf.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},uf.computeBoundaryDistanceTolerance=function(t,e){return Math.min(Sp.computeSizeBasedSnapTolerance(t),Sp.computeSizeBasedSnapTolerance(e))},uf.isValid=function(t,e,n,i){return new uf(t,e,i).isValid(n)},cf.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(uf,cf);var hf=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};hf.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this._skipEmpty&&i.isEmpty()||e.add(i)}},hf.prototype.combine=function(){for(var t=new nu,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},hf.prototype.interfaces_=function(){return[]},hf.prototype.getClass=function(){return hf},hf.combine=function(){if(1===arguments.length){var t=arguments[0];return new hf(t).combine()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new hf(hf.createList(e,n)).combine()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];return new hf(hf.createList(i,r,o)).combine()}},hf.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},hf.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new nu;return n.add(t),n.add(e),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=new nu;return s.add(i),s.add(r),s.add(o),s}};var pf=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new nu)},ff={STRTREE_NODE_CAPACITY:{configurable:!0}};pf.prototype.reduceToGeometries=function(t){for(var e=new nu,n=t.iterator();n.hasNext();){var i=n.next(),r=null;ll(i,eu)?r=this.unionTree(i):i instanceof Ul&&(r=i),e.add(r)}return e},pf.prototype.extractByEnvelope=function(t,e,n){for(var i=new nu,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?i.add(o):n.add(o)}return this._geomFactory.buildGeometry(i)},pf.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return hf.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},pf.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new Bc(pf.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},pf.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(i-n<=1){var r=pf.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(pf.getGeometry(e,n),pf.getGeometry(e,n+1));var o=Math.trunc((i+n)/2),s=this.binaryUnion(e,n,o),a=this.binaryUnion(e,o,i);return this.unionSafe(s,a)}},pf.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},pf.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},pf.prototype.unionActual=function(t,e){return pf.restrictToPolygons(t.union(e))},pf.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},pf.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var i=new nu,r=this.extractByEnvelope(n,t,i),o=this.extractByEnvelope(n,e,i),s=this.unionActual(r,o);return i.add(s),hf.combine(i)},pf.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},pf.prototype.interfaces_=function(){return[]},pf.prototype.getClass=function(){return pf},pf.restrictToPolygons=function(t){if(ll(t,Mu))return t;var e=ep.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(Zu.toPolygonArray(e))},pf.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},pf.union=function(t){return new pf(t).union()},ff.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(pf,ff);var df=function(){};df.prototype.interfaces_=function(){return[]},df.prototype.getClass=function(){return df},df.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return of.createEmptyResult(of.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),kp.overlayOp(t,e,of.UNION)};var gf=function(){return new Rr};Rr.prototype={constructor:Rr,reset:function(){this.s=this.t=0},add:function(t){Ar(yf,t,this.t),Ar(this,yf.s,this.s),this.s?this.t+=yf.t:this.s=yf.t},valueOf:function(){return this.s}};var yf=new Rr,mf=1e-6,_f=Math.PI,vf=_f/2,xf=_f/4,Cf=2*_f,wf=180/_f,bf=_f/180,Ef=Math.abs,If=Math.atan,Pf=Math.atan2,Nf=Math.cos,Sf=Math.exp,Tf=Math.log,Lf=Math.sin,Mf=Math.sqrt,Of=Math.tan,Rf={Feature:function(t,e){kr(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)kr(n[i].geometry,e)}},Af={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Br(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Br(n[i],e,0)},Polygon:function(t,e){Gr(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Gr(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)kr(n[i],e)}},Df=function(t,e){t&&Rf.hasOwnProperty(t.type)?Rf[t.type](t,e):kr(t,e)},Ff=(gf(),gf(),gf(),function(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n});Xr.invert=Xr;var kf=function(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:Fr,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},Bf=function(t,e,n,i,r,o){var s,a=t[0],l=t[1],u=0,c=1,h=e[0]-a,p=e[1]-l;if(s=n-a,h||!(s>0)){if(s/=h,h<0){if(s<u)return;s<c&&(c=s)}else if(h>0){if(s>c)return;s>u&&(u=s)}if(s=r-a,h||!(s<0)){if(s/=h,h<0){if(s>c)return;s>u&&(u=s)}else if(h>0){if(s<u)return;s<c&&(c=s)}if(s=i-l,p||!(s>0)){if(s/=p,p<0){if(s<u)return;s<c&&(c=s)}else if(p>0){if(s>c)return;s>u&&(u=s)}if(s=o-l,p||!(s<0)){if(s/=p,p<0){if(s>c)return;s>u&&(u=s)}else if(p>0){if(s<u)return;s<c&&(c=s)}return u>0&&(t[0]=a+u*h,t[1]=l+u*p),c<1&&(e[0]=a+c*h,e[1]=l+c*p),!0}}}}},Gf=function(t,e){return Ef(t[0]-e[0])<mf&&Ef(t[1]-e[1])<mf},jf=function(t,e,n,i,r){var o,s,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],s=t[e];if(Gf(i,s)){for(r.lineStart(),o=0;o<e;++o)r.point((i=t[o])[0],i[1]);r.lineEnd()}else a.push(n=new $r(i,t,null,!0)),l.push(n.o=new $r(i,null,n,!1)),a.push(n=new $r(s,t,null,!1)),l.push(n.o=new $r(s,null,n,!0))}})),a.length){for(l.sort(e),to(a),to(l),o=0,s=l.length;o<s;++o)l[o].e=n=!n;for(var u,c,h=a[0];;){for(var p=h,f=!0;p.v;)if((p=p.n)===h)return;u=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(o=0,s=u.length;o<s;++o)r.point((c=u[o])[0],c[1]);else i(p.x,p.n.x,1,r);p=p.n}else{if(f)for(u=p.p.z,o=u.length-1;o>=0;--o)r.point((c=u[o])[0],c[1]);else i(p.x,p.p.x,-1,r);p=p.p}u=(p=p.o).z,f=!f}while(!p.v);r.lineEnd()}}},zf=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Uf=(function(t){1===t.length&&(t=function(t){return function(e,n){return zf(t(e),n)}}(t))}(zf),function(t){for(var e,n,i,r=t.length,o=-1,s=0;++o<r;)s+=t[o].length;for(n=new Array(s);--r>=0;)for(e=(i=t[r]).length;--e>=0;)n[--s]=i[e];return n}),qf=1e9,Vf=-qf,Hf=gf(),Yf=(gf(),function(t){return t}),Xf=(gf(),gf(),1/0),Wf=Xf,Kf=-Xf,Zf=Kf,Jf={point:function(t,e){t<Xf&&(Xf=t),t>Kf&&(Kf=t),e<Wf&&(Wf=e),e>Zf&&(Zf=e)},lineStart:Fr,lineEnd:Fr,polygonStart:Fr,polygonEnd:Fr,result:function(){var t=[[Xf,Wf],[Kf,Zf]];return Kf=Zf=-(Wf=Xf=1/0),t}},Qf=(gf(),function(t,e,n,i){return function(r,o){function s(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&o.point(e,n)}function a(t,e){var n=r(t,e);y.point(n[0],n[1])}function l(){C.point=a,y.lineStart()}function u(){C.point=s,y.lineEnd()}function c(t,e){g.push([t,e]);var n=r(t,e);v.point(n[0],n[1])}function h(){v.lineStart(),g=[]}function p(){c(g[0][0],g[0][1]),v.lineEnd();var t,e,n,i,r=v.clean(),s=_.result(),a=s.length;if(g.pop(),f.push(g),g=null,a)if(1&r){if((e=(n=s[0]).length-1)>0){for(x||(o.polygonStart(),x=!0),o.lineStart(),t=0;t<e;++t)o.point((i=n[t])[0],i[1]);o.lineEnd()}}else a>1&&2&r&&s.push(s.pop().concat(s.shift())),d.push(s.filter(no))}var f,d,g,y=e(o),m=r.invert(i[0],i[1]),_=kf(),v=e(_),x=!1,C={point:s,lineStart:l,lineEnd:u,polygonStart:function(){C.point=c,C.lineStart=h,C.lineEnd=p,d=[],f=[]},polygonEnd:function(){C.point=s,C.lineStart=l,C.lineEnd=u,d=Uf(d);var t=function(t,e){var n=e[0],i=e[1],r=[Lf(n),-Nf(n),0],o=0,s=0;Hf.reset();for(var a=0,l=t.length;a<l;++a)if(c=(u=t[a]).length)for(var u,c,h=u[c-1],p=h[0],f=h[1]/2+xf,d=Lf(f),g=Nf(f),y=0;y<c;++y,p=_,d=x,g=C,h=m){var m=u[y],_=m[0],v=m[1]/2+xf,x=Lf(v),C=Nf(v),w=_-p,b=w>=0?1:-1,E=b*w,I=E>_f,P=d*x;if(Hf.add(Pf(P*b*Lf(E),g*C+P*Nf(E))),o+=I?w+b*Cf:w,I^p>=n^_>=n){var N=qr(zr(h),zr(m));Yr(N);var S=qr(r,N);Yr(S);var T=(I^w>=0?-1:1)*Dr(S[2]);(i>T||i===T&&(N[0]||N[1]))&&(s+=I^w>=0?1:-1)}}return(o<-mf||o<mf&&Hf<-mf)^1&s}(f,m);d.length?(x||(o.polygonStart(),x=!0),jf(d,io,t,n,o)):t&&(x||(o.polygonStart(),x=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),x&&(o.polygonEnd(),x=!1),d=f=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};return C}}),$f=Qf((function(){return!0}),(function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?_f:-_f,l=Ef(o-n);Ef(l-_f)<mf?(t.point(n,i=(i+s)/2>0?vf:-vf),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),t.point(o,i),e=0):r!==a&&l>=_f&&(Ef(n-r)<mf&&(n-=r*mf),Ef(o-a)<mf&&(o-=a*mf),i=function(t,e,n,i){var r,o,s=Lf(t-n);return Ef(s)>mf?If((Lf(e)*(o=Nf(i))*Lf(n)-Lf(i)*(r=Nf(e))*Lf(t))/(r*o*s)):(e+i)/2}(n,i,o,s),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),e=0),t.point(n=o,i=s),r=a},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}),(function(t,e,n,i){var r;if(null==t)r=n*vf,i.point(-_f,r),i.point(0,r),i.point(_f,r),i.point(_f,0),i.point(_f,-r),i.point(0,-r),i.point(-_f,-r),i.point(-_f,0),i.point(-_f,r);else if(Ef(t[0]-e[0])>mf){var o=t[0]<e[0]?_f:-_f;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])}),[-_f,-vf]),td=function(t,e){function n(t,e){return Nf(t)*Nf(e)>o}function i(t,e,n){var i=[1,0,0],r=qr(zr(t),zr(e)),s=Ur(r,r),a=r[0],l=s-a*a;if(!l)return!n&&t;var u=o*s/l,c=-o*a/l,h=qr(i,r),p=Hr(i,u);Vr(p,Hr(r,c));var f=h,d=Ur(p,f),g=Ur(f,f),y=d*d-g*(Ur(p,p)-1);if(!(y<0)){var m=Mf(y),_=Hr(f,(-d-m)/g);if(Vr(_,p),_=jr(_),!n)return _;var v,x=t[0],C=e[0],w=t[1],b=e[1];C<x&&(v=x,x=C,C=v);var E=C-x,I=Ef(E-_f)<mf;if(!I&&b<w&&(v=w,w=b,b=v),I||E<mf?I?w+b>0^_[1]<(Ef(_[0]-x)<mf?w:b):w<=_[1]&&_[1]<=b:E>_f^(x<=_[0]&&_[0]<=C)){var P=Hr(f,(-d+m)/g);return Vr(P,p),[_,jr(P)]}}}function r(e,n){var i=s?t:_f-t,r=0;return e<-i?r|=1:e>i&&(r|=2),n<-i?r|=4:n>i&&(r|=8),r}var o=Nf(t),s=o>0,a=Ef(o)>mf;return Qf(n,(function(t){var e,o,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,p){var f,d=[h,p],g=n(h,p),y=s?g?0:r(h,p):g?r(h+(h<0?_f:-_f),p):0;if(!e&&(u=l=g)&&t.lineStart(),g!==l&&(!(f=i(e,d))||Gf(e,f)||Gf(d,f))&&(d[0]+=mf,d[1]+=mf,g=n(d[0],d[1])),g!==l)c=0,g?(t.lineStart(),f=i(d,e),t.point(f[0],f[1])):(f=i(e,d),t.point(f[0],f[1]),t.lineEnd()),e=f;else if(a&&e&&s^g){var m;y&o||!(m=i(d,e,!0))||(c=0,s?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1])))}!g||e&&Gf(e,d)||t.point(d[0],d[1]),e=d,l=g,o=y},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(n,i,r,o){!function(t,e,n,i,r,o){if(n){var s=Nf(e),a=Lf(e),l=i*n;null==r?(r=e+i*Cf,o=e-l/2):(r=Qr(s,r),o=Qr(s,o),(i>0?r<o:r>o)&&(r+=i*Cf));for(var u,c=r;i>0?c>o:c<o;c-=l)u=jr([s,-a*Nf(c),-a*Lf(c)]),t.point(u[0],u[1])}}(o,t,e,r,n,i)}),s?[0,-t]:[-_f,t-_f])};oo.prototype={constructor:oo,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var ed=Nf(30*bf),nd=function(t,e){return+e?function(t,e){function n(i,r,o,s,a,l,u,c,h,p,f,d,g,y){var m=u-i,_=c-r,v=m*m+_*_;if(v>4*e&&g--){var x=s+p,C=a+f,w=l+d,b=Mf(x*x+C*C+w*w),E=Dr(w/=b),I=Ef(Ef(w)-1)<mf||Ef(o-h)<mf?(o+h)/2:Pf(C,x),P=t(I,E),N=P[0],S=P[1],T=N-i,L=S-r,M=_*T-m*L;(M*M/v>e||Ef((m*T+_*L)/v-.5)>.3||s*p+a*f+l*d<ed)&&(n(i,r,o,s,a,l,N,S,I,x/=b,C/=b,w,g,y),y.point(N,S),n(N,S,I,x,C,w,u,c,h,p,f,d,g,y))}}return function(e){function i(n,i){n=t(n,i),e.point(n[0],n[1])}function r(){m=NaN,w.point=o,e.lineStart()}function o(i,r){var o=zr([i,r]),s=t(i,r);n(m,_,y,v,x,C,m=s[0],_=s[1],y=i,v=o[0],x=o[1],C=o[2],16,e),e.point(m,_)}function s(){w.point=i,e.lineEnd()}function a(){r(),w.point=l,w.lineEnd=u}function l(t,e){o(c=t,e),h=m,p=_,f=v,d=x,g=C,w.point=o}function u(){n(m,_,y,v,x,C,h,p,c,f,d,g,16,e),w.lineEnd=s,s()}var c,h,p,f,d,g,y,m,_,v,x,C,w={point:i,lineStart:r,lineEnd:s,polygonStart:function(){e.polygonStart(),w.lineStart=a},polygonEnd:function(){e.polygonEnd(),w.lineStart=r}};return w}}(t,e):function(t){return ro({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)},id=ro({point:function(t,e){this.stream.point(t*bf,e*bf)}});ao.invert=function(t,e){return[t,2*If(Sf(e))-vf]},lo.invert=function(t,e){return[-e,2*If(Sf(t))-vf]};var rd=function(){var t=function(t){function e(){var e=_f*a(),s=o(function(t){function e(e){return(e=t(e[0]*bf,e[1]*bf))[0]*=wf,e[1]*=wf,e}return t=Wr(t[0]*bf,t[1]*bf,t.length>2?t[2]*bf:0),e.invert=function(e){return(e=t.invert(e[0]*bf,e[1]*bf))[0]*=wf,e[1]*=wf,e},e}(o.rotate()).invert([0,0]));return u(null==c?[[s[0]-e,s[1]-e],[s[0]+e,s[1]+e]]:t===ao?[[Math.max(s[0]-e,c),n],[Math.min(s[0]+e,i),r]]:[[c,Math.max(s[1]-e,n)],[i,Math.min(s[1]+e,r)]])}var n,i,r,o=function(t){return function(t){function e(t){return[(t=u(t[0]*bf,t[1]*bf))[0]*g+s,a-t[1]*g]}function n(t,e){return[(t=o(t,e))[0]*g+s,a-t[1]*g]}function i(){u=Ff(l=Wr(x,C,w),o);var t=o(_,v);return s=y-t[0]*g,a=m+t[1]*g,r()}function r(){return f=d=null,e}var o,s,a,l,u,c,h,p,f,d,g=150,y=480,m=250,_=0,v=0,x=0,C=0,w=0,b=null,E=$f,I=null,P=Yf,N=.5,S=nd(n,N);return e.stream=function(t){return f&&d===t?f:f=id(E(l,S(P(d=t))))},e.clipAngle=function(t){return arguments.length?(E=+t?td(b=t*bf,6*bf):(b=null,$f),r()):b*wf},e.clipExtent=function(t){return arguments.length?(P=null==t?(I=c=h=p=null,Yf):eo(I=+t[0][0],c=+t[0][1],h=+t[1][0],p=+t[1][1]),r()):null==I?null:[[I,c],[h,p]]},e.scale=function(t){return arguments.length?(g=+t,i()):g},e.translate=function(t){return arguments.length?(y=+t[0],m=+t[1],i()):[y,m]},e.center=function(t){return arguments.length?(_=t[0]%360*bf,v=t[1]%360*bf,i()):[_*wf,v*wf]},e.rotate=function(t){return arguments.length?(x=t[0]%360*bf,C=t[1]%360*bf,w=t.length>2?t[2]%360*bf:0,i()):[x*wf,C*wf,w*wf]},e.precision=function(t){return arguments.length?(S=nd(n,N=t*t),r()):Mf(N)},e.fitExtent=function(t,n){return so(e,t,n)},e.fitSize=function(t,n){return function(t,e,n){return so(t,[[0,0],e],n)}(e,t,n)},function(){return o=t.apply(this,arguments),e.invert=o.invert&&function(t){return(t=u.invert((t[0]-s)/g,(a-t[1])/g))&&[t[0]*wf,t[1]*wf]},i()}}((function(){return t}))()}(t),s=o.center,a=o.scale,l=o.translate,u=o.clipExtent,c=null;return o.scale=function(t){return arguments.length?(a(t),e()):a()},o.translate=function(t){return arguments.length?(l(t),e()):l()},o.center=function(t){return arguments.length?(s(t),e()):s()},o.clipExtent=function(t){return arguments.length?(null==t?c=n=i=r=null:(c=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),e()):null==c?null:[[c,n],[i,r]]},e()}(lo),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)};t.projection=cs,t.random=Xa,t.clusters=Wa,t.helpers=Po,t.invariant=So,t.meta=No,t.isolines=function(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.zProperty||"elevation",r=n.commonProperties||{},o=n.breaksProperties||[];if(W(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks must be an Array");if(!E(r))throw new Error("commonProperties must be an Object");if(!Array.isArray(o))throw new Error("breaksProperties must be an Array");var s=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",i=e.flip,r=e.flags;W(t,"Point","input must contain Points");for(var o=function(t,e){var n={};return M(t,(function(t){var e=V(t)[1];n[e]||(n[e]=[]),n[e].push(t)})),Object.keys(n).map((function(t){return n[t].sort((function(t,e){return V(t)[0]-V(e)[0]}))})).sort((function(t,n){return e?V(t[0])[1]-V(n[0])[1]:V(n[0])[1]-V(t[0])[1]}))}(t,i),s=[],a=0;a<o.length;a++){for(var l=o[a],u=[],c=0;c<l.length;c++){var h=l[c];h.properties[n]?u.push(h.properties[n]):u.push(0),!0===r&&(h.properties.matrixPosition=[a,c])}s.push(u)}return s}(t,{zProperty:i,flip:!0});return u(function(t,e,n){var i=U(n),r=i[2]-i[0],o=i[3]-i[1],s=i[0],a=i[1],l=e[0].length-1,u=e.length-1,c=r/l,h=o/u,p=function(t){t[0]=t[0]*c+s,t[1]=t[1]*h+a};return t.forEach((function(t){N(t,p)})),t}(function(t,e,n,i,r){for(var o=[],s=1;s<e.length;s++){var a=+e[s],l=Object.assign({},i,r[s]);l[n]=a;var u=c(Q(t,a),l);o.push(u)}return o}(s,e,i,r,o),s,t))},t.convex=Nt,t.pointsWithinPolygon=Lt,t.concave=function(t,n){if(!E(n=n||{}))throw new Error("options is invalid");if(!t)throw new Error("points is required");var i=n.maxEdge||1/0;if(!b(i))throw new Error("maxEdge is invalid");var r=Mt(function(t){var e=[],n={};return M(t,(function(t){if(t.geometry){var i=t.geometry.coordinates.join("-");n.hasOwnProperty(i)||(e.push(t),n[i]=!0)}})),u(e)}(t));if(r.features=r.features.filter((function(t){var e=t.geometry.coordinates[0][0],r=t.geometry.coordinates[0][1],o=t.geometry.coordinates[0][2],s=Dt(e,r,n),a=Dt(r,o,n),l=Dt(e,o,n);return s<=i&&a<=i&&l<=i})),r.features.length<1)return null;var o=Wt(r,n);return 1===o.coordinates.length&&(o.coordinates=o.coordinates[0],o.type="Polygon"),e(o)},t.collect=function(t,e,n,i){var r=Oo(6),o=e.features.map((function(t){return{minX:t.geometry.coordinates[0],minY:t.geometry.coordinates[1],maxX:t.geometry.coordinates[0],maxY:t.geometry.coordinates[1],property:t.properties[n]}}));return r.load(o),t.features.forEach((function(t){t.properties||(t.properties={});var e=U(t),n=[];r.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}).forEach((function(e){St([e.minX,e.minY],t)&&n.push(e.property)})),t.properties[i]=n})),t},t.flip=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if(!t)throw new Error("geojson is required");return!1!==n&&void 0!==n||(t=Ft(t)),N(t,(function(t){var e=t[0],n=t[1];t[0]=n,t[1]=e})),t},t.simplify=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=void 0!==e.tolerance?e.tolerance:1,i=e.highQuality||!1,r=e.mutate||!1;if(!t)throw new Error("geojson is required");if(n&&n<0)throw new Error("invalid tolerance");return!0!==r&&(t=Ft(t)),A(t,(function(t){!function(t,e,n){var i=t.type;if("Point"===i||"MultiPoint"===i)return t;Kt(t,!0);var r=t.coordinates;switch(i){case"LineString":t.coordinates=te(r,e,n);break;case"MultiLineString":t.coordinates=r.map((function(t){return te(t,e,n)}));break;case"Polygon":t.coordinates=ee(r,e,n);break;case"MultiPolygon":t.coordinates=r.map((function(t){return ee(t,e,n)}))}}(t,n,i)})),t},t.bezierSpline=ne,t.tag=function(t,e,n,i){return t=Ft(t),e=Ft(e),M(t,(function(t){t.properties||(t.properties={}),M(e,(function(e){void 0===t.properties[i]&&St(t,e)&&(t.properties[i]=e.properties[n])}))})),t},t.sample=function(t,e){if(!t)throw new Error("featurecollection is required");if(null==e)throw new Error("num is required");if("number"!=typeof e)throw new Error("num must be a number");return u(function(t,e){for(var n,i,r=t.slice(0),o=t.length,s=o-e;o-- >s;)n=r[i=Math.floor((o+1)*Math.random())],r[i]=r[o],r[o]=n;return r.slice(s)}(t.features,e))},t.envelope=re,t.square=oe,t.circle=ae,t.midpoint=function(t,e){return se(t,Dt(t,e)/2,le(t,e))},t.center=ue,t.centerOfMass=function t(e,n){switch(J(e)){case"Point":return e;case"Polygon":var r=[];N(e,(function(t){r.push(t)}));var o,s,a,l,u,c,h,p,f=ce(e,n),d=f.geometry.coordinates,g=0,y=0,m=0,_=r.map((function(t){return[t[0]-d[0],t[1]-d[1]]}));for(o=0;o<r.length-1;o++)l=(s=_[o])[0],c=s[1],u=(a=_[o+1])[0],m+=p=l*(h=a[1])-u*c,g+=(l+u)*p,y+=(c+h)*p;if(0===m)return f;var v=1/(.5*m*6);return i([d[0]+v*g,d[1]+v*y],n);default:var x=Nt(e);return x?t(x,n):ce(e,n)}},t.centroid=ce,t.combine=function(t){function n(t,e,n){n?i[e].coordinates=i[e].coordinates.concat(t.geometry.coordinates):i[e].coordinates.push(t.geometry.coordinates),i[e].properties.push(t.properties)}var i={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},r=Object.keys(i).reduce((function(t,e){return t[e.replace("Multi","")]=e,t}),{});return M(t,(function(t){t.geometry&&(i[t.geometry.type]?n(t,t.geometry.type,!0):r[t.geometry.type]&&n(t,r[t.geometry.type],!1))})),u(Object.keys(i).filter((function(t){return i[t].coordinates.length})).sort().map((function(t){return e({type:t,coordinates:i[t].coordinates},{collectedProperties:i[t].properties})})))},t.distance=Dt,t.explode=he,t.bbox=U,t.tesselate=function(t){if(!t.geometry||"Polygon"!==t.geometry.type&&"MultiPolygon"!==t.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return"Polygon"===t.geometry.type?e.features=Ne(t.geometry.coordinates):t.geometry.coordinates.forEach((function(t){e.features=e.features.concat(Ne(t))})),e},t.bboxPolygon=ie,t.booleanPointInPolygon=St,t.nearestPoint=Se,t.nearestPointOnLine=Ke,t.nearestPointToLine=function(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.units,r=n.properties||{};if(!t)throw new Error("points is required");if(!(t=function(t){var e=[];switch(t.geometry?t.geometry.type:t.type){case"GeometryCollection":return A(t,(function(t){"Point"===t.type&&e.push({type:"Feature",properties:{},geometry:t})})),{type:"FeatureCollection",features:e};case"FeatureCollection":return t.features=t.features.filter((function(t){return"Point"===t.geometry.type})),t;default:throw new Error("points must be a Point Collection")}}(t)).features.length)throw new Error("points must contain features");if(!e)throw new Error("line is required");if("LineString"!==J(e))throw new Error("line must be a LineString");var o=1/0,s=null;return M(t,(function(t){var n=on(t,e,{units:i});n<o&&(o=n,s=t)})),s&&(s.properties=Object.assign({dist:o},s.properties,r)),s},t.planepoint=function(t,e){var n=q(t),i=K(e).coordinates[0];if(i.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var r=e.properties||{},o=r.a,s=r.b,a=r.c,l=n[0],u=n[1],c=i[0][0],h=i[0][1],p=void 0!==o?o:i[0][2],f=i[1][0],d=i[1][1],g=void 0!==s?s:i[1][2],y=i[2][0],m=i[2][1],_=void 0!==a?a:i[2][2];return(_*(l-c)*(u-d)+p*(l-f)*(u-m)+g*(l-y)*(u-h)-g*(l-c)*(u-m)-_*(l-f)*(u-h)-p*(l-y)*(u-d))/((l-c)*(u-d)+(l-f)*(u-m)+(l-y)*(u-h)-(l-c)*(u-m)-(l-f)*(u-h)-(l-y)*(u-d))},t.tin=Mt,t.bearing=le,t.destination=se,t.kinks=function(t){var e,n,r={type:"FeatureCollection",features:[]};if("LineString"===(n="Feature"===t.type?t.geometry:t).type)e=[n.coordinates];else if("MultiLineString"===n.type)e=n.coordinates;else if("MultiPolygon"===n.type)e=[].concat.apply([],n.coordinates);else{if("Polygon"!==n.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=n.coordinates}return e.forEach((function(t){e.forEach((function(e){for(var n=0;n<t.length-1;n++)for(var o=n;o<e.length-1;o++){if(t===e){if(1===Math.abs(n-o))continue;if(0===n&&o===t.length-2&&t[n][0]===t[t.length-1][0]&&t[n][1]===t[t.length-1][1])continue}var s=function(t,e,n,i,r,o,s,a){var l,u,c,h,p={x:null,y:null,onLine1:!1,onLine2:!1};return 0==(l=(a-o)*(n-t)-(s-r)*(i-e))?null!==p.x&&null!==p.y&&p:(h=(n-t)*(u=e-o)-(i-e)*(c=t-r),u=((s-r)*u-(a-o)*c)/l,c=h/l,p.x=t+u*(n-t),p.y=e+u*(i-e),u>=0&&u<=1&&(p.onLine1=!0),c>=0&&c<=1&&(p.onLine2=!0),!(!p.onLine1||!p.onLine2)&&[p.x,p.y])}(t[n][0],t[n][1],t[n+1][0],t[n+1][1],e[o][0],e[o][1],e[o+1][0],e[o+1][1]);s&&r.features.push(i([s[0],s[1]]))}}))})),r},t.pointOnFeature=an,t.area=un,t.along=function(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r;if("Feature"===t.type)r=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");r=t.coordinates}if(!b(e))throw new Error("distance must be a number");for(var o=0,s=0;s<r.length&&!(e>=o&&s===r.length-1);s++){if(o>=e){var a=e-o;if(a){var l=le(r[s],r[s-1])-180;return se(r[s],a,l,n)}return i(r[s])}o+=Dt(r[s],r[s+1],n)}return i(r[r.length-1])},t.length=fn,t.lineSlice=function(t,e,n){var i=V(n);if("LineString"!==J(n))throw new Error("line must be a LineString");for(var r,o=Ke(n,t),s=Ke(n,e),l=[(r=o.properties.index<=s.properties.index?[o,s]:[s,o])[0].geometry.coordinates],u=r[0].properties.index+1;u<r[1].properties.index+1;u++)l.push(i[u]);return l.push(r[1].geometry.coordinates),a(l,n.properties)},t.lineSliceAlong=dn,t.pointGrid=vn,t.truncate=xn,t.flatten=function(t){if(!t)throw new Error("geojson is required");var e=[];return F(t,(function(t){e.push(t)})),u(e)},t.lineIntersect=Xe,t.lineChunk=function(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.units,r=n.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var o=[];return F(t,(function(t){r&&(t.geometry.coordinates=t.geometry.coordinates.reverse()),function(t,e,n,i){var r=fn(t,{units:n});if(r<=e)return i(t);var o=r/e;Number.isInteger(o)||(o=Math.floor(o)+1);for(var s=0;s<o;s++)i(dn(t,e*s,e*(s+1),{units:n}))}(t,e,i,(function(t){o.push(t)}))})),u(o)},t.unkinkPolygon=function(t){var e=[];return F(t,(function(t){"Polygon"===t.geometry.type&&M(ps(t),(function(n){e.push(o(n.geometry.coordinates,t.properties))}))})),u(e)},t.greatCircle=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var i=n.properties,r=n.npoints,o=n.offset;return t=q(t),e=q(e),i=i||{},r=r||100,o=o||10,new xs({x:t[0],y:t[1]},{x:e[0],y:e[1]},i).Arc(r,{offset:o}).json()},t.lineSegment=Ye,t.lineSplit=function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var n=J(t),i=J(e);if("LineString"!==n)throw new Error("line must be LineString");if("FeatureCollection"===i)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===i)throw new Error("splitter cannot be a GeometryCollection");var r=xn(e,{precision:7});switch(i){case"Point":return In(t,r);case"MultiPoint":return En(t,r);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return En(t,Xe(t,r))}},t.lineArc=Sn,t.polygonToLine=Ln,t.lineToPolygon=On,t.bboxClip=function(t,e){var n=function(t){return t.geometry?t.geometry.type:t.type}(t),i=V(t),r=t.properties;switch(n){case"LineString":case"MultiLineString":var s=[];return"LineString"===n&&(i=[i]),i.forEach((function(t){Cs(t,e,s)})),1===s.length?a(s[0],r):c(s,r);case"Polygon":return o(Bn(i,e),r);case"MultiPolygon":return p(i.map((function(t){return Bn(t,e)})),r);default:throw new Error("geometry "+n+" not supported")}},t.lineOverlap=qn,t.sector=function(t,e,n,i,r){if(!E(r=r||{}))throw new Error("options is invalid");if(!t)throw new Error("center is required");if(null==n)throw new Error("bearing1 is required");if(null==i)throw new Error("bearing2 is required");if(!e)throw new Error("radius is required");if("object"!=typeof r)throw new Error("options must be an object");if(Hn(n)===Hn(i))return ae(t,e,r);var s=V(t),a=[[s]];return N(Sn(t,e,n,i,r),(function(t){a[0].push(t)})),a[0].push(s),o(a)},t.rhumbBearing=Ze,t.rhumbDistance=Qe,t.rhumbDestination=Yn,t.polygonTangents=function(t,e){var n,r,o,s=V(t),a=V(e);switch(J(e)){case"Polygon":n=a[0][0],r=a[0][0],o=Wn(a[0][0],a[0][a[0].length-1],s);var l=Xn(a[0],s,o,void 0,n,r);n=l[0],r=l[1];break;case"MultiPolygon":n=a[0][0][0],r=a[0][0][0],o=Wn(a[0][0][0],a[0][0][a[0][0].length-1],s),a.forEach((function(t){var e=Xn(t[0],s,o,void 0,n,r);n=e[0],r=e[1]}))}return u([i(n),i(r)])},t.rewind=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.reverse||!1,i=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof i)throw new Error("<mutate> must be a boolean");!1===i&&(t=Ft(t));var r=[];switch(t.type){case"GeometryCollection":return A(t,(function(t){Zn(t,n)})),t;case"FeatureCollection":return M(t,(function(t){M(Zn(t,n),(function(t){r.push(t)}))})),u(r)}return Zn(t,n)},t.isobands=function(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.zProperty||"elevation",r=n.commonProperties||{},s=n.breaksProperties||[];if(W(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks is not an Array");if(!E(r))throw new Error("commonProperties is not an Object");if(!Array.isArray(s))throw new Error("breaksProperties is not an Array");var a=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",i=e.flip,r=e.flags;W(t,"Point","input must contain Points");for(var o=function(t,e){var n={};return M(t,(function(t){var e=V(t)[1];n[e]||(n[e]=[]),n[e].push(t)})),Object.keys(n).map((function(t){return n[t].sort((function(t,e){return V(t)[0]-V(e)[0]}))})).sort((function(t,n){return e?V(t[0])[1]-V(n[0])[1]:V(n[0])[1]-V(t[0])[1]}))}(t,i),s=[],a=0;a<o.length;a++){for(var l=o[a],u=[],c=0;c<l.length;c++){var h=l[c];h.properties[n]?u.push(h.properties[n]):u.push(0),!0===r&&(h.properties.matrixPosition=[a,c])}s.push(u)}return s}(t,{zProperty:i,flip:!0}),l=function(t,e,n){for(var i=[],r=1;r<e.length;r++){var s=+e[r-1],a=+e[r],l=function(t){for(var e=t.map((function(t){return{lrCoordinates:t,grouped:!1}})),n=[];!function(t){for(var e=0;e<t.length;e++)if(!1===t[e].grouped)return!1;return!0}(e);)for(var i=0;i<e.length;i++)if(!e[i].grouped){var r=[];r.push(e[i].lrCoordinates),e[i].grouped=!0;for(var s=o([e[i].lrCoordinates]),a=i+1;a<e.length;a++)e[a].grouped||function(t,e){for(var n=he(t),i=0;i<n.features.length;i++)if(!St(n.features[i],e))return!1;return!0}(o([e[a].lrCoordinates]),s)&&(r.push(e[a].lrCoordinates),e[a].grouped=!0);n.push(r)}return n}(function(t){var e=[],n=[];t.forEach((function(t){var i=un(o([t]));n.push(i),e.push({ring:t,area:i})})),n.sort((function(t,e){return e-t}));var i=[];return n.forEach((function(t){for(var n=0;n<e.length;n++)if(e[n].area===t){i.push(e[n].ring),e.splice(n,1);break}})),i}($n(t,s,a-s))),u={};u.groupedRings=l,u[n]=s+"-"+a,i.push(u)}return i}(a,e,i);return u((l=function(t,e,n){var i=U(n),r=i[2]-i[0],o=i[3]-i[1],s=i[0],a=i[1],l=e[0].length-1,u=e.length-1,c=r/l,h=o/u,p=function(t){t[0]=t[0]*c+s,t[1]=t[1]*h+a};return t.forEach((function(t){t.groupedRings.forEach((function(t){t.forEach((function(t){t.forEach(p)}))}))})),t}(l,a,t)).map((function(t,e){if(s[e]&&!E(s[e]))throw new Error("Each mappedProperty is required to be an Object");var n=Object.assign({},r,s[e]);return n[i]=t[i],p(t.groupedRings,n)})))},t.transformRotate=ni,t.transformScale=ii,t.transformTranslate=function(t,e,n,i){if(!E(i=i||{}))throw new Error("options is invalid");var r=i.units,o=i.zTranslation,s=i.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");if(o&&"number"!=typeof o&&isNaN(o))throw new Error("zTranslation is not a number");if(o=void 0!==o?o:0,0===e&&0===o)return t;if(null==n||isNaN(n))throw new Error("direction is required");return e<0&&(e=-e,n=-n),!1!==s&&void 0!==s||(t=Ft(t)),N(t,(function(t){var i=V(Yn(t,e,n,{units:r}));t[0]=i[0],t[1]=i[1],o&&3===t.length&&(t[2]+=o)})),t},t.lineOffset=function(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.units;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");var r=J(t),o=t.properties;switch(r){case"LineString":return ai(t,e,i);case"MultiLineString":var s=[];return F(t,(function(t){s.push(ai(t,e,i).geometry.coordinates)})),c(s,o);default:throw new Error("geometry "+r+" is not supported")}},t.polygonize=function(t){var e=xa.fromGeoJson(t);e.deleteDangles(),e.deleteCutEdges();var n=[],i=[];return e.getEdgeRings().filter((function(t){return t.isValid()})).forEach((function(t){t.isHole()?n.push(t):i.push(t)})),n.forEach((function(t){_a.findEdgeRingContaining(t,i)&&i.push(t)})),u(i.map((function(t){return t.toPolygon()})))},t.booleanDisjoint=function(t,e){var n;return F(t,(function(t){F(e,(function(e){if(!1===n)return!1;n=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return!function(t,e){return t[0]===e[0]&&t[1]===e[1]}(t.coordinates,e.coordinates);case"LineString":return!ci(e,t);case"Polygon":return!St(t,e)}break;case"LineString":switch(e.type){case"Point":return!ci(t,e);case"LineString":return!function(t,e){return Xe(t,e).features.length>0}(t,e);case"Polygon":return!hi(e,t)}break;case"Polygon":switch(e.type){case"Point":return!St(e,t);case"LineString":return!hi(t,e);case"Polygon":return!function(t,e){for(var n=0;n<t.coordinates[0].length;n++)if(St(t.coordinates[0][n],e))return!0;for(var i=0;i<e.coordinates[0].length;i++)if(St(e.coordinates[0][i],t))return!0;return!1}(e,t)}}}(t.geometry,e.geometry)}))})),n},t.booleanContains=function(t,e){var n=J(t),i=J(e),r=K(t),o=K(e),s=V(t),a=V(e);switch(n){case"Point":switch(i){case"Point":return fi(s,a);default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"Point":return function(t,e){var n,i=!1;for(n=0;n<t.coordinates.length;n++)if(fi(t.coordinates[n],e.coordinates)){i=!0;break}return i}(r,o);case"MultiPoint":return function(t,e){for(var n=0;n<e.coordinates.length;n++){for(var i=!1,r=0;r<t.coordinates.length;r++)if(fi(e.coordinates[n],t.coordinates[r])){i=!0;break}if(!i)return!1}return!0}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"Point":return gn(o,r,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var n=!1,i=0;i<e.coordinates.length;i++)if(gn({type:"Point",coordinates:e.coordinates[i]},t,{ignoreEndVertices:!0})&&(n=!0),!gn({type:"Point",coordinates:e.coordinates[i]},t,{ignoreEndVertices:!1}))return!1;return n}(r,o);case"MultiPoint":return function(t,e){for(var n=!1,i=0;i<e.coordinates.length;i++)if(gn(e.coordinates[i],t,{ignoreEndVertices:!0})&&(n=!0),!gn(e.coordinates[i],t))return!1;return!!n}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Point":return St(o,r,{ignoreBoundary:!0});case"LineString":return function(t,e){var n=!1,i=0;if(!pi(U(t),U(e)))return!1;for(;i<e.coordinates.length-1;i++)if(St({type:"Point",coordinates:function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}(e.coordinates[i],e.coordinates[i+1])},t,{ignoreBoundary:!0})){n=!0;break}return n}(r,o);case"Polygon":return function(t,e){if(!pi(U(t),U(e)))return!1;for(var n=0;n<e.coordinates[0].length;n++)if(!St(e.coordinates[0][n],t))return!1;return!0}(r,o);case"MultiPoint":return function(t,e){for(var n=0;n<e.coordinates.length;n++)if(!St(e.coordinates[n],t,{ignoreBoundary:!0}))return!1;return!0}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}},t.booleanCrosses=function(t,e){var n=J(t),i=J(e),r=K(t),o=K(e);switch(n){case"MultiPoint":switch(i){case"LineString":return di(r,o);case"Polygon":return yi(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"MultiPoint":return di(o,r);case"LineString":return function(t,e){if(Xe(t,e).features.length>0)for(var n=0;n<t.coordinates.length-1;n++)for(var i=0;i<e.coordinates.length-1;i++){var r=!0;if(0!==i&&i!==e.coordinates.length-2||(r=!1),mi(t.coordinates[n],t.coordinates[n+1],e.coordinates[i],r))return!0}return!1}(r,o);case"Polygon":return gi(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"MultiPoint":return yi(o,r);case"LineString":return gi(o,r);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}},t.booleanClockwise=Kn,t.booleanOverlap=Ci,t.booleanPointOnLine=gn,t.booleanEqual=function(t,e){if(!t)throw new Error("feature1 is required");if(!e)throw new Error("feature2 is required");return J(t)===J(e)&&new Ia({precision:6}).compare(Kt(t),Kt(e))},t.booleanWithin=yn,t.clone=Ft,t.cleanCoords=Kt,t.clustersDbscan=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var i=n.minPoints,r=n.units;if(W(t,"Point","Input must contain Points"),null==e)throw new Error("maxDistance is required");if(!(Math.sign(e)>0))throw new Error("Invalid maxDistance");if(!(null==i||Math.sign(i)>0))throw new Error("Invalid minPoints");t=Ft(t),i=i||3;var o=new La.DBSCAN,s=-1;return o.run(R(t),C(e,r),i,Dt).forEach((function(e){s++,e.forEach((function(e){var n=t.features[e];n.properties||(n.properties={}),n.properties.cluster=s,n.properties.dbscan="core"}))})),o.noise.forEach((function(e){var n=t.features[e];n.properties||(n.properties={}),n.properties.cluster?n.properties.dbscan="edge":n.properties.dbscan="noise"})),t},t.clustersKmeans=function(t,e){if("object"!=typeof(e=e||{}))throw new Error("options is invalid");var n=e.numberOfClusters,i=e.mutate;W(t,"Point","Input must contain Points");var r=t.features.length;(n=n||Math.round(Math.sqrt(r/2)))>r&&(n=r),!1!==i&&void 0!==i||(t=Ft(t));var o=R(t),s=o.slice(0,n),a=Da(o,n,s),l={};return a.centroids.forEach((function(t,e){l[e]=t})),M(t,(function(t,e){var n=a.idxs[e];t.properties.cluster=n,t.properties.centroid=l[n]})),t},t.pointToLineDistance=on,t.booleanParallel=function(t,e){if(!t)throw new Error("line1 is required");if(!e)throw new Error("line2 is required");if("LineString"!==bi(t,"line1"))throw new Error("line1 must be a LineString");if("LineString"!==bi(e,"line2"))throw new Error("line2 must be a LineString");for(var n=Ye(Kt(t)).features,i=Ye(Kt(e)).features,r=0;r<n.length;r++){var o=n[r].geometry.coordinates;if(!i[r])break;if(!function(t,e){return _(Ze(t[0],t[1]))===_(Ze(e[0],e[1]))}(o,i[r].geometry.coordinates))return!1}return!0},t.shortestPath=function(t,n,r){if(!E(r=r||{}))throw new Error("options is invalid");var o=r.resolution,s=r.minDistance,l=r.obstacles||u([]);if(!t)throw new Error("start is required");if(!n)throw new Error("end is required");if(o&&!b(o)||o<=0)throw new Error("options.resolution must be a number, greater than 0");if(s)throw new Error("options.minDistance is not yet implemented");var c=q(t),h=q(n);switch(t=i(c),n=i(h),J(l)){case"FeatureCollection":if(0===l.features.length)return a([c,h]);break;case"Polygon":l=u([e(K(l))]);break;default:throw new Error("invalid obstacles")}var p=l;p.features.push(t),p.features.push(n);var f=U(ii(ie(U(p)),1.15));o||(o=Dt([f[0],f[1]],[f[2],f[1]],r)/100),p.features.pop(),p.features.pop();for(var d=f[0],g=f[1],y=f[2],m=f[3],_=o/Dt([d,g],[y,g],r)*(y-d),v=o/Dt([d,g],[d,m],r)*(m-g),x=y-d,C=m-g,w=(x-Math.floor(x/_)*_)/2,I=[],P=[],N=[],S=[],T=1/0,L=1/0,M=m-(C-Math.floor(C/v)*v)/2,O=0;M>=g;){for(var R=[],A=[],D=d+w,F=0;D<=y;){var k=i([D,M]),B=function(t,e){for(var n=0;n<e.features.length;n++)if(St(t,e.features[n]))return!0;return!1}(k,l);R.push(B?0:1),A.push(D+"|"+M);var G=Dt(k,t);!B&&G<T&&(T=G,N={x:F,y:O});var j=Dt(k,n);!B&&j<L&&(L=j,S={x:F,y:O}),D+=_,F++}P.push(R),I.push(A),M-=v,O++}var z=new Ii(P,{diagonal:!0}),V=z.grid[N.y][N.x],H=z.grid[S.y][S.x],Y=[c];return Fa.search(z,V,H).forEach((function(t){var e=I[t.x][t.y].split("|");Y.push([+e[0],+e[1]])})),Y.push(h),Kt(a(Y))},t.voronoi=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.bbox||[-180,-85,180,85];if(!t)throw new Error("points is required");if(!Array.isArray(n))throw new Error("bbox is invalid");return W(t,"Point","points"),u(function(){function t(t){return new Qi(t.map((function(i,r){var o=[Math.round(e(i,r,t)/Ha)*Ha,Math.round(n(i,r,t)/Ha)*Ha];return o.index=r,o.data=i,o})),i)}var e=Si,n=Ti,i=null;return t.polygons=function(e){return t(e).polygons()},t.links=function(e){return t(e).links()},t.triangles=function(e){return t(e).triangles()},t.x=function(n){return arguments.length?(e="function"==typeof n?n:ka(+n),t):e},t.y=function(e){return arguments.length?(n="function"==typeof e?e:ka(+e),t):n},t.extent=function(e){return arguments.length?(i=null==e?null:[[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]],t):i&&[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},t.size=function(e){return arguments.length?(i=null==e?null:[[0,0],[+e[0],+e[1]]],t):i&&[i[1][0]-i[0][0],i[1][1]-i[0][1]]},t}().x((function(t){return t.geometry.coordinates[0]})).y((function(t){return t.geometry.coordinates[1]})).extent([[n[0],n[1]],[n[2],n[3]]]).polygons(t.features).map($i))},t.ellipse=tr,t.centerMean=nr,t.centerMedian=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.counter||10;if(!b(n))throw new Error("counter must be a number");var i=e.weight,r=nr(t,{weight:e.weight}),o=u([]);return M(t,(function(t){o.features.push(ce(t,{weight:t.properties[i]}))})),o.properties={tolerance:e.tolerance,medianCandidates:[]},ir(r.geometry.coordinates,[0,0],o,n)},t.standardDeviationalEllipse=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.steps||64,i=e.weight,r=e.properties||{};if(!b(n))throw new Error("steps must be a number");if(!E(r))throw new Error("properties must be a number");var o=R(t).length,s=nr(t,{weight:i}),a=0,l=0,c=0;M(t,(function(t){var e=t.properties[i]||1,n=rr(V(t),V(s));a+=Math.pow(n.x,2)*e,l+=Math.pow(n.y,2)*e,c+=n.x*n.y*e}));var h=a-l,p=Math.sqrt(Math.pow(h,2)+4*Math.pow(c,2)),f=2*c,d=Math.atan((h+p)/f),g=180*d/Math.PI,y=0,m=0,_=0;M(t,(function(t){var e=t.properties[i]||1,n=rr(V(t),V(s));y+=Math.pow(n.x*Math.cos(d)-n.y*Math.sin(d),2)*e,m+=Math.pow(n.x*Math.sin(d)+n.y*Math.cos(d),2)*e,_+=e}));var v=Math.sqrt(2*y/_),x=Math.sqrt(2*m/_),C=tr(s,v,x,{units:"degrees",angle:g,steps:n,properties:r}),w=Lt(t,u([C])),I={meanCenterCoordinates:V(s),semiMajorAxis:v,semiMinorAxis:x,numberOfFeatures:o,angle:g,percentageWithinEllipse:100*R(w).length/o};return C.properties.standardDeviationalEllipse=I,C},t.difference=function(t,n){var i=K(t),r=K(n),o=t.properties||{};if(i=Or(i),r=Or(r),!i)return null;if(!r)return e(i,o);var s=new nc,a=s.read(i),l=s.read(r),u=of.difference(a,l);return u.isEmpty()?null:e((new ic).write(u),o)},t.buffer=function(t,e,n){var i=(n=n||{}).units,r=n.steps||64;if(!t)throw new Error("geojson is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof r)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");r=r||64,i=i||"kilometers";var o=[];switch(t.type){case"GeometryCollection":return A(t,(function(t){var n=uo(t,e,i,r);n&&o.push(n)})),u(o);case"FeatureCollection":return M(t,(function(t){var n=uo(t,e,i,r);n&&M(n,(function(t){t&&o.push(t)}))})),u(o)}return uo(t,e,i,r)},t.union=fo,t.intersect=go,t.dissolve=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.propertyName;W(t,"Polygon","dissolve");var i=Ft(t),r=i.features,o=[];r.forEach((function(t,e){t.properties.origIndexPosition=e}));var s=qe();for(var l in s.load(i),r){var u=r[l],c=!1;if(s.search(u).features.forEach((function(t){u=r[l];var e=t.properties.origIndexPosition;if(o.length>0&&0!==e)if(e>o[o.length-1])e-=o.length;else{var i=yo(e,o);0!==i&&(e-=i)}if(e!==+l){var h=r[e];h&&u&&(void 0!==n&&h.properties[n]!==u.properties[n]||Ci(u,h)&&function(t,e){return Xe(a(R(t)),a(R(e))).features.length>0}(u,h)&&(r[l]=fo(u,h),o.push(t.properties.origIndexPosition),o.sort((function(t,e){return t-e})),s.remove(t),r.splice(e,1),u.properties.origIndexPosition=l,s.remove(u,(function(t,e){return t.properties.origIndexPosition===e.properties.origIndexPosition})),c=!0))}})),c){if(!u)continue;u.properties.origIndexPosition=l,s.insert(u),l--}}return r.forEach((function(t){delete t.properties.origIndexPosition,delete t.bbox})),i},t.hexGrid=mo,t.mask=function(t,e){var n=function(t){return o(t&&t.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]])}(e),i=function(t){var e=[],n=[];return F(t,(function(t){var i=t.geometry.coordinates,r=i[0],s=i.slice(1);e.push(o([r])),s.forEach((function(t){n.push(o([t]))}))})),[u(e),u(n)]}(t),r=i[0],s=i[1];return function(t,e,n){var i=[];return i.push(t.geometry.coordinates[0]),F(e,(function(t){i.push(t.geometry.coordinates[0])})),F(n,(function(t){i.push(t.geometry.coordinates[0])})),o(i)}(n,r=_o(r),s=_o(s))},t.squareGrid=xo,t.triangleGrid=Co,t.interpolate=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var i=n.gridType,r=n.property,o=n.weight;if(!t)throw new Error("points is required");if(W(t,"Point","input must contain Points"),!e)throw new Error("cellSize is required");if(void 0!==o&&"number"!=typeof o)throw new Error("weight must be a number");r=r||"elevation",i=i||"square",o=o||1;var s,a=U(t);switch(i){case"point":case"points":s=vn(a,e,n);break;case"square":case"squares":s=xo(a,e,n);break;case"hex":case"hexes":s=mo(a,e,n);break;case"triangle":case"triangles":s=Co(a,e,n);break;default:throw new Error("invalid gridType")}var l=[];return M(s,(function(e){var s=0,a=0;M(t,(function(t){var l,u=Dt("point"===i?e:ce(e),t,n);if(void 0!==r&&(l=t.properties[r]),void 0===l&&(l=t.geometry.coordinates[2]),void 0===l)throw new Error("zValue is missing");0===u&&(s=l);var c=1/Math.pow(u,o);a+=c,s+=c*l}));var u=Ft(e);u.properties[r]=s/a,l.push(u)})),u(l)},t.pointOnSurface=an,t.polygonToLineString=Ln,t.lineStringToPolygon=On,t.inside=St,t.within=Lt,t.bezier=ne,t.nearest=Se,t.pointOnLine=Ke,t.lineDistance=fn,t.radians2degrees=v,t.degrees2radians=x,t.distanceToDegrees=m,t.distanceToRadians=y,t.radiansToDistance=g,t.bearingToAngle=_,t.convertDistance=C,t.toMercator=$e,t.toWgs84=tn,t.randomPosition=or,t.randomPoint=sr,t.randomPolygon=ar,t.randomLineString=lr,t.getCluster=cr,t.clusterEach=hr,t.clusterReduce=pr,t.createBins=fr,t.applyFilter=dr,t.propertiesContainsFilter=gr,t.filterProperties=yr,t.earthRadius=wo,t.factors=bo,t.unitsFactors=Eo,t.areaFactors=Io,t.feature=e,t.geometry=n,t.point=i,t.points=r,t.polygon=o,t.polygons=s,t.lineString=a,t.lineStrings=l,t.featureCollection=u,t.multiLineString=c,t.multiPoint=h,t.multiPolygon=p,t.geometryCollection=f,t.round=d,t.radiansToLength=g,t.lengthToRadians=y,t.lengthToDegrees=m,t.bearingToAzimuth=_,t.radiansToDegrees=v,t.degreesToRadians=x,t.convertLength=C,t.convertArea=w,t.isNumber=b,t.isObject=E,t.validateBBox=I,t.validateId=P,t.getCoord=q,t.getCoords=V,t.containsNumber=H,t.geojsonType=Y,t.featureOf=X,t.collectionOf=W,t.getGeom=K,t.getGeomType=Z,t.getType=J,t.coordEach=N,t.coordReduce=S,t.propEach=T,t.propReduce=L,t.featureEach=M,t.featureReduce=O,t.coordAll=R,t.geomEach=A,t.geomReduce=D,t.flattenEach=F,t.flattenReduce=k,t.segmentEach=B,t.segmentReduce=G,t.lineEach=j,t.lineReduce=z,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){t.exports={default:n(168),__esModule:!0}},function(t,e){var n=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},function(t,e,n){"use strict";e.__esModule=!0;var i=s(n(141)),r=s(n(143)),o="function"==typeof r.default&&"symbol"==typeof i.default?function(t){return typeof t}:function(t){return t&&"function"==typeof r.default&&t.constructor===r.default&&t!==r.default.prototype?"symbol":typeof t};function s(t){return t&&t.__esModule?t:{default:t}}e.default="function"==typeof r.default&&"symbol"===o(i.default)?function(t){return void 0===t?"undefined":o(t)}:function(t){return t&&"function"==typeof r.default&&t.constructor===r.default&&t!==r.default.prototype?"symbol":void 0===t?"undefined":o(t)}},function(t,e,n){var i=n(12),r=n(9),o=n(32),s=n(27),a=n(24),l=function(t,e,n){var u,c,h,p=t&l.F,f=t&l.G,d=t&l.S,g=t&l.P,y=t&l.B,m=t&l.W,_=f?r:r[e]||(r[e]={}),v=_.prototype,x=f?i:d?i[e]:(i[e]||{}).prototype;for(u in f&&(n=e),n)(c=!p&&x&&void 0!==x[u])&&a(_,u)||(h=c?x[u]:n[u],_[u]=f&&"function"!=typeof x[u]?n[u]:y&&c?o(h,i):m&&x[u]==h?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(h):g&&"function"==typeof h?o(Function.call,h):h,g&&((_.virtual||(_.virtual={}))[u]=h,t&l.R&&v&&!v[u]&&s(v,u,h)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){!function(t){"use strict";function e(){}function n(t){this.message=t||""}function i(t){this.message=t||""}function r(t){this.message=t||""}function o(){}function s(t){return null===t?At:t.color}function a(t){return null===t?null:t.parent}function l(t,e){null!==t&&(t.color=e)}function u(t){return null===t?null:t.left}function c(t){return null===t?null:t.right}function h(){this.root_=null,this.size_=0}function p(){}function f(){this.array_=[],arguments[0]instanceof xt&&this.addAll(arguments[0])}function d(){}function g(t){this.message=t||""}function y(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,i=1 in arguments&&parseInt(Number(arguments[1]),10)||0;i=i<0?Math.max(n+i,0):Math.min(i,n);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(r=r<0?Math.max(n+arguments[2],0):Math.min(r,n);i<r;)e[i]=t,++i;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var m=function(){};m.prototype.interfaces_=function(){return[]},m.prototype.getClass=function(){return m},m.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var _=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),v=function(){},x={MAX_VALUE:{configurable:!0}};v.isNaN=function(t){return Number.isNaN(t)},v.doubleToLongBits=function(t){return t},v.longBitsToDouble=function(t){return t},v.isInfinite=function(t){return!Number.isFinite(t)},x.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(v,x);var C=function(){},w=function(){},b=function(){},E=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},I={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};E.prototype.setOrdinate=function(t,e){switch(t){case E.X:this.x=e;break;case E.Y:this.y=e;break;case E.Z:this.z=e;break;default:throw new _("Invalid ordinate index: "+t)}},E.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!m.equalsWithTolerance(this.x,e.x,n)&&!!m.equalsWithTolerance(this.y,e.y,n)}},E.prototype.getOrdinate=function(t){switch(t){case E.X:return this.x;case E.Y:return this.y;case E.Z:return this.z}throw new _("Invalid ordinate index: "+t)},E.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||v.isNaN(this.z))&&v.isNaN(t.z)},E.prototype.equals=function(t){return t instanceof E&&this.equals2D(t)},E.prototype.equalInZ=function(t,e){return m.equalsWithTolerance(this.z,t.z,e)},E.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},E.prototype.clone=function(){},E.prototype.copy=function(){return new E(this)},E.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},E.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},E.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},E.prototype.hashCode=function(){var t=17;return 37*(t=37*t+E.hashCode(this.x))+E.hashCode(this.y)},E.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},E.prototype.interfaces_=function(){return[C,w,e]},E.prototype.getClass=function(){return E},E.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=v.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},I.DimensionalComparator.get=function(){return P},I.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},I.NULL_ORDINATE.get=function(){return v.NaN},I.X.get=function(){return 0},I.Y.get=function(){return 1},I.Z.get=function(){return 2},Object.defineProperties(E,I);var P=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new _("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};P.prototype.compare=function(t,e){var n=t,i=e,r=P.compare(n.x,i.x);if(0!==r)return r;var o=P.compare(n.y,i.y);return 0!==o?o:this._dimensionsToTest<=2?0:P.compare(n.z,i.z)},P.prototype.interfaces_=function(){return[b]},P.prototype.getClass=function(){return P},P.compare=function(t,e){return t<e?-1:t>e?1:v.isNaN(t)?v.isNaN(e)?0:-1:v.isNaN(e)?1:0};var N=function(){};N.prototype.create=function(){},N.prototype.interfaces_=function(){return[]},N.prototype.getClass=function(){return N};var S=function(){},T={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};S.prototype.interfaces_=function(){return[]},S.prototype.getClass=function(){return S},S.toLocationSymbol=function(t){switch(t){case S.EXTERIOR:return"e";case S.BOUNDARY:return"b";case S.INTERIOR:return"i";case S.NONE:return"-"}throw new _("Unknown location value: "+t)},T.INTERIOR.get=function(){return 0},T.BOUNDARY.get=function(){return 1},T.EXTERIOR.get=function(){return 2},T.NONE.get=function(){return-1},Object.defineProperties(S,T);var L=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},M=function(){},O={LOG_10:{configurable:!0}};M.prototype.interfaces_=function(){return[]},M.prototype.getClass=function(){return M},M.log10=function(t){var e=Math.log(t);return v.isInfinite(e)||v.isNaN(e)?e:e/M.LOG_10},M.min=function(t,e,n,i){var r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r},M.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],o=arguments[2];return i<r?r:i>o?o:i}},M.wrap=function(t,e){return t<0?e- -t%e:t%e},M.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=t;return e>i&&(i=e),n>i&&(i=n),i}if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],l=r;return o>l&&(l=o),s>l&&(l=s),a>l&&(l=a),l}},M.average=function(t,e){return(t+e)/2},O.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(M,O);var R=function(t){this.str=t};R.prototype.append=function(t){this.str+=t},R.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},R.prototype.toString=function(t){return this.str};var A=function(t){this.value=t};A.prototype.intValue=function(){return this.value},A.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},A.isNaN=function(t){return Number.isNaN(t)};var D=function(){};D.isWhitespace=function(t){return t<=32&&t>=0||127===t},D.toUpperCase=function(t){return t.toUpperCase()};var F=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else if("string"==typeof arguments[0]){var i=arguments[0];t.call(this,t.parse(i))}}else if(2===arguments.length){var r=arguments[0],o=arguments[1];this.init(r,o)}},k={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};F.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},F.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),i=F.magnitude(n._hi),r=F.TEN.pow(i);(n=n.divide(r)).gt(F.TEN)?(n=n.divide(F.TEN),i+=1):n.lt(F.ONE)&&(n=n.multiply(F.TEN),i-=1);for(var o=i+1,s=new R,a=F.MAX_PRINT_DIGITS-1,l=0;l<=a;l++){t&&l===o&&s.append(".");var u=Math.trunc(n._hi);if(u<0)break;var c=!1,h=0;u>9?(c=!0,h="9"):h="0"+u,s.append(h),n=n.subtract(F.valueOf(u)).multiply(F.TEN),c&&n.selfAdd(F.TEN);var p=!0,f=F.magnitude(n._hi);if(f<0&&Math.abs(f)>=a-l&&(p=!1),!p)break}return e[0]=i,s.toString()},F.prototype.sqr=function(){return this.multiply(this)},F.prototype.doubleValue=function(){return this._hi+this._lo},F.prototype.subtract=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},F.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},F.prototype.isZero=function(){return 0===this._hi&&0===this._lo},F.prototype.selfSubtract=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},F.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},F.prototype.min=function(t){return this.le(t)?this:t},F.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=null,o=null,s=null,a=null,l=null,u=null,c=null,h=null;return l=this._hi/n,h=(r=(u=F.SPLIT*l)-(r=u-l))*(s=(h=F.SPLIT*n)-(s=h-n))-(c=l*n)+r*(a=n-s)+(o=l-r)*s+o*a,h=l+(u=(this._hi-c-h+this._lo-l*i)/n),this._hi=h,this._lo=l-h+u,this}},F.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},F.prototype.divide=function(){if(arguments[0]instanceof F){var t=arguments[0],e=null,n=null,i=null,r=null,o=null,s=null,a=null,l=null;return n=(o=this._hi/t._hi)-(e=(s=F.SPLIT*o)-(e=s-o)),l=e*(i=(l=F.SPLIT*t._hi)-(i=l-t._hi))-(a=o*t._hi)+e*(r=t._hi-i)+n*i+n*r,s=(this._hi-a-l+this._lo-o*t._lo)/t._hi,new F(l=o+s,o-l+s)}if("number"==typeof arguments[0]){var u=arguments[0];return v.isNaN(u)?F.createNaN():F.copy(this).selfDivide(u,0)}},F.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},F.prototype.pow=function(t){if(0===t)return F.valueOf(1);var e=new F(this),n=F.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),(i/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},F.prototype.ceil=function(){if(this.isNaN())return F.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new F(t,e)},F.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},F.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},F.prototype.setValue=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},F.prototype.max=function(t){return this.ge(t)?this:t},F.prototype.sqrt=function(){if(this.isZero())return F.valueOf(0);if(this.isNegative())return F.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=F.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)},F.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,i=null,r=null,o=null,s=null,a=null;return o=(r=this._hi+e)-(s=r-this._hi),i=(a=(o=e-s+(this._hi-o))+this._lo)+(r-(n=r+a)),this._hi=n+i,this._lo=i+(n-this._hi),this}}else if(2===arguments.length){var l=arguments[0],u=arguments[1],c=null,h=null,p=null,f=null,d=null,g=null,y=null;f=this._hi+l,h=this._lo+u,d=f-(g=f-this._hi),p=h-(y=h-this._lo);var m=(c=f+(g=(d=l-g+(this._hi-d))+h))+(g=(p=u-y+(this._lo-p))+(g+(f-c))),_=g+(c-m);return this._hi=m,this._lo=_,this}},F.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=null,o=null,s=null,a=null,l=null,u=null;r=(l=F.SPLIT*this._hi)-this._hi,u=F.SPLIT*n,r=l-r,o=this._hi-r,s=u-n;var c=(l=this._hi*n)+(u=r*(s=u-s)-l+r*(a=n-s)+o*s+o*a+(this._hi*i+this._lo*n)),h=u+(r=l-c);return this._hi=c,this._lo=h,this}},F.prototype.selfSqr=function(){return this.selfMultiply(this)},F.prototype.floor=function(){if(this.isNaN())return F.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new F(t,e)},F.prototype.negate=function(){return this.isNaN()?this:new F(-this._hi,-this._lo)},F.prototype.clone=function(){},F.prototype.multiply=function(){if(arguments[0]instanceof F){var t=arguments[0];return t.isNaN()?F.createNaN():F.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return v.isNaN(e)?F.createNaN():F.copy(this).selfMultiply(e,0)}},F.prototype.isNaN=function(){return v.isNaN(this._hi)},F.prototype.intValue=function(){return Math.trunc(this._hi)},F.prototype.toString=function(){var t=F.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},F.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+F.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var o=i-n.length;r=n+F.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},F.prototype.reciprocal=function(){var t,e,n,i,r=null,o=null,s=null,a=null;t=(n=1/this._hi)-(r=(s=F.SPLIT*n)-(r=s-n)),o=(a=F.SPLIT*this._hi)-this._hi;var l=n+(s=(1-(i=n*this._hi)-(a=r*(o=a-o)-i+r*(e=this._hi-o)+t*o+t*e)-n*this._lo)/this._hi);return new F(l,n-l+s)},F.prototype.toSciNotation=function(){if(this.isZero())return F.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=F.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var r="";n.length>1&&(r=n.substring(1));var o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i},F.prototype.abs=function(){return this.isNaN()?F.NaN:this.isNegative()?this.negate():new F(this)},F.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},F.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},F.prototype.add=function(){if(arguments[0]instanceof F){var t=arguments[0];return F.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return F.copy(this).selfAdd(e)}},F.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof F){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._hi=n,this._lo=i}},F.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},F.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},F.prototype.trunc=function(){return this.isNaN()?F.NaN:this.isPositive()?this.floor():this.ceil()},F.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},F.prototype.interfaces_=function(){return[e,C,w]},F.prototype.getClass=function(){return F},F.sqr=function(t){return F.valueOf(t).selfMultiply(t)},F.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return F.parse(t)}if("number"==typeof arguments[0]){var e=arguments[0];return new F(e)}},F.sqrt=function(t){return F.valueOf(t).sqrt()},F.parse=function(t){for(var e=0,n=t.length;D.isWhitespace(t.charAt(e));)e++;var i=!1;if(e<n){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(i=!0))}for(var o=new F,s=0,a=0,l=0;!(e>=n);){var u=t.charAt(e);if(e++,D.isDigit(u)){var c=u-"0";o.selfMultiply(F.TEN),o.selfAdd(c),s++}else{if("."!==u){if("e"===u||"E"===u){var h=t.substring(e);try{l=A.parseInt(h)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+h+" in string "+t):e}break}throw new Error("Unexpected character '"+u+"' at position "+e+" in string "+t)}a=s}}var p=o,f=s-a-l;if(0===f)p=o;else if(f>0){var d=F.TEN.pow(f);p=o.divide(d)}else if(f<0){var g=F.TEN.pow(-f);p=o.multiply(g)}return i?p.negate():p},F.createNaN=function(){return new F(v.NaN,v.NaN)},F.copy=function(t){return new F(t)},F.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i},F.stringOfChar=function(t,e){for(var n=new R,i=0;i<e;i++)n.append(t);return n.toString()},k.PI.get=function(){return new F(3.141592653589793,12246467991473532e-32)},k.TWO_PI.get=function(){return new F(6.283185307179586,24492935982947064e-32)},k.PI_2.get=function(){return new F(1.5707963267948966,6123233995736766e-32)},k.E.get=function(){return new F(2.718281828459045,14456468917292502e-32)},k.NaN.get=function(){return new F(v.NaN,v.NaN)},k.EPS.get=function(){return 123259516440783e-46},k.SPLIT.get=function(){return 134217729},k.MAX_PRINT_DIGITS.get=function(){return 32},k.TEN.get=function(){return F.valueOf(10)},k.ONE.get=function(){return F.valueOf(1)},k.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},k.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(F,k);var B=function(){},G={DP_SAFE_EPSILON:{configurable:!0}};B.prototype.interfaces_=function(){return[]},B.prototype.getClass=function(){return B},B.orientationIndex=function(t,e,n){var i=B.orientationIndexFilter(t,e,n);if(i<=1)return i;var r=F.valueOf(e.x).selfAdd(-t.x),o=F.valueOf(e.y).selfAdd(-t.y),s=F.valueOf(n.x).selfAdd(-e.x),a=F.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},B.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},B.intersection=function(t,e,n,i){var r=F.valueOf(i.y).selfSubtract(n.y).selfMultiply(F.valueOf(e.x).selfSubtract(t.x)),o=F.valueOf(i.x).selfSubtract(n.x).selfMultiply(F.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=F.valueOf(i.x).selfSubtract(n.x).selfMultiply(F.valueOf(t.y).selfSubtract(n.y)),l=F.valueOf(i.y).selfSubtract(n.y).selfMultiply(F.valueOf(t.x).selfSubtract(n.x)),u=a.subtract(l).selfDivide(s).doubleValue(),c=F.valueOf(t.x).selfAdd(F.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),h=F.valueOf(e.x).selfSubtract(t.x).selfMultiply(F.valueOf(t.y).selfSubtract(n.y)),p=F.valueOf(e.y).selfSubtract(t.y).selfMultiply(F.valueOf(t.x).selfSubtract(n.x)),f=h.subtract(p).selfDivide(s).doubleValue(),d=F.valueOf(n.y).selfAdd(F.valueOf(i.y).selfSubtract(n.y).selfMultiply(f)).doubleValue();return new E(c,d)},B.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=r-o;if(r>0){if(o<=0)return B.signum(s);i=r+o}else{if(!(r<0))return B.signum(s);if(o>=0)return B.signum(s);i=-r-o}var a=B.DP_SAFE_EPSILON*i;return s>=a||-s>=a?B.signum(s):2},B.signum=function(t){return t>0?1:t<0?-1:0},G.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(B,G);var j=function(){},z={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};z.X.get=function(){return 0},z.Y.get=function(){return 1},z.Z.get=function(){return 2},z.M.get=function(){return 3},j.prototype.setOrdinate=function(t,e,n){},j.prototype.size=function(){},j.prototype.getOrdinate=function(t,e){},j.prototype.getCoordinate=function(){},j.prototype.getCoordinateCopy=function(t){},j.prototype.getDimension=function(){},j.prototype.getX=function(t){},j.prototype.clone=function(){},j.prototype.expandEnvelope=function(t){},j.prototype.copy=function(){},j.prototype.getY=function(t){},j.prototype.toCoordinateArray=function(){},j.prototype.interfaces_=function(){return[w]},j.prototype.getClass=function(){return j},Object.defineProperties(j,z);var U=function(){},q=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(U),V=function(){};V.arraycopy=function(t,e,n,i,r){for(var o=0,s=e;s<e+r;s++)n[i+o]=t[s],o++},V.getProperty=function(t){return{"line.separator":"\n"}[t]};var H=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.x=n,this.y=i,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],o=arguments[1];this.x=r.y*o.w-o.y*r.w,this.y=o.x*r.w-r.x*o.w,this.w=r.x*o.y-o.x*r.y}else if(arguments[0]instanceof E&&arguments[1]instanceof E){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2];this.x=l,this.y=u,this.w=c}else if(4===arguments.length){var h=arguments[0],p=arguments[1],f=arguments[2],d=arguments[3],g=h.y-p.y,y=p.x-h.x,m=h.x*p.y-p.x*h.y,_=f.y-d.y,v=d.x-f.x,x=f.x*d.y-d.x*f.y;this.x=y*x-v*m,this.y=_*m-g*x,this.w=g*v-_*y}};H.prototype.getY=function(){var t=this.y/this.w;if(v.isNaN(t)||v.isInfinite(t))throw new q;return t},H.prototype.getX=function(){var t=this.x/this.w;if(v.isNaN(t)||v.isInfinite(t))throw new q;return t},H.prototype.getCoordinate=function(){var t=new E;return t.x=this.getX(),t.y=this.getY(),t},H.prototype.interfaces_=function(){return[]},H.prototype.getClass=function(){return H},H.intersection=function(t,e,n,i){var r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-i.y,l=i.x-n.x,u=n.x*i.y-i.x*n.y,c=r*l-a*o,h=(o*u-l*s)/c,p=(a*s-r*u)/c;if(v.isNaN(h)||v.isInfinite(h)||v.isNaN(p)||v.isInfinite(p))throw new q;return new E(h,p)};var Y=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof E){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],l=arguments[3];this.init(o,s,a,l)}},X={serialVersionUID:{configurable:!0}};Y.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Y.prototype.equals=function(t){if(!(t instanceof Y))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},Y.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new Y;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new Y(e,i,n,r)},Y.prototype.isNull=function(){return this._maxx<this._minx},Y.prototype.getMaxX=function(){return this._maxx},Y.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof Y){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&i>=this._miny&&i<=this._maxy}},Y.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof Y){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof E){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||i>this._maxy||i<this._miny)}},Y.prototype.getMinY=function(){return this._miny},Y.prototype.getMinX=function(){return this._minx},Y.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof Y){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=i,this._maxy=i):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}},Y.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},Y.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Y.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},Y.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},Y.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Y.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Y.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Y.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},Y.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Y.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof Y){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof E){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},Y.prototype.centre=function(){return this.isNull()?null:new E((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Y.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Y){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];r<o?(this._minx=r,this._maxx=o):(this._minx=o,this._maxx=r),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},Y.prototype.getMaxY=function(){return this._maxy},Y.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},Y.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+E.hashCode(this._minx))+E.hashCode(this._maxx))+E.hashCode(this._miny))+E.hashCode(this._maxy)},Y.prototype.interfaces_=function(){return[C,e]},Y.prototype.getClass=function(){return Y},Y.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),l=Math.max(o.x,s.x),u=Math.min(i.x,r.x),c=Math.max(i.x,r.x);return!(u>l||c<a||(a=Math.min(o.y,s.y),l=Math.max(o.y,s.y),u=Math.min(i.y,r.y),c=Math.max(i.y,r.y),u>l||c<a))}},X.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(Y,X);var W={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},K=function(t){this.geometryFactory=t||new me};K.prototype.read=function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=W.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=W.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],J[n]&&(e=J[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},K.prototype.write=function(t){return this.extractGeometry(t)},K.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Z[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+Z[e].apply(this,[t])+")"};var Z={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Z.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Z.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(Z.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(Z.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Z.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Z.linestring.apply(this,[t._shell])+")");for(var n=0,i=t._holes.length;n<i;++n)e.push("("+Z.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Z.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},J={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(W.spaces);return this.geometryFactory.createPoint(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(W.trimParens,"$1"),i.push(J.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(W.spaces),i.push(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(W.spaces),i.push(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(W.parenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(W.trimParens,"$1"),i.push(J.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,o=t.trim().split(W.parenComma),s=[],a=0,l=o.length;a<l;++a)e=o[a].replace(W.trimParens,"$1"),n=J.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n._points),0===a?r=i:s.push(i);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(W.doubleParenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(W.trimParens,"$1"),i.push(J.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;i<r;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}},Q=function(t){this.parser=new K(t)};Q.prototype.write=function(t){return this.parser.write(t)},Q.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var $=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),tt=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}($),et=function(){};et.prototype.interfaces_=function(){return[]},et.prototype.getClass=function(){return et},et.shouldNeverReachHere=function(){if(0===arguments.length)et.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new tt("Should never reach here"+(null!==t?": "+t:""))}},et.isTrue=function(){var t;if(1===arguments.length)et.isTrue(arguments[0],null);else if(2===arguments.length&&(t=arguments[1],!arguments[0]))throw null===t?new tt:new tt(t)},et.equals=function(){var t,e,n;if(2===arguments.length)et.equals(t=arguments[0],e=arguments[1],null);else if(3===arguments.length&&(t=arguments[0],n=arguments[2],!(e=arguments[1]).equals(t)))throw new tt("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var nt=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new E,this._intPt[1]=new E,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},it={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};nt.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},nt.prototype.getTopologySummary=function(){var t=new R;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},nt.prototype.computeIntersection=function(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)},nt.prototype.getIntersectionNum=function(){return this._result},nt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},nt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},nt.prototype.setPrecisionModel=function(t){this._precisionModel=t},nt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},nt.prototype.getIntersection=function(t){return this._intPt[t]},nt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},nt.prototype.hasIntersection=function(){return this._result!==nt.NO_INTERSECTION},nt.prototype.getEdgeDistance=function(t,e){return nt.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},nt.prototype.isCollinear=function(){return this._result===nt.COLLINEAR_INTERSECTION},nt.prototype.toString=function(){return Q.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Q.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},nt.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},nt.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},nt.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},nt.prototype.interfaces_=function(){return[]},nt.prototype.getClass=function(){return nt},nt.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=i>r?i:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=i>r?s:a)||t.equals(e)||(o=Math.max(s,a))}return et.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},nt.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);return et.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},it.DONT_INTERSECT.get=function(){return 0},it.DO_INTERSECT.get=function(){return 1},it.COLLINEAR.get=function(){return 2},it.NO_INTERSECTION.get=function(){return 0},it.POINT_INTERSECTION.get=function(){return 1},it.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(nt,it);var rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new Y(this._inputLines[0][0],this._inputLines[0][1]),n=new Y(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],n=arguments[1],i=arguments[2];if(this._isProper=!1,Y.intersects(n,i,e)&&0===at.orientationIndex(n,i,e)&&0===at.orientationIndex(i,n,e))return this._isProper=!0,(e.equals(n)||e.equals(i))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},e.prototype.safeHCoordinateIntersection=function(t,n,i,r){var o=null;try{o=H.intersection(t,n,i,r)}catch(s){if(!(s instanceof q))throw s;o=e.nearestEndpoint(t,n,i,r)}return o},e.prototype.intersection=function(t,n,i,r){var o=this.intersectionWithNormalization(t,n,i,r);return this.isInSegmentEnvelopes(o)||(o=new E(e.nearestEndpoint(t,n,i,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,n,i){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(n)<o&&(r=n,o=Math.abs(n)),Math.abs(i)<o&&(r=i),r},e.prototype.checkDD=function(t,e,n,i,r){var o=B.intersection(t,e,n,i),s=this.isInSegmentEnvelopes(o);V.out.println("DD in env = "+s+"  --------------------- "+o),r.distance(o)>1e-4&&V.out.println("Distance = "+r.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,n,i){var r=new E(t),o=new E(e),s=new E(n),a=new E(i),l=new E;this.normalizeToEnvCentre(r,o,s,a,l);var u=this.safeHCoordinateIntersection(r,o,s,a);return u.x+=l.x,u.y+=l.y,u},e.prototype.computeCollinearIntersection=function(e,n,i,r){var o=Y.intersects(e,n,i),s=Y.intersects(e,n,r),a=Y.intersects(i,r,e),l=Y.intersects(i,r,n);return o&&s?(this._intPt[0]=i,this._intPt[1]=r,t.COLLINEAR_INTERSECTION):a&&l?(this._intPt[0]=e,this._intPt[1]=n,t.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||s||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&l?(this._intPt[0]=i,this._intPt[1]=n,!i.equals(n)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||o||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&l?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||o||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,n,i,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,u=n.x<i.x?n.x:i.x,c=n.y<i.y?n.y:i.y,h=n.x>i.x?n.x:i.x,p=n.y>i.y?n.y:i.y,f=((o>u?o:u)+(a<h?a:h))/2,d=((s>c?s:c)+(l<p?l:p))/2;r.x=f,r.y=d,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},e.prototype.computeIntersect=function(e,n,i,r){if(this._isProper=!1,!Y.intersects(e,n,i,r))return t.NO_INTERSECTION;var o=at.orientationIndex(e,n,i),s=at.orientationIndex(e,n,r);if(o>0&&s>0||o<0&&s<0)return t.NO_INTERSECTION;var a=at.orientationIndex(i,r,e),l=at.orientationIndex(i,r,n);return a>0&&l>0||a<0&&l<0?t.NO_INTERSECTION:0===o&&0===s&&0===a&&0===l?this.computeCollinearIntersection(e,n,i,r):(0===o||0===s||0===a||0===l?(this._isProper=!1,e.equals2D(i)||e.equals2D(r)?this._intPt[0]=e:n.equals2D(i)||n.equals2D(r)?this._intPt[0]=n:0===o?this._intPt[0]=new E(i):0===s?this._intPt[0]=new E(r):0===a?this._intPt[0]=new E(e):0===l&&(this._intPt[0]=new E(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,i,r)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,n,i){var r=t,o=at.distancePointLine(t,n,i),s=at.distancePointLine(e,n,i);return s<o&&(o=s,r=e),(s=at.distancePointLine(n,t,e))<o&&(o=s,r=n),(s=at.distancePointLine(i,t,e))<o&&(o=s,r=i),r},e}(nt),ot=function(){};ot.prototype.interfaces_=function(){return[]},ot.prototype.getClass=function(){return ot},ot.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return ot.signOfDet2x2(i,r,o,s)},ot.signOfDet2x2=function(t,e,n,i){var r=null,o=null,s=null;if(r=1,0===t||0===i)return 0===e||0===n?0:e>0?n>0?-r:r:n>0?r:-r;if(0===e||0===n)return i>0?t>0?r:-r:t>0?-r:r;if(e>0?i>0?e<=i||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):e<=-i?(r=-r,n=-n,i=-i):(o=t,t=-n,n=o,o=e,e=-i,i=o):i>0?-e<=i?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):e>=i?(t=-t,e=-e,n=-n,i=-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,i=o),t>0){if(!(n>0))return r;if(!(t<=n))return r}else{if(n>0)return-r;if(!(t>=n))return-r;r=-r,t=-t,n=-n}for(;;){if((i-=(s=Math.floor(n/t))*e)<0)return-r;if(i>e)return r;if(t>(n-=s*t)+n){if(e<i+i)return r}else{if(e>i+i)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if((e-=(s=Math.floor(t/n))*i)<0)return r;if(e>i)return-r;if(n>(t-=s*n)+t){if(i<e+e)return-r}else{if(i>e+e)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var st=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};st.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,l=ot.signOfDet2x2(r,o,s,a);if(0===l)return this._isPointOnSegment=!0,null;a<o&&(l=-l),l>0&&this._crossingCount++}},st.prototype.isPointInPolygon=function(){return this.getLocation()!==S.EXTERIOR},st.prototype.getLocation=function(){return this._isPointOnSegment?S.BOUNDARY:this._crossingCount%2==1?S.INTERIOR:S.EXTERIOR},st.prototype.isOnSegment=function(){return this._isPointOnSegment},st.prototype.interfaces_=function(){return[]},st.prototype.getClass=function(){return st},st.locatePointInRing=function(){if(arguments[0]instanceof E&&L(arguments[1],j)){for(var t=arguments[0],e=arguments[1],n=new st(t),i=new E,r=new E,o=1;o<e.size();o++)if(e.getCoordinate(o,i),e.getCoordinate(o-1,r),n.countSegment(i,r),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof E&&arguments[1]instanceof Array){for(var s=arguments[0],a=arguments[1],l=new st(s),u=1;u<a.length;u++){var c=a[u],h=a[u-1];if(l.countSegment(c,h),l.isOnSegment())return l.getLocation()}return l.getLocation()}};var at=function(){},lt={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};at.prototype.interfaces_=function(){return[]},at.prototype.getClass=function(){return at},at.orientationIndex=function(t,e,n){return B.orientationIndex(t,e,n)},at.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,o=t[i+1].y;e+=r*(t[i-1].y-o)}return e/2}if(L(arguments[0],j)){var s=arguments[0],a=s.size();if(a<3)return 0;var l=new E,u=new E,c=new E;s.getCoordinate(0,u),s.getCoordinate(1,c);var h=u.x;c.x-=h;for(var p=0,f=1;f<a-1;f++)l.y=u.y,u.x=c.x,u.y=c.y,s.getCoordinate(f+1,c),c.x-=h,p+=u.x*(l.y-c.y);return p/2}},at.distanceLineLine=function(t,e,n,i){if(t.equals(e))return at.distancePointLine(t,n,i);if(n.equals(i))return at.distancePointLine(i,t,e);var r=!1;if(Y.intersects(t,e,n,i)){var o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===o)r=!0;else{var s=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,l=s/o;(l<0||l>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?M.min(at.distancePointLine(t,n,i),at.distancePointLine(e,n,i),at.distancePointLine(n,t,e),at.distancePointLine(i,t,e)):0},at.isPointInRing=function(t,e){return at.locatePointInRing(t,e)!==S.EXTERIOR},at.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new E;t.getCoordinate(0,i);for(var r=i.x,o=i.y,s=1;s<e;s++){t.getCoordinate(s,i);var a=i.x,l=i.y,u=a-r,c=l-o;n+=Math.sqrt(u*u+c*c),r=a,o=l}return n},at.isCCW=function(t){var e=t.length-1;if(e<3)throw new _("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,r=1;r<=e;r++){var o=t[r];o.y>n.y&&(n=o,i=r)}var s=i;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(n)&&s!==i);var a=i;do{a=(a+1)%e}while(t[a].equals2D(n)&&a!==i);var l=t[s],u=t[a];if(l.equals2D(n)||u.equals2D(n)||l.equals2D(u))return!1;var c=at.computeOrientation(l,n,u);return 0===c?l.x>u.x:c>0},at.locatePointInRing=function(t,e){return st.locatePointInRing(t,e)},at.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},at.computeOrientation=function(t,e,n){return at.orientationIndex(t,e,n)},at.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new _("Line array must contain at least one vertex");for(var n=t.distance(e[0]),i=0;i<e.length-1;i++){var r=at.distancePointLine(t,e[i],e[i+1]);r<n&&(n=r)}return n}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var l=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),u=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/l;if(u<=0)return o.distance(s);if(u>=1)return o.distance(a);var c=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/l;return Math.abs(c)*Math.sqrt(l)}},at.isOnLine=function(t,e){for(var n=new rt,i=1;i<e.length;i++){var r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1},lt.CLOCKWISE.get=function(){return-1},lt.RIGHT.get=function(){return at.CLOCKWISE},lt.COUNTERCLOCKWISE.get=function(){return 1},lt.LEFT.get=function(){return at.COUNTERCLOCKWISE},lt.COLLINEAR.get=function(){return 0},lt.STRAIGHT.get=function(){return at.COLLINEAR},Object.defineProperties(at,lt);var ut=function(){};ut.prototype.filter=function(t){},ut.prototype.interfaces_=function(){return[]},ut.prototype.getClass=function(){return ut};var ct=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},ht={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};ct.prototype.isGeometryCollection=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION},ct.prototype.getFactory=function(){return this._factory},ct.prototype.getGeometryN=function(t){return this},ct.prototype.getArea=function(){return 0},ct.prototype.isRectangle=function(){return!1},ct.prototype.equals=function(){if(arguments[0]instanceof ct){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof ct))return!1;var n=e;return this.equalsExact(n)}},ct.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},ct.prototype.geometryChanged=function(){this.apply(ct.geometryChangedFilter)},ct.prototype.geometryChangedAction=function(){this._envelope=null},ct.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},ct.prototype.getLength=function(){return 0},ct.prototype.getNumGeometries=function(){return 1},ct.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,i)}},ct.prototype.getUserData=function(){return this._userData},ct.prototype.getSRID=function(){return this._SRID},ct.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},ct.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION)throw new _("This method does not support GeometryCollection arguments")},ct.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},ct.prototype.norm=function(){var t=this.copy();return t.normalize(),t},ct.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},ct.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new Y(this._envelope)},ct.prototype.setSRID=function(t){this._SRID=t},ct.prototype.setUserData=function(t){this._userData=t},ct.prototype.compare=function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),o=i.next(),s=r.compareTo(o);if(0!==s)return s}return n.hasNext()?1:i.hasNext()?-1:0},ct.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},ct.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===ct.SORTINDEX_MULTIPOINT||this.getSortIndex()===ct.SORTINDEX_MULTILINESTRING||this.getSortIndex()===ct.SORTINDEX_MULTIPOLYGON},ct.prototype.interfaces_=function(){return[w,C,e]},ct.prototype.getClass=function(){return ct},ct.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},ct.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},ht.serialVersionUID.get=function(){return 0x799ea46522854c00},ht.SORTINDEX_POINT.get=function(){return 0},ht.SORTINDEX_MULTIPOINT.get=function(){return 1},ht.SORTINDEX_LINESTRING.get=function(){return 2},ht.SORTINDEX_LINEARRING.get=function(){return 3},ht.SORTINDEX_MULTILINESTRING.get=function(){return 4},ht.SORTINDEX_POLYGON.get=function(){return 5},ht.SORTINDEX_MULTIPOLYGON.get=function(){return 6},ht.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},ht.geometryChangedFilter.get=function(){return pt},Object.defineProperties(ct,ht);var pt=function(){};pt.interfaces_=function(){return[ut]},pt.filter=function(t){t.geometryChangedAction()};var ft=function(){};ft.prototype.filter=function(t){},ft.prototype.interfaces_=function(){return[]},ft.prototype.getClass=function(){return ft};var dt=function(){},gt={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};dt.prototype.isInBoundary=function(t){},dt.prototype.interfaces_=function(){return[]},dt.prototype.getClass=function(){return dt},gt.Mod2BoundaryNodeRule.get=function(){return yt},gt.EndPointBoundaryNodeRule.get=function(){return mt},gt.MultiValentEndPointBoundaryNodeRule.get=function(){return _t},gt.MonoValentEndPointBoundaryNodeRule.get=function(){return vt},gt.MOD2_BOUNDARY_RULE.get=function(){return new yt},gt.ENDPOINT_BOUNDARY_RULE.get=function(){return new mt},gt.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new _t},gt.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new vt},gt.OGC_SFS_BOUNDARY_RULE.get=function(){return dt.MOD2_BOUNDARY_RULE},Object.defineProperties(dt,gt);var yt=function(){};yt.prototype.isInBoundary=function(t){return t%2==1},yt.prototype.interfaces_=function(){return[dt]},yt.prototype.getClass=function(){return yt};var mt=function(){};mt.prototype.isInBoundary=function(t){return t>0},mt.prototype.interfaces_=function(){return[dt]},mt.prototype.getClass=function(){return mt};var _t=function(){};_t.prototype.isInBoundary=function(t){return t>1},_t.prototype.interfaces_=function(){return[dt]},_t.prototype.getClass=function(){return _t};var vt=function(){};vt.prototype.isInBoundary=function(t){return 1===t},vt.prototype.interfaces_=function(){return[dt]},vt.prototype.getClass=function(){return vt};var xt=function(){};xt.prototype.add=function(){},xt.prototype.addAll=function(){},xt.prototype.isEmpty=function(){},xt.prototype.iterator=function(){},xt.prototype.size=function(){},xt.prototype.toArray=function(){},xt.prototype.remove=function(){},(n.prototype=new Error).name="IndexOutOfBoundsException";var Ct=function(){};Ct.prototype.hasNext=function(){},Ct.prototype.next=function(){},Ct.prototype.remove=function(){};var wt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(xt);(i.prototype=new Error).name="NoSuchElementException";var bt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof xt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,xt]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new Et(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new n;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(wt),Et=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new i;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(Ct),It=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.ensureCapacity(n.length),this.add(n,i)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=!1,r=e.iterator();r.hasNext();)this.add(r.next(),n),i=!0;return i}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),n=0;n<this.size();n++)e.add(n,this.get(n).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],i=arguments[1];return this.add(n,i,!0),!0}if(arguments[0]instanceof E&&"boolean"==typeof arguments[1]){var r=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(r))return null;t.prototype.add.call(this,r)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1];return this.add(o,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var a=arguments[0],l=arguments[1];if(arguments[2])for(var u=0;u<a.length;u++)this.add(a[u],l);else for(var c=a.length-1;c>=0;c--)this.add(a[c],l);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof E){var h=arguments[0],p=arguments[1];if(!arguments[2]){var f=this.size();if(f>0){if(h>0&&this.get(h-1).equals2D(p))return null;if(h<f&&this.get(h).equals2D(p))return null}}t.prototype.add.call(this,h,p)}}else if(4===arguments.length){var d=arguments[0],g=arguments[1],y=arguments[2],m=arguments[3],_=1;y>m&&(_=-1);for(var v=y;v!==m;v+=_)this.add(d[v],g);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new E(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(bt),Pt=function(){},Nt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Nt.ForwardComparator.get=function(){return St},Nt.BidirectionalComparator.get=function(){return Tt},Nt.coordArrayType.get=function(){return new Array(0).fill(null)},Pt.prototype.interfaces_=function(){return[]},Pt.prototype.getClass=function(){return Pt},Pt.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},Pt.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(Pt.indexOf(i,e)<0)return i}return null},Pt.scroll=function(t,e){var n=Pt.indexOf(e,t);if(n<0)return null;var i=new Array(t.length).fill(null);V.arraycopy(t,n,i,0,t.length-n),V.arraycopy(t,0,i,t.length-n,n),V.arraycopy(i,0,t,0,t.length)},Pt.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var s=0;s<i.length;s++)if(0!==o.compare(i[s],r[s]))return!1;return!0}},Pt.intersection=function(t,e){for(var n=new It,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},Pt.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Pt.removeRepeatedPoints=function(t){return Pt.hasRepeatedPoints(t)?new It(t,!1).toCoordinateArray():t},Pt.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},Pt.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(i[r++]=t[o]);return i},Pt.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new E(t[n]);return e}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],l=0;l<a;l++)o[s+l]=new E(i[r+l])},Pt.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},Pt.envelope=function(t){for(var e=new Y,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Pt.toCoordinateArray=function(t){return t.toArray(Pt.coordArrayType)},Pt.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Pt.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Pt.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},Pt.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},Pt.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},Pt.extract=function(t,e,n){e=M.clamp(e,0,t.length);var i=(n=M.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var o=0,s=e;s<=n;s++)r[o++]=t[s];return r},Object.defineProperties(Pt,Nt);var St=function(){};St.prototype.compare=function(t,e){return Pt.compare(t,e)},St.prototype.interfaces_=function(){return[b]},St.prototype.getClass=function(){return St};var Tt=function(){};Tt.prototype.compare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=Pt.compare(n,i);return Pt.isEqualReversed(n,i)?0:r},Tt.prototype.OLDcompare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=Pt.increasingDirection(n),o=Pt.increasingDirection(i),s=r>0?0:n.length-1,a=o>0?0:n.length-1,l=0;l<n.length;l++){var u=n[s].compareTo(i[a]);if(0!==u)return u;s+=r,a+=o}return 0},Tt.prototype.interfaces_=function(){return[b]},Tt.prototype.getClass=function(){return Tt};var Lt=function(){};Lt.prototype.get=function(){},Lt.prototype.put=function(){},Lt.prototype.size=function(){},Lt.prototype.values=function(){},Lt.prototype.entrySet=function(){};var Mt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Lt);(r.prototype=new Error).name="OperationNotSupported",(o.prototype=new xt).contains=function(){};var Ot=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof xt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Rt(this)},e}(o),Rt=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new i;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new r},e}(Ct),At=0;(h.prototype=new Mt).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},h.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:At,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,(i=t.compareTo(r.key))<0)r=r.left;else{if(!(i>0)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:n,color:At,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},h.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(a(t)===u(a(a(t)))){var e=c(a(a(t)));1===s(e)?(l(a(t),At),l(e,At),l(a(a(t)),1),t=a(a(t))):(t===c(a(t))&&(t=a(t),this.rotateLeft(t)),l(a(t),At),l(a(a(t)),1),this.rotateRight(a(a(t))))}else{var n=u(a(a(t)));1===s(n)?(l(a(t),At),l(n,At),l(a(a(t)),1),t=a(a(t))):(t===u(a(t))&&(t=a(t),this.rotateRight(t)),l(a(t),At),l(a(a(t)),1),this.rotateLeft(a(a(t))))}this.root_.color=At},h.prototype.values=function(){var t=new bt,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=h.successor(e));)t.add(e.value);return t},h.prototype.entrySet=function(){var t=new Ot,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=h.successor(e));)t.add(e);return t},h.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},h.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},h.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},h.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,i=t;null!==n&&i===n.right;)i=n,n=n.parent;return n},h.prototype.size=function(){return this.size_};var Dt=function(){};Dt.prototype.interfaces_=function(){return[]},Dt.prototype.getClass=function(){return Dt},p.prototype=new o,(f.prototype=new p).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},f.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},f.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},f.prototype.remove=function(t){throw new r},f.prototype.size=function(){return this.array_.length},f.prototype.isEmpty=function(){return 0===this.array_.length},f.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},f.prototype.iterator=function(){return new Ft(this)};var Ft=function(t){this.treeSet_=t,this.position_=0};Ft.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new i;return this.treeSet_.array_[this.position_++]},Ft.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Ft.prototype.remove=function(){throw new r};var kt=function(){};kt.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)i=function(t,e){return t.compareTo(e)},r.sort(i);else if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])},kt.asList=function(t){for(var e=new bt,n=0,i=t.length;n<i;n++)e.add(t[n]);return e};var Bt=function(){},Gt={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Gt.P.get=function(){return 0},Gt.L.get=function(){return 1},Gt.A.get=function(){return 2},Gt.FALSE.get=function(){return-1},Gt.TRUE.get=function(){return-2},Gt.DONTCARE.get=function(){return-3},Gt.SYM_FALSE.get=function(){return"F"},Gt.SYM_TRUE.get=function(){return"T"},Gt.SYM_DONTCARE.get=function(){return"*"},Gt.SYM_P.get=function(){return"0"},Gt.SYM_L.get=function(){return"1"},Gt.SYM_A.get=function(){return"2"},Bt.prototype.interfaces_=function(){return[]},Bt.prototype.getClass=function(){return Bt},Bt.toDimensionSymbol=function(t){switch(t){case Bt.FALSE:return Bt.SYM_FALSE;case Bt.TRUE:return Bt.SYM_TRUE;case Bt.DONTCARE:return Bt.SYM_DONTCARE;case Bt.P:return Bt.SYM_P;case Bt.L:return Bt.SYM_L;case Bt.A:return Bt.SYM_A}throw new _("Unknown dimension value: "+t)},Bt.toDimensionValue=function(t){switch(D.toUpperCase(t)){case Bt.SYM_FALSE:return Bt.FALSE;case Bt.SYM_TRUE:return Bt.TRUE;case Bt.SYM_DONTCARE:return Bt.DONTCARE;case Bt.SYM_P:return Bt.P;case Bt.SYM_L:return Bt.L;case Bt.SYM_A:return Bt.A}throw new _("Unknown dimension symbol: "+t)},Object.defineProperties(Bt,Gt);var jt=function(){};jt.prototype.filter=function(t){},jt.prototype.interfaces_=function(){return[]},jt.prototype.getClass=function(){return jt};var zt=function(){};zt.prototype.filter=function(t,e){},zt.prototype.isDone=function(){},zt.prototype.isGeometryChanged=function(){},zt.prototype.interfaces_=function(){return[]},zt.prototype.getClass=function(){return zt};var Ut=function(t){function e(e,n){if(t.call(this,n),this._geometries=e||[],t.hasNullElements(this._geometries))throw new _("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new Y,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var i=this._geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e;if(this._geometries.length!==i._geometries.length)return!1;for(var r=0;r<this._geometries.length;r++)if(!this._geometries[r].equalsExact(i._geometries[r],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();kt.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=Bt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=Bt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new f(kt.asList(this._geometries)),n=new f(kt.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o=i,s=this.getNumGeometries(),a=o.getNumGeometries(),l=0;l<s&&l<a;){var u=this.getGeometryN(l),c=o.getGeometryN(l),h=u.compareToSameClass(c,r);if(0!==h)return h;l++}return l<s?1:l<a?-1:0}},e.prototype.apply=function(){if(L(arguments[0],ft))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(L(arguments[0],zt)){var n=arguments[0];if(0===this._geometries.length)return null;for(var i=0;i<this._geometries.length&&(this._geometries[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(L(arguments[0],jt)){var r=arguments[0];r.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(r)}else if(L(arguments[0],ut)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),et.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var n=0;n<this._geometries.length;n++)e._geometries[n]=this._geometries[n].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,n),e}(ct),qt=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Bt.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new Vt(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Dt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,n),e}(Ut),Vt=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=dt.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=i}};Vt.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},Vt.prototype.getBoundary=function(){return this._geom instanceof Kt?this.boundaryLineString(this._geom):this._geom instanceof qt?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Vt.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},Vt.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Vt.prototype.computeBoundaryCoordinates=function(t){var e=new bt;this._endpointMap=new h;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return Pt.toCoordinateArray(e)},Vt.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Ht,this._endpointMap.put(t,e)),e.count++},Vt.prototype.interfaces_=function(){return[]},Vt.prototype.getClass=function(){return Vt},Vt.getBoundary=function(){if(1===arguments.length){var t=arguments[0];return new Vt(t).getBoundary()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new Vt(e,n).getBoundary()}};var Ht=function(){this.count=null};Ht.prototype.interfaces_=function(){return[]},Ht.prototype.getClass=function(){return Ht};var Yt=function(){},Xt={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Yt.prototype.interfaces_=function(){return[]},Yt.prototype.getClass=function(){return Yt},Yt.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;i<e;i++)n[i]=t;return String(n)},Yt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o="",s=new function(){}(new function(){}(Yt.getStackTrace(i))),a=0;a<r;a++)try{o+=s.readLine()+Yt.NEWLINE}catch(t){if(!(t instanceof d))throw t;et.shouldNeverReachHere()}return o}},Yt.split=function(t,e){for(var n=e.length,i=new bt,r=""+t,o=r.indexOf(e);o>=0;){var s=r.substring(0,o);i.add(s),o=(r=r.substring(o+n)).indexOf(e)}r.length>0&&i.add(r);for(var a=new Array(i.size()).fill(null),l=0;l<a.length;l++)a[l]=i.get(l);return a},Yt.toString=function(){if(1===arguments.length){var t=arguments[0];return Yt.SIMPLE_ORDINATE_FORMAT.format(t)}},Yt.spaces=function(t){return Yt.chars(" ",t)},Xt.NEWLINE.get=function(){return V.getProperty("line.separator")},Xt.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(Yt,Xt);var Wt=function(){};Wt.prototype.interfaces_=function(){return[]},Wt.prototype.getClass=function(){return Wt},Wt.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),o=0;o<r;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))},Wt.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,j.X)===t.getOrdinate(e-1,j.X)&&t.getOrdinate(0,j.Y)===t.getOrdinate(e-1,j.Y)},Wt.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),r=0;r<n;r++)for(var o=0;o<i;o++){var s=t.getOrdinate(r,o),a=e.getOrdinate(r,o);if(!(t.getOrdinate(r,o)===e.getOrdinate(r,o)||v.isNaN(s)&&v.isNaN(a)))return!1}return!0},Wt.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(Wt.copy(e,0,i,0,r),r>0)for(var o=r;o<n;o++)Wt.copy(e,r-1,i,o,1);return i},Wt.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;i<=n;i++)Wt.swap(t,i,e-i)},Wt.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},Wt.copy=function(t,e,n,i,r){for(var o=0;o<r;o++)Wt.copyCoord(t,e+o,n,i+o)},Wt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new R;i.append("(");for(var r=0;r<e;r++){r>0&&i.append(" ");for(var o=0;o<n;o++)o>0&&i.append(","),i.append(Yt.toString(t.getOrdinate(r,o)))}return i.append(")"),i.toString()}},Wt.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Wt.createClosedRing(t,e,4):e.getOrdinate(0,j.X)===e.getOrdinate(n-1,j.X)&&e.getOrdinate(0,j.Y)===e.getOrdinate(n-1,j.Y)?e:Wt.createClosedRing(t,e,n+1)},Wt.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();Wt.copy(e,0,i,0,r);for(var o=r;o<n;o++)Wt.copy(e,0,i,o,1);return i};var Kt=function(t){function e(e,n){t.call(this,n),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Y:this._points.expandEnvelope(new Y)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e;if(this._points.size()!==i._points.size())return!1;for(var r=0;r<this._points.size();r++)if(!this.equal(this._points.getCoordinate(r),i._points.getCoordinate(r),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&Wt.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Bt.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return at.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Wt.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}},e.prototype.apply=function(){if(L(arguments[0],ft))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(L(arguments[0],zt)){var n=arguments[0];if(0===this._points.size())return null;for(var i=0;i<this._points.size()&&(n.filter(this._points,i),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else(L(arguments[0],jt)||L(arguments[0],ut))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new Vt(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new _("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Dt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(ct),Zt=function(){};Zt.prototype.interfaces_=function(){return[]},Zt.prototype.getClass=function(){return Zt};var Jt=function(t){function e(e,n){t.call(this,n),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Y;var t=new Y;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),n))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return Bt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(L(arguments[0],ft)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(L(arguments[0],zt)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(L(arguments[0],jt)||L(arguments[0],ut))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),et.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Zt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,n),e}(ct),Qt=function(){};Qt.prototype.interfaces_=function(){return[]},Qt.prototype.getClass=function(){return Qt};var $t=function(t){function e(e,n,i){if(t.call(this,i),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===n&&(n=[]),t.hasNullElements(n))throw new _("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(n))throw new _("shell is empty but holes are not");this._shell=e,this._holes=n}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(at.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(at.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var l=t.getX(a),u=t.getY(a);if(l!==o==(u!==s))return!1;o=l,s=u}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e,r=this._shell,o=i._shell;if(!r.equalsExact(o,n))return!1;if(this._holes.length!==i._holes.length)return!1;for(var s=0;s<this._holes.length;s++)if(!this._holes[s].equalsExact(i._holes[s],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);kt.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);V.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=Pt.minCoordinate(e.getCoordinates());Pt.scroll(i,r),V.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],at.isCCW(e.getCoordinates())===n&&Pt.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[0],r=arguments[1],o=i,s=this._shell,a=o._shell,l=s.compareToSameClass(a,r);if(0!==l)return l;for(var u=this.getNumInteriorRing(),c=o.getNumInteriorRing(),h=0;h<u&&h<c;){var p=this.getInteriorRingN(h),f=o.getInteriorRingN(h),d=p.compareToSameClass(f,r);if(0!==d)return d;h++}return h<u?1:h<c?-1:0}},e.prototype.apply=function(t){if(L(t,ft)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(L(t,zt)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(L(t,jt))t.filter(this);else if(L(t,ut)){t.filter(this),this._shell.apply(t);for(var i=0;i<this._holes.length;i++)this._holes[i].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var n=0;n<this._holes.length;n++)e._holes[n]=this._holes[n].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),i=0;i<n.length;i++)n[i]=this._holes[i].copy();return new e(t,n,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[Qt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(ct),te=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return Bt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Zt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,n),e}(Ut),ee=function(t){function e(e,n){e instanceof E&&n instanceof me&&(e=n.getCoordinateSequenceFactory().create(e)),t.call(this,e,n),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return Bt.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return Wt.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new _("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new _("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(Kt),ne=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new bt,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Qt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(Ut),ie=function(t){this._factory=t||null,this._isUserDataCopied=!1},re={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ie.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},ie.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},ie.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof Ut?this.editGeometryCollection(t,e):t instanceof $t?this.editPolygon(t,e):t instanceof Jt||t instanceof Kt?e.edit(t,this._factory):(et.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},ie.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),i=new bt,r=0;r<n.getNumGeometries();r++){var o=this.edit(n.getGeometryN(r),e);null===o||o.isEmpty()||i.add(o)}return n.getClass()===te?this._factory.createMultiPoint(i.toArray([])):n.getClass()===qt?this._factory.createMultiLineString(i.toArray([])):n.getClass()===ne?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))},ie.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this._factory.createPolygon();for(var r=new bt,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(i,r.toArray([]))},ie.prototype.interfaces_=function(){return[]},ie.prototype.getClass=function(){return ie},ie.GeometryEditorOperation=function(){},re.NoOpGeometryOperation.get=function(){return oe},re.CoordinateOperation.get=function(){return se},re.CoordinateSequenceOperation.get=function(){return ae},Object.defineProperties(ie,re);var oe=function(){};oe.prototype.edit=function(t,e){return t},oe.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},oe.prototype.getClass=function(){return oe};var se=function(){};se.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof ee?e.createLinearRing(n):t instanceof Kt?e.createLineString(n):t instanceof Jt?n.length>0?e.createPoint(n[0]):e.createPoint():t},se.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},se.prototype.getClass=function(){return se};var ae=function(){};ae.prototype.edit=function(t,e){return t instanceof ee?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Kt?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Jt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},ae.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},ae.prototype.getClass=function(){return ae};var le=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new E}else if(L(arguments[0],j)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var i=0;i<this._coordinates.length;i++)this._coordinates[i]=n.getCoordinateCopy(i)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],o=arguments[1];this._coordinates=r,this._dimension=o,null===r&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=a;for(var l=0;l<s;l++)this._coordinates[l]=new E}},ue={serialVersionUID:{configurable:!0}};le.prototype.setOrdinate=function(t,e,n){switch(e){case j.X:this._coordinates[t].x=n;break;case j.Y:this._coordinates[t].y=n;break;case j.Z:this._coordinates[t].z=n;break;default:throw new _("invalid ordinateIndex")}},le.prototype.size=function(){return this._coordinates.length},le.prototype.getOrdinate=function(t,e){switch(e){case j.X:return this._coordinates[t].x;case j.Y:return this._coordinates[t].y;case j.Z:return this._coordinates[t].z}return v.NaN},le.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},le.prototype.getCoordinateCopy=function(t){return new E(this._coordinates[t])},le.prototype.getDimension=function(){return this._dimension},le.prototype.getX=function(t){return this._coordinates[t].x},le.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new le(t,this._dimension)},le.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},le.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new le(t,this._dimension)},le.prototype.toString=function(){if(this._coordinates.length>0){var t=new R(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},le.prototype.getY=function(t){return this._coordinates[t].y},le.prototype.toCoordinateArray=function(){return this._coordinates},le.prototype.interfaces_=function(){return[j,e]},le.prototype.getClass=function(){return le},ue.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(le,ue);var ce=function(){},he={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};ce.prototype.readResolve=function(){return ce.instance()},ce.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new le(t)}if(L(arguments[0],j)){var e=arguments[0];return new le(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return i>3&&(i=3),i<2?new le(n):new le(n,i)}},ce.prototype.interfaces_=function(){return[N,e]},ce.prototype.getClass=function(){return ce},ce.instance=function(){return ce.instanceObject},he.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},he.instanceObject.get=function(){return new ce},Object.defineProperties(ce,he);var pe=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new bt,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var t=new Ot;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(Lt),fe=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof ge){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}},de={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};fe.prototype.equals=function(t){if(!(t instanceof fe))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},fe.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new A(n).compareTo(new A(i))},fe.prototype.getScale=function(){return this._scale},fe.prototype.isFloating=function(){return this._modelType===fe.FLOATING||this._modelType===fe.FLOATING_SINGLE},fe.prototype.getType=function(){return this._modelType},fe.prototype.toString=function(){var t="UNKNOWN";return this._modelType===fe.FLOATING?t="Floating":this._modelType===fe.FLOATING_SINGLE?t="Floating-Single":this._modelType===fe.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},fe.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return v.isNaN(t)||this._modelType===fe.FLOATING_SINGLE?t:this._modelType===fe.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof E){var e=arguments[0];if(this._modelType===fe.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},fe.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===fe.FLOATING?t=16:this._modelType===fe.FLOATING_SINGLE?t=6:this._modelType===fe.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},fe.prototype.setScale=function(t){this._scale=Math.abs(t)},fe.prototype.interfaces_=function(){return[e,C]},fe.prototype.getClass=function(){return fe},fe.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},de.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},de.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(fe,de);var ge=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},ye={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};ge.prototype.readResolve=function(){return ge.nameToTypeMap.get(this._name)},ge.prototype.toString=function(){return this._name},ge.prototype.interfaces_=function(){return[e]},ge.prototype.getClass=function(){return ge},ye.serialVersionUID.get=function(){return-552860263173159e4},ye.nameToTypeMap.get=function(){return new pe},Object.defineProperties(ge,ye),fe.Type=ge,fe.FIXED=new ge("FIXED"),fe.FLOATING=new ge("FLOATING"),fe.FLOATING_SINGLE=new ge("FLOATING SINGLE");var me=function t(){this._precisionModel=new fe,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?L(arguments[0],N)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof fe&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},_e={serialVersionUID:{configurable:!0}};me.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new E(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new E(t.getMinX(),t.getMinY()),new E(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new E(t.getMinX(),t.getMinY()),new E(t.getMinX(),t.getMaxY()),new E(t.getMaxX(),t.getMaxY()),new E(t.getMaxX(),t.getMinY()),new E(t.getMinX(),t.getMinY())]),null)},me.prototype.createLineString=function(t){return t?t instanceof Array?new Kt(this.getCoordinateSequenceFactory().create(t),this):L(t,j)?new Kt(t,this):void 0:new Kt(this.getCoordinateSequenceFactory().create([]),this)},me.prototype.createMultiLineString=function(){if(0===arguments.length)return new qt(null,this);if(1===arguments.length){var t=arguments[0];return new qt(t,this)}},me.prototype.buildGeometry=function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(me.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof $t)return this.createMultiPolygon(me.toPolygonArray(t));if(a instanceof Kt)return this.createMultiLineString(me.toLineStringArray(t));if(a instanceof Jt)return this.createMultiPoint(me.toPointArray(t));et.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},me.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},me.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(L(arguments[0],j)){var e=arguments[0];return new Jt(e,this)}}},me.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},me.prototype.createPolygon=function(){if(0===arguments.length)return new $t(null,null,this);if(1===arguments.length){if(L(arguments[0],j)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ee){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return new $t(i,r,this)}},me.prototype.getSRID=function(){return this._SRID},me.prototype.createGeometryCollection=function(){if(0===arguments.length)return new Ut(null,this);if(1===arguments.length){var t=arguments[0];return new Ut(t,this)}},me.prototype.createGeometry=function(t){return new ie(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},me.prototype.getPrecisionModel=function(){return this._precisionModel},me.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(L(arguments[0],j)){var e=arguments[0];return new ee(e,this)}}},me.prototype.createMultiPolygon=function(){if(0===arguments.length)return new ne(null,this);if(1===arguments.length){var t=arguments[0];return new ne(t,this)}},me.prototype.createMultiPoint=function(){if(0===arguments.length)return new te(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new te(t,this)}if(arguments[0]instanceof Array){var e=arguments[0];return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(L(arguments[0],j)){var n=arguments[0];if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var i=new Array(n.size()).fill(null),r=0;r<n.size();r++){var o=this.getCoordinateSequenceFactory().create(1,n.getDimension());Wt.copy(n,r,o,0,1),i[r]=this.createPoint(o)}return this.createMultiPoint(i)}}},me.prototype.interfaces_=function(){return[e]},me.prototype.getClass=function(){return me},me.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},me.getDefaultCoordinateSequenceFactory=function(){return ce.instance()},me.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},_e.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(me,_e);var ve=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],xe=function(t){this.geometryFactory=t||new me};xe.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!Ce[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==ve.indexOf(n)?Ce[n].apply(this,[e.coordinates]):"GeometryCollection"===n?Ce[n].apply(this,[e.geometries]):Ce[n].apply(this,[e])},xe.prototype.write=function(t){var e=t.getGeometryType();if(!we[e])throw new Error("Geometry is not supported");return we[e].apply(this,[t])};var Ce={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!Ce[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=Ce.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new E(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new E(t[0],t[1]),new E(t[2],t[1]),new E(t[2],t[3]),new E(t[0],t[3]),new E(t[0],t[1])])},Point:function(t){var e=new E(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(Ce.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=Ce.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(Ce.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=Ce.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var o=t[r],s=Ce.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(Ce.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},we={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:we.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=we.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(we.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=we.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=we.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var i=0;i<t._holes.length;++i){var r=t._holes[i],o=we.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=we.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=i.getGeometryType();e.push(we[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}},be=function(t){this.geometryFactory=t||new me,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new xe(this.geometryFactory)};be.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===fe.FIXED&&this.reducePrecision(e),e},be.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var Ee=function(){this.parser=new xe(this.geometryFactory)};Ee.prototype.write=function(t){return this.parser.write(t)};var Ie=function(){},Pe={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Ie.prototype.interfaces_=function(){return[]},Ie.prototype.getClass=function(){return Ie},Ie.opposite=function(t){return t===Ie.LEFT?Ie.RIGHT:t===Ie.RIGHT?Ie.LEFT:t},Pe.ON.get=function(){return 0},Pe.LEFT.get=function(){return 1},Pe.RIGHT.get=function(){return 2},Object.defineProperties(Ie,Pe),(g.prototype=new Error).name="EmptyStackException",(y.prototype=new wt).add=function(t){return this.array_.push(t),!0},y.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},y.prototype.push=function(t){return this.array_.push(t),t},y.prototype.pop=function(t){if(0===this.array_.length)throw new g;return this.array_.pop()},y.prototype.peek=function(){if(0===this.array_.length)throw new g;return this.array_[this.array_.length-1]},y.prototype.empty=function(){return 0===this.array_.length},y.prototype.isEmpty=function(){return this.empty()},y.prototype.search=function(t){return this.array_.indexOf(t)},y.prototype.size=function(){return this.array_.length},y.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var Ne=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Ne.prototype.getCoordinate=function(){return this._minCoord},Ne.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Ne.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();et.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],i=at.computeOrientation(this._minCoord,n,e),r=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===at.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===at.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)},Ne.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=Ie.LEFT;return n[e].y<n[e+1].y&&(i=Ie.RIGHT),i},Ne.prototype.getEdge=function(){return this._orientedDe},Ne.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},Ne.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Ne.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}et.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Ie.LEFT&&(this._orientedDe=this._minDe.getSym())},Ne.prototype.interfaces_=function(){return[]},Ne.prototype.getClass=function(){return Ne};var Se=function(t){function e(n,i){t.call(this,e.msgWithCoord(n,i)),this.pt=i?new E(i):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}($),Te=function(){this.array_=[]};Te.prototype.addLast=function(t){this.array_.push(t)},Te.prototype.removeFirst=function(){return this.array_.shift()},Te.prototype.isEmpty=function(){return 0===this.array_.length};var Le=function(){this._finder=null,this._dirEdgeList=new bt,this._nodes=new bt,this._rightMostCoord=null,this._env=null,this._finder=new Ne};Le.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Le.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Le.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new Se("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},Le.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Ie.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Le.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Le.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Ie.RIGHT)>=1&&e.getDepth(Ie.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Le.prototype.computeDepths=function(t){var e=new Ot,n=new Te,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},Le.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Le.prototype.getEnvelope=function(){if(null===this._env){for(var t=new Y,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this._env=t}return this._env},Le.prototype.addReachable=function(t){var e=new y;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},Le.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Ie.LEFT,t.getDepth(Ie.RIGHT)),e.setDepth(Ie.RIGHT,t.getDepth(Ie.LEFT))},Le.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}},Le.prototype.getNodes=function(){return this._nodes},Le.prototype.getDirectedEdges=function(){return this._dirEdgeList},Le.prototype.interfaces_=function(){return[C]},Le.prototype.getClass=function(){return Le};var Me=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[Ie.ON]=n}else if(arguments[0]instanceof t){var i=arguments[0];if(this.init(i.location.length),null!==i)for(var r=0;r<this.location.length;r++)this.location[r]=i.location[r]}}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.init(3),this.location[Ie.ON]=o,this.location[Ie.LEFT]=s,this.location[Ie.RIGHT]=a}};Me.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Me.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==S.NONE)return!1;return!0},Me.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===S.NONE&&(this.location[e]=t)},Me.prototype.isLine=function(){return 1===this.location.length},Me.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Ie.ON]=this.location[Ie.ON],e[Ie.LEFT]=S.NONE,e[Ie.RIGHT]=S.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===S.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},Me.prototype.getLocations=function(){return this.location},Me.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Ie.LEFT];this.location[Ie.LEFT]=this.location[Ie.RIGHT],this.location[Ie.RIGHT]=t},Me.prototype.toString=function(){var t=new R;return this.location.length>1&&t.append(S.toLocationSymbol(this.location[Ie.LEFT])),t.append(S.toLocationSymbol(this.location[Ie.ON])),this.location.length>1&&t.append(S.toLocationSymbol(this.location[Ie.RIGHT])),t.toString()},Me.prototype.setLocations=function(t,e,n){this.location[Ie.ON]=t,this.location[Ie.LEFT]=e,this.location[Ie.RIGHT]=n},Me.prototype.get=function(t){return t<this.location.length?this.location[t]:S.NONE},Me.prototype.isArea=function(){return this.location.length>1},Me.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===S.NONE)return!0;return!1},Me.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Ie.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},Me.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(S.NONE)},Me.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Me.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Me.prototype.interfaces_=function(){return[]},Me.prototype.getClass=function(){return Me};var Oe=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Me(e),this.elt[1]=new Me(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new Me(n.elt[0]),this.elt[1]=new Me(n.elt[1])}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.elt[0]=new Me(S.NONE),this.elt[1]=new Me(S.NONE),this.elt[i].setLocation(r)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new Me(o,s,a),this.elt[1]=new Me(o,s,a)}else if(4===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2],h=arguments[3];this.elt[0]=new Me(S.NONE,S.NONE,S.NONE),this.elt[1]=new Me(S.NONE,S.NONE,S.NONE),this.elt[l].setLocations(u,c,h)}};Oe.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},Oe.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},Oe.prototype.isNull=function(t){return this.elt[t].isNull()},Oe.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},Oe.prototype.isLine=function(t){return this.elt[t].isLine()},Oe.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Me(t.elt[e]):this.elt[e].merge(t.elt[e])},Oe.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Oe.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Ie.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},Oe.prototype.toString=function(){var t=new R;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},Oe.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},Oe.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},Oe.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Ie.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},Oe.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},Oe.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},Oe.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Me(this.elt[t].location[0]))},Oe.prototype.interfaces_=function(){return[]},Oe.prototype.getClass=function(){return Oe},Oe.toLineLabel=function(t){for(var e=new Oe(S.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var Re=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new bt,this._pts=new bt,this._label=new Oe(S.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new bt,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Re.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=at.isCCW(this._ring.getCoordinates())},Re.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Re.prototype.computePoints=function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new Se("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Se("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var i=e.getLabel();et.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},Re.prototype.getLinearRing=function(){return this._ring},Re.prototype.getCoordinate=function(t){return this._pts.get(t)},Re.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Re.prototype.addPoints=function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var o=r;o<i.length;o++)this._pts.add(i[o])}else{var s=i.length-2;n&&(s=i.length-1);for(var a=s;a>=0;a--)this._pts.add(i[a])}},Re.prototype.isHole=function(){return this._isHole},Re.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},Re.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!at.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},Re.prototype.addHole=function(t){this._holes.add(t)},Re.prototype.isShell=function(){return null===this._shell},Re.prototype.getLabel=function(){return this._label},Re.prototype.getEdges=function(){return this._edges},Re.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Re.prototype.getShell=function(){return this._shell},Re.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=e.getLocation(n,Ie.RIGHT);if(i===S.NONE)return null;if(this._label.getLocation(n)===S.NONE)return this._label.setLocation(n,i),null}},Re.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},Re.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Re.prototype.interfaces_=function(){return[]},Re.prototype.getClass=function(){return Re};var Ae=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Re),De=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new bt,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new Ae(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Re),Fe=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};Fe.prototype.setVisited=function(t){this._isVisited=t},Fe.prototype.setInResult=function(t){this._isInResult=t},Fe.prototype.isCovered=function(){return this._isCovered},Fe.prototype.isCoveredSet=function(){return this._isCoveredSet},Fe.prototype.setLabel=function(t){this._label=t},Fe.prototype.getLabel=function(){return this._label},Fe.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},Fe.prototype.updateIM=function(t){et.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},Fe.prototype.isInResult=function(){return this._isInResult},Fe.prototype.isVisited=function(){return this._isVisited},Fe.prototype.interfaces_=function(){return[]},Fe.prototype.getClass=function(){return Fe};var ke=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],n=arguments[1];this._coord=e,this._edges=n,this._label=new Oe(0,S.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var n=S.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==S.BOUNDARY&&(n=i)}return n},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],n=arguments[1];null===this._label?this._label=new Oe(e,n):this._label.setLocation(e,n)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Oe)for(var n=arguments[0],i=0;i<2;i++){var r=this.computeMergedLocation(n,i);this._label.getLocation(i)===S.NONE&&this._label.setLocation(i,r)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=S.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case S.BOUNDARY:n=S.INTERIOR;break;case S.INTERIOR:default:n=S.BOUNDARY}this._label.setLocation(t,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Fe),Be=function(){this.nodeMap=new h,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};Be.prototype.find=function(t){return this.nodeMap.get(t)},Be.prototype.addNode=function(){if(arguments[0]instanceof E){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof ke){var n=arguments[0],i=this.nodeMap.get(n.getCoordinate());return null===i?(this.nodeMap.put(n.getCoordinate(),n),n):(i.mergeLabel(n),i)}},Be.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},Be.prototype.iterator=function(){return this.nodeMap.values().iterator()},Be.prototype.values=function(){return this.nodeMap.values()},Be.prototype.getBoundaryNodes=function(t){for(var e=new bt,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===S.BOUNDARY&&e.add(i)}return e},Be.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},Be.prototype.interfaces_=function(){return[]},Be.prototype.getClass=function(){return Be};var Ge=function(){},je={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Ge.prototype.interfaces_=function(){return[]},Ge.prototype.getClass=function(){return Ge},Ge.isNorthern=function(t){return t===Ge.NE||t===Ge.NW},Ge.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},Ge.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},Ge.isInHalfPlane=function(t,e){return e===Ge.SE?t===Ge.SE||t===Ge.SW:t===e||t===e+1},Ge.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new _("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Ge.NE:Ge.SE:e>=0?Ge.NW:Ge.SW}if(arguments[0]instanceof E&&arguments[1]instanceof E){var n=arguments[0],i=arguments[1];if(i.x===n.x&&i.y===n.y)throw new _("Cannot compute the quadrant for two identical points "+n);return i.x>=n.x?i.y>=n.y?Ge.NE:Ge.SE:i.y>=n.y?Ge.NW:Ge.SW}},je.NE.get=function(){return 0},je.NW.get=function(){return 1},je.SW.get=function(){return 2},je.SE.get=function(){return 3},Object.defineProperties(Ge,je);var ze=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];this._edge=e,this.init(n,i),this._label=null}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this._edge=r,this.init(o,s),this._label=a}};ze.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:at.computeOrientation(t._p0,t._p1,this._p1)},ze.prototype.getDy=function(){return this._dy},ze.prototype.getCoordinate=function(){return this._p0},ze.prototype.setNode=function(t){this._node=t},ze.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},ze.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},ze.prototype.getDirectedCoordinate=function(){return this._p1},ze.prototype.getDx=function(){return this._dx},ze.prototype.getLabel=function(){return this._label},ze.prototype.getEdge=function(){return this._edge},ze.prototype.getQuadrant=function(){return this._quadrant},ze.prototype.getNode=function(){return this._node},ze.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},ze.prototype.computeLabel=function(t){},ze.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Ge.quadrant(this._dx,this._dy),et.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},ze.prototype.interfaces_=function(){return[C]},ze.prototype.getClass=function(){return ze};var Ue=function(t){function e(){var e=arguments[0],n=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=n,n)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var i=e.getNumPoints()-1;this.init(e.getCoordinate(i),e.getCoordinate(i-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new Oe(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Se("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Ie.LEFT)===S.INTERIOR&&this._label.getLocation(e,Ie.RIGHT)===S.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[Ie.LEFT]+"/"+this._depth[Ie.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,S.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,S.EXTERIOR);return t&&e&&n},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===Ie.LEFT&&(i=-1);var r=Ie.opposite(t),o=e+n*i;this.setDepth(t,e),this.setDepth(r,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===S.EXTERIOR&&e===S.INTERIOR?1:t===S.INTERIOR&&e===S.EXTERIOR?-1:0},e}(ze),qe=function(){};qe.prototype.createNode=function(t){return new ke(t,null)},qe.prototype.interfaces_=function(){return[]},qe.prototype.getClass=function(){return qe};var Ve=function(){if(this._edges=new bt,this._nodes=null,this._edgeEndList=new bt,0===arguments.length)this._nodes=new Be(new qe);else if(1===arguments.length){var t=arguments[0];this._nodes=new Be(t)}};Ve.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},Ve.prototype.find=function(t){return this._nodes.find(t)},Ve.prototype.addNode=function(){if(arguments[0]instanceof ke){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof E){var e=arguments[0];return this._nodes.addNode(e)}},Ve.prototype.getNodeIterator=function(){return this._nodes.iterator()},Ve.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},Ve.prototype.debugPrintln=function(t){V.out.println(t)},Ve.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===S.BOUNDARY},Ve.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},Ve.prototype.matchInSameDirection=function(t,e,n,i){return!!t.equals(n)&&at.computeOrientation(t,e,i)===at.COLLINEAR&&Ge.quadrant(t,e)===Ge.quadrant(n,i)},Ve.prototype.getEdgeEnds=function(){return this._edgeEndList},Ve.prototype.debugPrint=function(t){V.out.print(t)},Ve.prototype.getEdgeIterator=function(){return this._edges.iterator()},Ve.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},Ve.prototype.insertEdge=function(t){this._edges.add(t)},Ve.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},Ve.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var i=new Ue(n,!0),r=new Ue(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},Ve.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},Ve.prototype.getNodes=function(){return this._nodes.values()},Ve.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},Ve.prototype.interfaces_=function(){return[]},Ve.prototype.getClass=function(){return Ve},Ve.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var He=function(){this._geometryFactory=null,this._shellList=new bt;var t=arguments[0];this._geometryFactory=t};He.prototype.sortShellsAndHoles=function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},He.prototype.computePolygons=function(t){for(var e=new bt,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);e.add(i)}return e},He.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new Se("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},He.prototype.buildMinimalEdgeRings=function(t,e,n){for(var i=new bt,r=t.iterator();r.hasNext();){var o=r.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else i.add(o)}return i},He.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},He.prototype.buildMaximalEdgeRings=function(t){for(var e=new bt,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new De(i,this._geometryFactory);e.add(r),r.setInResult()}}return e},He.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},He.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},He.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var l=a.next(),u=l.getLinearRing(),c=u.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var h=!1;c.contains(i)&&at.isPointInRing(r,u.getCoordinates())&&(h=!0),h&&(null===o||s.contains(c))&&(o=l)}return o},He.prototype.findShell=function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return et.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},He.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];Ve.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new bt,o=this.buildMinimalEdgeRings(i,this._shellList,r);this.sortShellsAndHoles(o,this._shellList,r),this.placeFreeHoles(this._shellList,r)}},He.prototype.interfaces_=function(){return[]},He.prototype.getClass=function(){return He};var Ye=function(){};Ye.prototype.getBounds=function(){},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye};var Xe=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};Xe.prototype.getItem=function(){return this._item},Xe.prototype.getBounds=function(){return this._bounds},Xe.prototype.interfaces_=function(){return[Ye,e]},Xe.prototype.getClass=function(){return Xe};var We=function(){this._size=null,this._items=null,this._size=0,this._items=new bt,this._items.add(null)};We.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},We.prototype.size=function(){return this._size},We.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},We.prototype.clear=function(){this._size=0,this._items.clear()},We.prototype.isEmpty=function(){return 0===this._size},We.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},We.prototype.interfaces_=function(){return[]},We.prototype.getClass=function(){return We};var Ke=function(){};Ke.prototype.visitItem=function(t){},Ke.prototype.interfaces_=function(){return[]},Ke.prototype.getClass=function(){return Ke};var Ze=function(){};Ze.prototype.insert=function(t,e){},Ze.prototype.remove=function(t,e){},Ze.prototype.query=function(){},Ze.prototype.interfaces_=function(){return[]},Ze.prototype.getClass=function(){return Ze};var Je=function(){if(this._childBoundables=new bt,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Qe={serialVersionUID:{configurable:!0}};Je.prototype.getLevel=function(){return this._level},Je.prototype.size=function(){return this._childBoundables.size()},Je.prototype.getChildBoundables=function(){return this._childBoundables},Je.prototype.addChildBoundable=function(t){et.isTrue(null===this._bounds),this._childBoundables.add(t)},Je.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Je.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Je.prototype.interfaces_=function(){return[Ye,e]},Je.prototype.getClass=function(){return Je},Qe.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Je,Qe);var $e=function(){};$e.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},$e.min=function(t){return $e.sort(t),t.get(0)},$e.sort=function(t,e){var n=t.toArray();e?kt.sort(n,e):kt.sort(n);for(var i=t.iterator(),r=0,o=n.length;r<o;r++)i.next(),i.set(n[r])},$e.singletonList=function(t){var e=new bt;return e.add(t),e};var tn=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};tn.prototype.expandToQueue=function(t,e){var n=tn.isComposite(this._boundable1),i=tn.isComposite(this._boundable2);if(n&&i)return tn.area(this._boundable1)>tn.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new _("neither boundable is composite")},tn.prototype.isLeaves=function(){return!(tn.isComposite(this._boundable1)||tn.isComposite(this._boundable2))},tn.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},tn.prototype.expand=function(t,e,n,i){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),s=new tn(o,e,this._itemDistance);s.getDistance()<i&&n.add(s)}},tn.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},tn.prototype.getDistance=function(){return this._distance},tn.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},tn.prototype.interfaces_=function(){return[C]},tn.prototype.getClass=function(){return tn},tn.area=function(t){return t.getBounds().getArea()},tn.isComposite=function(t){return t instanceof Je};var en=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new bt,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];et.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},nn={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};en.prototype.getNodeCapacity=function(){return this._nodeCapacity},en.prototype.lastNode=function(t){return t.get(t.size()-1)},en.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Je?t+=this.size(n):n instanceof Xe&&(t+=1)}return t}},en.prototype.removeItem=function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof Xe&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},en.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new bt:t}if(1===arguments.length){for(var e=arguments[0],n=new bt,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof Je){var o=this.itemsTree(r);null!==o&&n.add(o)}else r instanceof Xe?n.add(r.getItem()):et.shouldNeverReachHere()}return n.size()<=0?null:n}},en.prototype.insert=function(t,e){et.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Xe(t,e))},en.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new bt;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(et.isTrue(n>-2),i.getLevel()===n)return r.add(i),null;for(var o=i.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof Je?this.boundablesAtLevel(n,s,r):(et.isTrue(s instanceof Xe),-1===n&&r.add(s))}return null}},en.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new bt;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,i)}else if(3===arguments.length)if(L(arguments[2],Ke)&&arguments[0]instanceof Object&&arguments[1]instanceof Je)for(var r=arguments[0],o=arguments[1],s=arguments[2],a=o.getChildBoundables(),l=0;l<a.size();l++){var u=a.get(l);this.getIntersectsOp().intersects(u.getBounds(),r)&&(u instanceof Je?this.query(r,u,s):u instanceof Xe?s.visitItem(u.getItem()):et.shouldNeverReachHere())}else if(L(arguments[2],wt)&&arguments[0]instanceof Object&&arguments[1]instanceof Je)for(var c=arguments[0],h=arguments[1],p=arguments[2],f=h.getChildBoundables(),d=0;d<f.size();d++){var g=f.get(d);this.getIntersectsOp().intersects(g.getBounds(),c)&&(g instanceof Je?this.query(c,g,p):g instanceof Xe?p.add(g.getItem()):et.shouldNeverReachHere())}},en.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},en.prototype.getRoot=function(){return this.build(),this._root},en.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=this.removeItem(i,r);if(o)return!0;for(var s=null,a=i.getChildBoundables().iterator();a.hasNext();){var l=a.next();if(this.getIntersectsOp().intersects(l.getBounds(),n)&&l instanceof Je&&(o=this.remove(n,l,r))){s=l;break}}return null!==s&&s.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(s),o}},en.prototype.createHigherLevels=function(t,e){et.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},en.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Je){var i=this.depth(n);i>t&&(t=i)}}return t+1}},en.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var n=new bt;n.add(this.createNode(e));var i=new bt(t);$e.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var o=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},en.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},en.prototype.interfaces_=function(){return[e]},en.prototype.getClass=function(){return en},en.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},nn.IntersectsOp.get=function(){return rn},nn.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},nn.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(en,nn);var rn=function(){},on=function(){};on.prototype.distance=function(t,e){},on.prototype.interfaces_=function(){return[]},on.prototype.getClass=function(){return on};var sn=function(t){function n(e){e=e||n.DEFAULT_NODE_CAPACITY,t.call(this,e)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var i={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return n.prototype.createParentBoundablesFromVerticalSlices=function(t,e){et.isTrue(t.length>0);for(var n=new bt,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},n.prototype.createNode=function(t){return new an(t)},n.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},n.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],n=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,n)},n.prototype.getIntersectsOp=function(){return n.intersectsOp},n.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){i[o]=new bt;for(var s=0;r.hasNext()&&s<n;){var a=r.next();i[o].add(a),s++}}return i},n.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];t.prototype.query.call(this,n,i)}else if(3===arguments.length)if(L(arguments[2],Ke)&&arguments[0]instanceof Object&&arguments[1]instanceof Je){var r=arguments[0],o=arguments[1],s=arguments[2];t.prototype.query.call(this,r,o,s)}else if(L(arguments[2],wt)&&arguments[0]instanceof Object&&arguments[1]instanceof Je){var a=arguments[0],l=arguments[1],u=arguments[2];t.prototype.query.call(this,a,l,u)}},n.prototype.getComparator=function(){return n.yComparator},n.prototype.createParentBoundablesFromVerticalSlice=function(e,n){return t.prototype.createParentBoundables.call(this,e,n)},n.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.prototype.remove.call(this,e,n)}return t.prototype.remove.apply(this,arguments)},n.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},n.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var i=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new bt(t);$e.sort(r,n.xComparator);var o=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(i))));return this.createParentBoundablesFromVerticalSlices(o,e)},n.prototype.nearestNeighbour=function(){if(1===arguments.length){if(L(arguments[0],on)){var t=arguments[0],e=new tn(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof tn){var i=arguments[0];return this.nearestNeighbour(i,v.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof n&&L(arguments[1],on)){var r=arguments[0],o=arguments[1],s=new tn(this.getRoot(),r.getRoot(),o);return this.nearestNeighbour(s)}if(arguments[0]instanceof tn&&"number"==typeof arguments[1]){var a=arguments[0],l=arguments[1],u=null,c=new We;for(c.add(a);!c.isEmpty()&&l>0;){var h=c.poll(),p=h.getDistance();if(p>=l)break;h.isLeaves()?(l=p,u=h):h.expandToQueue(c,l)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length){var f=arguments[0],d=arguments[1],g=arguments[2],y=new Xe(f,d),m=new tn(this.getRoot(),y,g);return this.nearestNeighbour(m)[0]}},n.prototype.interfaces_=function(){return[Ze,e]},n.prototype.getClass=function(){return n},n.centreX=function(t){return n.avg(t.getMinX(),t.getMaxX())},n.avg=function(t,e){return(t+e)/2},n.centreY=function(t){return n.avg(t.getMinY(),t.getMaxY())},i.STRtreeNode.get=function(){return an},i.serialVersionUID.get=function(){return 0x39920f7d5f261e0},i.xComparator.get=function(){return{interfaces_:function(){return[b]},compare:function(e,i){return t.compareDoubles(n.centreX(e.getBounds()),n.centreX(i.getBounds()))}}},i.yComparator.get=function(){return{interfaces_:function(){return[b]},compare:function(e,i){return t.compareDoubles(n.centreY(e.getBounds()),n.centreY(i.getBounds()))}}},i.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},i.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(n,i),n}(en),an=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new Y(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Je),ln=function(){};ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln},ln.relativeSign=function(t,e){return t<e?-1:t>e?1:0},ln.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=ln.relativeSign(e.x,n.x),r=ln.relativeSign(e.y,n.y);switch(t){case 0:return ln.compareValue(i,r);case 1:return ln.compareValue(r,i);case 2:return ln.compareValue(r,-i);case 3:return ln.compareValue(-i,r);case 4:return ln.compareValue(-i,-r);case 5:return ln.compareValue(-r,-i);case 6:return ln.compareValue(-r,i);case 7:return ln.compareValue(i,-r)}return et.shouldNeverReachHere("invalid octant value"),0},ln.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var un=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new E(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))};un.prototype.getCoordinate=function(){return this.coord},un.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},un.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:ln.compare(this._segmentOctant,this.coord,e.coord)},un.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},un.prototype.isInterior=function(){return this._isInterior},un.prototype.interfaces_=function(){return[C]},un.prototype.getClass=function(){return un};var cn=function(){this._nodeMap=new h,this._edge=null;var t=arguments[0];this._edge=t};cn.prototype.getSplitCoordinates=function(){var t=new It;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},cn.prototype.addCollapsedNodes=function(){var t=new bt;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},cn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},cn.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(new A(e+1))}},cn.prototype.addEdgeCoordinates=function(t,e,n){var i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new E(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));r&&n.add(new E(e.coord))},cn.prototype.iterator=function(){return this._nodeMap.values().iterator()},cn.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},cn.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},cn.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new A(e[0])),i=r}},cn.prototype.getEdge=function(){return this._edge},cn.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},cn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new E(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return r&&(o[s]=new E(e.coord)),new dn(o,this._edge.getData())},cn.prototype.add=function(t,e){var n=new un(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(et.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)},cn.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new $("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new $("bad split edge end point at "+r)},cn.prototype.interfaces_=function(){return[]},cn.prototype.getClass=function(){return cn};var hn=function(){};hn.prototype.interfaces_=function(){return[]},hn.prototype.getClass=function(){return hn},hn.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new _("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),i=Math.abs(e);return t>=0?e>=0?n>=i?0:1:n>=i?7:6:e>=0?n>=i?3:2:n>=i?4:5}if(arguments[0]instanceof E&&arguments[1]instanceof E){var r=arguments[0],o=arguments[1],s=o.x-r.x,a=o.y-r.y;if(0===s&&0===a)throw new _("Cannot compute the octant for two identical points "+r);return hn.octant(s,a)}};var pn=function(){};pn.prototype.getCoordinates=function(){},pn.prototype.size=function(){},pn.prototype.getCoordinate=function(t){},pn.prototype.isClosed=function(){},pn.prototype.setData=function(t){},pn.prototype.getData=function(){},pn.prototype.interfaces_=function(){return[]},pn.prototype.getClass=function(){return pn};var fn=function(){};fn.prototype.addIntersection=function(t,e){},fn.prototype.interfaces_=function(){return[pn]},fn.prototype.getClass=function(){return fn};var dn=function(){this._nodeList=new cn(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};dn.prototype.getCoordinates=function(){return this._pts},dn.prototype.size=function(){return this._pts.length},dn.prototype.getCoordinate=function(t){return this._pts[t]},dn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},dn.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},dn.prototype.setData=function(t){this._data=t},dn.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:hn.octant(t,e)},dn.prototype.getData=function(){return this._data},dn.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[3],o=new E(n.getIntersection(r));this.addIntersection(o,i)}},dn.prototype.toString=function(){return Q.toLineString(new le(this._pts))},dn.prototype.getNodeList=function(){return this._nodeList},dn.prototype.addIntersectionNode=function(t,e){var n=e,i=n+1;if(i<this._pts.length){var r=this._pts[i];t.equals2D(r)&&(n=i)}return this._nodeList.add(t,n)},dn.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},dn.prototype.interfaces_=function(){return[fn]},dn.prototype.getClass=function(){return dn},dn.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new bt;return dn.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(i)};var gn=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new E,this.p1=new E;else if(1===arguments.length){var t=arguments[0];this.p0=new E(t.p0),this.p1=new E(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3];this.p0=new E(e,n),this.p1=new E(i,r)}},yn={serialVersionUID:{configurable:!0}};gn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},gn.prototype.orientationIndex=function(){if(arguments[0]instanceof gn){var t=arguments[0],e=at.orientationIndex(this.p0,this.p1,t.p0),n=at.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof E){var i=arguments[0];return at.orientationIndex(this.p0,this.p1,i)}},gn.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},gn.prototype.isVertical=function(){return this.p0.x===this.p1.x},gn.prototype.equals=function(t){if(!(t instanceof gn))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},gn.prototype.intersection=function(t){var e=new rt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},gn.prototype.project=function(){if(arguments[0]instanceof E){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new E(t);var e=this.projectionFactor(t),n=new E;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof gn){var i=arguments[0],r=this.projectionFactor(i.p0),o=this.projectionFactor(i.p1);if(r>=1&&o>=1)return null;if(r<=0&&o<=0)return null;var s=this.project(i.p0);r<0&&(s=this.p0),r>1&&(s=this.p1);var a=this.project(i.p1);return o<0&&(a=this.p0),o>1&&(a=this.p1),new gn(s,a)}},gn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},gn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},gn.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},gn.prototype.distancePerpendicular=function(t){return at.distancePointLinePerpendicular(t,this.p0,this.p1)},gn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},gn.prototype.midPoint=function(){return gn.midPoint(this.p0,this.p1)},gn.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?v.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},gn.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=v.MAX_VALUE,r=null,o=this.closestPoint(t.p0);i=o.distance(t.p0),n[0]=o,n[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<i&&(i=r,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<i&&(i=r,n[0]=this.p0,n[1]=a);var l=t.closestPoint(this.p1);return(r=l.distance(this.p1))<i&&(i=r,n[0]=this.p1,n[1]=l),n},gn.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},gn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},gn.prototype.getLength=function(){return this.p0.distance(this.p1)},gn.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},gn.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},gn.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},gn.prototype.lineIntersection=function(t){try{return H.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof q))throw t}return null},gn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},gn.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,l=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,l=e*o/s}return new E(n-l,i+a)},gn.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},gn.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||v.isNaN(e))&&(e=1),e},gn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},gn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},gn.prototype.distance=function(){if(arguments[0]instanceof gn){var t=arguments[0];return at.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof E){var e=arguments[0];return at.distancePointLine(e,this.p0,this.p1)}},gn.prototype.pointAlong=function(t){var e=new E;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},gn.prototype.hashCode=function(){var t=v.doubleToLongBits(this.p0.x);t^=31*v.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=v.doubleToLongBits(this.p1.x);return n^=31*v.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},gn.prototype.interfaces_=function(){return[C,e]},gn.prototype.getClass=function(){return gn},gn.midPoint=function(t,e){return new E((t.x+e.x)/2,(t.y+e.y)/2)},yn.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(gn,yn);var mn=function(){this.tempEnv1=new Y,this.tempEnv2=new Y,this._overlapSeg1=new gn,this._overlapSeg2=new gn};mn.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t.getLineSegment(e,this._overlapSeg1),n.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},mn.prototype.interfaces_=function(){return[]},mn.prototype.getClass=function(){return mn};var _n=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i};_n.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},_n.prototype.computeSelect=function(t,e,n,i){var r=this._pts[e],o=this._pts[n];if(i.tempEnv1.init(r,o),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,i),s<n&&this.computeSelect(t,s,n,i)},_n.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},_n.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},_n.prototype.setId=function(t){this._id=t},_n.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},_n.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new Y(t,e)}return this._env},_n.prototype.getEndIndex=function(){return this._end},_n.prototype.getStartIndex=function(){return this._start},_n.prototype.getContext=function(){return this._context},_n.prototype.getId=function(){return this._id},_n.prototype.computeOverlapsInternal=function(t,e,n,i,r,o){var s=this._pts[t],a=this._pts[e],l=n._pts[i],u=n._pts[r];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(l,u),!o.tempEnv1.intersects(o.tempEnv2))return null;var c=Math.trunc((t+e)/2),h=Math.trunc((i+r)/2);t<c&&(i<h&&this.computeOverlapsInternal(t,c,n,i,h,o),h<r&&this.computeOverlapsInternal(t,c,n,h,r,o)),c<e&&(i<h&&this.computeOverlapsInternal(c,e,n,i,h,o),h<r&&this.computeOverlapsInternal(c,e,n,h,r,o))},_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n};var vn=function(){};vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn},vn.getChainStartIndices=function(t){var e=0,n=new bt;n.add(new A(e));do{var i=vn.findChainEnd(t,e);n.add(new A(i)),e=i}while(e<t.length-1);return vn.toIntArray(n)},vn.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=Ge.quadrant(t[n],t[n+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||Ge.quadrant(t[r-1],t[r])===i);)r++;return r-1},vn.getChains=function(){if(1===arguments.length){var t=arguments[0];return vn.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new bt,r=vn.getChainStartIndices(e),o=0;o<r.length-1;o++){var s=new _n(e,r[o],r[o+1],n);i.add(s)}return i}},vn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var xn=function(){};xn.prototype.computeNodes=function(t){},xn.prototype.getNodedSubstrings=function(){},xn.prototype.interfaces_=function(){return[]},xn.prototype.getClass=function(){return xn};var Cn=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};Cn.prototype.setSegmentIntersector=function(t){this._segInt=t},Cn.prototype.interfaces_=function(){return[xn]},Cn.prototype.getClass=function(){return Cn};var wn=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new bt,this._index=new sn,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return dn.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=vn.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new bn(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this._index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return bn},Object.defineProperties(e,n),e}(Cn),bn=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3],o=e.getContext(),s=i.getContext();this._si.processIntersections(o,n,s,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(mn),En=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(i)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}},In={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};En.prototype.getEndCapStyle=function(){return this._endCapStyle},En.prototype.isSingleSided=function(){return this._isSingleSided},En.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=En.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=En.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==En.JOIN_ROUND&&(this._quadrantSegments=En.DEFAULT_QUADRANT_SEGMENTS)},En.prototype.getJoinStyle=function(){return this._joinStyle},En.prototype.setJoinStyle=function(t){this._joinStyle=t},En.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},En.prototype.getSimplifyFactor=function(){return this._simplifyFactor},En.prototype.getQuadrantSegments=function(){return this._quadrantSegments},En.prototype.setEndCapStyle=function(t){this._endCapStyle=t},En.prototype.getMitreLimit=function(){return this._mitreLimit},En.prototype.setMitreLimit=function(t){this._mitreLimit=t},En.prototype.setSingleSided=function(t){this._isSingleSided=t},En.prototype.interfaces_=function(){return[]},En.prototype.getClass=function(){return En},En.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},In.CAP_ROUND.get=function(){return 1},In.CAP_FLAT.get=function(){return 2},In.CAP_SQUARE.get=function(){return 3},In.JOIN_ROUND.get=function(){return 1},In.JOIN_MITRE.get=function(){return 2},In.JOIN_BEVEL.get=function(){return 3},In.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},In.DEFAULT_MITRE_LIMIT.get=function(){return 5},In.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(En,In);var Pn=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=at.COUNTERCLOCKWISE,this._inputLine=t||null},Nn={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Pn.prototype.isDeletable=function(t,e,n,i){var r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(r,o,s)&&!!this.isShallow(r,o,s,i)&&this.isShallowSampled(r,o,t,n,i)},Pn.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;n<this._inputLine.length;){var r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=Pn.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},Pn.prototype.isShallowConcavity=function(t,e,n,i){return at.computeOrientation(t,e,n)===this._angleOrientation&&at.distancePointLine(e,t,n)<i},Pn.prototype.isShallowSampled=function(t,e,n,i,r){var o=Math.trunc((i-n)/Pn.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=n;s<i;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},Pn.prototype.isConcave=function(t,e,n){return at.computeOrientation(t,e,n)===this._angleOrientation},Pn.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=at.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Pn.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Pn.DELETE;)e++;return e},Pn.prototype.isShallow=function(t,e,n,i){return at.distancePointLine(e,t,n)<i},Pn.prototype.collapseLine=function(){for(var t=new It,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Pn.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Pn.prototype.interfaces_=function(){return[]},Pn.prototype.getClass=function(){return Pn},Pn.simplify=function(t,e){return new Pn(t).simplify(e)},Nn.INIT.get=function(){return 0},Nn.DELETE.get=function(){return 1},Nn.KEEP.get=function(){return 1},Nn.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Pn,Nn);var Sn=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new bt},Tn={COORDINATE_ARRAY_TYPE:{configurable:!0}};Sn.prototype.getCoordinates=function(){return this._ptList.toArray(Sn.COORDINATE_ARRAY_TYPE)},Sn.prototype.setPrecisionModel=function(t){this._precisionModel=t},Sn.prototype.addPt=function(t){var e=new E(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},Sn.prototype.revere=function(){},Sn.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var i=t.length-1;i>=0;i--)this.addPt(t[i])},Sn.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},Sn.prototype.toString=function(){return(new me).createLineString(this.getCoordinates()).toString()},Sn.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new E(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},Sn.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},Sn.prototype.interfaces_=function(){return[]},Sn.prototype.getClass=function(){return Sn},Tn.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Sn,Tn);var Ln=function(){},Mn={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Ln.prototype.interfaces_=function(){return[]},Ln.prototype.getClass=function(){return Ln},Ln.toDegrees=function(t){return 180*t/Math.PI},Ln.normalize=function(t){for(;t>Math.PI;)t-=Ln.PI_TIMES_2;for(;t<=-Math.PI;)t+=Ln.PI_TIMES_2;return t},Ln.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},Ln.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0},Ln.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0},Ln.interiorAngle=function(t,e,n){var i=Ln.angle(e,t),r=Ln.angle(e,n);return Math.abs(r-i)},Ln.normalizePositive=function(t){if(t<0){for(;t<0;)t+=Ln.PI_TIMES_2;t>=Ln.PI_TIMES_2&&(t=0)}else{for(;t>=Ln.PI_TIMES_2;)t-=Ln.PI_TIMES_2;t<0&&(t=0)}return t},Ln.angleBetween=function(t,e,n){var i=Ln.angle(e,t),r=Ln.angle(e,n);return Ln.diff(i,r)},Ln.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},Ln.toRadians=function(t){return t*Math.PI/180},Ln.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?Ln.COUNTERCLOCKWISE:n<0?Ln.CLOCKWISE:Ln.NONE},Ln.angleBetweenOriented=function(t,e,n){var i=Ln.angle(e,t),r=Ln.angle(e,n)-i;return r<=-Math.PI?r+Ln.PI_TIMES_2:r>Math.PI?r-Ln.PI_TIMES_2:r},Mn.PI_TIMES_2.get=function(){return 2*Math.PI},Mn.PI_OVER_2.get=function(){return Math.PI/2},Mn.PI_OVER_4.get=function(){return Math.PI/4},Mn.COUNTERCLOCKWISE.get=function(){return at.COUNTERCLOCKWISE},Mn.CLOCKWISE.get=function(){return at.CLOCKWISE},Mn.NONE.get=function(){return at.COLLINEAR},Object.defineProperties(Ln,Mn);var On=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new gn,this._seg1=new gn,this._offset0=new gn,this._offset1=new gn,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new rt,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===En.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)},Rn={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};On.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=at.computeOrientation(this._s0,this._s1,this._s2),i=n===at.CLOCKWISE&&this._side===Ie.LEFT||n===at.COUNTERCLOCKWISE&&this._side===Ie.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},On.prototype.addLineEndCap=function(t,e){var n=new gn(t,e),i=new gn;this.computeOffsetSegment(n,Ie.LEFT,this._distance,i);var r=new gn;this.computeOffsetSegment(n,Ie.RIGHT,this._distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case En.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,at.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case En.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case En.CAP_SQUARE:var l=new E;l.x=Math.abs(this._distance)*Math.cos(a),l.y=Math.abs(this._distance)*Math.sin(a);var u=new E(i.p1.x+l.x,i.p1.y+l.y),c=new E(r.p1.x+l.x,r.p1.y+l.y);this._segList.addPt(u),this._segList.addPt(c)}},On.prototype.getCoordinates=function(){return this._segList.getCoordinates()},On.prototype.addMitreJoin=function(t,e,n,i){var r=!0,o=null;try{o=H.intersection(e.p0,e.p1,n.p0,n.p1),(i<=0?1:o.distance(t)/Math.abs(i))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof q))throw t;o=new E(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())},On.prototype.addFilletCorner=function(t,e,n,i,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),l=n.x-t.x,u=n.y-t.y,c=Math.atan2(u,l);i===at.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,c,i,r),this._segList.addPt(n)},On.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*On.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===En.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===En.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},On.prototype.createSquare=function(t){this._segList.addPt(new E(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new E(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new E(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new E(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},On.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},On.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},On.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},On.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},On.prototype.addLimitedMitreJoin=function(t,e,n,i){var r=this._seg0.p1,o=Ln.angle(r,this._seg0.p0),s=Ln.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=Ln.normalize(o+s),l=Ln.normalize(a+Math.PI),u=i*n,c=n-u*Math.abs(Math.sin(s)),h=r.x+u*Math.cos(l),p=r.y+u*Math.sin(l),f=new E(h,p),d=new gn(r,f),g=d.pointAlongOffset(1,c),y=d.pointAlongOffset(1,-c);this._side===Ie.LEFT?(this._segList.addPt(g),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(g))},On.prototype.computeOffsetSegment=function(t,e,n,i){var r=e===Ie.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),l=r*n*o/a,u=r*n*s/a;i.p0.x=t.p0.x-u,i.p0.y=t.p0.y+l,i.p1.x=t.p1.x-u,i.p1.y=t.p1.y+l},On.prototype.addFilletArc=function(t,e,n,i,r){var o=i===at.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var l=s/a,u=0,c=new E;u<s;){var h=e+o*u;c.x=t.x+r*Math.cos(h),c.y=t.y+r*Math.sin(h),this._segList.addPt(c),u+=l}},On.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*On.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new E((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var i=new E((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},On.prototype.createCircle=function(t){var e=new E(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},On.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},On.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Sn,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*On.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},On.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===En.JOIN_BEVEL||this._bufParams.getJoinStyle()===En.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,at.CLOCKWISE,this._distance))},On.prototype.closeRing=function(){this._segList.closeRing()},On.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},On.prototype.interfaces_=function(){return[]},On.prototype.getClass=function(){return On},Rn.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Rn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Rn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Rn.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(On,Rn);var An=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};An.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var o=r.getCoordinates();return n&&Pt.reverse(o),o},An.prototype.computeSingleSidedBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var r=Pn.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Ie.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{n.addSegments(t,!1);var a=Pn.simplify(t,i),l=a.length-1;n.initSideSegments(a[0],a[1],Ie.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment(),n.closeRing()},An.prototype.computeRingBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);e===Ie.RIGHT&&(i=-i);var r=Pn.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(var s=1;s<=o;s++){var a=1!==s;n.addNextSegment(r[s],a)}n.closeRing()},An.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),i=Pn.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],Ie.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(i[o],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var s=Pn.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],Ie.LEFT);for(var l=a-2;l>=0;l--)e.addNextSegment(s[l],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},An.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case En.CAP_ROUND:e.createCircle(t);break;case En.CAP_SQUARE:e.createSquare(t)}},An.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},An.prototype.getBufferParameters=function(){return this._bufParams},An.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},An.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return An.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},An.prototype.computeOffsetCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){var r=Pn.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Ie.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{var a=Pn.simplify(t,i),l=a.length-1;n.initSideSegments(a[0],a[1],Ie.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment()},An.prototype.getSegGen=function(t){return new On(this._precisionModel,this._bufParams,t)},An.prototype.interfaces_=function(){return[]},An.prototype.getClass=function(){return An},An.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new E(t[n]);return e};var Dn=function(){this._subgraphs=null,this._seg=new gn,this._cga=new at;var t=arguments[0];this._subgraphs=t},Fn={DepthSegment:{configurable:!0}};Dn.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new bt,n=this._subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(L(arguments[2],wt)&&arguments[0]instanceof E&&arguments[1]instanceof Ue){for(var o=arguments[0],s=arguments[1],a=arguments[2],l=s.getEdge().getCoordinates(),u=0;u<l.length-1;u++)if(this._seg.p0=l[u],this._seg.p1=l[u+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||at.computeOrientation(this._seg.p0,this._seg.p1,o)===at.RIGHT)){var c=s.getDepth(Ie.LEFT);this._seg.p0.equals(l[u])||(c=s.getDepth(Ie.RIGHT));var h=new kn(this._seg,c);a.add(h)}}else if(L(arguments[2],wt)&&arguments[0]instanceof E&&L(arguments[1],wt))for(var p=arguments[0],f=arguments[1],d=arguments[2],g=f.iterator();g.hasNext();){var y=g.next();y.isForward()&&this.findStabbedSegments(p,y,d)}},Dn.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:$e.min(e)._leftDepth},Dn.prototype.interfaces_=function(){return[]},Dn.prototype.getClass=function(){return Dn},Fn.DepthSegment.get=function(){return kn},Object.defineProperties(Dn,Fn);var kn=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new gn(t),this._leftDepth=e};kn.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n||0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},kn.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},kn.prototype.toString=function(){return this._upwardSeg.toString()},kn.prototype.interfaces_=function(){return[C]},kn.prototype.getClass=function(){return kn};var Bn=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};Bn.prototype.area=function(){return Bn.area(this.p0,this.p1,this.p2)},Bn.prototype.signedArea=function(){return Bn.signedArea(this.p0,this.p1,this.p2)},Bn.prototype.interpolateZ=function(t){if(null===t)throw new _("Supplied point is null.");return Bn.interpolateZ(t,this.p0,this.p1,this.p2)},Bn.prototype.longestSideLength=function(){return Bn.longestSideLength(this.p0,this.p1,this.p2)},Bn.prototype.isAcute=function(){return Bn.isAcute(this.p0,this.p1,this.p2)},Bn.prototype.circumcentre=function(){return Bn.circumcentre(this.p0,this.p1,this.p2)},Bn.prototype.area3D=function(){return Bn.area3D(this.p0,this.p1,this.p2)},Bn.prototype.centroid=function(){return Bn.centroid(this.p0,this.p1,this.p2)},Bn.prototype.inCentre=function(){return Bn.inCentre(this.p0,this.p1,this.p2)},Bn.prototype.interfaces_=function(){return[]},Bn.prototype.getClass=function(){return Bn},Bn.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},Bn.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},Bn.det=function(t,e,n,i){return t*i-e*n},Bn.interpolateZ=function(t,e,n,i){var r=e.x,o=e.y,s=n.x-r,a=i.x-r,l=n.y-o,u=i.y-o,c=s*u-a*l,h=t.x-r,p=t.y-o,f=(u*h-a*p)/c,d=(-l*h+s*p)/c;return e.z+f*(n.z-e.z)+d*(i.z-e.z)},Bn.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),o=n.distance(t),s=i;return r>s&&(s=r),o>s&&(s=o),s},Bn.isAcute=function(t,e,n){return!!Ln.isAcute(t,e,n)&&!!Ln.isAcute(e,n,t)&&!!Ln.isAcute(n,t,e)},Bn.circumcentre=function(t,e,n){var i=n.x,r=n.y,o=t.x-i,s=t.y-r,a=e.x-i,l=e.y-r,u=2*Bn.det(o,s,a,l),c=Bn.det(s,o*o+s*s,l,a*a+l*l),h=Bn.det(o,o*o+s*s,a,a*a+l*l);return new E(i-c/u,r+h/u)},Bn.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y,r=new H(t.x+n/2,t.y+i/2,1),o=new H(t.x-i+n/2,t.y+n+i/2,1);return new H(r,o)},Bn.angleBisector=function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new E(t.x+r*o,t.y+r*s)},Bn.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,l=n.z-t.z,u=r*l-o*a,c=o*s-i*l,h=i*a-r*s,p=u*u+c*c+h*h;return Math.sqrt(p)/2},Bn.centroid=function(t,e,n){var i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new E(i,r)},Bn.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),o=t.distance(e),s=i+r+o,a=(i*t.x+r*e.x+o*n.x)/s,l=(i*t.y+r*e.y+o*n.y)/s;return new E(a,l)};var Gn=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new bt;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};Gn.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,S.EXTERIOR,S.INTERIOR)},Gn.prototype.addPolygon=function(t){var e=this._distance,n=Ie.LEFT;this._distance<0&&(e=-this._distance,n=Ie.RIGHT);var i=t.getExteriorRing(),r=Pt.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,S.EXTERIOR,S.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=Pt.removeRepeatedPoints(s.getCoordinates());this._distance>0&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,Ie.opposite(n),S.INTERIOR,S.EXTERIOR)}},Gn.prototype.isTriangleErodedCompletely=function(t,e){var n=new Bn(t[0],t[1],t[2]),i=n.inCentre();return at.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},Gn.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Pt.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,S.EXTERIOR,S.INTERIOR)},Gn.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var i=new dn(t,new Oe(0,S.BOUNDARY,e,n));this._curveList.add(i)},Gn.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Gn.prototype.addPolygonRing=function(t,e,n,i,r){if(0===e&&t.length<ee.MINIMUM_VALID_SIZE)return null;var o=i,s=r;t.length>=ee.MINIMUM_VALID_SIZE&&at.isCCW(t)&&(o=r,s=i,n=Ie.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},Gn.prototype.add=function(t){if(t.isEmpty())return null;t instanceof $t?this.addPolygon(t):t instanceof Kt?this.addLineString(t):t instanceof Jt?this.addPoint(t):(t instanceof te||t instanceof qt||t instanceof ne||t instanceof Ut)&&this.addCollection(t)},Gn.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r},Gn.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},Gn.prototype.interfaces_=function(){return[]},Gn.prototype.getClass=function(){return Gn};var jn=function(){};jn.prototype.locate=function(t){},jn.prototype.interfaces_=function(){return[]},jn.prototype.getClass=function(){return jn};var zn=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};zn.prototype.next=function(){if(this._atStart)return this._atStart=!1,zn.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new i;var t=this._parent.getGeometryN(this._index++);return t instanceof Ut?(this._subcollectionIterator=new zn(t),this._subcollectionIterator.next()):t},zn.prototype.remove=function(){throw new Error(this.getClass().getName())},zn.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},zn.prototype.interfaces_=function(){return[Ct]},zn.prototype.getClass=function(){return zn},zn.isAtomic=function(t){return!(t instanceof Ut)};var Un=function(){this._geom=null;var t=arguments[0];this._geom=t};Un.prototype.locate=function(t){return Un.locate(t,this._geom)},Un.prototype.interfaces_=function(){return[jn]},Un.prototype.getClass=function(){return Un},Un.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&at.isPointInRing(t,e.getCoordinates())},Un.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!Un.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(Un.isPointInRing(t,r))return!1}return!0},Un.containsPoint=function(t,e){if(e instanceof $t)return Un.containsPointInPolygon(t,e);if(e instanceof Ut)for(var n=new zn(e);n.hasNext();){var i=n.next();if(i!==e&&Un.containsPoint(t,i))return!0}return!1},Un.locate=function(t,e){return e.isEmpty()?S.EXTERIOR:Un.containsPoint(t,e)?S.INTERIOR:S.EXTERIOR};var qn=function(){this._edgeMap=new h,this._edgeList=null,this._ptInAreaLocation=[S.NONE,S.NONE]};qn.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},qn.prototype.propagateSideLabels=function(t){for(var e=S.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,Ie.LEFT)!==S.NONE&&(e=i.getLocation(t,Ie.LEFT))}if(e===S.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,Ie.ON)===S.NONE&&a.setLocation(t,Ie.ON,r),a.isArea(t)){var l=a.getLocation(t,Ie.LEFT),u=a.getLocation(t,Ie.RIGHT);if(u!==S.NONE){if(u!==r)throw new Se("side location conflict",s.getCoordinate());l===S.NONE&&et.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=l}else et.isTrue(a.getLocation(t,Ie.LEFT)===S.NONE,"found single null side"),a.setLocation(t,Ie.RIGHT,r),a.setLocation(t,Ie.LEFT,r)}}},qn.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},qn.prototype.print=function(t){V.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},qn.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},qn.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,Ie.LEFT);et.isTrue(i!==S.NONE,"Found unlabelled area edge");for(var r=i,o=this.iterator();o.hasNext();){var s=o.next().getLabel();et.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Ie.LEFT),l=s.getLocation(t,Ie.RIGHT);if(a===l)return!1;if(l!==r)return!1;r=a}return!0},qn.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},qn.prototype.iterator=function(){return this.getEdges().iterator()},qn.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new bt(this._edgeMap.values())),this._edgeList},qn.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===S.NONE&&(this._ptInAreaLocation[t]=Un.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},qn.prototype.toString=function(){var t=new R;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},qn.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},qn.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===S.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),l=0;l<2;l++)if(a.isAnyNull(l)){var u=S.NONE;if(e[l])u=S.EXTERIOR;else{var c=s.getCoordinate();u=this.getLocation(l,c,t)}a.setAllLocationsIfNull(l,u)}},qn.prototype.getDegree=function(){return this._edgeMap.size()},qn.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},qn.prototype.interfaces_=function(){return[]},qn.prototype.getClass=function(){return qn};var Vn=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var r=this._resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new Se("no outgoing dirEdge found",this.getCoordinate());et.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return Ge.isNorthern(r)&&Ge.isNorthern(o)?n:Ge.isNorthern(r)||Ge.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:(et.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},e.prototype.print=function(t){V.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new bt;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(Ie.LEFT),i=t.getDepth(Ie.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new Se("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[0],s=arguments[1],a=arguments[2],l=o;l<s;l++){var u=this._edgeList.get(l);u.setEdgeDepths(Ie.RIGHT,a),a=u.getDepth(Ie.LEFT)}return a}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,i=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;r>=0;r--){var o=this._resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(et.isTrue(null!==e,"found null for first outgoing dirEdge"),et.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],i=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===n&&i++;return i}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=S.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=S.INTERIOR;break}if(i.isInResult()){t=S.EXTERIOR;break}}}if(t===S.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===S.INTERIOR):(s.isInResult()&&(r=S.EXTERIOR),a.isInResult()&&(r=S.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new Oe(S.NONE);for(var n=this.iterator();n.hasNext();)for(var i=n.next().getEdge().getLabel(),r=0;r<2;r++){var o=i.getLocation(r);o!==S.INTERIOR&&o!==S.BOUNDARY||this._label.setLocation(r,S.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(qn),Hn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new ke(t,new Vn)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(qe),Yn=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Yn.prototype.compareTo=function(t){var e=t;return Yn.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Yn.prototype.interfaces_=function(){return[C]},Yn.prototype.getClass=function(){return Yn},Yn.orientation=function(t){return 1===Pt.increasingDirection(t)},Yn.compareOriented=function(t,e,n,i){for(var r=e?1:-1,o=i?1:-1,s=e?t.length:-1,a=i?n.length:-1,l=e?0:t.length-1,u=i?0:n.length-1;;){var c=t[l].compareTo(n[u]);if(0!==c)return c;var h=(l+=r)===s,p=(u+=o)===a;if(h&&!p)return-1;if(!h&&p)return 1;if(h&&p)return 0}};var Xn=function(){this._edges=new bt,this._ocaMap=new h};Xn.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)r>0&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},Xn.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Xn.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Xn.prototype.iterator=function(){return this._edges.iterator()},Xn.prototype.getEdges=function(){return this._edges},Xn.prototype.get=function(t){return this._edges.get(t)},Xn.prototype.findEqualEdge=function(t){var e=new Yn(t.getCoordinates());return this._ocaMap.get(e)},Xn.prototype.add=function(t){this._edges.add(t);var e=new Yn(t.getCoordinates());this._ocaMap.put(e,t)},Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn};var Wn=function(){};Wn.prototype.processIntersections=function(t,e,n,i){},Wn.prototype.isDone=function(){},Wn.prototype.interfaces_=function(){return[]},Wn.prototype.getClass=function(){return Wn};var Kn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Kn.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(Kn.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},Kn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Kn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Kn.prototype.getLineIntersector=function(){return this._li},Kn.prototype.hasProperIntersection=function(){return this._hasProper},Kn.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Kn.prototype.hasIntersection=function(){return this._hasIntersection},Kn.prototype.isDone=function(){return!1},Kn.prototype.hasInteriorIntersection=function(){return this._hasInterior},Kn.prototype.interfaces_=function(){return[Wn]},Kn.prototype.getClass=function(){return Kn},Kn.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Zn=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new E(t),this.segmentIndex=e,this.dist=n};Zn.prototype.getSegmentIndex=function(){return this.segmentIndex},Zn.prototype.getCoordinate=function(){return this.coord},Zn.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Zn.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},Zn.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Zn.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Zn.prototype.getDistance=function(){return this.dist},Zn.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Zn.prototype.interfaces_=function(){return[C]},Zn.prototype.getClass=function(){return Zn};var Jn=function(){this._nodeMap=new h,this.edge=null;var t=arguments[0];this.edge=t};Jn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Jn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Jn.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},Jn.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Jn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new E(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new ni(o,new Oe(this.edge._label))},Jn.prototype.add=function(t,e,n){var i=new Zn(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)},Jn.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Jn.prototype.interfaces_=function(){return[]},Jn.prototype.getClass=function(){return Jn};var Qn=function(){};Qn.prototype.getChainStartIndices=function(t){var e=0,n=new bt;n.add(new A(e));do{var i=this.findChainEnd(t,e);n.add(new A(i)),e=i}while(e<t.length-1);return Qn.toIntArray(n)},Qn.prototype.findChainEnd=function(t,e){for(var n=Ge.quadrant(t[e],t[e+1]),i=e+1;i<t.length&&Ge.quadrant(t[i-1],t[i])===n;)i++;return i-1},Qn.prototype.interfaces_=function(){return[]},Qn.prototype.getClass=function(){return Qn},Qn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var $n=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Y,this.env2=new Y;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Qn;this.startIndex=e.getChainStartIndices(this.pts)};$n.prototype.getCoordinates=function(){return this.pts},$n.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},$n.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},$n.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],l=arguments[4],u=arguments[5],c=this.pts[r],h=this.pts[o],p=s.pts[a],f=s.pts[l];if(o-r==1&&l-a==1)return u.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(c,h),this.env2.init(p,f),!this.env1.intersects(this.env2))return null;var d=Math.trunc((r+o)/2),g=Math.trunc((a+l)/2);r<d&&(a<g&&this.computeIntersectsForChain(r,d,s,a,g,u),g<l&&this.computeIntersectsForChain(r,d,s,g,l,u)),d<o&&(a<g&&this.computeIntersectsForChain(d,o,s,a,g,u),g<l&&this.computeIntersectsForChain(d,o,s,g,l,u))}},$n.prototype.getStartIndexes=function(){return this.startIndex},$n.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n};var ti=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},ei={NULL_VALUE:{configurable:!0}};ti.prototype.getDepth=function(t,e){return this._depth[t][e]},ti.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},ti.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==ti.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===ti.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._depth[i][r]===ti.NULL_VALUE}},ti.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}},ti.prototype.getDelta=function(t){return this._depth[t][Ie.RIGHT]-this._depth[t][Ie.LEFT]},ti.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?S.EXTERIOR:S.INTERIOR},ti.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},ti.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var i=t.getLocation(e,n);i!==S.EXTERIOR&&i!==S.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=ti.depthAtLocation(i):this._depth[e][n]+=ti.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],o=arguments[1];arguments[2]===S.INTERIOR&&this._depth[r][o]++}},ti.prototype.interfaces_=function(){return[]},ti.prototype.getClass=function(){return ti},ti.depthAtLocation=function(t){return t===S.EXTERIOR?0:t===S.INTERIOR?1:ti.NULL_VALUE},ei.NULL_VALUE.get=function(){return-1},Object.defineProperties(ti,ei);var ni=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Jn(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ti,this._depthDelta=0,1===arguments.length){var n=arguments[0];e.call(this,n,null)}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.pts=i,this._label=r}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,Oe.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var i=!0,r=!0,o=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(n.pts[s])||(i=!1),this.pts[s].equals2D(n.pts[--o])||(r=!1),!i&&!r)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new $n(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new Y;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,n,i){var r=new E(t.getIntersection(i)),o=e,s=t.getEdgeDistance(n,i),a=o+1;if(a<this.pts.length){var l=this.pts[a];r.equals2D(l)&&(o=a,s=0)}this.eiList.add(r,o,s)},e.prototype.toString=function(){var t=new R;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],n=arguments[1];n.setAtLeastIfValid(e.getLocation(0,Ie.ON),e.getLocation(1,Ie.ON),1),e.isArea()&&(n.setAtLeastIfValid(e.getLocation(0,Ie.LEFT),e.getLocation(1,Ie.LEFT),2),n.setAtLeastIfValid(e.getLocation(0,Ie.RIGHT),e.getLocation(1,Ie.RIGHT),2))},e}(Fe),ii=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Xn,this._bufParams=t||null};ii.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},ii.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Oe(t.getLabel())).flip(),n.merge(i);var r=ii.depthDelta(i),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(ii.depthDelta(t.getLabel()))},ii.prototype.buildSubgraphs=function(t,e){for(var n=new bt,i=t.iterator();i.hasNext();){var r=i.next(),o=r.getRightmostCoordinate(),s=new Dn(n).getDepth(o);r.computeDepth(s),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},ii.prototype.createSubgraphs=function(t){for(var e=new bt,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new Le;r.create(i),e.add(r)}}return $e.sort(e,$e.reverseOrder()),e},ii.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},ii.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new wn,n=new rt;return n.setPrecisionModel(t),e.setSegmentIntersector(new Kn(n)),e},ii.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new An(n,this._bufParams),r=new Gn(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new Ve(new Hn),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new He(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},ii.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new ni(r.getCoordinates(),new Oe(s));this.insertUniqueEdge(a)}}},ii.prototype.setNoder=function(t){this._workingNoder=t},ii.prototype.interfaces_=function(){return[]},ii.prototype.getClass=function(){return ii},ii.depthDelta=function(t){var e=t.getLocation(0,Ie.LEFT),n=t.getLocation(0,Ie.RIGHT);return e===S.INTERIOR&&n===S.EXTERIOR?1:e===S.EXTERIOR&&n===S.INTERIOR?-1:0},ii.convertSegStrings=function(t){for(var e=new me,n=new bt;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)};var ri=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=arguments[3];this._noder=n,this._scaleFactor=i,this._offsetX=r,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};ri.prototype.rescale=function(){if(L(arguments[0],xt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],i=0;i<n.length;i++)n[i].x=n[i].x/this._scaleFactor+this._offsetX,n[i].y=n[i].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&V.out.println(n)}},ri.prototype.scale=function(){if(L(arguments[0],xt)){for(var t=arguments[0],e=new bt,n=t.iterator();n.hasNext();){var i=n.next();e.add(new dn(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],o=new Array(r.length).fill(null),s=0;s<r.length;s++)o[s]=new E(Math.round((r[s].x-this._offsetX)*this._scaleFactor),Math.round((r[s].y-this._offsetY)*this._scaleFactor),r[s].z);return Pt.removeRepeatedPoints(o)}},ri.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},ri.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},ri.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},ri.prototype.interfaces_=function(){return[xn]},ri.prototype.getClass=function(){return ri};var oi=function(){this._li=new rt,this._segStrings=null;var t=arguments[0];this._segStrings=t},si={fact:{configurable:!0}};oi.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1].iterator();i.hasNext();)for(var r=i.next().getCoordinates(),o=1;o<r.length-1;o++)if(r[o].equals(n))throw new $("found endpt/interior pt intersection at index "+o+" :pt "+n)},oi.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=r.getCoordinates(),a=o.getCoordinates(),l=0;l<s.length-1;l++)for(var u=0;u<a.length-1;u++)this.checkInteriorIntersections(r,l,o,u);else if(4===arguments.length){var c=arguments[0],h=arguments[1],p=arguments[2],f=arguments[3];if(c===p&&h===f)return null;var d=c.getCoordinates()[h],g=c.getCoordinates()[h+1],y=p.getCoordinates()[f],m=p.getCoordinates()[f+1];if(this._li.computeIntersection(d,g,y,m),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,d,g)||this.hasInteriorIntersection(this._li,y,m)))throw new $("found non-noded intersection at "+d+"-"+g+" and "+y+"-"+m)}},oi.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},oi.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),i=0;i<n.length-2;i++)this.checkCollapse(n[i],n[i+1],n[i+2])},oi.prototype.hasInteriorIntersection=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},oi.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new $("found non-noded collapse at "+oi.fact.createLineString([t,e,n]))},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi},si.fact.get=function(){return new me},Object.defineProperties(oi,si);var ai=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new _("Scale factor must be non-zero");1!==e&&(this._pt=new E(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new E,this._p1Scaled=new E),this.initCorners(this._pt)},li={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};ai.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>i||this._maxy<r||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return et.isTrue(!(s&&a),"Found bad envelope test"),a},ai.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new E(this._maxx,this._maxy),this._corner[1]=new E(this._minx,this._maxy),this._corner[2]=new E(this._minx,this._miny),this._corner[3]=new E(this._maxx,this._miny)},ai.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},ai.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},ai.prototype.getCoordinate=function(){return this._originalPt},ai.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},ai.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=ai.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Y(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},ai.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},ai.prototype.intersectsToleranceSquare=function(t,e){var n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&i||t.equals(this._pt)||e.equals(this._pt)))))},ai.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai},li.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(ai,li);var ui=function(){this.tempEnv1=new Y,this.selectedSegment=new gn};ui.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui};var ci=function(){this._index=null;var t=arguments[0];this._index=t},hi={HotPixelSnapAction:{configurable:!0}};ci.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),o=new pi(e,n,i);return this._index.query(r,{interfaces_:function(){return[Ke]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},ci.prototype.interfaces_=function(){return[]},ci.prototype.getClass=function(){return ci},hi.HotPixelSnapAction.get=function(){return pi},Object.defineProperties(ci,hi);var pi=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._hotPixel=e,this._parentEdge=n,this._hotPixelVertexIndex=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[0],n=arguments[1],i=e.getContext();if(null!==this._parentEdge&&i===this._parentEdge&&n===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(i,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ui),fi=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new bt};fi.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}},fi.prototype.isDone=function(){return!1},fi.prototype.getInteriorIntersections=function(){return this._interiorIntersections},fi.prototype.interfaces_=function(){return[Wn]},fi.prototype.getClass=function(){return fi};var di=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new rt,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};di.prototype.checkCorrectness=function(t){var e=dn.getNodedSubstrings(t),n=new oi(e);try{n.checkValid()}catch(t){if(!(t instanceof U))throw t;t.printStackTrace()}},di.prototype.getNodedSubstrings=function(){return dn.getNodedSubstrings(this._nodedSegStrings)},di.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},di.prototype.findInteriorIntersections=function(t,e){var n=new fi(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},di.prototype.computeVertexSnaps=function(){if(L(arguments[0],xt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof dn)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var o=new ai(i[r],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,r)&&n.addIntersection(i[r],r)}},di.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new wn,this._pointSnapper=new ci(this._noder.getIndex()),this.snapRound(t,this._li)},di.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new ai(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}},di.prototype.interfaces_=function(){return[xn]},di.prototype.getClass=function(){return di};var gi=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new En,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},yi={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};gi.prototype.bufferFixedPrecision=function(t){var e=new ri(new di(new fe(1)),t.getScale()),n=new ii(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},gi.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=gi.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof Se))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],i=gi.precisionScaleFactor(this._argGeom,this._distance,n),r=new fe(i);this.bufferFixedPrecision(r)}},gi.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===fe.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},gi.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},gi.prototype.bufferOriginalPrecision=function(){try{var t=new ii(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof $))throw t;this._saveException=t}},gi.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},gi.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},gi.prototype.interfaces_=function(){return[]},gi.prototype.getClass=function(){return gi},gi.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new gi(t).getResultGeometry(e)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1],r=arguments[2],o=new gi(n);return o.setQuadrantSegments(r),o.getResultGeometry(i)}if(arguments[2]instanceof En&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var s=arguments[0],a=arguments[1],l=arguments[2];return new gi(s,l).getResultGeometry(a)}}else if(4===arguments.length){var u=arguments[0],c=arguments[1],h=arguments[2],p=arguments[3],f=new gi(u);return f.setQuadrantSegments(h),f.setEndCapStyle(p),f.getResultGeometry(c)}},gi.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=M.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},yi.CAP_ROUND.get=function(){return En.CAP_ROUND},yi.CAP_BUTT.get=function(){return En.CAP_FLAT},yi.CAP_FLAT.get=function(){return En.CAP_FLAT},yi.CAP_SQUARE.get=function(){return En.CAP_SQUARE},yi.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(gi,yi);var mi=function(){this._pt=[new E,new E],this._distance=v.NaN,this._isNull=!0};mi.prototype.getCoordinates=function(){return this._pt},mi.prototype.getCoordinate=function(t){return this._pt[t]},mi.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},mi.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},mi.prototype.getDistance=function(){return this._distance},mi.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi};var _i=function(){};_i.prototype.interfaces_=function(){return[]},_i.prototype.getClass=function(){return _i},_i.computeDistance=function(){if(arguments[2]instanceof mi&&arguments[0]instanceof Kt&&arguments[1]instanceof E)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=t.getCoordinates(),r=new gn,o=0;o<i.length-1;o++){r.setCoordinates(i[o],i[o+1]);var s=r.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof mi&&arguments[0]instanceof $t&&arguments[1]instanceof E){var a=arguments[0],l=arguments[1],u=arguments[2];_i.computeDistance(a.getExteriorRing(),l,u);for(var c=0;c<a.getNumInteriorRing();c++)_i.computeDistance(a.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof mi&&arguments[0]instanceof ct&&arguments[1]instanceof E){var h=arguments[0],p=arguments[1],f=arguments[2];if(h instanceof Kt)_i.computeDistance(h,p,f);else if(h instanceof $t)_i.computeDistance(h,p,f);else if(h instanceof Ut)for(var d=h,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);_i.computeDistance(y,p,f)}else f.setMinimum(h.getCoordinate(),p)}else if(arguments[2]instanceof mi&&arguments[0]instanceof gn&&arguments[1]instanceof E){var m=arguments[0],_=arguments[1],v=arguments[2],x=m.closestPoint(_);v.setMinimum(x,_)}};var vi=function(t){this._maxPtDist=new mi,this._inputGeom=t||null},xi={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};vi.prototype.computeMaxMidpointDistance=function(t){var e=new wi(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},vi.prototype.computeMaxVertexDistance=function(t){var e=new Ci(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},vi.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},vi.prototype.getDistancePoints=function(){return this._maxPtDist},vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi},xi.MaxPointDistanceFilter.get=function(){return Ci},xi.MaxMidpointDistanceFilter.get=function(){return wi},Object.defineProperties(vi,xi);var Ci=function(t){this._maxPtDist=new mi,this._minPtDist=new mi,this._geom=t||null};Ci.prototype.filter=function(t){this._minPtDist.initialize(),_i.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Ci.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ci.prototype.interfaces_=function(){return[ft]},Ci.prototype.getClass=function(){return Ci};var wi=function(t){this._maxPtDist=new mi,this._minPtDist=new mi,this._geom=t||null};wi.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=new E((n.x+i.x)/2,(n.y+i.y)/2);this._minPtDist.initialize(),_i.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},wi.prototype.isDone=function(){return!1},wi.prototype.isGeometryChanged=function(){return!1},wi.prototype.getMaxPointDistance=function(){return this._maxPtDist},wi.prototype.interfaces_=function(){return[zt]},wi.prototype.getClass=function(){return wi};var bi=function(t){this._comps=t||null};bi.prototype.filter=function(t){t instanceof $t&&this._comps.add(t)},bi.prototype.interfaces_=function(){return[jt]},bi.prototype.getClass=function(){return bi},bi.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return bi.getPolygons(t,new bt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof $t?n.add(e):e instanceof Ut&&e.apply(new bi(n)),n}};var Ei=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};Ei.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ee){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Kt&&this._lines.add(t)},Ei.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},Ei.prototype.interfaces_=function(){return[ut]},Ei.prototype.getClass=function(){return Ei},Ei.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(Ei.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(Ei.getLines(e,n))}},Ei.getLines=function(){if(1===arguments.length){var t=arguments[0];return Ei.getLines(t,!1)}if(2===arguments.length){if(L(arguments[0],xt)&&L(arguments[1],xt)){for(var e=arguments[0],n=arguments[1],i=e.iterator();i.hasNext();){var r=i.next();Ei.getLines(r,n)}return n}if(arguments[0]instanceof ct&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1],a=new bt;return o.apply(new Ei(a,s)),a}if(arguments[0]instanceof ct&&L(arguments[1],xt)){var l=arguments[0],u=arguments[1];return l instanceof Kt?u.add(l):l.apply(new Ei(u)),u}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&L(arguments[0],xt)&&L(arguments[1],xt)){for(var c=arguments[0],h=arguments[1],p=arguments[2],f=c.iterator();f.hasNext();){var d=f.next();Ei.getLines(d,h,p)}return h}if("boolean"==typeof arguments[2]&&arguments[0]instanceof ct&&L(arguments[1],xt)){var g=arguments[0],y=arguments[1],m=arguments[2];return g.apply(new Ei(y,m)),y}}};var Ii=function(){if(this._boundaryRule=dt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new _("Rule must be non-null");this._boundaryRule=t}};Ii.prototype.locateInternal=function(){if(arguments[0]instanceof E&&arguments[1]instanceof $t){var t=arguments[0],e=arguments[1];if(e.isEmpty())return S.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===S.EXTERIOR)return S.EXTERIOR;if(i===S.BOUNDARY)return S.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r),s=this.locateInPolygonRing(t,o);if(s===S.INTERIOR)return S.EXTERIOR;if(s===S.BOUNDARY)return S.BOUNDARY}return S.INTERIOR}if(arguments[0]instanceof E&&arguments[1]instanceof Kt){var a=arguments[0],l=arguments[1];if(!l.getEnvelopeInternal().intersects(a))return S.EXTERIOR;var u=l.getCoordinates();return l.isClosed()||!a.equals(u[0])&&!a.equals(u[u.length-1])?at.isOnLine(a,u)?S.INTERIOR:S.EXTERIOR:S.BOUNDARY}if(arguments[0]instanceof E&&arguments[1]instanceof Jt){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?S.INTERIOR:S.EXTERIOR}},Ii.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?at.locatePointInRing(t,e.getCoordinates()):S.EXTERIOR},Ii.prototype.intersects=function(t,e){return this.locate(t,e)!==S.EXTERIOR},Ii.prototype.updateLocationInfo=function(t){t===S.INTERIOR&&(this._isIn=!0),t===S.BOUNDARY&&this._numBoundaries++},Ii.prototype.computeLocation=function(t,e){if(e instanceof Jt&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Kt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof $t)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof qt)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof ne)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof Ut)for(var l=new zn(e);l.hasNext();){var u=l.next();u!==e&&this.computeLocation(t,u)}},Ii.prototype.locate=function(t,e){return e.isEmpty()?S.EXTERIOR:e instanceof Kt||e instanceof $t?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?S.BOUNDARY:this._numBoundaries>0||this._isIn?S.INTERIOR:S.EXTERIOR)},Ii.prototype.interfaces_=function(){return[]},Ii.prototype.getClass=function(){return Ii};var Pi=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var e=arguments[0],n=arguments[1];t.call(this,e,t.INSIDE_AREA,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._component=i,this._segIndex=r,this._pt=o}},Ni={INSIDE_AREA:{configurable:!0}};Pi.prototype.isInsideArea=function(){return this._segIndex===Pi.INSIDE_AREA},Pi.prototype.getCoordinate=function(){return this._pt},Pi.prototype.getGeometryComponent=function(){return this._component},Pi.prototype.getSegmentIndex=function(){return this._segIndex},Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi},Ni.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Pi,Ni);var Si=function(t){this._pts=t||null};Si.prototype.filter=function(t){t instanceof Jt&&this._pts.add(t)},Si.prototype.interfaces_=function(){return[jt]},Si.prototype.getClass=function(){return Si},Si.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Jt?$e.singletonList(t):Si.getPoints(t,new bt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Jt?n.add(e):e instanceof Ut&&e.apply(new Si(n)),n}};var Ti=function(){this._locations=null;var t=arguments[0];this._locations=t};Ti.prototype.filter=function(t){(t instanceof Jt||t instanceof Kt||t instanceof $t)&&this._locations.add(new Pi(t,0,t.getCoordinate()))},Ti.prototype.interfaces_=function(){return[jt]},Ti.prototype.getClass=function(){return Ti},Ti.getLocations=function(t){var e=new bt;return t.apply(new Ti(e)),e};var Li=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Ii,this._minDistanceLocation=null,this._minDistance=v.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=i,this._terminateDistance=r}};Li.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=bi.getPolygons(this._geom[e]);if(r.size()>0){var o=Ti.getLocations(this._geom[i]);if(this.computeContainmentDistance(o,r,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&L(arguments[0],wt)&&L(arguments[1],wt)){for(var s=arguments[0],a=arguments[1],l=arguments[2],u=0;u<s.size();u++)for(var c=s.get(u),h=0;h<a.size();h++)if(this.computeContainmentDistance(c,a.get(h),l),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Pi&&arguments[1]instanceof $t){var p=arguments[0],f=arguments[1],d=arguments[2],g=p.getCoordinate();if(S.EXTERIOR!==this._ptLocator.locate(g,f))return this._minDistance=0,d[0]=p,d[1]=new Pi(f,g),null}},Li.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Li.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=Ei.getLines(this._geom[0]),n=Ei.getLines(this._geom[1]),i=Si.getPoints(this._geom[0]),r=Si.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},Li.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Li.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},Li.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Li.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Kt&&arguments[1]instanceof Jt){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),o=0;o<i.length-1;o++){var s=at.distancePointLine(r,i[o],i[o+1]);if(s<this._minDistance){this._minDistance=s;var a=new gn(i[o],i[o+1]).closestPoint(r);n[0]=new Pi(t,o,a),n[1]=new Pi(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Kt&&arguments[1]instanceof Kt){var l=arguments[0],u=arguments[1],c=arguments[2];if(l.getEnvelopeInternal().distance(u.getEnvelopeInternal())>this._minDistance)return null;for(var h=l.getCoordinates(),p=u.getCoordinates(),f=0;f<h.length-1;f++)for(var d=0;d<p.length-1;d++){var g=at.distanceLineLine(h[f],h[f+1],p[d],p[d+1]);if(g<this._minDistance){this._minDistance=g;var y=new gn(h[f],h[f+1]),m=new gn(p[d],p[d+1]),_=y.closestPoints(m);c[0]=new Pi(l,f,_[0]),c[1]=new Pi(u,d,_[1])}if(this._minDistance<=this._terminateDistance)return null}}},Li.prototype.computeMinDistancePoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o),a=r.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new Pi(r,0,r.getCoordinate()),n[1]=new Pi(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Li.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new _("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Li.prototype.computeMinDistanceLines=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li},Li.distance=function(t,e){return new Li(t,e).distance()},Li.isWithinDistance=function(t,e,n){return new Li(t,e,n).distance()<=n},Li.nearestPoints=function(t,e){return new Li(t,e).nearestPoints()};var Mi=function(){this._pt=[new E,new E],this._distance=v.NaN,this._isNull=!0};Mi.prototype.getCoordinates=function(){return this._pt},Mi.prototype.getCoordinate=function(t){return this._pt[t]},Mi.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},Mi.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},Mi.prototype.toString=function(){return Q.toLineString(this._pt[0],this._pt[1])},Mi.prototype.getDistance=function(){return this._distance},Mi.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},Mi.prototype.interfaces_=function(){return[]},Mi.prototype.getClass=function(){return Mi};var Oi=function(){};Oi.prototype.interfaces_=function(){return[]},Oi.prototype.getClass=function(){return Oi},Oi.computeDistance=function(){if(arguments[2]instanceof Mi&&arguments[0]instanceof Kt&&arguments[1]instanceof E)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=new gn,r=t.getCoordinates(),o=0;o<r.length-1;o++){i.setCoordinates(r[o],r[o+1]);var s=i.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Mi&&arguments[0]instanceof $t&&arguments[1]instanceof E){var a=arguments[0],l=arguments[1],u=arguments[2];Oi.computeDistance(a.getExteriorRing(),l,u);for(var c=0;c<a.getNumInteriorRing();c++)Oi.computeDistance(a.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof Mi&&arguments[0]instanceof ct&&arguments[1]instanceof E){var h=arguments[0],p=arguments[1],f=arguments[2];if(h instanceof Kt)Oi.computeDistance(h,p,f);else if(h instanceof $t)Oi.computeDistance(h,p,f);else if(h instanceof Ut)for(var d=h,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);Oi.computeDistance(y,p,f)}else f.setMinimum(h.getCoordinate(),p)}else if(arguments[2]instanceof Mi&&arguments[0]instanceof gn&&arguments[1]instanceof E){var m=arguments[0],_=arguments[1],v=arguments[2],x=m.closestPoint(_);v.setMinimum(x,_)}};var Ri=function(){this._g0=null,this._g1=null,this._ptDist=new Mi,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},Ai={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Ri.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Ri.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new _("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Ri.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Ri.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Ri.prototype.computeOrientedDistance=function(t,e,n){var i=new Di(e);if(t.apply(i),n.setMaximum(i.getMaxPointDistance()),this._densifyFrac>0){var r=new Fi(e,this._densifyFrac);t.apply(r),n.setMaximum(r.getMaxPointDistance())}},Ri.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Ri.prototype.interfaces_=function(){return[]},Ri.prototype.getClass=function(){return Ri},Ri.distance=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Ri(t,e).distance()}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new Ri(n,i);return o.setDensifyFraction(r),o.distance()}},Ai.MaxPointDistanceFilter.get=function(){return Di},Ai.MaxDensifiedByFractionDistanceFilter.get=function(){return Fi},Object.defineProperties(Ri,Ai);var Di=function(){this._maxPtDist=new Mi,this._minPtDist=new Mi,this._euclideanDist=new Oi,this._geom=null;var t=arguments[0];this._geom=t};Di.prototype.filter=function(t){this._minPtDist.initialize(),Oi.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Di.prototype.getMaxPointDistance=function(){return this._maxPtDist},Di.prototype.interfaces_=function(){return[ft]},Di.prototype.getClass=function(){return Di};var Fi=function(){this._maxPtDist=new Mi,this._minPtDist=new Mi,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};Fi.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=(i.x-n.x)/this._numSubSegs,o=(i.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=n.x+s*r,l=n.y+s*o,u=new E(a,l);this._minPtDist.initialize(),Oi.computeDistance(this._geom,u,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Fi.prototype.isDone=function(){return!1},Fi.prototype.isGeometryChanged=function(){return!1},Fi.prototype.getMaxPointDistance=function(){return this._maxPtDist},Fi.prototype.interfaces_=function(){return[zt]},Fi.prototype.getClass=function(){return Fi};var ki=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},Bi={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};ki.prototype.checkMaximumDistance=function(t,e,n){var i=new Ri(e,t);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var r=i.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Q.toLineString(r[0],r[1])+")"}},ki.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=ki.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),ki.VERBOSE&&V.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},ki.prototype.checkNegativeValid=function(){if(!(this._input instanceof $t||this._input instanceof ne||this._input instanceof Ut))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},ki.prototype.getErrorIndicator=function(){return this._errorIndicator},ki.prototype.checkMinimumDistance=function(t,e,n){var i=new Li(t,e,n);if(this._minDistanceFound=i.distance(),this._minDistanceFound<n){this._isValid=!1;var r=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Q.toLineString(r[0],r[1])+" )"}},ki.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},ki.prototype.getErrorLocation=function(){return this._errorLocation},ki.prototype.getPolygonLines=function(t){for(var e=new bt,n=new Ei(e),i=bi.getPolygons(t).iterator();i.hasNext();)i.next().apply(n);return t.getFactory().buildGeometry(e)},ki.prototype.getErrorMessage=function(){return this._errMsg},ki.prototype.interfaces_=function(){return[]},ki.prototype.getClass=function(){return ki},Bi.VERBOSE.get=function(){return!1},Bi.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ki,Bi);var Gi=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},ji={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Gi.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Gi.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Gi.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new Y(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new Y(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},Gi.prototype.checkDistance=function(){var t=new ki(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},Gi.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Gi.prototype.checkPolygonal=function(){this._result instanceof $t||this._result instanceof ne||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Gi.prototype.getErrorIndicator=function(){return this._errorIndicator},Gi.prototype.getErrorLocation=function(){return this._errorLocation},Gi.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Gi.prototype.report=function(t){if(!Gi.VERBOSE)return null;V.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},Gi.prototype.getErrorMessage=function(){return this._errorMsg},Gi.prototype.interfaces_=function(){return[]},Gi.prototype.getClass=function(){return Gi},Gi.isValidMsg=function(t,e,n){var i=new Gi(t,e,n);return i.isValid()?null:i.getErrorMessage()},Gi.isValid=function(t,e,n){return!!new Gi(t,e,n).isValid()},ji.VERBOSE.get=function(){return!1},ji.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Gi,ji);var zi=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};zi.prototype.getCoordinates=function(){return this._pts},zi.prototype.size=function(){return this._pts.length},zi.prototype.getCoordinate=function(t){return this._pts[t]},zi.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},zi.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:hn.octant(this.getCoordinate(t),this.getCoordinate(t+1))},zi.prototype.setData=function(t){this._data=t},zi.prototype.getData=function(){return this._data},zi.prototype.toString=function(){return Q.toLineString(new le(this._pts))},zi.prototype.interfaces_=function(){return[pn]},zi.prototype.getClass=function(){return zi};var Ui=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new bt,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Ui.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Ui.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},Ui.prototype.getIntersectionSegments=function(){return this._intSegments},Ui.prototype.count=function(){return this._intersectionCount},Ui.prototype.getIntersections=function(){return this._intersections},Ui.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Ui.prototype.setKeepIntersections=function(t){this._keepIntersections=t},Ui.prototype.processIntersections=function(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,i))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Ui.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},Ui.prototype.hasIntersection=function(){return null!==this._interiorIntersection},Ui.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},Ui.prototype.interfaces_=function(){return[Wn]},Ui.prototype.getClass=function(){return Ui},Ui.createAllIntersectionsFinder=function(t){var e=new Ui(t);return e.setFindAllIntersections(!0),e},Ui.createAnyIntersectionFinder=function(t){return new Ui(t)},Ui.createIntersectionCounter=function(t){var e=new Ui(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var qi=function(){this._li=new rt,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};qi.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},qi.prototype.getIntersections=function(){return this._segInt.getIntersections()},qi.prototype.isValid=function(){return this.execute(),this._isValid},qi.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},qi.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Ui(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new wn;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},qi.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Se(this.getErrorMessage(),this._segInt.getInteriorIntersection())},qi.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Q.toLineString(t[0],t[1])+" and "+Q.toLineString(t[2],t[3])},qi.prototype.interfaces_=function(){return[]},qi.prototype.getClass=function(){return qi},qi.computeIntersections=function(t){var e=new qi(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var Vi=function t(){this._nv=null;var e=arguments[0];this._nv=new qi(t.toSegmentStrings(e))};Vi.prototype.checkValid=function(){this._nv.checkValid()},Vi.prototype.interfaces_=function(){return[]},Vi.prototype.getClass=function(){return Vi},Vi.toSegmentStrings=function(t){for(var e=new bt,n=t.iterator();n.hasNext();){var i=n.next();e.add(new zi(i.getCoordinates(),i))}return e},Vi.checkValid=function(t){new Vi(t).checkValid()};var Hi=function(t){this._mapOp=t};Hi.prototype.map=function(t){for(var e=new bt,n=0;n<t.getNumGeometries();n++){var i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(me.toGeometryArray(e))},Hi.prototype.interfaces_=function(){return[]},Hi.prototype.getClass=function(){return Hi},Hi.map=function(t,e){return new Hi(e).map(t)};var Yi=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new bt,this._resultLineList=new bt;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};Yi.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},Yi.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},Yi.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Yi.prototype.collectLineEdge=function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Pr.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},Yi.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},Yi.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},Yi.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(i),n.setInResult(!0)}},Yi.prototype.collectBoundaryTouchEdge=function(t,e,n){var i=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(et.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Pr.isResultOfOp(i,e)&&e===Pr.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},Yi.prototype.interfaces_=function(){return[]},Yi.prototype.getClass=function(){return Yi};var Xi=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new bt;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Xi.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Xi.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==Pr.INTERSECTION)){var i=n.getLabel();Pr.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},Xi.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Xi.prototype.interfaces_=function(){return[]},Xi.prototype.getClass=function(){return Xi};var Wi=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Wi.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Wi.prototype.transformPolygon=function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof ee&&!i.isEmpty()||(n=!1);for(var r=new bt,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof ee||(n=!1),r.add(s))}if(n)return this._factory.createPolygon(i,r.toArray([]));var a=new bt;return null!==i&&a.add(i),a.addAll(r),this._factory.buildGeometry(a)},Wi.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Wi.prototype.getInputGeometry=function(){return this._inputGeom},Wi.prototype.transformMultiLineString=function(t,e){for(var n=new bt,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Wi.prototype.transformCoordinates=function(t,e){return this.copy(t)},Wi.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Wi.prototype.transformMultiPoint=function(t,e){for(var n=new bt,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Wi.prototype.transformMultiPolygon=function(t,e){for(var n=new bt,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Wi.prototype.copy=function(t){return t.copy()},Wi.prototype.transformGeometryCollection=function(t,e){for(var n=new bt,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(me.toGeometryArray(n)):this._factory.buildGeometry(n)},Wi.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Jt)return this.transformPoint(t,null);if(t instanceof te)return this.transformMultiPoint(t,null);if(t instanceof ee)return this.transformLinearRing(t,null);if(t instanceof Kt)return this.transformLineString(t,null);if(t instanceof qt)return this.transformMultiLineString(t,null);if(t instanceof $t)return this.transformPolygon(t,null);if(t instanceof ne)return this.transformMultiPolygon(t,null);if(t instanceof Ut)return this.transformGeometryCollection(t,null);throw new _("Unknown Geometry subtype: "+t.getClass().getName())},Wi.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var i=n.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},Wi.prototype.interfaces_=function(){return[]},Wi.prototype.getClass=function(){return Wi};var Ki=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new gn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Kt&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];t.call(this,e.getCoordinates(),n)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var i=arguments[0],r=arguments[1];this._srcPts=i,this._isClosed=t.isClosed(i),this._snapTolerance=r}};Ki.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;i<n;i++){var r=t.get(i),o=this.findSnapForVertex(r,e);null!==o&&(t.set(i,new E(o)),0===i&&this._isClosed&&t.set(t.size()-1,new E(o)))}},Ki.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},Ki.prototype.snapTo=function(t){var e=new It(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Ki.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;i<n;i++){var r=e[i],o=this.findSegmentIndexToSnap(r,t);o>=0&&t.add(o+1,new E(r),!1)}},Ki.prototype.findSegmentIndexToSnap=function(t,e){for(var n=v.MAX_VALUE,i=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,i=r)}return i},Ki.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Ki.prototype.interfaces_=function(){return[]},Ki.prototype.getClass=function(){return Ki},Ki.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var Zi=function(t){this._srcGeom=t||null},Ji={SNAP_PRECISION_FACTOR:{configurable:!0}};Zi.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new Qi(e,n).transform(this._srcGeom)},Zi.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),i=new Qi(t,n,!0).transform(this._srcGeom),r=i;return e&&L(r,Qt)&&(r=i.buffer(0)),r},Zi.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},Zi.prototype.extractTargetCoordinates=function(t){for(var e=new f,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},Zi.prototype.computeMinimumSegmentLength=function(t){for(var e=v.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);i<e&&(e=i)}return e},Zi.prototype.interfaces_=function(){return[]},Zi.prototype.getClass=function(){return Zi},Zi.snap=function(t,e,n){var i=new Array(2).fill(null),r=new Zi(t);i[0]=r.snapTo(e,n);var o=new Zi(e);return i[1]=o.snapTo(i[0],n),i},Zi.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=Zi.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===fe.FIXED){var i=1/n.getScale()*2/1.415;i>e&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min(Zi.computeOverlaySnapTolerance(r),Zi.computeOverlaySnapTolerance(o))}},Zi.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Zi.SNAP_PRECISION_FACTOR},Zi.snapToSelf=function(t,e,n){return new Zi(t).snapToSelf(e,n)},Ji.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Zi,Ji);var Qi=function(t){function e(e,n,i){t.call(this),this._snapTolerance=e||null,this._snapPts=n||null,this._isSelfSnap=void 0!==i&&i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var n=new Ki(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Wi),$i=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};$i.prototype.getCommon=function(){return v.longBitsToDouble(this._commonBits)},$i.prototype.add=function(t){var e=v.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=$i.signExpBits(this._commonBits),this._isFirst=!1,null):$i.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=$i.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=$i.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},$i.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=v.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+v.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}},$i.prototype.interfaces_=function(){return[]},$i.prototype.getClass=function(){return $i},$i.getBit=function(t,e){return 0!=(t&1<<e)?1:0},$i.signExpBits=function(t){return t>>52},$i.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},$i.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;i>=0;i--){if($i.getBit(t,i)!==$i.getBit(e,i))return n;n++}return 52};var tr=function(){this._commonCoord=null,this._ccFilter=new nr},er={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};tr.prototype.addCommonBits=function(t){var e=new ir(this._commonCoord);t.apply(e),t.geometryChanged()},tr.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new E(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new ir(e);return t.apply(n),t.geometryChanged(),t},tr.prototype.getCommonCoordinate=function(){return this._commonCoord},tr.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},er.CommonCoordinateFilter.get=function(){return nr},er.Translater.get=function(){return ir},Object.defineProperties(tr,er);var nr=function(){this._commonBitsX=new $i,this._commonBitsY=new $i};nr.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},nr.prototype.getCommonCoordinate=function(){return new E(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},nr.prototype.interfaces_=function(){return[ft]},nr.prototype.getClass=function(){return nr};var ir=function(){this.trans=null;var t=arguments[0];this.trans=t};ir.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},ir.prototype.isDone=function(){return!1},ir.prototype.isGeometryChanged=function(){return!0},ir.prototype.interfaces_=function(){return[zt]},ir.prototype.getClass=function(){return ir};var rr=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};rr.prototype.selfSnap=function(t){return new Zi(t).snapTo(t,this._snapTolerance)},rr.prototype.removeCommonBits=function(t){this._cbr=new tr,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},rr.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},rr.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=Pr.overlayOp(e[0],e[1],t);return this.prepareResult(n)},rr.prototype.checkValid=function(t){t.isValid()||V.out.println("Snapped geometry is invalid")},rr.prototype.computeSnapTolerance=function(){this._snapTolerance=Zi.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},rr.prototype.snap=function(t){var e=this.removeCommonBits(t);return Zi.snap(e[0],e[1],this._snapTolerance)},rr.prototype.interfaces_=function(){return[]},rr.prototype.getClass=function(){return rr},rr.overlayOp=function(t,e,n){return new rr(t,e).getResultGeometry(n)},rr.union=function(t,e){return rr.overlayOp(t,e,Pr.UNION)},rr.intersection=function(t,e){return rr.overlayOp(t,e,Pr.INTERSECTION)},rr.symDifference=function(t,e){return rr.overlayOp(t,e,Pr.SYMDIFFERENCE)},rr.difference=function(t,e){return rr.overlayOp(t,e,Pr.DIFFERENCE)};var or=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};or.prototype.getResultGeometry=function(t){var e=null,n=!1,i=null;try{e=Pr.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof $))throw t;i=t}if(!n)try{e=rr.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof $?i:t}return e},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or},or.overlayOp=function(t,e,n){return new or(t,e).getResultGeometry(n)},or.union=function(t,e){return or.overlayOp(t,e,Pr.UNION)},or.intersection=function(t,e){return or.overlayOp(t,e,Pr.INTERSECTION)},or.symDifference=function(t,e){return or.overlayOp(t,e,Pr.SYMDIFFERENCE)},or.difference=function(t,e){return or.overlayOp(t,e,Pr.DIFFERENCE)};var sr=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};sr.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},sr.prototype.interfaces_=function(){return[]},sr.prototype.getClass=function(){return sr};var ar=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=i,this._xValue=r,this._obj=o}},lr={INSERT:{configurable:!0},DELETE:{configurable:!0}};ar.prototype.isDelete=function(){return this._eventType===ar.DELETE},ar.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},ar.prototype.getObject=function(){return this._obj},ar.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},ar.prototype.getInsertEvent=function(){return this._insertEvent},ar.prototype.isInsert=function(){return this._eventType===ar.INSERT},ar.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},ar.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},ar.prototype.interfaces_=function(){return[C]},ar.prototype.getClass=function(){return ar},lr.INSERT.get=function(){return 1},lr.DELETE.get=function(){return 2},Object.defineProperties(ar,lr);var ur=function(){};ur.prototype.interfaces_=function(){return[]},ur.prototype.getClass=function(){return ur};var cr=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};cr.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(cr.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},cr.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},cr.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},cr.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},cr.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1},cr.prototype.hasProperIntersection=function(){return this._hasProper},cr.prototype.hasIntersection=function(){return this._hasIntersection},cr.prototype.isDone=function(){return this._isDone},cr.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},cr.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},cr.prototype.addIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr},cr.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var hr=function(t){function e(){t.call(this),this.events=new bt,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){$e.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof cr&&L(arguments[0],wt)&&L(arguments[1],wt)){var i=arguments[0],r=arguments[1],o=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&L(arguments[0],wt)&&arguments[1]instanceof cr){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var o=new sr(n,r),s=new ar(e,n.getMinX(r),o);this.events.add(s),this.events.add(new ar(n.getMaxX(r),s))}},e.prototype.processOverlaps=function(t,e,n,i){for(var r=n.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(r.computeIntersections(a,i),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();){var o=r.next();this.addEdge(o,i)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ur),pr=function(){this._min=v.POSITIVE_INFINITY,this._max=v.NEGATIVE_INFINITY},fr={NodeComparator:{configurable:!0}};pr.prototype.getMin=function(){return this._min},pr.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},pr.prototype.getMax=function(){return this._max},pr.prototype.toString=function(){return Q.toLineString(new E(this._min,0),new E(this._max,0))},pr.prototype.interfaces_=function(){return[]},pr.prototype.getClass=function(){return pr},fr.NodeComparator.get=function(){return dr},Object.defineProperties(pr,fr);var dr=function(){};dr.prototype.compare=function(t,e){var n=t,i=e,r=(n._min+n._max)/2,o=(i._min+i._max)/2;return r<o?-1:r>o?1:0},dr.prototype.interfaces_=function(){return[b]},dr.prototype.getClass=function(){return dr};var gr=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],n=arguments[1],i=arguments[2];this._min=e,this._max=n,this._item=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(pr),yr=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],n=arguments[1];this._node1=e,this._node2=n,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(pr),mr=function(){this._leaves=new bt,this._root=null,this._level=0};mr.prototype.buildTree=function(){$e.sort(this._leaves,new pr.NodeComparator);for(var t=this._leaves,e=null,n=new bt;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},mr.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new gr(t,e,n))},mr.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},mr.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},mr.prototype.printNode=function(t){V.out.println(Q.toLineString(new E(t._min,this._level),new E(t._max,this._level)))},mr.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},mr.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new yr(t.get(n),t.get(n+1));e.add(r)}}},mr.prototype.interfaces_=function(){return[]},mr.prototype.getClass=function(){return mr};var _r=function(){this._items=new bt};_r.prototype.visitItem=function(t){this._items.add(t)},_r.prototype.getItems=function(){return this._items},_r.prototype.interfaces_=function(){return[Ke]},_r.prototype.getClass=function(){return _r};var vr=function(){this._index=null;var t=arguments[0];if(!L(t,Qt))throw new _("Argument must be Polygonal");this._index=new wr(t)},xr={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};vr.prototype.locate=function(t){var e=new st(t),n=new Cr(e);return this._index.query(t.y,t.y,n),e.getLocation()},vr.prototype.interfaces_=function(){return[jn]},vr.prototype.getClass=function(){return vr},xr.SegmentVisitor.get=function(){return Cr},xr.IntervalIndexedGeometry.get=function(){return wr},Object.defineProperties(vr,xr);var Cr=function(){this._counter=null;var t=arguments[0];this._counter=t};Cr.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},Cr.prototype.interfaces_=function(){return[Ke]},Cr.prototype.getClass=function(){return Cr};var wr=function(){this._index=new mr;var t=arguments[0];this.init(t)};wr.prototype.init=function(t){for(var e=Ei.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},wr.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new gn(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}},wr.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new _r;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._index.query(i,r,o)}},wr.prototype.interfaces_=function(){return[]},wr.prototype.getClass=function(){return wr};var br=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new pe,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Ii,2===arguments.length){var e=arguments[0],n=arguments[1],i=dt.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=n,this._boundaryNodeRule=i,null!==n&&this.add(n)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this._argIndex=r,this._parentGeom=o,this._boundaryNodeRule=s,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,n){var i=this._nodes.addNode(n).getLabel(),r=1;i.getLocation(t,Ie.ON)===S.BOUNDARY&&r++;var o=e.determineBoundary(this._boundaryNodeRule,r);i.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new cr(n,!0,!1);o.setIsDoneIfProperInt(r);var s=this.createEdgeSetIntersector(),a=this._parentGeom instanceof ee||this._parentGeom instanceof $t||this._parentGeom instanceof ne,l=i||!a;return s.computeIntersections(this._edges,o,l),this.addSelfIntersectionNodes(this._argIndex),o}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,n){var i=new cr(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Jt){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,S.INTERIOR)}else if(arguments[0]instanceof E){var e=arguments[0];this.insertPoint(this._argIndex,e,S.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),S.EXTERIOR,S.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,S.INTERIOR,S.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],S.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],S.BOUNDARY)},e.prototype.addLineString=function(t){var e=Pt.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new ni(e,new Oe(this._argIndex,S.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),et.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===S.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},e.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var i=Pt.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var r=e,o=n;at.isCCW(i)&&(r=n,o=e);var s=new ni(i,new Oe(this._argIndex,S.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,i[0],S.BOUNDARY)},e.prototype.insertPoint=function(t,e,n){var i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new Oe(t,n):r.setLocation(t,n)},e.prototype.createEdgeSetIntersector=function(){return new hr},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,i)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof ne&&(this._useBoundaryDeterminationRule=!1),e instanceof $t)this.addPolygon(e);else if(e instanceof Kt)this.addLineString(e);else if(e instanceof Jt)this.addPoint(e);else if(e instanceof te)this.addCollection(e);else if(e instanceof qt)this.addCollection(e);else if(e instanceof ne)this.addCollection(e);else{if(!(e instanceof Ut))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},e.prototype.locate=function(t){return L(this._parentGeom,Qt)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new vr(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?S.BOUNDARY:S.INTERIOR},e}(Ve),Er=function(){if(this._li=new rt,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new br(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=dt.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new br(0,e,i),this._arg[1]=new br(1,n,i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];r.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new br(0,r,s),this._arg[1]=new br(1,o,s)}};Er.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Er.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Er.prototype.interfaces_=function(){return[]},Er.prototype.getClass=function(){return Er};var Ir=function(){};Ir.prototype.interfaces_=function(){return[]},Ir.prototype.getClass=function(){return Ir},Ir.map=function(){if(arguments[0]instanceof ct&&L(arguments[1],Ir.MapOp)){for(var t=arguments[0],e=arguments[1],n=new bt,i=0;i<t.getNumGeometries();i++){var r=e.map(t.getGeometryN(i));null!==r&&n.add(r)}return t.getFactory().buildGeometry(n)}if(L(arguments[0],xt)&&L(arguments[1],Ir.MapOp)){for(var o=arguments[0],s=arguments[1],a=new bt,l=o.iterator();l.hasNext();){var u=l.next(),c=s.map(u);null!==c&&a.add(c)}return a}},Ir.MapOp=function(){};var Pr=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n),this._ptLocator=new Ii,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Xn,this._resultPolyList=new bt,this._resultLineList=new bt,this._resultPointList=new bt,this._graph=new Ve(new Hn),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Oe(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,n,i,r){var o=new bt;return o.addAll(t),o.addAll(n),o.addAll(i),o.isEmpty()?e.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this._ptLocator.locate(t,i)!==S.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new bt,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new bt;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Vi.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new He(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var i=new Yi(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);var r=new Xi(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var i=n.next(),r=i.getLabel();r.isArea()&&!i.isInteriorAreaEdge()&&e.isResultOfOp(r.getLocation(0,Ie.RIGHT),r.getLocation(1,Ie.RIGHT),t)&&i.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(et.isTrue(!i.isNull(r,Ie.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,Ie.LEFT,i.getLocation(r,Ie.LEFT)),et.isTrue(!i.isNull(r,Ie.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,Ie.RIGHT,i.getLocation(r,Ie.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Er);Pr.overlayOp=function(t,e,n){return new Pr(t,e).getResultGeometry(n)},Pr.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Pr.createEmptyResult(Pr.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Hi.map(t,{interfaces_:function(){return[Ir.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Pr.INTERSECTION)},Pr.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Pr.createEmptyResult(Pr.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Pr.SYMDIFFERENCE)},Pr.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),o=-1;switch(t){case Pr.INTERSECTION:o=Math.min(i,r);break;case Pr.UNION:o=Math.max(i,r);break;case Pr.DIFFERENCE:o=i;break;case Pr.SYMDIFFERENCE:o=Math.max(i,r)}return o},Pr.createEmptyResult=function(t,e,n,i){var r=null;switch(Pr.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},Pr.difference=function(t,e){return t.isEmpty()?Pr.createEmptyResult(Pr.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Pr.DIFFERENCE))},Pr.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return Pr.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];switch(r===S.BOUNDARY&&(r=S.INTERIOR),o===S.BOUNDARY&&(o=S.INTERIOR),s){case Pr.INTERSECTION:return r===S.INTERIOR&&o===S.INTERIOR;case Pr.UNION:return r===S.INTERIOR||o===S.INTERIOR;case Pr.DIFFERENCE:return r===S.INTERIOR&&o!==S.INTERIOR;case Pr.SYMDIFFERENCE:return r===S.INTERIOR&&o!==S.INTERIOR||r!==S.INTERIOR&&o===S.INTERIOR}return!1}},Pr.INTERSECTION=1,Pr.UNION=2,Pr.DIFFERENCE=3,Pr.SYMDIFFERENCE=4;var Nr=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Ii,this._seg=new gn;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Nr.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),i=0;i<n.size()-1;i++)if(n.getCoordinate(i,this._seg.p0),n.getCoordinate(i+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},Nr.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?S.BOUNDARY:this._ptLocator.locate(t,this._g)},Nr.prototype.extractLinework=function(t){var e=new Sr;t.apply(e);var n=e.getLinework(),i=me.toLineStringArray(n);return t.getFactory().createMultiLineString(i)},Nr.prototype.interfaces_=function(){return[]},Nr.prototype.getClass=function(){return Nr};var Sr=function(){this._linework=null,this._linework=new bt};Sr.prototype.getLinework=function(){return this._linework},Sr.prototype.filter=function(t){if(t instanceof $t){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},Sr.prototype.interfaces_=function(){return[jt]},Sr.prototype.getClass=function(){return Sr};var Tr=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Tr.prototype.extractPoints=function(t,e,n){for(var i=t.getCoordinates(),r=0;r<i.length-1;r++)this.computeOffsetPoints(i[r],i[r+1],e,n)},Tr.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Tr.prototype.getPoints=function(t){for(var e=new bt,n=Ei.getLines(this._g).iterator();n.hasNext();){var i=n.next();this.extractPoints(i,t,e)}return e},Tr.prototype.computeOffsetPoints=function(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,s=Math.sqrt(r*r+o*o),a=n*r/s,l=n*o/s,u=(e.x+t.x)/2,c=(e.y+t.y)/2;if(this._doLeft){var h=new E(u-l,c+a);i.add(h)}if(this._doRight){var p=new E(u+l,c-a);i.add(p)}},Tr.prototype.interfaces_=function(){return[]},Tr.prototype.getClass=function(){return Tr};var Lr=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new bt;var e=arguments[0],n=arguments[1],i=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,i],this._locFinder=[new Nr(this._geom[0],this._boundaryDistanceTolerance),new Nr(this._geom[1],this._boundaryDistanceTolerance),new Nr(this._geom[2],this._boundaryDistanceTolerance)]},Mr={TOLERANCE:{configurable:!0}};Lr.prototype.reportResult=function(t,e,n){V.out.println("Overlay result invalid - A:"+S.toLocationSymbol(e[0])+" B:"+S.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+S.toLocationSymbol(e[2]))},Lr.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Lr.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._location[0]=this._locFinder[0].getLocation(r),this._location[1]=this._locFinder[1].getLocation(r),this._location[2]=this._locFinder[2].getLocation(r),!!Lr.hasLocation(this._location,S.BOUNDARY)||this.isValidResult(i,this._location)}},Lr.prototype.addTestPts=function(t){var e=new Tr(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Lr.prototype.isValidResult=function(t,e){var n=Pr.isResultOfOp(e[0],e[1],t),i=!(n^e[2]===S.INTERIOR);return i||this.reportResult(t,e,n),i},Lr.prototype.getInvalidLocation=function(){return this._invalidLocation},Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr},Lr.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},Lr.computeBoundaryDistanceTolerance=function(t,e){return Math.min(Zi.computeSizeBasedSnapTolerance(t),Zi.computeSizeBasedSnapTolerance(e))},Lr.isValid=function(t,e,n,i){return new Lr(t,e,i).isValid(n)},Mr.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Lr,Mr);var Or=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Or.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this._skipEmpty&&i.isEmpty()||e.add(i)}},Or.prototype.combine=function(){for(var t=new bt,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Or.prototype.interfaces_=function(){return[]},Or.prototype.getClass=function(){return Or},Or.combine=function(){if(1===arguments.length){var t=arguments[0];return new Or(t).combine()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new Or(Or.createList(e,n)).combine()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];return new Or(Or.createList(i,r,o)).combine()}},Or.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Or.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new bt;return n.add(t),n.add(e),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=new bt;return s.add(i),s.add(r),s.add(o),s}};var Rr=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new bt)},Ar={STRTREE_NODE_CAPACITY:{configurable:!0}};Rr.prototype.reduceToGeometries=function(t){for(var e=new bt,n=t.iterator();n.hasNext();){var i=n.next(),r=null;L(i,wt)?r=this.unionTree(i):i instanceof ct&&(r=i),e.add(r)}return e},Rr.prototype.extractByEnvelope=function(t,e,n){for(var i=new bt,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?i.add(o):n.add(o)}return this._geomFactory.buildGeometry(i)},Rr.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return Or.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},Rr.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new sn(Rr.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},Rr.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(i-n<=1){var r=Rr.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(Rr.getGeometry(e,n),Rr.getGeometry(e,n+1));var o=Math.trunc((i+n)/2),s=this.binaryUnion(e,n,o),a=this.binaryUnion(e,o,i);return this.unionSafe(s,a)}},Rr.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},Rr.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Rr.prototype.unionActual=function(t,e){return Rr.restrictToPolygons(t.union(e))},Rr.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Rr.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var i=new bt,r=this.extractByEnvelope(n,t,i),o=this.extractByEnvelope(n,e,i),s=this.unionActual(r,o);return i.add(s),Or.combine(i)},Rr.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},Rr.prototype.interfaces_=function(){return[]},Rr.prototype.getClass=function(){return Rr},Rr.restrictToPolygons=function(t){if(L(t,Qt))return t;var e=bi.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(me.toPolygonArray(e))},Rr.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Rr.union=function(t){return new Rr(t).union()},Ar.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Rr,Ar);var Dr=function(){};Dr.prototype.interfaces_=function(){return[]},Dr.prototype.getClass=function(){return Dr},Dr.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Pr.createEmptyResult(Pr.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Pr.UNION)},t.GeoJSONReader=be,t.GeoJSONWriter=Ee,t.OverlayOp=Pr,t.UnionOp=Dr,t.BufferOp=gi,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){var i=n(59)("wks"),r=n(50),o=n(12).Symbol,s="function"==typeof o;(t.exports=function(t){return i[t]||(i[t]=s&&o[t]||(s?o:r)("Symbol."+t))}).store=i},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){"use strict";var i=n(96),r=Object.prototype.toString;function o(t){return"[object Array]"===r.call(t)}function s(t){return void 0===t}function a(t){return null!==t&&"object"==typeof t}function l(t){if("[object Object]"!==r.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function u(t){return"[object Function]"===r.call(t)}function c(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),o(t))for(var n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.call(null,t[r],r,t)}t.exports={isArray:o,isArrayBuffer:function(t){return"[object ArrayBuffer]"===r.call(t)},isBuffer:function(t){return null!==t&&!s(t)&&null!==t.constructor&&!s(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:a,isPlainObject:l,isUndefined:s,isDate:function(t){return"[object Date]"===r.call(t)},isFile:function(t){return"[object File]"===r.call(t)},isBlob:function(t){return"[object Blob]"===r.call(t)},isFunction:u,isStream:function(t){return a(t)&&u(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:c,merge:function t(){var e={};function n(n,i){l(e[i])&&l(n)?e[i]=t(e[i],n):l(n)?e[i]=t({},n):o(n)?e[i]=n.slice():e[i]=n}for(var i=0,r=arguments.length;i<r;i++)c(arguments[i],n);return e},extend:function(t,e,n){return c(e,(function(e,r){t[r]=n&&"function"==typeof e?i(e,n):e})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}}},function(t,e,n){t.exports=n(152)},function(t,e,n){var i=n(19),r=n(78),o=n(54),s=Object.defineProperty;e.f=n(20)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var i=n(15);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){t.exports=!n(33)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,n){t.exports={default:n(199),__esModule:!0}},function(t,e,n){"use strict";(function(t){var n,i={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-i.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*i.Bounce.In(2*t):.5*i.Bounce.Out(2*t-1)+.5}}},r="undefined"==typeof self&&void 0!==t&&t.hrtime?function(){var e=t.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},o=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map((function(e){return t._tweens[e]}))},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},t.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},t.prototype.update=function(t,e){void 0===t&&(t=r()),void 0===e&&(e=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var o=this._tweens[n[i]],s=!e;o&&!1===o.update(t,s)&&!e&&delete this._tweens[n[i]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),s={Linear:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),o=s.Utils.Linear;return e<0?o(t[0],t[1],i):e>1?o(t[n],t[n-1],n-i):o(t[r],t[r+1>n?n:r+1],i-r)},Bezier:function(t,e){for(var n=0,i=t.length-1,r=Math.pow,o=s.Utils.Bernstein,a=0;a<=i;a++)n+=r(1-e,i-a)*r(e,a)*t[a]*o(i,a);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),o=s.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(r=Math.floor(i=n*(1+e))),o(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],i-r)):e<0?t[0]-(o(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(o(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):o(t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2],i-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=s.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:(n=[1],function(t){var e=1;if(n[t])return n[t];for(var i=t;i>1;i--)e*=i;return n[t]=e,e}),CatmullRom:function(t,e,n,i,r){var o=.5*(n-t),s=.5*(i-e),a=r*r;return(2*e-2*n+o+s)*(r*a)+(-3*e+3*n-2*o-s)*a+o*r+e}}},a=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),l=new o,u=function(){function t(t,e){void 0===e&&(e=l),this._object=t,this._group=e,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=i.Linear.None,this._interpolationFunction=s.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=a.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.to=function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},t.prototype.duration=function(t){return this._duration=t,this},t.prototype.start=function(t){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var e in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(e),this._valuesStart[e]=this._valuesStartRepeat[e];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==t?"string"==typeof t?r()+parseFloat(t):t:r(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},t.prototype._setupProperties=function(t,e,n,i){for(var r in n){var o=t[r],s=Array.isArray(o),a=s?"array":typeof o,l=!s&&Array.isArray(n[r]);if("undefined"!==a&&"function"!==a){if(l){var u=n[r];if(0===u.length)continue;u=u.map(this._handleRelativeValue.bind(this,o)),n[r]=[o].concat(u)}if("object"!==a&&!s||!o||l)void 0===e[r]&&(e[r]=o),s||(e[r]*=1),i[r]=l?n[r].slice().reverse():e[r]||0;else{for(var c in e[r]=s?[]:{},o)e[r][c]=o[c];i[r]=s?[]:{},this._setupProperties(o,e[r],n[r],i[r])}}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(t){return void 0===t&&(t=r()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this},t.prototype.resume=function(t){return void 0===t&&(t=r()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},t.prototype.stopChainedTweens=function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this},t.prototype.group=function(t){return this._group=t,this},t.prototype.delay=function(t){return this._delayTime=t,this},t.prototype.repeat=function(t){return this._initialRepeat=t,this._repeat=t,this},t.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},t.prototype.yoyo=function(t){return this._yoyo=t,this},t.prototype.easing=function(t){return this._easingFunction=t,this},t.prototype.interpolation=function(t){return this._interpolationFunction=t,this},t.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._chainedTweens=t,this},t.prototype.onStart=function(t){return this._onStartCallback=t,this},t.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},t.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},t.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},t.prototype.onStop=function(t){return this._onStopCallback=t,this},t.prototype.update=function(t,e){if(void 0===t&&(t=r()),void 0===e&&(e=!0),this._isPaused)return!0;var n,i,o=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>o)return!1;e&&this.start(t)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(t-this._startTime)/this._duration,i=0===this._duration||i>1?1:i;var s=this._easingFunction(i);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,s),this._onUpdateCallback&&this._onUpdateCallback(this._object,i),1===i){if(this._repeat>0){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[n]||(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,l=this._chainedTweens.length;a<l;a++)this._chainedTweens[a].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(t,e,n,i){for(var r in n)if(void 0!==e[r]){var o=e[r]||0,s=n[r],a=Array.isArray(t[r]),l=Array.isArray(s);!a&&l?t[r]=this._interpolationFunction(s,i):"object"==typeof s&&s?this._updateProperties(t[r],o,s,i):"number"==typeof(s=this._handleRelativeValue(o,s))&&(t[r]=o+(s-o)*i)}},t.prototype._handleRelativeValue=function(t,e){return"string"!=typeof e?e:"+"===e.charAt(0)||"-"===e.charAt(0)?t+parseFloat(e):parseFloat(e)},t.prototype._swapEndStartRepeatValues=function(t){var e=this._valuesStartRepeat[t],n=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof n?this._valuesStartRepeat[t]+parseFloat(n):this._valuesEnd[t],this._valuesEnd[t]=e},t}(),c=a.nextId,h=l,p=h.getAll.bind(h),f=h.removeAll.bind(h),d=h.add.bind(h),g=h.remove.bind(h),y=h.update.bind(h),m={Easing:i,Group:o,Interpolation:s,now:r,Sequence:a,nextId:c,Tween:u,VERSION:"18.6.4",getAll:p,removeAll:f,add:d,remove:g,update:y};e.a=m}).call(this,n(69))},function(t,e){t.exports={wkt:{Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION"},wkb:{Point:1,LineString:2,Polygon:3,MultiPoint:4,MultiLineString:5,MultiPolygon:6,GeometryCollection:7},geoJSON:{Point:"Point",LineString:"LineString",Polygon:"Polygon",MultiPoint:"MultiPoint",MultiLineString:"MultiLineString",MultiPolygon:"MultiPolygon",GeometryCollection:"GeometryCollection"}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){t.exports={default:n(200),__esModule:!0}},function(t,e,n){t.exports={default:n(204),__esModule:!0}},function(t,e,n){var i=n(18),r=n(36);t.exports=n(20)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){(function(e){t.exports=g;var i=n(23),r=n(29),o=n(75),s=n(76),a=n(105),l=n(106),u=n(107),c=n(108),h=n(192),p=n(30),f=n(193),d=n(104);function g(){this.srid=void 0,this.hasZ=!1,this.hasM=!1}g.parse=function(t,n){if("string"===typeof t||t instanceof f)return g._parseWkt(t);if(e.isBuffer(t)||t instanceof h)return g._parseWkb(t,n);throw new Error("first argument must be a string or Buffer")},g._parseWkt=function(t){var e,n,h=(e=t instanceof f?t:new f(t)).matchRegex([/^SRID=(\d+);/]);h&&(n=parseInt(h[1],10));var p=e.matchType(),d=e.matchDimension(),g={srid:n,hasZ:d.hasZ,hasM:d.hasM};switch(p){case i.wkt.Point:return r._parseWkt(e,g);case i.wkt.LineString:return o._parseWkt(e,g);case i.wkt.Polygon:return s._parseWkt(e,g);case i.wkt.MultiPoint:return a._parseWkt(e,g);case i.wkt.MultiLineString:return l._parseWkt(e,g);case i.wkt.MultiPolygon:return u._parseWkt(e,g);case i.wkt.GeometryCollection:return c._parseWkt(e,g)}},g._parseWkb=function(t,e){var n,p,f,d={};switch((n=t instanceof h?t:new h(t)).isBigEndian=!n.readInt8(),p=n.readUInt32(),d.hasSrid=536870912==(536870912&p),d.isEwkb=536870912&p||1073741824&p||2147483648&p,d.hasSrid&&(d.srid=n.readUInt32()),d.hasZ=!1,d.hasM=!1,d.isEwkb||e&&e.isEwkb?(2147483648&p&&(d.hasZ=!0),1073741824&p&&(d.hasM=!0),f=15&p):p>=1e3&&p<2e3?(d.hasZ=!0,f=p-1e3):p>=2e3&&p<3e3?(d.hasM=!0,f=p-2e3):p>=3e3&&p<4e3?(d.hasZ=!0,d.hasM=!0,f=p-3e3):f=p,f){case i.wkb.Point:return r._parseWkb(n,d);case i.wkb.LineString:return o._parseWkb(n,d);case i.wkb.Polygon:return s._parseWkb(n,d);case i.wkb.MultiPoint:return a._parseWkb(n,d);case i.wkb.MultiLineString:return l._parseWkb(n,d);case i.wkb.MultiPolygon:return u._parseWkb(n,d);case i.wkb.GeometryCollection:return c._parseWkb(n,d);default:throw new Error("GeometryType "+f+" not supported")}},g.parseTwkb=function(t){var e,n={},p=(e=t instanceof h?t:new h(t)).readUInt8(),f=e.readUInt8(),g=15&p;if(n.precision=d.decode(p>>4),n.precisionFactor=Math.pow(10,n.precision),n.hasBoundingBox=f>>0&1,n.hasSizeAttribute=f>>1&1,n.hasIdList=f>>2&1,n.hasExtendedPrecision=f>>3&1,n.isEmpty=f>>4&1,n.hasExtendedPrecision){var y=e.readUInt8();n.hasZ=1==(1&y),n.hasM=2==(2&y),n.zPrecision=d.decode((28&y)>>2),n.zPrecisionFactor=Math.pow(10,n.zPrecision),n.mPrecision=d.decode((224&y)>>5),n.mPrecisionFactor=Math.pow(10,n.mPrecision)}else n.hasZ=!1,n.hasM=!1;if(n.hasSizeAttribute&&e.readVarInt(),n.hasBoundingBox){var m=2;n.hasZ&&m++,n.hasM&&m++;for(var _=0;_<m;_++)e.readVarInt(),e.readVarInt()}switch(g){case i.wkb.Point:return r._parseTwkb(e,n);case i.wkb.LineString:return o._parseTwkb(e,n);case i.wkb.Polygon:return s._parseTwkb(e,n);case i.wkb.MultiPoint:return a._parseTwkb(e,n);case i.wkb.MultiLineString:return l._parseTwkb(e,n);case i.wkb.MultiPolygon:return u._parseTwkb(e,n);case i.wkb.GeometryCollection:return c._parseTwkb(e,n);default:throw new Error("GeometryType "+g+" not supported")}},g.parseGeoJSON=function(t){return g._parseGeoJSON(t)},g._parseGeoJSON=function(t,e){var n;switch(t.type){case i.geoJSON.Point:n=r._parseGeoJSON(t);break;case i.geoJSON.LineString:n=o._parseGeoJSON(t);break;case i.geoJSON.Polygon:n=s._parseGeoJSON(t);break;case i.geoJSON.MultiPoint:n=a._parseGeoJSON(t);break;case i.geoJSON.MultiLineString:n=l._parseGeoJSON(t);break;case i.geoJSON.MultiPolygon:n=u._parseGeoJSON(t);break;case i.geoJSON.GeometryCollection:n=c._parseGeoJSON(t);break;default:throw new Error("GeometryType "+t.type+" not supported")}if(t.crs&&t.crs.type&&"name"===t.crs.type&&t.crs.properties&&t.crs.properties.name){var h=t.crs.properties.name;if(0===h.indexOf("EPSG:"))n.srid=parseInt(h.substring(5));else{if(0!==h.indexOf("urn:ogc:def:crs:EPSG::"))throw new Error("Unsupported crs: "+h);n.srid=parseInt(h.substring(22))}}else e||(n.srid=4326);return n},g.prototype.toEwkt=function(){return"SRID="+this.srid+";"+this.toWkt()},g.prototype.toEwkb=function(){var t=new p(this._getWkbSize()+4),e=this.toWkb();return t.writeInt8(1),t.writeUInt32LE((536870912|e.slice(1,5).readUInt32LE(0))>>>0,!0),t.writeUInt32LE(this.srid),t.writeBuffer(e.slice(5)),t.buffer},g.prototype._getWktType=function(t,e){var n=t;return this.hasZ&&this.hasM?n+=" ZM ":this.hasZ?n+=" Z ":this.hasM&&(n+=" M "),!e||this.hasZ||this.hasM||(n+=" "),e&&(n+="EMPTY"),n},g.prototype._getWktCoordinate=function(t){var e=t.x+" "+t.y;return this.hasZ&&(e+=" "+t.z),this.hasM&&(e+=" "+t.m),e},g.prototype._writeWkbType=function(t,e,n){var i=0;void 0!==this.srid||n&&void 0!==n.srid?(this.hasZ&&(i|=2147483648),this.hasM&&(i|=1073741824)):this.hasZ&&this.hasM?i+=3e3:this.hasZ?i+=1e3:this.hasM&&(i+=2e3),t.writeUInt32LE(i+e>>>0,!0)},g.getTwkbPrecision=function(t,e,n){return{xy:t,z:e,m:n,xyFactor:Math.pow(10,t),zFactor:Math.pow(10,e),mFactor:Math.pow(10,n)}},g.prototype._writeTwkbHeader=function(t,e,n,i){var r=(d.encode(n.xy)<<4)+e,o=(this.hasZ||this.hasM)<<3;if(o+=i<<4,t.writeUInt8(r),t.writeUInt8(o),this.hasZ||this.hasM){var s=0;this.hasZ&&(s|=1),this.hasM&&(s|=2),t.writeUInt8(s)}},g.prototype.toGeoJSON=function(t){var e={};return this.srid&&t&&(t.shortCrs?e.crs={type:"name",properties:{name:"EPSG:"+this.srid}}:t.longCrs&&(e.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+this.srid}})),e}}).call(this,n(74).Buffer)},function(t,e,n){t.exports=l;var i=n(34),r=n(28),o=n(23),s=n(30),a=n(104);function l(t,e,n,i,o){r.call(this),this.x=t,this.y=e,this.z=n,this.m=i,this.srid=o,this.hasZ=void 0!==this.z,this.hasM=void 0!==this.m}i.inherits(l,r),l.Z=function(t,e,n,i){var r=new l(t,e,n,void 0,i);return r.hasZ=!0,r},l.M=function(t,e,n,i){var r=new l(t,e,void 0,n,i);return r.hasM=!0,r},l.ZM=function(t,e,n,i,r){var o=new l(t,e,n,i,r);return o.hasZ=!0,o.hasM=!0,o},l._parseWkt=function(t,e){var n=new l;if(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.isMatch(["EMPTY"]))return n;t.expectGroupStart();var i=t.matchCoordinate(e);return n.x=i.x,n.y=i.y,n.z=i.z,n.m=i.m,t.expectGroupEnd(),n},l._parseWkb=function(t,e){var n=l._readWkbPoint(t,e);return n.srid=e.srid,n},l._readWkbPoint=function(t,e){return new l(t.readDouble(),t.readDouble(),e.hasZ?t.readDouble():void 0,e.hasM?t.readDouble():void 0)},l._parseTwkb=function(t,e){var n=new l;return n.hasZ=e.hasZ,n.hasM=e.hasM,e.isEmpty||(n.x=a.decode(t.readVarInt())/e.precisionFactor,n.y=a.decode(t.readVarInt())/e.precisionFactor,n.z=e.hasZ?a.decode(t.readVarInt())/e.zPrecisionFactor:void 0,n.m=e.hasM?a.decode(t.readVarInt())/e.mPrecisionFactor:void 0),n},l._readTwkbPoint=function(t,e,n){return n.x+=a.decode(t.readVarInt())/e.precisionFactor,n.y+=a.decode(t.readVarInt())/e.precisionFactor,e.hasZ&&(n.z+=a.decode(t.readVarInt())/e.zPrecisionFactor),e.hasM&&(n.m+=a.decode(t.readVarInt())/e.mPrecisionFactor),new l(n.x,n.y,n.z,n.m)},l._parseGeoJSON=function(t){return l._readGeoJSONPoint(t.coordinates)},l._readGeoJSONPoint=function(t){return 0===t.length?new l:t.length>2?new l(t[0],t[1],t[2]):new l(t[0],t[1])},l.prototype.toWkt=function(){return void 0===this.x&&void 0===this.y&&void 0===this.z&&void 0===this.m?this._getWktType(o.wkt.Point,!0):this._getWktType(o.wkt.Point,!1)+"("+this._getWktCoordinate(this)+")"},l.prototype.toWkb=function(t){var e=new s(this._getWkbSize());return e.writeInt8(1),this._writeWkbType(e,o.wkb.Point,t),void 0===this.x&&void 0===this.y?(e.writeDoubleLE(NaN),e.writeDoubleLE(NaN),this.hasZ&&e.writeDoubleLE(NaN),this.hasM&&e.writeDoubleLE(NaN)):this._writeWkbPoint(e),e.buffer},l.prototype._writeWkbPoint=function(t){t.writeDoubleLE(this.x),t.writeDoubleLE(this.y),this.hasZ&&t.writeDoubleLE(this.z),this.hasM&&t.writeDoubleLE(this.m)},l.prototype.toTwkb=function(){var t=new s(0,!0),e=r.getTwkbPrecision(5,0,0),n=void 0===this.x&&void 0===this.y;return this._writeTwkbHeader(t,o.wkb.Point,e,n),n||this._writeTwkbPoint(t,e,new l(0,0,0,0)),t.buffer},l.prototype._writeTwkbPoint=function(t,e,n){var i=this.x*e.xyFactor,r=this.y*e.xyFactor,o=this.z*e.zFactor,s=this.m*e.mFactor;t.writeVarInt(a.encode(i-n.x)),t.writeVarInt(a.encode(r-n.y)),this.hasZ&&t.writeVarInt(a.encode(o-n.z)),this.hasM&&t.writeVarInt(a.encode(s-n.m)),n.x=i,n.y=r,n.z=o,n.m=s},l.prototype._getWkbSize=function(){var t=21;return this.hasZ&&(t+=8),this.hasM&&(t+=8),t},l.prototype.toGeoJSON=function(t){var e=r.prototype.toGeoJSON.call(this,t);return e.type=o.geoJSON.Point,void 0===this.x&&void 0===this.y?e.coordinates=[]:void 0!==this.z?e.coordinates=[this.x,this.y,this.z]:e.coordinates=[this.x,this.y],e}},function(t,e,n){(function(e){function n(t,n){this.buffer=new e(t),this.position=0,this.allowResize=n}function i(t,e){return function(n,i){this.ensureSize(e),t.call(this.buffer,n,this.position,i),this.position+=e}}t.exports=n,n.prototype.writeUInt8=i(e.prototype.writeUInt8,1),n.prototype.writeUInt16LE=i(e.prototype.writeUInt16LE,2),n.prototype.writeUInt16BE=i(e.prototype.writeUInt16BE,2),n.prototype.writeUInt32LE=i(e.prototype.writeUInt32LE,4),n.prototype.writeUInt32BE=i(e.prototype.writeUInt32BE,4),n.prototype.writeInt8=i(e.prototype.writeInt8,1),n.prototype.writeInt16LE=i(e.prototype.writeInt16LE,2),n.prototype.writeInt16BE=i(e.prototype.writeInt16BE,2),n.prototype.writeInt32LE=i(e.prototype.writeInt32LE,4),n.prototype.writeInt32BE=i(e.prototype.writeInt32BE,4),n.prototype.writeFloatLE=i(e.prototype.writeFloatLE,4),n.prototype.writeFloatBE=i(e.prototype.writeFloatBE,4),n.prototype.writeDoubleLE=i(e.prototype.writeDoubleLE,8),n.prototype.writeDoubleBE=i(e.prototype.writeDoubleBE,8),n.prototype.writeBuffer=function(t){this.ensureSize(t.length),t.copy(this.buffer,this.position,0,t.length),this.position+=t.length},n.prototype.writeVarInt=function(t){for(var e=1;0!=(4294967168&t);)this.writeUInt8(127&t|128),t>>>=7,e++;return this.writeUInt8(127&t),e},n.prototype.ensureSize=function(t){if(this.buffer.length<this.position+t){if(!this.allowResize)throw new RangeError("index out of range");var n=new e(this.position+t);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n}}}).call(this,n(74).Buffer)},function(t,e,n){"use strict";e.__esModule=!0;var i,r=n(110),o=(i=r)&&i.__esModule?i:{default:i};e.default=function(t,e,n){return e in t?(0,o.default)(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){var i=n(40);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){(function(t){var i=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},i=0;i<e.length;i++)n[e[i]]=Object.getOwnPropertyDescriptor(t,e[i]);return n},r=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(a(arguments[n]));return e.join(" ")}n=1;for(var i=arguments,o=i.length,s=String(t).replace(r,(function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}})),l=i[n];n<o;l=i[++n])g(l)||!x(l)?s+=" "+l:s+=" "+a(l);return s},e.deprecate=function(n,i){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,i).apply(this,arguments)};var r=!1;return function(){if(!r){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),r=!0}return n.apply(this,arguments)}};var o,s={};function a(t,n){var i={seen:[],stylize:u};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),d(n)?i.showHidden=n:n&&e._extend(i,n),_(i.showHidden)&&(i.showHidden=!1),_(i.depth)&&(i.depth=2),_(i.colors)&&(i.colors=!1),_(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=l),c(i,t,i.depth)}function l(t,e){var n=a.styles[e];return n?"["+a.colors[n][0]+"m"+t+"["+a.colors[n][1]+"m":t}function u(t,e){return t}function c(t,n,i){if(t.customInspect&&n&&b(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var r=n.inspect(i,t);return m(r)||(r=c(t,r,i)),r}var o=function(t,e){if(_(e))return t.stylize("undefined","undefined");if(m(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(y(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(g(e))return t.stylize("null","null")}(t,n);if(o)return o;var s=Object.keys(n),a=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),w(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(b(n)){var l=n.name?": "+n.name:"";return t.stylize("[Function"+l+"]","special")}if(v(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(C(n))return t.stylize(Date.prototype.toString.call(n),"date");if(w(n))return h(n)}var u,x="",E=!1,I=["{","}"];(f(n)&&(E=!0,I=["[","]"]),b(n))&&(x=" [Function"+(n.name?": "+n.name:"")+"]");return v(n)&&(x=" "+RegExp.prototype.toString.call(n)),C(n)&&(x=" "+Date.prototype.toUTCString.call(n)),w(n)&&(x=" "+h(n)),0!==s.length||E&&0!=n.length?i<0?v(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=E?function(t,e,n,i,r){for(var o=[],s=0,a=e.length;s<a;++s)S(e,String(s))?o.push(p(t,e,n,i,String(s),!0)):o.push("");return r.forEach((function(r){r.match(/^\d+$/)||o.push(p(t,e,n,i,r,!0))})),o}(t,n,i,a,s):s.map((function(e){return p(t,n,i,a,e,E)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,x,I)):I[0]+x+I[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,n,i,r,o){var s,a,l;if((l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?a=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(a=t.stylize("[Setter]","special")),S(i,r)||(s="["+r+"]"),a||(t.seen.indexOf(l.value)<0?(a=g(n)?c(t,l.value,null):c(t,l.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),_(s)){if(o&&r.match(/^\d+$/))return a;(s=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function f(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function g(t){return null===t}function y(t){return"number"==typeof t}function m(t){return"string"==typeof t}function _(t){return void 0===t}function v(t){return x(t)&&"[object RegExp]"===E(t)}function x(t){return"object"==typeof t&&null!==t}function C(t){return x(t)&&"[object Date]"===E(t)}function w(t){return x(t)&&("[object Error]"===E(t)||t instanceof Error)}function b(t){return"function"==typeof t}function E(t){return Object.prototype.toString.call(t)}function I(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(_(o)&&(o=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var i=t.pid;s[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,i,t)}}else s[n]=function(){};return s[n]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=d,e.isNull=g,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=_,e.isRegExp=v,e.isObject=x,e.isDate=C,e.isError=w,e.isFunction=b,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(190);var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function N(){var t=new Date,e=[I(t.getHours()),I(t.getMinutes()),I(t.getSeconds())].join(":");return[t.getDate(),P[t.getMonth()],e].join(" ")}function S(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",N(),e.format.apply(e,arguments))},e.inherits=n(191),e._extend=function(t,e){if(!e||!x(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t};var T="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function L(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(T&&t[T]){var e;if("function"!=typeof(e=t[T]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,T,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,i=new Promise((function(t,i){e=t,n=i})),r=[],o=0;o<arguments.length;o++)r.push(arguments[o]);r.push((function(t,i){t?n(t):e(i)}));try{t.apply(this,r)}catch(t){n(t)}return i}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),T&&Object.defineProperty(e,T,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,i(t))},e.promisify.custom=T,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],i=0;i<arguments.length;i++)n.push(arguments[i]);var r=n.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return r.apply(o,arguments)};e.apply(this,n).then((function(e){t.nextTick(s,null,e)}),(function(e){t.nextTick(L,e,s)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,i(e)),n}}).call(this,n(69))},function(t,e,n){t.exports={default:n(194),__esModule:!0}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(55),r=n(56);t.exports=function(t){return i(r(t))}},function(t,e,n){var i=n(56);t.exports=function(t){return Object(i(t))}},function(t,e){t.exports={}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var i=n(80),r=n(60);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=!0},function(t,e,n){"use strict";var i=n(125)(!0);n(81)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})}))},function(t,e,n){var i=n(18).f,r=n(24),o=n(14)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){n(127);for(var i=n(12),r=n(27),o=n(39),s=n(14)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<a.length;l++){var u=a[l],c=i[u],h=c&&c.prototype;h&&!h[s]&&r(h,s,u),o[u]=o.Array}},function(t,e,n){var i=n(50)("meta"),r=n(15),o=n(24),s=n(18).f,a=0,l=Object.isExtensible||function(){return!0},u=!n(33)((function(){return l(Object.preventExtensions({}))})),c=function(t){s(t,i,{value:{i:"O"+ ++a,w:{}}})},h=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,i)){if(!l(t))return"F";if(!e)return"E";c(t)}return t[i].i},getWeak:function(t,e){if(!o(t,i)){if(!l(t))return!0;if(!e)return!1;c(t)}return t[i].w},onFreeze:function(t){return u&&h.NEED&&l(t)&&!o(t,i)&&c(t),t}}},function(t,e,n){t.exports=n(207)},function(t,e,n){var i=n(57),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var i=n(32),r=n(86),o=n(87),s=n(19),a=n(49),l=n(66),u={},c={};(e=t.exports=function(t,e,n,h,p){var f,d,g,y,m=p?function(){return t}:l(t),_=i(n,h,e?2:1),v=0;if("function"!=typeof m)throw TypeError(t+" is not iterable!");if(o(m)){for(f=a(t.length);f>v;v++)if((y=e?_(s(d=t[v])[0],d[1]):_(t[v]))===u||y===c)return y}else for(g=m.call(t);!(d=g.next()).done;)if((y=r(g,_,d.value,e))===u||y===c)return y}).BREAK=u,e.RETURN=c},function(t,e,n){var i=n(15),r=n(12).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,n){var i=n(15);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(42);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(59)("keys"),r=n(50);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e,n){var i=n(9),r=n(12),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(43)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e){},function(t,e,n){t.exports=n(27)},function(t,e,n){var i=n(42),r=n(14)("toStringTag"),o="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?n:o?i(e):"Object"==(s=i(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var i=n(64),r=n(14)("iterator"),o=n(39);t.exports=n(9).getIteratorMethod=function(t){if(null!=t)return t[r]||t["@@iterator"]||o[i(t)]}},function(t,e,n){"use strict";var i=n(40);function r(t){var e,n;this.promise=new t((function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i})),this.resolve=i(e),this.reject=i(n)}t.exports.f=function(t){return new r(t)}},function(t,e,n){var i=n(27);t.exports=function(t,e,n){for(var r in e)n&&t[r]?t[r]=e[r]:i(t,r,e[r]);return t}},function(t,e){var n,i,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var l,u=[],c=!1,h=-1;function p(){c&&l&&(c=!1,l.length?u=l.concat(u):h=-1,u.length&&f())}function f(){if(!c){var t=a(p);c=!0;for(var e=u.length;e;){for(l=u,u=[];++h<e;)l&&l[h].run();h=-1,e=u.length}l=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new d(t,e)),1!==u.length||c||a(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){e.f=n(14)},function(t,e,n){var i=n(12),r=n(9),o=n(43),s=n(70),a=n(18).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=o?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},function(t,e,n){var i=n(32),r=n(55),o=n(38),s=n(49),a=n(175);t.exports=function(t,e){var n=1==t,l=2==t,u=3==t,c=4==t,h=6==t,p=5==t||h,f=e||a;return function(e,a,d){for(var g,y,m=o(e),_=r(m),v=i(a,d,3),x=s(_.length),C=0,w=n?f(e,x):l?f(e,0):void 0;x>C;C++)if((p||C in _)&&(y=v(g=_[C],C,m),t))if(n)w[C]=y;else if(y)switch(t){case 3:return!0;case 5:return g;case 6:return C;case 2:w.push(g)}else if(c)return!1;return h?-1:u||c?c:w}}},function(t,e,n){var i=n(15);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var i=n(187),r=n(188),o=n(189);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return u(this,t,e,n)}function u(t,e,n,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,i){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,n):new Uint8Array(e,n,i);l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=p(t,e);return t}(t,e,n,i):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|d(e,n),r=(t=a(t,i)).write(e,n);r!==i&&(t=t.slice(0,r));return t}(t,e,n):function(t,e){if(l.isBuffer(e)){var n=0|f(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?a(t,0):p(t,e);if("Buffer"===e.type&&o(e.data))return p(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(c(e),t=a(t,e<0?0:0|f(e)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function p(t,e){var n=e.length<0?0:0|f(e.length);t=a(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function f(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(t).length;default:if(i)return j(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,n){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,n);case"utf8":case"utf-8":return P(this,e,n);case"ascii":return N(this,e,n);case"latin1":case"binary":return S(this,e,n);case"base64":return I(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function y(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function m(t,e,n,i,r){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=l.from(e,i)),l.isBuffer(e))return 0===e.length?-1:_(t,e,n,i,r);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):_(t,[e],n,i,r);throw new TypeError("val must be string, number or Buffer")}function _(t,e,n,i,r){var o,s=1,a=t.length,l=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;s=2,a/=2,l/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(r){var c=-1;for(o=n;o<a;o++)if(u(t,o)===u(e,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*s}else-1!==c&&(o-=o-c),c=-1}else for(n+l>a&&(n=a-l),o=n;o>=0;o--){for(var h=!0,p=0;p<l;p++)if(u(t,o+p)!==u(e,p)){h=!1;break}if(h)return o}return-1}function v(t,e,n,i){n=Number(n)||0;var r=t.length-n;i?(i=Number(i))>r&&(i=r):i=r;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var s=0;s<i;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function x(t,e,n,i){return U(j(e,t.length-n),t,n,i)}function C(t,e,n,i){return U(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function w(t,e,n,i){return C(t,e,n,i)}function b(t,e,n,i){return U(z(e),t,n,i)}function E(t,e,n,i){return U(function(t,e){for(var n,i,r,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),i=n>>8,r=n%256,o.push(r),o.push(i);return o}(e,t.length-n),t,n,i)}function I(t,e,n){return 0===e&&n===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,n))}function P(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;r<n;){var o,s,a,l,u=t[r],c=null,h=u>239?4:u>223?3:u>191?2:1;if(r+h<=n)switch(h){case 1:u<128&&(c=u);break;case 2:128==(192&(o=t[r+1]))&&(l=(31&u)<<6|63&o)>127&&(c=l);break;case 3:o=t[r+1],s=t[r+2],128==(192&o)&&128==(192&s)&&(l=(15&u)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=t[r+1],s=t[r+2],a=t[r+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(l=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(c=l)}null===c?(c=65533,h=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),r+=h}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",i=0;for(;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=4096));return n}(i)}e.Buffer=l,e.SlowBuffer=function(t){+t!=t&&(t=0);return l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,n){return u(null,t,e,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,n){return function(t,e,n,i){return c(e),e<=0?a(t,e):void 0!==n?"string"==typeof i?a(t,e).fill(n,i):a(t,e).fill(n):a(t,e)}(null,t,e,n)},l.allocUnsafe=function(t){return h(null,t)},l.allocUnsafeSlow=function(t){return h(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,o=Math.min(n,i);r<o;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=l.allocUnsafe(e),r=0;for(n=0;n<t.length;++n){var s=t[n];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,r),r+=s.length}return i},l.byteLength=d,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?P(this,0,t):g.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,n,i,r){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),e<0||n>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&e>=n)return 0;if(i>=r)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(r>>>=0)-(i>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),u=this.slice(i,r),c=t.slice(e,n),h=0;h<a;++h)if(u[h]!==c[h]){o=u[h],s=c[h];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},l.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return v(this,t,e,n);case"utf8":case"utf-8":return x(this,t,e,n);case"ascii":return C(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return b(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function N(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(127&t[r]);return i}function S(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(t[r]);return i}function T(t,e,n){var i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var r="",o=e;o<n;++o)r+=G(t[o]);return r}function L(t,e,n){for(var i=t.slice(e,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function M(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,n,i,r,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<o)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function R(t,e,n,i){e<0&&(e=65535+e+1);for(var r=0,o=Math.min(t.length-n,2);r<o;++r)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function A(t,e,n,i){e<0&&(e=4294967295+e+1);for(var r=0,o=Math.min(t.length-n,4);r<o;++r)t[n+r]=e>>>8*(i?r:3-r)&255}function D(t,e,n,i,r,o){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(t,e,n,i,o){return o||D(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function k(t,e,n,i,o){return o||D(t,0,n,8),r.write(t,e,n,i,52,8),n+8}l.prototype.slice=function(t,e){var n,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=l.prototype;else{var r=e-t;n=new l(r,void 0);for(var o=0;o<r;++o)n[o]=this[o+t]}return n},l.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||M(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return i},l.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||M(t,e,this.length);for(var i=this[t+--e],r=1;e>0&&(r*=256);)i+=this[t+--e]*r;return i},l.prototype.readUInt8=function(t,e){return e||M(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||M(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||M(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||M(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*e)),i},l.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||M(t,e,this.length);for(var i=e,r=1,o=this[t+--i];i>0&&(r*=256);)o+=this[t+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return e||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||M(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){e||M(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return e||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||M(t,4,this.length),r.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||M(t,4,this.length),r.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||M(t,8,this.length),r.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||M(t,8,this.length),r.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,n,i){(t=+t,e|=0,n|=0,i)||O(this,t,e,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[e]=255&t;++o<n&&(r*=256);)this[e+o]=t/r&255;return e+n},l.prototype.writeUIntBE=function(t,e,n,i){(t=+t,e|=0,n|=0,i)||O(this,t,e,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+n},l.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):A(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):A(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);O(this,t,e,n,r-1,-r)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},l.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);O(this,t,e,n,r-1,-r)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):A(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):A(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,n){return F(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return F(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return k(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return k(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var r,o=i-n;if(this===t&&n<e&&e<i)for(r=o-1;r>=0;--r)t[r+e]=this[r+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},l.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=l.isBuffer(t)?t:j(new l(t,i).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function G(t){return t<16?"0"+t.toString(16):t.toString(16)}function j(t,e){var n;e=e||1/0;for(var i=t.length,r=null,o=[],s=0;s<i;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===i){(e-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function z(t){return i.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function U(t,e,n,i){for(var r=0;r<i&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}}).call(this,n(186))},function(t,e,n){t.exports=l;var i=n(34),r=n(28),o=n(23),s=n(29),a=n(30);function l(t,e){r.call(this),this.points=t||[],this.srid=e,this.points.length>0&&(this.hasZ=this.points[0].hasZ,this.hasM=this.points[0].hasM)}i.inherits(l,r),l.Z=function(t,e){var n=new l(t,e);return n.hasZ=!0,n},l.M=function(t,e){var n=new l(t,e);return n.hasM=!0,n},l.ZM=function(t,e){var n=new l(t,e);return n.hasZ=!0,n.hasM=!0,n},l._parseWkt=function(t,e){var n=new l;return n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.isMatch(["EMPTY"])||(t.expectGroupStart(),n.points.push.apply(n.points,t.matchCoordinates(e)),t.expectGroupEnd()),n},l._parseWkb=function(t,e){var n=new l;n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM;for(var i=t.readUInt32(),r=0;r<i;r++)n.points.push(s._readWkbPoint(t,e));return n},l._parseTwkb=function(t,e){var n=new l;if(n.hasZ=e.hasZ,n.hasM=e.hasM,e.isEmpty)return n;for(var i=new s(0,0,e.hasZ?0:void 0,e.hasM?0:void 0),r=t.readVarInt(),o=0;o<r;o++)n.points.push(s._readTwkbPoint(t,e,i));return n},l._parseGeoJSON=function(t){var e=new l;t.coordinates.length>0&&(e.hasZ=t.coordinates[0].length>2);for(var n=0;n<t.coordinates.length;n++)e.points.push(s._readGeoJSONPoint(t.coordinates[n]));return e},l.prototype.toWkt=function(){return 0===this.points.length?this._getWktType(o.wkt.LineString,!0):this._getWktType(o.wkt.LineString,!1)+this._toInnerWkt()},l.prototype._toInnerWkt=function(){for(var t="(",e=0;e<this.points.length;e++)t+=this._getWktCoordinate(this.points[e])+",";return t=t.slice(0,-1),t+=")"},l.prototype.toWkb=function(t){var e=new a(this._getWkbSize());e.writeInt8(1),this._writeWkbType(e,o.wkb.LineString,t),e.writeUInt32LE(this.points.length);for(var n=0;n<this.points.length;n++)this.points[n]._writeWkbPoint(e);return e.buffer},l.prototype.toTwkb=function(){var t=new a(0,!0),e=r.getTwkbPrecision(5,0,0),n=0===this.points.length;if(this._writeTwkbHeader(t,o.wkb.LineString,e,n),this.points.length>0){t.writeVarInt(this.points.length);for(var i=new s(0,0,0,0),l=0;l<this.points.length;l++)this.points[l]._writeTwkbPoint(t,e,i)}return t.buffer},l.prototype._getWkbSize=function(){var t=16;return this.hasZ&&(t+=8),this.hasM&&(t+=8),9+this.points.length*t},l.prototype.toGeoJSON=function(t){var e=r.prototype.toGeoJSON.call(this,t);e.type=o.geoJSON.LineString,e.coordinates=[];for(var n=0;n<this.points.length;n++)this.hasZ?e.coordinates.push([this.points[n].x,this.points[n].y,this.points[n].z]):e.coordinates.push([this.points[n].x,this.points[n].y]);return e}},function(t,e,n){t.exports=l;var i=n(34),r=n(28),o=n(23),s=n(29),a=n(30);function l(t,e,n){r.call(this),this.exteriorRing=t||[],this.interiorRings=e||[],this.srid=n,this.exteriorRing.length>0&&(this.hasZ=this.exteriorRing[0].hasZ,this.hasM=this.exteriorRing[0].hasM)}i.inherits(l,r),l.Z=function(t,e,n){var i=new l(t,e,n);return i.hasZ=!0,i},l.M=function(t,e,n){var i=new l(t,e,n);return i.hasM=!0,i},l.ZM=function(t,e,n){var i=new l(t,e,n);return i.hasZ=!0,i.hasM=!0,i},l._parseWkt=function(t,e){var n=new l;if(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.isMatch(["EMPTY"]))return n;for(t.expectGroupStart(),t.expectGroupStart(),n.exteriorRing.push.apply(n.exteriorRing,t.matchCoordinates(e)),t.expectGroupEnd();t.isMatch([","]);)t.expectGroupStart(),n.interiorRings.push(t.matchCoordinates(e)),t.expectGroupEnd();return t.expectGroupEnd(),n},l._parseWkb=function(t,e){var n=new l;n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM;var i=t.readUInt32();if(i>0){for(var r=t.readUInt32(),o=0;o<r;o++)n.exteriorRing.push(s._readWkbPoint(t,e));for(o=1;o<i;o++){for(var a=[],u=t.readUInt32(),c=0;c<u;c++)a.push(s._readWkbPoint(t,e));n.interiorRings.push(a)}}return n},l._parseTwkb=function(t,e){var n=new l;if(n.hasZ=e.hasZ,n.hasM=e.hasM,e.isEmpty)return n;for(var i=new s(0,0,e.hasZ?0:void 0,e.hasM?0:void 0),r=t.readVarInt(),o=t.readVarInt(),a=0;a<o;a++)n.exteriorRing.push(s._readTwkbPoint(t,e,i));for(a=1;a<r;a++){for(var u=[],c=t.readVarInt(),h=0;h<c;h++)u.push(s._readTwkbPoint(t,e,i));n.interiorRings.push(u)}return n},l._parseGeoJSON=function(t){var e=new l;t.coordinates.length>0&&t.coordinates[0].length>0&&(e.hasZ=t.coordinates[0][0].length>2);for(var n=0;n<t.coordinates.length;n++){n>0&&e.interiorRings.push([]);for(var i=0;i<t.coordinates[n].length;i++)0===n?e.exteriorRing.push(s._readGeoJSONPoint(t.coordinates[n][i])):e.interiorRings[n-1].push(s._readGeoJSONPoint(t.coordinates[n][i]))}return e},l.prototype.toWkt=function(){return 0===this.exteriorRing.length?this._getWktType(o.wkt.Polygon,!0):this._getWktType(o.wkt.Polygon,!1)+this._toInnerWkt()},l.prototype._toInnerWkt=function(){for(var t="((",e=0;e<this.exteriorRing.length;e++)t+=this._getWktCoordinate(this.exteriorRing[e])+",";for(t=t.slice(0,-1),t+=")",e=0;e<this.interiorRings.length;e++){t+=",(";for(var n=0;n<this.interiorRings[e].length;n++)t+=this._getWktCoordinate(this.interiorRings[e][n])+",";t=t.slice(0,-1),t+=")"}return t+=")"},l.prototype.toWkb=function(t){var e=new a(this._getWkbSize());e.writeInt8(1),this._writeWkbType(e,o.wkb.Polygon,t),this.exteriorRing.length>0?(e.writeUInt32LE(1+this.interiorRings.length),e.writeUInt32LE(this.exteriorRing.length)):e.writeUInt32LE(0);for(var n=0;n<this.exteriorRing.length;n++)this.exteriorRing[n]._writeWkbPoint(e);for(n=0;n<this.interiorRings.length;n++){e.writeUInt32LE(this.interiorRings[n].length);for(var i=0;i<this.interiorRings[n].length;i++)this.interiorRings[n][i]._writeWkbPoint(e)}return e.buffer},l.prototype.toTwkb=function(){var t=new a(0,!0),e=r.getTwkbPrecision(5,0,0),n=0===this.exteriorRing.length;if(this._writeTwkbHeader(t,o.wkb.Polygon,e,n),this.exteriorRing.length>0){t.writeVarInt(1+this.interiorRings.length),t.writeVarInt(this.exteriorRing.length);for(var i=new s(0,0,0,0),l=0;l<this.exteriorRing.length;l++)this.exteriorRing[l]._writeTwkbPoint(t,e,i);for(l=0;l<this.interiorRings.length;l++){t.writeVarInt(this.interiorRings[l].length);for(var u=0;u<this.interiorRings[l].length;u++)this.interiorRings[l][u]._writeTwkbPoint(t,e,i)}}return t.buffer},l.prototype._getWkbSize=function(){var t=16;this.hasZ&&(t+=8),this.hasM&&(t+=8);var e=9;this.exteriorRing.length>0&&(e+=4+this.exteriorRing.length*t);for(var n=0;n<this.interiorRings.length;n++)e+=4+this.interiorRings[n].length*t;return e},l.prototype.toGeoJSON=function(t){var e=r.prototype.toGeoJSON.call(this,t);if(e.type=o.geoJSON.Polygon,e.coordinates=[],this.exteriorRing.length>0){for(var n=[],i=0;i<this.exteriorRing.length;i++)this.hasZ?n.push([this.exteriorRing[i].x,this.exteriorRing[i].y,this.exteriorRing[i].z]):n.push([this.exteriorRing[i].x,this.exteriorRing[i].y]);e.coordinates.push(n)}for(var s=0;s<this.interiorRings.length;s++){for(var a=[],l=0;l<this.interiorRings[s].length;l++)this.hasZ?a.push([this.interiorRings[s][l].x,this.interiorRings[s][l].y,this.interiorRings[s][l].z]):a.push([this.interiorRings[s][l].x,this.interiorRings[s][l].y]);e.coordinates.push(a)}return e}},function(t,e,n){"use strict";e.__esModule=!0;var i,r=n(3),o=(i=r)&&i.__esModule?i:{default:i};e.default=function(t){return function(){var e=t.apply(this,arguments);return new o.default((function(t,n){return function i(r,s){try{var a=e[r](s),l=a.value}catch(t){return void n(t)}if(!a.done)return o.default.resolve(l).then((function(t){i("next",t)}),(function(t){i("throw",t)}));t(l)}("next")}))}}},function(t,e,n){t.exports=!n(20)&&!n(33)((function(){return 7!=Object.defineProperty(n(53)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){"use strict";var i=n(20),r=n(41),o=n(61),s=n(51),a=n(38),l=n(55),u=Object.assign;t.exports=!u||n(33)((function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach((function(t){e[t]=t})),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=i}))?function(t,e){for(var n=a(t),u=arguments.length,c=1,h=o.f,p=s.f;u>c;)for(var f,d=l(arguments[c++]),g=h?r(d).concat(h(d)):r(d),y=g.length,m=0;y>m;)f=g[m++],i&&!p.call(d,f)||(n[f]=d[f]);return n}:u},function(t,e,n){var i=n(24),r=n(37),o=n(122)(!1),s=n(58)("IE_PROTO");t.exports=function(t,e){var n,a=r(t),l=0,u=[];for(n in a)n!=s&&i(a,n)&&u.push(n);for(;e.length>l;)i(a,n=e[l++])&&(~o(u,n)||u.push(n));return u}},function(t,e,n){"use strict";var i=n(43),r=n(11),o=n(63),s=n(27),a=n(39),l=n(126),u=n(45),c=n(85),h=n(14)("iterator"),p=!([].keys&&"next"in[].keys()),f=function(){return this};t.exports=function(t,e,n,d,g,y,m){l(n,e,d);var _,v,x,C=function(t){if(!p&&t in I)return I[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},w=e+" Iterator",b="values"==g,E=!1,I=t.prototype,P=I[h]||I["@@iterator"]||g&&I[g],N=P||C(g),S=g?b?C("entries"):N:void 0,T="Array"==e&&I.entries||P;if(T&&(x=c(T.call(new t)))!==Object.prototype&&x.next&&(u(x,w,!0),i||"function"==typeof x[h]||s(x,h,f)),b&&P&&"values"!==P.name&&(E=!0,N=function(){return P.call(this)}),i&&!m||!p&&!E&&I[h]||s(I,h,N),a[e]=N,a[w]=f,g)if(_={values:b?N:C("values"),keys:y?N:C("keys"),entries:S},m)for(v in _)v in I||o(I,v,_[v]);else r(r.P+r.F*(p||E),e,_);return _}},function(t,e,n){var i=n(19),r=n(83),o=n(60),s=n(58)("IE_PROTO"),a=function(){},l=function(){var t,e=n(53)("iframe"),i=o.length;for(e.style.display="none",n(84).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;i--;)delete l.prototype[o[i]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(a.prototype=i(t),n=new a,a.prototype=null,n[s]=t):n=l(),void 0===e?n:r(n,e)}},function(t,e,n){var i=n(18),r=n(19),o=n(41);t.exports=n(20)?Object.defineProperties:function(t,e){r(t);for(var n,s=o(e),a=s.length,l=0;a>l;)i.f(t,n=s[l++],e[n]);return t}},function(t,e,n){var i=n(12).document;t.exports=i&&i.documentElement},function(t,e,n){var i=n(24),r=n(38),o=n(58)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){var i=n(19);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&i(o.call(t)),e}}},function(t,e,n){var i=n(39),r=n(14)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},function(t,e,n){var i=n(19),r=n(40),o=n(14)("species");t.exports=function(t,e){var n,s=i(t).constructor;return void 0===s||null==(n=i(s)[o])?e:r(n)}},function(t,e,n){var i,r,o,s=n(32),a=n(131),l=n(84),u=n(53),c=n(12),h=c.process,p=c.setImmediate,f=c.clearImmediate,d=c.MessageChannel,g=c.Dispatch,y=0,m={},_=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},v=function(t){_.call(t.data)};p&&f||(p=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return m[++y]=function(){a("function"==typeof t?t:Function(t),e)},i(y),y},f=function(t){delete m[t]},"process"==n(42)(h)?i=function(t){h.nextTick(s(_,t,1))}:g&&g.now?i=function(t){g.now(s(_,t,1))}:d?(o=(r=new d).port2,r.port1.onmessage=v,i=s(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(i=function(t){c.postMessage(t+"","*")},c.addEventListener("message",v,!1)):i="onreadystatechange"in u("script")?function(t){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),_.call(t)}}:function(t){setTimeout(s(_,t,1),0)}),t.exports={set:p,clear:f}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var i=n(19),r=n(15),o=n(67);t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){var i=n(14)("iterator"),r=!1;try{var o=[7][i]();o.return=function(){r=!0},Array.from(o,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o=[7],s=o[i]();s.next=function(){return{done:n=!0}},o[i]=function(){return s},t(o)}catch(t){}return n}},function(t,e,n){var i=n(42);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(80),r=n(60).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(51),r=n(36),o=n(37),s=n(54),a=n(24),l=n(78),u=Object.getOwnPropertyDescriptor;e.f=n(20)?u:function(t,e){if(t=o(t),e=s(e,!0),l)try{return u(t,e)}catch(t){}if(a(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return t.apply(e,n)}}},function(t,e,n){"use strict";var i=n(16);function r(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var o;if(n)o=n(e);else if(i.isURLSearchParams(e))o=e.toString();else{var s=[];i.forEach(e,(function(t,e){null!=t&&(i.isArray(t)?e+="[]":t=[t],i.forEach(t,(function(t){i.isDate(t)?t=t.toISOString():i.isObject(t)&&(t=JSON.stringify(t)),s.push(r(e)+"="+r(t))})))})),o=s.join("&")}if(o){var a=t.indexOf("#");-1!==a&&(t=t.slice(0,a)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,n){"use strict";(function(e){var i=n(16),r=n(157),o={"Content-Type":"application/x-www-form-urlencoded"};function s(t,e){!i.isUndefined(t)&&i.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var a,l={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==e&&"[object process]"===Object.prototype.toString.call(e))&&(a=n(100)),a),transformRequest:[function(t,e){return r(e,"Accept"),r(e,"Content-Type"),i.isFormData(t)||i.isArrayBuffer(t)||i.isBuffer(t)||i.isStream(t)||i.isFile(t)||i.isBlob(t)?t:i.isArrayBufferView(t)?t.buffer:i.isURLSearchParams(t)?(s(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):i.isObject(t)?(s(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300}};l.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],(function(t){l.headers[t]={}})),i.forEach(["post","put","patch"],(function(t){l.headers[t]=i.merge(o)})),t.exports=l}).call(this,n(69))},function(t,e,n){"use strict";var i=n(16),r=n(158),o=n(160),s=n(97),a=n(161),l=n(164),u=n(165),c=n(101);t.exports=function(t){return new Promise((function(e,n){var h=t.data,p=t.headers;i.isFormData(h)&&delete p["Content-Type"],(i.isBlob(h)||i.isFile(h))&&h.type&&delete p["Content-Type"];var f=new XMLHttpRequest;if(t.auth){var d=t.auth.username||"",g=unescape(encodeURIComponent(t.auth.password))||"";p.Authorization="Basic "+btoa(d+":"+g)}var y=a(t.baseURL,t.url);if(f.open(t.method.toUpperCase(),s(y,t.params,t.paramsSerializer),!0),f.timeout=t.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var i="getAllResponseHeaders"in f?l(f.getAllResponseHeaders()):null,o={data:t.responseType&&"text"!==t.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:i,config:t,request:f};r(e,n,o),f=null}},f.onabort=function(){f&&(n(c("Request aborted",t,"ECONNABORTED",f)),f=null)},f.onerror=function(){n(c("Network Error",t,null,f)),f=null},f.ontimeout=function(){var e="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(c(e,t,"ECONNABORTED",f)),f=null},i.isStandardBrowserEnv()){var m=(t.withCredentials||u(y))&&t.xsrfCookieName?o.read(t.xsrfCookieName):void 0;m&&(p[t.xsrfHeaderName]=m)}if("setRequestHeader"in f&&i.forEach(p,(function(t,e){void 0===h&&"content-type"===e.toLowerCase()?delete p[e]:f.setRequestHeader(e,t)})),i.isUndefined(t.withCredentials)||(f.withCredentials=!!t.withCredentials),t.responseType)try{f.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&f.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){f&&(f.abort(),n(t),f=null)})),h||(h=null),f.send(h)}))}},function(t,e,n){"use strict";var i=n(159);t.exports=function(t,e,n,r,o){var s=new Error(t);return i(s,e,n,r,o)}},function(t,e,n){"use strict";var i=n(16);t.exports=function(t,e){e=e||{};var n={},r=["url","method","data"],o=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function l(t,e){return i.isPlainObject(t)&&i.isPlainObject(e)?i.merge(t,e):i.isPlainObject(e)?i.merge({},e):i.isArray(e)?e.slice():e}function u(r){i.isUndefined(e[r])?i.isUndefined(t[r])||(n[r]=l(void 0,t[r])):n[r]=l(t[r],e[r])}i.forEach(r,(function(t){i.isUndefined(e[t])||(n[t]=l(void 0,e[t]))})),i.forEach(o,u),i.forEach(s,(function(r){i.isUndefined(e[r])?i.isUndefined(t[r])||(n[r]=l(void 0,t[r])):n[r]=l(void 0,e[r])})),i.forEach(a,(function(i){i in e?n[i]=l(t[i],e[i]):i in t&&(n[i]=l(void 0,t[i]))}));var c=r.concat(o).concat(s).concat(a),h=Object.keys(t).concat(Object.keys(e)).filter((function(t){return-1===c.indexOf(t)}));return i.forEach(h,u),n}},function(t,e,n){"use strict";function i(t){this.message=t}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,t.exports=i},function(t,e){t.exports={encode:function(t){return t<<1^t>>31},decode:function(t){return t>>1^-(1&t)}}},function(t,e,n){t.exports=l;var i=n(34),r=n(23),o=n(28),s=n(29),a=n(30);function l(t,e){o.call(this),this.points=t||[],this.srid=e,this.points.length>0&&(this.hasZ=this.points[0].hasZ,this.hasM=this.points[0].hasM)}i.inherits(l,o),l.Z=function(t,e){var n=new l(t,e);return n.hasZ=!0,n},l.M=function(t,e){var n=new l(t,e);return n.hasM=!0,n},l.ZM=function(t,e){var n=new l(t,e);return n.hasZ=!0,n.hasM=!0,n},l._parseWkt=function(t,e){var n=new l;return n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.isMatch(["EMPTY"])||(t.expectGroupStart(),n.points.push.apply(n.points,t.matchCoordinates(e)),t.expectGroupEnd()),n},l._parseWkb=function(t,e){var n=new l;n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM;for(var i=t.readUInt32(),r=0;r<i;r++)n.points.push(o.parse(t,e));return n},l._parseTwkb=function(t,e){var n=new l;if(n.hasZ=e.hasZ,n.hasM=e.hasM,e.isEmpty)return n;for(var i=new s(0,0,e.hasZ?0:void 0,e.hasM?0:void 0),r=t.readVarInt(),o=0;o<r;o++)n.points.push(s._readTwkbPoint(t,e,i));return n},l._parseGeoJSON=function(t){var e=new l;t.coordinates.length>0&&(e.hasZ=t.coordinates[0].length>2);for(var n=0;n<t.coordinates.length;n++)e.points.push(s._parseGeoJSON({coordinates:t.coordinates[n]}));return e},l.prototype.toWkt=function(){if(0===this.points.length)return this._getWktType(r.wkt.MultiPoint,!0);for(var t=this._getWktType(r.wkt.MultiPoint,!1)+"(",e=0;e<this.points.length;e++)t+=this._getWktCoordinate(this.points[e])+",";return t=t.slice(0,-1),t+=")"},l.prototype.toWkb=function(){var t=new a(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,r.wkb.MultiPoint),t.writeUInt32LE(this.points.length);for(var e=0;e<this.points.length;e++)t.writeBuffer(this.points[e].toWkb({srid:this.srid}));return t.buffer},l.prototype.toTwkb=function(){var t=new a(0,!0),e=o.getTwkbPrecision(5,0,0),n=0===this.points.length;if(this._writeTwkbHeader(t,r.wkb.MultiPoint,e,n),this.points.length>0){t.writeVarInt(this.points.length);for(var i=new s(0,0,0,0),l=0;l<this.points.length;l++)this.points[l]._writeTwkbPoint(t,e,i)}return t.buffer},l.prototype._getWkbSize=function(){var t=16;return this.hasZ&&(t+=8),this.hasM&&(t+=8),t+=5,9+this.points.length*t},l.prototype.toGeoJSON=function(t){var e=o.prototype.toGeoJSON.call(this,t);e.type=r.geoJSON.MultiPoint,e.coordinates=[];for(var n=0;n<this.points.length;n++)e.coordinates.push(this.points[n].toGeoJSON().coordinates);return e}},function(t,e,n){t.exports=u;var i=n(34),r=n(23),o=n(28),s=n(29),a=n(75),l=n(30);function u(t,e){o.call(this),this.lineStrings=t||[],this.srid=e,this.lineStrings.length>0&&(this.hasZ=this.lineStrings[0].hasZ,this.hasM=this.lineStrings[0].hasM)}i.inherits(u,o),u.Z=function(t,e){var n=new u(t,e);return n.hasZ=!0,n},u.M=function(t,e){var n=new u(t,e);return n.hasM=!0,n},u.ZM=function(t,e){var n=new u(t,e);return n.hasZ=!0,n.hasM=!0,n},u._parseWkt=function(t,e){var n=new u;if(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.isMatch(["EMPTY"]))return n;t.expectGroupStart();do{t.expectGroupStart(),n.lineStrings.push(new a(t.matchCoordinates(e))),t.expectGroupEnd()}while(t.isMatch([","]));return t.expectGroupEnd(),n},u._parseWkb=function(t,e){var n=new u;n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM;for(var i=t.readUInt32(),r=0;r<i;r++)n.lineStrings.push(o.parse(t,e));return n},u._parseTwkb=function(t,e){var n=new u;if(n.hasZ=e.hasZ,n.hasM=e.hasM,e.isEmpty)return n;for(var i=new s(0,0,e.hasZ?0:void 0,e.hasM?0:void 0),r=t.readVarInt(),o=0;o<r;o++){var l=new a;l.hasZ=e.hasZ,l.hasM=e.hasM;for(var c=t.readVarInt(),h=0;h<c;h++)l.points.push(s._readTwkbPoint(t,e,i));n.lineStrings.push(l)}return n},u._parseGeoJSON=function(t){var e=new u;t.coordinates.length>0&&t.coordinates[0].length>0&&(e.hasZ=t.coordinates[0][0].length>2);for(var n=0;n<t.coordinates.length;n++)e.lineStrings.push(a._parseGeoJSON({coordinates:t.coordinates[n]}));return e},u.prototype.toWkt=function(){if(0===this.lineStrings.length)return this._getWktType(r.wkt.MultiLineString,!0);for(var t=this._getWktType(r.wkt.MultiLineString,!1)+"(",e=0;e<this.lineStrings.length;e++)t+=this.lineStrings[e]._toInnerWkt()+",";return t=t.slice(0,-1),t+=")"},u.prototype.toWkb=function(){var t=new l(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,r.wkb.MultiLineString),t.writeUInt32LE(this.lineStrings.length);for(var e=0;e<this.lineStrings.length;e++)t.writeBuffer(this.lineStrings[e].toWkb({srid:this.srid}));return t.buffer},u.prototype.toTwkb=function(){var t=new l(0,!0),e=o.getTwkbPrecision(5,0,0),n=0===this.lineStrings.length;if(this._writeTwkbHeader(t,r.wkb.MultiLineString,e,n),this.lineStrings.length>0){t.writeVarInt(this.lineStrings.length);for(var i=new s(0,0,0,0),a=0;a<this.lineStrings.length;a++){t.writeVarInt(this.lineStrings[a].points.length);for(var u=0;u<this.lineStrings[a].points.length;u++)this.lineStrings[a].points[u]._writeTwkbPoint(t,e,i)}}return t.buffer},u.prototype._getWkbSize=function(){for(var t=9,e=0;e<this.lineStrings.length;e++)t+=this.lineStrings[e]._getWkbSize();return t},u.prototype.toGeoJSON=function(t){var e=o.prototype.toGeoJSON.call(this,t);e.type=r.geoJSON.MultiLineString,e.coordinates=[];for(var n=0;n<this.lineStrings.length;n++)e.coordinates.push(this.lineStrings[n].toGeoJSON().coordinates);return e}},function(t,e,n){t.exports=u;var i=n(34),r=n(23),o=n(28),s=n(29),a=n(76),l=n(30);function u(t,e){o.call(this),this.polygons=t||[],this.srid=e,this.polygons.length>0&&(this.hasZ=this.polygons[0].hasZ,this.hasM=this.polygons[0].hasM)}i.inherits(u,o),u.Z=function(t,e){var n=new u(t,e);return n.hasZ=!0,n},u.M=function(t,e){var n=new u(t,e);return n.hasM=!0,n},u.ZM=function(t,e){var n=new u(t,e);return n.hasZ=!0,n.hasM=!0,n},u._parseWkt=function(t,e){var n=new u;if(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.isMatch(["EMPTY"]))return n;t.expectGroupStart();do{t.expectGroupStart();var i=[],r=[];for(t.expectGroupStart(),i.push.apply(i,t.matchCoordinates(e)),t.expectGroupEnd();t.isMatch([","]);)t.expectGroupStart(),r.push(t.matchCoordinates(e)),t.expectGroupEnd();n.polygons.push(new a(i,r)),t.expectGroupEnd()}while(t.isMatch([","]));return t.expectGroupEnd(),n},u._parseWkb=function(t,e){var n=new u;n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM;for(var i=t.readUInt32(),r=0;r<i;r++)n.polygons.push(o.parse(t,e));return n},u._parseTwkb=function(t,e){var n=new u;if(n.hasZ=e.hasZ,n.hasM=e.hasM,e.isEmpty)return n;for(var i=new s(0,0,e.hasZ?0:void 0,e.hasM?0:void 0),r=t.readVarInt(),o=0;o<r;o++){var l=new a;l.hasZ=e.hasZ,l.hasM=e.hasM;for(var c=t.readVarInt(),h=t.readVarInt(),p=0;p<h;p++)l.exteriorRing.push(s._readTwkbPoint(t,e,i));for(p=1;p<c;p++){for(var f=[],d=t.readVarInt(),g=0;g<d;g++)f.push(s._readTwkbPoint(t,e,i));l.interiorRings.push(f)}n.polygons.push(l)}return n},u._parseGeoJSON=function(t){var e=new u;t.coordinates.length>0&&t.coordinates[0].length>0&&t.coordinates[0][0].length>0&&(e.hasZ=t.coordinates[0][0][0].length>2);for(var n=0;n<t.coordinates.length;n++)e.polygons.push(a._parseGeoJSON({coordinates:t.coordinates[n]}));return e},u.prototype.toWkt=function(){if(0===this.polygons.length)return this._getWktType(r.wkt.MultiPolygon,!0);for(var t=this._getWktType(r.wkt.MultiPolygon,!1)+"(",e=0;e<this.polygons.length;e++)t+=this.polygons[e]._toInnerWkt()+",";return t=t.slice(0,-1),t+=")"},u.prototype.toWkb=function(){var t=new l(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,r.wkb.MultiPolygon),t.writeUInt32LE(this.polygons.length);for(var e=0;e<this.polygons.length;e++)t.writeBuffer(this.polygons[e].toWkb({srid:this.srid}));return t.buffer},u.prototype.toTwkb=function(){var t=new l(0,!0),e=o.getTwkbPrecision(5,0,0),n=0===this.polygons.length;if(this._writeTwkbHeader(t,r.wkb.MultiPolygon,e,n),this.polygons.length>0){t.writeVarInt(this.polygons.length);for(var i=new s(0,0,0,0),a=0;a<this.polygons.length;a++){t.writeVarInt(1+this.polygons[a].interiorRings.length),t.writeVarInt(this.polygons[a].exteriorRing.length);for(var u=0;u<this.polygons[a].exteriorRing.length;u++)this.polygons[a].exteriorRing[u]._writeTwkbPoint(t,e,i);for(u=0;u<this.polygons[a].interiorRings.length;u++){t.writeVarInt(this.polygons[a].interiorRings[u].length);for(var c=0;c<this.polygons[a].interiorRings[u].length;c++)this.polygons[a].interiorRings[u][c]._writeTwkbPoint(t,e,i)}}}return t.buffer},u.prototype._getWkbSize=function(){for(var t=9,e=0;e<this.polygons.length;e++)t+=this.polygons[e]._getWkbSize();return t},u.prototype.toGeoJSON=function(t){var e=o.prototype.toGeoJSON.call(this,t);e.type=r.geoJSON.MultiPolygon,e.coordinates=[];for(var n=0;n<this.polygons.length;n++)e.coordinates.push(this.polygons[n].toGeoJSON().coordinates);return e}},function(t,e,n){t.exports=a;var i=n(34),r=n(23),o=n(28),s=n(30);function a(t,e){o.call(this),this.geometries=t||[],this.srid=e,this.geometries.length>0&&(this.hasZ=this.geometries[0].hasZ,this.hasM=this.geometries[0].hasM)}i.inherits(a,o),a.Z=function(t,e){var n=new a(t,e);return n.hasZ=!0,n},a.M=function(t,e){var n=new a(t,e);return n.hasM=!0,n},a.ZM=function(t,e){var n=new a(t,e);return n.hasZ=!0,n.hasM=!0,n},a._parseWkt=function(t,e){var n=new a;if(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.isMatch(["EMPTY"]))return n;t.expectGroupStart();do{n.geometries.push(o.parse(t))}while(t.isMatch([","]));return t.expectGroupEnd(),n},a._parseWkb=function(t,e){var n=new a;n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM;for(var i=t.readUInt32(),r=0;r<i;r++)n.geometries.push(o.parse(t,e));return n},a._parseTwkb=function(t,e){var n=new a;if(n.hasZ=e.hasZ,n.hasM=e.hasM,e.isEmpty)return n;for(var i=t.readVarInt(),r=0;r<i;r++)n.geometries.push(o.parseTwkb(t));return n},a._parseGeoJSON=function(t){for(var e=new a,n=0;n<t.geometries.length;n++)e.geometries.push(o._parseGeoJSON(t.geometries[n],!0));return e.geometries.length>0&&(e.hasZ=e.geometries[0].hasZ),e},a.prototype.toWkt=function(){if(0===this.geometries.length)return this._getWktType(r.wkt.GeometryCollection,!0);for(var t=this._getWktType(r.wkt.GeometryCollection,!1)+"(",e=0;e<this.geometries.length;e++)t+=this.geometries[e].toWkt()+",";return t=t.slice(0,-1),t+=")"},a.prototype.toWkb=function(){var t=new s(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,r.wkb.GeometryCollection),t.writeUInt32LE(this.geometries.length);for(var e=0;e<this.geometries.length;e++)t.writeBuffer(this.geometries[e].toWkb({srid:this.srid}));return t.buffer},a.prototype.toTwkb=function(){var t=new s(0,!0),e=o.getTwkbPrecision(5,0,0),n=0===this.geometries.length;if(this._writeTwkbHeader(t,r.wkb.GeometryCollection,e,n),this.geometries.length>0){t.writeVarInt(this.geometries.length);for(var i=0;i<this.geometries.length;i++)t.writeBuffer(this.geometries[i].toTwkb())}return t.buffer},a.prototype._getWkbSize=function(){for(var t=9,e=0;e<this.geometries.length;e++)t+=this.geometries[e]._getWkbSize();return t},a.prototype.toGeoJSON=function(t){var e=o.prototype.toGeoJSON.call(this,t);e.type=r.geoJSON.GeometryCollection,e.geometries=[];for(var n=0;n<this.geometries.length;n++)e.geometries.push(this.geometries[n].toGeoJSON());return e}},function(t,e,n){var i=n(11),r=n(9),o=n(33);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],s={};s[t]=e(n),i(i.S+i.F*o((function(){n(1)})),"Object",s)}},function(t,e,n){t.exports={default:n(202),__esModule:!0}},function(t,e,n){t.exports={default:n(171),__esModule:!0}},function(t,e,n){t.exports={default:n(173),__esModule:!0}},function(t,e,n){"use strict";n.r(e),n.d(e,"add",(function(){return c})),n.d(e,"remove",(function(){return h})),n.d(e,"setMain",(function(){return p})),n.d(e,"syncView",(function(){return u})),n.d(e,"onMainChange",(function(){return f}));var i=n(6),r=n.n(i),o=[],s=null,a=[],l=function(){},u=function(){if(s){var t=s.camera,e=!0,n=!1,i=void 0;try{for(var a,l=r()(o);!(e=(a=l.next()).done);e=!0){var u=a.value;u.viewer!==s&&u.viewer.camera.setView({destination:t.positionWC,orientation:{heading:t.heading,pitch:t.pitch,roll:t.roll}})}}catch(t){n=!0,i=t}finally{try{!e&&l.return&&l.return()}finally{if(n)throw i}}}},c=function(t){t&&(!function(t){if(t&&!o.find((function(e){return e.viewer===t}))){t.scene.preRender.addEventListener(u);var e=new Cesium.ScreenSpaceEventHandler(t.scene.canvas);e.setInputAction((function(){var e=s;e!==(s=t)&&d(s,e)}),Cesium.ScreenSpaceEventType.LEFT_DOWN),o.push({viewer:t,sseh:e})}}(t.viewer),a.push(t))},h=function(t){if(t){!function(t){for(var e=o.length-1;e>=0;e--){var n=o[e];n.viewer===t&&(n.sseh.destroy(),n.sseh=null,t.scene.preRender.removeEventListener(u),o.splice(e,1))}}(t.viewer);var e=a.indexOf(t);e>=0&&a.splice(e,1)}},p=function(t){var e=s;t&&t.viewer&&(s=t.viewer),e!==s&&d(s,e)},f=function(t){t&&(l=t)};function d(t,e){var n=a.find((function(e){return e.viewer===t})),i=a.find((function(t){return t.viewer===e}));l(n,i)}},function(t,e,n){const i=n(185);class r{static convertPolygonToWK(){throw new Error("method is deprecated, use convertToWK instead")}static convertToWK(t,e="wkt"){const n="Feature"===t.type?t.geometry:t,r=i.Geometry.parseGeoJSON(n);return"wkt"===e?r.toWkt():r.toWkb()}static parseFromWK(t,e=!1,n={}){const r=i.Geometry.parse(t).toGeoJSON();return e?{type:"Feature",geometry:r,properties:n}:r}static convertFeatureCollection(t){if("FeatureCollection"!==t.type)throw new Error("GeoJSON is not a FeatureCollection");return`GEOMETRYCOLLECTION(${t.features.map(t=>r.convertToWK(t)).join(",")})`}}t.exports=r},function(t,e,n){
/**
 * JSTS. See https://github.com/bjornharrtell/jsts
 * https://github.com/bjornharrtell/jsts/blob/master/LICENSE_EDLv1.txt
 * https://github.com/bjornharrtell/jsts/blob/master/LICENSE_EPLv1.txt
 * @license
 */
!function(t){"use strict";class e{static equalsWithTolerance(t,e,n){return Math.abs(t-e)<=n}}class n extends Error{constructor(t){super(t),this.name=Object.keys({Exception:n})[0]}toString(){return this.message}}class i extends n{constructor(t){super(t),this.name=Object.keys({IllegalArgumentException:i})[0]}}class r{constructor(t,e){this.low=e||0,this.high=t||0}static toBinaryString(t){let e,n="";for(e=2147483648;e>0;e>>>=1)n+=(t.high&e)===e?"1":"0";for(e=2147483648;e>0;e>>>=1)n+=(t.low&e)===e?"1":"0";return n}}function o(){}function s(){}function a(){}function l(){}function u(){}o.NaN=NaN,o.isNaN=t=>Number.isNaN(t),o.isInfinite=t=>!Number.isFinite(t),o.MAX_VALUE=Number.MAX_VALUE,o.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,o.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,"function"==typeof Float64Array&&"function"==typeof Int32Array?function(){const t=new Float64Array(1),e=new Int32Array(t.buffer);o.doubleToLongBits=function(n){t[0]=n;let i=0|e[0],o=0|e[1];return 2146435072==(2146435072&o)&&0!=(1048575&o)&&0!==i&&(i=0,o=2146959360),new r(o,i)},o.longBitsToDouble=function(n){return e[0]=n.low,e[1]=n.high,t[0]}}():function(){const t=Math.log2,e=Math.floor,n=Math.pow,i=function(){for(let i=53;i>0;i--){const r=n(2,i)-1;if(e(t(r))+1===i)return r}return 0}();o.doubleToLongBits=function(o){let s,a,l,u,c,h,p,f,d;if(o<0||1/o===Number.NEGATIVE_INFINITY?(h=1<<31,o=-o):h=0,0===o)return d=0,f=h,new r(f,d);if(o===1/0)return d=0,f=2146435072|h,new r(f,d);if(o!=o)return d=0,f=2146959360,new r(f,d);if(u=0,d=0,s=e(o),s>1)if(s<=i)u=e(t(s)),u<=20?(d=0,f=s<<20-u&1048575):(l=u-20,a=n(2,l),d=s%a<<32-l,f=s/a&1048575);else for(l=s,d=0;a=l/2,l=e(a),0!==l;)u++,d>>>=1,d|=(1&f)<<31,f>>>=1,a!==l&&(f|=524288);if(p=u+1023,c=0===s,s=o-s,u<52&&0!==s)for(l=0;;){if(a=2*s,a>=1?(s=a-1,c?(p--,c=!1):(l<<=1,l|=1,u++)):(s=a,c?0==--p&&(u++,c=!1):(l<<=1,u++)),20===u)f|=l,l=0;else if(52===u){d|=l;break}if(1===a){u<20?f|=l<<20-u:u<52&&(d|=l<<52-u);break}}return f|=p<<20,f|=h,new r(f,d)},o.longBitsToDouble=function(t){let e,i,r,o;const s=t.high,a=t.low,l=s&1<<31?-1:1;for(r=((2146435072&s)>>20)-1023,o=0,i=1<<19,e=1;e<=20;e++)s&i&&(o+=n(2,-e)),i>>>=1;for(i=1<<31,e=21;e<=52;e++)a&i&&(o+=n(2,-e)),i>>>=1;if(-1023===r){if(0===o)return 0*l;r=-1022}else{if(1024===r)return 0===o?l/0:NaN;o+=1}return l*o*n(2,r)}}();class c extends n{constructor(t){super(t),this.name=Object.keys({RuntimeException:c})[0]}}class h extends c{constructor(){super(),h.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length)c.constructor_.call(this);else if(1===arguments.length){const t=arguments[0];c.constructor_.call(this,t)}}}class p{static shouldNeverReachHere(){if(0===arguments.length)p.shouldNeverReachHere(null);else if(1===arguments.length){const t=arguments[0];throw new h("Should never reach here"+(null!==t?": "+t:""))}}static isTrue(){if(1===arguments.length){const t=arguments[0];p.isTrue(t,null)}else if(2===arguments.length){const t=arguments[1];if(!arguments[0])throw null===t?new h:new h(t)}}static equals(){if(2===arguments.length){const t=arguments[0],e=arguments[1];p.equals(t,e,null)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(!e.equals(t))throw new h("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))}}}const f=new ArrayBuffer(8),d=new Float64Array(f),g=new Int32Array(f);class y{constructor(){y.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)y.constructor_.call(this,0,0);else if(1===arguments.length){const t=arguments[0];y.constructor_.call(this,t.x,t.y,t.getZ())}else if(2===arguments.length){const t=arguments[0],e=arguments[1];y.constructor_.call(this,t,e,y.NULL_ORDINATE)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.x=t,this.y=e,this.z=n}}static hashCode(t){return d[0]=t,g[0]^g[1]}getM(){return o.NaN}setOrdinate(t,e){switch(t){case y.X:this.x=e;break;case y.Y:this.y=e;break;case y.Z:this.setZ(e);break;default:throw new i("Invalid ordinate index: "+t)}}equals2D(){if(1===arguments.length){const t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){const t=arguments[0],n=arguments[1];return!!e.equalsWithTolerance(this.x,t.x,n)&&!!e.equalsWithTolerance(this.y,t.y,n)}}setM(t){throw new i("Invalid ordinate index: "+y.M)}getZ(){return this.z}getOrdinate(t){switch(t){case y.X:return this.x;case y.Y:return this.y;case y.Z:return this.getZ()}throw new i("Invalid ordinate index: "+t)}equals3D(t){return this.x===t.x&&this.y===t.y&&(this.getZ()===t.getZ()||o.isNaN(this.getZ())&&o.isNaN(t.getZ()))}equals(t){return t instanceof y&&this.equals2D(t)}equalInZ(t,n){return e.equalsWithTolerance(this.getZ(),t.getZ(),n)}setX(t){this.x=t}compareTo(t){const e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}getX(){return this.x}setZ(t){this.z=t}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return p.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}copy(){return new y(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}distance3D(t){const e=this.x-t.x,n=this.y-t.y,i=this.getZ()-t.getZ();return Math.sqrt(e*e+n*n+i*i)}getY(){return this.y}setY(t){this.y=t}distance(t){const e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)}hashCode(){let t=17;return t=37*t+y.hashCode(this.x),t=37*t+y.hashCode(this.y),t}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}get interfaces_(){return[s,a,u]}}class m{constructor(){m.constructor_.apply(this,arguments)}static constructor_(){if(this._dimensionsToTest=2,0===arguments.length)m.constructor_.call(this,2);else if(1===arguments.length){const t=arguments[0];if(2!==t&&3!==t)throw new i("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}static compare(t,e){return t<e?-1:t>e?1:o.isNaN(t)?o.isNaN(e)?0:-1:o.isNaN(e)?1:0}compare(t,e){const n=m.compare(t.x,e.x);if(0!==n)return n;const i=m.compare(t.y,e.y);return 0!==i?i:this._dimensionsToTest<=2?0:m.compare(t.getZ(),e.getZ())}get interfaces_(){return[l]}}y.DimensionalComparator=m,y.NULL_ORDINATE=o.NaN,y.X=0,y.Y=1,y.Z=2,y.M=3;class _ extends y{constructor(){super(),_.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length)y.constructor_.call(this);else if(1===arguments.length){if(arguments[0]instanceof _){const t=arguments[0];y.constructor_.call(this,t.x,t.y)}else if(arguments[0]instanceof y){const t=arguments[0];y.constructor_.call(this,t.x,t.y)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];y.constructor_.call(this,t,e,y.NULL_ORDINATE)}}setOrdinate(t,e){switch(t){case _.X:this.x=e;break;case _.Y:this.y=e;break;default:throw new i("Invalid ordinate index: "+t)}}getZ(){return y.NULL_ORDINATE}getOrdinate(t){switch(t){case _.X:return this.x;case _.Y:return this.y}throw new i("Invalid ordinate index: "+t)}setZ(t){throw new i("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new _(this)}toString(){return"("+this.x+", "+this.y+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}}_.X=0,_.Y=1,_.Z=-1,_.M=-1;class v extends y{constructor(){super(),v.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,0===arguments.length)y.constructor_.call(this),this._m=0;else if(1===arguments.length){if(arguments[0]instanceof v){const t=arguments[0];y.constructor_.call(this,t.x,t.y),this._m=t._m}else if(arguments[0]instanceof y){const t=arguments[0];y.constructor_.call(this,t.x,t.y),this._m=this.getM()}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];y.constructor_.call(this,t,e,y.NULL_ORDINATE),this._m=n}}getM(){return this._m}setOrdinate(t,e){switch(t){case v.X:this.x=e;break;case v.Y:this.y=e;break;case v.M:this._m=e;break;default:throw new i("Invalid ordinate index: "+t)}}setM(t){this._m=t}getZ(){return y.NULL_ORDINATE}getOrdinate(t){switch(t){case v.X:return this.x;case v.Y:return this.y;case v.M:return this._m}throw new i("Invalid ordinate index: "+t)}setZ(t){throw new i("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new v(this)}toString(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}v.X=0,v.Y=1,v.Z=-1,v.M=2;class x extends y{constructor(){super(),x.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,0===arguments.length)y.constructor_.call(this),this._m=0;else if(1===arguments.length){if(arguments[0]instanceof x){const t=arguments[0];y.constructor_.call(this,t),this._m=t._m}else if(arguments[0]instanceof y){const t=arguments[0];y.constructor_.call(this,t),this._m=this.getM()}}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];y.constructor_.call(this,t,e,n),this._m=i}}getM(){return this._m}setOrdinate(t,e){switch(t){case y.X:this.x=e;break;case y.Y:this.y=e;break;case y.Z:this.z=e;break;case y.M:this._m=e;break;default:throw new i("Invalid ordinate index: "+t)}}setM(t){this._m=t}getOrdinate(t){switch(t){case y.X:return this.x;case y.Y:return this.y;case y.Z:return this.getZ();case y.M:return this.getM()}throw new i("Invalid ordinate index: "+t)}copy(){return new x(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}function C(t,e){return t.interfaces_&&t.interfaces_.indexOf(e)>-1}class w{add(){}addAll(){}isEmpty(){}iterator(){}size(){}toArray(){}remove(){}}class b extends n{constructor(t){super(t),this.name=Object.keys({IndexOutOfBoundsException:b})[0]}}class E extends w{get(){}set(){}isEmpty(){}}class I extends n{constructor(t){super(t),this.name=Object.keys({NoSuchElementException:I})[0]}}class P extends E{constructor(t){super(),this.array=[],t instanceof w&&this.addAll(t)}get interfaces_(){return[E,w]}ensureCapacity(){}add(t){return 1===arguments.length?this.array.push(t):this.array.splice(arguments[0],0,arguments[1]),!0}clear(){this.array=[]}addAll(t){for(const e of t)this.array.push(e)}set(t,e){const n=this.array[t];return this.array[t]=e,n}iterator(){return new N(this)}get(t){if(t<0||t>=this.size())throw new b;return this.array[t]}isEmpty(){return 0===this.array.length}sort(t){t?this.array.sort((e,n)=>t.compare(e,n)):this.array.sort()}size(){return this.array.length}toArray(){return this.array.slice()}remove(t){for(let e=0,n=this.array.length;e<n;e++)if(this.array[e]===t)return!!this.array.splice(e,1);return!1}[Symbol.iterator](){return this.array.values()}}class N{constructor(t){this.arrayList=t,this.position=0}next(){if(this.position===this.arrayList.size())throw new I;return this.arrayList.get(this.position++)}hasNext(){return this.position<this.arrayList.size()}set(t){return this.arrayList.set(this.position-1,t)}remove(){this.arrayList.remove(this.arrayList.get(this.position))}}class S extends P{constructor(){super(),S.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.ensureCapacity(t.length),this.add(t,e)}}getCoordinate(t){return this.get(t)}addAll(){if(2===arguments.length&&"boolean"==typeof arguments[1]&&C(arguments[0],w)){const t=arguments[1];let e=!1;for(let n=arguments[0].iterator();n.hasNext();)this.add(n.next(),t),e=!0;return e}return super.addAll.apply(this,arguments)}clone(){const t=super.clone.call(this);for(let e=0;e<this.size();e++)t.add(e,this.get(e).clone());return t}toCoordinateArray(){if(0===arguments.length)return this.toArray(S.coordArrayType);if(1===arguments.length){if(arguments[0])return this.toArray(S.coordArrayType);const t=this.size(),e=new Array(t).fill(null);for(let n=0;n<t;n++)e[n]=this.get(t-n-1);return e}}add(){if(1===arguments.length){const t=arguments[0];return super.add.call(this,t)}if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return this.add(t,e,!0),!0}if(arguments[0]instanceof y&&"boolean"==typeof arguments[1]){const t=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(t))return null;super.add.call(this,t)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return this.add(t,e),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1];if(arguments[2])for(let n=0;n<t.length;n++)this.add(t[n],e);else for(let n=t.length-1;n>=0;n--)this.add(t[n],e);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof y){const t=arguments[0],e=arguments[1];if(!arguments[2]){const n=this.size();if(n>0){if(t>0&&this.get(t-1).equals2D(e))return null;if(t<n&&this.get(t).equals2D(e))return null}}super.add.call(this,t,e)}}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];let r=1;n>i&&(r=-1);for(let o=n;o!==i;o+=r)this.add(t[o],e);return!0}}closeRing(){if(this.size()>0){const t=this.get(0).copy();this.add(t,!1)}}}S.coordArrayType=new Array(0).fill(null);class T{filter(t,e){}isDone(){}isGeometryChanged(){}}class L{constructor(){L.constructor_.apply(this,arguments)}static constructor_(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof y){const t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof L){const t=arguments[0];this.init(t)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.init(t,e,n,i)}}static intersects(){if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];let r=Math.min(n.x,i.x),o=Math.max(n.x,i.x),s=Math.min(t.x,e.x),a=Math.max(t.x,e.x);return!(s>o||a<r||(r=Math.min(n.y,i.y),o=Math.max(n.y,i.y),s=Math.min(t.y,e.y),a=Math.max(t.y,e.y),s>o||a<r))}}getArea(){return this.getWidth()*this.getHeight()}equals(t){if(!(t instanceof L))return!1;const e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()}intersection(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new L;const e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new L(e,i,n,r)}isNull(){return this._maxx<this._minx}getMaxX(){return this._maxx}covers(){if(1===arguments.length){if(arguments[0]instanceof y){const t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof L){const t=arguments[0];return!this.isNull()&&!t.isNull()&&t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];return!this.isNull()&&t>=this._minx&&t<=this._maxx&&e>=this._miny&&e<=this._maxy}}intersects(){if(1===arguments.length){if(arguments[0]instanceof L){const t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof y){const t=arguments[0];return this.intersects(t.x,t.y)}}else if(2===arguments.length){if(arguments[0]instanceof y&&arguments[1]instanceof y){const t=arguments[0],e=arguments[1];return!this.isNull()&&(!((t.x<e.x?t.x:e.x)>this._maxx)&&(!((t.x>e.x?t.x:e.x)<this._minx)&&(!((t.y<e.y?t.y:e.y)>this._maxy)&&!((t.y>e.y?t.y:e.y)<this._miny))))}if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return!this.isNull()&&!(t>this._maxx||t<this._minx||e>this._maxy||e<this._miny)}}}getMinY(){return this._miny}getDiameter(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return Math.sqrt(t*t+e*e)}getMinX(){return this._minx}expandToInclude(){if(1===arguments.length){if(arguments[0]instanceof y){const t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof L){const t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.isNull()?(this._minx=t,this._maxx=t,this._miny=e,this._maxy=e):(t<this._minx&&(this._minx=t),t>this._maxx&&(this._maxx=t),e<this._miny&&(this._miny=e),e>this._maxy&&(this._maxy=e))}}minExtent(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return t<e?t:e}getWidth(){return this.isNull()?0:this._maxx-this._minx}compareTo(t){const e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}translate(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}copy(){return new L(this)}toString(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}setToNull(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}disjoint(t){return!(!this.isNull()&&!t.isNull())||t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny}getHeight(){return this.isNull()?0:this._maxy-this._miny}maxExtent(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return t>e?t:e}expandBy(){if(1===arguments.length){const t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=e,this._maxy+=e,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}contains(){if(1===arguments.length){if(arguments[0]instanceof L){const t=arguments[0];return this.covers(t)}if(arguments[0]instanceof y){const t=arguments[0];return this.covers(t)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.covers(t,e)}}centre(){return this.isNull()?null:new y((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}init(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof y){const t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof L){const t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t<e?(this._minx=t,this._maxx=e):(this._minx=e,this._maxx=t),n<i?(this._miny=n,this._maxy=i):(this._miny=i,this._maxy=n)}}getMaxY(){return this._maxy}distance(t){if(this.intersects(t))return 0;let e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);let n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)}hashCode(){let t=17;return t=37*t+y.hashCode(this._minx),t=37*t+y.hashCode(this._maxx),t=37*t+y.hashCode(this._miny),t=37*t+y.hashCode(this._maxy),t}get interfaces_(){return[s,u]}}class M{constructor(t){this.str=t}append(t){this.str+=t}setCharAt(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}toString(){return this.str}}class O{constructor(t){this.value=t}intValue(){return this.value}compareTo(t){return this.value<t?-1:this.value>t?1:0}static compare(t,e){return t<e?-1:t>e?1:0}static isNan(t){return Number.isNaN(t)}static valueOf(t){return new O(t)}}class R{static isWhitespace(t){return t<=32&&t>=0||127===t}static toUpperCase(t){return t.toUpperCase()}}class A extends n{constructor(t){super(t),this.name=Object.keys({IllegalStateException:A})[0]}}class D{constructor(){D.constructor_.apply(this,arguments)}static constructor_(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){const t=arguments[0];this.init(t)}else if(arguments[0]instanceof D){const t=arguments[0];this.init(t)}else if("string"==typeof arguments[0]){const t=arguments[0];D.constructor_.call(this,D.parse(t))}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.init(t,e)}}static determinant(){if("number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];return D.determinant(D.valueOf(t),D.valueOf(e),D.valueOf(n),D.valueOf(i))}if(arguments[3]instanceof D&&arguments[2]instanceof D&&arguments[0]instanceof D&&arguments[1]instanceof D){const t=arguments[1],e=arguments[2],n=arguments[3];return arguments[0].multiply(n).selfSubtract(t.multiply(e))}}static sqr(t){return D.valueOf(t).selfMultiply(t)}static valueOf(){if("string"==typeof arguments[0]){const t=arguments[0];return D.parse(t)}if("number"==typeof arguments[0])return new D(arguments[0])}static sqrt(t){return D.valueOf(t).sqrt()}static parse(t){let e=0;const n=t.length;for(;R.isWhitespace(t.charAt(e));)e++;let i=!1;if(e<n){const n=t.charAt(e);"-"!==n&&"+"!==n||(e++,"-"===n&&(i=!0))}const r=new D;let o=0,s=0,a=0,l=!1;for(;!(e>=n);){const n=t.charAt(e);if(e++,R.isDigit(n)){const t=n-"0";r.selfMultiply(D.TEN),r.selfAdd(t),o++}else{if("."!==n){if("e"===n||"E"===n){const n=t.substring(e);try{a=O.parseInt(n)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+n+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+n+"' at position "+e+" in string "+t)}s=o,l=!0}}let u=r;l||(s=o);const c=o-s-a;if(0===c)u=r;else if(c>0){const t=D.TEN.pow(c);u=r.divide(t)}else if(c<0){const t=D.TEN.pow(-c);u=r.multiply(t)}return i?u.negate():u}static createNaN(){return new D(o.NaN,o.NaN)}static copy(t){return new D(t)}static magnitude(t){const e=Math.abs(t),n=Math.log(e)/Math.log(10);let i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i}static stringOfChar(t,e){const n=new M;for(let i=0;i<e;i++)n.append(t);return n.toString()}le(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}extractSignificantDigits(t,e){let n=this.abs(),i=D.magnitude(n._hi);const r=D.TEN.pow(i);n=n.divide(r),n.gt(D.TEN)?(n=n.divide(D.TEN),i+=1):n.lt(D.ONE)&&(n=n.multiply(D.TEN),i-=1);const o=i+1,s=new M,a=D.MAX_PRINT_DIGITS-1;for(let e=0;e<=a;e++){t&&e===o&&s.append(".");const i=Math.trunc(n._hi);if(i<0)break;let r=!1,l=0;i>9?(r=!0,l="9"):l="0"+i,s.append(l),n=n.subtract(D.valueOf(i)).multiply(D.TEN),r&&n.selfAdd(D.TEN);let u=!0;const c=D.magnitude(n._hi);if(c<0&&Math.abs(c)>=a-e&&(u=!1),!u)break}return e[0]=i,s.toString()}sqr(){return this.multiply(this)}doubleValue(){return this._hi+this._lo}subtract(){if(arguments[0]instanceof D){const t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){const t=arguments[0];return this.add(-t)}}equals(){if(1===arguments.length&&arguments[0]instanceof D){const t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}isZero(){return 0===this._hi&&0===this._lo}selfSubtract(){if(arguments[0]instanceof D){const t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}}getSpecialNumberString(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}min(t){return this.le(t)?this:t}selfDivide(){if(1===arguments.length){if(arguments[0]instanceof D){const t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];return this.selfDivide(t,0)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=null,i=null,r=null,o=null,s=null,a=null,l=null,u=null;return s=this._hi/t,a=D.SPLIT*s,n=a-s,u=D.SPLIT*t,n=a-n,i=s-n,r=u-t,l=s*t,r=u-r,o=t-r,u=n*r-l+n*o+i*r+i*o,a=(this._hi-l-u+this._lo-s*e)/t,u=s+a,this._hi=u,this._lo=s-u+a,this}}dump(){return"DD<"+this._hi+", "+this._lo+">"}divide(){if(arguments[0]instanceof D){const t=arguments[0];let e=null,n=null,i=null,r=null,o=null,s=null,a=null,l=null;return o=this._hi/t._hi,s=D.SPLIT*o,e=s-o,l=D.SPLIT*t._hi,e=s-e,n=o-e,i=l-t._hi,a=o*t._hi,i=l-i,r=t._hi-i,l=e*i-a+e*r+n*i+n*r,s=(this._hi-a-l+this._lo-o*t._lo)/t._hi,l=o+s,new D(l,o-l+s)}if("number"==typeof arguments[0]){const t=arguments[0];return o.isNaN(t)?D.createNaN():D.copy(this).selfDivide(t,0)}}ge(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}pow(t){if(0===t)return D.valueOf(1);let e=new D(this),n=D.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),i/=2,i>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n}ceil(){if(this.isNaN())return D.NaN;const t=Math.ceil(this._hi);let e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new D(t,e)}compareTo(t){const e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}rint(){return this.isNaN()?this:this.add(.5).floor()}setValue(){if(arguments[0]instanceof D){const t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){const t=arguments[0];return this.init(t),this}}max(t){return this.ge(t)?this:t}sqrt(){if(this.isZero())return D.valueOf(0);if(this.isNegative())return D.NaN;const t=1/Math.sqrt(this._hi),e=this._hi*t,n=D.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)}selfAdd(){if(1===arguments.length){if(arguments[0]instanceof D){const t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];let e=null,n=null,i=null,r=null,o=null,s=null;return i=this._hi+t,o=i-this._hi,r=i-o,r=t-o+(this._hi-r),s=r+this._lo,e=i+s,n=s+(i-e),this._hi=e+n,this._lo=n+(e-this._hi),this}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=null,i=null,r=null,o=null,s=null,a=null,l=null,u=null;s=this._hi+t,r=this._lo+e,l=s-this._hi,u=r-this._lo,a=s-l,o=r-u,a=t-l+(this._hi-a),o=e-u+(this._lo-o),l=a+r,n=s+l,i=l+(s-n),l=o+i;const c=n+l,h=l+(n-c);return this._hi=c,this._lo=h,this}}selfMultiply(){if(1===arguments.length){if(arguments[0]instanceof D){const t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];return this.selfMultiply(t,0)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=null,i=null,r=null,o=null,s=null,a=null;s=D.SPLIT*this._hi,n=s-this._hi,a=D.SPLIT*t,n=s-n,i=this._hi-n,r=a-t,s=this._hi*t,r=a-r,o=t-r,a=n*r-s+n*o+i*r+i*o+(this._hi*e+this._lo*t);const l=s+a;n=s-l;const u=a+n;return this._hi=l,this._lo=u,this}}selfSqr(){return this.selfMultiply(this)}floor(){if(this.isNaN())return D.NaN;const t=Math.floor(this._hi);let e=0;return t===this._hi&&(e=Math.floor(this._lo)),new D(t,e)}negate(){return this.isNaN()?this:new D(-this._hi,-this._lo)}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}multiply(){if(arguments[0]instanceof D){const t=arguments[0];return t.isNaN()?D.createNaN():D.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){const t=arguments[0];return o.isNaN(t)?D.createNaN():D.copy(this).selfMultiply(t,0)}}isNaN(){return o.isNaN(this._hi)}intValue(){return Math.trunc(this._hi)}toString(){const t=D.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}toStandardNotation(){const t=this.getSpecialNumberString();if(null!==t)return t;const e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1;let r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+D.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){const t=i-n.length;r=n+D.stringOfChar("0",t)+".0"}return this.isNegative()?"-"+r:r}reciprocal(){let t=null,e=null,n=null,i=null,r=null,o=null,s=null,a=null;r=1/this._hi,o=D.SPLIT*r,t=o-r,a=D.SPLIT*this._hi,t=o-t,e=r-t,n=a-this._hi,s=r*this._hi,n=a-n,i=this._hi-n,a=t*n-s+t*i+e*n+e*i,o=(1-s-a-r*this._lo)/this._hi;const l=r+o;return new D(l,r-l+o)}toSciNotation(){if(this.isZero())return D.SCI_NOT_ZERO;const t=this.getSpecialNumberString();if(null!==t)return t;const e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=D.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new A("Found leading zero: "+n);let r="";n.length>1&&(r=n.substring(1));const o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i}abs(){return this.isNaN()?D.NaN:this.isNegative()?this.negate():new D(this)}isPositive(){return this._hi>0||0===this._hi&&this._lo>0}lt(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}add(){if(arguments[0]instanceof D){const t=arguments[0];return D.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){const t=arguments[0];return D.copy(this).selfAdd(t)}}init(){if(1===arguments.length){if("number"==typeof arguments[0]){const t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof D){const t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._hi=t,this._lo=e}}gt(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}isNegative(){return this._hi<0||0===this._hi&&this._lo<0}trunc(){return this.isNaN()?D.NaN:this.isPositive()?this.floor():this.ceil()}signum(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}get interfaces_(){return[u,s,a]}}D.PI=new D(3.141592653589793,12246467991473532e-32),D.TWO_PI=new D(6.283185307179586,24492935982947064e-32),D.PI_2=new D(1.5707963267948966,6123233995736766e-32),D.E=new D(2.718281828459045,14456468917292502e-32),D.NaN=new D(o.NaN,o.NaN),D.EPS=123259516440783e-46,D.SPLIT=134217729,D.MAX_PRINT_DIGITS=32,D.TEN=D.valueOf(10),D.ONE=D.valueOf(1),D.SCI_NOT_EXPONENT_CHAR="E",D.SCI_NOT_ZERO="0.0E0";class F{static orientationIndex(t,e,n){const i=F.orientationIndexFilter(t,e,n);if(i<=1)return i;const r=D.valueOf(e.x).selfAdd(-t.x),o=D.valueOf(e.y).selfAdd(-t.y),s=D.valueOf(n.x).selfAdd(-e.x),a=D.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()}static signOfDet2x2(){if(arguments[3]instanceof D&&arguments[2]instanceof D&&arguments[0]instanceof D&&arguments[1]instanceof D){const t=arguments[1],e=arguments[2],n=arguments[3];return arguments[0].multiply(n).selfSubtract(t.multiply(e)).signum()}if("number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=D.valueOf(t),o=D.valueOf(e),s=D.valueOf(n),a=D.valueOf(i);return r.multiply(a).selfSubtract(o.multiply(s)).signum()}}static intersection(t,e,n,i){const r=new D(t.y).selfSubtract(e.y),s=new D(e.x).selfSubtract(t.x),a=new D(t.x).selfMultiply(e.y).selfSubtract(new D(e.x).selfMultiply(t.y)),l=new D(n.y).selfSubtract(i.y),u=new D(i.x).selfSubtract(n.x),c=new D(n.x).selfMultiply(i.y).selfSubtract(new D(i.x).selfMultiply(n.y)),h=s.multiply(c).selfSubtract(u.multiply(a)),p=l.multiply(a).selfSubtract(r.multiply(c)),f=r.multiply(u).selfSubtract(l.multiply(s)),d=h.selfDivide(f).doubleValue(),g=p.selfDivide(f).doubleValue();return o.isNaN(d)||o.isInfinite(d)||o.isNaN(g)||o.isInfinite(g)?null:new y(d,g)}static orientationIndexFilter(t,e,n){let i=null;const r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=r-o;if(r>0){if(o<=0)return F.signum(s);i=r+o}else{if(!(r<0))return F.signum(s);if(o>=0)return F.signum(s);i=-r-o}const a=F.DP_SAFE_EPSILON*i;return s>=a||-s>=a?F.signum(s):2}static signum(t){return t>0?1:t<0?-1:0}}F.DP_SAFE_EPSILON=1e-15;class k{getM(t){if(this.hasM()){const e=this.getDimension()-this.getMeasures();return this.getOrdinate(t,e)}return o.NaN}setOrdinate(t,e,n){}getZ(t){return this.hasZ()?this.getOrdinate(t,2):o.NaN}size(){}getOrdinate(t,e){}getCoordinate(){}getCoordinateCopy(t){}createCoordinate(){}getDimension(){}hasM(){return this.getMeasures()>0}getX(t){}hasZ(){return this.getDimension()-this.getMeasures()>2}getMeasures(){return 0}expandEnvelope(t){}copy(){}getY(t){}toCoordinateArray(){}get interfaces_(){return[a]}}k.X=0,k.Y=1,k.Z=2,k.M=3;class B{static index(t,e,n){return F.orientationIndex(t,e,n)}static isCCW(){if(arguments[0]instanceof Array){const t=arguments[0],e=t.length-1;if(e<3)throw new i("Ring has fewer than 4 points, so orientation cannot be determined");let n=t[0],r=0;for(let i=1;i<=e;i++){const e=t[i];e.y>n.y&&(n=e,r=i)}let o=r;do{o-=1,o<0&&(o=e)}while(t[o].equals2D(n)&&o!==r);let s=r;do{s=(s+1)%e}while(t[s].equals2D(n)&&s!==r);const a=t[o],l=t[s];if(a.equals2D(n)||l.equals2D(n)||a.equals2D(l))return!1;const u=B.index(a,n,l);let c=null;return c=0===u?a.x>l.x:u>0,c}if(C(arguments[0],k)){const t=arguments[0],e=t.size()-1;if(e<3)throw new i("Ring has fewer than 4 points, so orientation cannot be determined");let n=t.getCoordinate(0),r=0;for(let i=1;i<=e;i++){const e=t.getCoordinate(i);e.y>n.y&&(n=e,r=i)}let o=null,s=r;do{s-=1,s<0&&(s=e),o=t.getCoordinate(s)}while(o.equals2D(n)&&s!==r);let a=null,l=r;do{l=(l+1)%e,a=t.getCoordinate(l)}while(a.equals2D(n)&&l!==r);if(o.equals2D(n)||a.equals2D(n)||o.equals2D(a))return!1;const u=B.index(o,n,a);let c=null;return c=0===u?o.x>a.x:u>0,c}}}B.CLOCKWISE=-1,B.RIGHT=B.CLOCKWISE,B.COUNTERCLOCKWISE=1,B.LEFT=B.COUNTERCLOCKWISE,B.COLLINEAR=0,B.STRAIGHT=B.COLLINEAR;class G{static intersection(t,e,n,i){const r=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,u=n.x<i.x?n.x:i.x,c=n.y<i.y?n.y:i.y,h=n.x>i.x?n.x:i.x,p=n.y>i.y?n.y:i.y,f=((r>u?r:u)+(a<h?a:h))/2,d=((s>c?s:c)+(l<p?l:p))/2,g=t.x-f,m=t.y-d,_=e.x-f,v=e.y-d,x=n.x-f,C=n.y-d,w=i.x-f,b=i.y-d,E=m-v,I=_-g,P=g*v-_*m,N=C-b,S=w-x,T=x*b-w*C,L=E*S-N*I,M=(I*T-S*P)/L,O=(N*P-E*T)/L;return o.isNaN(M)||o.isInfinite(M)||o.isNaN(O)||o.isInfinite(O)?null:new y(M+f,O+d)}}class j{static arraycopy(t,e,n,i,r){let o=0;for(let s=e;s<e+r;s++)n[i+o]=t[s],o++}static getProperty(t){return{"line.separator":"\n"}[t]}}class z{static log10(t){const e=Math.log(t);return o.isInfinite(e)||o.isNaN(e)?e:e/z.LOG_10}static min(t,e,n,i){let r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r}static clamp(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}}static wrap(t,e){return t<0?e- -t%e:t%e}static max(){if(3===arguments.length){const t=arguments[1],e=arguments[2];let n=arguments[0];return t>n&&(n=t),e>n&&(n=e),n}if(4===arguments.length){const t=arguments[1],e=arguments[2],n=arguments[3];let i=arguments[0];return t>i&&(i=t),e>i&&(i=e),n>i&&(i=n),i}}static average(t,e){return(t+e)/2}}z.LOG_10=Math.log(10);class U{static segmentToSegment(t,e,n,i){if(t.equals(e))return U.pointToSegment(t,n,i);if(n.equals(i))return U.pointToSegment(i,t,e);let r=!1;if(L.intersects(t,e,n,i)){const o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===o)r=!0;else{const s=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,l=s/o;(l<0||l>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?z.min(U.pointToSegment(t,n,i),U.pointToSegment(e,n,i),U.pointToSegment(n,t,e),U.pointToSegment(i,t,e)):0}static pointToSegment(t,e,n){if(e.x===n.x&&e.y===n.y)return t.distance(e);const i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;if(r<=0)return t.distance(e);if(r>=1)return t.distance(n);const o=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(o)*Math.sqrt(i)}static pointToLinePerpendicular(t,e,n){const i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)}static pointToSegmentString(t,e){if(0===e.length)throw new i("Line array must contain at least one vertex");let n=t.distance(e[0]);for(let i=0;i<e.length-1;i++){const r=U.pointToSegment(t,e[i],e[i+1]);r<n&&(n=r)}return n}}class q{create(){if(1===arguments.length)arguments[0]instanceof Array||C(arguments[0],k);else if(2===arguments.length);else if(3===arguments.length){const t=arguments[0],e=arguments[1];return this.create(t,e)}}}class V{filter(t){}}class H{constructor(){H.constructor_.apply(this,arguments)}isGeometryCollection(){return this.getTypeCode()===H.TYPECODE_GEOMETRYCOLLECTION}getFactory(){return this._factory}getGeometryN(t){return this}getArea(){return 0}isRectangle(){return!1}equalsExact(t){return this===t||this.equalsExact(t,0)}geometryChanged(){this.apply(H.geometryChangedFilter)}geometryChangedAction(){this._envelope=null}equalsNorm(t){return null!==t&&this.norm().equalsExact(t.norm())}getLength(){return 0}getNumGeometries(){return 1}compareTo(){let t;if(1===arguments.length){const e=arguments[0];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){const e=arguments[0],n=arguments[1];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e,n)}}getUserData(){return this._userData}getSRID(){return this._SRID}getEnvelope(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}static checkNotGeometryCollection(t){if(t.getTypeCode()===H.TYPECODE_GEOMETRYCOLLECTION)throw new i("This method does not support GeometryCollection arguments")}equal(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n}norm(){const t=this.copy();return t.normalize(),t}reverse(){const t=this.reverseInternal();return null!=this.envelope&&(t.envelope=this.envelope.copy()),t.setSRID(this.getSRID()),t}copy(){const t=this.copyInternal();return t.envelope=null==this._envelope?null:this._envelope.copy(),t._SRID=this._SRID,t._userData=this._userData,t}getPrecisionModel(){return this._factory.getPrecisionModel()}getEnvelopeInternal(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new L(this._envelope)}setSRID(t){this._SRID=t}setUserData(t){this._userData=t}compare(t,e){const n=t.iterator(),i=e.iterator();for(;n.hasNext()&&i.hasNext();){const t=n.next(),e=i.next(),r=t.compareTo(e);if(0!==r)return r}return n.hasNext()?1:i.hasNext()?-1:0}hashCode(){return this.getEnvelopeInternal().hashCode()}isEquivalentClass(t){return this.getClass()===t.getClass()}isGeometryCollectionOrDerived(){return this.getTypeCode()===H.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===H.TYPECODE_MULTIPOINT||this.getTypeCode()===H.TYPECODE_MULTILINESTRING||this.getTypeCode()===H.TYPECODE_MULTIPOLYGON}get interfaces_(){return[a,s,u]}getClass(){return H}static hasNonEmptyElements(t){for(let e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}static hasNullElements(t){for(let e=0;e<t.length;e++)if(null===t[e])return!0;return!1}}H.constructor_=function(t){t&&(this._envelope=null,this._userData=null,this._factory=t,this._SRID=t.getSRID())},H.TYPECODE_POINT=0,H.TYPECODE_MULTIPOINT=1,H.TYPECODE_LINESTRING=2,H.TYPECODE_LINEARRING=3,H.TYPECODE_MULTILINESTRING=4,H.TYPECODE_POLYGON=5,H.TYPECODE_MULTIPOLYGON=6,H.TYPECODE_GEOMETRYCOLLECTION=7,H.TYPENAME_POINT="Point",H.TYPENAME_MULTIPOINT="MultiPoint",H.TYPENAME_LINESTRING="LineString",H.TYPENAME_LINEARRING="LinearRing",H.TYPENAME_MULTILINESTRING="MultiLineString",H.TYPENAME_POLYGON="Polygon",H.TYPENAME_MULTIPOLYGON="MultiPolygon",H.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",H.geometryChangedFilter={get interfaces_(){return[V]},filter(t){t.geometryChangedAction()}};class Y{filter(t){}}class X{static ofLine(t){const e=t.size();if(e<=1)return 0;let n=0;const i=new y;t.getCoordinate(0,i);let r=i.x,o=i.y;for(let s=1;s<e;s++){t.getCoordinate(s,i);const e=i.x,a=i.y,l=e-r,u=a-o;n+=Math.sqrt(l*l+u*u),r=e,o=a}return n}}class W{}class K{static copyCoord(t,e,n,i){const r=Math.min(t.getDimension(),n.getDimension());for(let o=0;o<r;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))}static isRing(t){const e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,k.X)===t.getOrdinate(e-1,k.X)&&t.getOrdinate(0,k.Y)===t.getOrdinate(e-1,k.Y)}static scroll(){if(2===arguments.length){if(C(arguments[0],k)&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];K.scroll(t,e,K.isRing(t))}else if(C(arguments[0],k)&&arguments[1]instanceof y){const t=arguments[0],e=arguments[1],n=K.indexOf(e,t);if(n<=0)return null;K.scroll(t,n)}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(e<=0)return null;const i=t.copy(),r=n?t.size()-1:t.size();for(let n=0;n<r;n++)for(let o=0;o<t.getDimension();o++)t.setOrdinate(n,o,i.getOrdinate((e+n)%r,o));if(n)for(let e=0;e<t.getDimension();e++)t.setOrdinate(r,e,t.getOrdinate(0,e))}}static isEqual(t,e){const n=t.size();if(n!==e.size())return!1;const i=Math.min(t.getDimension(),e.getDimension());for(let r=0;r<n;r++)for(let n=0;n<i;n++){const i=t.getOrdinate(r,n),s=e.getOrdinate(r,n);if(!(t.getOrdinate(r,n)===e.getOrdinate(r,n)||o.isNaN(i)&&o.isNaN(s)))return!1}return!0}static minCoordinateIndex(){if(1===arguments.length){const t=arguments[0];return K.minCoordinateIndex(t,0,t.size()-1)}if(3===arguments.length){const t=arguments[0],e=arguments[2];let n=-1,i=null;for(let r=arguments[1];r<=e;r++){const e=t.getCoordinate(r);(null===i||i.compareTo(e)>0)&&(i=e,n=r)}return n}}static extend(t,e,n){const i=t.create(n,e.getDimension()),r=e.size();if(K.copy(e,0,i,0,r),r>0)for(let t=r;t<n;t++)K.copy(e,r-1,i,t,1);return i}static reverse(t){const e=t.size()-1,n=Math.trunc(e/2);for(let i=0;i<=n;i++)K.swap(t,i,e-i)}static swap(t,e,n){if(e===n)return null;for(let i=0;i<t.getDimension();i++){const r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}}static copy(t,e,n,i,r){for(let o=0;o<r;o++)K.copyCoord(t,e+o,n,i+o)}static ensureValidRing(t,e){const n=e.size();return 0===n?e:n<=3?K.createClosedRing(t,e,4):e.getOrdinate(0,k.X)===e.getOrdinate(n-1,k.X)&&e.getOrdinate(0,k.Y)===e.getOrdinate(n-1,k.Y)?e:K.createClosedRing(t,e,n+1)}static indexOf(t,e){for(let n=0;n<e.size();n++)if(t.x===e.getOrdinate(n,k.X)&&t.y===e.getOrdinate(n,k.Y))return n;return-1}static createClosedRing(t,e,n){const i=t.create(n,e.getDimension()),r=e.size();K.copy(e,0,i,0,r);for(let t=r;t<n;t++)K.copy(e,0,i,t,1);return i}static minCoordinate(t){let e=null;for(let n=0;n<t.size();n++){const i=t.getCoordinate(n);(null===e||e.compareTo(i)>0)&&(e=i)}return e}}class Z extends n{constructor(t){super(t),this.name=Object.keys({UnsupportedOperationException:Z})[0]}}class J{static toDimensionSymbol(t){switch(t){case J.FALSE:return J.SYM_FALSE;case J.TRUE:return J.SYM_TRUE;case J.DONTCARE:return J.SYM_DONTCARE;case J.P:return J.SYM_P;case J.L:return J.SYM_L;case J.A:return J.SYM_A}throw new i("Unknown dimension value: "+t)}static toDimensionValue(t){switch(R.toUpperCase(t)){case J.SYM_FALSE:return J.FALSE;case J.SYM_TRUE:return J.TRUE;case J.SYM_DONTCARE:return J.DONTCARE;case J.SYM_P:return J.P;case J.SYM_L:return J.L;case J.SYM_A:return J.A}throw new i("Unknown dimension symbol: "+t)}}J.P=0,J.L=1,J.A=2,J.FALSE=-1,J.TRUE=-2,J.DONTCARE=-3,J.SYM_FALSE="F",J.SYM_TRUE="T",J.SYM_DONTCARE="*",J.SYM_P="0",J.SYM_L="1",J.SYM_A="2";class Q{filter(t){}}class $ extends H{constructor(){super(),$.constructor_.apply(this,arguments)}static constructor_(){if(this._points=null,0===arguments.length);else if(2===arguments.length){const t=arguments[0],e=arguments[1];H.constructor_.call(this,e),this.init(t)}}computeEnvelopeInternal(){return this.isEmpty()?new L:this._points.expandEnvelope(new L)}isRing(){return this.isClosed()&&this.isSimple()}getCoordinates(){return this._points.toCoordinateArray()}copyInternal(){return new $(this._points.copy(),this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof H){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const n=t;if(this._points.size()!==n._points.size())return!1;for(let t=0;t<this._points.size();t++)if(!this.equal(this._points.getCoordinate(t),n._points.getCoordinate(t),e))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(let t=0;t<Math.trunc(this._points.size()/2);t++){const e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0){const t=this._points.copy();K.reverse(t),this._points=t}return null}}}getCoordinate(){return this.isEmpty()?null:this._points.getCoordinate(0)}getBoundaryDimension(){return this.isClosed()?J.FALSE:0}isClosed(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}reverseInternal(){const t=this._points.copy();return K.reverse(t),this.getFactory().createLineString(t)}getEndPoint(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}getTypeCode(){return H.TYPECODE_LINESTRING}getDimension(){return 1}getLength(){return X.ofLine(this._points)}getNumPoints(){return this._points.size()}compareToSameClass(){if(1===arguments.length){const t=arguments[0];let e=0,n=0;for(;e<this._points.size()&&n<t._points.size();){const i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){const t=arguments[0];return arguments[1].compare(this._points,t._points)}}apply(){if(C(arguments[0],Y)){const t=arguments[0];for(let e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e))}else if(C(arguments[0],T)){const t=arguments[0];if(0===this._points.size())return null;for(let e=0;e<this._points.size()&&(t.filter(this._points,e),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else(C(arguments[0],Q)||C(arguments[0],V))&&arguments[0].filter(this)}getBoundary(){throw new Z}isEquivalentClass(t){return t instanceof $}getCoordinateN(t){return this._points.getCoordinate(t)}getGeometryType(){return H.TYPENAME_LINESTRING}getCoordinateSequence(){return this._points}isEmpty(){return 0===this._points.size()}init(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new i("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}isCoordinate(t){for(let e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1}getStartPoint(){return this.isEmpty()?null:this.getPointN(0)}getPointN(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}get interfaces_(){return[W]}}class tt{}class et extends H{constructor(){super(),et.constructor_.apply(this,arguments)}static constructor_(){this._coordinates=null;const t=arguments[0],e=arguments[1];H.constructor_.call(this,e),this.init(t)}computeEnvelopeInternal(){if(this.isEmpty())return new L;const t=new L;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}getCoordinates(){return this.isEmpty()?[]:[this.getCoordinate()]}copyInternal(){return new et(this._coordinates.copy(),this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof H){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return super.equalsExact.apply(this,arguments)}normalize(){}getCoordinate(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null}getBoundaryDimension(){return J.FALSE}reverseInternal(){return this.getFactory().createPoint(this._coordinates.copy())}getTypeCode(){return H.TYPECODE_POINT}getDimension(){return 0}getNumPoints(){return this.isEmpty()?0:1}getX(){if(null===this.getCoordinate())throw new A("getX called on empty Point");return this.getCoordinate().x}compareToSameClass(){if(1===arguments.length){const t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){const t=arguments[0];return arguments[1].compare(this._coordinates,t._coordinates)}}apply(){if(C(arguments[0],Y)){const t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(C(arguments[0],T)){const t=arguments[0];if(this.isEmpty())return null;t.filter(this._coordinates,0),t.isGeometryChanged()&&this.geometryChanged()}else(C(arguments[0],Q)||C(arguments[0],V))&&arguments[0].filter(this)}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return H.TYPENAME_POINT}getCoordinateSequence(){return this._coordinates}getY(){if(null===this.getCoordinate())throw new A("getY called on empty Point");return this.getCoordinate().y}isEmpty(){return 0===this._coordinates.size()}init(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),p.isTrue(t.size()<=1),this._coordinates=t}isSimple(){return!0}get interfaces_(){return[tt]}}class nt{static ofRing(){if(arguments[0]instanceof Array){const t=arguments[0];return Math.abs(nt.ofRingSigned(t))}if(C(arguments[0],k)){const t=arguments[0];return Math.abs(nt.ofRingSigned(t))}}static ofRingSigned(){if(arguments[0]instanceof Array){const t=arguments[0];if(t.length<3)return 0;let e=0;const n=t[0].x;for(let i=1;i<t.length-1;i++){const r=t[i].x-n,o=t[i+1].y;e+=r*(t[i-1].y-o)}return e/2}if(C(arguments[0],k)){const t=arguments[0],e=t.size();if(e<3)return 0;const n=new y,i=new y,r=new y;t.getCoordinate(0,i),t.getCoordinate(1,r);const o=i.x;r.x-=o;let s=0;for(let a=1;a<e-1;a++)n.y=i.y,i.x=r.x,i.y=r.y,t.getCoordinate(a+1,r),r.x-=o,s+=i.x*(n.y-r.y);return s/2}}}class it{static sort(){const t=arguments[0];if(1===arguments.length)t.sort((t,e)=>t.compareTo(e));else if(2===arguments.length)t.sort((t,e)=>arguments[1].compare(t,e));else if(3===arguments.length){const e=t.slice(arguments[1],arguments[2]);e.sort();const n=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);for(const e of n)t.push(e)}else if(4===arguments.length){const e=t.slice(arguments[1],arguments[2]);e.sort((t,e)=>arguments[3].compare(t,e));const n=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);for(const e of n)t.push(e)}}static asList(t){const e=new P;for(const n of t)e.add(n);return e}static copyOf(t,e){return t.slice(0,e)}}class rt{}class ot extends H{constructor(){super(),ot.constructor_.apply(this,arguments)}static constructor_(){this._shell=null,this._holes=null;let t=arguments[0],e=arguments[1],n=arguments[2];if(H.constructor_.call(this,n),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),H.hasNullElements(e))throw new i("holes must not contain null elements");if(t.isEmpty()&&H.hasNonEmptyElements(e))throw new i("shell is empty but holes are not");this._shell=t,this._holes=e}computeEnvelopeInternal(){return this._shell.getEnvelopeInternal()}getCoordinates(){if(this.isEmpty())return[];const t=new Array(this.getNumPoints()).fill(null);let e=-1;const n=this._shell.getCoordinates();for(let i=0;i<n.length;i++)e++,t[e]=n[i];for(let n=0;n<this._holes.length;n++){const i=this._holes[n].getCoordinates();for(let n=0;n<i.length;n++)e++,t[e]=i[n]}return t}getArea(){let t=0;t+=nt.ofRing(this._shell.getCoordinateSequence());for(let e=0;e<this._holes.length;e++)t-=nt.ofRing(this._holes[e].getCoordinateSequence());return t}copyInternal(){const t=this._shell.copy(),e=new Array(this._holes.length).fill(null);for(let t=0;t<this._holes.length;t++)e[t]=this._holes[t].copy();return new ot(t,e,this._factory)}isRectangle(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;const t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal();for(let n=0;n<5;n++){const i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;const r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}let n=t.getX(0),i=t.getY(0);for(let e=1;e<=4;e++){const r=t.getX(e),o=t.getY(e);if(r!==n==(o!==i))return!1;n=r,i=o}return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof H){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const n=t,i=this._shell,r=n._shell;if(!i.equalsExact(r,e))return!1;if(this._holes.length!==n._holes.length)return!1;for(let t=0;t<this._holes.length;t++)if(!this._holes[t].equalsExact(n._holes[t],e))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){if(0===arguments.length){this._shell=this.normalized(this._shell,!0);for(let t=0;t<this._holes.length;t++)this._holes[t]=this.normalized(this._holes[t],!1);it.sort(this._holes)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];if(t.isEmpty())return null;const n=t.getCoordinateSequence(),i=K.minCoordinateIndex(n,0,n.size()-2);K.scroll(n,i,!0),B.isCCW(n)===e&&K.reverse(n)}}getCoordinate(){return this._shell.getCoordinate()}getNumInteriorRing(){return this._holes.length}getBoundaryDimension(){return 1}reverseInternal(){const t=this.getExteriorRing().reverse(),e=new Array(this.getNumInteriorRing()).fill(null);for(let t=0;t<e.length;t++)e[t]=this.getInteriorRingN(t).reverse();return this.getFactory().createPolygon(t,e)}getTypeCode(){return H.TYPECODE_POLYGON}getDimension(){return 2}getLength(){let t=0;t+=this._shell.getLength();for(let e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t}getNumPoints(){let t=this._shell.getNumPoints();for(let e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t}convexHull(){return this.getExteriorRing().convexHull()}normalized(t,e){const n=t.copy();return this.normalize(n,e),n}compareToSameClass(){if(1===arguments.length){const t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){const t=arguments[1],e=arguments[0],n=this._shell,i=e._shell,r=n.compareToSameClass(i,t);if(0!==r)return r;const o=this.getNumInteriorRing(),s=e.getNumInteriorRing();let a=0;for(;a<o&&a<s;){const n=this.getInteriorRingN(a),i=e.getInteriorRingN(a),r=n.compareToSameClass(i,t);if(0!==r)return r;a++}return a<o?1:a<s?-1:0}}apply(){if(C(arguments[0],Y)){const t=arguments[0];this._shell.apply(t);for(let e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(C(arguments[0],T)){const t=arguments[0];if(this._shell.apply(t),!t.isDone())for(let e=0;e<this._holes.length&&(this._holes[e].apply(t),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else if(C(arguments[0],Q))arguments[0].filter(this);else if(C(arguments[0],V)){const t=arguments[0];t.filter(this),this._shell.apply(t);for(let e=0;e<this._holes.length;e++)this._holes[e].apply(t)}}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(let e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}getGeometryType(){return H.TYPENAME_POLYGON}getExteriorRing(){return this._shell}isEmpty(){return this._shell.isEmpty()}getInteriorRingN(t){return this._holes[t]}get interfaces_(){return[rt]}}class st extends w{contains(){}}class at extends st{}class lt extends at{constructor(t){super(),this.array=[],t instanceof w&&this.addAll(t)}contains(t){for(const e of this.array)if(0===e.compareTo(t))return!0;return!1}add(t){if(this.contains(t))return!1;for(let e=0,n=this.array.length;e<n;e++)if(1===this.array[e].compareTo(t))return!!this.array.splice(e,0,t);return this.array.push(t),!0}addAll(t){for(const e of t)this.add(e);return!0}remove(){throw new Z}size(){return this.array.length}isEmpty(){return 0===this.array.length}toArray(){return this.array.slice()}iterator(){return new ut(this.array)}}class ut{constructor(t){this.array=t,this.position=0}next(){if(this.position===this.array.length)throw new I;return this.array[this.position++]}hasNext(){return this.position<this.array.length}remove(){throw new Z}}class ct extends H{constructor(){super(),ct.constructor_.apply(this,arguments)}static constructor_(){if(this._geometries=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];if(H.constructor_.call(this,e),null===t&&(t=[]),H.hasNullElements(t))throw new i("geometries must not contain null elements");this._geometries=t}}computeEnvelopeInternal(){const t=new L;for(let e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t}getGeometryN(t){return this._geometries[t]}getCoordinates(){const t=new Array(this.getNumPoints()).fill(null);let e=-1;for(let n=0;n<this._geometries.length;n++){const i=this._geometries[n].getCoordinates();for(let n=0;n<i.length;n++)e++,t[e]=i[n]}return t}getArea(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new ct(t,this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof H){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const n=t;if(this._geometries.length!==n._geometries.length)return!1;for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].equalsExact(n._geometries[t],e))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(let t=0;t<this._geometries.length;t++)this._geometries[t].normalize();it.sort(this._geometries)}getCoordinate(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}getBoundaryDimension(){let t=J.FALSE;for(let e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t}reverseInternal(){const t=this._geometries.length,e=new P(t);for(let n=0;n<t;n++)e.add(this._geometries[n].reverse());return this.getFactory().buildGeometry(e)}getTypeCode(){return H.TYPECODE_GEOMETRYCOLLECTION}getDimension(){let t=J.FALSE;for(let e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t}getLength(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t}getNumPoints(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t}getNumGeometries(){return this._geometries.length}compareToSameClass(){if(1===arguments.length){const t=arguments[0],e=new lt(it.asList(this._geometries)),n=new lt(it.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){const t=arguments[1],e=arguments[0],n=this.getNumGeometries(),i=e.getNumGeometries();let r=0;for(;r<n&&r<i;){const n=this.getGeometryN(r),i=e.getGeometryN(r),o=n.compareToSameClass(i,t);if(0!==o)return o;r++}return r<n?1:r<i?-1:0}}apply(){if(C(arguments[0],Y)){const t=arguments[0];for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}else if(C(arguments[0],T)){const t=arguments[0];if(0===this._geometries.length)return null;for(let e=0;e<this._geometries.length&&(this._geometries[e].apply(t),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else if(C(arguments[0],Q)){const t=arguments[0];t.filter(this);for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}else if(C(arguments[0],V)){const t=arguments[0];t.filter(this);for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}}getBoundary(){return H.checkNotGeometryCollection(this),p.shouldNeverReachHere(),null}getGeometryType(){return H.TYPENAME_GEOMETRYCOLLECTION}isEmpty(){for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}}class ht extends ct{constructor(){super(),ht.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];ct.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new ht(t,this._factory)}isValid(){return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof H){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getCoordinate(){if(1===arguments.length&&Number.isInteger(arguments[0])){const t=arguments[0];return this._geometries[t].getCoordinate()}return super.getCoordinate.apply(this,arguments)}getBoundaryDimension(){return J.FALSE}getTypeCode(){return H.TYPECODE_MULTIPOINT}getDimension(){return 0}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return H.TYPENAME_MULTIPOINT}get interfaces_(){return[tt]}}class pt extends ${constructor(){super(),pt.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];$.constructor_.call(this,t,e),this.validateConstruction()}copyInternal(){return new pt(this._points.copy(),this._factory)}getBoundaryDimension(){return J.FALSE}isClosed(){return!!this.isEmpty()||super.isClosed.call(this)}reverseInternal(){const t=this._points.copy();return K.reverse(t),this.getFactory().createLinearRing(t)}getTypeCode(){return H.TYPECODE_LINEARRING}validateConstruction(){if(!this.isEmpty()&&!super.isClosed.call(this))throw new i("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<pt.MINIMUM_VALID_SIZE)throw new i("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}getGeometryType(){return H.TYPENAME_LINEARRING}}pt.MINIMUM_VALID_SIZE=4;class ft{static measures(t){return t instanceof _?0:t instanceof v||t instanceof x?1:0}static dimension(t){return t instanceof _?2:t instanceof v?3:t instanceof x?4:3}static create(){if(1===arguments.length){const t=arguments[0];return ft.create(t,0)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return 2===t?new _:3===t&&0===e?new y:3===t&&1===e?new v:4===t&&1===e?new x:new y}}}class dt{static isRing(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))}static ptNotInList(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(dt.indexOf(i,e)<0)return i}return null}static scroll(t,e){const n=dt.indexOf(e,t);if(n<0)return null;const i=new Array(t.length).fill(null);j.arraycopy(t,n,i,0,t.length-n),j.arraycopy(t,0,i,t.length-n,n),j.arraycopy(i,0,t,0,t.length)}static equals(){if(2===arguments.length){const t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(0!==n.compare(t[i],e[i]))return!1;return!0}}static intersection(t,e){const n=new S;for(let i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()}static measures(t){if(null===t||0===t.length)return 0;let e=0;for(const n of t)e=Math.max(e,ft.measures(n));return e}static hasRepeatedPoints(t){for(let e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}static removeRepeatedPoints(t){return dt.hasRepeatedPoints(t)?new S(t,!1).toCoordinateArray():t}static reverse(t){const e=t.length-1,n=Math.trunc(e/2);for(let i=0;i<=n;i++){const n=t[i];t[i]=t[e-i],t[e-i]=n}}static removeNull(t){let e=0;for(let n=0;n<t.length;n++)null!==t[n]&&e++;const n=new Array(e).fill(null);if(0===e)return n;let i=0;for(let e=0;e<t.length;e++)null!==t[e]&&(n[i++]=t[e]);return n}static copyDeep(){if(1===arguments.length){const t=arguments[0],e=new Array(t.length).fill(null);for(let n=0;n<t.length;n++)e[n]=t[n].copy();return e}if(5===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4];for(let o=0;o<r;o++)n[i+o]=t[e+o].copy()}}static isEqualReversed(t,e){for(let n=0;n<t.length;n++){const i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0}static envelope(t){const e=new L;for(let n=0;n<t.length;n++)e.expandToInclude(t[n]);return e}static toCoordinateArray(t){return t.toArray(dt.coordArrayType)}static dimension(t){if(null===t||0===t.length)return 3;let e=0;for(const n of t)e=Math.max(e,ft.dimension(n));return e}static atLeastNCoordinatesOrNothing(t,e){return e.length>=t?e:[]}static indexOf(t,e){for(let n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1}static increasingDirection(t){for(let e=0;e<Math.trunc(t.length/2);e++){const n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1}static compare(t,e){let n=0;for(;n<t.length&&n<e.length;){const i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0}static minCoordinate(t){let e=null;for(let n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e}static extract(t,e,n){e=z.clamp(e,0,t.length);let i=(n=z.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);const r=new Array(i).fill(null);if(0===i)return r;let o=0;for(let i=e;i<=n;i++)r[o++]=t[i];return r}}dt.ForwardComparator=class{compare(t,e){const n=t,i=e;return dt.compare(n,i)}get interfaces_(){return[l]}},dt.BidirectionalComparator=class{compare(t,e){const n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;const r=dt.compare(n,i);return dt.isEqualReversed(n,i)?0:r}OLDcompare(t,e){const n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;const r=dt.increasingDirection(n),o=dt.increasingDirection(i);let s=r>0?0:n.length-1,a=o>0?0:n.length-1;for(let t=0;t<n.length;t++){const t=n[s].compareTo(i[a]);if(0!==t)return t;s+=r,a+=o}return 0}get interfaces_(){return[l]}},dt.coordArrayType=new Array(0).fill(null);class gt{constructor(t){this.str=t}append(t){this.str+=t}setCharAt(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}toString(){return this.str}}class yt{constructor(){yt.constructor_.apply(this,arguments)}static constructor_(){if(this._dimension=3,this._measures=0,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];yt.constructor_.call(this,t,dt.dimension(t),dt.measures(t))}else if(Number.isInteger(arguments[0])){const t=arguments[0];this._coordinates=new Array(t).fill(null);for(let e=0;e<t;e++)this._coordinates[e]=new y}else if(C(arguments[0],k)){const t=arguments[0];if(null===t)return this._coordinates=new Array(0).fill(null),null;this._dimension=t.getDimension(),this._measures=t.getMeasures(),this._coordinates=new Array(t.size()).fill(null);for(let e=0;e<this._coordinates.length;e++)this._coordinates[e]=t.getCoordinateCopy(e)}}else if(2===arguments.length){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];yt.constructor_.call(this,t,e,dt.measures(t))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];this._coordinates=new Array(t).fill(null),this._dimension=e;for(let n=0;n<t;n++)this._coordinates[n]=ft.create(e)}}else if(3===arguments.length)if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],n=arguments[2];this._dimension=e,this._measures=n,this._coordinates=null===t?new Array(0).fill(null):t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],n=arguments[2];this._coordinates=new Array(t).fill(null),this._dimension=e,this._measures=n;for(let e=0;e<t;e++)this._coordinates[e]=this.createCoordinate()}}getM(t){return this.hasM()?this._coordinates[t].getM():o.NaN}setOrdinate(t,e,n){switch(e){case k.X:this._coordinates[t].x=n;break;case k.Y:this._coordinates[t].y=n;break;default:this._coordinates[t].setOrdinate(e,n)}}getZ(t){return this.hasZ()?this._coordinates[t].getZ():o.NaN}size(){return this._coordinates.length}getOrdinate(t,e){switch(e){case k.X:return this._coordinates[t].x;case k.Y:return this._coordinates[t].y;default:return this._coordinates[t].getOrdinate(e)}}getCoordinate(){if(1===arguments.length){const t=arguments[0];return this._coordinates[t]}if(2===arguments.length){const t=arguments[0];arguments[1].setCoordinate(this._coordinates[t])}}getCoordinateCopy(t){const e=this.createCoordinate();return e.setCoordinate(this._coordinates[t]),e}createCoordinate(){return ft.create(this.getDimension(),this.getMeasures())}getDimension(){return this._dimension}getX(t){return this._coordinates[t].x}getMeasures(){return this._measures}expandEnvelope(t){for(let e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}copy(){const t=new Array(this.size()).fill(null);for(let e=0;e<this._coordinates.length;e++){const n=this.createCoordinate();n.setCoordinate(this._coordinates[e]),t[e]=n}return new yt(t,this._dimension,this._measures)}toString(){if(this._coordinates.length>0){const t=new gt(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(let e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}getY(t){return this._coordinates[t].y}toCoordinateArray(){return this._coordinates}get interfaces_(){return[k,u]}}class mt{static instance(){return mt.instanceObject}readResolve(){return mt.instance()}create(){if(1===arguments.length){if(arguments[0]instanceof Array)return new yt(arguments[0]);if(C(arguments[0],k))return new yt(arguments[0])}else{if(2===arguments.length){let t=arguments[1];return t>3&&(t=3),t<2&&(t=2),new yt(arguments[0],t)}if(3===arguments.length){let t=arguments[2],e=arguments[1]-t;return t>1&&(t=1),e>3&&(e=3),e<2&&(e=2),new yt(arguments[0],e+t,t)}}}get interfaces_(){return[q,u]}}mt.instanceObject=new mt;class _t extends ct{constructor(){super(),_t.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];ct.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new _t(t,this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof H){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return 1}getTypeCode(){return H.TYPECODE_MULTIPOLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const t=new P;for(let e=0;e<this._geometries.length;e++){const n=this._geometries[e].getBoundary();for(let e=0;e<n.getNumGeometries();e++)t.add(n.getGeometryN(e))}const e=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(e))}getGeometryType(){return H.TYPENAME_MULTIPOLYGON}get interfaces_(){return[rt]}}class vt{get(){}put(){}size(){}values(){}entrySet(){}}class xt extends st{constructor(t){super(),this.map=new Map,t instanceof w&&this.addAll(t)}contains(t){const e=t.hashCode?t.hashCode():t;return!!this.map.has(e)}add(t){const e=t.hashCode?t.hashCode():t;return!this.map.has(e)&&!!this.map.set(e,t)}addAll(t){for(const e of t)this.add(e);return!0}remove(){throw new Z}size(){return this.map.size}isEmpty(){return 0===this.map.size}toArray(){return Array.from(this.map.values())}iterator(){return new Ct(this.map)}[Symbol.iterator](){return this.map}}class Ct{constructor(t){this.iterator=t.values();const{done:e,value:n}=this.iterator.next();this.done=e,this.value=n}next(){if(this.done)throw new I;const t=this.value,{done:e,value:n}=this.iterator.next();return this.done=e,this.value=n,t}hasNext(){return!this.done}remove(){throw new Z}}class wt extends vt{constructor(){super(),this.map=new Map}get(t){return this.map.get(t)||null}put(t,e){return this.map.set(t,e),e}values(){const t=new P,e=this.map.values();let n=e.next();for(;!n.done;)t.add(n.value),n=e.next();return t}entrySet(){const t=new xt;return this.map.entries().forEach(e=>t.add(e)),t}size(){return this.map.size()}}class bt{constructor(){bt.constructor_.apply(this,arguments)}static constructor_(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=bt.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Et){const t=arguments[0];this._modelType=t,t===bt.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){const t=arguments[0];this._modelType=bt.FIXED,this.setScale(t)}else if(arguments[0]instanceof bt){const t=arguments[0];this._modelType=t._modelType,this._scale=t._scale}}static mostPrecise(t,e){return t.compareTo(e)>=0?t:e}equals(t){if(!(t instanceof bt))return!1;const e=t;return this._modelType===e._modelType&&this._scale===e._scale}compareTo(t){const e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return O.compare(n,i)}getScale(){return this._scale}isFloating(){return this._modelType===bt.FLOATING||this._modelType===bt.FLOATING_SINGLE}getType(){return this._modelType}toString(){let t="UNKNOWN";return this._modelType===bt.FLOATING?t="Floating":this._modelType===bt.FLOATING_SINGLE?t="Floating-Single":this._modelType===bt.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}makePrecise(){if("number"==typeof arguments[0]){const t=arguments[0];return o.isNaN(t)||this._modelType===bt.FLOATING_SINGLE?t:this._modelType===bt.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof y){const t=arguments[0];if(this._modelType===bt.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}}getMaximumSignificantDigits(){let t=16;return this._modelType===bt.FLOATING?t=16:this._modelType===bt.FLOATING_SINGLE?t=6:this._modelType===bt.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}setScale(t){this._scale=Math.abs(t)}get interfaces_(){return[u,s]}}class Et{constructor(){Et.constructor_.apply(this,arguments)}static constructor_(){this._name=null;const t=arguments[0];this._name=t,Et.nameToTypeMap.put(t,this)}readResolve(){return Et.nameToTypeMap.get(this._name)}toString(){return this._name}get interfaces_(){return[u]}}Et.nameToTypeMap=new wt,bt.Type=Et,bt.FIXED=new Et("FIXED"),bt.FLOATING=new Et("FLOATING"),bt.FLOATING_SINGLE=new Et("FLOATING SINGLE"),bt.maximumPreciseValue=9007199254740992;class It extends ct{constructor(){super(),It.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];ct.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new It(t,this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof H){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return this.isClosed()?J.FALSE:0}isClosed(){if(this.isEmpty())return!1;for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}getTypeCode(){return H.TYPECODE_MULTILINESTRING}getDimension(){return 1}getBoundary(){throw new Z}getGeometryType(){return H.TYPENAME_MULTILINESTRING}get interfaces_(){return[W]}}class Pt{constructor(){Pt.constructor_.apply(this,arguments)}static constructor_(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,0===arguments.length)Pt.constructor_.call(this,new bt,0);else if(1===arguments.length){if(C(arguments[0],q)){const t=arguments[0];Pt.constructor_.call(this,new bt,0,t)}else if(arguments[0]instanceof bt){const t=arguments[0];Pt.constructor_.call(this,t,0,Pt.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];Pt.constructor_.call(this,t,e,Pt.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._precisionModel=t,this._coordinateSequenceFactory=n,this._SRID=e}}static toMultiPolygonArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toGeometryArray(t){if(null===t)return null;const e=new Array(t.size()).fill(null);return t.toArray(e)}static getDefaultCoordinateSequenceFactory(){return mt.instance()}static toMultiLineStringArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toLineStringArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toMultiPointArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toLinearRingArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toPointArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toPolygonArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static createPointFromInternalCoord(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}createEmpty(t){switch(t){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new i("Invalid dimension: "+t)}}toGeometry(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new y(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new y(t.getMinX(),t.getMinY()),new y(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new y(t.getMinX(),t.getMinY()),new y(t.getMinX(),t.getMaxY()),new y(t.getMaxX(),t.getMaxY()),new y(t.getMaxX(),t.getMinY()),new y(t.getMinX(),t.getMinY())]),null)}createLineString(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(C(arguments[0],k))return new $(arguments[0],this)}}createMultiLineString(){return 0===arguments.length?new It(null,this):1===arguments.length?new It(arguments[0],this):void 0}buildGeometry(t){let e=null,n=!1,i=!1;for(let r=t.iterator();r.hasNext();){const t=r.next(),o=t.getTypeCode();null===e&&(e=o),o!==e&&(n=!0),t instanceof ct&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(Pt.toGeometryArray(t));const r=t.iterator().next();if(t.size()>1){if(r instanceof ot)return this.createMultiPolygon(Pt.toPolygonArray(t));if(r instanceof $)return this.createMultiLineString(Pt.toLineStringArray(t));if(r instanceof et)return this.createMultiPoint(Pt.toPointArray(t));p.shouldNeverReachHere("Unhandled geometry type: "+r.getGeometryType())}return r}createMultiPointFromCoords(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}createPoint(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof y){const t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(C(arguments[0],k))return new et(arguments[0],this)}}getCoordinateSequenceFactory(){return this._coordinateSequenceFactory}createPolygon(){if(0===arguments.length)return this.createPolygon(null,null);if(1===arguments.length){if(C(arguments[0],k)){const t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){const t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof pt){const t=arguments[0];return this.createPolygon(t,null)}}else if(2===arguments.length)return new ot(arguments[0],arguments[1],this)}getSRID(){return this._SRID}createGeometryCollection(){return 0===arguments.length?new ct(null,this):1===arguments.length?new ct(arguments[0],this):void 0}getPrecisionModel(){return this._precisionModel}createLinearRing(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(C(arguments[0],k))return new pt(arguments[0],this)}}createMultiPolygon(){return 0===arguments.length?new _t(null,this):1===arguments.length?new _t(arguments[0],this):void 0}createMultiPoint(){if(0===arguments.length)return new ht(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new ht(arguments[0],this);if(C(arguments[0],k)){const t=arguments[0];if(null===t)return this.createMultiPoint(new Array(0).fill(null));const e=new Array(t.size()).fill(null);for(let n=0;n<t.size();n++){const i=this.getCoordinateSequenceFactory().create(1,t.getDimension(),t.getMeasures());K.copy(t,n,i,0,1),e[n]=this.createPoint(i)}return this.createMultiPoint(e)}}}get interfaces_(){return[u]}}const Nt="XY",St="XYZ",Tt="XYM",Lt="XYZM",Mt={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Ot=1,Rt=2,At=3,Dt=4,Ft=5,kt=6;for(const t in Mt)Mt[t].toUpperCase();class Bt{constructor(t){this.wkt=t,this.index_=-1}isAlpha_(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"}isNumeric_(t,e){return t>="0"&&t<="9"||"."==t&&!(void 0!==e&&e)}isWhiteSpace_(t){return" "==t||"\t"==t||"\r"==t||"\n"==t}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){const t=this.nextChar_(),e=this.index_;let n,i=t;if("("==t)n=Rt;else if(","==t)n=Ft;else if(")"==t)n=At;else if(this.isNumeric_(t)||"-"==t)n=Dt,i=this.readNumber_();else if(this.isAlpha_(t))n=Ot,i=this.readText_();else{if(this.isWhiteSpace_(t))return this.nextToken();if(""!==t)throw new Error("Unexpected character: "+t);n=kt}return{position:e,value:i,type:n}}readNumber_(){let t;const e=this.index_;let n=!1,i=!1;do{"."==t?n=!0:"e"!=t&&"E"!=t||(i=!0),t=this.nextChar_()}while(this.isNumeric_(t,n)||!i&&("e"==t||"E"==t)||i&&("-"==t||"+"==t));return parseFloat(this.wkt.substring(e,this.index_--))}readText_(){let t;const e=this.index_;do{t=this.nextChar_()}while(this.isAlpha_(t));return this.wkt.substring(e,this.index_--).toUpperCase()}}class Gt{constructor(t,e){this.lexer_=t,this.token_,this.layout_=Nt,this.factory=e}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(t){return this.token_.type==t}match(t){const e=this.isTokenType(t);return e&&this.consume_(),e}parse(){return this.consume_(),this.parseGeometry_()}parseGeometryLayout_(){let t=Nt;const e=this.token_;if(this.isTokenType(Ot)){const n=e.value;"Z"===n?t=St:"M"===n?t=Tt:"ZM"===n&&(t=Lt),t!==Nt&&this.consume_()}return t}parseGeometryCollectionText_(){if(this.match(Rt)){const t=[];do{t.push(this.parseGeometry_())}while(this.match(Ft));if(this.match(At))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePointText_(){if(this.match(Rt)){const t=this.parsePoint_();if(this.match(At))return t}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match(Rt)){const t=this.parsePointList_();if(this.match(At))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match(Rt)){const t=this.parseLineStringTextList_();if(this.match(At))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match(Rt)){let t;if(t=this.token_.type==Rt?this.parsePointTextList_():this.parsePointList_(),this.match(At))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match(Rt)){const t=this.parseLineStringTextList_();if(this.match(At))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match(Rt)){const t=this.parsePolygonTextList_();if(this.match(At))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePoint_(){const t=[],e=this.layout_.length;for(let n=0;n<e;++n){const e=this.token_;if(!this.match(Dt))break;t.push(e.value)}if(t.length==e)return t;throw new Error(this.formatErrorMessage_())}parsePointList_(){const t=[this.parsePoint_()];for(;this.match(Ft);)t.push(this.parsePoint_());return t}parsePointTextList_(){const t=[this.parsePointText_()];for(;this.match(Ft);)t.push(this.parsePointText_());return t}parseLineStringTextList_(){const t=[this.parseLineStringText_()];for(;this.match(Ft);)t.push(this.parseLineStringText_());return t}parsePolygonTextList_(){const t=[this.parsePolygonText_()];for(;this.match(Ft);)t.push(this.parsePolygonText_());return t}isEmptyGeometry_(){const t=this.isTokenType(Ot)&&"EMPTY"==this.token_.value;return t&&this.consume_(),t}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){const t=this.factory,e=t=>new y(...t),n=n=>{const i=n.map(n=>t.createLinearRing(n.map(e)));return i.length>1?t.createPolygon(i[0],i.slice(1)):t.createPolygon(i[0])},i=this.token_;if(this.match(Ot)){const r=i.value;if(this.layout_=this.parseGeometryLayout_(),"GEOMETRYCOLLECTION"==r){const e=this.parseGeometryCollectionText_();return t.createGeometryCollection(e)}switch(r){case"POINT":{const e=this.parsePointText_();return e?t.createPoint(new y(...e)):t.createPoint()}case"LINESTRING":{const n=this.parseLineStringText_().map(e);return t.createLineString(n)}case"LINEARRING":{const n=this.parseLineStringText_().map(e);return t.createLinearRing(n)}case"POLYGON":{const e=this.parsePolygonText_();return e&&0!==e.length?n(e):t.createPolygon()}case"MULTIPOINT":{const n=this.parseMultiPointText_();if(!n||0===n.length)return t.createMultiPoint();const i=n.map(e).map(e=>t.createPoint(e));return t.createMultiPoint(i)}case"MULTILINESTRING":{const n=this.parseMultiLineStringText_().map(n=>t.createLineString(n.map(e)));return t.createMultiLineString(n)}case"MULTIPOLYGON":{const e=this.parseMultiPolygonText_();if(!e||0===e.length)return t.createMultiPolygon();const i=e.map(n);return t.createMultiPolygon(i)}default:throw new Error("Invalid geometry type: "+r)}}throw new Error(this.formatErrorMessage_())}}function jt(t){if(t.isEmpty())return"";const e=t.getCoordinate(),n=[e.x,e.y];return void 0===e.z||Number.isNaN(e.z)||n.push(e.z),void 0===e.m||Number.isNaN(e.m)||n.push(e.m),n.join(" ")}function zt(t){const e=t.getCoordinates().map(t=>{const e=[t.x,t.y];return void 0===t.z||Number.isNaN(t.z)||e.push(t.z),void 0===t.m||Number.isNaN(t.m)||e.push(t.m),e}),n=[];for(let t=0,i=e.length;t<i;++t)n.push(e[t].join(" "));return n.join(", ")}function Ut(t){const e=[];e.push("("+zt(t.getExteriorRing())+")");for(let n=0,i=t.getNumInteriorRing();n<i;++n)e.push("("+zt(t.getInteriorRingN(n))+")");return e.join(", ")}const qt={Point:jt,LineString:zt,LinearRing:zt,Polygon:Ut,MultiPoint:function(t){const e=[];for(let n=0,i=t.getNumGeometries();n<i;++n)e.push("("+jt(t.getGeometryN(n))+")");return e.join(", ")},MultiLineString:function(t){const e=[];for(let n=0,i=t.getNumGeometries();n<i;++n)e.push("("+zt(t.getGeometryN(n))+")");return e.join(", ")},MultiPolygon:function(t){const e=[];for(let n=0,i=t.getNumGeometries();n<i;++n)e.push("("+Ut(t.getGeometryN(n))+")");return e.join(", ")},GeometryCollection:function(t){const e=[];for(let n=0,i=t.getNumGeometries();n<i;++n)e.push(Vt(t.getGeometryN(n)));return e.join(", ")}};function Vt(t){let e=t.getGeometryType();const n=qt[e];e=e.toUpperCase();const i=function(t){let e="";if(t.isEmpty())return e;const n=t.getCoordinate();return void 0===n.z||Number.isNaN(n.z)||(e+="Z"),void 0===n.m||Number.isNaN(n.m)||(e+="M"),e}(t);return i.length>0&&(e+=" "+i),t.isEmpty()?e+" EMPTY":e+" ("+n(t)+")"}class Ht{constructor(t){this.geometryFactory=t||new Pt,this.precisionModel=this.geometryFactory.getPrecisionModel()}read(t){const e=new Bt(t);return new Gt(e,this.geometryFactory).parse()}write(t){return Vt(t)}}class Yt{constructor(t){this.parser=new Ht(t)}write(t){return this.parser.write(t)}static toLineString(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}class Xt{constructor(){Xt.constructor_.apply(this,arguments)}static constructor_(){this._result=null,this._inputLines=Array(2).fill().map(()=>Array(2)),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new y,this._intPt[1]=new y,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}static computeEdgeDistance(t,e,n){const i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y);let o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=i>r?i:r;else{const n=Math.abs(t.x-e.x),s=Math.abs(t.y-e.y);o=i>r?n:s,0!==o||t.equals(e)||(o=Math.max(n,s))}return p.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o}static nonRobustComputeEdgeDistance(t,e,n){const i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);return p.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o}getIndexAlongSegment(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}getTopologySummary(){const t=new gt;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}computeIntersection(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)}getIntersectionNum(){return this._result}computeIntLineIndex(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(()=>Array(2)),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){const t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}isProper(){return this.hasIntersection()&&this._isProper}setPrecisionModel(t){this._precisionModel=t}isInteriorIntersection(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){const t=arguments[0];for(let e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}}getIntersection(t){return this._intPt[t]}isEndPoint(){return this.hasIntersection()&&!this._isProper}hasIntersection(){return this._result!==Xt.NO_INTERSECTION}getEdgeDistance(t,e){return Xt.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])}isCollinear(){return this._result===Xt.COLLINEAR_INTERSECTION}toString(){return Yt.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Yt.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}getEndpoint(t,e){return this._inputLines[t][e]}isIntersection(t){for(let e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}getIntersectionAlongSegment(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}}Xt.DONT_INTERSECT=0,Xt.DO_INTERSECT=1,Xt.COLLINEAR=2,Xt.NO_INTERSECTION=0,Xt.POINT_INTERSECTION=1,Xt.COLLINEAR_INTERSECTION=2;class Wt extends Xt{constructor(){super()}static nearestEndpoint(t,e,n,i){let r=t,o=U.pointToSegment(t,n,i),s=U.pointToSegment(e,n,i);return s<o&&(o=s,r=e),s=U.pointToSegment(n,t,e),s<o&&(o=s,r=n),s=U.pointToSegment(i,t,e),s<o&&(o=s,r=i),r}isInSegmentEnvelopes(t){const e=new L(this._inputLines[0][0],this._inputLines[0][1]),n=new L(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)}computeIntersection(){if(3!==arguments.length)return super.computeIntersection.apply(this,arguments);{const t=arguments[0],e=arguments[1],n=arguments[2];if(this._isProper=!1,L.intersects(e,n,t)&&0===B.index(e,n,t)&&0===B.index(n,e,t))return this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this._result=Xt.POINT_INTERSECTION,null;this._result=Xt.NO_INTERSECTION}}intersection(t,e,n,i){let r=this.intersectionSafe(t,e,n,i);return this.isInSegmentEnvelopes(r)||(r=new y(Wt.nearestEndpoint(t,e,n,i))),null!==this._precisionModel&&this._precisionModel.makePrecise(r),r}checkDD(t,e,n,i,r){const o=F.intersection(t,e,n,i),s=this.isInSegmentEnvelopes(o);j.out.println("DD in env = "+s+"  --------------------- "+o),r.distance(o)>1e-4&&j.out.println("Distance = "+r.distance(o))}intersectionSafe(t,e,n,i){let r=G.intersection(t,e,n,i);return null===r&&(r=Wt.nearestEndpoint(t,e,n,i)),r}computeCollinearIntersection(t,e,n,i){const r=L.intersects(t,e,n),o=L.intersects(t,e,i),s=L.intersects(n,i,t),a=L.intersects(n,i,e);return r&&o?(this._intPt[0]=n,this._intPt[1]=i,Xt.COLLINEAR_INTERSECTION):s&&a?(this._intPt[0]=t,this._intPt[1]=e,Xt.COLLINEAR_INTERSECTION):r&&s?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||o||a?Xt.COLLINEAR_INTERSECTION:Xt.POINT_INTERSECTION):r&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||o||s?Xt.COLLINEAR_INTERSECTION:Xt.POINT_INTERSECTION):o&&s?(this._intPt[0]=i,this._intPt[1]=t,!i.equals(t)||r||a?Xt.COLLINEAR_INTERSECTION:Xt.POINT_INTERSECTION):o&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||r||s?Xt.COLLINEAR_INTERSECTION:Xt.POINT_INTERSECTION):Xt.NO_INTERSECTION}computeIntersect(t,e,n,i){if(this._isProper=!1,!L.intersects(t,e,n,i))return Xt.NO_INTERSECTION;const r=B.index(t,e,n),o=B.index(t,e,i);if(r>0&&o>0||r<0&&o<0)return Xt.NO_INTERSECTION;const s=B.index(n,i,t),a=B.index(n,i,e);return s>0&&a>0||s<0&&a<0?Xt.NO_INTERSECTION:0===r&&0===o&&0===s&&0===a?this.computeCollinearIntersection(t,e,n,i):(0===r||0===o||0===s||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this._intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this._intPt[0]=e:0===r?this._intPt[0]=new y(n):0===o?this._intPt[0]=new y(i):0===s?this._intPt[0]=new y(t):0===a&&(this._intPt[0]=new y(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,n,i)),Xt.POINT_INTERSECTION)}}class Kt{constructor(){Kt.constructor_.apply(this,arguments)}static constructor_(){if(this.p0=null,this.p1=null,0===arguments.length)Kt.constructor_.call(this,new y,new y);else if(1===arguments.length){const t=arguments[0];Kt.constructor_.call(this,t.p0,t.p1)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.p0=t,this.p1=e}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];Kt.constructor_.call(this,new y(t,e),new y(n,i))}}static midPoint(t,e){return new y((t.x+e.x)/2,(t.y+e.y)/2)}minX(){return Math.min(this.p0.x,this.p1.x)}orientationIndex(){if(arguments[0]instanceof Kt){const t=arguments[0],e=B.index(this.p0,this.p1,t.p0),n=B.index(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof y){const t=arguments[0];return B.index(this.p0,this.p1,t)}}toGeometry(t){return t.createLineString([this.p0,this.p1])}isVertical(){return this.p0.x===this.p1.x}equals(t){if(!(t instanceof Kt))return!1;const e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)}intersection(t){const e=new Wt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}project(){if(arguments[0]instanceof y){const t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new y(t);const e=this.projectionFactor(t),n=new y;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof Kt){const t=arguments[0],e=this.projectionFactor(t.p0),n=this.projectionFactor(t.p1);if(e>=1&&n>=1)return null;if(e<=0&&n<=0)return null;let i=this.project(t.p0);e<0&&(i=this.p0),e>1&&(i=this.p1);let r=this.project(t.p1);return n<0&&(r=this.p0),n>1&&(r=this.p1),new Kt(i,r)}}normalize(){this.p1.compareTo(this.p0)<0&&this.reverse()}angle(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}getCoordinate(t){return 0===t?this.p0:this.p1}distancePerpendicular(t){return U.pointToLinePerpendicular(t,this.p0,this.p1)}minY(){return Math.min(this.p0.y,this.p1.y)}midPoint(){return Kt.midPoint(this.p0,this.p1)}projectionFactor(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;const e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?o.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i}closestPoints(t){const e=this.intersection(t);if(null!==e)return[e,e];const n=new Array(2).fill(null);let i=o.MAX_VALUE,r=null;const s=this.closestPoint(t.p0);i=s.distance(t.p0),n[0]=s,n[1]=t.p0;const a=this.closestPoint(t.p1);r=a.distance(t.p1),r<i&&(i=r,n[0]=a,n[1]=t.p1);const l=t.closestPoint(this.p0);r=l.distance(this.p0),r<i&&(i=r,n[0]=this.p0,n[1]=l);const u=t.closestPoint(this.p1);return r=u.distance(this.p1),r<i&&(i=r,n[0]=this.p1,n[1]=u),n}closestPoint(t){const e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}maxX(){return Math.max(this.p0.x,this.p1.x)}getLength(){return this.p0.distance(this.p1)}compareTo(t){const e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)}reverse(){const t=this.p0;this.p0=this.p1,this.p1=t}equalsTopo(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}lineIntersection(t){return G.intersection(this.p0,this.p1,t.p0,t.p1)}maxY(){return Math.max(this.p0.y,this.p1.y)}pointAlongOffset(t,e){const n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o);let a=0,l=0;if(0!==e){if(s<=0)throw new A("Cannot compute offset from zero-length line segment");a=e*r/s,l=e*o/s}return new y(n-l,i+a)}setCoordinates(){if(1===arguments.length){const t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=e.x,this.p1.y=e.y}}segmentFraction(t){let e=this.projectionFactor(t);return e<0?e=0:(e>1||o.isNaN(e))&&(e=1),e}toString(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}isHorizontal(){return this.p0.y===this.p1.y}reflect(t){const e=this.p1.getY()-this.p0.getY(),n=this.p0.getX()-this.p1.getX(),i=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),r=e*e+n*n,o=e*e-n*n,s=t.getX(),a=t.getY();return new y((-o*s-2*e*n*a-2*e*i)/r,(o*a-2*e*n*s-2*n*i)/r)}distance(){if(arguments[0]instanceof Kt){const t=arguments[0];return U.segmentToSegment(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof y){const t=arguments[0];return U.pointToSegment(t,this.p0,this.p1)}}pointAlong(t){const e=new y;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}hashCode(){let t=o.doubleToLongBits(this.p0.x);t^=31*o.doubleToLongBits(this.p0.y);const e=Math.trunc(t)^Math.trunc(t>>32);let n=o.doubleToLongBits(this.p1.x);return n^=31*o.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)}get interfaces_(){return[s,u]}}class Zt{static toLocationSymbol(t){switch(t){case Zt.EXTERIOR:return"e";case Zt.BOUNDARY:return"b";case Zt.INTERIOR:return"i";case Zt.NONE:return"-"}throw new i("Unknown location value: "+t)}}Zt.INTERIOR=0,Zt.BOUNDARY=1,Zt.EXTERIOR=2,Zt.NONE=-1;class Jt{constructor(){Jt.constructor_.apply(this,arguments)}static constructor_(){if(this._matrix=null,0===arguments.length)this._matrix=Array(3).fill().map(()=>Array(3)),this.setAll(J.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){const t=arguments[0];Jt.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof Jt){const t=arguments[0];Jt.constructor_.call(this),this._matrix[Zt.INTERIOR][Zt.INTERIOR]=t._matrix[Zt.INTERIOR][Zt.INTERIOR],this._matrix[Zt.INTERIOR][Zt.BOUNDARY]=t._matrix[Zt.INTERIOR][Zt.BOUNDARY],this._matrix[Zt.INTERIOR][Zt.EXTERIOR]=t._matrix[Zt.INTERIOR][Zt.EXTERIOR],this._matrix[Zt.BOUNDARY][Zt.INTERIOR]=t._matrix[Zt.BOUNDARY][Zt.INTERIOR],this._matrix[Zt.BOUNDARY][Zt.BOUNDARY]=t._matrix[Zt.BOUNDARY][Zt.BOUNDARY],this._matrix[Zt.BOUNDARY][Zt.EXTERIOR]=t._matrix[Zt.BOUNDARY][Zt.EXTERIOR],this._matrix[Zt.EXTERIOR][Zt.INTERIOR]=t._matrix[Zt.EXTERIOR][Zt.INTERIOR],this._matrix[Zt.EXTERIOR][Zt.BOUNDARY]=t._matrix[Zt.EXTERIOR][Zt.BOUNDARY],this._matrix[Zt.EXTERIOR][Zt.EXTERIOR]=t._matrix[Zt.EXTERIOR][Zt.EXTERIOR]}}static matches(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return e===J.SYM_DONTCARE||e===J.SYM_TRUE&&(t>=0||t===J.TRUE)||e===J.SYM_FALSE&&t===J.FALSE||e===J.SYM_P&&t===J.P||e===J.SYM_L&&t===J.L||e===J.SYM_A&&t===J.A}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){const t=arguments[1];return new Jt(arguments[0]).matches(t)}}static isTrue(t){return t>=0||t===J.TRUE}isIntersects(){return!this.isDisjoint()}isCovers(){return(Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.INTERIOR])||Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.BOUNDARY])||Jt.isTrue(this._matrix[Zt.BOUNDARY][Zt.INTERIOR])||Jt.isTrue(this._matrix[Zt.BOUNDARY][Zt.BOUNDARY]))&&this._matrix[Zt.EXTERIOR][Zt.INTERIOR]===J.FALSE&&this._matrix[Zt.EXTERIOR][Zt.BOUNDARY]===J.FALSE}isCoveredBy(){return(Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.INTERIOR])||Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.BOUNDARY])||Jt.isTrue(this._matrix[Zt.BOUNDARY][Zt.INTERIOR])||Jt.isTrue(this._matrix[Zt.BOUNDARY][Zt.BOUNDARY]))&&this._matrix[Zt.INTERIOR][Zt.EXTERIOR]===J.FALSE&&this._matrix[Zt.BOUNDARY][Zt.EXTERIOR]===J.FALSE}set(){if(1===arguments.length){const t=arguments[0];for(let e=0;e<t.length;e++){const n=Math.trunc(e/3),i=e%3;this._matrix[n][i]=J.toDimensionValue(t.charAt(e))}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._matrix[t][e]=n}}isContains(){return Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.INTERIOR])&&this._matrix[Zt.EXTERIOR][Zt.INTERIOR]===J.FALSE&&this._matrix[Zt.EXTERIOR][Zt.BOUNDARY]===J.FALSE}setAtLeast(){if(1===arguments.length){const t=arguments[0];for(let e=0;e<t.length;e++){const n=Math.trunc(e/3),i=e%3;this.setAtLeast(n,i,J.toDimensionValue(t.charAt(e)))}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._matrix[t][e]<n&&(this._matrix[t][e]=n)}}setAtLeastIfValid(t,e,n){t>=0&&e>=0&&this.setAtLeast(t,e,n)}isWithin(){return Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.INTERIOR])&&this._matrix[Zt.INTERIOR][Zt.EXTERIOR]===J.FALSE&&this._matrix[Zt.BOUNDARY][Zt.EXTERIOR]===J.FALSE}isTouches(t,e){return t>e?this.isTouches(e,t):(t===J.A&&e===J.A||t===J.L&&e===J.L||t===J.L&&e===J.A||t===J.P&&e===J.A||t===J.P&&e===J.L)&&this._matrix[Zt.INTERIOR][Zt.INTERIOR]===J.FALSE&&(Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.BOUNDARY])||Jt.isTrue(this._matrix[Zt.BOUNDARY][Zt.INTERIOR])||Jt.isTrue(this._matrix[Zt.BOUNDARY][Zt.BOUNDARY]))}isOverlaps(t,e){return t===J.P&&e===J.P||t===J.A&&e===J.A?Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.INTERIOR])&&Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.EXTERIOR])&&Jt.isTrue(this._matrix[Zt.EXTERIOR][Zt.INTERIOR]):t===J.L&&e===J.L&&1===this._matrix[Zt.INTERIOR][Zt.INTERIOR]&&Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.EXTERIOR])&&Jt.isTrue(this._matrix[Zt.EXTERIOR][Zt.INTERIOR])}isEquals(t,e){return t===e&&Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.INTERIOR])&&this._matrix[Zt.INTERIOR][Zt.EXTERIOR]===J.FALSE&&this._matrix[Zt.BOUNDARY][Zt.EXTERIOR]===J.FALSE&&this._matrix[Zt.EXTERIOR][Zt.INTERIOR]===J.FALSE&&this._matrix[Zt.EXTERIOR][Zt.BOUNDARY]===J.FALSE}toString(){const t=new gt("123456789");for(let e=0;e<3;e++)for(let n=0;n<3;n++)t.setCharAt(3*e+n,J.toDimensionSymbol(this._matrix[e][n]));return t.toString()}setAll(t){for(let e=0;e<3;e++)for(let n=0;n<3;n++)this._matrix[e][n]=t}get(t,e){return this._matrix[t][e]}transpose(){let t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}matches(t){if(9!==t.length)throw new i("Should be length 9: "+t);for(let e=0;e<3;e++)for(let n=0;n<3;n++)if(!Jt.matches(this._matrix[e][n],t.charAt(3*e+n)))return!1;return!0}add(t){for(let e=0;e<3;e++)for(let n=0;n<3;n++)this.setAtLeast(e,n,t.get(e,n))}isDisjoint(){return this._matrix[Zt.INTERIOR][Zt.INTERIOR]===J.FALSE&&this._matrix[Zt.INTERIOR][Zt.BOUNDARY]===J.FALSE&&this._matrix[Zt.BOUNDARY][Zt.INTERIOR]===J.FALSE&&this._matrix[Zt.BOUNDARY][Zt.BOUNDARY]===J.FALSE}isCrosses(t,e){return t===J.P&&e===J.L||t===J.P&&e===J.A||t===J.L&&e===J.A?Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.INTERIOR])&&Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.EXTERIOR]):t===J.L&&e===J.P||t===J.A&&e===J.P||t===J.A&&e===J.L?Jt.isTrue(this._matrix[Zt.INTERIOR][Zt.INTERIOR])&&Jt.isTrue(this._matrix[Zt.EXTERIOR][Zt.INTERIOR]):t===J.L&&e===J.L&&0===this._matrix[Zt.INTERIOR][Zt.INTERIOR]}get interfaces_(){return[a]}}class Qt{static toDegrees(t){return 180*t/Math.PI}static normalize(t){for(;t>Math.PI;)t-=Qt.PI_TIMES_2;for(;t<=-Math.PI;)t+=Qt.PI_TIMES_2;return t}static angle(){if(1===arguments.length){const t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){const t=arguments[0],e=arguments[1],n=e.x-t.x,i=e.y-t.y;return Math.atan2(i,n)}}static isAcute(t,e,n){const i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0}static isObtuse(t,e,n){const i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0}static interiorAngle(t,e,n){const i=Qt.angle(e,t),r=Qt.angle(e,n);return Math.abs(r-i)}static normalizePositive(t){if(t<0){for(;t<0;)t+=Qt.PI_TIMES_2;t>=Qt.PI_TIMES_2&&(t=0)}else{for(;t>=Qt.PI_TIMES_2;)t-=Qt.PI_TIMES_2;t<0&&(t=0)}return t}static angleBetween(t,e,n){const i=Qt.angle(e,t),r=Qt.angle(e,n);return Qt.diff(i,r)}static diff(t,e){let n=null;return n=t<e?e-t:t-e,n>Math.PI&&(n=2*Math.PI-n),n}static toRadians(t){return t*Math.PI/180}static getTurn(t,e){const n=Math.sin(e-t);return n>0?Qt.COUNTERCLOCKWISE:n<0?Qt.CLOCKWISE:Qt.NONE}static angleBetweenOriented(t,e,n){const i=Qt.angle(e,t),r=Qt.angle(e,n)-i;return r<=-Math.PI?r+Qt.PI_TIMES_2:r>Math.PI?r-Qt.PI_TIMES_2:r}}Qt.PI_TIMES_2=2*Math.PI,Qt.PI_OVER_2=Math.PI/2,Qt.PI_OVER_4=Math.PI/4,Qt.COUNTERCLOCKWISE=B.COUNTERCLOCKWISE,Qt.CLOCKWISE=B.CLOCKWISE,Qt.NONE=B.COLLINEAR;class $t extends n{constructor(){super(),$t.constructor_.apply(this,arguments)}static constructor_(){n.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}class te{constructor(){te.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){const t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];this.x=t,this.y=e,this.w=1}else if(arguments[0]instanceof te&&arguments[1]instanceof te){const t=arguments[0],e=arguments[1];this.x=t.y*e.w-e.y*t.w,this.y=e.x*t.w-t.x*e.w,this.w=t.x*e.y-e.x*t.y}else if(arguments[0]instanceof y&&arguments[1]instanceof y){const t=arguments[0],e=arguments[1];this.x=t.y-e.y,this.y=e.x-t.x,this.w=t.x*e.y-e.x*t.y}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.x=t,this.y=e,this.w=n}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-i.y,l=i.x-n.x,u=n.x*i.y-i.x*n.y;this.x=o*u-l*s,this.y=a*s-r*u,this.w=r*l-a*o}}getY(){const t=this.y/this.w;if(o.isNaN(t)||o.isInfinite(t))throw new $t;return t}getX(){const t=this.x/this.w;if(o.isNaN(t)||o.isInfinite(t))throw new $t;return t}getCoordinate(){const t=new y;return t.x=this.getX(),t.y=this.getY(),t}}class ee{constructor(){ee.constructor_.apply(this,arguments)}static constructor_(){this.p0=null,this.p1=null,this.p2=null;const t=arguments[0],e=arguments[1],n=arguments[2];this.p0=t,this.p1=e,this.p2=n}static area(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)}static signedArea(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2}static det(t,e,n,i){return t*i-e*n}static interpolateZ(t,e,n,i){const r=e.x,o=e.y,s=n.x-r,a=i.x-r,l=n.y-o,u=i.y-o,c=s*u-a*l,h=t.x-r,p=t.y-o,f=(u*h-a*p)/c,d=(-l*h+s*p)/c;return e.getZ()+f*(n.getZ()-e.getZ())+d*(i.getZ()-e.getZ())}static longestSideLength(t,e,n){const i=t.distance(e),r=e.distance(n),o=n.distance(t);let s=i;return r>s&&(s=r),o>s&&(s=o),s}static circumcentreDD(t,e,n){const i=D.valueOf(t.x).subtract(n.x),r=D.valueOf(t.y).subtract(n.y),o=D.valueOf(e.x).subtract(n.x),s=D.valueOf(e.y).subtract(n.y),a=D.determinant(i,r,o,s).multiply(2),l=i.sqr().add(r.sqr()),u=o.sqr().add(s.sqr()),c=D.determinant(r,l,s,u),h=D.determinant(i,l,o,u),p=D.valueOf(n.x).subtract(c.divide(a)).doubleValue(),f=D.valueOf(n.y).add(h.divide(a)).doubleValue();return new y(p,f)}static isAcute(t,e,n){return!!Qt.isAcute(t,e,n)&&!!Qt.isAcute(e,n,t)&&!!Qt.isAcute(n,t,e)}static circumcentre(t,e,n){const i=n.x,r=n.y,o=t.x-i,s=t.y-r,a=e.x-i,l=e.y-r,u=2*ee.det(o,s,a,l),c=ee.det(s,o*o+s*s,l,a*a+l*l),h=ee.det(o,o*o+s*s,a,a*a+l*l);return new y(i-c/u,r+h/u)}static perpendicularBisector(t,e){const n=e.x-t.x,i=e.y-t.y,r=new te(t.x+n/2,t.y+i/2,1),o=new te(t.x-i+n/2,t.y+n+i/2,1);return new te(r,o)}static angleBisector(t,e,n){const i=e.distance(t),r=i/(i+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new y(t.x+r*o,t.y+r*s)}static area3D(t,e,n){const i=e.x-t.x,r=e.y-t.y,o=e.getZ()-t.getZ(),s=n.x-t.x,a=n.y-t.y,l=n.getZ()-t.getZ(),u=r*l-o*a,c=o*s-i*l,h=i*a-r*s,p=u*u+c*c+h*h;return Math.sqrt(p)/2}static centroid(t,e,n){const i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new y(i,r)}static inCentre(t,e,n){const i=e.distance(n),r=t.distance(n),o=t.distance(e),s=i+r+o,a=(i*t.x+r*e.x+o*n.x)/s,l=(i*t.y+r*e.y+o*n.y)/s;return new y(a,l)}area(){return ee.area(this.p0,this.p1,this.p2)}signedArea(){return ee.signedArea(this.p0,this.p1,this.p2)}interpolateZ(t){if(null===t)throw new i("Supplied point is null.");return ee.interpolateZ(t,this.p0,this.p1,this.p2)}longestSideLength(){return ee.longestSideLength(this.p0,this.p1,this.p2)}isAcute(){return ee.isAcute(this.p0,this.p1,this.p2)}circumcentre(){return ee.circumcentre(this.p0,this.p1,this.p2)}area3D(){return ee.area3D(this.p0,this.p1,this.p2)}centroid(){return ee.centroid(this.p0,this.p1,this.p2)}inCentre(){return ee.inCentre(this.p0,this.p1,this.p2)}}class ne extends n{constructor(){super(),ne.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length)n.constructor_.call(this);else if(1===arguments.length){const t=arguments[0];n.constructor_.call(this,t)}}}class ie{constructor(){ie.constructor_.apply(this,arguments)}static constructor_(){if(this._m00=null,this._m01=null,this._m02=null,this._m10=null,this._m11=null,this._m12=null,0===arguments.length)this.setToIdentity();else if(1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];this._m00=t[0],this._m01=t[1],this._m02=t[2],this._m10=t[3],this._m11=t[4],this._m12=t[5]}else if(arguments[0]instanceof ie){const t=arguments[0];this.setTransformation(t)}}else if(6===arguments.length&&"number"==typeof arguments[5]&&"number"==typeof arguments[4]&&"number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],o=arguments[5];this.setTransformation(t,e,n,i,r,o)}}static translationInstance(t,e){const n=new ie;return n.setToTranslation(t,e),n}static shearInstance(t,e){const n=new ie;return n.setToShear(t,e),n}static reflectionInstance(){if(2===arguments.length){const t=arguments[0],e=arguments[1],n=new ie;return n.setToReflection(t,e),n}if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=new ie;return r.setToReflection(t,e,n,i),r}}static rotationInstance(){if(1===arguments.length){const t=arguments[0];return ie.rotationInstance(Math.sin(t),Math.cos(t))}if(2===arguments.length){const t=arguments[0],e=arguments[1],n=new ie;return n.setToRotation(t,e),n}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];return ie.rotationInstance(Math.sin(t),Math.cos(t),e,n)}if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=new ie;return r.setToRotation(t,e,n,i),r}}static scaleInstance(){if(2===arguments.length){const t=arguments[0],e=arguments[1],n=new ie;return n.setToScale(t,e),n}if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=new ie;return r.translate(-n,-i),r.scale(t,e),r.translate(n,i),r}}setToReflectionBasic(t,e,n,r){if(t===n&&e===r)throw new i("Reflection line points must be distinct");const o=n-t,s=r-e,a=Math.sqrt(o*o+s*s),l=s/a,u=o/a,c=2*l*u,h=u*u-l*l;return this._m00=h,this._m01=c,this._m02=0,this._m10=c,this._m11=-h,this._m12=0,this}getInverse(){const t=this.getDeterminant();if(0===t)throw new ne("Transformation is non-invertible");const e=this._m11/t,n=-this._m10/t,i=-this._m01/t,r=this._m00/t,o=(this._m01*this._m12-this._m02*this._m11)/t,s=(-this._m00*this._m12+this._m10*this._m02)/t;return new ie(e,i,o,n,r,s)}compose(t){const e=t._m00*this._m00+t._m01*this._m10,n=t._m00*this._m01+t._m01*this._m11,i=t._m00*this._m02+t._m01*this._m12+t._m02,r=t._m10*this._m00+t._m11*this._m10,o=t._m10*this._m01+t._m11*this._m11,s=t._m10*this._m02+t._m11*this._m12+t._m12;return this._m00=e,this._m01=n,this._m02=i,this._m10=r,this._m11=o,this._m12=s,this}equals(t){if(null===t)return!1;if(!(t instanceof ie))return!1;const e=t;return this._m00===e._m00&&this._m01===e._m01&&this._m02===e._m02&&this._m10===e._m10&&this._m11===e._m11&&this._m12===e._m12}setToScale(t,e){return this._m00=t,this._m01=0,this._m02=0,this._m10=0,this._m11=e,this._m12=0,this}isIdentity(){return 1===this._m00&&0===this._m01&&0===this._m02&&0===this._m10&&1===this._m11&&0===this._m12}scale(t,e){return this.compose(ie.scaleInstance(t,e)),this}setToIdentity(){return this._m00=1,this._m01=0,this._m02=0,this._m10=0,this._m11=1,this._m12=0,this}isGeometryChanged(){return!0}setTransformation(){if(1===arguments.length){const t=arguments[0];return this._m00=t._m00,this._m01=t._m01,this._m02=t._m02,this._m10=t._m10,this._m11=t._m11,this._m12=t._m12,this}if(6===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],o=arguments[5];return this._m00=t,this._m01=e,this._m02=n,this._m10=i,this._m11=r,this._m12=o,this}}setToRotation(){if(1===arguments.length){const t=arguments[0];return this.setToRotation(Math.sin(t),Math.cos(t)),this}if(2===arguments.length){const t=arguments[0],e=arguments[1];return this._m00=e,this._m01=-t,this._m02=0,this._m10=t,this._m11=e,this._m12=0,this}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];return this.setToRotation(Math.sin(t),Math.cos(t),e,n),this}if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];return this._m00=e,this._m01=-t,this._m02=n-n*e+i*t,this._m10=t,this._m11=e,this._m12=i-n*t-i*e,this}}getMatrixEntries(){return[this._m00,this._m01,this._m02,this._m10,this._m11,this._m12]}filter(t,e){this.transform(t,e)}rotate(){if(1===arguments.length){const t=arguments[0];return this.compose(ie.rotationInstance(t)),this}if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.compose(ie.rotationInstance(t,e)),this}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];return this.compose(ie.rotationInstance(t,e,n)),this}if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];return this.compose(ie.rotationInstance(t,e,n,i)),this}}getDeterminant(){return this._m00*this._m11-this._m01*this._m10}composeBefore(t){const e=this._m00*t._m00+this._m01*t._m10,n=this._m00*t._m01+this._m01*t._m11,i=this._m00*t._m02+this._m01*t._m12+this._m02,r=this._m10*t._m00+this._m11*t._m10,o=this._m10*t._m01+this._m11*t._m11,s=this._m10*t._m02+this._m11*t._m12+this._m12;return this._m00=e,this._m01=n,this._m02=i,this._m10=r,this._m11=o,this._m12=s,this}setToShear(t,e){return this._m00=1,this._m01=t,this._m02=0,this._m10=e,this._m11=1,this._m12=0,this}isDone(){return!1}clone(){try{return null}catch(t){if(!(t instanceof n))throw t;p.shouldNeverReachHere()}return null}translate(t,e){return this.compose(ie.translationInstance(t,e)),this}setToReflection(){if(2===arguments.length){const t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new i("Reflection vector must be non-zero");if(t===e)return this._m00=0,this._m01=1,this._m02=0,this._m10=1,this._m11=0,this._m12=0,this;const n=Math.sqrt(t*t+e*e),r=e/n,o=t/n;return this.rotate(-r,o),this.scale(1,-1),this.rotate(r,o),this}if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];if(t===n&&e===r)throw new i("Reflection line points must be distinct");this.setToTranslation(-t,-e);const o=n-t,s=r-e,a=Math.sqrt(o*o+s*s),l=s/a,u=o/a;return this.rotate(-l,u),this.scale(1,-1),this.rotate(l,u),this.translate(t,e),this}}toString(){return"AffineTransformation[["+this._m00+", "+this._m01+", "+this._m02+"], ["+this._m10+", "+this._m11+", "+this._m12+"]]"}setToTranslation(t,e){return this._m00=1,this._m01=0,this._m02=t,this._m10=0,this._m11=1,this._m12=e,this}shear(t,e){return this.compose(ie.shearInstance(t,e)),this}transform(){if(1===arguments.length){const t=arguments[0].copy();return t.apply(this),t}if(2===arguments.length){if(arguments[0]instanceof y&&arguments[1]instanceof y){const t=arguments[0],e=arguments[1],n=this._m00*t.x+this._m01*t.y+this._m02,i=this._m10*t.x+this._m11*t.y+this._m12;return e.x=n,e.y=i,e}if(C(arguments[0],k)&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],n=this._m00*t.getOrdinate(e,0)+this._m01*t.getOrdinate(e,1)+this._m02,i=this._m10*t.getOrdinate(e,0)+this._m11*t.getOrdinate(e,1)+this._m12;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)}}}reflect(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.compose(ie.reflectionInstance(t,e)),this}if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];return this.compose(ie.reflectionInstance(t,e,n,i)),this}}get interfaces_(){return[a,T]}}class re{static solve(t,e){const n=e.length;if(t.length!==n||t[0].length!==n)throw new i("Matrix A is incorrectly sized");for(let i=0;i<n;i++){let r=i;for(let e=i+1;e<n;e++)Math.abs(t[e][i])>Math.abs(t[r][i])&&(r=e);if(0===t[r][i])return null;re.swapRows(t,i,r),re.swapRows(e,i,r);for(let r=i+1;r<n;r++){const o=t[r][i]/t[i][i];for(let e=n-1;e>=i;e--)t[r][e]-=t[i][e]*o;e[r]-=e[i]*o}}const r=new Array(n).fill(null);for(let i=n-1;i>=0;i--){let o=0;for(let e=i+1;e<n;e++)o+=t[i][e]*r[e];r[i]=(e[i]-o)/t[i][i]}return r}static swapRows(){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],n=arguments[2];if(e===n)return null;for(let i=0;i<t[0].length;i++){const r=t[e][i];t[e][i]=t[n][i],t[n][i]=r}}else if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],n=arguments[2];if(e===n)return null;const i=t[e];t[e]=t[n],t[n]=i}}}class oe{constructor(){oe.constructor_.apply(this,arguments)}static constructor_(){this._src0=null,this._src1=null,this._src2=null,this._dest0=null,this._dest1=null,this._dest2=null,this._m00=null,this._m01=null,this._m02=null,this._m10=null,this._m11=null,this._m12=null;const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],o=arguments[5];this._src0=t,this._src1=e,this._src2=n,this._dest0=i,this._dest1=r,this._dest2=o}solve(t){const e=[[this._src0.x,this._src0.y,1],[this._src1.x,this._src1.y,1],[this._src2.x,this._src2.y,1]];return re.solve(e,t)}compute(){const t=[this._dest0.x,this._dest1.x,this._dest2.x],e=this.solve(t);if(null===e)return!1;this._m00=e[0],this._m01=e[1],this._m02=e[2];const n=[this._dest0.y,this._dest1.y,this._dest2.y],i=this.solve(n);return null!==i&&(this._m10=i[0],this._m11=i[1],this._m12=i[2],!0)}getTransformation(){return this.compute()?new ie(this._m00,this._m01,this._m02,this._m10,this._m11,this._m12):null}}class se{static createFromBaseLines(t,e,n,i){const r=new y(t.x+i.x-n.x,t.y+i.y-n.y),o=Qt.angleBetweenOriented(e,t,r),s=e.distance(t),a=i.distance(n);if(0===s)return new ie;const l=a/s,u=ie.translationInstance(-t.x,-t.y);return u.rotate(o),u.scale(l,l),u.translate(n.x,n.y),u}static createFromControlVectors(){if(2===arguments.length){if(arguments[0]instanceof y&&arguments[1]instanceof y){const t=arguments[0],e=arguments[1],n=e.x-t.x,i=e.y-t.y;return ie.translationInstance(n,i)}if(arguments[0]instanceof Array&&arguments[1]instanceof Array){const t=arguments[0],e=arguments[1];if(t.length!==e.length)throw new i("Src and Dest arrays are not the same length");if(t.length<=0)throw new i("Too few control points");if(t.length>3)throw new i("Too many control points");return 1===t.length?se.createFromControlVectors(t[0],e[0]):2===t.length?se.createFromControlVectors(t[0],t[1],e[0],e[1]):se.createFromControlVectors(t[0],t[1],t[2],e[0],e[1],e[2])}}else{if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=new y(i.x-n.x,i.y-n.y),o=Qt.angleBetweenOriented(e,t,r),s=e.distance(t),a=i.distance(n);if(0===s)return null;const l=a/s,u=ie.translationInstance(-t.x,-t.y);return u.rotate(o),u.scale(l,l),u.translate(n.x,n.y),u}if(6===arguments.length)return new oe(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]).getTransformation()}}}class ae{constructor(){ae.constructor_.apply(this,arguments)}static constructor_(){this._coords=null;const t=arguments[0];this._coords=t}static getCoordinates(t){const e=new P;return t.apply(new ae(e)),e}filter(t){(t instanceof $||t instanceof et)&&this._coords.add(t.getCoordinate())}get interfaces_(){return[V]}}class le{constructor(){le.constructor_.apply(this,arguments)}static constructor_(){this._mapOp=null;const t=arguments[0];this._mapOp=t}static map(t,e){return new le(e).map(t)}map(t){const e=new P;for(let n=0;n<t.getNumGeometries();n++){const i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(Pt.toGeometryArray(e))}}class ue{constructor(){ue.constructor_.apply(this,arguments)}static constructor_(){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null;const t=arguments[0];this._geomFactory=ue.extractFactory(t),this._inputGeoms=t}static combine(){if(1===arguments.length)return new ue(arguments[0]).combine();if(2===arguments.length){const t=arguments[0],e=arguments[1];return new ue(ue.createList(t,e)).combine()}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];return new ue(ue.createList(t,e,n)).combine()}}static extractFactory(t){return t.isEmpty()?null:t.iterator().next().getFactory()}static createList(){if(2===arguments.length){const t=arguments[0],e=arguments[1],n=new P;return n.add(t),n.add(e),n}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=new P;return i.add(t),i.add(e),i.add(n),i}}extractElements(t,e){if(null===t)return null;for(let n=0;n<t.getNumGeometries();n++){const i=t.getGeometryN(n);this._skipEmpty&&i.isEmpty()||e.add(i)}}combine(){const t=new P;for(let e=this._inputGeoms.iterator();e.hasNext();){const n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection():null:this._geomFactory.buildGeometry(t)}}class ce{constructor(){ce.constructor_.apply(this,arguments)}static constructor_(){if(this._factory=null,this._isUserDataCopied=!1,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this._factory=t}}setCopyUserData(t){this._isUserDataCopied=t}edit(t,e){if(null===t)return null;const n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n}editInternal(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof ct?this.editGeometryCollection(t,e):t instanceof ot?this.editPolygon(t,e):t instanceof et||t instanceof $?e.edit(t,this._factory):(p.shouldNeverReachHere("Unsupported Geometry type: "+t.getGeometryType()),null)}editGeometryCollection(t,e){const n=e.edit(t,this._factory),i=new P;for(let t=0;t<n.getNumGeometries();t++){const r=this.edit(n.getGeometryN(t),e);null===r||r.isEmpty()||i.add(r)}return n.getGeometryType()===H.TYPENAME_MULTIPOINT?this._factory.createMultiPoint(i.toArray([])):n.getGeometryType()===H.TYPENAME_MULTILINESTRING?this._factory.createMultiLineString(i.toArray([])):n.getGeometryType()===H.TYPENAME_MULTIPOLYGON?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))}editPolygon(t,e){let n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon()),n.isEmpty())return n;const i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this._factory.createPolygon();const r=new P;for(let t=0;t<n.getNumInteriorRing();t++){const i=this.edit(n.getInteriorRingN(t),e);null===i||i.isEmpty()||r.add(i)}return this._factory.createPolygon(i,r.toArray([]))}}function he(){}ce.GeometryEditorOperation=he,ce.NoOpGeometryOperation=class{edit(t,e){return t}get interfaces_(){return[he]}},ce.CoordinateOperation=class{edit(t,e){const n=this.edit(t.getCoordinates(),t);return t instanceof pt?null===n?e.createLinearRing():e.createLinearRing(n):t instanceof $?null===n?e.createLineString():e.createLineString(n):t instanceof et?null===n||0===n.length?e.createPoint():e.createPoint(n[0]):t}get interfaces_(){return[he]}},ce.CoordinateSequenceOperation=class{edit(t,e){return t instanceof pt?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof $?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof et?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t}get interfaces_(){return[he]}};class pe{constructor(){pe.constructor_.apply(this,arguments)}static constructor_(){this._geometryType=null,this._comps=null;const t=arguments[0],e=arguments[1];this._geometryType=t,this._comps=e}static isOfType(t,e){return t.getGeometryType()===e||e===H.TYPENAME_LINESTRING&&t.getGeometryType()===H.TYPENAME_LINEARRING}static extract(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return pe.extract(t,e,new P)}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];return t.getGeometryType()===e?n.add(t):t instanceof ct&&t.apply(new pe(e,n)),n}}filter(t){(null===this._geometryType||pe.isOfType(t,this._geometryType))&&this._comps.add(t)}get interfaces_(){return[Q]}}class fe{static map(){if(arguments[0]instanceof H&&C(arguments[1],de)){const t=arguments[0],e=arguments[1],n=new P;for(let i=0;i<t.getNumGeometries();i++){const r=e.map(t.getGeometryN(i));null!==r&&n.add(r)}return t.getFactory().buildGeometry(n)}if(C(arguments[0],w)&&C(arguments[1],de)){const t=arguments[0],e=arguments[1],n=new P;for(let i=t.iterator();i.hasNext();){const t=i.next(),r=e.map(t);null!==r&&n.add(r)}return n}}}function de(){}fe.MapOp=de;class ge{constructor(){ge.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1}transformPoint(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))}transformPolygon(t,e){let n=!0;const i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof pt&&!i.isEmpty()||(n=!1);const r=new P;for(let e=0;e<t.getNumInteriorRing();e++){const i=this.transformLinearRing(t.getInteriorRingN(e),t);null===i||i.isEmpty()||(i instanceof pt||(n=!1),r.add(i))}if(n)return this._factory.createPolygon(i,r.toArray([]));{const t=new P;return null!==i&&t.add(i),t.addAll(r),this._factory.buildGeometry(t)}}createCoordinateSequence(t){return this._factory.getCoordinateSequenceFactory().create(t)}getInputGeometry(){return this._inputGeom}transformMultiLineString(t,e){const n=new P;for(let e=0;e<t.getNumGeometries();e++){const i=this.transformLineString(t.getGeometryN(e),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)}transformCoordinates(t,e){return this.copy(t)}transformLineString(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))}transformMultiPoint(t,e){const n=new P;for(let e=0;e<t.getNumGeometries();e++){const i=this.transformPoint(t.getGeometryN(e),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)}transformMultiPolygon(t,e){const n=new P;for(let e=0;e<t.getNumGeometries();e++){const i=this.transformPolygon(t.getGeometryN(e),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)}copy(t){return t.copy()}transformGeometryCollection(t,e){const n=new P;for(let e=0;e<t.getNumGeometries();e++){const i=this.transform(t.getGeometryN(e));null!==i&&(this._pruneEmptyGeometry&&i.isEmpty()||n.add(i))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Pt.toGeometryArray(n)):this._factory.buildGeometry(n)}transform(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof et)return this.transformPoint(t,null);if(t instanceof ht)return this.transformMultiPoint(t,null);if(t instanceof pt)return this.transformLinearRing(t,null);if(t instanceof $)return this.transformLineString(t,null);if(t instanceof It)return this.transformMultiLineString(t,null);if(t instanceof ot)return this.transformPolygon(t,null);if(t instanceof _t)return this.transformMultiPolygon(t,null);if(t instanceof ct)return this.transformGeometryCollection(t,null);throw new i("Unknown Geometry subtype: "+t.getGeometryType())}transformLinearRing(t,e){const n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);const i=n.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)}}class ye{constructor(){ye.constructor_.apply(this,arguments)}static constructor_(){this._comps=null;const t=arguments[0];this._comps=t}static getGeometry(t){return t.getFactory().buildGeometry(ye.getLines(t))}static getLines(){if(1===arguments.length){const t=arguments[0];return ye.getLines(t,new P)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return t instanceof $?e.add(t):t instanceof ct&&t.apply(new ye(e)),e}}filter(t){t instanceof $&&this._comps.add(t)}get interfaces_(){return[Q]}}class me{constructor(){me.constructor_.apply(this,arguments)}static constructor_(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){const t=arguments[0];this._lines=t}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._lines=t,this._isForcedToLineString=e}}static getGeometry(){if(1===arguments.length){const t=arguments[0];return t.getFactory().buildGeometry(me.getLines(t))}if(2===arguments.length){const t=arguments[0],e=arguments[1];return t.getFactory().buildGeometry(me.getLines(t,e))}}static getLines(){if(1===arguments.length){const t=arguments[0];return me.getLines(t,!1)}if(2===arguments.length){if(C(arguments[0],w)&&C(arguments[1],w)){const t=arguments[1];for(let e=arguments[0].iterator();e.hasNext();){const n=e.next();me.getLines(n,t)}return t}if(arguments[0]instanceof H&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1],n=new P;return t.apply(new me(n,e)),n}if(arguments[0]instanceof H&&C(arguments[1],w)){const t=arguments[0],e=arguments[1];return t instanceof $?e.add(t):t.apply(new me(e)),e}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&C(arguments[0],w)&&C(arguments[1],w)){const t=arguments[1],e=arguments[2];for(let n=arguments[0].iterator();n.hasNext();){const i=n.next();me.getLines(i,t,e)}return t}if("boolean"==typeof arguments[2]&&arguments[0]instanceof H&&C(arguments[1],w)){const t=arguments[1],e=arguments[2];return arguments[0].apply(new me(t,e)),t}}}filter(t){if(this._isForcedToLineString&&t instanceof pt){const e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof $&&this._lines.add(t)}setForceToLineString(t){this._isForcedToLineString=t}get interfaces_(){return[V]}}const _e={reverseOrder:function(){return{compare:(t,e)=>e.compareTo(t)}},min:function(t){return _e.sort(t),t.get(0)},sort:function(t,e){const n=t.toArray();e?it.sort(n,e):it.sort(n);const i=t.iterator();for(let t=0,e=n.length;t<e;t++)i.next(),i.set(n[t])},singletonList:function(t){const e=new P;return e.add(t),e}};class ve{constructor(){ve.constructor_.apply(this,arguments)}static constructor_(){this._pts=null;const t=arguments[0];this._pts=t}static getPoints(){if(1===arguments.length){const t=arguments[0];return t instanceof et?_e.singletonList(t):ve.getPoints(t,new P)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return t instanceof et?e.add(t):t instanceof ct&&t.apply(new ve(e)),e}}filter(t){t instanceof et&&this._pts.add(t)}get interfaces_(){return[Q]}}class xe{constructor(){xe.constructor_.apply(this,arguments)}static constructor_(){this._comps=null;const t=arguments[0];this._comps=t}static getPolygons(){if(1===arguments.length){const t=arguments[0];return xe.getPolygons(t,new P)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return t instanceof ot?e.add(t):t instanceof ct&&t.apply(new xe(e)),e}}filter(t){t instanceof ot&&this._comps.add(t)}get interfaces_(){return[Q]}}class Ce{constructor(){Ce.constructor_.apply(this,arguments)}static constructor_(){this._isDone=!1}applyTo(t){for(let e=0;e<t.getNumGeometries()&&!this._isDone;e++){const n=t.getGeometryN(e);if(n instanceof ct)this.applyTo(n);else if(this.visit(n),this.isDone())return this._isDone=!0,null}}}class we{constructor(){we.constructor_.apply(this,arguments)}static constructor_(){if(this._geomFact=null,this._precModel=null,this._dim=new be,this._nPts=100,this._rotationAngle=0,0===arguments.length)we.constructor_.call(this,new Pt);else if(1===arguments.length){const t=arguments[0];this._geomFact=t,this._precModel=t.getPrecisionModel()}}createSupercircle(t){const e=1/t,n=this._dim.getMinSize()/2,i=this._dim.getCentre(),r=Math.pow(n,t),o=n,s=Math.pow(r/2,e),a=Math.trunc(this._nPts/8),l=new Array(8*a+1).fill(null),u=s/a;for(let n=0;n<=a;n++){let s=0,c=o;if(0!==n){s=u*n;const i=Math.pow(s,t);c=Math.pow(r-i,e)}l[n]=this.coordTrans(s,c,i),l[2*a-n]=this.coordTrans(c,s,i),l[2*a+n]=this.coordTrans(c,-s,i),l[4*a-n]=this.coordTrans(s,-c,i),l[4*a+n]=this.coordTrans(-s,-c,i),l[6*a-n]=this.coordTrans(-c,-s,i),l[6*a+n]=this.coordTrans(-c,s,i),l[8*a-n]=this.coordTrans(-s,c,i)}l[l.length-1]=new y(l[0]);const c=this._geomFact.createLinearRing(l),h=this._geomFact.createPolygon(c);return this.rotate(h)}setNumPoints(t){this._nPts=t}setBase(t){this._dim.setBase(t)}setRotation(t){this._rotationAngle=t}setWidth(t){this._dim.setWidth(t)}createEllipse(){const t=this._dim.getEnvelope(),e=t.getWidth()/2,n=t.getHeight()/2,i=t.getMinX()+e,r=t.getMinY()+n,o=new Array(this._nPts+1).fill(null);let s=0;for(let t=0;t<this._nPts;t++){const a=t*(2*Math.PI/this._nPts),l=e*Math.cos(a)+i,u=n*Math.sin(a)+r;o[s++]=this.coord(l,u)}o[s]=new y(o[0]);const a=this._geomFact.createLinearRing(o),l=this._geomFact.createPolygon(a);return this.rotate(l)}coordTrans(t,e,n){return this.coord(t+n.x,e+n.y)}createSquircle(){return this.createSupercircle(4)}setEnvelope(t){this._dim.setEnvelope(t)}setCentre(t){this._dim.setCentre(t)}createArc(t,e){const n=this._dim.getEnvelope(),i=n.getWidth()/2,r=n.getHeight()/2,o=n.getMinX()+i,s=n.getMinY()+r;let a=e;(a<=0||a>2*Math.PI)&&(a=2*Math.PI);const l=a/(this._nPts-1),u=new Array(this._nPts).fill(null);let c=0;for(let e=0;e<this._nPts;e++){const n=t+e*l,a=i*Math.cos(n)+o,h=r*Math.sin(n)+s;u[c++]=this.coord(a,h)}const h=this._geomFact.createLineString(u);return this.rotate(h)}rotate(t){if(0!==this._rotationAngle){const e=ie.rotationInstance(this._rotationAngle,this._dim.getCentre().x,this._dim.getCentre().y);t.apply(e)}return t}coord(t,e){const n=new y(t,e);return this._precModel.makePrecise(n),n}createArcPolygon(t,e){const n=this._dim.getEnvelope(),i=n.getWidth()/2,r=n.getHeight()/2,o=n.getMinX()+i,s=n.getMinY()+r;let a=e;(a<=0||a>2*Math.PI)&&(a=2*Math.PI);const l=a/(this._nPts-1),u=new Array(this._nPts+2).fill(null);let c=0;u[c++]=this.coord(o,s);for(let e=0;e<this._nPts;e++){const n=t+l*e,a=i*Math.cos(n)+o,h=r*Math.sin(n)+s;u[c++]=this.coord(a,h)}u[c++]=this.coord(o,s);const h=this._geomFact.createLinearRing(u),p=this._geomFact.createPolygon(h);return this.rotate(p)}createRectangle(){let t=null,e=0,n=Math.trunc(this._nPts/4);n<1&&(n=1);const i=this._dim.getEnvelope().getWidth()/n,r=this._dim.getEnvelope().getHeight()/n,o=new Array(4*n+1).fill(null),s=this._dim.getEnvelope();for(t=0;t<n;t++){const n=s.getMinX()+t*i,r=s.getMinY();o[e++]=this.coord(n,r)}for(t=0;t<n;t++){const n=s.getMaxX(),i=s.getMinY()+t*r;o[e++]=this.coord(n,i)}for(t=0;t<n;t++){const n=s.getMaxX()-t*i,r=s.getMaxY();o[e++]=this.coord(n,r)}for(t=0;t<n;t++){const n=s.getMinX(),i=s.getMaxY()-t*r;o[e++]=this.coord(n,i)}o[e++]=new y(o[0]);const a=this._geomFact.createLinearRing(o),l=this._geomFact.createPolygon(a);return this.rotate(l)}createCircle(){return this.createEllipse()}setHeight(t){this._dim.setHeight(t)}setSize(t){this._dim.setSize(t)}}class be{constructor(){be.constructor_.apply(this,arguments)}static constructor_(){this.base=null,this.centre=null,this.width=null,this.height=null}setBase(t){this.base=t}setWidth(t){this.width=t}getBase(){return this.base}getWidth(){return this.width}setEnvelope(t){this.width=t.getWidth(),this.height=t.getHeight(),this.base=new y(t.getMinX(),t.getMinY()),this.centre=new y(t.centre())}setCentre(t){this.centre=t}getMinSize(){return Math.min(this.width,this.height)}getEnvelope(){return null!==this.base?new L(this.base.x,this.base.x+this.width,this.base.y,this.base.y+this.height):null!==this.centre?new L(this.centre.x-this.width/2,this.centre.x+this.width/2,this.centre.y-this.height/2,this.centre.y+this.height/2):new L(0,this.width,0,this.height)}getCentre(){return null===this.centre&&(this.centre=new y(this.base.x+this.width/2,this.base.y+this.height/2)),this.centre}getHeight(){return this.height}setHeight(t){this.height=t}setSize(t){this.height=t,this.width=t}}we.Dimensions=be;class Ee extends we{constructor(){super(),Ee.constructor_.apply(this,arguments)}static constructor_(){if(this._numArms=8,this._armLengthRatio=.5,0===arguments.length)we.constructor_.call(this);else if(1===arguments.length){const t=arguments[0];we.constructor_.call(this,t)}}static create(t,e,n,i,r){const o=new Ee;return o.setCentre(t),o.setSize(e),o.setNumPoints(n),o.setArmLengthRatio(r),o.setNumArms(i),o.createSineStar()}setNumArms(t){this._numArms=t}setArmLengthRatio(t){this._armLengthRatio=t}createSineStar(){const t=this._dim.getEnvelope(),e=t.getWidth()/2;let n=this._armLengthRatio;n<0&&(n=0),n>1&&(n=1);const i=n*e,r=(1-n)*e,o=t.getMinX()+e,s=t.getMinY()+e,a=new Array(this._nPts+1).fill(null);let l=0;for(let t=0;t<this._nPts;t++){const e=t/this._nPts*this._numArms,n=e-Math.floor(e),u=2*Math.PI*n,c=r+i*((Math.cos(u)+1)/2),h=t*(2*Math.PI/this._nPts),p=c*Math.cos(h)+o,f=c*Math.sin(h)+s;a[l++]=this.coord(p,f)}a[l]=new y(a[0]);const u=this._geomFact.createLinearRing(a);return this._geomFact.createPolygon(u)}}var Ie=Object.freeze({__proto__:null,AffineTransformation:ie,AffineTransformationBuilder:oe,AffineTransformationFactory:se,ComponentCoordinateExtracter:ae,GeometryCollectionMapper:le,GeometryCombiner:ue,GeometryEditor:ce,GeometryExtracter:pe,GeometryMapper:fe,GeometryTransformer:ge,LineStringExtracter:ye,LinearComponentExtracter:me,PointExtracter:ve,PolygonExtracter:xe,ShortCircuitedGeometryVisitor:Ce,SineStarFactory:Ee}),Pe=Object.freeze({__proto__:null,Coordinate:y,CoordinateXY:_,CoordinateXYM:v,CoordinateXYZM:x,CoordinateList:S,CoordinateSequenceFilter:T,Envelope:L,LineSegment:Kt,GeometryFactory:Pt,Geometry:H,Point:et,LineString:$,LinearRing:pt,Polygon:ot,GeometryCollection:ct,MultiPoint:ht,MultiLineString:It,MultiPolygon:_t,Dimension:J,IntersectionMatrix:Jt,PrecisionModel:bt,Location:Zt,Triangle:ee,util:Ie});class Ne{constructor(){Ne.constructor_.apply(this,arguments)}static constructor_(){this._pt=[new y,new y],this._distance=o.NaN,this._isNull=!0}getCoordinates(){return this._pt}getCoordinate(t){return this._pt[t]}setMinimum(){if(1===arguments.length){const t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this._isNull)return this.initialize(t,e),null;const n=t.distance(e);n<this._distance&&this.initialize(t,e,n)}}initialize(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=n,this._isNull=!1}}toString(){return Yt.toLineString(this._pt[0],this._pt[1])}getDistance(){return this._distance}setMaximum(){if(1===arguments.length){const t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this._isNull)return this.initialize(t,e),null;const n=t.distance(e);n>this._distance&&this.initialize(t,e,n)}}}class Se{static computeDistance(){if(arguments[2]instanceof Ne&&arguments[0]instanceof $&&arguments[1]instanceof y){const t=arguments[0],e=arguments[1],n=arguments[2],i=new Kt,r=t.getCoordinates();for(let t=0;t<r.length-1;t++){i.setCoordinates(r[t],r[t+1]);const o=i.closestPoint(e);n.setMinimum(o,e)}}else if(arguments[2]instanceof Ne&&arguments[0]instanceof ot&&arguments[1]instanceof y){const t=arguments[0],e=arguments[1],n=arguments[2];Se.computeDistance(t.getExteriorRing(),e,n);for(let i=0;i<t.getNumInteriorRing();i++)Se.computeDistance(t.getInteriorRingN(i),e,n)}else if(arguments[2]instanceof Ne&&arguments[0]instanceof H&&arguments[1]instanceof y){const t=arguments[0],e=arguments[1],n=arguments[2];if(t instanceof $)Se.computeDistance(t,e,n);else if(t instanceof ot)Se.computeDistance(t,e,n);else if(t instanceof ct){const i=t;for(let t=0;t<i.getNumGeometries();t++){const r=i.getGeometryN(t);Se.computeDistance(r,e,n)}}else n.setMinimum(t.getCoordinate(),e)}else if(arguments[2]instanceof Ne&&arguments[0]instanceof Kt&&arguments[1]instanceof y){const t=arguments[1],e=arguments[2],n=arguments[0].closestPoint(t);e.setMinimum(n,t)}}}class Te{constructor(){Te.constructor_.apply(this,arguments)}static constructor_(){this._g0=null,this._g1=null,this._ptDist=new Ne,this._densifyFrac=0;const t=arguments[0],e=arguments[1];this._g0=t,this._g1=e}static distance(){if(2===arguments.length)return new Te(arguments[0],arguments[1]).distance();if(3===arguments.length){const t=arguments[2],e=new Te(arguments[0],arguments[1]);return e.setDensifyFraction(t),e.distance()}}getCoordinates(){return this._ptDist.getCoordinates()}setDensifyFraction(t){if(t>1||t<=0)throw new i("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t}compute(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)}distance(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()}computeOrientedDistance(t,e,n){const i=new Le(e);if(t.apply(i),n.setMaximum(i.getMaxPointDistance()),this._densifyFrac>0){const i=new Me(e,this._densifyFrac);t.apply(i),n.setMaximum(i.getMaxPointDistance())}}orientedDistance(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()}}class Le{constructor(){Le.constructor_.apply(this,arguments)}static constructor_(){this._maxPtDist=new Ne,this._minPtDist=new Ne,this._euclideanDist=new Se,this._geom=null;const t=arguments[0];this._geom=t}filter(t){this._minPtDist.initialize(),Se.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}getMaxPointDistance(){return this._maxPtDist}get interfaces_(){return[Y]}}class Me{constructor(){Me.constructor_.apply(this,arguments)}static constructor_(){this._maxPtDist=new Ne,this._minPtDist=new Ne,this._geom=null,this._numSubSegs=0;const t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))}filter(t,e){if(0===e)return null;const n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=(i.x-n.x)/this._numSubSegs,o=(i.y-n.y)/this._numSubSegs;for(let t=0;t<this._numSubSegs;t++){const e=n.x+t*r,i=n.y+t*o,s=new y(e,i);this._minPtDist.initialize(),Se.computeDistance(this._geom,s,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}}isDone(){return!1}isGeometryChanged(){return!1}getMaxPointDistance(){return this._maxPtDist}get interfaces_(){return[T]}}Te.MaxPointDistanceFilter=Le,Te.MaxDensifiedByFractionDistanceFilter=Me;var Oe=Object.freeze({__proto__:null,DiscreteHausdorffDistance:Te,DistanceToPoint:Se,PointPairDistance:Ne});class Re{visitItem(t){}}class Ae{locate(t){}}class De{constructor(){De.constructor_.apply(this,arguments)}static constructor_(){this._min=o.POSITIVE_INFINITY,this._max=o.NEGATIVE_INFINITY}getMin(){return this._min}intersects(t,e){return!(this._min>e||this._max<t)}getMax(){return this._max}toString(){return Yt.toLineString(new y(this._min,0),new y(this._max,0))}}De.NodeComparator=class{compare(t,e){const n=t,i=e,r=(n._min+n._max)/2,o=(i._min+i._max)/2;return r<o?-1:r>o?1:0}get interfaces_(){return[l]}};class Fe extends De{constructor(){super(),Fe.constructor_.apply(this,arguments)}static constructor_(){this._item=null;const t=arguments[0],e=arguments[1],n=arguments[2];this._min=t,this._max=e,this._item=n}query(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)}}class ke extends De{constructor(){super(),ke.constructor_.apply(this,arguments)}static constructor_(){this._node1=null,this._node2=null;const t=arguments[0],e=arguments[1];this._node1=t,this._node2=e,this.buildExtent(this._node1,this._node2)}buildExtent(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)}query(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)}}class Be{constructor(){Be.constructor_.apply(this,arguments)}static constructor_(){this._leaves=new P,this._root=null,this._level=0}buildTree(){_e.sort(this._leaves,new De.NodeComparator);let t=this._leaves,e=null,n=new P;for(;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}}insert(t,e,n){if(null!==this._root)throw new A("Index cannot be added to once it has been queried");this._leaves.add(new Fe(t,e,n))}query(t,e,n){if(this.init(),null===this._root)return null;this._root.query(t,e,n)}buildRoot(){if(null!==this._root)return null;this._root=this.buildTree()}printNode(t){j.out.println(Yt.toLineString(new y(t._min,this._level),new y(t._max,this._level)))}init(){return null!==this._root||0===this._leaves.size()?null:void this.buildRoot()}buildLevel(t,e){this._level++,e.clear();for(let n=0;n<t.size();n+=2){const i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{const i=new ke(t.get(n),t.get(n+1));e.add(i)}}}}class Ge{constructor(){Ge.constructor_.apply(this,arguments)}static constructor_(){this._items=new P}visitItem(t){this._items.add(t)}getItems(){return this._items}get interfaces_(){return[Re]}}class je{constructor(){je.constructor_.apply(this,arguments)}static constructor_(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;const t=arguments[0];this._p=t}static locatePointInRing(){if(arguments[0]instanceof y&&C(arguments[1],k)){const t=arguments[1],e=new je(arguments[0]),n=new y,i=new y;for(let r=1;r<t.size();r++)if(t.getCoordinate(r,n),t.getCoordinate(r-1,i),e.countSegment(n,i),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof y&&arguments[1]instanceof Array){const t=arguments[1],e=new je(arguments[0]);for(let n=1;n<t.length;n++){const i=t[n],r=t[n-1];if(e.countSegment(i,r),e.isOnSegment())return e.getLocation()}return e.getLocation()}}countSegment(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){let n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){let n=B.index(t,e,this._p);if(n===B.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(n=-n),n===B.LEFT&&this._crossingCount++}}isPointInPolygon(){return this.getLocation()!==Zt.EXTERIOR}getLocation(){return this._isPointOnSegment?Zt.BOUNDARY:this._crossingCount%2==1?Zt.INTERIOR:Zt.EXTERIOR}isOnSegment(){return this._isPointOnSegment}}class ze{constructor(){ze.constructor_.apply(this,arguments)}static constructor_(){this._geom=null,this._index=null;const t=arguments[0];if(!(C(t,rt)||t instanceof pt))throw new i("Argument must be Polygonal or LinearRing");this._geom=t}locate(t){null===this._index&&(this._index=new qe(this._geom),this._geom=null);const e=new je(t),n=new Ue(e);return this._index.query(t.y,t.y,n),e.getLocation()}get interfaces_(){return[Ae]}}class Ue{constructor(){Ue.constructor_.apply(this,arguments)}static constructor_(){this._counter=null;const t=arguments[0];this._counter=t}visitItem(t){const e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))}get interfaces_(){return[Re]}}class qe{constructor(){qe.constructor_.apply(this,arguments)}static constructor_(){this._isEmpty=!1,this._index=new Be;const t=arguments[0];t.isEmpty()?this._isEmpty=!0:this.init(t)}init(t){for(let e=me.getLines(t).iterator();e.hasNext();){const t=e.next().getCoordinates();this.addLine(t)}}addLine(t){for(let e=1;e<t.length;e++){const n=new Kt(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}}query(){if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this._isEmpty)return new P;const n=new Ge;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(this._isEmpty)return null;this._index.query(t,e,n)}}}ze.SegmentVisitor=Ue,ze.IntervalIndexedGeometry=qe;class Ve{static isOnLine(){if(arguments[0]instanceof y&&C(arguments[1],k)){const t=arguments[0],e=arguments[1],n=new Wt,i=new y,r=new y,o=e.size();for(let s=1;s<o;s++)if(e.getCoordinate(s-1,i),e.getCoordinate(s,r),n.computeIntersection(t,i,r),n.hasIntersection())return!0;return!1}if(arguments[0]instanceof y&&arguments[1]instanceof Array){const t=arguments[0],e=arguments[1],n=new Wt;for(let i=1;i<e.length;i++){const r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1}}static locateInRing(t,e){return je.locatePointInRing(t,e)}static isInRing(t,e){return Ve.locateInRing(t,e)!==Zt.EXTERIOR}}class He{hasNext(){}next(){}remove(){}}class Ye{constructor(){Ye.constructor_.apply(this,arguments)}static constructor_(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;const t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()}static isAtomic(t){return!(t instanceof ct)}next(){if(this._atStart)return this._atStart=!1,Ye.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new I;const t=this._parent.getGeometryN(this._index++);return t instanceof ct?(this._subcollectionIterator=new Ye(t),this._subcollectionIterator.next()):t}remove(){throw new Z(this.getClass().getName())}hasNext(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}get interfaces_(){return[He]}}class Xe{constructor(){Xe.constructor_.apply(this,arguments)}static constructor_(){this._geom=null;const t=arguments[0];this._geom=t}static locatePointInPolygon(t,e){if(e.isEmpty())return Zt.EXTERIOR;const n=e.getExteriorRing(),i=Xe.locatePointInRing(t,n);if(i!==Zt.INTERIOR)return i;for(let n=0;n<e.getNumInteriorRing();n++){const i=e.getInteriorRingN(n),r=Xe.locatePointInRing(t,i);if(r===Zt.BOUNDARY)return Zt.BOUNDARY;if(r===Zt.INTERIOR)return Zt.EXTERIOR}return Zt.INTERIOR}static locatePointInRing(t,e){return e.getEnvelopeInternal().intersects(t)?Ve.locateInRing(t,e.getCoordinates()):Zt.EXTERIOR}static containsPointInPolygon(t,e){return Zt.EXTERIOR!==Xe.locatePointInPolygon(t,e)}static locateInGeometry(t,e){if(e instanceof ot)return Xe.locatePointInPolygon(t,e);if(e instanceof ct){const n=new Ye(e);for(;n.hasNext();){const i=n.next();if(i!==e){const e=Xe.locateInGeometry(t,i);if(e!==Zt.EXTERIOR)return e}}}return Zt.EXTERIOR}static isContained(t,e){return Zt.EXTERIOR!==Xe.locate(t,e)}static locate(t,e){return e.isEmpty()?Zt.EXTERIOR:e.getEnvelopeInternal().intersects(t)?Xe.locateInGeometry(t,e):Zt.EXTERIOR}locate(t){return Xe.locate(t,this._geom)}get interfaces_(){return[Ae]}}var We=Object.freeze({__proto__:null,IndexedPointInAreaLocator:ze,PointOnGeometryLocator:Ae,SimplePointInAreaLocator:Xe});class Ke{measure(t,e){}}class Ze{static diagonalSize(t){if(t.isNull())return 0;const e=t.getWidth(),n=t.getHeight();return Math.sqrt(e*e+n*n)}measure(t,e){const n=Te.distance(t,e,Ze.DENSIFY_FRACTION),i=new L(t.getEnvelopeInternal());return i.expandToInclude(e.getEnvelopeInternal()),1-n/Ze.diagonalSize(i)}get interfaces_(){return[Ke]}}Ze.DENSIFY_FRACTION=.25;var Je=Object.freeze({__proto__:null,AreaSimilarityMeasure:class{measure(t,e){return t.intersection(e).getArea()/t.union(e).getArea()}get interfaces_(){return[Ke]}},HausdorffSimilarityMeasure:Ze,SimilarityMeasure:Ke,SimilarityMeasureCombiner:class{static combine(t,e){return Math.min(t,e)}}});class Qe{constructor(){Qe.constructor_.apply(this,arguments)}static constructor_(){this._areaBasePt=null,this._triangleCent3=new y,this._areasum2=0,this._cg3=new y,this._lineCentSum=new y,this._totalLength=0,this._ptCount=0,this._ptCentSum=new y;const t=arguments[0];this._areaBasePt=null,this.add(t)}static area2(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)}static centroid3(t,e,n,i){return i.x=t.x+e.x+n.x,i.y=t.y+e.y+n.y,null}static getCentroid(t){return new Qe(t).getCentroid()}setAreaBasePoint(t){this._areaBasePt=t}addPoint(t){this._ptCount+=1,this._ptCentSum.x+=t.x,this._ptCentSum.y+=t.y}addLineSegments(t){let e=0;for(let n=0;n<t.length-1;n++){const i=t[n].distance(t[n+1]);if(0===i)continue;e+=i;const r=(t[n].x+t[n+1].x)/2;this._lineCentSum.x+=i*r;const o=(t[n].y+t[n+1].y)/2;this._lineCentSum.y+=i*o}this._totalLength+=e,0===e&&t.length>0&&this.addPoint(t[0])}addHole(t){const e=B.isCCW(t);for(let n=0;n<t.length-1;n++)this.addTriangle(this._areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)}getCentroid(){const t=new y;if(Math.abs(this._areasum2)>0)t.x=this._cg3.x/3/this._areasum2,t.y=this._cg3.y/3/this._areasum2;else if(this._totalLength>0)t.x=this._lineCentSum.x/this._totalLength,t.y=this._lineCentSum.y/this._totalLength;else{if(!(this._ptCount>0))return null;t.x=this._ptCentSum.x/this._ptCount,t.y=this._ptCentSum.y/this._ptCount}return t}addShell(t){t.length>0&&this.setAreaBasePoint(t[0]);const e=!B.isCCW(t);for(let n=0;n<t.length-1;n++)this.addTriangle(this._areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)}addTriangle(t,e,n,i){const r=i?1:-1;Qe.centroid3(t,e,n,this._triangleCent3);const o=Qe.area2(t,e,n);this._cg3.x+=r*o*this._triangleCent3.x,this._cg3.y+=r*o*this._triangleCent3.y,this._areasum2+=r*o}add(){if(arguments[0]instanceof ot){const t=arguments[0];this.addShell(t.getExteriorRing().getCoordinates());for(let e=0;e<t.getNumInteriorRing();e++)this.addHole(t.getInteriorRingN(e).getCoordinates())}else if(arguments[0]instanceof H){const t=arguments[0];if(t.isEmpty())return null;if(t instanceof et)this.addPoint(t.getCoordinate());else if(t instanceof $)this.addLineSegments(t.getCoordinates());else if(t instanceof ot){const e=t;this.add(e)}else if(t instanceof ct){const e=t;for(let t=0;t<e.getNumGeometries();t++)this.add(e.getGeometryN(t))}}}}class $e extends n{constructor(t){super(t),this.name=Object.keys({EmptyStackException:$e})[0]}}class tn extends E{constructor(){super(),this.array=[]}add(t){return this.array.push(t),!0}get(t){if(t<0||t>=this.size())throw new b;return this.array[t]}push(t){return this.array.push(t),t}pop(){if(0===this.array.length)throw new $e;return this.array.pop()}peek(){if(0===this.array.length)throw new $e;return this.array[this.array.length-1]}empty(){return 0===this.array.length}isEmpty(){return this.empty()}search(t){return this.array.indexOf(t)}size(){return this.array.length}toArray(){return this.array.slice()}}class en{constructor(){en.constructor_.apply(this,arguments)}static constructor_(){this._coordSet=new xt,this._list=new P}static filterCoordinates(t){const e=new en;for(let n=0;n<t.length;n++)e.filter(t[n]);return e.getCoordinates()}filter(t){this._coordSet.add(t)&&this._list.add(t)}getCoordinates(){const t=new Array(this._list.size()).fill(null);return this._list.toArray(t)}get interfaces_(){return[Y]}}class nn{constructor(){nn.constructor_.apply(this,arguments)}static constructor_(){if(this._geomFactory=null,this._inputPts=null,1===arguments.length){const t=arguments[0];nn.constructor_.call(this,nn.extractCoordinates(t),t.getFactory())}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._inputPts=en.filterCoordinates(t),this._geomFactory=e}}static extractCoordinates(t){const e=new en;return t.apply(e),e.getCoordinates()}preSort(t){let e=null;for(let n=1;n<t.length;n++)(t[n].y<t[0].y||t[n].y===t[0].y&&t[n].x<t[0].x)&&(e=t[0],t[0]=t[n],t[n]=e);return it.sort(t,1,t.length,new rn(t[0])),t}computeOctRing(t){const e=this.computeOctPts(t),n=new S;return n.add(e,!1),n.size()<3?null:(n.closeRing(),n.toCoordinateArray())}lineOrPolygon(t){if(3===(t=this.cleanRing(t)).length)return this._geomFactory.createLineString([t[0],t[1]]);const e=this._geomFactory.createLinearRing(t);return this._geomFactory.createPolygon(e)}cleanRing(t){p.equals(t[0],t[t.length-1]);const e=new P;let n=null;for(let i=0;i<=t.length-2;i++){const r=t[i],o=t[i+1];r.equals(o)||null!==n&&this.isBetween(n,r,o)||(e.add(r),n=r)}e.add(t[t.length-1]);const i=new Array(e.size()).fill(null);return e.toArray(i)}isBetween(t,e,n){if(0!==B.index(t,e,n))return!1;if(t.x!==n.x){if(t.x<=e.x&&e.x<=n.x)return!0;if(n.x<=e.x&&e.x<=t.x)return!0}if(t.y!==n.y){if(t.y<=e.y&&e.y<=n.y)return!0;if(n.y<=e.y&&e.y<=t.y)return!0}return!1}reduce(t){const e=this.computeOctRing(t);if(null===e)return t;const n=new lt;for(let t=0;t<e.length;t++)n.add(e[t]);for(let i=0;i<t.length;i++)Ve.isInRing(t[i],e)||n.add(t[i]);const i=dt.toCoordinateArray(n);return i.length<3?this.padArray3(i):i}getConvexHull(){if(0===this._inputPts.length)return this._geomFactory.createGeometryCollection();if(1===this._inputPts.length)return this._geomFactory.createPoint(this._inputPts[0]);if(2===this._inputPts.length)return this._geomFactory.createLineString(this._inputPts);let t=this._inputPts;this._inputPts.length>50&&(t=this.reduce(this._inputPts));const e=this.preSort(t),n=this.grahamScan(e),i=this.toCoordinateArray(n);return this.lineOrPolygon(i)}padArray3(t){const e=new Array(3).fill(null);for(let n=0;n<e.length;n++)n<t.length?e[n]=t[n]:e[n]=t[0];return e}computeOctPts(t){const e=new Array(8).fill(null);for(let n=0;n<e.length;n++)e[n]=t[0];for(let n=1;n<t.length;n++)t[n].x<e[0].x&&(e[0]=t[n]),t[n].x-t[n].y<e[1].x-e[1].y&&(e[1]=t[n]),t[n].y>e[2].y&&(e[2]=t[n]),t[n].x+t[n].y>e[3].x+e[3].y&&(e[3]=t[n]),t[n].x>e[4].x&&(e[4]=t[n]),t[n].x-t[n].y>e[5].x-e[5].y&&(e[5]=t[n]),t[n].y<e[6].y&&(e[6]=t[n]),t[n].x+t[n].y<e[7].x+e[7].y&&(e[7]=t[n]);return e}toCoordinateArray(t){const e=new Array(t.size()).fill(null);for(let n=0;n<t.size();n++){const i=t.get(n);e[n]=i}return e}grahamScan(t){let e=null;const n=new tn;n.push(t[0]),n.push(t[1]),n.push(t[2]);for(let i=3;i<t.length;i++){for(e=n.pop();!n.empty()&&B.index(n.peek(),e,t[i])>0;)e=n.pop();n.push(e),n.push(t[i])}return n.push(t[0]),n}}class rn{constructor(){rn.constructor_.apply(this,arguments)}static constructor_(){this._origin=null;const t=arguments[0];this._origin=t}static polarCompare(t,e,n){const i=e.x-t.x,r=e.y-t.y,o=n.x-t.x,s=n.y-t.y,a=B.index(t,e,n);if(a===B.COUNTERCLOCKWISE)return 1;if(a===B.CLOCKWISE)return-1;const l=i*i+r*r,u=o*o+s*s;return l<u?-1:l>u?1:0}compare(t,e){const n=t,i=e;return rn.polarCompare(this._origin,n,i)}get interfaces_(){return[l]}}nn.RadialComparator=rn;class on{constructor(){on.constructor_.apply(this,arguments)}static constructor_(){this._interiorPoint=null,this._maxWidth=-1;const t=arguments[0];this.process(t)}static getInteriorPoint(t){return new on(t).getInteriorPoint()}static avg(t,e){return(t+e)/2}getInteriorPoint(){return this._interiorPoint}process(t){if(t.isEmpty())return null;if(t instanceof ot)this.processPolygon(t);else if(t instanceof ct){const e=t;for(let t=0;t<e.getNumGeometries();t++)this.process(e.getGeometryN(t))}}processPolygon(t){const e=new sn(t);e.process();const n=e.getWidth();n>this._maxWidth&&(this._maxWidth=n,this._interiorPoint=e.getInteriorPoint())}}class sn{constructor(){sn.constructor_.apply(this,arguments)}static constructor_(){this._polygon=null,this._interiorPointY=null,this._interiorSectionWidth=0,this._interiorPoint=null;const t=arguments[0];this._polygon=t,this._interiorPointY=ln.getScanLineY(t)}static isEdgeCrossingCounted(t,e,n){const i=t.getY(),r=e.getY();return!(i===r||i===n&&r<n||r===n&&i<n)}static intersectsHorizontalLine(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return!(e<t.getMinY()||e>t.getMaxY())}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];return!(t.getY()>n&&e.getY()>n||t.getY()<n&&e.getY()<n)}}static intersection(t,e,n){const i=t.getX(),r=e.getX();if(i===r)return i;const o=r-i,s=(e.getY()-t.getY())/o;return i+(n-t.getY())/s}findBestMidpoint(t){if(0===t.size())return null;p.isTrue(0==t.size()%2,"Interior Point robustness failure: odd number of scanline crossings"),t.sort(new an);for(let e=0;e<t.size();e+=2){const n=t.get(e),i=t.get(e+1),r=i-n;if(r>this._interiorSectionWidth){this._interiorSectionWidth=r;const t=on.avg(n,i);this._interiorPoint=new y(t,this._interiorPointY)}}}process(){if(this._polygon.isEmpty())return null;this._interiorPoint=new y(this._polygon.getCoordinate());const t=new P;this.scanRing(this._polygon.getExteriorRing(),t);for(let e=0;e<this._polygon.getNumInteriorRing();e++)this.scanRing(this._polygon.getInteriorRingN(e),t);this.findBestMidpoint(t)}scanRing(t,e){if(!sn.intersectsHorizontalLine(t.getEnvelopeInternal(),this._interiorPointY))return null;const n=t.getCoordinateSequence();for(let t=1;t<n.size();t++){const i=n.getCoordinate(t-1),r=n.getCoordinate(t);this.addEdgeCrossing(i,r,this._interiorPointY,e)}}getWidth(){return this._interiorSectionWidth}getInteriorPoint(){return this._interiorPoint}addEdgeCrossing(t,e,n,i){if(!sn.intersectsHorizontalLine(t,e,n))return null;if(!sn.isEdgeCrossingCounted(t,e,n))return null;const r=sn.intersection(t,e,n);i.add(r)}}class an{compare(t,e){return t<e?-1:t>e?1:0}get interfaces_(){return[l]}}sn.DoubleComparator=an;class ln{constructor(){ln.constructor_.apply(this,arguments)}static constructor_(){this._poly=null,this._centreY=null,this._hiY=o.MAX_VALUE,this._loY=-o.MAX_VALUE;const t=arguments[0];this._poly=t,this._hiY=t.getEnvelopeInternal().getMaxY(),this._loY=t.getEnvelopeInternal().getMinY(),this._centreY=on.avg(this._loY,this._hiY)}static getScanLineY(t){return new ln(t).getScanLineY()}updateInterval(t){t<=this._centreY?t>this._loY&&(this._loY=t):t>this._centreY&&t<this._hiY&&(this._hiY=t)}getScanLineY(){this.process(this._poly.getExteriorRing());for(let t=0;t<this._poly.getNumInteriorRing();t++)this.process(this._poly.getInteriorRingN(t));return on.avg(this._hiY,this._loY)}process(t){const e=t.getCoordinateSequence();for(let t=0;t<e.size();t++){const n=e.getY(t);this.updateInterval(n)}}}on.InteriorPointPolygon=sn,on.ScanLineYOrdinateFinder=ln;class un{constructor(){un.constructor_.apply(this,arguments)}static constructor_(){this._centroid=null,this._minDistance=o.MAX_VALUE,this._interiorPoint=null;const t=arguments[0];t.isEmpty()?this._centroid=null:(this._centroid=Qe.getCentroid(t),t.getPrecisionModel().makePrecise(this._centroid)),this.addInterior(t),null===this._interiorPoint&&this.addEndpoints(t)}static getInteriorPoint(t){return new un(t).getInteriorPoint()}addEndpoints(){if(arguments[0]instanceof H){const t=arguments[0];if(t instanceof $)this.addEndpoints(t.getCoordinates());else if(t instanceof ct){const e=t;for(let t=0;t<e.getNumGeometries();t++)this.addEndpoints(e.getGeometryN(t))}}else if(arguments[0]instanceof Array){const t=arguments[0];this.add(t[0]),this.add(t[t.length-1])}}getInteriorPoint(){return this._interiorPoint}addInterior(){if(arguments[0]instanceof H){const t=arguments[0];if(t instanceof $)this.addInterior(t.getCoordinates());else if(t instanceof ct){const e=t;for(let t=0;t<e.getNumGeometries();t++)this.addInterior(e.getGeometryN(t))}}else if(arguments[0]instanceof Array){const t=arguments[0];for(let e=1;e<t.length-1;e++)this.add(t[e])}}add(t){const e=t.distance(this._centroid);e<this._minDistance&&(this._interiorPoint=new y(t),this._minDistance=e)}}class cn{constructor(){cn.constructor_.apply(this,arguments)}static constructor_(){this._centroid=null,this._minDistance=o.MAX_VALUE,this._interiorPoint=null;const t=arguments[0];this._centroid=Qe.getCentroid(t),this.add(t)}static getInteriorPoint(t){return new cn(t).getInteriorPoint()}getInteriorPoint(){return this._interiorPoint}add(){if(arguments[0]instanceof H){const t=arguments[0];if(t instanceof et)this.add(t.getCoordinate());else if(t instanceof ct){const e=t;for(let t=0;t<e.getNumGeometries();t++)this.add(e.getGeometryN(t))}}else if(arguments[0]instanceof y){const t=arguments[0],e=t.distance(this._centroid);e<this._minDistance&&(this._interiorPoint=new y(t),this._minDistance=e)}}}class hn{isInBoundary(t){}}class pn{isInBoundary(t){return t%2==1}get interfaces_(){return[hn]}}class fn{isInBoundary(t){return t>0}get interfaces_(){return[hn]}}class dn{isInBoundary(t){return t>1}get interfaces_(){return[hn]}}class gn{isInBoundary(t){return 1===t}get interfaces_(){return[hn]}}hn.Mod2BoundaryNodeRule=pn,hn.EndPointBoundaryNodeRule=fn,hn.MultiValentEndPointBoundaryNodeRule=dn,hn.MonoValentEndPointBoundaryNodeRule=gn,hn.MOD2_BOUNDARY_RULE=new pn,hn.ENDPOINT_BOUNDARY_RULE=new fn,hn.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new dn,hn.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new gn,hn.OGC_SFS_BOUNDARY_RULE=hn.MOD2_BOUNDARY_RULE;class yn{constructor(){yn.constructor_.apply(this,arguments)}static constructor_(){if(this._boundaryRule=hn.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){const t=arguments[0];if(null===t)throw new i("Rule must be non-null");this._boundaryRule=t}}locateInPolygonRing(t,e){return e.getEnvelopeInternal().intersects(t)?Ve.locateInRing(t,e.getCoordinates()):Zt.EXTERIOR}intersects(t,e){return this.locate(t,e)!==Zt.EXTERIOR}updateLocationInfo(t){t===Zt.INTERIOR&&(this._isIn=!0),t===Zt.BOUNDARY&&this._numBoundaries++}computeLocation(t,e){if(e instanceof et&&this.updateLocationInfo(this.locateOnPoint(t,e)),e instanceof $)this.updateLocationInfo(this.locateOnLineString(t,e));else if(e instanceof ot)this.updateLocationInfo(this.locateInPolygon(t,e));else if(e instanceof It){const n=e;for(let e=0;e<n.getNumGeometries();e++){const i=n.getGeometryN(e);this.updateLocationInfo(this.locateOnLineString(t,i))}}else if(e instanceof _t){const n=e;for(let e=0;e<n.getNumGeometries();e++){const i=n.getGeometryN(e);this.updateLocationInfo(this.locateInPolygon(t,i))}}else if(e instanceof ct){const n=new Ye(e);for(;n.hasNext();){const i=n.next();i!==e&&this.computeLocation(t,i)}}}locateOnPoint(t,e){return e.getCoordinate().equals2D(t)?Zt.INTERIOR:Zt.EXTERIOR}locateOnLineString(t,e){if(!e.getEnvelopeInternal().intersects(t))return Zt.EXTERIOR;const n=e.getCoordinateSequence();return e.isClosed()||!t.equals(n.getCoordinate(0))&&!t.equals(n.getCoordinate(n.size()-1))?Ve.isOnLine(t,n)?Zt.INTERIOR:Zt.EXTERIOR:Zt.BOUNDARY}locateInPolygon(t,e){if(e.isEmpty())return Zt.EXTERIOR;const n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===Zt.EXTERIOR)return Zt.EXTERIOR;if(i===Zt.BOUNDARY)return Zt.BOUNDARY;for(let n=0;n<e.getNumInteriorRing();n++){const i=e.getInteriorRingN(n),r=this.locateInPolygonRing(t,i);if(r===Zt.INTERIOR)return Zt.EXTERIOR;if(r===Zt.BOUNDARY)return Zt.BOUNDARY}return Zt.INTERIOR}locate(t,e){return e.isEmpty()?Zt.EXTERIOR:e instanceof $?this.locateOnLineString(t,e):e instanceof ot?this.locateInPolygon(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?Zt.BOUNDARY:this._numBoundaries>0||this._isIn?Zt.INTERIOR:Zt.EXTERIOR)}}class mn{constructor(){mn.constructor_.apply(this,arguments)}static constructor_(){this._input=null,this._extremalPts=null,this._centre=null,this._radius=0;const t=arguments[0];this._input=t}static farthestPoints(t){const e=t[0].distance(t[1]),n=t[1].distance(t[2]),i=t[2].distance(t[0]);return e>=n&&e>=i?[t[0],t[1]]:n>=e&&n>=i?[t[1],t[2]]:[t[2],t[0]]}static pointWitMinAngleWithX(t,e){let n=o.MAX_VALUE,i=null;for(let r=0;r<t.length;r++){const o=t[r];if(o===e)continue;const s=o.x-e.x;let a=o.y-e.y;a<0&&(a=-a);const l=a/Math.sqrt(s*s+a*a);l<n&&(n=l,i=o)}return i}static lowestPoint(t){let e=t[0];for(let n=1;n<t.length;n++)t[n].y<e.y&&(e=t[n]);return e}static pointWithMinAngleWithSegment(t,e,n){let i=o.MAX_VALUE,r=null;for(let o=0;o<t.length;o++){const s=t[o];if(s===e)continue;if(s===n)continue;const a=Qt.angleBetween(e,s,n);a<i&&(i=a,r=s)}return r}getRadius(){return this.compute(),this._radius}getDiameter(){switch(this.compute(),this._extremalPts.length){case 0:return this._input.getFactory().createLineString();case 1:return this._input.getFactory().createPoint(this._centre)}const t=this._extremalPts[0],e=this._extremalPts[1];return this._input.getFactory().createLineString([t,e])}getExtremalPoints(){return this.compute(),this._extremalPts}computeCirclePoints(){if(this._input.isEmpty())return this._extremalPts=new Array(0).fill(null),null;if(1===this._input.getNumPoints()){const t=this._input.getCoordinates();return this._extremalPts=[new y(t[0])],null}const t=this._input.convexHull().getCoordinates();let e=t;if(t[0].equals2D(t[t.length-1])&&(e=new Array(t.length-1).fill(null),dt.copyDeep(t,0,e,0,t.length-1)),e.length<=2)return this._extremalPts=dt.copyDeep(e),null;let n=mn.lowestPoint(e),i=mn.pointWitMinAngleWithX(e,n);for(let t=0;t<e.length;t++){const t=mn.pointWithMinAngleWithSegment(e,n,i);if(Qt.isObtuse(n,t,i))return this._extremalPts=[new y(n),new y(i)],null;if(Qt.isObtuse(t,n,i))n=t;else{if(!Qt.isObtuse(t,i,n))return this._extremalPts=[new y(n),new y(i),new y(t)],null;i=t}}p.shouldNeverReachHere("Logic failure in Minimum Bounding Circle algorithm!")}compute(){if(null!==this._extremalPts)return null;this.computeCirclePoints(),this.computeCentre(),null!==this._centre&&(this._radius=this._centre.distance(this._extremalPts[0]))}getCircle(){if(this.compute(),null===this._centre)return this._input.getFactory().createPolygon();const t=this._input.getFactory().createPoint(this._centre);return 0===this._radius?t:t.buffer(this._radius)}getCentre(){return this.compute(),this._centre}getMaximumDiameter(){switch(this.compute(),this._extremalPts.length){case 0:return this._input.getFactory().createLineString();case 1:return this._input.getFactory().createPoint(this._centre);case 2:return this._input.getFactory().createLineString([this._extremalPts[0],this._extremalPts[1]]);default:const t=mn.farthestPoints(this._extremalPts);return this._input.getFactory().createLineString(t)}}computeCentre(){switch(this._extremalPts.length){case 0:this._centre=null;break;case 1:this._centre=this._extremalPts[0];break;case 2:this._centre=new y((this._extremalPts[0].x+this._extremalPts[1].x)/2,(this._extremalPts[0].y+this._extremalPts[1].y)/2);break;case 3:this._centre=ee.circumcentre(this._extremalPts[0],this._extremalPts[1],this._extremalPts[2])}}}class _n{constructor(){_n.constructor_.apply(this,arguments)}static constructor_(){if(this._inputGeom=null,this._isConvex=null,this._convexHullPts=null,this._minBaseSeg=new Kt,this._minWidthPt=null,this._minPtIndex=null,this._minWidth=0,1===arguments.length){const t=arguments[0];_n.constructor_.call(this,t,!1)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._inputGeom=t,this._isConvex=e}}static nextIndex(t,e){return++e>=t.length&&(e=0),e}static computeC(t,e,n){return t*n.y-e*n.x}static getMinimumDiameter(t){return new _n(t).getDiameter()}static getMinimumRectangle(t){return new _n(t).getMinimumRectangle()}static computeSegmentForLine(t,e,n){let i=null,r=null;return Math.abs(e)>Math.abs(t)?(i=new y(0,n/e),r=new y(1,n/e-t/e)):(i=new y(n/t,0),r=new y(n/t-e/t,1)),new Kt(i,r)}getWidthCoordinate(){return this.computeMinimumDiameter(),this._minWidthPt}getSupportingSegment(){return this.computeMinimumDiameter(),this._inputGeom.getFactory().createLineString([this._minBaseSeg.p0,this._minBaseSeg.p1])}getDiameter(){if(this.computeMinimumDiameter(),null===this._minWidthPt)return this._inputGeom.getFactory().createLineString();const t=this._minBaseSeg.project(this._minWidthPt);return this._inputGeom.getFactory().createLineString([t,this._minWidthPt])}computeWidthConvex(t){this._convexHullPts=t instanceof ot?t.getExteriorRing().getCoordinates():t.getCoordinates(),0===this._convexHullPts.length?(this._minWidth=0,this._minWidthPt=null,this._minBaseSeg=null):1===this._convexHullPts.length?(this._minWidth=0,this._minWidthPt=this._convexHullPts[0],this._minBaseSeg.p0=this._convexHullPts[0],this._minBaseSeg.p1=this._convexHullPts[0]):2===this._convexHullPts.length||3===this._convexHullPts.length?(this._minWidth=0,this._minWidthPt=this._convexHullPts[0],this._minBaseSeg.p0=this._convexHullPts[0],this._minBaseSeg.p1=this._convexHullPts[1]):this.computeConvexRingMinDiameter(this._convexHullPts)}computeConvexRingMinDiameter(t){this._minWidth=o.MAX_VALUE;let e=1;const n=new Kt;for(let i=0;i<t.length-1;i++)n.p0=t[i],n.p1=t[i+1],e=this.findMaxPerpDistance(t,n,e)}computeMinimumDiameter(){if(null!==this._minWidthPt)return null;if(this._isConvex)this.computeWidthConvex(this._inputGeom);else{const t=new nn(this._inputGeom).getConvexHull();this.computeWidthConvex(t)}}getLength(){return this.computeMinimumDiameter(),this._minWidth}findMaxPerpDistance(t,e,n){let i=e.distancePerpendicular(t[n]),r=i,o=n,s=o;for(;r>=i;)i=r,o=s,s=_n.nextIndex(t,o),r=e.distancePerpendicular(t[s]);return i<this._minWidth&&(this._minPtIndex=o,this._minWidth=i,this._minWidthPt=t[this._minPtIndex],this._minBaseSeg=new Kt(e)),o}getMinimumRectangle(){if(this.computeMinimumDiameter(),0===this._minWidth)return this._minBaseSeg.p0.equals2D(this._minBaseSeg.p1)?this._inputGeom.getFactory().createPoint(this._minBaseSeg.p0):this._minBaseSeg.toGeometry(this._inputGeom.getFactory());const t=this._minBaseSeg.p1.x-this._minBaseSeg.p0.x,e=this._minBaseSeg.p1.y-this._minBaseSeg.p0.y;let n=o.MAX_VALUE,i=-o.MAX_VALUE,r=o.MAX_VALUE,s=-o.MAX_VALUE;for(let o=0;o<this._convexHullPts.length;o++){const a=_n.computeC(t,e,this._convexHullPts[o]);a>i&&(i=a),a<n&&(n=a);const l=_n.computeC(-e,t,this._convexHullPts[o]);l>s&&(s=l),l<r&&(r=l)}const a=_n.computeSegmentForLine(-t,-e,s),l=_n.computeSegmentForLine(-t,-e,r),u=_n.computeSegmentForLine(-e,t,i),c=_n.computeSegmentForLine(-e,t,n),h=u.lineIntersection(a),p=c.lineIntersection(a),f=c.lineIntersection(l),d=u.lineIntersection(l),g=this._inputGeom.getFactory().createLinearRing([h,p,f,d,h]);return this._inputGeom.getFactory().createPolygon(g)}}var vn=Object.freeze({__proto__:null,distance:Oe,locate:We,match:Je,Angle:Qt,Area:nt,Centroid:Qe,ConvexHull:nn,Distance:U,InteriorPointArea:on,InteriorPointLine:un,InteriorPointPoint:cn,Length:X,Orientation:B,PointLocation:Ve,PointLocator:yn,RobustLineIntersector:Wt,MinimumBoundingCircle:mn,MinimumDiameter:_n});class xn{constructor(){xn.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distanceTolerance=null;const t=arguments[0];this._inputGeom=t}static densifyPoints(t,e,n){const i=new Kt,r=new S;for(let o=0;o<t.length-1;o++){i.p0=t[o],i.p1=t[o+1],r.add(i.p0,!1);const s=i.getLength(),a=Math.trunc(s/e)+1;if(a>1){const t=s/a;for(let e=1;e<a;e++){const o=e*t/s,a=i.pointAlong(o);n.makePrecise(a),r.add(a,!1)}}}return r.add(t[t.length-1],!1),r.toCoordinateArray()}static densify(t,e){const n=new xn(t);return n.setDistanceTolerance(e),n.getResultGeometry()}getResultGeometry(){return new Cn(this._distanceTolerance).transform(this._inputGeom)}setDistanceTolerance(t){if(t<=0)throw new i("Tolerance must be positive");this._distanceTolerance=t}}class Cn extends ge{constructor(){super(),Cn.constructor_.apply(this,arguments)}static constructor_(){this.distanceTolerance=null;const t=arguments[0];this.distanceTolerance=t}transformMultiPolygon(t,e){const n=super.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)}transformPolygon(t,e){const n=super.transformPolygon.call(this,t,e);return e instanceof _t?n:this.createValidArea(n)}transformCoordinates(t,e){const n=t.toCoordinateArray();let i=xn.densifyPoints(n,this.distanceTolerance,e.getPrecisionModel());return e instanceof $&&1===i.length&&(i=new Array(0).fill(null)),this._factory.getCoordinateSequenceFactory().create(i)}createValidArea(t){return t.buffer(0)}}xn.DensifyTransformer=Cn;var wn=Object.freeze({__proto__:null,Densifier:xn});class bn{static isNorthern(t){return t===bn.NE||t===bn.NW}static isOpposite(t,e){return t!==e&&2==(t-e+4)%4}static commonHalfPlane(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;const n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n}static isInHalfPlane(t,e){return e===bn.SE?t===bn.SE||t===bn.SW:t===e||t===e+1}static quadrant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new i("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?bn.NE:bn.SE:e>=0?bn.NW:bn.SW}if(arguments[0]instanceof y&&arguments[1]instanceof y){const t=arguments[0],e=arguments[1];if(e.x===t.x&&e.y===t.y)throw new i("Cannot compute the quadrant for two identical points "+t);return e.x>=t.x?e.y>=t.y?bn.NE:bn.SE:e.y>=t.y?bn.NW:bn.SW}}}bn.NE=0,bn.NW=1,bn.SW=2,bn.SE=3;class En{constructor(){En.constructor_.apply(this,arguments)}static constructor_(){this._orig=null,this._sym=null,this._next=null;const t=arguments[0];this._orig=t}static create(t,e){const n=new En(t),i=new En(e);return n.link(i),n}find(t){let e=this;do{if(null===e)return null;if(e.dest().equals2D(t))return e;e=e.oNext()}while(e!==this);return null}dest(){return this._sym._orig}isEdgesSorted(){const t=this.findLowest();let e=t;do{const n=e.oNext();if(n===t)break;if(!(n.compareTo(e)>0))return!1;e=n}while(e!==t);return!0}oNext(){return this._sym._next}directionY(){return this.directionPt().getY()-this._orig.getY()}insert(t){if(this.oNext()===this)return this.insertAfter(t),null;this.insertionEdge(t).insertAfter(t)}insertAfter(t){p.equals(this._orig,t.orig());const e=this.oNext();this._sym.setNext(t),t.sym().setNext(e)}degree(){let t=0,e=this;do{t++,e=e.oNext()}while(e!==this);return t}equals(){if(2===arguments.length&&arguments[1]instanceof y&&arguments[0]instanceof y){const t=arguments[0],e=arguments[1];return this._orig.equals2D(t)&&this._sym._orig.equals(e)}}findLowest(){let t=this,e=this.oNext();do{e.compareTo(t)<0&&(t=e),e=e.oNext()}while(e!==this);return t}directionPt(){return this.dest()}sym(){return this._sym}prev(){return this._sym.next()._sym}compareAngularDirection(t){const e=this.directionX(),n=this.directionY(),i=t.directionX(),r=t.directionY();if(e===i&&n===r)return 0;const o=bn.quadrant(e,n),s=bn.quadrant(i,r);if(o>s)return 1;if(o<s)return-1;const a=this.directionPt(),l=t.directionPt();return B.index(t._orig,l,a)}prevNode(){let t=this;for(;2===t.degree();)if(t=t.prev(),t===this)return null;return t}directionX(){return this.directionPt().getX()-this._orig.getX()}insertionEdge(t){let e=this;do{const n=e.oNext();if(n.compareTo(e)>0&&t.compareTo(e)>=0&&t.compareTo(n)<=0)return e;if(n.compareTo(e)<=0&&(t.compareTo(n)<=0||t.compareTo(e)>=0))return e;e=n}while(e!==this);return p.shouldNeverReachHere(),null}compareTo(t){const e=t;return this.compareAngularDirection(e)}toStringNode(){const t=this.orig();this.dest();const e=new gt;e.append("Node( "+Yt.format(t)+" )\n");let n=this;do{e.append("  -> "+n),e.append("\n"),n=n.oNext()}while(n!==this);return e.toString()}link(t){this.setSym(t),t.setSym(this),this.setNext(t),t.setNext(this)}next(){return this._next}setSym(t){this._sym=t}orig(){return this._orig}toString(){return"HE("+this._orig.x+" "+this._orig.y+", "+this._sym._orig.x+" "+this._sym._orig.y+")"}toStringNodeEdge(){return"  -> ("+Yt.format(this.dest())}setNext(t){this._next=t}}class In extends En{constructor(){super(),In.constructor_.apply(this,arguments)}static constructor_(){this._isMarked=!1;const t=arguments[0];En.constructor_.call(this,t)}static setMarkBoth(t,e){t.setMark(e),t.sym().setMark(e)}static isMarked(t){return t.isMarked()}static setMark(t,e){t.setMark(e)}static markBoth(t){t.mark(),t.sym().mark()}static mark(t){t.mark()}mark(){this._isMarked=!0}setMark(t){this._isMarked=t}isMarked(){return this._isMarked}}class Pn{constructor(){Pn.constructor_.apply(this,arguments)}static constructor_(){this._vertexMap=new wt}static isValidEdge(t,e){return 0!==e.compareTo(t)}insert(t,e,n){const i=this.create(t,e);null!==n?n.insert(i):this._vertexMap.put(t,i);const r=this._vertexMap.get(e);return null!==r?r.insert(i.sym()):this._vertexMap.put(e,i.sym()),i}create(t,e){const n=this.createEdge(t),i=this.createEdge(e);return n.link(i),n}createEdge(t){return new En(t)}addEdge(t,e){if(!Pn.isValidEdge(t,e))return null;const n=this._vertexMap.get(t);let i=null;return null!==n&&(i=n.find(e)),null!==i?i:this.insert(t,e,n)}getVertexEdges(){return this._vertexMap.values()}findEdge(t,e){const n=this._vertexMap.get(t);return null===n?null:n.find(e)}}class Nn extends In{constructor(){super(),Nn.constructor_.apply(this,arguments)}static constructor_(){this._isStart=!1;const t=arguments[0];In.constructor_.call(this,t)}setStart(){this._isStart=!0}isStart(){return this._isStart}}class Sn extends Pn{constructor(){super()}createEdge(t){return new Nn(t)}}class Tn{constructor(){Tn.constructor_.apply(this,arguments)}static constructor_(){this._result=null,this._factory=null,this._graph=null,this._lines=new P,this._nodeEdgeStack=new tn,this._ringStartEdge=null,this._graph=new Sn}static dissolve(t){const e=new Tn;return e.add(t),e.getResult()}addLine(t){this._lines.add(this._factory.createLineString(t.toCoordinateArray()))}updateRingStartEdge(t){return t.isStart()||(t=t.sym()).isStart()?null===this._ringStartEdge?(this._ringStartEdge=t,null):void(t.orig().compareTo(this._ringStartEdge.orig())<0&&(this._ringStartEdge=t)):null}getResult(){return null===this._result&&this.computeResult(),this._result}process(t){let e=t.prevNode();null===e&&(e=t),this.stackEdges(e),this.buildLines()}buildRing(t){const e=new S;let n=t;for(e.add(n.orig().copy(),!1);2===n.sym().degree();){const i=n.next();if(i===t)break;e.add(i.orig().copy(),!1),n=i}e.add(n.dest().copy(),!1),this.addLine(e)}buildLine(t){const e=new S;let n=t;for(this._ringStartEdge=null,In.markBoth(n),e.add(n.orig().copy(),!1);2===n.sym().degree();){this.updateRingStartEdge(n);const i=n.next();if(i===t)return this.buildRing(this._ringStartEdge),null;e.add(i.orig().copy(),!1),n=i,In.markBoth(n)}e.add(n.dest().clone(),!1),this.stackEdges(n.sym()),this.addLine(e)}stackEdges(t){let e=t;do{In.isMarked(e)||this._nodeEdgeStack.add(e),e=e.oNext()}while(e!==t)}computeResult(){for(let t=this._graph.getVertexEdges().iterator();t.hasNext();){const e=t.next();In.isMarked(e)||this.process(e)}this._result=this._factory.buildGeometry(this._lines)}buildLines(){for(;!this._nodeEdgeStack.empty();){const t=this._nodeEdgeStack.pop();In.isMarked(t)||this.buildLine(t)}}add(){if(arguments[0]instanceof H)arguments[0].apply(new class{get interfaces_(){return[V]}filter(t){t instanceof $&&this.add(t)}});else if(C(arguments[0],w))for(let t=arguments[0].iterator();t.hasNext();){const e=t.next();this.add(e)}else if(arguments[0]instanceof $){const t=arguments[0];null===this._factory&&(this._factory=t.getFactory());const e=t.getCoordinateSequence();let n=!1;for(let t=1;t<e.size();t++){const i=this._graph.addEdge(e.getCoordinate(t-1),e.getCoordinate(t));null!==i&&(n||(i.setStart(),n=!0))}}}}var Ln=Object.freeze({__proto__:null,LineDissolver:Tn});class Mn{static opposite(t){return t===Mn.LEFT?Mn.RIGHT:t===Mn.RIGHT?Mn.LEFT:t}}Mn.ON=0,Mn.LEFT=1,Mn.RIGHT=2;class On{constructor(){On.constructor_.apply(this,arguments)}static constructor_(){this.mce=null,this.chainIndex=null;const t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e}computeIntersections(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)}}class Rn{constructor(){Rn.constructor_.apply(this,arguments)}static constructor_(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){const t=arguments[0],e=arguments[1];this._eventType=Rn.DELETE,this._xValue=t,this._insertEvent=e}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._eventType=Rn.INSERT,this._label=t,this._xValue=e,this._obj=n}}isDelete(){return this._eventType===Rn.DELETE}setDeleteEventIndex(t){this._deleteEventIndex=t}getObject(){return this._obj}compareTo(t){const e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0}getInsertEvent(){return this._insertEvent}isInsert(){return this._eventType===Rn.INSERT}isSameLabel(t){return null!==this._label&&this._label===t._label}getDeleteEventIndex(){return this._deleteEventIndex}get interfaces_(){return[s]}}Rn.INSERT=1,Rn.DELETE=2;class An{constructor(){An.constructor_.apply(this,arguments)}static constructor_(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;const t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n}static isAdjacentSegments(t,e){return 1===Math.abs(t-e)}isTrivialIntersection(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(An.isAdjacentSegments(e,i))return!0;if(t.isClosed()){const n=t.getNumPoints()-1;if(0===e&&i===n||0===i&&e===n)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}setIsDoneIfProperInt(t){this._isDoneWhenProperInt=t}hasProperInteriorIntersection(){return this._hasProperInterior}isBoundaryPointInternal(t,e){for(let n=e.iterator();n.hasNext();){const e=n.next().getCoordinate();if(t.isIntersection(e))return!0}return!1}hasProperIntersection(){return this._hasProper}hasIntersection(){return this._hasIntersection}isDone(){return this._isDone}isBoundaryPoint(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))}setBoundaryNodes(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e}addIntersections(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;const r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))}}class Dn extends class{}{constructor(){super(),Dn.constructor_.apply(this,arguments)}static constructor_(){this.events=new P,this.nOverlaps=null}prepareEvents(){_e.sort(this.events);for(let t=0;t<this.events.size();t++){const e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}}computeIntersections(){if(1===arguments.length){const t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(let e=0;e<this.events.size();e++){const n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof An&&C(arguments[0],E)&&C(arguments[1],E)){const t=arguments[0],e=arguments[1],n=arguments[2];this.addEdges(t,t),this.addEdges(e,e),this.computeIntersections(n)}else if("boolean"==typeof arguments[2]&&C(arguments[0],E)&&arguments[1]instanceof An){const t=arguments[0],e=arguments[1];arguments[2]?this.addEdges(t,null):this.addEdges(t),this.computeIntersections(e)}}addEdge(t,e){const n=t.getMonotoneChainEdge(),i=n.getStartIndexes();for(let t=0;t<i.length-1;t++){const i=new On(n,t),r=new Rn(e,n.getMinX(t),i);this.events.add(r),this.events.add(new Rn(n.getMaxX(t),r))}}processOverlaps(t,e,n,i){const r=n.getObject();for(let o=t;o<e;o++){const t=this.events.get(o);if(t.isInsert()){const e=t.getObject();n.isSameLabel(t)||(r.computeIntersections(e,i),this.nOverlaps++)}}}addEdges(){if(1===arguments.length)for(let t=arguments[0].iterator();t.hasNext();){const e=t.next();this.addEdge(e,e)}else if(2===arguments.length){const t=arguments[1];for(let e=arguments[0].iterator();e.hasNext();){const n=e.next();this.addEdge(n,t)}}}}class Fn{constructor(){Fn.constructor_.apply(this,arguments)}static constructor_(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){const t=arguments[0];this.init(1),this.location[Mn.ON]=t}else if(arguments[0]instanceof Fn){const t=arguments[0];if(this.init(t.location.length),null!==t)for(let e=0;e<this.location.length;e++)this.location[e]=t.location[e]}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.init(3),this.location[Mn.ON]=t,this.location[Mn.LEFT]=e,this.location[Mn.RIGHT]=n}}setAllLocations(t){for(let e=0;e<this.location.length;e++)this.location[e]=t}isNull(){for(let t=0;t<this.location.length;t++)if(this.location[t]!==Zt.NONE)return!1;return!0}setAllLocationsIfNull(t){for(let e=0;e<this.location.length;e++)this.location[e]===Zt.NONE&&(this.location[e]=t)}isLine(){return 1===this.location.length}merge(t){if(t.location.length>this.location.length){const t=new Array(3).fill(null);t[Mn.ON]=this.location[Mn.ON],t[Mn.LEFT]=Zt.NONE,t[Mn.RIGHT]=Zt.NONE,this.location=t}for(let e=0;e<this.location.length;e++)this.location[e]===Zt.NONE&&e<t.location.length&&(this.location[e]=t.location[e])}getLocations(){return this.location}flip(){if(this.location.length<=1)return null;const t=this.location[Mn.LEFT];this.location[Mn.LEFT]=this.location[Mn.RIGHT],this.location[Mn.RIGHT]=t}toString(){const t=new M;return this.location.length>1&&t.append(Zt.toLocationSymbol(this.location[Mn.LEFT])),t.append(Zt.toLocationSymbol(this.location[Mn.ON])),this.location.length>1&&t.append(Zt.toLocationSymbol(this.location[Mn.RIGHT])),t.toString()}setLocations(t,e,n){this.location[Mn.ON]=t,this.location[Mn.LEFT]=e,this.location[Mn.RIGHT]=n}get(t){return t<this.location.length?this.location[t]:Zt.NONE}isArea(){return this.location.length>1}isAnyNull(){for(let t=0;t<this.location.length;t++)if(this.location[t]===Zt.NONE)return!0;return!1}setLocation(){if(1===arguments.length){const t=arguments[0];this.setLocation(Mn.ON,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.location[t]=e}}init(t){this.location=new Array(t).fill(null),this.setAllLocations(Zt.NONE)}isEqualOnSide(t,e){return this.location[e]===t.location[e]}allPositionsEqual(t){for(let e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}}class kn{constructor(){kn.constructor_.apply(this,arguments)}static constructor_(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){const t=arguments[0];this.elt[0]=new Fn(t),this.elt[1]=new Fn(t)}else if(arguments[0]instanceof kn){const t=arguments[0];this.elt[0]=new Fn(t.elt[0]),this.elt[1]=new Fn(t.elt[1])}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.elt[0]=new Fn(Zt.NONE),this.elt[1]=new Fn(Zt.NONE),this.elt[t].setLocation(e)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.elt[0]=new Fn(t,e,n),this.elt[1]=new Fn(t,e,n)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.elt[0]=new Fn(Zt.NONE,Zt.NONE,Zt.NONE),this.elt[1]=new Fn(Zt.NONE,Zt.NONE,Zt.NONE),this.elt[t].setLocations(e,n,i)}}static toLineLabel(t){const e=new kn(Zt.NONE);for(let n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e}getGeometryCount(){let t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}setAllLocations(t,e){this.elt[t].setAllLocations(e)}isNull(t){return this.elt[t].isNull()}setAllLocationsIfNull(){if(1===arguments.length){const t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.elt[t].setAllLocationsIfNull(e)}}isLine(t){return this.elt[t].isLine()}merge(t){for(let e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Fn(t.elt[e]):this.elt[e].merge(t.elt[e])}flip(){this.elt[0].flip(),this.elt[1].flip()}getLocation(){if(1===arguments.length){const t=arguments[0];return this.elt[t].get(Mn.ON)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.elt[t].get(e)}}toString(){const t=new M;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}isArea(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){const t=arguments[0];return this.elt[t].isArea()}}isAnyNull(t){return this.elt[t].isAnyNull()}setLocation(){if(2===arguments.length){const t=arguments[0],e=arguments[1];this.elt[t].setLocation(Mn.ON,e)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this.elt[t].setLocation(e,n)}}isEqualOnSide(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}allPositionsEqual(t,e){return this.elt[t].allPositionsEqual(e)}toLine(t){this.elt[t].isArea()&&(this.elt[t]=new Fn(this.elt[t].location[0]))}}class Bn{constructor(){Bn.constructor_.apply(this,arguments)}static constructor_(){this.coord=null,this.segmentIndex=null,this.dist=null;const t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new y(t),this.segmentIndex=e,this.dist=n}getSegmentIndex(){return this.segmentIndex}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)}compareTo(t){const e=t;return this.compare(e.segmentIndex,e.dist)}isEndPoint(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t}toString(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}getDistance(){return this.dist}compare(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0}get interfaces_(){return[s]}}class Gn extends vt{}function jn(t){return null==t?0:t.color}function zn(t){return null==t?null:t.parent}function Un(t,e){null!==t&&(t.color=e)}function qn(t){return null==t?null:t.left}function Vn(t){return null==t?null:t.right}class Hn extends Gn{constructor(){super(),this.root_=null,this.size_=0}get(t){let e=this.root_;for(;null!==e;){const n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null}put(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:0,getValue(){return this.value},getKey(){return this.key}},this.size_=1,null;let n,i,r=this.root_;do{if(n=r,i=t.compareTo(r.key),i<0)r=r.left;else{if(!(i>0)){const t=r.value;return r.value=e,t}r=r.right}}while(null!==r);const o={key:t,left:null,right:null,value:e,parent:n,color:0,getValue(){return this.value},getKey(){return this.key}};return i<0?n.left=o:n.right=o,this.fixAfterInsertion(o),this.size_++,null}fixAfterInsertion(t){let e;for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)zn(t)===qn(zn(zn(t)))?(e=Vn(zn(zn(t))),1===jn(e)?(Un(zn(t),0),Un(e,0),Un(zn(zn(t)),1),t=zn(zn(t))):(t===Vn(zn(t))&&(t=zn(t),this.rotateLeft(t)),Un(zn(t),0),Un(zn(zn(t)),1),this.rotateRight(zn(zn(t))))):(e=qn(zn(zn(t))),1===jn(e)?(Un(zn(t),0),Un(e,0),Un(zn(zn(t)),1),t=zn(zn(t))):(t===qn(zn(t))&&(t=zn(t),this.rotateRight(t)),Un(zn(t),0),Un(zn(zn(t)),1),this.rotateLeft(zn(zn(t)))));this.root_.color=0}values(){const t=new P;let e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=Hn.successor(e));)t.add(e.value);return t}entrySet(){const t=new xt;let e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=Hn.successor(e));)t.add(e);return t}rotateLeft(t){if(null!=t){const e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}}rotateRight(t){if(null!=t){const e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}}getFirstEntry(){let t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t}static successor(t){let e;if(null===t)return null;if(null!==t.right){for(e=t.right;null!==e.left;)e=e.left;return e}{e=t.parent;let n=t;for(;null!==e&&n===e.right;)n=e,e=e.parent;return e}}size(){return this.size_}containsKey(t){let e=this.root_;for(;null!==e;){const n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return!0;e=e.right}}return!1}}class Yn{constructor(){Yn.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new Hn,this.edge=null;const t=arguments[0];this.edge=t}print(t){t.println("Intersections:");for(let e=this.iterator();e.hasNext();)e.next().print(t)}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints();const e=this.iterator();let n=e.next();for(;e.hasNext();){const i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}}addEndpoints(){const t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)}createSplitEdge(t,e){let n=e.segmentIndex-t.segmentIndex+2;const i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;const o=new Array(n).fill(null);let s=0;o[s++]=new y(t.coord);for(let n=t.segmentIndex+1;n<=e.segmentIndex;n++)o[s++]=this.edge.pts[n];return r&&(o[s]=e.coord),new Qn(o,new kn(this.edge._label))}add(t,e,n){const i=new Bn(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)}isIntersection(t){for(let e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1}}class Xn{constructor(){Xn.constructor_.apply(this,arguments)}static constructor_(){if(this._data=null,this._size=0,0===arguments.length)Xn.constructor_.call(this,10);else if(1===arguments.length){const t=arguments[0];this._data=new Array(t).fill(null)}}size(){return this._size}addAll(t){return null===t||0===t.length?null:(this.ensureCapacity(this._size+t.length),j.arraycopy(t,0,this._data,this._size,t.length),void(this._size+=t.length))}ensureCapacity(t){if(t<=this._data.length)return null;const e=Math.max(t,2*this._data.length);this._data=it.copyOf(this._data,e)}toArray(){const t=new Array(this._size).fill(null);return j.arraycopy(this._data,0,t,0,this._size),t}add(t){this.ensureCapacity(this._size+1),this._data[this._size]=t,++this._size}}class Wn{static toIntArray(t){const e=new Array(t.size()).fill(null);for(let n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e}getChainStartIndices(t){let e=0;const n=new Xn(Math.trunc(t.length/2));n.add(e);do{const i=this.findChainEnd(t,e);n.add(i),e=i}while(e<t.length-1);return n.toArray()}findChainEnd(t,e){const n=bn.quadrant(t[e],t[e+1]);let i=e+1;for(;i<t.length&&bn.quadrant(t[i-1],t[i])===n;)i++;return i-1}OLDgetChainStartIndices(t){let e=0;const n=new P;n.add(e);do{const i=this.findChainEnd(t,e);n.add(i),e=i}while(e<t.length-1);return Wn.toIntArray(n)}}class Kn{constructor(){Kn.constructor_.apply(this,arguments)}static constructor_(){this.e=null,this.pts=null,this.startIndex=null;const t=arguments[0];this.e=t,this.pts=t.getCoordinates();const e=new Wn;this.startIndex=e.getChainStartIndices(this.pts)}getCoordinates(){return this.pts}getMaxX(t){const e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n}getMinX(t){const e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n}computeIntersectsForChain(){if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],o=arguments[5];if(e-t==1&&r-i==1)return o.addIntersections(this.e,t,n.e,i),null;if(!this.overlaps(t,e,n,i,r))return null;const s=Math.trunc((t+e)/2),a=Math.trunc((i+r)/2);t<s&&(i<a&&this.computeIntersectsForChain(t,s,n,i,a,o),a<r&&this.computeIntersectsForChain(t,s,n,a,r,o)),s<e&&(i<a&&this.computeIntersectsForChain(s,e,n,i,a,o),a<r&&this.computeIntersectsForChain(s,e,n,a,r,o))}}overlaps(t,e,n,i,r){return L.intersects(this.pts[t],this.pts[e],n.pts[i],n.pts[r])}getStartIndexes(){return this.startIndex}computeIntersects(t,e){for(let n=0;n<this.startIndex.length-1;n++)for(let i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)}}class Zn{constructor(){Zn.constructor_.apply(this,arguments)}static constructor_(){this._depth=Array(2).fill().map(()=>Array(3));for(let t=0;t<2;t++)for(let e=0;e<3;e++)this._depth[t][e]=Zn.NULL_VALUE}static depthAtLocation(t){return t===Zt.EXTERIOR?0:t===Zt.INTERIOR?1:Zn.NULL_VALUE}getDepth(t,e){return this._depth[t][e]}setDepth(t,e,n){this._depth[t][e]=n}isNull(){if(0===arguments.length){for(let t=0;t<2;t++)for(let e=0;e<3;e++)if(this._depth[t][e]!==Zn.NULL_VALUE)return!1;return!0}if(1===arguments.length){const t=arguments[0];return this._depth[t][1]===Zn.NULL_VALUE}if(2===arguments.length){const t=arguments[0],e=arguments[1];return this._depth[t][e]===Zn.NULL_VALUE}}normalize(){for(let t=0;t<2;t++)if(!this.isNull(t)){let e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(let n=1;n<3;n++){let i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}}getDelta(t){return this._depth[t][Mn.RIGHT]-this._depth[t][Mn.LEFT]}getLocation(t,e){return this._depth[t][e]<=0?Zt.EXTERIOR:Zt.INTERIOR}toString(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}add(){if(1===arguments.length){const t=arguments[0];for(let e=0;e<2;e++)for(let n=1;n<3;n++){const i=t.getLocation(e,n);i!==Zt.EXTERIOR&&i!==Zt.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=Zn.depthAtLocation(i):this._depth[e][n]+=Zn.depthAtLocation(i))}}else if(3===arguments.length){const t=arguments[0],e=arguments[1];arguments[2]===Zt.INTERIOR&&this._depth[t][e]++}}}Zn.NULL_VALUE=-1;class Jn{constructor(){Jn.constructor_.apply(this,arguments)}static constructor_(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this._label=t}}setVisited(t){this._isVisited=t}setInResult(t){this._isInResult=t}isCovered(){return this._isCovered}isCoveredSet(){return this._isCoveredSet}setLabel(t){this._label=t}getLabel(){return this._label}setCovered(t){this._isCovered=t,this._isCoveredSet=!0}updateIM(t){p.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)}isInResult(){return this._isInResult}isVisited(){return this._isVisited}}class Qn extends Jn{constructor(){super(),Qn.constructor_.apply(this,arguments)}static constructor_(){if(this.pts=null,this._env=null,this.eiList=new Yn(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Zn,this._depthDelta=0,1===arguments.length){const t=arguments[0];Qn.constructor_.call(this,t,null)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.pts=t,this._label=e}}static updateIM(){if(!(2===arguments.length&&arguments[1]instanceof Jt&&arguments[0]instanceof kn))return super.updateIM.apply(this,arguments);{const t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,Mn.ON),t.getLocation(1,Mn.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,Mn.LEFT),t.getLocation(1,Mn.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,Mn.RIGHT),t.getLocation(1,Mn.RIGHT),2))}}getDepth(){return this._depth}getCollapsedEdge(){const t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new Qn(t,kn.toLineLabel(this._label))}isIsolated(){return this._isIsolated}getCoordinates(){return this.pts}setIsolated(t){this._isIsolated=t}setName(t){this._name=t}equals(t){if(!(t instanceof Qn))return!1;const e=t;if(this.pts.length!==e.pts.length)return!1;let n=!0,i=!0,r=this.pts.length;for(let t=0;t<this.pts.length;t++)if(this.pts[t].equals2D(e.pts[t])||(n=!1),this.pts[t].equals2D(e.pts[--r])||(i=!1),!n&&!i)return!1;return!0}getCoordinate(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){const t=arguments[0];return this.pts[t]}}print(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(let e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)}computeIM(t){Qn.updateIM(this._label,t)}isCollapsed(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])}isClosed(){return this.pts[0].equals(this.pts[this.pts.length-1])}getMaximumSegmentIndex(){return this.pts.length-1}getDepthDelta(){return this._depthDelta}getNumPoints(){return this.pts.length}printReverse(t){t.print("edge "+this._name+": ");for(let e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")}getMonotoneChainEdge(){return null===this._mce&&(this._mce=new Kn(this)),this._mce}getEnvelope(){if(null===this._env){this._env=new L;for(let t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env}addIntersection(t,e,n,i){const r=new y(t.getIntersection(i));let o=e,s=t.getEdgeDistance(n,i);const a=o+1;if(a<this.pts.length){const t=this.pts[a];r.equals2D(t)&&(o=a,s=0)}this.eiList.add(r,o,s)}toString(){const t=new gt;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(let e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()}isPointwiseEqual(t){if(this.pts.length!==t.pts.length)return!1;for(let e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0}setDepthDelta(t){this._depthDelta=t}getEdgeIntersectionList(){return this.eiList}addIntersections(t,e,n){for(let i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)}}class $n extends Jn{constructor(){super(),$n.constructor_.apply(this,arguments)}static constructor_(){this._coord=null,this._edges=null;const t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new kn(0,Zt.NONE)}isIncidentEdgeInResult(){for(let t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1}isIsolated(){return 1===this._label.getGeometryCount()}getCoordinate(){return this._coord}print(t){t.println("node "+this._coord+" lbl: "+this._label)}computeIM(t){}computeMergedLocation(t,e){let n=Zt.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){const i=t.getLocation(e);n!==Zt.BOUNDARY&&(n=i)}return n}setLabel(){if(2!==arguments.length||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return super.setLabel.apply(this,arguments);{const t=arguments[0],e=arguments[1];null===this._label?this._label=new kn(t,e):this._label.setLocation(t,e)}}getEdges(){return this._edges}mergeLabel(){if(arguments[0]instanceof $n){const t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof kn){const t=arguments[0];for(let e=0;e<2;e++){const n=this.computeMergedLocation(t,e);this._label.getLocation(e)===Zt.NONE&&this._label.setLocation(e,n)}}}add(t){this._edges.insert(t),t.setNode(this)}setLabelBoundary(t){if(null===this._label)return null;let e=Zt.NONE;null!==this._label&&(e=this._label.getLocation(t));let n=null;switch(e){case Zt.BOUNDARY:n=Zt.INTERIOR;break;case Zt.INTERIOR:default:n=Zt.BOUNDARY}this._label.setLocation(t,n)}}class ti{constructor(){ti.constructor_.apply(this,arguments)}static constructor_(){this.nodeMap=new Hn,this.nodeFact=null;const t=arguments[0];this.nodeFact=t}find(t){return this.nodeMap.get(t)}addNode(){if(arguments[0]instanceof y){const t=arguments[0];let e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof $n){const t=arguments[0],e=this.nodeMap.get(t.getCoordinate());return null===e?(this.nodeMap.put(t.getCoordinate(),t),t):(e.mergeLabel(t),e)}}print(t){for(let e=this.iterator();e.hasNext();)e.next().print(t)}iterator(){return this.nodeMap.values().iterator()}values(){return this.nodeMap.values()}getBoundaryNodes(t){const e=new P;for(let n=this.iterator();n.hasNext();){const i=n.next();i.getLabel().getLocation(t)===Zt.BOUNDARY&&e.add(i)}return e}add(t){const e=t.getCoordinate();this.addNode(e).add(t)}}class ei{constructor(){ei.constructor_.apply(this,arguments)}static constructor_(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){const t=arguments[0];this._edge=t}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];ei.constructor_.call(this,t,e,n,null)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];ei.constructor_.call(this,t),this.init(e,n),this._label=i}}compareDirection(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:B.index(t._p0,t._p1,this._p1)}getDy(){return this._dy}getCoordinate(){return this._p0}setNode(t){this._node=t}print(t){const e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}compareTo(t){const e=t;return this.compareDirection(e)}getDirectedCoordinate(){return this._p1}getDx(){return this._dx}getLabel(){return this._label}getEdge(){return this._edge}getQuadrant(){return this._quadrant}getNode(){return this._node}toString(){const t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}computeLabel(t){}init(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=bn.quadrant(this._dx,this._dy),p.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")}get interfaces_(){return[s]}}class ni extends c{constructor(t,e){super(e?t+" [ "+e+" ]":t),this.pt=e?new y(e):void 0,this.name=Object.keys({TopologyException:ni})[0]}getCoordinate(){return this.pt}}class ii extends ei{constructor(){super(),ii.constructor_.apply(this,arguments)}static constructor_(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];const t=arguments[0],e=arguments[1];if(ei.constructor_.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{const e=t.getNumPoints()-1;this.init(t.getCoordinate(e),t.getCoordinate(e-1))}this.computeDirectedLabel()}static depthFactor(t,e){return t===Zt.EXTERIOR&&e===Zt.INTERIOR?1:t===Zt.INTERIOR&&e===Zt.EXTERIOR?-1:0}getNextMin(){return this._nextMin}getDepth(t){return this._depth[t]}setVisited(t){this._isVisited=t}computeDirectedLabel(){this._label=new kn(this._edge.getLabel()),this._isForward||this._label.flip()}getNext(){return this._next}setDepth(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new ni("assigned depths do not match",this.getCoordinate());this._depth[t]=e}isInteriorAreaEdge(){let t=!0;for(let e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Mn.LEFT)===Zt.INTERIOR&&this._label.getLocation(e,Mn.RIGHT)===Zt.INTERIOR||(t=!1);return t}setNextMin(t){this._nextMin=t}print(t){super.print.call(this,t),t.print(" "+this._depth[Mn.LEFT]+"/"+this._depth[Mn.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")}setMinEdgeRing(t){this._minEdgeRing=t}isLineEdge(){const t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,Zt.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,Zt.EXTERIOR);return t&&e&&n}setEdgeRing(t){this._edgeRing=t}getMinEdgeRing(){return this._minEdgeRing}getDepthDelta(){let t=this._edge.getDepthDelta();return this._isForward||(t=-t),t}setInResult(t){this._isInResult=t}getSym(){return this._sym}isForward(){return this._isForward}getEdge(){return this._edge}printEdge(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)}setSym(t){this._sym=t}setVisitedEdge(t){this.setVisited(t),this._sym.setVisited(t)}setEdgeDepths(t,e){let n=this.getEdge().getDepthDelta();this._isForward||(n=-n);let i=1;t===Mn.LEFT&&(i=-1);const r=Mn.opposite(t),o=e+n*i;this.setDepth(t,e),this.setDepth(r,o)}getEdgeRing(){return this._edgeRing}isInResult(){return this._isInResult}setNext(t){this._next=t}isVisited(){return this._isVisited}}class ri{createNode(t){return new $n(t,null)}}class oi{constructor(){oi.constructor_.apply(this,arguments)}static constructor_(){if(this._edges=new P,this._nodes=null,this._edgeEndList=new P,0===arguments.length)this._nodes=new ti(new ri);else if(1===arguments.length){const t=arguments[0];this._nodes=new ti(t)}}static linkResultDirectedEdges(t){for(let e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()}printEdges(t){t.println("Edges:");for(let e=0;e<this._edges.size();e++){t.println("edge "+e+":");const n=this._edges.get(e);n.print(t),n.eiList.print(t)}}find(t){return this._nodes.find(t)}addNode(){if(arguments[0]instanceof $n){const t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof y){const t=arguments[0];return this._nodes.addNode(t)}}getNodeIterator(){return this._nodes.iterator()}linkResultDirectedEdges(){for(let t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()}debugPrintln(t){j.out.println(t)}isBoundaryNode(t,e){const n=this._nodes.find(e);if(null===n)return!1;const i=n.getLabel();return null!==i&&i.getLocation(t)===Zt.BOUNDARY}linkAllDirectedEdges(){for(let t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()}matchInSameDirection(t,e,n,i){return!!t.equals(n)&&B.index(t,e,i)===B.COLLINEAR&&bn.quadrant(t,e)===bn.quadrant(n,i)}getEdgeEnds(){return this._edgeEndList}debugPrint(t){j.out.print(t)}getEdgeIterator(){return this._edges.iterator()}findEdgeInSameDirection(t,e){for(let n=0;n<this._edges.size();n++){const i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null}insertEdge(t){this._edges.add(t)}findEdgeEnd(t){for(let e=this.getEdgeEnds().iterator();e.hasNext();){const n=e.next();if(n.getEdge()===t)return n}return null}addEdges(t){for(let e=t.iterator();e.hasNext();){const t=e.next();this._edges.add(t);const n=new ii(t,!0),i=new ii(t,!1);n.setSym(i),i.setSym(n),this.add(n),this.add(i)}}add(t){this._nodes.add(t),this._edgeEndList.add(t)}getNodes(){return this._nodes.values()}findEdge(t,e){for(let n=0;n<this._edges.size();n++){const i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null}}class si extends oi{constructor(){super(),si.constructor_.apply(this,arguments)}static constructor_(){if(this._parentGeom=null,this._lineEdgeMap=new wt,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new yn,2===arguments.length){const t=arguments[0],e=arguments[1];si.constructor_.call(this,t,e,hn.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._argIndex=t,this._parentGeom=e,this._boundaryNodeRule=n,null!==e&&this.add(e)}}static determineBoundary(t,e){return t.isInBoundary(e)?Zt.BOUNDARY:Zt.INTERIOR}insertBoundaryPoint(t,e){const n=this._nodes.addNode(e).getLabel();let i=1,r=Zt.NONE;r=n.getLocation(t,Mn.ON),r===Zt.BOUNDARY&&i++;const o=si.determineBoundary(this._boundaryNodeRule,i);n.setLocation(t,o)}computeSelfNodes(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){const t=arguments[1],e=arguments[2],n=new An(arguments[0],!0,!1);n.setIsDoneIfProperInt(e);const i=this.createEdgeSetIntersector(),r=this._parentGeom instanceof pt||this._parentGeom instanceof ot||this._parentGeom instanceof _t,o=t||!r;return i.computeIntersections(this._edges,n,o),this.addSelfIntersectionNodes(this._argIndex),n}}computeSplitEdges(t){for(let e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)}computeEdgeIntersections(t,e,n){const i=new An(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i}getGeometry(){return this._parentGeom}getBoundaryNodeRule(){return this._boundaryNodeRule}hasTooFewPoints(){return this._hasTooFewPoints}addPoint(){if(arguments[0]instanceof et){const t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,Zt.INTERIOR)}else if(arguments[0]instanceof y){const t=arguments[0];this.insertPoint(this._argIndex,t,Zt.INTERIOR)}}addPolygon(t){this.addPolygonRing(t.getExteriorRing(),Zt.EXTERIOR,Zt.INTERIOR);for(let e=0;e<t.getNumInteriorRing();e++){const n=t.getInteriorRingN(e);this.addPolygonRing(n,Zt.INTERIOR,Zt.EXTERIOR)}}addEdge(t){this.insertEdge(t);const e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],Zt.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],Zt.BOUNDARY)}addLineString(t){const e=dt.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;const n=new Qn(e,new kn(this._argIndex,Zt.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),p.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])}getInvalidPoint(){return this._invalidPoint}getBoundaryPoints(){const t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null);let n=0;for(let i=t.iterator();i.hasNext();){const t=i.next();e[n++]=t.getCoordinate().copy()}return e}getBoundaryNodes(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes}addSelfIntersectionNode(t,e,n){if(this.isBoundaryNode(t,e))return null;n===Zt.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)}addPolygonRing(t,e,n){if(t.isEmpty())return null;const i=dt.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;let r=e,o=n;B.isCCW(i)&&(r=n,o=e);const s=new Qn(i,new kn(this._argIndex,Zt.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,i[0],Zt.BOUNDARY)}insertPoint(t,e,n){const i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new kn(t,n):r.setLocation(t,n)}createEdgeSetIntersector(){return new Dn}addSelfIntersectionNodes(t){for(let e=this._edges.iterator();e.hasNext();){const n=e.next(),i=n.getLabel().getLocation(t);for(let e=n.eiList.iterator();e.hasNext();){const n=e.next();this.addSelfIntersectionNode(t,n.coord,i)}}}add(){if(!(1===arguments.length&&arguments[0]instanceof H))return super.add.apply(this,arguments);{const t=arguments[0];if(t.isEmpty())return null;if(t instanceof _t&&(this._useBoundaryDeterminationRule=!1),t instanceof ot)this.addPolygon(t);else if(t instanceof $)this.addLineString(t);else if(t instanceof et)this.addPoint(t);else if(t instanceof ht)this.addCollection(t);else if(t instanceof It)this.addCollection(t);else if(t instanceof _t)this.addCollection(t);else{if(!(t instanceof ct))throw new Z(t.getGeometryType());this.addCollection(t)}}}addCollection(t){for(let e=0;e<t.getNumGeometries();e++){const n=t.getGeometryN(e);this.add(n)}}locate(t){return C(this._parentGeom,rt)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new ze(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)}findEdge(){if(1===arguments.length&&arguments[0]instanceof $){const t=arguments[0];return this._lineEdgeMap.get(t)}return super.findEdge.apply(this,arguments)}}var ai=Object.freeze({__proto__:null,GeometryGraph:si});class li{visit(t){}}class ui{constructor(){ui.constructor_.apply(this,arguments)}static constructor_(){if(this._p=null,this._data=null,this._left=null,this._right=null,this._count=null,2===arguments.length){const t=arguments[0],e=arguments[1];this._p=new y(t),this._left=null,this._right=null,this._count=1,this._data=e}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._p=new y(t,e),this._left=null,this._right=null,this._count=1,this._data=n}}isRepeated(){return this._count>1}getRight(){return this._right}getCoordinate(){return this._p}setLeft(t){this._left=t}getX(){return this._p.x}getData(){return this._data}getCount(){return this._count}getLeft(){return this._left}getY(){return this._p.y}increment(){this._count=this._count+1}setRight(t){this._right=t}}class ci{constructor(){ci.constructor_.apply(this,arguments)}static constructor_(){if(this._root=null,this._numberOfNodes=null,this._tolerance=null,0===arguments.length)ci.constructor_.call(this,0);else if(1===arguments.length){const t=arguments[0];this._tolerance=t}}static toCoordinates(){if(1===arguments.length){const t=arguments[0];return ci.toCoordinates(t,!1)}if(2===arguments.length){const t=arguments[0],e=arguments[1],n=new S;for(let i=t.iterator();i.hasNext();){const t=i.next(),r=e?t.getCount():1;for(let e=0;e<r;e++)n.add(t.getCoordinate(),!0)}return n.toCoordinateArray()}}insert(){if(1===arguments.length){const t=arguments[0];return this.insert(t,null)}if(2===arguments.length){const t=arguments[0],e=arguments[1];if(null===this._root)return this._root=new ui(t,e),this._root;if(this._tolerance>0){const e=this.findBestMatchNode(t);if(null!==e)return e.increment(),e}return this.insertExact(t,e)}}query(){if(1===arguments.length){const t=arguments[0],e=new P;return this.query(t,e),e}if(2===arguments.length)if(arguments[0]instanceof L&&C(arguments[1],E)){const t=arguments[0],e=arguments[1];this.queryNode(this._root,t,!0,new class{get interfaces_(){return[li]}visit(t){e.add(t)}})}else if(arguments[0]instanceof L&&C(arguments[1],li)){const t=arguments[0],e=arguments[1];this.queryNode(this._root,t,!0,e)}}queryNode(t,e,n,i){if(null===t)return null;let r=null,o=null,s=null;n?(r=e.getMinX(),o=e.getMaxX(),s=t.getX()):(r=e.getMinY(),o=e.getMaxY(),s=t.getY());const a=s<=o;r<s&&this.queryNode(t.getLeft(),e,!n,i),e.contains(t.getCoordinate())&&i.visit(t),a&&this.queryNode(t.getRight(),e,!n,i)}findBestMatchNode(t){const e=new hi(t,this._tolerance);return this.query(e.queryEnvelope(),e),e.getNode()}isEmpty(){return null===this._root}insertExact(t,e){let n=this._root,i=this._root,r=!0,o=!0;for(;null!==n;){if(null!==n&&t.distance(n.getCoordinate())<=this._tolerance)return n.increment(),n;o=r?t.x<n.getX():t.y<n.getY(),i=n,n=o?n.getLeft():n.getRight(),r=!r}this._numberOfNodes=this._numberOfNodes+1;const s=new ui(t,e);return o?i.setLeft(s):i.setRight(s),s}}class hi{constructor(){hi.constructor_.apply(this,arguments)}static constructor_(){this._tolerance=null,this._matchNode=null,this._matchDist=0,this._p=null;const t=arguments[0],e=arguments[1];this._p=t,this._tolerance=e}visit(t){const e=this._p.distance(t.getCoordinate());if(!(e<=this._tolerance))return null;let n=!1;(null===this._matchNode||e<this._matchDist||null!==this._matchNode&&e===this._matchDist&&t.getCoordinate().compareTo(this._matchNode.getCoordinate())<1)&&(n=!0),n&&(this._matchNode=t,this._matchDist=e)}queryEnvelope(){const t=new L(this._p);return t.expandBy(this._tolerance),t}getNode(){return this._matchNode}get interfaces_(){return[li]}}ci.BestMatchVisitor=hi;var pi=Object.freeze({__proto__:null,KdTree:ci});class fi{constructor(){fi.constructor_.apply(this,arguments)}static constructor_(){this._items=new P,this._subnode=new Array(4).fill(null)}static getSubnodeIndex(t,e,n){let i=-1;return t.getMinX()>=e&&(t.getMinY()>=n&&(i=3),t.getMaxY()<=n&&(i=1)),t.getMaxX()<=e&&(t.getMinY()>=n&&(i=2),t.getMaxY()<=n&&(i=0)),i}hasChildren(){for(let t=0;t<4;t++)if(null!==this._subnode[t])return!0;return!1}isPrunable(){return!(this.hasChildren()||this.hasItems())}addAllItems(t){t.addAll(this._items);for(let e=0;e<4;e++)null!==this._subnode[e]&&this._subnode[e].addAllItems(t);return t}getNodeCount(){let t=0;for(let e=0;e<4;e++)null!==this._subnode[e]&&(t+=this._subnode[e].size());return t+1}size(){let t=0;for(let e=0;e<4;e++)null!==this._subnode[e]&&(t+=this._subnode[e].size());return t+this._items.size()}addAllItemsFromOverlapping(t,e){if(!this.isSearchMatch(t))return null;e.addAll(this._items);for(let n=0;n<4;n++)null!==this._subnode[n]&&this._subnode[n].addAllItemsFromOverlapping(t,e)}visitItems(t,e){for(let t=this._items.iterator();t.hasNext();)e.visitItem(t.next())}hasItems(){return!this._items.isEmpty()}remove(t,e){if(!this.isSearchMatch(t))return!1;let n=!1;for(let i=0;i<4;i++)if(null!==this._subnode[i]&&(n=this._subnode[i].remove(t,e),n)){this._subnode[i].isPrunable()&&(this._subnode[i]=null);break}return n||(n=this._items.remove(e),n)}visit(t,e){if(!this.isSearchMatch(t))return null;this.visitItems(t,e);for(let n=0;n<4;n++)null!==this._subnode[n]&&this._subnode[n].visit(t,e)}getItems(){return this._items}depth(){let t=0;for(let e=0;e<4;e++)if(null!==this._subnode[e]){const n=this._subnode[e].depth();n>t&&(t=n)}return t+1}isEmpty(){let t=!0;if(this._items.isEmpty()){for(let e=0;e<4;e++)if(null!==this._subnode[e]&&!this._subnode[e].isEmpty()){t=!1;break}}else t=!1;return t}add(t){this._items.add(t)}get interfaces_(){return[u]}}function di(){}di.exponent=function(t){return function(t,e){let n,i,r,o;const s={32:{d:127,c:128,b:0,a:0},64:{d:32752,c:0,b:0,a:0}},a={32:8,64:11}[t];if(o||(n=e<0||1/e<0,isFinite(e)||(o=s[t],n&&(o.d+=1<<t/4-1),i=Math.pow(2,a)-1,r=0)),!o){for(i={32:127,64:1023}[t],r=Math.abs(e);r>=2;)i++,r/=2;for(;r<1&&i>0;)i--,r*=2;i<=0&&(r/=2),32===t&&i>254&&(o={d:n?255:127,c:128,b:0,a:0},i=Math.pow(2,a)-1,r=0)}return i}(64,t)-1023},di.powerOf2=function(t){return Math.pow(2,t)};class gi{constructor(){gi.constructor_.apply(this,arguments)}static constructor_(){this._pt=new y,this._level=0,this._env=null;const t=arguments[0];this.computeKey(t)}static computeQuadLevel(t){const e=t.getWidth(),n=t.getHeight(),i=e>n?e:n;return di.exponent(i)+1}getLevel(){return this._level}computeKey(){if(1===arguments.length){const t=arguments[0];for(this._level=gi.computeQuadLevel(t),this._env=new L,this.computeKey(this._level,t);!this._env.contains(t);)this._level+=1,this.computeKey(this._level,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1],n=di.powerOf2(t);this._pt.x=Math.floor(e.getMinX()/n)*n,this._pt.y=Math.floor(e.getMinY()/n)*n,this._env.init(this._pt.x,this._pt.x+n,this._pt.y,this._pt.y+n)}}getEnvelope(){return this._env}getCentre(){return new y((this._env.getMinX()+this._env.getMaxX())/2,(this._env.getMinY()+this._env.getMaxY())/2)}getPoint(){return this._pt}}class yi extends fi{constructor(){super(),yi.constructor_.apply(this,arguments)}static constructor_(){this._env=null,this._centrex=null,this._centrey=null,this._level=null;const t=arguments[0],e=arguments[1];this._env=t,this._level=e,this._centrex=(t.getMinX()+t.getMaxX())/2,this._centrey=(t.getMinY()+t.getMaxY())/2}static createNode(t){const e=new gi(t);return new yi(e.getEnvelope(),e.getLevel())}static createExpanded(t,e){const n=new L(e);null!==t&&n.expandToInclude(t._env);const i=yi.createNode(n);return null!==t&&i.insertNode(t),i}find(t){const e=fi.getSubnodeIndex(t,this._centrex,this._centrey);return-1===e?this:null!==this._subnode[e]?this._subnode[e].find(t):this}isSearchMatch(t){return null!==t&&this._env.intersects(t)}getSubnode(t){return null===this._subnode[t]&&(this._subnode[t]=this.createSubnode(t)),this._subnode[t]}getEnvelope(){return this._env}getNode(t){const e=fi.getSubnodeIndex(t,this._centrex,this._centrey);return-1!==e?this.getSubnode(e).getNode(t):this}createSubnode(t){let e=0,n=0,i=0,r=0;switch(t){case 0:e=this._env.getMinX(),n=this._centrex,i=this._env.getMinY(),r=this._centrey;break;case 1:e=this._centrex,n=this._env.getMaxX(),i=this._env.getMinY(),r=this._centrey;break;case 2:e=this._env.getMinX(),n=this._centrex,i=this._centrey,r=this._env.getMaxY();break;case 3:e=this._centrex,n=this._env.getMaxX(),i=this._centrey,r=this._env.getMaxY()}const o=new L(e,n,i,r);return new yi(o,this._level-1)}insertNode(t){p.isTrue(null===this._env||this._env.contains(t._env));const e=fi.getSubnodeIndex(t._env,this._centrex,this._centrey);if(t._level===this._level-1)this._subnode[e]=t;else{const n=this.createSubnode(e);n.insertNode(t),this._subnode[e]=n}}}class mi{static isZeroWidth(t,e){const n=e-t;if(0===n)return!0;const i=n/Math.max(Math.abs(t),Math.abs(e));return di.exponent(i)<=mi.MIN_BINARY_EXPONENT}}mi.MIN_BINARY_EXPONENT=-50;class _i extends fi{constructor(){super()}insert(t,e){const n=fi.getSubnodeIndex(t,_i.origin.x,_i.origin.y);if(-1===n)return this.add(e),null;const i=this._subnode[n];if(null===i||!i.getEnvelope().contains(t)){const e=yi.createExpanded(i,t);this._subnode[n]=e}this.insertContained(this._subnode[n],t,e)}isSearchMatch(t){return!0}insertContained(t,e,n){p.isTrue(t.getEnvelope().contains(e));const i=mi.isZeroWidth(e.getMinX(),e.getMaxX()),r=mi.isZeroWidth(e.getMinY(),e.getMaxY());let o=null;o=i||r?t.find(e):t.getNode(e),o.add(n)}}_i.origin=new y(0,0);class vi{insert(t,e){}remove(t,e){}query(){}}class xi{constructor(){xi.constructor_.apply(this,arguments)}static constructor_(){this._root=null,this._minExtent=1,this._root=new _i}static ensureExtent(t,e){let n=t.getMinX(),i=t.getMaxX(),r=t.getMinY(),o=t.getMaxY();return n!==i&&r!==o?t:(n===i&&(n-=e/2,i+=e/2),r===o&&(r-=e/2,o+=e/2),new L(n,i,r,o))}size(){return null!==this._root?this._root.size():0}insert(t,e){this.collectStats(t);const n=xi.ensureExtent(t,this._minExtent);this._root.insert(n,e)}query(){if(1===arguments.length){const t=arguments[0],e=new Ge;return this.query(t,e),e.getItems()}if(2===arguments.length){const t=arguments[0],e=arguments[1];this._root.visit(t,e)}}queryAll(){const t=new P;return this._root.addAllItems(t),t}remove(t,e){const n=xi.ensureExtent(t,this._minExtent);return this._root.remove(n,e)}collectStats(t){const e=t.getWidth();e<this._minExtent&&e>0&&(this._minExtent=e);const n=t.getHeight();n<this._minExtent&&n>0&&(this._minExtent=n)}depth(){return null!==this._root?this._root.depth():0}isEmpty(){return null===this._root||this._root.isEmpty()}get interfaces_(){return[vi,u]}}var Ci=Object.freeze({__proto__:null,Quadtree:xi});class wi{getBounds(){}}class bi{constructor(){bi.constructor_.apply(this,arguments)}static constructor_(){this._bounds=null,this._item=null;const t=arguments[0],e=arguments[1];this._bounds=t,this._item=e}getItem(){return this._item}getBounds(){return this._bounds}get interfaces_(){return[wi,u]}}class Ei{constructor(){Ei.constructor_.apply(this,arguments)}static constructor_(){this._size=null,this._items=null,this._size=0,this._items=new P,this._items.add(null)}poll(){if(this.isEmpty())return null;const t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t}size(){return this._size}reorder(t){let e=null;const n=this._items.get(t);for(;2*t<=this._size&&(e=2*t,e!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)}clear(){this._size=0,this._items.clear()}peek(){return this.isEmpty()?null:this._items.get(1)}isEmpty(){return 0===this._size}add(t){this._items.add(null),this._size+=1;let e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)}}class Ii{constructor(){Ii.constructor_.apply(this,arguments)}static constructor_(){if(this._childBoundables=new P,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this._level=t}}getLevel(){return this._level}size(){return this._childBoundables.size()}getChildBoundables(){return this._childBoundables}addChildBoundable(t){p.isTrue(null===this._bounds),this._childBoundables.add(t)}isEmpty(){return this._childBoundables.isEmpty()}getBounds(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds}get interfaces_(){return[wi,u]}}class Pi{static maxDistance(t,e,n,i,r,o,s,a){let l=Pi.distance(t,e,r,o);return l=Math.max(l,Pi.distance(t,e,s,a)),l=Math.max(l,Pi.distance(n,i,r,o)),l=Math.max(l,Pi.distance(n,i,s,a)),l}static distance(t,e,n,i){const r=n-t,o=i-e;return Math.sqrt(r*r+o*o)}static maximumDistance(t,e){const n=Math.min(t.getMinX(),e.getMinX()),i=Math.min(t.getMinY(),e.getMinY()),r=Math.max(t.getMaxX(),e.getMaxX()),o=Math.max(t.getMaxY(),e.getMaxY());return Pi.distance(n,i,r,o)}static minMaxDistance(t,e){const n=t.getMinX(),i=t.getMinY(),r=t.getMaxX(),o=t.getMaxY(),s=e.getMinX(),a=e.getMinY(),l=e.getMaxX(),u=e.getMaxY();let c=Pi.maxDistance(n,i,n,o,s,a,s,u);return c=Math.min(c,Pi.maxDistance(n,i,n,o,s,a,l,a)),c=Math.min(c,Pi.maxDistance(n,i,n,o,l,u,s,u)),c=Math.min(c,Pi.maxDistance(n,i,n,o,l,u,l,a)),c=Math.min(c,Pi.maxDistance(n,i,r,i,s,a,s,u)),c=Math.min(c,Pi.maxDistance(n,i,r,i,s,a,l,a)),c=Math.min(c,Pi.maxDistance(n,i,r,i,l,u,s,u)),c=Math.min(c,Pi.maxDistance(n,i,r,i,l,u,l,a)),c=Math.min(c,Pi.maxDistance(r,o,n,o,s,a,s,u)),c=Math.min(c,Pi.maxDistance(r,o,n,o,s,a,l,a)),c=Math.min(c,Pi.maxDistance(r,o,n,o,l,u,s,u)),c=Math.min(c,Pi.maxDistance(r,o,n,o,l,u,l,a)),c=Math.min(c,Pi.maxDistance(r,o,r,i,s,a,s,u)),c=Math.min(c,Pi.maxDistance(r,o,r,i,s,a,l,a)),c=Math.min(c,Pi.maxDistance(r,o,r,i,l,u,s,u)),c=Math.min(c,Pi.maxDistance(r,o,r,i,l,u,l,a)),c}}class Ni{constructor(){Ni.constructor_.apply(this,arguments)}static constructor_(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;const t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()}static area(t){return t.getBounds().getArea()}static isComposite(t){return t instanceof Ii}maximumDistance(){return Pi.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}expandToQueue(t,e){const n=Ni.isComposite(this._boundable1),r=Ni.isComposite(this._boundable2);if(n&&r)return Ni.area(this._boundable1)>Ni.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,t,e),null):(this.expand(this._boundable2,this._boundable1,!0,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,!1,t,e),null;if(r)return this.expand(this._boundable2,this._boundable1,!0,t,e),null;throw new i("neither boundable is composite")}isLeaves(){return!(Ni.isComposite(this._boundable1)||Ni.isComposite(this._boundable2))}compareTo(t){const e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0}expand(t,e,n,i,r){for(let o=t.getChildBoundables().iterator();o.hasNext();){const t=o.next();let s=null;s=n?new Ni(e,t,this._itemDistance):new Ni(t,e,this._itemDistance),s.getDistance()<r&&i.add(s)}}getBoundable(t){return 0===t?this._boundable1:this._boundable2}getDistance(){return this._distance}distance(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}get interfaces_(){return[s]}}class Si{constructor(){Si.constructor_.apply(this,arguments)}static constructor_(){if(this._root=null,this._built=!1,this._itemBoundables=new P,this._nodeCapacity=null,0===arguments.length)Si.constructor_.call(this,Si.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){const t=arguments[0];p.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}}static compareDoubles(t,e){return t>e?1:t<e?-1:0}queryInternal(){if(C(arguments[2],Re)&&arguments[0]instanceof Object&&arguments[1]instanceof Ii){const t=arguments[0],e=arguments[2],n=arguments[1].getChildBoundables();for(let i=0;i<n.size();i++){const r=n.get(i);this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof Ii?this.queryInternal(t,r,e):r instanceof bi?e.visitItem(r.getItem()):p.shouldNeverReachHere())}}else if(C(arguments[2],E)&&arguments[0]instanceof Object&&arguments[1]instanceof Ii){const t=arguments[0],e=arguments[2],n=arguments[1].getChildBoundables();for(let i=0;i<n.size();i++){const r=n.get(i);this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof Ii?this.queryInternal(t,r,e):r instanceof bi?e.add(r.getItem()):p.shouldNeverReachHere())}}}getNodeCapacity(){return this._nodeCapacity}lastNode(t){return t.get(t.size()-1)}size(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){let t=0;for(let e=arguments[0].getChildBoundables().iterator();e.hasNext();){const n=e.next();n instanceof Ii?t+=this.size(n):n instanceof bi&&(t+=1)}return t}}removeItem(t,e){let n=null;for(let i=t.getChildBoundables().iterator();i.hasNext();){const t=i.next();t instanceof bi&&t.getItem()===e&&(n=t)}return null!==n&&(t.getChildBoundables().remove(n),!0)}itemsTree(){if(0===arguments.length){this.build();const t=this.itemsTree(this._root);return null===t?new P:t}if(1===arguments.length){const t=arguments[0],e=new P;for(let n=t.getChildBoundables().iterator();n.hasNext();){const t=n.next();if(t instanceof Ii){const n=this.itemsTree(t);null!==n&&e.add(n)}else t instanceof bi?e.add(t.getItem()):p.shouldNeverReachHere()}return e.size()<=0?null:e}}insert(t,e){p.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new bi(t,e))}boundablesAtLevel(){if(1===arguments.length){const t=arguments[0],e=new P;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(p.isTrue(t>-2),e.getLevel()===t)return n.add(e),null;for(let i=e.getChildBoundables().iterator();i.hasNext();){const e=i.next();e instanceof Ii?this.boundablesAtLevel(t,e,n):(p.isTrue(e instanceof bi),-1===t&&n.add(e))}return null}}query(){if(1===arguments.length){const t=arguments[0];this.build();const e=new P;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e),e}if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e)}}build(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}getRoot(){return this.build(),this._root}remove(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];let i=this.removeItem(e,n);if(i)return!0;let r=null;for(let o=e.getChildBoundables().iterator();o.hasNext();){const e=o.next();if(this.getIntersectsOp().intersects(e.getBounds(),t)&&e instanceof Ii&&(i=this.remove(t,e,n),i)){r=e;break}}return null!==r&&r.getChildBoundables().isEmpty()&&e.getChildBoundables().remove(r),i}}createHigherLevels(t,e){p.isTrue(!t.isEmpty());const n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)}depth(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){let t=0;for(let e=arguments[0].getChildBoundables().iterator();e.hasNext();){const n=e.next();if(n instanceof Ii){const e=this.depth(n);e>t&&(t=e)}}return t+1}}createParentBoundables(t,e){p.isTrue(!t.isEmpty());const n=new P;n.add(this.createNode(e));const i=new P(t);_e.sort(i,this.getComparator());for(let t=i.iterator();t.hasNext();){const i=t.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(i)}return n}isEmpty(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}get interfaces_(){return[u]}}Si.IntersectsOp=function(){},Si.DEFAULT_NODE_CAPACITY=10;class Ti{distance(t,e){}}class Li extends Si{constructor(){super(),Li.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length)Li.constructor_.call(this,Li.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){const t=arguments[0];Si.constructor_.call(this,t)}}static centreX(t){return Li.avg(t.getMinX(),t.getMaxX())}static avg(t,e){return(t+e)/2}static getItems(t){const e=new Array(t.size()).fill(null);let n=0;for(;!t.isEmpty();){const i=t.poll();e[n]=i.getBoundable(0).getItem(),n++}return e}static centreY(t){return Li.avg(t.getMinY(),t.getMaxY())}createParentBoundablesFromVerticalSlices(t,e){p.isTrue(t.length>0);const n=new P;for(let i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n}nearestNeighbourK(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.nearestNeighbourK(t,o.POSITIVE_INFINITY,e)}if(3===arguments.length){const t=arguments[0],e=arguments[2];let n=arguments[1];const i=new Ei;i.add(t);const r=new Ei;for(;!i.isEmpty()&&n>=0;){const t=i.poll(),o=t.getDistance();if(o>=n)break;t.isLeaves()?r.size()<e?r.add(t):(r.peek().getDistance()>o&&(r.poll(),r.add(t)),n=r.peek().getDistance()):t.expandToQueue(i,n)}return Li.getItems(r)}}createNode(t){return new Mi(t)}size(){return 0===arguments.length?super.size.call(this):super.size.apply(this,arguments)}insert(){if(!(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof L))return super.insert.apply(this,arguments);{const t=arguments[0],e=arguments[1];if(t.isNull())return null;super.insert.call(this,t,e)}}getIntersectsOp(){return Li.intersectsOp}verticalSlices(t,e){const n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator();for(let t=0;t<e;t++){i[t]=new P;let e=0;for(;r.hasNext()&&e<n;){const n=r.next();i[t].add(n),e++}}return i}query(){if(1===arguments.length){const t=arguments[0];return super.query.call(this,t)}if(2===arguments.length){const t=arguments[0],e=arguments[1];super.query.call(this,t,e)}}getComparator(){return Li.yComparator}createParentBoundablesFromVerticalSlice(t,e){return super.createParentBoundables.call(this,t,e)}remove(){if(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof L){const t=arguments[0],e=arguments[1];return super.remove.call(this,t,e)}return super.remove.apply(this,arguments)}depth(){return 0===arguments.length?super.depth.call(this):super.depth.apply(this,arguments)}createParentBoundables(t,e){p.isTrue(!t.isEmpty());const n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new P(t);_e.sort(i,Li.xComparator);const r=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(r,e)}nearestNeighbour(){if(1===arguments.length){if(C(arguments[0],Ti)){const t=arguments[0];if(this.isEmpty())return null;const e=new Ni(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof Ni){const t=arguments[0];let e=o.POSITIVE_INFINITY,n=null;const i=new Ei;for(i.add(t);!i.isEmpty()&&e>0;){const t=i.poll(),r=t.getDistance();if(r>=e)break;t.isLeaves()?(e=r,n=t):t.expandToQueue(i,e)}return null===n?null:[n.getBoundable(0).getItem(),n.getBoundable(1).getItem()]}}else{if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this.isEmpty()||t.isEmpty())return null;const n=new Ni(this.getRoot(),t.getRoot(),e);return this.nearestNeighbour(n)}if(3===arguments.length){const t=arguments[2],e=new bi(arguments[0],arguments[1]),n=new Ni(this.getRoot(),e,t);return this.nearestNeighbour(n)[0]}if(4===arguments.length){const t=arguments[2],e=arguments[3],n=new bi(arguments[0],arguments[1]),i=new Ni(this.getRoot(),n,t);return this.nearestNeighbourK(i,e)}}}isWithinDistance(){if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=o.POSITIVE_INFINITY;const i=new Ei;for(i.add(t);!i.isEmpty();){const t=i.poll(),r=t.getDistance();if(r>e)return!1;if(t.maximumDistance()<=e)return!0;if(t.isLeaves()){if(n=r,n<=e)return!0}else t.expandToQueue(i,n)}return!1}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=new Ni(this.getRoot(),t.getRoot(),e);return this.isWithinDistance(i,n)}}get interfaces_(){return[vi,u]}}class Mi extends Ii{constructor(){super(),Mi.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0];Ii.constructor_.call(this,t)}computeBounds(){let t=null;for(let e=this.getChildBoundables().iterator();e.hasNext();){const n=e.next();null===t?t=new L(n.getBounds()):t.expandToInclude(n.getBounds())}return t}}Li.STRtreeNode=Mi,Li.xComparator=new class{get interfaces_(){return[l]}compare(t,e){return Si.compareDoubles(Li.centreX(t.getBounds()),Li.centreX(e.getBounds()))}},Li.yComparator=new class{get interfaces_(){return[l]}compare(t,e){return Si.compareDoubles(Li.centreY(t.getBounds()),Li.centreY(e.getBounds()))}},Li.intersectsOp=new class{get interfaces_(){return[IntersectsOp]}intersects(t,e){return t.intersects(e)}},Li.DEFAULT_NODE_CAPACITY=10;var Oi=Object.freeze({__proto__:null,STRtree:Li}),Ri=Object.freeze({__proto__:null,kdtree:pi,quadtree:Ci,strtree:Oi});const Ai=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];class Di{constructor(t){this.geometryFactory=t||new Pt}read(t){let e;e="string"==typeof t?JSON.parse(t):t;const n=e.type;if(!Fi[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==Ai.indexOf(n)?Fi[n].call(this,e.coordinates):"GeometryCollection"===n?Fi[n].call(this,e.geometries):Fi[n].call(this,e)}write(t){const e=t.getGeometryType();if(!ki[e])throw new Error("Geometry is not supported");return ki[e].call(this,t)}}const Fi={Feature:function(t){const e={};for(const n in t)e[n]=t[n];if(t.geometry){const n=t.geometry.type;if(!Fi[n])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=Fi.bbox.call(this,t.bbox)),e},FeatureCollection:function(t){const e={};if(t.features){e.features=[];for(let n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.call(this,t.bbox)),e},coordinates:function(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];e.push(new y(...i))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new y(t[0],t[1]),new y(t[2],t[1]),new y(t[2],t[3]),new y(t[0],t[3]),new y(t[0],t[1])])},Point:function(t){const e=new y(...t);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){const e=[];for(let n=0;n<t.length;++n)e.push(Fi.Point.call(this,t[n]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){const e=Fi.coordinates.call(this,t);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){const e=[];for(let n=0;n<t.length;++n)e.push(Fi.LineString.call(this,t[n]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){const e=Fi.coordinates.call(this,t[0]),n=this.geometryFactory.createLinearRing(e),i=[];for(let e=1;e<t.length;++e){const n=t[e],r=Fi.coordinates.call(this,n),o=this.geometryFactory.createLinearRing(r);i.push(o)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];e.push(Fi.Polygon.call(this,i))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},ki={coordinate:function(t){const e=[t.x,t.y];return t.z&&e.push(t.z),t.m&&e.push(t.m),e},Point:function(t){return{type:"Point",coordinates:ki.coordinate.call(this,t.getCoordinate())}},MultiPoint:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const i=t._geometries[n],r=ki.Point.call(this,i);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){const e=[],n=t.getCoordinates();for(let t=0;t<n.length;++t){const i=n[t];e.push(ki.coordinate.call(this,i))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const i=t._geometries[n],r=ki.LineString.call(this,i);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){const e=[],n=ki.LineString.call(this,t._shell);e.push(n.coordinates);for(let n=0;n<t._holes.length;++n){const i=t._holes[n],r=ki.LineString.call(this,i);e.push(r.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const i=t._geometries[n],r=ki.Polygon.call(this,i);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const i=t._geometries[n],r=i.getGeometryType();e.push(ki[r].call(this,i))}return{type:"GeometryCollection",geometries:e}}};function Bi(t){return[t.x,t.y]}var Gi=Object.freeze({__proto__:null,GeoJSONReader:class{constructor(t){this.parser=new Di(t||new Pt)}read(t){return this.parser.read(t)}},GeoJSONWriter:class{constructor(){this.parser=new Di(this.geometryFactory)}write(t){return this.parser.write(t)}},OL3Parser:class{constructor(t,e){this.geometryFactory=t||new Pt,this.ol=e||"undefined"!=typeof ol&&ol}inject(t,e,n,i,r,o,s,a){this.ol={geom:{Point:t,LineString:e,LinearRing:n,Polygon:i,MultiPoint:r,MultiLineString:o,MultiPolygon:s,GeometryCollection:a}}}read(t){const e=this.ol;return t instanceof e.geom.Point?this.convertFromPoint(t):t instanceof e.geom.LineString?this.convertFromLineString(t):t instanceof e.geom.LinearRing?this.convertFromLinearRing(t):t instanceof e.geom.Polygon?this.convertFromPolygon(t):t instanceof e.geom.MultiPoint?this.convertFromMultiPoint(t):t instanceof e.geom.MultiLineString?this.convertFromMultiLineString(t):t instanceof e.geom.MultiPolygon?this.convertFromMultiPolygon(t):t instanceof e.geom.GeometryCollection?this.convertFromCollection(t):void 0}convertFromPoint(t){const e=t.getCoordinates();return this.geometryFactory.createPoint(new y(e[0],e[1]))}convertFromLineString(t){return this.geometryFactory.createLineString(t.getCoordinates().map((function(t){return new y(t[0],t[1])})))}convertFromLinearRing(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map((function(t){return new y(t[0],t[1])})))}convertFromPolygon(t){const e=t.getLinearRings();let n=null;const i=[];for(let t=0;t<e.length;t++){const r=this.convertFromLinearRing(e[t]);0===t?n=r:i.push(r)}return this.geometryFactory.createPolygon(n,i)}convertFromMultiPoint(t){const e=t.getPoints().map((function(t){return this.convertFromPoint(t)}),this);return this.geometryFactory.createMultiPoint(e)}convertFromMultiLineString(t){const e=t.getLineStrings().map((function(t){return this.convertFromLineString(t)}),this);return this.geometryFactory.createMultiLineString(e)}convertFromMultiPolygon(t){const e=t.getPolygons().map((function(t){return this.convertFromPolygon(t)}),this);return this.geometryFactory.createMultiPolygon(e)}convertFromCollection(t){const e=t.getGeometries().map((function(t){return this.read(t)}),this);return this.geometryFactory.createGeometryCollection(e)}write(t){return"Point"===t.getGeometryType()?this.convertToPoint(t.getCoordinate()):"LineString"===t.getGeometryType()?this.convertToLineString(t):"LinearRing"===t.getGeometryType()?this.convertToLinearRing(t):"Polygon"===t.getGeometryType()?this.convertToPolygon(t):"MultiPoint"===t.getGeometryType()?this.convertToMultiPoint(t):"MultiLineString"===t.getGeometryType()?this.convertToMultiLineString(t):"MultiPolygon"===t.getGeometryType()?this.convertToMultiPolygon(t):"GeometryCollection"===t.getGeometryType()?this.convertToCollection(t):void 0}convertToPoint(t){return new this.ol.geom.Point([t.x,t.y])}convertToLineString(t){const e=t._points._coordinates.map(Bi);return new this.ol.geom.LineString(e)}convertToLinearRing(t){const e=t._points._coordinates.map(Bi);return new this.ol.geom.LinearRing(e)}convertToPolygon(t){const e=[t._shell._points._coordinates.map(Bi)];for(let n=0;n<t._holes.length;n++)e.push(t._holes[n]._points._coordinates.map(Bi));return new this.ol.geom.Polygon(e)}convertToMultiPoint(t){return new this.ol.geom.MultiPoint(t.getCoordinates().map(Bi))}convertToMultiLineString(t){const e=[];for(let n=0;n<t._geometries.length;n++)e.push(this.convertToLineString(t._geometries[n]).getCoordinates());return new this.ol.geom.MultiLineString(e)}convertToMultiPolygon(t){const e=[];for(let n=0;n<t._geometries.length;n++)e.push(this.convertToPolygon(t._geometries[n]).getCoordinates());return new this.ol.geom.MultiPolygon(e)}convertToCollection(t){const e=[];for(let n=0;n<t._geometries.length;n++){const i=t._geometries[n];e.push(this.write(i))}return new this.ol.geom.GeometryCollection(e)}},WKTReader:class{constructor(t){this.parser=new Ht(t||new Pt)}read(t){return this.parser.read(t)}},WKTWriter:Yt});class ji{static relativeSign(t,e){return t<e?-1:t>e?1:0}static compare(t,e,n){if(e.equals2D(n))return 0;const i=ji.relativeSign(e.x,n.x),r=ji.relativeSign(e.y,n.y);switch(t){case 0:return ji.compareValue(i,r);case 1:return ji.compareValue(r,i);case 2:return ji.compareValue(r,-i);case 3:return ji.compareValue(-i,r);case 4:return ji.compareValue(-i,-r);case 5:return ji.compareValue(-r,-i);case 6:return ji.compareValue(-r,i);case 7:return ji.compareValue(i,-r)}return p.shouldNeverReachHere("invalid octant value"),0}static compareValue(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0}}class zi{constructor(){zi.constructor_.apply(this,arguments)}static constructor_(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new y(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)}compareTo(t){const e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:this._isInterior?e._isInterior?ji.compare(this._segmentOctant,this.coord,e.coord):1:-1}isEndPoint(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t}toString(){return this.segmentIndex+":"+this.coord.toString()}isInterior(){return this._isInterior}get interfaces_(){return[s]}}class Ui{constructor(){Ui.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new Hn,this._edge=null;const t=arguments[0];this._edge=t}getSplitCoordinates(){const t=new S;this.addEndpoints();const e=this.iterator();let n=e.next();for(;e.hasNext();){const i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()}addCollapsedNodes(){const t=new P;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(let e=t.iterator();e.hasNext();){const t=e.next().intValue();this.add(this._edge.getCoordinate(t),t)}}createSplitEdgePts(t,e){let n=e.segmentIndex-t.segmentIndex+2;if(2===n)return[new y(t.coord),new y(e.coord)];const i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;const o=new Array(n).fill(null);let s=0;o[s++]=new y(t.coord);for(let n=t.segmentIndex+1;n<=e.segmentIndex;n++)o[s++]=this._edge.getCoordinate(n);return r&&(o[s]=new y(e.coord)),o}print(t){t.println("Intersections:");for(let e=this.iterator();e.hasNext();)e.next().print(t)}findCollapsesFromExistingVertices(t){for(let e=0;e<this._edge.size()-2;e++){const n=this._edge.getCoordinate(e);this._edge.getCoordinate(e+1);const i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(O.valueOf(e+1))}}addEdgeCoordinates(t,e,n){const i=this.createSplitEdgePts(t,e);n.add(i,!1)}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints(),this.addCollapsedNodes();const e=this.iterator();let n=e.next();for(;e.hasNext();){const i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}}findCollapseIndex(t,e,n){if(!t.coord.equals2D(e.coord))return!1;let i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)}findCollapsesFromInsertedNodes(t){const e=new Array(1).fill(null),n=this.iterator();let i=n.next();for(;n.hasNext();){const r=n.next();this.findCollapseIndex(i,r,e)&&t.add(O.valueOf(e[0])),i=r}}getEdge(){return this._edge}addEndpoints(){const t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)}createSplitEdge(t,e){const n=this.createSplitEdgePts(t,e);return new Yi(n,this._edge.getData())}add(t,e){const n=new zi(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(p.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)}checkSplitEdgesCorrectness(t){const e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new c("bad split edge start point at "+n);const i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new c("bad split edge end point at "+r)}}class qi{static octant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new i("Cannot compute the octant for point ( "+t+", "+e+" )");const n=Math.abs(t),r=Math.abs(e);return t>=0?e>=0?n>=r?0:1:n>=r?7:6:e>=0?n>=r?3:2:n>=r?4:5}if(arguments[0]instanceof y&&arguments[1]instanceof y){const t=arguments[0],e=arguments[1],n=e.x-t.x,r=e.y-t.y;if(0===n&&0===r)throw new i("Cannot compute the octant for two identical points "+t);return qi.octant(n,r)}}}class Vi{getCoordinates(){}size(){}getCoordinate(t){}isClosed(){}setData(t){}getData(){}}class Hi{addIntersection(t,e){}get interfaces_(){return[Vi]}}class Yi{constructor(){Yi.constructor_.apply(this,arguments)}static constructor_(){this._nodeList=new Ui(this),this._pts=null,this._data=null;const t=arguments[0],e=arguments[1];this._pts=t,this._data=e}static getNodedSubstrings(){if(1===arguments.length){const t=arguments[0],e=new P;return Yi.getNodedSubstrings(t,e),e}if(2===arguments.length){const t=arguments[1];for(let e=arguments[0].iterator();e.hasNext();)e.next().getNodeList().addSplitEdges(t)}}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(t){return this._pts[t]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))}setData(t){this._data=t}safeOctant(t,e){return t.equals2D(e)?0:qi.octant(t,e)}getData(){return this._data}addIntersection(){if(2===arguments.length){const t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){const t=arguments[1],e=arguments[3],n=new y(arguments[0].getIntersection(e));this.addIntersection(n,t)}}toString(){return Yt.toLineString(new yt(this._pts))}getNodeList(){return this._nodeList}addIntersectionNode(t,e){let n=e;const i=n+1;if(i<this._pts.length){const e=this._pts[i];t.equals2D(e)&&(n=i)}return this._nodeList.add(t,n)}addIntersections(t,e,n){for(let i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)}get interfaces_(){return[Hi]}}class Xi{constructor(){Xi.constructor_.apply(this,arguments)}static constructor_(){this._overlapSeg1=new Kt,this._overlapSeg2=new Kt}overlap(){if(2===arguments.length);else if(4===arguments.length){const t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}class Wi{constructor(){Wi.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i}getLineSegment(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]}computeSelect(t,e,n,i){const r=this._pts[e],o=this._pts[n];if(n-e==1)return i.select(this,e),null;if(!t.intersects(r,o))return null;const s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,i),s<n&&this.computeSelect(t,s,n,i)}getCoordinates(){const t=new Array(this._end-this._start+1).fill(null);let e=0;for(let n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t}computeOverlaps(){if(2===arguments.length){const t=arguments[0],e=arguments[1];this.computeOverlaps(this._start,this._end,t,t._start,t._end,e)}else if(6===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],o=arguments[5];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(!this.overlaps(t,e,n,i,r))return null;const s=Math.trunc((t+e)/2),a=Math.trunc((i+r)/2);t<s&&(i<a&&this.computeOverlaps(t,s,n,i,a,o),a<r&&this.computeOverlaps(t,s,n,a,r,o)),s<e&&(i<a&&this.computeOverlaps(s,e,n,i,a,o),a<r&&this.computeOverlaps(s,e,n,a,r,o))}}setId(t){this._id=t}select(t,e){this.computeSelect(t,this._start,this._end,e)}getEnvelope(){if(null===this._env){const t=this._pts[this._start],e=this._pts[this._end];this._env=new L(t,e)}return this._env}overlaps(t,e,n,i,r){return L.intersects(this._pts[t],this._pts[e],n._pts[i],n._pts[r])}getEndIndex(){return this._end}getStartIndex(){return this._start}getContext(){return this._context}getId(){return this._id}}class Ki{static findChainEnd(t,e){let n=e;for(;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;const i=bn.quadrant(t[n],t[n+1]);let r=e+1;for(;r<t.length&&(t[r-1].equals2D(t[r])||bn.quadrant(t[r-1],t[r])===i);)r++;return r-1}static getChains(){if(1===arguments.length){const t=arguments[0];return Ki.getChains(t,null)}if(2===arguments.length){const t=arguments[0],e=arguments[1],n=new P;let i=0;do{const r=Ki.findChainEnd(t,i),o=new Wi(t,i,r,e);n.add(o),i=r}while(i<t.length-1);return n}}}class Zi{computeNodes(t){}getNodedSubstrings(){}}class Ji{constructor(){Ji.constructor_.apply(this,arguments)}static constructor_(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.setSegmentIntersector(t)}}setSegmentIntersector(t){this._segInt=t}get interfaces_(){return[Zi]}}class Qi extends Ji{constructor(){super(),Qi.constructor_.apply(this,arguments)}static constructor_(){if(this._monoChains=new P,this._index=new Li,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,0===arguments.length);else if(1===arguments.length){const t=arguments[0];Ji.constructor_.call(this,t)}}getMonotoneChains(){return this._monoChains}getNodedSubstrings(){return Yi.getNodedSubstrings(this._nodedSegStrings)}getIndex(){return this._index}add(t){for(let e=Ki.getChains(t.getCoordinates(),t).iterator();e.hasNext();){const t=e.next();t.setId(this._idCounter++),this._index.insert(t.getEnvelope(),t),this._monoChains.add(t)}}computeNodes(t){this._nodedSegStrings=t;for(let e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()}intersectChains(){const t=new $i(this._segInt);for(let e=this._monoChains.iterator();e.hasNext();){const n=e.next();for(let e=this._index.query(n.getEnvelope()).iterator();e.hasNext();){const i=e.next();if(i.getId()>n.getId()&&(n.computeOverlaps(i,t),this._nOverlaps++),this._segInt.isDone())return null}}}}class $i extends Xi{constructor(){super(),$i.constructor_.apply(this,arguments)}static constructor_(){this._si=null;const t=arguments[0];this._si=t}overlap(){if(4!==arguments.length)return super.overlap.apply(this,arguments);{const t=arguments[1],e=arguments[2],n=arguments[3],i=arguments[0].getContext(),r=e.getContext();this._si.processIntersections(i,t,r,n)}}}Qi.SegmentOverlapAction=$i;class tr{constructor(){tr.constructor_.apply(this,arguments)}static constructor_(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){const t=arguments[0],e=arguments[1];tr.constructor_.call(this,t,e,0,0)}else if(4===arguments.length){const t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._isScaled=!this.isIntegerPrecision()}}rescale(){if(C(arguments[0],w))for(let t=arguments[0].iterator();t.hasNext();){const e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){const t=arguments[0];for(let e=0;e<t.length;e++)t[e].x=t[e].x/this._scaleFactor+this._offsetX,t[e].y=t[e].y/this._scaleFactor+this._offsetY;2===t.length&&t[0].equals2D(t[1])&&j.out.println(t)}}scale(){if(C(arguments[0],w)){const t=arguments[0],e=new P(t.size());for(let n=t.iterator();n.hasNext();){const t=n.next();e.add(new Yi(this.scale(t.getCoordinates()),t.getData()))}return e}if(arguments[0]instanceof Array){const t=arguments[0],e=new Array(t.length).fill(null);for(let n=0;n<t.length;n++)e[n]=new y(Math.round((t[n].x-this._offsetX)*this._scaleFactor),Math.round((t[n].y-this._offsetY)*this._scaleFactor),t[n].getZ());return dt.removeRepeatedPoints(e)}}isIntegerPrecision(){return 1===this._scaleFactor}getNodedSubstrings(){const t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t}computeNodes(t){let e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)}get interfaces_(){return[Zi]}}var er=Object.freeze({__proto__:null,MCIndexNoder:Qi,ScaledNoder:tr,SegmentString:Vi});class nr{constructor(){nr.constructor_.apply(this,arguments)}static constructor_(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){const t=arguments[0];nr.constructor_.call(this,t,hn.MOD2_BOUNDARY_RULE)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}}static getBoundary(){return 1===arguments.length?new nr(arguments[0]).getBoundary():2===arguments.length?new nr(arguments[0],arguments[1]).getBoundary():void 0}boundaryMultiLineString(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();const e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)}getBoundary(){return this._geom instanceof $?this.boundaryLineString(this._geom):this._geom instanceof It?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()}boundaryLineString(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])}getEmptyMultiPoint(){return this._geomFact.createMultiPoint()}computeBoundaryCoordinates(t){const e=new P;this._endpointMap=new Hn;for(let e=0;e<t.getNumGeometries();e++){const n=t.getGeometryN(e);0!==n.getNumPoints()&&(this.addEndpoint(n.getCoordinateN(0)),this.addEndpoint(n.getCoordinateN(n.getNumPoints()-1)))}for(let t=this._endpointMap.entrySet().iterator();t.hasNext();){const n=t.next(),i=n.getValue().count;this._bnRule.isInBoundary(i)&&e.add(n.getKey())}return dt.toCoordinateArray(e)}addEndpoint(t){let e=this._endpointMap.get(t);null===e&&(e=new ir,this._endpointMap.put(t,e)),e.count++}}class ir{constructor(){ir.constructor_.apply(this,arguments)}static constructor_(){this.count=null}}class rr{constructor(){rr.constructor_.apply(this,arguments)}static constructor_(){if(this._inputGeom=null,this._isClosedEndpointsInInterior=!0,this._nonSimpleLocation=null,1===arguments.length){const t=arguments[0];this._inputGeom=t}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._inputGeom=t,this._isClosedEndpointsInInterior=!e.isInBoundary(2)}}static isSimple(){return 1===arguments.length?new rr(arguments[0]).isSimple():2===arguments.length?new rr(arguments[0],arguments[1]).isSimple():void 0}isSimpleMultiPoint(t){if(t.isEmpty())return!0;const e=new lt;for(let n=0;n<t.getNumGeometries();n++){const i=t.getGeometryN(n).getCoordinate();if(e.contains(i))return this._nonSimpleLocation=i,!1;e.add(i)}return!0}isSimplePolygonal(t){for(let e=me.getLines(t).iterator();e.hasNext();){const t=e.next();if(!this.isSimpleLinearGeometry(t))return!1}return!0}hasClosedEndpointIntersection(t){const e=new Hn;for(let n=t.getEdgeIterator();n.hasNext();){const t=n.next(),i=t.isClosed(),r=t.getCoordinate(0);this.addEndpoint(e,r,i);const o=t.getCoordinate(t.getNumPoints()-1);this.addEndpoint(e,o,i)}for(let t=e.values().iterator();t.hasNext();){const e=t.next();if(e.isClosed&&2!==e.degree)return this._nonSimpleLocation=e.getCoordinate(),!0}return!1}getNonSimpleLocation(){return this._nonSimpleLocation}isSimpleLinearGeometry(t){if(t.isEmpty())return!0;const e=new si(0,t),n=new Wt,i=e.computeSelfNodes(n,!0);return!(i.hasIntersection()&&(i.hasProperIntersection()?(this._nonSimpleLocation=i.getProperIntersectionPoint(),1):this.hasNonEndpointIntersection(e)||this._isClosedEndpointsInInterior&&this.hasClosedEndpointIntersection(e)))}hasNonEndpointIntersection(t){for(let e=t.getEdgeIterator();e.hasNext();){const t=e.next(),n=t.getMaximumSegmentIndex();for(let e=t.getEdgeIntersectionList().iterator();e.hasNext();){const t=e.next();if(!t.isEndPoint(n))return this._nonSimpleLocation=t.getCoordinate(),!0}}return!1}addEndpoint(t,e,n){let i=t.get(e);null===i&&(i=new or(e),t.put(e,i)),i.addEndpoint(n)}computeSimple(t){return this._nonSimpleLocation=null,!!t.isEmpty()||(t instanceof $||t instanceof It?this.isSimpleLinearGeometry(t):t instanceof ht?this.isSimpleMultiPoint(t):C(t,rt)?this.isSimplePolygonal(t):!(t instanceof ct)||this.isSimpleGeometryCollection(t))}isSimple(){return this._nonSimpleLocation=null,this.computeSimple(this._inputGeom)}isSimpleGeometryCollection(t){for(let e=0;e<t.getNumGeometries();e++){const n=t.getGeometryN(e);if(!this.computeSimple(n))return!1}return!0}}class or{constructor(){or.constructor_.apply(this,arguments)}static constructor_(){this.pt=null,this.isClosed=null,this.degree=null;const t=arguments[0];this.pt=t,this.isClosed=!1,this.degree=0}addEndpoint(t){this.degree++,this.isClosed|=t}getCoordinate(){return this.pt}}rr.EndpointInfo=or;class sr{constructor(){sr.constructor_.apply(this,arguments)}static constructor_(){if(this._quadrantSegments=sr.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=sr.CAP_ROUND,this._joinStyle=sr.JOIN_ROUND,this._mitreLimit=sr.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=sr.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.setQuadrantSegments(t),this.setEndCapStyle(e)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.setQuadrantSegments(t),this.setEndCapStyle(e),this.setJoinStyle(n),this.setMitreLimit(i)}}static bufferDistanceError(t){const e=Math.PI/2/t;return 1-Math.cos(e/2)}getEndCapStyle(){return this._endCapStyle}isSingleSided(){return this._isSingleSided}setQuadrantSegments(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=sr.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=sr.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==sr.JOIN_ROUND&&(this._quadrantSegments=sr.DEFAULT_QUADRANT_SEGMENTS)}getJoinStyle(){return this._joinStyle}setJoinStyle(t){this._joinStyle=t}setSimplifyFactor(t){this._simplifyFactor=t<0?0:t}getSimplifyFactor(){return this._simplifyFactor}getQuadrantSegments(){return this._quadrantSegments}setEndCapStyle(t){this._endCapStyle=t}getMitreLimit(){return this._mitreLimit}setMitreLimit(t){this._mitreLimit=t}setSingleSided(t){this._isSingleSided=t}}sr.CAP_ROUND=1,sr.CAP_FLAT=2,sr.CAP_SQUARE=3,sr.JOIN_ROUND=1,sr.JOIN_MITRE=2,sr.JOIN_BEVEL=3,sr.DEFAULT_QUADRANT_SEGMENTS=8,sr.DEFAULT_MITRE_LIMIT=5,sr.DEFAULT_SIMPLIFY_FACTOR=.01;class ar{constructor(){ar.constructor_.apply(this,arguments)}static constructor_(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}getCoordinate(){return this._minCoord}getRightmostSide(t,e){let n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n}findRightmostEdgeAtVertex(){const t=this._minDe.getEdge().getCoordinates();p.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");const e=t[this._minIndex-1],n=t[this._minIndex+1],i=B.index(this._minCoord,n,e);let r=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===B.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===B.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)}getRightmostSideOfSegment(t,e){const n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;let i=Mn.LEFT;return n[e].y<n[e+1].y&&(i=Mn.RIGHT),i}getEdge(){return this._orientedDe}checkForRightmostCoordinate(t){const e=t.getEdge().getCoordinates();for(let n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])}findRightmostEdgeAtNode(){const t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}findEdge(t){for(let e=t.iterator();e.hasNext();){const t=e.next();t.isForward()&&this.checkForRightmostCoordinate(t)}p.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Mn.LEFT&&(this._orientedDe=this._minDe.getSym())}}class lr{constructor(){this.array=[]}addLast(t){this.array.push(t)}removeFirst(){return this.array.shift()}isEmpty(){return 0===this.array.length}}class ur{constructor(){ur.constructor_.apply(this,arguments)}static constructor_(){this._finder=null,this._dirEdgeList=new P,this._nodes=new P,this._rightMostCoord=null,this._env=null,this._finder=new ar}clearVisitedEdges(){for(let t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)}getRightmostCoordinate(){return this._rightMostCoord}computeNodeDepth(t){let e=null;for(let n=t.getEdges().iterator();n.hasNext();){const t=n.next();if(t.isVisited()||t.getSym().isVisited()){e=t;break}}if(null===e)throw new ni("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(let e=t.getEdges().iterator();e.hasNext();){const t=e.next();t.setVisited(!0),this.copySymDepths(t)}}computeDepth(t){this.clearVisitedEdges();const e=this._finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(Mn.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)}create(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}findResultEdges(){for(let t=this._dirEdgeList.iterator();t.hasNext();){const e=t.next();e.getDepth(Mn.RIGHT)>=1&&e.getDepth(Mn.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}}computeDepths(t){const e=new xt,n=new lr,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){const t=n.removeFirst();e.add(t),this.computeNodeDepth(t);for(let i=t.getEdges().iterator();i.hasNext();){const t=i.next().getSym();if(t.isVisited())continue;const r=t.getNode();e.contains(r)||(n.addLast(r),e.add(r))}}}compareTo(t){const e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0}getEnvelope(){if(null===this._env){const t=new L;for(let e=this._dirEdgeList.iterator();e.hasNext();){const n=e.next().getEdge().getCoordinates();for(let e=0;e<n.length-1;e++)t.expandToInclude(n[e])}this._env=t}return this._env}addReachable(t){const e=new tn;for(e.add(t);!e.empty();){const t=e.pop();this.add(t,e)}}copySymDepths(t){const e=t.getSym();e.setDepth(Mn.LEFT,t.getDepth(Mn.RIGHT)),e.setDepth(Mn.RIGHT,t.getDepth(Mn.LEFT))}add(t,e){t.setVisited(!0),this._nodes.add(t);for(let n=t.getEdges().iterator();n.hasNext();){const t=n.next();this._dirEdgeList.add(t);const i=t.getSym().getNode();i.isVisited()||e.push(i)}}getNodes(){return this._nodes}getDirectedEdges(){return this._dirEdgeList}get interfaces_(){return[s]}}class cr{constructor(){cr.constructor_.apply(this,arguments)}static constructor_(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new P,this._pts=new P,this._label=new kn(Zt.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new P,this._geometryFactory=null,0===arguments.length);else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()}}computeRing(){if(null!==this._ring)return null;const t=new Array(this._pts.size()).fill(null);for(let e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=B.isCCW(this._ring.getCoordinates())}isIsolated(){return 1===this._label.getGeometryCount()}computePoints(t){this._startDe=t;let e=t,n=!0;do{if(null===e)throw new ni("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new ni("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);const t=e.getLabel();p.isTrue(t.isArea()),this.mergeLabel(t),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)}getLinearRing(){return this._ring}getCoordinate(t){return this._pts.get(t)}computeMaxNodeDegree(){this._maxNodeDegree=0;let t=this._startDe;do{const e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2}addPoints(t,e,n){const i=t.getCoordinates();if(e){let t=1;n&&(t=0);for(let e=t;e<i.length;e++)this._pts.add(i[e])}else{let t=i.length-2;n&&(t=i.length-1);for(let e=t;e>=0;e--)this._pts.add(i[e])}}isHole(){return this._isHole}setInResult(){let t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)}containsPoint(t){const e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!Ve.isInRing(t,e.getCoordinates()))return!1;for(let e=this._holes.iterator();e.hasNext();)if(e.next().containsPoint(t))return!1;return!0}addHole(t){this._holes.add(t)}isShell(){return null===this._shell}getLabel(){return this._label}getEdges(){return this._edges}getMaxNodeDegree(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}getShell(){return this._shell}mergeLabel(){if(1===arguments.length){const t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){const t=arguments[1],e=arguments[0].getLocation(t,Mn.RIGHT);if(e===Zt.NONE)return null;if(this._label.getLocation(t)===Zt.NONE)return this._label.setLocation(t,e),null}}setShell(t){this._shell=t,null!==t&&t.addHole(this)}toPolygon(t){const e=new Array(this._holes.size()).fill(null);for(let t=0;t<this._holes.size();t++)e[t]=this._holes.get(t).getLinearRing();return t.createPolygon(this.getLinearRing(),e)}}class hr extends cr{constructor(){super(),hr.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];cr.constructor_.call(this,t,e)}setEdgeRing(t,e){t.setMinEdgeRing(e)}getNext(t){return t.getNextMin()}}class pr extends cr{constructor(){super(),pr.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];cr.constructor_.call(this,t,e)}buildMinimalRings(){const t=new P;let e=this._startDe;do{if(null===e.getMinEdgeRing()){const n=new hr(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t}setEdgeRing(t,e){t.setEdgeRing(e)}linkDirectedEdgesForMinimalEdgeRings(){let t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)}getNext(t){return t.getNext()}}class fr{constructor(){fr.constructor_.apply(this,arguments)}static constructor_(){this._geometryFactory=null,this._shellList=new P;const t=arguments[0];this._geometryFactory=t}static findEdgeRingContaining(t,e){const n=t.getLinearRing(),i=n.getEnvelopeInternal();let r=n.getCoordinateN(0),o=null,s=null;for(let t=e.iterator();t.hasNext();){const e=t.next(),a=e.getLinearRing(),l=a.getEnvelopeInternal();if(l.equals(i))continue;if(!l.contains(i))continue;r=dt.ptNotInList(n.getCoordinates(),a.getCoordinates());let u=!1;Ve.isInRing(r,a.getCoordinates())&&(u=!0),u&&(null===o||s.contains(l))&&(o=e,s=o.getLinearRing().getEnvelopeInternal())}return o}sortShellsAndHoles(t,e,n){for(let i=t.iterator();i.hasNext();){const t=i.next();t.isHole()?n.add(t):e.add(t)}}computePolygons(t){const e=new P;for(let n=t.iterator();n.hasNext();){const t=n.next().toPolygon(this._geometryFactory);e.add(t)}return e}placeFreeHoles(t,e){for(let n=e.iterator();n.hasNext();){const e=n.next();if(null===e.getShell()){const n=fr.findEdgeRingContaining(e,t);if(null===n)throw new ni("unable to assign hole to a shell",e.getCoordinate(0));e.setShell(n)}}}buildMinimalEdgeRings(t,e,n){const i=new P;for(let r=t.iterator();r.hasNext();){const t=r.next();if(t.getMaxNodeDegree()>2){t.linkDirectedEdgesForMinimalEdgeRings();const i=t.buildMinimalRings(),r=this.findShell(i);null!==r?(this.placePolygonHoles(r,i),e.add(r)):n.addAll(i)}else i.add(t)}return i}buildMaximalEdgeRings(t){const e=new P;for(let n=t.iterator();n.hasNext();){const t=n.next();if(t.isInResult()&&t.getLabel().isArea()&&null===t.getEdgeRing()){const n=new pr(t,this._geometryFactory);e.add(n),n.setInResult()}}return e}placePolygonHoles(t,e){for(let n=e.iterator();n.hasNext();){const e=n.next();e.isHole()&&e.setShell(t)}}getPolygons(){return this.computePolygons(this._shellList)}findShell(t){let e=0,n=null;for(let i=t.iterator();i.hasNext();){const t=i.next();t.isHole()||(n=t,e++)}return p.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n}add(){if(1===arguments.length){const t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){const t=arguments[0],e=arguments[1];oi.linkResultDirectedEdges(e);const n=this.buildMaximalEdgeRings(t),i=new P,r=this.buildMinimalEdgeRings(n,this._shellList,i);this.sortShellsAndHoles(r,this._shellList,i),this.placeFreeHoles(this._shellList,i)}}}class dr{constructor(){dr.constructor_.apply(this,arguments)}static constructor_(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=B.COUNTERCLOCKWISE;const t=arguments[0];this._inputLine=t}static simplify(t,e){return new dr(t).simplify(e)}isDeletable(t,e,n,i){const r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(r,o,s)&&!!this.isShallow(r,o,s,i)&&this.isShallowSampled(r,o,t,n,i)}deleteShallowConcavities(){let t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;for(;n<this._inputLine.length;){let r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=dr.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i}isShallowConcavity(t,e,n,i){return B.index(t,e,n)===this._angleOrientation&&U.pointToSegment(e,t,n)<i}isShallowSampled(t,e,n,i,r){let o=Math.trunc((i-n)/dr.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(let s=n;s<i;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0}isConcave(t,e,n){return B.index(t,e,n)===this._angleOrientation}simplify(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=B.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);let e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()}findNextNonDeletedIndex(t){let e=t+1;for(;e<this._inputLine.length&&this._isDeleted[e]===dr.DELETE;)e++;return e}isShallow(t,e,n,i){return U.pointToSegment(e,t,n)<i}collapseLine(){const t=new S;for(let e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==dr.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()}}dr.INIT=0,dr.DELETE=1,dr.KEEP=1,dr.NUM_PTS_TO_CHECK=10;class gr{constructor(){gr.constructor_.apply(this,arguments)}static constructor_(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new P}getCoordinates(){return this._ptList.toArray(gr.COORDINATE_ARRAY_TYPE)}setPrecisionModel(t){this._precisionModel=t}addPt(t){const e=new y(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)}reverse(){}addPts(t,e){if(e)for(let e=0;e<t.length;e++)this.addPt(t[e]);else for(let e=t.length-1;e>=0;e--)this.addPt(t[e])}isRedundant(t){if(this._ptList.size()<1)return!1;const e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance}toString(){return(new Pt).createLineString(this.getCoordinates()).toString()}closeRing(){if(this._ptList.size()<1)return null;const t=new y(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)}setMinimumVertexDistance(t){this._minimimVertexDistance=t}}gr.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);class yr{constructor(){yr.constructor_.apply(this,arguments)}static constructor_(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Kt,this._seg1=new Kt,this._offset0=new Kt,this._offset1=new Kt,this._side=0,this._hasNarrowConcaveAngle=!1;const t=arguments[0],e=arguments[1],n=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new Wt,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===sr.JOIN_ROUND&&(this._closingSegLengthFactor=yr.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}addNextSegment(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;const n=B.index(this._s0,this._s1,this._s2),i=n===B.CLOCKWISE&&this._side===Mn.LEFT||n===B.COUNTERCLOCKWISE&&this._side===Mn.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)}addLineEndCap(t,e){const n=new Kt(t,e),i=new Kt;this.computeOffsetSegment(n,Mn.LEFT,this._distance,i);const r=new Kt;this.computeOffsetSegment(n,Mn.RIGHT,this._distance,r);const o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case sr.CAP_ROUND:this._segList.addPt(i.p1),this.addDirectedFillet(e,a+Math.PI/2,a-Math.PI/2,B.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case sr.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case sr.CAP_SQUARE:const t=new y;t.x=Math.abs(this._distance)*Math.cos(a),t.y=Math.abs(this._distance)*Math.sin(a);const n=new y(i.p1.x+t.x,i.p1.y+t.y),o=new y(r.p1.x+t.x,r.p1.y+t.y);this._segList.addPt(n),this._segList.addPt(o)}}getCoordinates(){return this._segList.getCoordinates()}addMitreJoin(t,e,n,i){const r=G.intersection(e.p0,e.p1,n.p0,n.p1);if(null!==r&&(i<=0?1:r.distance(t)/Math.abs(i))<=this._bufParams.getMitreLimit())return this._segList.addPt(r),null;this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())}addOutsideTurn(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*yr.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===sr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===sr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))}createSquare(t){this._segList.addPt(new y(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new y(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new y(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new y(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()}addSegments(t,e){this._segList.addPts(t,e)}addFirstSegment(){this._segList.addPt(this._offset1.p0)}addCornerFillet(t,e,n,i,r){const o=e.x-t.x,s=e.y-t.y;let a=Math.atan2(s,o);const l=n.x-t.x,u=n.y-t.y,c=Math.atan2(u,l);i===B.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addDirectedFillet(t,a,c,i,r),this._segList.addPt(n)}addLastSegment(){this._segList.addPt(this._offset1.p1)}initSideSegments(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)}addLimitedMitreJoin(t,e,n,i){const r=this._seg0.p1,o=Qt.angle(r,this._seg0.p0),s=Qt.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=Qt.normalize(o+s),l=Qt.normalize(a+Math.PI),u=i*n,c=n-u*Math.abs(Math.sin(s)),h=r.x+u*Math.cos(l),p=r.y+u*Math.sin(l),f=new y(h,p),d=new Kt(r,f),g=d.pointAlongOffset(1,c),m=d.pointAlongOffset(1,-c);this._side===Mn.LEFT?(this._segList.addPt(g),this._segList.addPt(m)):(this._segList.addPt(m),this._segList.addPt(g))}addDirectedFillet(t,e,n,i,r){const o=i===B.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;const l=s/a,u=new y;for(let n=0;n<a;n++){const i=e+o*n*l;u.x=t.x+r*Math.cos(i),u.y=t.y+r*Math.sin(i),this._segList.addPt(u)}}computeOffsetSegment(t,e,n,i){const r=e===Mn.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),l=r*n*o/a,u=r*n*s/a;i.p0.x=t.p0.x-u,i.p0.y=t.p0.y+l,i.p1.x=t.p1.x-u,i.p1.y=t.p1.y+l}addInsideTurn(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*yr.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){const t=new y((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(t);const e=new y((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(e)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}createCircle(t){const e=new y(t.x+this._distance,t.y);this._segList.addPt(e),this.addDirectedFillet(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}addBevelJoin(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)}init(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new gr,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*yr.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}addCollinear(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===sr.JOIN_BEVEL||this._bufParams.getJoinStyle()===sr.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,B.CLOCKWISE,this._distance))}closeRing(){this._segList.closeRing()}hasNarrowConcaveAngle(){return this._hasNarrowConcaveAngle}}yr.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,yr.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,yr.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,yr.MAX_CLOSING_SEG_LEN_FACTOR=80;class mr{constructor(){mr.constructor_.apply(this,arguments)}static constructor_(){this._distance=0,this._precisionModel=null,this._bufParams=null;const t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e}static copyCoordinates(t){const e=new Array(t.length).fill(null);for(let n=0;n<e.length;n++)e[n]=new y(t[n]);return e}getOffsetCurve(t,e){if(this._distance=e,0===e)return null;const n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);const o=r.getCoordinates();return n&&dt.reverse(o),o}computeSingleSidedBufferCurve(t,e,n){const i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);const e=dr.simplify(t,-i),r=e.length-1;n.initSideSegments(e[r],e[r-1],Mn.LEFT),n.addFirstSegment();for(let t=r-2;t>=0;t--)n.addNextSegment(e[t],!0)}else{n.addSegments(t,!1);const e=dr.simplify(t,i),r=e.length-1;n.initSideSegments(e[0],e[1],Mn.LEFT),n.addFirstSegment();for(let t=2;t<=r;t++)n.addNextSegment(e[t],!0)}n.addLastSegment(),n.closeRing()}computeRingBufferCurve(t,e,n){let i=this.simplifyTolerance(this._distance);e===Mn.RIGHT&&(i=-i);const r=dr.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(let t=1;t<=o;t++){const e=1!==t;n.addNextSegment(r[t],e)}n.closeRing()}computeLineBufferCurve(t,e){const n=this.simplifyTolerance(this._distance),i=dr.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],Mn.LEFT);for(let t=2;t<=r;t++)e.addNextSegment(i[t],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);const o=dr.simplify(t,-n),s=o.length-1;e.initSideSegments(o[s],o[s-1],Mn.LEFT);for(let t=s-2;t>=0;t--)e.addNextSegment(o[t],!0);e.addLastSegment(),e.addLineEndCap(o[1],o[0]),e.closeRing()}computePointCurve(t,e){switch(this._bufParams.getEndCapStyle()){case sr.CAP_ROUND:e.createCircle(t);break;case sr.CAP_SQUARE:e.createSquare(t)}}getLineCurve(t,e){if(this._distance=e,this.isLineOffsetEmpty(e))return null;const n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){const n=e<0;this.computeSingleSidedBufferCurve(t,n,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()}getBufferParameters(){return this._bufParams}simplifyTolerance(t){return t*this._bufParams.getSimplifyFactor()}getRingCurve(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return mr.copyCoordinates(t);const i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()}computeOffsetCurve(t,e,n){const i=this.simplifyTolerance(this._distance);if(e){const e=dr.simplify(t,-i),r=e.length-1;n.initSideSegments(e[r],e[r-1],Mn.LEFT),n.addFirstSegment();for(let t=r-2;t>=0;t--)n.addNextSegment(e[t],!0)}else{const e=dr.simplify(t,i),r=e.length-1;n.initSideSegments(e[0],e[1],Mn.LEFT),n.addFirstSegment();for(let t=2;t<=r;t++)n.addNextSegment(e[t],!0)}n.addLastSegment()}isLineOffsetEmpty(t){return 0===t||t<0&&!this._bufParams.isSingleSided()}getSegGen(t){return new yr(this._precisionModel,this._bufParams,t)}}class _r{constructor(){_r.constructor_.apply(this,arguments)}static constructor_(){this._subgraphs=null,this._seg=new Kt;const t=arguments[0];this._subgraphs=t}findStabbedSegments(){if(1===arguments.length){const t=arguments[0],e=new P;for(let n=this._subgraphs.iterator();n.hasNext();){const i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(C(arguments[2],E)&&arguments[0]instanceof y&&arguments[1]instanceof ii){const t=arguments[0],e=arguments[1],n=arguments[2],i=e.getEdge().getCoordinates();for(let r=0;r<i.length-1;r++){if(this._seg.p0=i[r],this._seg.p1=i[r+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),Math.max(this._seg.p0.x,this._seg.p1.x)<t.x)continue;if(this._seg.isHorizontal())continue;if(t.y<this._seg.p0.y||t.y>this._seg.p1.y)continue;if(B.index(this._seg.p0,this._seg.p1,t)===B.RIGHT)continue;let o=e.getDepth(Mn.LEFT);this._seg.p0.equals(i[r])||(o=e.getDepth(Mn.RIGHT));const s=new vr(this._seg,o);n.add(s)}}else if(C(arguments[2],E)&&arguments[0]instanceof y&&C(arguments[1],E)){const t=arguments[0],e=arguments[2];for(let n=arguments[1].iterator();n.hasNext();){const i=n.next();i.isForward()&&this.findStabbedSegments(t,i,e)}}}getDepth(t){const e=this.findStabbedSegments(t);return 0===e.size()?0:_e.min(e)._leftDepth}}class vr{constructor(){vr.constructor_.apply(this,arguments)}static constructor_(){this._upwardSeg=null,this._leftDepth=null;const t=arguments[0],e=arguments[1];this._upwardSeg=new Kt(t),this._leftDepth=e}compareTo(t){const e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;let n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n?n:(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg),0!==n?n:this._upwardSeg.compareTo(e._upwardSeg))}compareX(t,e){const n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)}toString(){return this._upwardSeg.toString()}get interfaces_(){return[s]}}_r.DepthSegment=vr;class xr{constructor(){xr.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new P;const t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n}addRingSide(t,e,n,i,r){if(0===e&&t.length<pt.MINIMUM_VALID_SIZE)return null;let o=i,s=r;t.length>=pt.MINIMUM_VALID_SIZE&&B.isCCW(t)&&(o=r,s=i,n=Mn.opposite(n));const a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)}addRingBothSides(t,e){this.addRingSide(t,e,Mn.LEFT,Zt.EXTERIOR,Zt.INTERIOR),this.addRingSide(t,e,Mn.RIGHT,Zt.INTERIOR,Zt.EXTERIOR)}addPoint(t){if(this._distance<=0)return null;const e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,Zt.EXTERIOR,Zt.INTERIOR)}addPolygon(t){let e=this._distance,n=Mn.LEFT;this._distance<0&&(e=-this._distance,n=Mn.RIGHT);const i=t.getExteriorRing(),r=dt.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addRingSide(r,e,n,Zt.EXTERIOR,Zt.INTERIOR);for(let i=0;i<t.getNumInteriorRing();i++){const r=t.getInteriorRingN(i),o=dt.removeRepeatedPoints(r.getCoordinates());this._distance>0&&this.isErodedCompletely(r,-this._distance)||this.addRingSide(o,e,Mn.opposite(n),Zt.INTERIOR,Zt.EXTERIOR)}}isTriangleErodedCompletely(t,e){const n=new ee(t[0],t[1],t[2]),i=n.inCentre();return U.pointToSegment(i,n.p0,n.p1)<Math.abs(e)}addLineString(t){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;const e=dt.removeRepeatedPoints(t.getCoordinates());if(dt.isRing(e)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(e,this._distance);else{const t=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(t,Zt.EXTERIOR,Zt.INTERIOR)}}addCurve(t,e,n){if(null===t||t.length<2)return null;const i=new Yi(t,new kn(0,Zt.BOUNDARY,e,n));this._curveList.add(i)}getCurves(){return this.add(this._inputGeom),this._curveList}add(t){if(t.isEmpty())return null;if(t instanceof ot)this.addPolygon(t);else if(t instanceof $)this.addLineString(t);else if(t instanceof et)this.addPoint(t);else if(t instanceof ht)this.addCollection(t);else if(t instanceof It)this.addCollection(t);else if(t instanceof _t)this.addCollection(t);else{if(!(t instanceof ct))throw new Z(t.getGeometryType());this.addCollection(t)}}isErodedCompletely(t,e){const n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);const i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r}addCollection(t){for(let e=0;e<t.getNumGeometries();e++){const n=t.getGeometryN(e);this.add(n)}}}class Cr{constructor(){Cr.constructor_.apply(this,arguments)}static constructor_(){this._edgeMap=new Hn,this._edgeList=null,this._ptInAreaLocation=[Zt.NONE,Zt.NONE]}getNextCW(t){this.getEdges();const e=this._edgeList.indexOf(t);let n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)}propagateSideLabels(t){let e=Zt.NONE;for(let n=this.iterator();n.hasNext();){const i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,Mn.LEFT)!==Zt.NONE&&(e=i.getLocation(t,Mn.LEFT))}if(e===Zt.NONE)return null;let n=e;for(let e=this.iterator();e.hasNext();){const i=e.next(),r=i.getLabel();if(r.getLocation(t,Mn.ON)===Zt.NONE&&r.setLocation(t,Mn.ON,n),r.isArea(t)){const e=r.getLocation(t,Mn.LEFT),o=r.getLocation(t,Mn.RIGHT);if(o!==Zt.NONE){if(o!==n)throw new ni("side location conflict",i.getCoordinate());e===Zt.NONE&&p.shouldNeverReachHere("found single null side (at "+i.getCoordinate()+")"),n=e}else p.isTrue(r.getLocation(t,Mn.LEFT)===Zt.NONE,"found single null side"),r.setLocation(t,Mn.RIGHT,n),r.setLocation(t,Mn.LEFT,n)}}}getCoordinate(){const t=this.iterator();return t.hasNext()?t.next().getCoordinate():null}print(t){j.out.println("EdgeEndStar:   "+this.getCoordinate());for(let e=this.iterator();e.hasNext();)e.next().print(t)}isAreaLabelsConsistent(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}checkAreaLabelsConsistent(t){const e=this.getEdges();if(e.size()<=0)return!0;const n=e.size()-1,i=e.get(n).getLabel().getLocation(t,Mn.LEFT);p.isTrue(i!==Zt.NONE,"Found unlabelled area edge");let r=i;for(let e=this.iterator();e.hasNext();){const n=e.next().getLabel();p.isTrue(n.isArea(t),"Found non-area edge");const i=n.getLocation(t,Mn.LEFT),o=n.getLocation(t,Mn.RIGHT);if(i===o)return!1;if(o!==r)return!1;r=i}return!0}findIndex(t){this.iterator();for(let e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1}iterator(){return this.getEdges().iterator()}getEdges(){return null===this._edgeList&&(this._edgeList=new P(this._edgeMap.values())),this._edgeList}getLocation(t,e,n){return this._ptInAreaLocation[t]===Zt.NONE&&(this._ptInAreaLocation[t]=Xe.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]}toString(){const t=new M;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(let e=this.iterator();e.hasNext();){const n=e.next();t.append(n),t.append("\n")}return t.toString()}computeEdgeEndLabels(t){for(let e=this.iterator();e.hasNext();)e.next().computeLabel(t)}computeLabelling(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);const e=[!1,!1];for(let t=this.iterator();t.hasNext();){const n=t.next().getLabel();for(let t=0;t<2;t++)n.isLine(t)&&n.getLocation(t)===Zt.BOUNDARY&&(e[t]=!0)}for(let n=this.iterator();n.hasNext();){const i=n.next(),r=i.getLabel();for(let n=0;n<2;n++)if(r.isAnyNull(n)){let o=Zt.NONE;if(e[n])o=Zt.EXTERIOR;else{const e=i.getCoordinate();o=this.getLocation(n,e,t)}r.setAllLocationsIfNull(n,o)}}}getDegree(){return this._edgeMap.size()}insertEdgeEnd(t,e){this._edgeMap.put(t,e),this._edgeList=null}}class wr extends Cr{constructor(){super(),wr.constructor_.apply(this,arguments)}static constructor_(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}linkResultDirectedEdges(){this.getResultAreaEdges();let t=null,e=null,n=this._SCANNING_FOR_INCOMING;for(let i=0;i<this._resultAreaEdgeList.size();i++){const r=this._resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new ni("no outgoing dirEdge found",this.getCoordinate());p.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}}insert(t){const e=t;this.insertEdgeEnd(e,e)}getRightmostEdge(){const t=this.getEdges(),e=t.size();if(e<1)return null;const n=t.get(0);if(1===e)return n;const i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return bn.isNorthern(r)&&bn.isNorthern(o)?n:bn.isNorthern(r)||bn.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:(p.shouldNeverReachHere("found two horizontal edges incident on node"),null):i}print(t){j.out.println("DirectedEdgeStar: "+this.getCoordinate());for(let e=this.iterator();e.hasNext();){const n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}}getResultAreaEdges(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new P;for(let t=this.iterator();t.hasNext();){const e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList}updateLabelling(t){for(let e=this.iterator();e.hasNext();){const n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}}linkAllDirectedEdges(){this.getEdges();let t=null,e=null;for(let n=this._edgeList.size()-1;n>=0;n--){const i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)}computeDepths(){if(1===arguments.length){const t=arguments[0],e=this.findIndex(t),n=t.getDepth(Mn.LEFT),i=t.getDepth(Mn.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new ni("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){const t=arguments[1];let e=arguments[2];for(let n=arguments[0];n<t;n++){const t=this._edgeList.get(n);t.setEdgeDepths(Mn.RIGHT,e),e=t.getDepth(Mn.LEFT)}return e}}mergeSymLabels(){for(let t=this.iterator();t.hasNext();){const e=t.next();e.getLabel().merge(e.getSym().getLabel())}}linkMinimalDirectedEdges(t){let e=null,n=null,i=this._SCANNING_FOR_INCOMING;for(let r=this._resultAreaEdgeList.size()-1;r>=0;r--){const o=this._resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(p.isTrue(null!==e,"found null for first outgoing dirEdge"),p.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))}getOutgoingDegree(){if(0===arguments.length){let t=0;for(let e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){const t=arguments[0];let e=0;for(let n=this.iterator();n.hasNext();)n.next().getEdgeRing()===t&&e++;return e}}getLabel(){return this._label}findCoveredLineEdges(){let t=Zt.NONE;for(let e=this.iterator();e.hasNext();){const n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=Zt.INTERIOR;break}if(i.isInResult()){t=Zt.EXTERIOR;break}}}if(t===Zt.NONE)return null;let e=t;for(let t=this.iterator();t.hasNext();){const n=t.next(),i=n.getSym();n.isLineEdge()?n.getEdge().setCovered(e===Zt.INTERIOR):(n.isInResult()&&(e=Zt.EXTERIOR),i.isInResult()&&(e=Zt.INTERIOR))}}computeLabelling(t){super.computeLabelling.call(this,t),this._label=new kn(Zt.NONE);for(let t=this.iterator();t.hasNext();){const e=t.next().getEdge().getLabel();for(let t=0;t<2;t++){const n=e.getLocation(t);n!==Zt.INTERIOR&&n!==Zt.BOUNDARY||this._label.setLocation(t,Zt.INTERIOR)}}}}class br extends ri{constructor(){super()}createNode(t){return new $n(t,new wr)}}class Er{constructor(){Er.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._orientation=null;const t=arguments[0];this._pts=t,this._orientation=Er.orientation(t)}static orientation(t){return 1===dt.increasingDirection(t)}static compareOriented(t,e,n,i){const r=e?1:-1,o=i?1:-1,s=e?t.length:-1,a=i?n.length:-1;let l=e?0:t.length-1,u=i?0:n.length-1;for(;;){const e=t[l].compareTo(n[u]);if(0!==e)return e;l+=r,u+=o;const i=l===s,c=u===a;if(i&&!c)return-1;if(!i&&c)return 1;if(i&&c)return 0}}compareTo(t){const e=t;return Er.compareOriented(this._pts,this._orientation,e._pts,e._orientation)}get interfaces_(){return[s]}}class Ir{constructor(){Ir.constructor_.apply(this,arguments)}static constructor_(){this._edges=new P,this._ocaMap=new Hn}print(t){t.print("MULTILINESTRING ( ");for(let e=0;e<this._edges.size();e++){const n=this._edges.get(e);e>0&&t.print(","),t.print("(");const i=n.getCoordinates();for(let e=0;e<i.length;e++)e>0&&t.print(","),t.print(i[e].x+" "+i[e].y);t.println(")")}t.print(")  ")}addAll(t){for(let e=t.iterator();e.hasNext();)this.add(e.next())}findEdgeIndex(t){for(let e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1}iterator(){return this._edges.iterator()}getEdges(){return this._edges}get(t){return this._edges.get(t)}findEqualEdge(t){const e=new Er(t.getCoordinates());return this._ocaMap.get(e)}add(t){this._edges.add(t);const e=new Er(t.getCoordinates());this._ocaMap.put(e,t)}}class Pr{processIntersections(t,e,n,i){}isDone(){}}class Nr{constructor(){Nr.constructor_.apply(this,arguments)}static constructor_(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;const t=arguments[0];this._li=t}static isAdjacentSegments(t,e){return 1===Math.abs(t-e)}isTrivialIntersection(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(Nr.isAdjacentSegments(e,i))return!0;if(t.isClosed()){const n=t.size()-1;if(0===e&&i===n||0===i&&e===n)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}hasProperInteriorIntersection(){return this._hasProperInterior}getLineIntersector(){return this._li}hasProperIntersection(){return this._hasProper}processIntersections(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;const r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}hasIntersection(){return this._hasIntersection}isDone(){return!1}hasInteriorIntersection(){return this._hasInterior}get interfaces_(){return[Pr]}}class Sr{constructor(){Sr.constructor_.apply(this,arguments)}static constructor_(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Ir;const t=arguments[0];this._bufParams=t}static depthDelta(t){const e=t.getLocation(0,Mn.LEFT),n=t.getLocation(0,Mn.RIGHT);return e===Zt.INTERIOR&&n===Zt.EXTERIOR?1:e===Zt.EXTERIOR&&n===Zt.INTERIOR?-1:0}static convertSegStrings(t){const e=new Pt,n=new P;for(;t.hasNext();){const i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)}setWorkingPrecisionModel(t){this._workingPrecisionModel=t}insertUniqueEdge(t){const e=this._edgeList.findEqualEdge(t);if(null!==e){const n=e.getLabel();let i=t.getLabel();e.isPointwiseEqual(t)||(i=new kn(t.getLabel()),i.flip()),n.merge(i);const r=Sr.depthDelta(i),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(Sr.depthDelta(t.getLabel()))}buildSubgraphs(t,e){const n=new P;for(let i=t.iterator();i.hasNext();){const t=i.next(),r=t.getRightmostCoordinate(),o=new _r(n).getDepth(r);t.computeDepth(o),t.findResultEdges(),n.add(t),e.add(t.getDirectedEdges(),t.getNodes())}}createSubgraphs(t){const e=new P;for(let n=t.getNodes().iterator();n.hasNext();){const t=n.next();if(!t.isVisited()){const n=new ur;n.create(t),e.add(n)}}return _e.sort(e,_e.reverseOrder()),e}createEmptyResultGeometry(){return this._geomFact.createPolygon()}getNoder(t){if(null!==this._workingNoder)return this._workingNoder;const e=new Qi,n=new Wt;return n.setPrecisionModel(t),e.setSegmentIntersector(new Nr(n)),e}buffer(t,e){let n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();const i=new mr(n,this._bufParams),r=new xr(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new oi(new br),this._graph.addEdges(this._edgeList.getEdges());const o=this.createSubgraphs(this._graph),s=new fr(this._geomFact);this.buildSubgraphs(o,s);const a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)}computeNodedEdges(t,e){const n=this.getNoder(e);n.computeNodes(t);for(let t=n.getNodedSubstrings().iterator();t.hasNext();){const e=t.next(),n=e.getCoordinates();if(2===n.length&&n[0].equals2D(n[1]))continue;const i=e.getData(),r=new Qn(e.getCoordinates(),new kn(i));this.insertUniqueEdge(r)}}setNoder(t){this._workingNoder=t}}class Tr{constructor(){Tr.constructor_.apply(this,arguments)}static constructor_(){this._li=new Wt,this._segStrings=null;const t=arguments[0];this._segStrings=t}checkEndPtVertexIntersections(){if(0===arguments.length)for(let t=this._segStrings.iterator();t.hasNext();){const e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length){const t=arguments[0];for(let e=arguments[1].iterator();e.hasNext();){const n=e.next().getCoordinates();for(let e=1;e<n.length-1;e++)if(n[e].equals(t))throw new c("found endpt/interior pt intersection at index "+e+" :pt "+t)}}}checkInteriorIntersections(){if(0===arguments.length)for(let t=this._segStrings.iterator();t.hasNext();){const e=t.next();for(let t=this._segStrings.iterator();t.hasNext();){const n=t.next();this.checkInteriorIntersections(e,n)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1],n=t.getCoordinates(),i=e.getCoordinates();for(let r=0;r<n.length-1;r++)for(let n=0;n<i.length-1;n++)this.checkInteriorIntersections(t,r,e,n)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];if(t===n&&e===i)return null;const r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,r,o)||this.hasInteriorIntersection(this._li,s,a)))throw new c("found non-noded intersection at "+r+"-"+o+" and "+s+"-"+a)}}checkValid(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}checkCollapses(){if(0===arguments.length)for(let t=this._segStrings.iterator();t.hasNext();){const e=t.next();this.checkCollapses(e)}else if(1===arguments.length){const t=arguments[0].getCoordinates();for(let e=0;e<t.length-2;e++)this.checkCollapse(t[e],t[e+1],t[e+2])}}hasInteriorIntersection(t,e,n){for(let i=0;i<t.getIntersectionNum();i++){const r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1}checkCollapse(t,e,n){if(t.equals(n))throw new c("found non-noded collapse at "+Tr.fact.createLineString([t,e,n]))}}Tr.fact=new Pt;class Lr{constructor(){Lr.constructor_.apply(this,arguments)}static constructor_(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;const t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new i("Scale factor must be non-zero");1!==e&&(this._pt=new y(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new y,this._p1Scaled=new y),this.initCorners(this._pt)}intersectsScaled(t,e){const n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>i||this._maxy<r||this._miny>o;if(s)return!1;const a=this.intersectsToleranceSquare(t,e);return p.isTrue(!(s&&a),"Found bad envelope test"),a}initCorners(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new y(this._maxx,this._maxy),this._corner[1]=new y(this._minx,this._maxy),this._corner[2]=new y(this._minx,this._miny),this._corner[3]=new y(this._maxx,this._miny)}intersects(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}scale(t){return Math.round(t*this._scaleFactor)}getCoordinate(){return this._originalPt}copyScaled(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)}getSafeEnvelope(){if(null===this._safeEnv){const t=Lr.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new L(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv}intersectsPixelClosure(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))}intersectsToleranceSquare(t,e){let n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&i||t.equals(this._pt)||e.equals(this._pt)))))}addSnappedNode(t,e){const n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)}}Lr.SAFE_ENV_EXPANSION_FACTOR=.75;class Mr{constructor(){Mr.constructor_.apply(this,arguments)}static constructor_(){this.selectedSegment=new Kt}select(){if(1===arguments.length);else if(2===arguments.length){const t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}}}class Or{constructor(){Or.constructor_.apply(this,arguments)}static constructor_(){this._index=null;const t=arguments[0];this._index=t}snap(){if(1===arguments.length){const t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=t.getSafeEnvelope(),r=new Rr(t,e,n);return this._index.query(i,new class{get interfaces_(){return[Re]}visitItem(t){t.select(i,r)}}),r.isNodeAdded()}}}class Rr extends Mr{constructor(){super(),Rr.constructor_.apply(this,arguments)}static constructor_(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;const t=arguments[0],e=arguments[1],n=arguments[2];this._hotPixel=t,this._parentEdge=e,this._hotPixelVertexIndex=n}isNodeAdded(){return this._isNodeAdded}select(){if(!(2===arguments.length&&Number.isInteger(arguments[1])&&arguments[0]instanceof Wi))return super.select.apply(this,arguments);{const t=arguments[1],e=arguments[0].getContext();if(this._parentEdge===e&&(t===this._hotPixelVertexIndex||t+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(e,t)}}}Or.HotPixelSnapAction=Rr;class Ar{constructor(){Ar.constructor_.apply(this,arguments)}static constructor_(){this._li=null,this._interiorIntersections=null;const t=arguments[0];this._li=t,this._interiorIntersections=new P}processIntersections(t,e,n,i){if(t===n&&e===i)return null;const r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(let t=0;t<this._li.getIntersectionNum();t++)this._interiorIntersections.add(this._li.getIntersection(t));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}}isDone(){return!1}getInteriorIntersections(){return this._interiorIntersections}get interfaces_(){return[Pr]}}class Dr{constructor(){Dr.constructor_.apply(this,arguments)}static constructor_(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;const t=arguments[0];this._pm=t,this._li=new Wt,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()}checkCorrectness(t){const e=Yi.getNodedSubstrings(t),i=new Tr(e);try{i.checkValid()}catch(t){if(!(t instanceof n))throw t;t.printStackTrace()}}getNodedSubstrings(){return Yi.getNodedSubstrings(this._nodedSegStrings)}snapRound(t,e){const n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)}findInteriorIntersections(t,e){const n=new Ar(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()}computeVertexSnaps(){if(C(arguments[0],w))for(let t=arguments[0].iterator();t.hasNext();){const e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof Yi){const t=arguments[0],e=t.getCoordinates();for(let n=0;n<e.length;n++){const i=new Lr(e[n],this._scaleFactor,this._li);this._pointSnapper.snap(i,t,n)&&t.addIntersection(e[n],n)}}}computeNodes(t){this._nodedSegStrings=t,this._noder=new Qi,this._pointSnapper=new Or(this._noder.getIndex()),this.snapRound(t,this._li)}computeIntersectionSnaps(t){for(let e=t.iterator();e.hasNext();){const t=e.next(),n=new Lr(t,this._scaleFactor,this._li);this._pointSnapper.snap(n)}}get interfaces_(){return[Zi]}}class Fr{constructor(){Fr.constructor_.apply(this,arguments)}static constructor_(){if(this._argGeom=null,this._distance=null,this._bufParams=new sr,this._resultGeometry=null,this._saveException=null,1===arguments.length){const t=arguments[0];this._argGeom=t}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._argGeom=t,this._bufParams=e}}static bufferOp(){if(2===arguments.length){const t=arguments[1];return new Fr(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof H&&"number"==typeof arguments[1]){const t=arguments[1],e=arguments[2],n=new Fr(arguments[0]);return n.setQuadrantSegments(e),n.getResultGeometry(t)}if(arguments[2]instanceof sr&&arguments[0]instanceof H&&"number"==typeof arguments[1]){const t=arguments[1];return new Fr(arguments[0],arguments[2]).getResultGeometry(t)}}else if(4===arguments.length){const t=arguments[1],e=arguments[2],n=arguments[3],i=new Fr(arguments[0]);return i.setQuadrantSegments(e),i.setEndCapStyle(n),i.getResultGeometry(t)}}static precisionScaleFactor(t,e,n){const i=t.getEnvelopeInternal(),r=z.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)}bufferFixedPrecision(t){const e=new tr(new Dr(new bt(1)),t.getScale()),n=new Sr(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)}bufferReducedPrecision(){if(0===arguments.length){for(let t=Fr.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(t){if(!(t instanceof ni))throw t;this._saveException=t}if(null!==this._resultGeometry)return null}throw this._saveException}if(1===arguments.length){const t=arguments[0],e=Fr.precisionScaleFactor(this._argGeom,this._distance,t),n=new bt(e);this.bufferFixedPrecision(n)}}computeGeometry(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;const t=this._argGeom.getFactory().getPrecisionModel();t.getType()===bt.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}setQuadrantSegments(t){this._bufParams.setQuadrantSegments(t)}bufferOriginalPrecision(){try{const t=new Sr(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof c))throw t;this._saveException=t}}getResultGeometry(t){return this._distance=t,this.computeGeometry(),this._resultGeometry}setEndCapStyle(t){this._bufParams.setEndCapStyle(t)}}Fr.CAP_ROUND=sr.CAP_ROUND,Fr.CAP_BUTT=sr.CAP_FLAT,Fr.CAP_FLAT=sr.CAP_FLAT,Fr.CAP_SQUARE=sr.CAP_SQUARE,Fr.MAX_PRECISION_DIGITS=12;var kr=Object.freeze({__proto__:null,BufferOp:Fr,BufferParameters:sr});class Br{constructor(){Br.constructor_.apply(this,arguments)}static constructor_(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){const t=arguments[0],e=arguments[1];Br.constructor_.call(this,t,Br.INSIDE_AREA,e)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._component=t,this._segIndex=e,this._pt=n}}getSegmentIndex(){return this._segIndex}getCoordinate(){return this._pt}isInsideArea(){return this._segIndex===Br.INSIDE_AREA}toString(){return this._component.getGeometryType()+"["+this._segIndex+"]-"+Yt.toPoint(this._pt)}getGeometryComponent(){return this._component}}Br.INSIDE_AREA=-1;class Gr{constructor(){Gr.constructor_.apply(this,arguments)}static constructor_(){this._locations=null;const t=arguments[0];this._locations=t}static getLocations(t){const e=new P;return t.apply(new Gr(e)),e}filter(t){if(t.isEmpty())return null;(t instanceof et||t instanceof $||t instanceof ot)&&this._locations.add(new Br(t,0,t.getCoordinate()))}get interfaces_(){return[Q]}}class jr{constructor(){jr.constructor_.apply(this,arguments)}static constructor_(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new yn,this._minDistanceLocation=null,this._minDistance=o.MAX_VALUE,2===arguments.length){const t=arguments[0],e=arguments[1];jr.constructor_.call(this,t,e,0)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e,this._terminateDistance=n}}static distance(t,e){return new jr(t,e).distance()}static isWithinDistance(t,e,n){return!(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>n)&&new jr(t,e,n).distance()<=n}static nearestPoints(t,e){return new jr(t,e).nearestPoints()}computeContainmentDistance(){if(0===arguments.length){const t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1],n=this._geom[t];if(n.getDimension()<2)return null;const i=1-t,r=xe.getPolygons(n);if(r.size()>0){const n=Gr.getLocations(this._geom[i]);if(this.computeContainmentDistance(n,r,e),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=e[0],this._minDistanceLocation[t]=e[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&C(arguments[0],E)&&C(arguments[1],E)){const t=arguments[0],e=arguments[1],n=arguments[2];for(let i=0;i<t.size();i++){const r=t.get(i);for(let t=0;t<e.size();t++)if(this.computeContainmentDistance(r,e.get(t),n),this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Br&&arguments[1]instanceof ot){const t=arguments[0],e=arguments[1],n=arguments[2],i=t.getCoordinate();if(Zt.EXTERIOR!==this._ptLocator.locate(i,e))return this._minDistance=0,n[0]=t,n[1]=new Br(e,i),null}}computeMinDistanceLinesPoints(t,e,n){for(let i=0;i<t.size();i++){const r=t.get(i);for(let t=0;t<e.size();t++){const i=e.get(t);if(this.computeMinDistance(r,i,n),this._minDistance<=this._terminateDistance)return null}}}computeFacetDistance(){const t=new Array(2).fill(null),e=me.getLines(this._geom[0]),n=me.getLines(this._geom[1]),i=ve.getPoints(this._geom[0]),r=ve.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))}nearestLocations(){return this.computeMinDistance(),this._minDistanceLocation}updateMinDistance(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])}nearestPoints(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]}computeMinDistance(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof $&&arguments[1]instanceof et){const t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;const i=t.getCoordinates(),r=e.getCoordinate();for(let o=0;o<i.length-1;o++){const s=U.pointToSegment(r,i[o],i[o+1]);if(s<this._minDistance){this._minDistance=s;const a=new Kt(i[o],i[o+1]).closestPoint(r);n[0]=new Br(t,o,a),n[1]=new Br(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof $&&arguments[1]instanceof $){const t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;const i=t.getCoordinates(),r=e.getCoordinates();for(let o=0;o<i.length-1;o++){const s=new L(i[o],i[o+1]);if(!(s.distance(e.getEnvelopeInternal())>this._minDistance))for(let a=0;a<r.length-1;a++){const l=new L(r[a],r[a+1]);if(s.distance(l)>this._minDistance)continue;const u=U.segmentToSegment(i[o],i[o+1],r[a],r[a+1]);if(u<this._minDistance){this._minDistance=u;const s=new Kt(i[o],i[o+1]),l=new Kt(r[a],r[a+1]),c=s.closestPoints(l);n[0]=new Br(t,o,c[0]),n[1]=new Br(e,a,c[1])}if(this._minDistance<=this._terminateDistance)return null}}}}computeMinDistancePoints(t,e,n){for(let i=0;i<t.size();i++){const r=t.get(i);for(let t=0;t<e.size();t++){const i=e.get(t),o=r.getCoordinate().distance(i.getCoordinate());if(o<this._minDistance&&(this._minDistance=o,n[0]=new Br(r,0,r.getCoordinate()),n[1]=new Br(i,0,i.getCoordinate())),this._minDistance<=this._terminateDistance)return null}}}distance(){if(null===this._geom[0]||null===this._geom[1])throw new i("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)}computeMinDistanceLines(t,e,n){for(let i=0;i<t.size();i++){const r=t.get(i);for(let t=0;t<e.size();t++){const i=e.get(t);if(this.computeMinDistance(r,i,n),this._minDistance<=this._terminateDistance)return null}}}}var zr=Object.freeze({__proto__:null,DistanceOp:jr});class Ur{constructor(){Ur.constructor_.apply(this,arguments)}static constructor_(){this._factory=null,this._directedEdges=new P,this._coordinates=null;const t=arguments[0];this._factory=t}getCoordinates(){if(null===this._coordinates){let t=0,e=0;const n=new S;for(let i=this._directedEdges.iterator();i.hasNext();){const r=i.next();r.getEdgeDirection()?t++:e++,n.add(r.getEdge().getLine().getCoordinates(),!1,r.getEdgeDirection())}this._coordinates=n.toCoordinateArray(),e>t&&dt.reverse(this._coordinates)}return this._coordinates}toLineString(){return this._factory.createLineString(this.getCoordinates())}add(t){this._directedEdges.add(t)}}class qr{constructor(){qr.constructor_.apply(this,arguments)}static constructor_(){this._isMarked=!1,this._isVisited=!1,this._data=null}static getComponentWithVisitedState(t,e){for(;t.hasNext();){const n=t.next();if(n.isVisited()===e)return n}return null}static setVisited(t,e){for(;t.hasNext();)t.next().setVisited(e)}static setMarked(t,e){for(;t.hasNext();)t.next().setMarked(e)}setVisited(t){this._isVisited=t}isMarked(){return this._isMarked}setData(t){this._data=t}getData(){return this._data}setMarked(t){this._isMarked=t}getContext(){return this._data}isVisited(){return this._isVisited}setContext(t){this._data=t}}class Vr extends qr{constructor(){super(),Vr.constructor_.apply(this,arguments)}static constructor_(){if(this._parentEdge=null,this._from=null,this._to=null,this._p0=null,this._p1=null,this._sym=null,this._edgeDirection=null,this._quadrant=null,this._angle=null,0===arguments.length);else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._from=t,this._to=e,this._edgeDirection=i,this._p0=t.getCoordinate(),this._p1=n;const r=this._p1.x-this._p0.x,o=this._p1.y-this._p0.y;this._quadrant=bn.quadrant(r,o),this._angle=Math.atan2(o,r)}}static toEdges(t){const e=new P;for(let n=t.iterator();n.hasNext();)e.add(n.next()._parentEdge);return e}isRemoved(){return null===this._parentEdge}compareDirection(t){return this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:B.index(t._p0,t._p1,this._p1)}getCoordinate(){return this._from.getCoordinate()}print(t){const e=this.getClass().getName(),n=e.lastIndexOf("."),i=e.substring(n+1);t.print("  "+i+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+this._angle)}getDirectionPt(){return this._p1}getAngle(){return this._angle}compareTo(t){const e=t;return this.compareDirection(e)}getFromNode(){return this._from}getSym(){return this._sym}setEdge(t){this._parentEdge=t}remove(){this._sym=null,this._parentEdge=null}getEdge(){return this._parentEdge}getQuadrant(){return this._quadrant}setSym(t){this._sym=t}getToNode(){return this._to}getEdgeDirection(){return this._edgeDirection}get interfaces_(){return[s]}}class Hr extends Vr{constructor(){super(),Hr.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];Vr.constructor_.call(this,t,e,n,i)}getNext(){return 2!==this.getToNode().getDegree()?null:this.getToNode().getOutEdges().getEdges().get(0)===this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(p.isTrue(this.getToNode().getOutEdges().getEdges().get(1)===this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))}}class Yr extends qr{constructor(){super(),Yr.constructor_.apply(this,arguments)}static constructor_(){if(this._dirEdge=null,0===arguments.length);else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.setDirectedEdges(t,e)}}isRemoved(){return null===this._dirEdge}setDirectedEdges(t,e){this._dirEdge=[t,e],t.setEdge(this),e.setEdge(this),t.setSym(e),e.setSym(t),t.getFromNode().addOutEdge(t),e.getFromNode().addOutEdge(e)}getDirEdge(){if(Number.isInteger(arguments[0])){const t=arguments[0];return this._dirEdge[t]}if(arguments[0]instanceof Wr){const t=arguments[0];return this._dirEdge[0].getFromNode()===t?this._dirEdge[0]:this._dirEdge[1].getFromNode()===t?this._dirEdge[1]:null}}remove(){this._dirEdge=null}getOppositeNode(t){return this._dirEdge[0].getFromNode()===t?this._dirEdge[0].getToNode():this._dirEdge[1].getFromNode()===t?this._dirEdge[1].getToNode():null}}class Xr{constructor(){Xr.constructor_.apply(this,arguments)}static constructor_(){this._outEdges=new P,this._sorted=!1}getNextEdge(t){const e=this.getIndex(t);return this._outEdges.get(this.getIndex(e+1))}getCoordinate(){const t=this.iterator();return t.hasNext()?t.next().getCoordinate():null}iterator(){return this.sortEdges(),this._outEdges.iterator()}sortEdges(){this._sorted||(_e.sort(this._outEdges),this._sorted=!0)}remove(t){this._outEdges.remove(t)}getEdges(){return this.sortEdges(),this._outEdges}getNextCWEdge(t){const e=this.getIndex(t);return this._outEdges.get(this.getIndex(e-1))}getIndex(){if(arguments[0]instanceof Yr){const t=arguments[0];this.sortEdges();for(let e=0;e<this._outEdges.size();e++)if(this._outEdges.get(e).getEdge()===t)return e;return-1}if(arguments[0]instanceof Vr){const t=arguments[0];this.sortEdges();for(let e=0;e<this._outEdges.size();e++)if(this._outEdges.get(e)===t)return e;return-1}if(Number.isInteger(arguments[0])){let t=arguments[0]%this._outEdges.size();return t<0&&(t+=this._outEdges.size()),t}}add(t){this._outEdges.add(t),this._sorted=!1}getDegree(){return this._outEdges.size()}}class Wr extends qr{constructor(){super(),Wr.constructor_.apply(this,arguments)}static constructor_(){if(this._pt=null,this._deStar=null,1===arguments.length){const t=arguments[0];Wr.constructor_.call(this,t,new Xr)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._pt=t,this._deStar=e}}static getEdgesBetween(t,e){const n=Vr.toEdges(t.getOutEdges().getEdges()),i=new xt(n),r=Vr.toEdges(e.getOutEdges().getEdges());return i.retainAll(r),i}isRemoved(){return null===this._pt}addOutEdge(t){this._deStar.add(t)}getCoordinate(){return this._pt}getOutEdges(){return this._deStar}remove(){if(0===arguments.length)this._pt=null;else if(1===arguments.length){const t=arguments[0];this._deStar.remove(t)}}getIndex(t){return this._deStar.getIndex(t)}getDegree(){return this._deStar.getDegree()}}class Kr extends Yr{constructor(){super(),Kr.constructor_.apply(this,arguments)}static constructor_(){this._line=null;const t=arguments[0];this._line=t}getLine(){return this._line}}class Zr{constructor(){Zr.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new Hn}find(t){return this._nodeMap.get(t)}iterator(){return this._nodeMap.values().iterator()}remove(t){return this._nodeMap.remove(t)}values(){return this._nodeMap.values()}add(t){return this._nodeMap.put(t.getCoordinate(),t),t}}class Jr{constructor(){Jr.constructor_.apply(this,arguments)}static constructor_(){this._edges=new xt,this._dirEdges=new xt,this._nodeMap=new Zr}findNodesOfDegree(t){const e=new P;for(let n=this.nodeIterator();n.hasNext();){const i=n.next();i.getDegree()===t&&e.add(i)}return e}dirEdgeIterator(){return this._dirEdges.iterator()}edgeIterator(){return this._edges.iterator()}remove(){if(arguments[0]instanceof Yr){const t=arguments[0];this.remove(t.getDirEdge(0)),this.remove(t.getDirEdge(1)),this._edges.remove(t),t.remove()}else if(arguments[0]instanceof Vr){const t=arguments[0],e=t.getSym();null!==e&&e.setSym(null),t.getFromNode().remove(t),t.remove(),this._dirEdges.remove(t)}else if(arguments[0]instanceof Wr){const t=arguments[0];for(let e=t.getOutEdges().getEdges().iterator();e.hasNext();){const t=e.next(),n=t.getSym();null!==n&&this.remove(n),this._dirEdges.remove(t);const i=t.getEdge();null!==i&&this._edges.remove(i)}this._nodeMap.remove(t.getCoordinate()),t.remove()}}findNode(t){return this._nodeMap.find(t)}getEdges(){return this._edges}nodeIterator(){return this._nodeMap.iterator()}contains(){if(arguments[0]instanceof Yr){const t=arguments[0];return this._edges.contains(t)}if(arguments[0]instanceof Vr){const t=arguments[0];return this._dirEdges.contains(t)}}add(){if(arguments[0]instanceof Wr){const t=arguments[0];this._nodeMap.add(t)}else if(arguments[0]instanceof Yr){const t=arguments[0];this._edges.add(t),this.add(t.getDirEdge(0)),this.add(t.getDirEdge(1))}else if(arguments[0]instanceof Vr){const t=arguments[0];this._dirEdges.add(t)}}getNodes(){return this._nodeMap.values()}}class Qr extends Jr{constructor(){super()}addEdge(t){if(t.isEmpty())return null;const e=dt.removeRepeatedPoints(t.getCoordinates());if(e.length<=1)return null;const n=e[0],i=e[e.length-1],r=this.getNode(n),o=this.getNode(i),s=new Hr(r,o,e[1],!0),a=new Hr(o,r,e[e.length-2],!1),l=new Kr(t);l.setDirectedEdges(s,a),this.add(l)}getNode(t){let e=this.findNode(t);return null===e&&(e=new Wr(t),this.add(e)),e}}class $r{constructor(){$r.constructor_.apply(this,arguments)}static constructor_(){this._graph=new Qr,this._mergedLineStrings=null,this._factory=null,this._edgeStrings=null}buildEdgeStringsForUnprocessedNodes(){for(let t=this._graph.getNodes().iterator();t.hasNext();){const e=t.next();e.isMarked()||(p.isTrue(2===e.getDegree()),this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}}buildEdgeStringsForNonDegree2Nodes(){for(let t=this._graph.getNodes().iterator();t.hasNext();){const e=t.next();2!==e.getDegree()&&(this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}}buildEdgeStringsForObviousStartNodes(){this.buildEdgeStringsForNonDegree2Nodes()}getMergedLineStrings(){return this.merge(),this._mergedLineStrings}buildEdgeStringsStartingAt(t){for(let e=t.getOutEdges().iterator();e.hasNext();){const t=e.next();t.getEdge().isMarked()||this._edgeStrings.add(this.buildEdgeStringStartingWith(t))}}merge(){if(null!==this._mergedLineStrings)return null;qr.setMarked(this._graph.nodeIterator(),!1),qr.setMarked(this._graph.edgeIterator(),!1),this._edgeStrings=new P,this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this._mergedLineStrings=new P;for(let t=this._edgeStrings.iterator();t.hasNext();){const e=t.next();this._mergedLineStrings.add(e.toLineString())}}addLineString(t){null===this._factory&&(this._factory=t.getFactory()),this._graph.addEdge(t)}buildEdgeStringStartingWith(t){const e=new Ur(this._factory);let n=t;do{e.add(n),n.getEdge().setMarked(!0),n=n.getNext()}while(null!==n&&n!==t);return e}add(){if(arguments[0]instanceof H){const t=arguments[0];for(let e=0;e<t.getNumGeometries();e++){const n=t.getGeometryN(e);n instanceof $&&this.addLineString(n)}}else if(C(arguments[0],w)){const t=arguments[0];this._mergedLineStrings=null;for(let e=t.iterator();e.hasNext();){const t=e.next();this.add(t)}}}buildEdgeStringsForIsolatedLoops(){this.buildEdgeStringsForUnprocessedNodes()}}class to{constructor(){to.constructor_.apply(this,arguments)}static constructor_(){this._parentGraph=null,this._edges=new xt,this._dirEdges=new P,this._nodeMap=new Zr;const t=arguments[0];this._parentGraph=t}dirEdgeIterator(){return this._dirEdges.iterator()}edgeIterator(){return this._edges.iterator()}getParent(){return this._parentGraph}nodeIterator(){return this._nodeMap.iterator()}contains(t){return this._edges.contains(t)}add(t){if(this._edges.contains(t))return null;this._edges.add(t),this._dirEdges.add(t.getDirEdge(0)),this._dirEdges.add(t.getDirEdge(1)),this._nodeMap.add(t.getDirEdge(0).getFromNode()),this._nodeMap.add(t.getDirEdge(1).getFromNode())}}class eo{constructor(){eo.constructor_.apply(this,arguments)}static constructor_(){this._graph=null;const t=arguments[0];this._graph=t}addReachable(t,e){const n=new tn;for(n.add(t);!n.empty();){const t=n.pop();this.addEdges(t,n,e)}}findSubgraph(t){const e=new to(this._graph);return this.addReachable(t,e),e}getConnectedSubgraphs(){const t=new P;qr.setVisited(this._graph.nodeIterator(),!1);for(let e=this._graph.edgeIterator();e.hasNext();){const n=e.next().getDirEdge(0).getFromNode();n.isVisited()||t.add(this.findSubgraph(n))}return t}addEdges(t,e,n){t.setVisited(!0);for(let i=t.getOutEdges().iterator();i.hasNext();){const t=i.next();n.add(t.getEdge());const r=t.getToNode();r.isVisited()||e.push(r)}}}class no{constructor(){no.constructor_.apply(this,arguments)}static constructor_(){this._graph=new Qr,this._factory=new Pt,this._lineCount=0,this._isRun=!1,this._sequencedGeometry=null,this._isSequenceable=!1}static findUnvisitedBestOrientedDE(t){let e=null,n=null;for(let i=t.getOutEdges().iterator();i.hasNext();){const t=i.next();t.getEdge().isVisited()||(n=t,t.getEdgeDirection()&&(e=t))}return null!==e?e:n}static findLowestDegreeNode(t){let e=O.MAX_VALUE,n=null;for(let i=t.nodeIterator();i.hasNext();){const t=i.next();(null===n||t.getDegree()<e)&&(e=t.getDegree(),n=t)}return n}static isSequenced(t){if(!(t instanceof It))return!0;const e=t,n=new lt;let i=null;const r=new P;for(let t=0;t<e.getNumGeometries();t++){const o=e.getGeometryN(t),s=o.getCoordinateN(0),a=o.getCoordinateN(o.getNumPoints()-1);if(n.contains(s))return!1;if(n.contains(a))return!1;null!==i&&(s.equals(i)||(n.addAll(r),r.clear())),r.add(s),r.add(a),i=a}return!0}static reverse(t){const e=t.getCoordinates(),n=new Array(e.length).fill(null),i=e.length;for(let t=0;t<i;t++)n[i-1-t]=new y(e[t]);return t.getFactory().createLineString(n)}static sequence(t){const e=new no;return e.add(t),e.getSequencedLineStrings()}addLine(t){null===this._factory&&(this._factory=t.getFactory()),this._graph.addEdge(t),this._lineCount++}hasSequence(t){let e=0;for(let n=t.nodeIterator();n.hasNext();)n.next().getDegree()%2==1&&e++;return e<=2}computeSequence(){if(this._isRun)return null;this._isRun=!0;const t=this.findSequences();if(null===t)return null;this._sequencedGeometry=this.buildSequencedGeometry(t),this._isSequenceable=!0;const e=this._sequencedGeometry.getNumGeometries();p.isTrue(this._lineCount===e,"Lines were missing from result"),p.isTrue(this._sequencedGeometry instanceof $||this._sequencedGeometry instanceof It,"Result is not lineal")}findSequences(){const t=new P;for(let e=new eo(this._graph).getConnectedSubgraphs().iterator();e.hasNext();){const n=e.next();if(!this.hasSequence(n))return null;{const e=this.findSequence(n);t.add(e)}}return t}addReverseSubpath(t,e,n){const i=t.getToNode();let r=null;for(;;){e.add(t.getSym()),t.getEdge().setVisited(!0),r=t.getFromNode();const n=no.findUnvisitedBestOrientedDE(r);if(null===n)break;t=n.getSym()}n&&p.isTrue(r===i,"path not contiguous")}findSequence(t){qr.setVisited(t.edgeIterator(),!1);const e=no.findLowestDegreeNode(t).getOutEdges().iterator().next().getSym(),n=new lr,i=n.listIterator();for(this.addReverseSubpath(e,i,!1);i.hasPrevious();){const t=i.previous(),e=no.findUnvisitedBestOrientedDE(t.getFromNode());null!==e&&this.addReverseSubpath(e.getSym(),i,!0)}return this.orient(n)}reverse(t){const e=new lr;for(let n=t.iterator();n.hasNext();){const t=n.next();e.addFirst(t.getSym())}return e}orient(t){const e=t.get(0),n=t.get(t.size()-1),i=e.getFromNode(),r=n.getToNode();let o=!1;if(1===i.getDegree()||1===r.getDegree()){let t=!1;1===n.getToNode().getDegree()&&!1===n.getEdgeDirection()&&(t=!0,o=!0),1===e.getFromNode().getDegree()&&!0===e.getEdgeDirection()&&(t=!0,o=!1),t||1===e.getFromNode().getDegree()&&(o=!0)}return o?this.reverse(t):t}buildSequencedGeometry(t){const e=new P;for(let n=t.iterator();n.hasNext();)for(let t=n.next().iterator();t.hasNext();){const n=t.next(),i=n.getEdge().getLine();let r=i;n.getEdgeDirection()||i.isClosed()||(r=no.reverse(i)),e.add(r)}return 0===e.size()?this._factory.createMultiLineString(new Array(0).fill(null)):this._factory.buildGeometry(e)}getSequencedLineStrings(){return this.computeSequence(),this._sequencedGeometry}isSequenceable(){return this.computeSequence(),this._isSequenceable}add(){if(C(arguments[0],w))for(let t=arguments[0].iterator();t.hasNext();){const e=t.next();this.add(e)}else arguments[0]instanceof H&&arguments[0].apply(new class{get interfaces_(){return[V]}filter(t){t instanceof $&&this.addLine(t)}})}}var io=Object.freeze({__proto__:null,LineMerger:$r,LineSequencer:no});class ro{constructor(){ro.constructor_.apply(this,arguments)}static constructor_(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Kt,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof $&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];ro.constructor_.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];this._srcPts=t,this._isClosed=ro.isClosed(t),this._snapTolerance=e}}static isClosed(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])}snapVertices(t,e){const n=this._isClosed?t.size()-1:t.size();for(let i=0;i<n;i++){const n=t.get(i),r=this.findSnapForVertex(n,e);null!==r&&(t.set(i,new y(r)),0===i&&this._isClosed&&t.set(t.size()-1,new y(r)))}}findSnapForVertex(t,e){for(let n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null}snapTo(t){const e=new S(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()}snapSegments(t,e){if(0===e.length)return null;let n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(let i=0;i<n;i++){const n=e[i],r=this.findSegmentIndexToSnap(n,t);r>=0&&t.add(r+1,new y(n),!1)}}findSegmentIndexToSnap(t,e){let n=o.MAX_VALUE,i=-1;for(let r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}const o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,i=r)}return i}setAllowSnappingToSourceVertices(t){this._allowSnappingToSourceVertices=t}}class oo{constructor(){oo.constructor_.apply(this,arguments)}static constructor_(){this._srcGeom=null;const t=arguments[0];this._srcGeom=t}static snap(t,e,n){const i=new Array(2).fill(null),r=new oo(t);i[0]=r.snapTo(e,n);const o=new oo(e);return i[1]=o.snapTo(i[0],n),i}static computeOverlaySnapTolerance(){if(1===arguments.length){const t=arguments[0];let e=oo.computeSizeBasedSnapTolerance(t);const n=t.getPrecisionModel();if(n.getType()===bt.FIXED){const t=1/n.getScale()*2/1.415;t>e&&(e=t)}return e}if(2===arguments.length){const t=arguments[0],e=arguments[1];return Math.min(oo.computeOverlaySnapTolerance(t),oo.computeOverlaySnapTolerance(e))}}static computeSizeBasedSnapTolerance(t){const e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*oo.SNAP_PRECISION_FACTOR}static snapToSelf(t,e,n){return new oo(t).snapToSelf(e,n)}snapTo(t,e){const n=this.extractTargetCoordinates(t);return new so(e,n).transform(this._srcGeom)}snapToSelf(t,e){const n=this.extractTargetCoordinates(this._srcGeom),i=new so(t,n,!0).transform(this._srcGeom);let r=i;return e&&C(r,rt)&&(r=i.buffer(0)),r}computeSnapTolerance(t){return this.computeMinimumSegmentLength(t)/10}extractTargetCoordinates(t){const e=new lt,n=t.getCoordinates();for(let t=0;t<n.length;t++)e.add(n[t]);return e.toArray(new Array(0).fill(null))}computeMinimumSegmentLength(t){let e=o.MAX_VALUE;for(let n=0;n<t.length-1;n++){const i=t[n].distance(t[n+1]);i<e&&(e=i)}return e}}oo.SNAP_PRECISION_FACTOR=1e-9;class so extends ge{constructor(){super(),so.constructor_.apply(this,arguments)}static constructor_(){if(this._snapTolerance=null,this._snapPts=null,this._isSelfSnap=!1,2===arguments.length){const t=arguments[0],e=arguments[1];this._snapTolerance=t,this._snapPts=e}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._snapTolerance=t,this._snapPts=e,this._isSelfSnap=n}}snapLine(t,e){const n=new ro(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)}transformCoordinates(t,e){const n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)}}var ao=Object.freeze({__proto__:null,GeometrySnapper:oo,LineStringSnapper:ro});class lo{constructor(){lo.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._data=null;const t=arguments[0],e=arguments[1];this._pts=t,this._data=e}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(t){return this._pts[t]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(t){return t===this._pts.length-1?-1:qi.octant(this.getCoordinate(t),this.getCoordinate(t+1))}setData(t){this._data=t}getData(){return this._data}toString(){return Yt.toLineString(new yt(this._pts))}get interfaces_(){return[Vi]}}class uo{constructor(){uo.constructor_.apply(this,arguments)}static constructor_(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._keepIntersections=!0,this._isInteriorIntersectionsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new P,this._intersectionCount=0;const t=arguments[0];this._li=t,this._interiorIntersection=null}static createAllIntersectionsFinder(t){const e=new uo(t);return e.setFindAllIntersections(!0),e}static isInteriorVertexIntersection(){if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[3];return!(arguments[2]&&n||!t.equals2D(e))}if(8===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],o=arguments[5],s=arguments[6],a=arguments[7];return!!(uo.isInteriorVertexIntersection(t,n,r,s)||uo.isInteriorVertexIntersection(t,i,r,a)||uo.isInteriorVertexIntersection(e,n,o,s)||uo.isInteriorVertexIntersection(e,i,o,a))}}static createInteriorIntersectionCounter(t){const e=new uo(t);return e.setInteriorIntersectionsOnly(!0),e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e}static createIntersectionCounter(t){const e=new uo(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e}static isEndSegment(t,e){return 0===e||e>=t.size()-2}static createAnyIntersectionFinder(t){return new uo(t)}static createInteriorIntersectionsFinder(t){const e=new uo(t);return e.setFindAllIntersections(!0),e.setInteriorIntersectionsOnly(!0),e}setCheckEndSegmentsOnly(t){this._isCheckEndSegmentsOnly=t}getIntersectionSegments(){return this._intSegments}count(){return this._intersectionCount}getIntersections(){return this._intersections}setFindAllIntersections(t){this._findAllIntersections=t}setKeepIntersections(t){this._keepIntersections=t}getIntersection(){return this._interiorIntersection}processIntersections(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;const r=t===n;if(r&&e===i)return null;if(this._isCheckEndSegmentsOnly&&!uo.isEndSegment(t,e)&&!uo.isEndSegment(n,i))return null;const o=t.getCoordinate(e),s=t.getCoordinate(e+1),a=n.getCoordinate(i),l=n.getCoordinate(i+1),u=0===e,c=e+2===t.size(),h=0===i,p=i+2===n.size();this._li.computeIntersection(o,s,a,l);const f=this._li.hasIntersection()&&this._li.isInteriorIntersection();let d=!1;this._isInteriorIntersectionsOnly||(d=!(r&&Math.abs(i-e)<=1)&&uo.isInteriorVertexIntersection(o,s,a,l,u,c,h,p)),(f||d)&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=o,this._intSegments[1]=s,this._intSegments[2]=a,this._intSegments[3]=l,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)}hasIntersection(){return null!==this._interiorIntersection}isDone(){return!this._findAllIntersections&&null!==this._interiorIntersection}setInteriorIntersectionsOnly(t){this._isInteriorIntersectionsOnly=t}get interfaces_(){return[Pr]}}class co{constructor(){co.constructor_.apply(this,arguments)}static constructor_(){this._li=new Wt,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;const t=arguments[0];this._segStrings=t}static computeIntersections(t){const e=new co(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()}execute(){if(null!==this._segInt)return null;this.checkInteriorIntersections()}getIntersections(){return this._segInt.getIntersections()}isValid(){return this.execute(),this._isValid}setFindAllIntersections(t){this._findAllIntersections=t}checkInteriorIntersections(){this._isValid=!0,this._segInt=new uo(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);const t=new Qi;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null}checkValid(){if(this.execute(),!this._isValid)throw new ni(this.getErrorMessage(),this._segInt.getIntersection())}getErrorMessage(){if(this._isValid)return"no intersections found";const t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Yt.toLineString(t[0],t[1])+" and "+Yt.toLineString(t[2],t[3])}}class ho{constructor(){ho.constructor_.apply(this,arguments)}static constructor_(){this._nv=null;const t=arguments[0];this._nv=new co(ho.toSegmentStrings(t))}static toSegmentStrings(t){const e=new P;for(let n=t.iterator();n.hasNext();){const t=n.next();e.add(new lo(t.getCoordinates(),t))}return e}static checkValid(t){new ho(t).checkValid()}checkValid(){this._nv.checkValid()}}class po{constructor(){po.constructor_.apply(this,arguments)}static constructor_(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new P,this._resultLineList=new P;const t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n}collectLines(t){for(let e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){const n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}}labelIsolatedLine(t,e){const n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)}build(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList}collectLineEdge(t,e,n){const i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!wo.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))}findCoveredLineEdges(){for(let t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(let t=this._op.getGraph().getEdgeEnds().iterator();t.hasNext();){const e=t.next(),n=e.getEdge();if(e.isLineEdge()&&!n.isCoveredSet()){const t=this._op.isCoveredByA(e.getCoordinate());n.setCovered(t)}}}labelIsolatedLines(t){for(let e=t.iterator();e.hasNext();){const t=e.next(),n=t.getLabel();t.isIsolated()&&(n.isNull(0)?this.labelIsolatedLine(t,0):this.labelIsolatedLine(t,1))}}buildLines(t){for(let t=this._lineEdgesList.iterator();t.hasNext();){const e=t.next(),n=this._geometryFactory.createLineString(e.getCoordinates());this._resultLineList.add(n),e.setInResult(!0)}}collectBoundaryTouchEdge(t,e,n){const i=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(p.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(wo.isResultOfOp(i,e)&&e===wo.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))}}class fo{constructor(){fo.constructor_.apply(this,arguments)}static constructor_(){this._op=null,this._geometryFactory=null,this._resultPointList=new P;const t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e}filterCoveredNodeToPoint(t){const e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){const t=this._geometryFactory.createPoint(e);this._resultPointList.add(t)}}extractNonCoveredResultNodes(t){for(let e=this._op.getGraph().getNodes().iterator();e.hasNext();){const n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==wo.INTERSECTION)){const e=n.getLabel();wo.isResultOfOp(e,t)&&this.filterCoveredNodeToPoint(n)}}}build(t){return this.extractNonCoveredResultNodes(t),this._resultPointList}}class go{constructor(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=new r,this._commonSignExp=null}getCommon(){return o.longBitsToDouble(this._commonBits)}add(t){const e=o.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=go.signExpBits(this._commonBits),this._isFirst=!1,null):go.signExpBits(e)!==this._commonSignExp?(this._commonBits.high=0,this._commonBits.low=0,null):(this._commonMantissaBitsCount=go.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=go.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))}toString(){if(1===arguments.length){const t=arguments[0],e=o.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+r.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}}getClass(){return go}get interfaces_(){return[]}static getBit(t,e){const n=1<<e%32;return e<32?0!=(t.low&n)?1:0:0!=(t.high&n)?1:0}static signExpBits(t){return t.high>>>20}static zeroLowerBits(t,e){let n="low";if(e>32&&(t.low=0,e%=32,n="high"),e>0){const i=e<32?~((1<<e)-1):0;t[n]&=i}return t}static numCommonMostSigMantissaBits(t,e){let n=0;for(let i=52;i>=0;i--){if(go.getBit(t,i)!==go.getBit(e,i))return n;n++}return 52}}class yo{constructor(){yo.constructor_.apply(this,arguments)}static constructor_(){this._commonCoord=null,this._ccFilter=new mo}addCommonBits(t){const e=new _o(this._commonCoord);t.apply(e),t.geometryChanged()}removeCommonBits(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;const e=new y(this._commonCoord);e.x=-e.x,e.y=-e.y;const n=new _o(e);return t.apply(n),t.geometryChanged(),t}getCommonCoordinate(){return this._commonCoord}add(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()}}class mo{constructor(){mo.constructor_.apply(this,arguments)}static constructor_(){this._commonBitsX=new go,this._commonBitsY=new go}filter(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)}getCommonCoordinate(){return new y(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())}get interfaces_(){return[Y]}}class _o{constructor(){_o.constructor_.apply(this,arguments)}static constructor_(){this.trans=null;const t=arguments[0];this.trans=t}filter(t,e){const n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)}isDone(){return!1}isGeometryChanged(){return!0}get interfaces_(){return[T]}}yo.CommonCoordinateFilter=mo,yo.Translater=_o;class vo{constructor(){vo.constructor_.apply(this,arguments)}static constructor_(){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null;const t=arguments[0],e=arguments[1];this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()}static overlayOp(t,e,n){return new vo(t,e).getResultGeometry(n)}static union(t,e){return vo.overlayOp(t,e,wo.UNION)}static intersection(t,e){return vo.overlayOp(t,e,wo.INTERSECTION)}static symDifference(t,e){return vo.overlayOp(t,e,wo.SYMDIFFERENCE)}static difference(t,e){return vo.overlayOp(t,e,wo.DIFFERENCE)}selfSnap(t){return new oo(t).snapTo(t,this._snapTolerance)}removeCommonBits(t){this._cbr=new yo,this._cbr.add(t[0]),this._cbr.add(t[1]);const e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e}prepareResult(t){return this._cbr.addCommonBits(t),t}getResultGeometry(t){const e=this.snap(this._geom),n=wo.overlayOp(e[0],e[1],t);return this.prepareResult(n)}checkValid(t){t.isValid()||j.out.println("Snapped geometry is invalid")}computeSnapTolerance(){this._snapTolerance=oo.computeOverlaySnapTolerance(this._geom[0],this._geom[1])}snap(t){const e=this.removeCommonBits(t);return oo.snap(e[0],e[1],this._snapTolerance)}}class xo{constructor(){xo.constructor_.apply(this,arguments)}static constructor_(){this._geom=new Array(2).fill(null);const t=arguments[0],e=arguments[1];this._geom[0]=t,this._geom[1]=e}static overlayOp(t,e,n){return new xo(t,e).getResultGeometry(n)}static union(t,e){return xo.overlayOp(t,e,wo.UNION)}static intersection(t,e){return xo.overlayOp(t,e,wo.INTERSECTION)}static symDifference(t,e){return xo.overlayOp(t,e,wo.SYMDIFFERENCE)}static difference(t,e){return xo.overlayOp(t,e,wo.DIFFERENCE)}getResultGeometry(t){let e=null,n=!1,i=null;try{e=wo.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof c))throw t;i=t}if(!n)try{e=vo.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof c?i:t}return e}}class Co{constructor(){Co.constructor_.apply(this,arguments)}static constructor_(){if(this._li=new Wt,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){const t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new si(0,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];Co.constructor_.call(this,t,e,hn.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];t.getPrecisionModel().compareTo(e.getPrecisionModel())>=0?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new si(0,t,n),this._arg[1]=new si(1,e,n)}}getArgGeometry(t){return this._arg[t].getGeometry()}setComputationPrecision(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)}}class wo extends Co{constructor(){super(),wo.constructor_.apply(this,arguments)}static constructor_(){this._ptLocator=new yn,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Ir,this._resultPolyList=new P,this._resultLineList=new P,this._resultPointList=new P;const t=arguments[0],e=arguments[1];Co.constructor_.call(this,t,e),this._graph=new oi(new br),this._geomFact=t.getFactory()}static overlayOp(t,e,n){return new wo(t,e).getResultGeometry(n)}static union(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return wo.createEmptyResult(wo.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}if(t.isGeometryCollection()||e.isGeometryCollection())throw new i("This method does not support GeometryCollection arguments");return xo.overlayOp(t,e,wo.UNION)}static intersection(t,e){if(t.isEmpty()||e.isEmpty())return wo.createEmptyResult(wo.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){const n=e;return le.map(t,new class{get interfaces_(){return[MapOp]}map(t){return wo.intersection(t,n)}})}return xo.overlayOp(t,e,wo.INTERSECTION)}static symDifference(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return wo.createEmptyResult(wo.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}if(t.isGeometryCollection()||e.isGeometryCollection())throw new i("This method does not support GeometryCollection arguments");return xo.overlayOp(t,e,wo.SYMDIFFERENCE)}static resultDimension(t,e,n){const i=e.getDimension(),r=n.getDimension();let o=-1;switch(t){case wo.INTERSECTION:o=Math.min(i,r);break;case wo.UNION:o=Math.max(i,r);break;case wo.DIFFERENCE:o=i;break;case wo.SYMDIFFERENCE:o=Math.max(i,r)}return o}static createEmptyResult(t,e,n,i){const r=wo.resultDimension(t,e,n);return i.createEmpty(r)}static difference(t,e){if(t.isEmpty())return wo.createEmptyResult(wo.DIFFERENCE,t,e,t.getFactory());if(e.isEmpty())return t.copy();if(t.isGeometryCollection()||e.isGeometryCollection())throw new i("This method does not support GeometryCollection arguments");return xo.overlayOp(t,e,wo.DIFFERENCE)}static isResultOfOp(){if(2===arguments.length){const t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return wo.isResultOfOp(n,i,e)}if(3===arguments.length){let t=arguments[0],e=arguments[1],n=arguments[2];switch(t===Zt.BOUNDARY&&(t=Zt.INTERIOR),e===Zt.BOUNDARY&&(e=Zt.INTERIOR),n){case wo.INTERSECTION:return t===Zt.INTERIOR&&e===Zt.INTERIOR;case wo.UNION:return t===Zt.INTERIOR||e===Zt.INTERIOR;case wo.DIFFERENCE:return t===Zt.INTERIOR&&e!==Zt.INTERIOR;case wo.SYMDIFFERENCE:return t===Zt.INTERIOR&&e!==Zt.INTERIOR||t!==Zt.INTERIOR&&e===Zt.INTERIOR}return!1}}insertUniqueEdge(t){const e=this._edgeList.findEqualEdge(t);if(null!==e){const n=e.getLabel();let i=t.getLabel();e.isPointwiseEqual(t)||(i=new kn(t.getLabel()),i.flip());const r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)}getGraph(){return this._graph}cancelDuplicateResultEdges(){for(let t=this._graph.getEdgeEnds().iterator();t.hasNext();){const e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}}isCoveredByLA(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)}computeGeometry(t,e,n,i){const r=new P;return r.addAll(t),r.addAll(e),r.addAll(n),r.isEmpty()?wo.createEmptyResult(i,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(r)}mergeSymLabels(){for(let t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()}isCovered(t,e){for(let n=e.iterator();n.hasNext();){const e=n.next();if(this._ptLocator.locate(t,e)!==Zt.EXTERIOR)return!0}return!1}replaceCollapsedEdges(){const t=new P;for(let e=this._edgeList.iterator();e.hasNext();){const n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)}updateNodeLabelling(){for(let t=this._graph.getNodes().iterator();t.hasNext();){const e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}}getResultGeometry(t){return this.computeOverlay(t),this._resultGeom}insertUniqueEdges(t){for(let e=t.iterator();e.hasNext();){const t=e.next();this.insertUniqueEdge(t)}}computeOverlay(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);const e=new P;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),ho.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();const n=new fr(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();const i=new po(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);const r=new fo(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)}labelIncompleteNode(t,e){const n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)}copyPoints(t){for(let e=this._arg[t].getNodeIterator();e.hasNext();){const n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}}findResultAreaEdges(t){for(let e=this._graph.getEdgeEnds().iterator();e.hasNext();){const n=e.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&wo.isResultOfOp(i.getLocation(0,Mn.RIGHT),i.getLocation(1,Mn.RIGHT),t)&&n.setInResult(!0)}}computeLabelsFromDepths(){for(let t=this._edgeList.iterator();t.hasNext();){const e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(let t=0;t<2;t++)n.isNull(t)||!n.isArea()||i.isNull(t)||(0===i.getDelta(t)?n.toLine(t):(p.isTrue(!i.isNull(t,Mn.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(t,Mn.LEFT,i.getLocation(t,Mn.LEFT)),p.isTrue(!i.isNull(t,Mn.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(t,Mn.RIGHT,i.getLocation(t,Mn.RIGHT))))}}}computeLabelling(){for(let t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()}labelIncompleteNodes(){for(let t=this._graph.getNodes().iterator();t.hasNext();){const e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}}isCoveredByA(t){return!!this.isCovered(t,this._resultPolyList)}}wo.INTERSECTION=1,wo.UNION=2,wo.DIFFERENCE=3,wo.SYMDIFFERENCE=4;var bo=Object.freeze({__proto__:null,snap:ao,OverlayOp:wo});class Eo extends Vr{constructor(){super(),Eo.constructor_.apply(this,arguments)}static constructor_(){this._edgeRing=null,this._next=null,this._label=-1;const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];Vr.constructor_.call(this,t,e,n,i)}getNext(){return this._next}isInRing(){return null!==this._edgeRing}setRing(t){this._edgeRing=t}setLabel(t){this._label=t}getLabel(){return this._label}setNext(t){this._next=t}getRing(){return this._edgeRing}}class Io extends Yr{constructor(){super(),Io.constructor_.apply(this,arguments)}static constructor_(){this._line=null;const t=arguments[0];this._line=t}getLine(){return this._line}}class Po{constructor(){Po.constructor_.apply(this,arguments)}static constructor_(){this._geometryFactory=new Pt,this._geomGraph=null,this._disconnectedRingcoord=null;const t=arguments[0];this._geomGraph=t}static findDifferentPoint(t,e){for(let n=0;n<t.length;n++)if(!t[n].equals(e))return t[n];return null}visitInteriorRing(t,e){if(t.isEmpty())return null;const n=t.getCoordinates(),i=n[0],r=Po.findDifferentPoint(n,i),o=e.findEdgeInSameDirection(i,r),s=e.findEdgeEnd(o);let a=null;s.getLabel().getLocation(0,Mn.RIGHT)===Zt.INTERIOR?a=s:s.getSym().getLabel().getLocation(0,Mn.RIGHT)===Zt.INTERIOR&&(a=s.getSym()),p.isTrue(null!==a,"unable to find dirEdge with Interior on RHS"),this.visitLinkedDirectedEdges(a)}visitShellInteriors(t,e){if(t instanceof ot){const n=t;this.visitInteriorRing(n.getExteriorRing(),e)}if(t instanceof _t){const n=t;for(let t=0;t<n.getNumGeometries();t++){const i=n.getGeometryN(t);this.visitInteriorRing(i.getExteriorRing(),e)}}}getCoordinate(){return this._disconnectedRingcoord}setInteriorEdgesInResult(t){for(let e=t.getEdgeEnds().iterator();e.hasNext();){const t=e.next();t.getLabel().getLocation(0,Mn.RIGHT)===Zt.INTERIOR&&t.setInResult(!0)}}visitLinkedDirectedEdges(t){const e=t;let n=t;do{p.isTrue(null!==n,"found null Directed Edge"),n.setVisited(!0),n=n.getNext()}while(n!==e)}buildEdgeRings(t){const e=new P;for(let n=t.iterator();n.hasNext();){const t=n.next();if(t.isInResult()&&null===t.getEdgeRing()){const n=new pr(t,this._geometryFactory);n.linkDirectedEdgesForMinimalEdgeRings();const i=n.buildMinimalRings();e.addAll(i)}}return e}hasUnvisitedShellEdge(t){for(let e=0;e<t.size();e++){const n=t.get(e);if(n.isHole())continue;const i=n.getEdges();let r=i.get(0);if(r.getLabel().getLocation(0,Mn.RIGHT)===Zt.INTERIOR)for(let t=0;t<i.size();t++)if(r=i.get(t),!r.isVisited())return this._disconnectedRingcoord=r.getCoordinate(),!0}return!1}isInteriorsConnected(){const t=new P;this._geomGraph.computeSplitEdges(t);const e=new oi(new br);e.addEdges(t),this.setInteriorEdgesInResult(e),e.linkResultDirectedEdges();const n=this.buildEdgeRings(e.getEdgeEnds());return this.visitShellInteriors(this._geomGraph.getGeometry(),e),!this.hasUnvisitedShellEdge(n)}}class No{createEdgeEndForNext(t,e,n,i){const r=n.segmentIndex+1;if(r>=t.getNumPoints()&&null===i)return null;let o=t.getCoordinate(r);null!==i&&i.segmentIndex===n.segmentIndex&&(o=i.coord);const s=new ei(t,n.coord,o,new kn(t.getLabel()));e.add(s)}createEdgeEndForPrev(t,e,n,i){let r=n.segmentIndex;if(0===n.dist){if(0===r)return null;r--}let o=t.getCoordinate(r);null!==i&&i.segmentIndex>=r&&(o=i.coord);const s=new kn(t.getLabel());s.flip();const a=new ei(t,n.coord,o,s);e.add(a)}computeEdgeEnds(){if(1===arguments.length){const t=arguments[0],e=new P;for(let n=t;n.hasNext();){const t=n.next();this.computeEdgeEnds(t,e)}return e}if(2===arguments.length){const t=arguments[0],e=arguments[1],n=t.getEdgeIntersectionList();n.addEndpoints();const i=n.iterator();let r=null,o=null;if(!i.hasNext())return null;let s=i.next();do{r=o,o=s,s=null,i.hasNext()&&(s=i.next()),null!==o&&(this.createEdgeEndForPrev(t,e,o,r),this.createEdgeEndForNext(t,e,o,s))}while(null!==o)}}}class So extends ei{constructor(){super(),So.constructor_.apply(this,arguments)}static constructor_(){if(this._edgeEnds=new P,1===arguments.length){const t=arguments[0];So.constructor_.call(this,null,t)}else if(2===arguments.length){const t=arguments[1];ei.constructor_.call(this,t.getEdge(),t.getCoordinate(),t.getDirectedCoordinate(),new kn(t.getLabel())),this.insert(t)}}insert(t){this._edgeEnds.add(t)}print(t){t.println("EdgeEndBundle--\x3e Label: "+this._label);for(let e=this.iterator();e.hasNext();)e.next().print(t),t.println()}iterator(){return this._edgeEnds.iterator()}getEdgeEnds(){return this._edgeEnds}computeLabelOn(t,e){let n=0,i=!1;for(let e=this.iterator();e.hasNext();){const r=e.next().getLabel().getLocation(t);r===Zt.BOUNDARY&&n++,r===Zt.INTERIOR&&(i=!0)}let r=Zt.NONE;i&&(r=Zt.INTERIOR),n>0&&(r=si.determineBoundary(e,n)),this._label.setLocation(t,r)}computeLabelSide(t,e){for(let n=this.iterator();n.hasNext();){const i=n.next();if(i.getLabel().isArea()){const n=i.getLabel().getLocation(t,e);if(n===Zt.INTERIOR)return this._label.setLocation(t,e,Zt.INTERIOR),null;n===Zt.EXTERIOR&&this._label.setLocation(t,e,Zt.EXTERIOR)}}}getLabel(){return this._label}computeLabelSides(t){this.computeLabelSide(t,Mn.LEFT),this.computeLabelSide(t,Mn.RIGHT)}updateIM(t){Qn.updateIM(this._label,t)}computeLabel(t){let e=!1;for(let t=this.iterator();t.hasNext();)t.next().getLabel().isArea()&&(e=!0);this._label=e?new kn(Zt.NONE,Zt.NONE,Zt.NONE):new kn(Zt.NONE);for(let n=0;n<2;n++)this.computeLabelOn(n,t),e&&this.computeLabelSides(n)}}class To extends Cr{constructor(){super()}updateIM(t){for(let e=this.iterator();e.hasNext();)e.next().updateIM(t)}insert(t){let e=this._edgeMap.get(t);null===e?(e=new So(t),this.insertEdgeEnd(t,e)):e.insert(t)}}class Lo extends $n{constructor(){super(),Lo.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];$n.constructor_.call(this,t,e)}updateIMFromEdges(t){this._edges.updateIM(t)}computeIM(t){t.setAtLeastIfValid(this._label.getLocation(0),this._label.getLocation(1),0)}}class Mo extends ri{constructor(){super()}createNode(t){return new Lo(t,new To)}}class Oo{constructor(){Oo.constructor_.apply(this,arguments)}static constructor_(){this._nodes=new ti(new Mo)}insertEdgeEnds(t){for(let e=t.iterator();e.hasNext();){const t=e.next();this._nodes.add(t)}}getNodeIterator(){return this._nodes.iterator()}copyNodesAndLabels(t,e){for(let n=t.getNodeIterator();n.hasNext();){const t=n.next();this._nodes.addNode(t.getCoordinate()).setLabel(e,t.getLabel().getLocation(e))}}build(t){this.computeIntersectionNodes(t,0),this.copyNodesAndLabels(t,0);const e=(new No).computeEdgeEnds(t.getEdgeIterator());this.insertEdgeEnds(e)}computeIntersectionNodes(t,e){for(let n=t.getEdgeIterator();n.hasNext();){const t=n.next(),i=t.getLabel().getLocation(e);for(let n=t.getEdgeIntersectionList().iterator();n.hasNext();){const t=n.next(),r=this._nodes.addNode(t.coord);i===Zt.BOUNDARY?r.setLabelBoundary(e):r.getLabel().isNull(e)&&r.setLabel(e,Zt.INTERIOR)}}}}class Ro{constructor(){Ro.constructor_.apply(this,arguments)}static constructor_(){this._li=new Wt,this._geomGraph=null,this._nodeGraph=new Oo,this._invalidPoint=null;const t=arguments[0];this._geomGraph=t}isNodeEdgeAreaLabelsConsistent(){for(let t=this._nodeGraph.getNodeIterator();t.hasNext();){const e=t.next();if(!e.getEdges().isAreaLabelsConsistent(this._geomGraph))return this._invalidPoint=e.getCoordinate().copy(),!1}return!0}getInvalidPoint(){return this._invalidPoint}hasDuplicateRings(){for(let t=this._nodeGraph.getNodeIterator();t.hasNext();)for(let e=t.next().getEdges().iterator();e.hasNext();){const t=e.next();if(t.getEdgeEnds().size()>1)return this._invalidPoint=t.getEdge().getCoordinate(0),!0}return!1}isNodeConsistentArea(){const t=this._geomGraph.computeSelfNodes(this._li,!0,!0);return t.hasProperIntersection()?(this._invalidPoint=t.getProperIntersectionPoint(),!1):(this._nodeGraph.build(this._geomGraph),this.isNodeEdgeAreaLabelsConsistent())}}class Ao{constructor(){Ao.constructor_.apply(this,arguments)}static constructor_(){this._graph=null,this._rings=new P,this._totalEnv=new L,this._index=null,this._nestedPt=null;const t=arguments[0];this._graph=t}buildIndex(){this._index=new Li;for(let t=0;t<this._rings.size();t++){const e=this._rings.get(t),n=e.getEnvelopeInternal();this._index.insert(n,e)}}getNestedPoint(){return this._nestedPt}isNonNested(){this.buildIndex();for(let t=0;t<this._rings.size();t++){const e=this._rings.get(t),n=e.getCoordinates(),i=this._index.query(e.getEnvelopeInternal());for(let t=0;t<i.size();t++){const r=i.get(t),o=r.getCoordinates();if(e===r)continue;if(!e.getEnvelopeInternal().intersects(r.getEnvelopeInternal()))continue;const s=Fo.findPtNotNode(n,r,this._graph);if(null!==s&&Ve.isInRing(s,o))return this._nestedPt=s,!1}}return!0}add(t){this._rings.add(t),this._totalEnv.expandToInclude(t.getEnvelopeInternal())}}class Do{constructor(){Do.constructor_.apply(this,arguments)}static constructor_(){if(this._errorType=null,this._pt=null,1===arguments.length){const t=arguments[0];Do.constructor_.call(this,t,null)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._errorType=t,null!==e&&(this._pt=e.copy())}}getErrorType(){return this._errorType}getMessage(){return Do.errMsg[this._errorType]}getCoordinate(){return this._pt}toString(){let t="";return null!==this._pt&&(t=" at or near point "+this._pt),this.getMessage()+t}}Do.ERROR=0,Do.REPEATED_POINT=1,Do.HOLE_OUTSIDE_SHELL=2,Do.NESTED_HOLES=3,Do.DISCONNECTED_INTERIOR=4,Do.SELF_INTERSECTION=5,Do.RING_SELF_INTERSECTION=6,Do.NESTED_SHELLS=7,Do.DUPLICATE_RINGS=8,Do.TOO_FEW_POINTS=9,Do.INVALID_COORDINATE=10,Do.RING_NOT_CLOSED=11,Do.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"];class Fo{constructor(){Fo.constructor_.apply(this,arguments)}static constructor_(){this._parentGeometry=null,this._isSelfTouchingRingFormingHoleValid=!1,this._validErr=null;const t=arguments[0];this._parentGeometry=t}static findPtNotNode(t,e,n){const i=n.findEdge(e).getEdgeIntersectionList();for(let e=0;e<t.length;e++){const n=t[e];if(!i.isIntersection(n))return n}return null}static isValid(){if(arguments[0]instanceof H)return new Fo(arguments[0]).isValid();if(arguments[0]instanceof y){const t=arguments[0];return!(o.isNaN(t.x)||o.isInfinite(t.x)||o.isNaN(t.y)||o.isInfinite(t.y))}}checkInvalidCoordinates(){if(arguments[0]instanceof Array){const t=arguments[0];for(let e=0;e<t.length;e++)if(!Fo.isValid(t[e]))return this._validErr=new Do(Do.INVALID_COORDINATE,t[e]),null}else if(arguments[0]instanceof ot){const t=arguments[0];if(this.checkInvalidCoordinates(t.getExteriorRing().getCoordinates()),null!==this._validErr)return null;for(let e=0;e<t.getNumInteriorRing();e++)if(this.checkInvalidCoordinates(t.getInteriorRingN(e).getCoordinates()),null!==this._validErr)return null}}checkHolesNotNested(t,e){if(t.getNumInteriorRing()<=0)return null;const n=new Ao(e);for(let e=0;e<t.getNumInteriorRing();e++){const i=t.getInteriorRingN(e);i.isEmpty()||n.add(i)}n.isNonNested()||(this._validErr=new Do(Do.NESTED_HOLES,n.getNestedPoint()))}checkConsistentArea(t){const e=new Ro(t);if(!e.isNodeConsistentArea())return this._validErr=new Do(Do.SELF_INTERSECTION,e.getInvalidPoint()),null;e.hasDuplicateRings()&&(this._validErr=new Do(Do.DUPLICATE_RINGS,e.getInvalidPoint()))}isValid(){return this.checkValid(this._parentGeometry),null===this._validErr}checkShellInsideHole(t,e,n){const i=t.getCoordinates(),r=e.getCoordinates(),o=Fo.findPtNotNode(i,e,n);if(null!==o&&!Ve.isInRing(o,r))return o;const s=Fo.findPtNotNode(r,t,n);return null!==s?Ve.isInRing(s,i)?s:null:(p.shouldNeverReachHere("points in shell and hole appear to be equal"),null)}checkNoSelfIntersectingRings(t){for(let e=t.getEdgeIterator();e.hasNext();){const t=e.next();if(this.checkNoSelfIntersectingRing(t.getEdgeIntersectionList()),null!==this._validErr)return null}}checkConnectedInteriors(t){const e=new Po(t);e.isInteriorsConnected()||(this._validErr=new Do(Do.DISCONNECTED_INTERIOR,e.getCoordinate()))}checkNoSelfIntersectingRing(t){const e=new lt;let n=!0;for(let i=t.iterator();i.hasNext();){const t=i.next();if(n)n=!1;else{if(e.contains(t.coord))return this._validErr=new Do(Do.RING_SELF_INTERSECTION,t.coord),null;e.add(t.coord)}}}checkHolesInShell(t,e){if(t.getNumInteriorRing()<=0)return null;const n=t.getExteriorRing(),i=n.isEmpty(),r=new ze(n);for(let o=0;o<t.getNumInteriorRing();o++){const s=t.getInteriorRingN(o);let a=null;if(!s.isEmpty()){if(a=Fo.findPtNotNode(s.getCoordinates(),n,e),null===a)return null;if(i||Zt.EXTERIOR===r.locate(a))return this._validErr=new Do(Do.HOLE_OUTSIDE_SHELL,a),null}}}checkTooFewPoints(t){if(t.hasTooFewPoints())return this._validErr=new Do(Do.TOO_FEW_POINTS,t.getInvalidPoint()),null}getValidationError(){return this.checkValid(this._parentGeometry),this._validErr}checkValid(){if(arguments[0]instanceof et){const t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof ht){const t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof pt){const t=arguments[0];if(this.checkInvalidCoordinates(t.getCoordinates()),null!==this._validErr)return null;if(this.checkClosedRing(t),null!==this._validErr)return null;const e=new si(0,t);if(this.checkTooFewPoints(e),null!==this._validErr)return null;const n=new Wt;e.computeSelfNodes(n,!0,!0),this.checkNoSelfIntersectingRings(e)}else if(arguments[0]instanceof $){const t=arguments[0];if(this.checkInvalidCoordinates(t.getCoordinates()),null!==this._validErr)return null;const e=new si(0,t);this.checkTooFewPoints(e)}else if(arguments[0]instanceof ot){const t=arguments[0];if(this.checkInvalidCoordinates(t),null!==this._validErr)return null;if(this.checkClosedRings(t),null!==this._validErr)return null;const e=new si(0,t);if(this.checkTooFewPoints(e),null!==this._validErr)return null;if(this.checkConsistentArea(e),null!==this._validErr)return null;if(!this._isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(e),null!==this._validErr))return null;if(this.checkHolesInShell(t,e),null!==this._validErr)return null;if(this.checkHolesNotNested(t,e),null!==this._validErr)return null;this.checkConnectedInteriors(e)}else if(arguments[0]instanceof _t){const t=arguments[0];for(let e=0;e<t.getNumGeometries();e++){const n=t.getGeometryN(e);if(this.checkInvalidCoordinates(n),null!==this._validErr)return null;if(this.checkClosedRings(n),null!==this._validErr)return null}const e=new si(0,t);if(this.checkTooFewPoints(e),null!==this._validErr)return null;if(this.checkConsistentArea(e),null!==this._validErr)return null;if(!this._isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(e),null!==this._validErr))return null;for(let n=0;n<t.getNumGeometries();n++){const i=t.getGeometryN(n);if(this.checkHolesInShell(i,e),null!==this._validErr)return null}for(let n=0;n<t.getNumGeometries();n++){const i=t.getGeometryN(n);if(this.checkHolesNotNested(i,e),null!==this._validErr)return null}if(this.checkShellsNotNested(t,e),null!==this._validErr)return null;this.checkConnectedInteriors(e)}else if(arguments[0]instanceof ct){const t=arguments[0];for(let e=0;e<t.getNumGeometries();e++){const n=t.getGeometryN(e);if(this.checkValid(n),null!==this._validErr)return null}}else if(arguments[0]instanceof H){const t=arguments[0];if(this._validErr=null,t.isEmpty())return null;if(t instanceof et)this.checkValid(t);else if(t instanceof ht)this.checkValid(t);else if(t instanceof pt)this.checkValid(t);else if(t instanceof $)this.checkValid(t);else if(t instanceof ot)this.checkValid(t);else if(t instanceof _t)this.checkValid(t);else{if(!(t instanceof ct))throw new Z(t.getGeometryType());this.checkValid(t)}}}setSelfTouchingRingFormingHoleValid(t){this._isSelfTouchingRingFormingHoleValid=t}checkShellNotNested(t,e,n){const i=t.getCoordinates(),r=e.getExteriorRing();if(r.isEmpty())return null;const o=r.getCoordinates(),s=Fo.findPtNotNode(i,r,n);if(null===s)return null;if(!Ve.isInRing(s,o))return null;if(e.getNumInteriorRing()<=0)return this._validErr=new Do(Do.NESTED_SHELLS,s),null;let a=null;for(let i=0;i<e.getNumInteriorRing();i++){const r=e.getInteriorRingN(i);if(a=this.checkShellInsideHole(t,r,n),null===a)return null}this._validErr=new Do(Do.NESTED_SHELLS,a)}checkClosedRings(t){if(this.checkClosedRing(t.getExteriorRing()),null!==this._validErr)return null;for(let e=0;e<t.getNumInteriorRing();e++)if(this.checkClosedRing(t.getInteriorRingN(e)),null!==this._validErr)return null}checkClosedRing(t){if(t.isEmpty())return null;if(!t.isClosed()){let e=null;t.getNumPoints()>=1&&(e=t.getCoordinateN(0)),this._validErr=new Do(Do.RING_NOT_CLOSED,e)}}checkShellsNotNested(t,e){for(let n=0;n<t.getNumGeometries();n++){const i=t.getGeometryN(n).getExteriorRing();for(let r=0;r<t.getNumGeometries();r++){if(n===r)continue;const o=t.getGeometryN(r);if(this.checkShellNotNested(i,o,e),null!==this._validErr)return null}}}}class ko{constructor(){ko.constructor_.apply(this,arguments)}static constructor_(){this._factory=null,this._deList=new P,this._lowestEdge=null,this._ring=null,this._locator=null,this._ringPts=null,this._holes=null,this._shell=null,this._isHole=null,this._isProcessed=!1,this._isIncludedSet=!1,this._isIncluded=!1;const t=arguments[0];this._factory=t}static findDirEdgesInRing(t){let e=t;const n=new P;do{n.add(e),e=e.getNext(),p.isTrue(null!==e,"found null DE in ring"),p.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t);return n}static addEdge(t,e,n){if(e)for(let e=0;e<t.length;e++)n.add(t[e],!1);else for(let e=t.length-1;e>=0;e--)n.add(t[e],!1)}static findEdgeRingContaining(t,e){const n=t.getRing(),i=n.getEnvelopeInternal();let r=n.getCoordinateN(0),o=null,s=null;for(let t=e.iterator();t.hasNext();){const e=t.next(),a=e.getRing().getEnvelopeInternal();a.equals(i)||a.contains(i)&&(r=dt.ptNotInList(n.getCoordinates(),e.getCoordinates()),e.isInRing(r)&&(null===o||s.contains(a))&&(o=e,s=o.getRing().getEnvelopeInternal()))}return o}isIncluded(){return this._isIncluded}getCoordinates(){if(null===this._ringPts){const t=new S;for(let e=this._deList.iterator();e.hasNext();){const n=e.next(),i=n.getEdge();ko.addEdge(i.getLine().getCoordinates(),n.getEdgeDirection(),t)}this._ringPts=t.toCoordinateArray()}return this._ringPts}isIncludedSet(){return this._isIncludedSet}isValid(){return this.getCoordinates(),!(this._ringPts.length<=3)&&(this.getRing(),Fo.isValid(this._ring))}build(t){let e=t;do{this.add(e),e.setRing(this),e=e.getNext(),p.isTrue(null!==e,"found null DE in ring"),p.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t)}isInRing(t){return Zt.EXTERIOR!==this.getLocator().locate(t)}isOuterHole(){return!!this._isHole&&!this.hasShell()}getPolygon(){let t=null;if(null!==this._holes){t=new Array(this._holes.size()).fill(null);for(let e=0;e<this._holes.size();e++)t[e]=this._holes.get(e)}return this._factory.createPolygon(this._ring,t)}isHole(){return this._isHole}isProcessed(){return this._isProcessed}addHole(){if(arguments[0]instanceof pt){const t=arguments[0];null===this._holes&&(this._holes=new P),this._holes.add(t)}else if(arguments[0]instanceof ko){const t=arguments[0];t.setShell(this);const e=t.getRing();null===this._holes&&(this._holes=new P),this._holes.add(e)}}setIncluded(t){this._isIncluded=t,this._isIncludedSet=!0}getOuterHole(){if(this.isHole())return null;for(let t=0;t<this._deList.size();t++){const e=this._deList.get(t).getSym().getRing();if(e.isOuterHole())return e}return null}computeHole(){const t=this.getRing();this._isHole=B.isCCW(t.getCoordinates())}hasShell(){return null!==this._shell}isOuterShell(){return null!==this.getOuterHole()}getLineString(){return this.getCoordinates(),this._factory.createLineString(this._ringPts)}toString(){return Yt.toLineString(new yt(this.getCoordinates()))}getLocator(){return null===this._locator&&(this._locator=new ze(this.getRing())),this._locator}getShell(){return this.isHole()?this._shell:this}add(t){this._deList.add(t)}getRing(){if(null!==this._ring)return this._ring;this.getCoordinates(),this._ringPts.length<3&&j.out.println(this._ringPts);try{this._ring=this._factory.createLinearRing(this._ringPts)}catch(t){if(!(t instanceof n))throw t;j.out.println(this._ringPts)}return this._ring}updateIncluded(){if(this.isHole())return null;for(let t=0;t<this._deList.size();t++){const e=this._deList.get(t).getSym().getRing().getShell();if(null!==e&&e.isIncludedSet())return this.setIncluded(!e.isIncluded()),null}}setShell(t){this._shell=t}setProcessed(t){this._isProcessed=t}}ko.EnvelopeComparator=class{compare(t,e){const n=e;return t.getRing().getEnvelope().compareTo(n.getRing().getEnvelope())}get interfaces_(){return[l]}};class Bo extends Jr{constructor(){super(),Bo.constructor_.apply(this,arguments)}static constructor_(){this._factory=null;const t=arguments[0];this._factory=t}static findLabeledEdgeRings(t){const e=new P;let n=1;for(let i=t.iterator();i.hasNext();){const t=i.next();if(t.isMarked())continue;if(t.getLabel()>=0)continue;e.add(t);const r=ko.findDirEdgesInRing(t);Bo.label(r,n),n++}return e}static getDegreeNonDeleted(t){let e=0;for(let n=t.getOutEdges().getEdges().iterator();n.hasNext();)n.next().isMarked()||e++;return e}static deleteAllEdges(t){for(let e=t.getOutEdges().getEdges().iterator();e.hasNext();){const t=e.next();t.setMarked(!0);const n=t.getSym();null!==n&&n.setMarked(!0)}}static label(t,e){for(let n=t.iterator();n.hasNext();)n.next().setLabel(e)}static computeNextCWEdges(t){let e=null,n=null;for(let i=t.getOutEdges().getEdges().iterator();i.hasNext();){const t=i.next();t.isMarked()||(null===e&&(e=t),null!==n&&n.getSym().setNext(t),n=t)}null!==n&&n.getSym().setNext(e)}static computeNextCCWEdges(t,e){let n=null,i=null;const r=t.getOutEdges().getEdges();for(let t=r.size()-1;t>=0;t--){const o=r.get(t),s=o.getSym();let a=null;o.getLabel()===e&&(a=o);let l=null;s.getLabel()===e&&(l=s),null===a&&null===l||(null!==l&&(i=l),null!==a&&(null!==i&&(i.setNext(a),i=null),null===n&&(n=a)))}null!==i&&(p.isTrue(null!==n),i.setNext(n))}static getDegree(t,e){let n=0;for(let i=t.getOutEdges().getEdges().iterator();i.hasNext();)i.next().getLabel()===e&&n++;return n}static findIntersectionNodes(t,e){let n=t,i=null;do{const r=n.getFromNode();Bo.getDegree(r,e)>1&&(null===i&&(i=new P),i.add(r)),n=n.getNext(),p.isTrue(null!==n,"found null DE in ring"),p.isTrue(n===t||!n.isInRing(),"found DE already in ring")}while(n!==t);return i}findEdgeRing(t){const e=new ko(this._factory);return e.build(t),e}computeDepthParity(){if(0===arguments.length)for(;;)return null}computeNextCWEdges(){for(let t=this.nodeIterator();t.hasNext();){const e=t.next();Bo.computeNextCWEdges(e)}}addEdge(t){if(t.isEmpty())return null;const e=dt.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return null;const n=e[0],i=e[e.length-1],r=this.getNode(n),o=this.getNode(i),s=new Eo(r,o,e[1],!0),a=new Eo(o,r,e[e.length-2],!1),l=new Io(t);l.setDirectedEdges(s,a),this.add(l)}deleteCutEdges(){this.computeNextCWEdges(),Bo.findLabeledEdgeRings(this._dirEdges);const t=new P;for(let e=this._dirEdges.iterator();e.hasNext();){const n=e.next();if(n.isMarked())continue;const i=n.getSym();if(n.getLabel()===i.getLabel()){n.setMarked(!0),i.setMarked(!0);const e=n.getEdge();t.add(e.getLine())}}return t}getEdgeRings(){this.computeNextCWEdges(),Bo.label(this._dirEdges,-1);const t=Bo.findLabeledEdgeRings(this._dirEdges);this.convertMaximalToMinimalEdgeRings(t);const e=new P;for(let t=this._dirEdges.iterator();t.hasNext();){const n=t.next();if(n.isMarked())continue;if(n.isInRing())continue;const i=this.findEdgeRing(n);e.add(i)}return e}getNode(t){let e=this.findNode(t);return null===e&&(e=new Wr(t),this.add(e)),e}convertMaximalToMinimalEdgeRings(t){for(let e=t.iterator();e.hasNext();){const t=e.next(),n=t.getLabel(),i=Bo.findIntersectionNodes(t,n);if(null!==i)for(let t=i.iterator();t.hasNext();){const e=t.next();Bo.computeNextCCWEdges(e,n)}}}deleteDangles(){const t=this.findNodesOfDegree(1),e=new xt,n=new tn;for(let e=t.iterator();e.hasNext();)n.push(e.next());for(;!n.isEmpty();){const t=n.pop();Bo.deleteAllEdges(t);for(let i=t.getOutEdges().getEdges().iterator();i.hasNext();){const t=i.next();t.setMarked(!0);const r=t.getSym();null!==r&&r.setMarked(!0);const o=t.getEdge();e.add(o.getLine());const s=t.getToNode();1===Bo.getDegreeNonDeleted(s)&&n.push(s)}}return e}}class Go{constructor(){Go.constructor_.apply(this,arguments)}static constructor_(){this._shells=null,this._shellIndex=null;const t=arguments[0];this._shells=t,this.buildIndex()}static assignHolesToShells(t,e){new Go(e).assignHolesToShells(t)}assignHolesToShells(t){for(let e=t.iterator();e.hasNext();){const t=e.next();this.assignHoleToShell(t)}}buildIndex(){this._shellIndex=new Li;for(const t of this._shells)this._shellIndex.insert(t.getRing().getEnvelopeInternal(),t)}queryOverlappingShells(t){return this._shellIndex.query(t)}findShellContaining(t){const e=t.getRing().getEnvelopeInternal(),n=this.queryOverlappingShells(e);return ko.findEdgeRingContaining(t,n)}assignHoleToShell(t){const e=this.findShellContaining(t);null!==e&&e.addHole(t)}}class jo{constructor(){jo.constructor_.apply(this,arguments)}static constructor_(){if(this._lineStringAdder=new zo(this),this._graph=null,this._dangles=new P,this._cutEdges=new P,this._invalidRingLines=new P,this._holeList=null,this._shellList=null,this._polyList=null,this._isCheckingRingsValid=!0,this._extractOnlyPolygonal=null,this._geomFactory=null,0===arguments.length)jo.constructor_.call(this,!1);else if(1===arguments.length){const t=arguments[0];this._extractOnlyPolygonal=t}}static extractPolygons(t,e){const n=new P;for(let i=t.iterator();i.hasNext();){const t=i.next();(e||t.isIncluded())&&n.add(t.getPolygon())}return n}static findOuterShells(t){for(let e=t.iterator();e.hasNext();){const t=e.next(),n=t.getOuterHole();null===n||n.isProcessed()||(t.setIncluded(!0),n.setProcessed(!0))}}static findDisjointShells(t){jo.findOuterShells(t);let e=null;do{e=!1;for(let n=t.iterator();n.hasNext();){const t=n.next();t.isIncludedSet()||(t.updateIncluded(),t.isIncludedSet()||(e=!0))}}while(e)}getGeometry(){return null===this._geomFactory&&(this._geomFactory=new Pt),this.polygonize(),this._extractOnlyPolygonal?this._geomFactory.buildGeometry(this._polyList):this._geomFactory.createGeometryCollection(Pt.toGeometryArray(this._polyList))}getInvalidRingLines(){return this.polygonize(),this._invalidRingLines}findValidRings(t,e,n){for(let i=t.iterator();i.hasNext();){const t=i.next();t.isValid()?e.add(t):n.add(t.getLineString())}}polygonize(){if(null!==this._polyList)return null;if(this._polyList=new P,null===this._graph)return null;this._dangles=this._graph.deleteDangles(),this._cutEdges=this._graph.deleteCutEdges();const t=this._graph.getEdgeRings();let e=new P;this._invalidRingLines=new P,this._isCheckingRingsValid?this.findValidRings(t,e,this._invalidRingLines):e=t,this.findShellsAndHoles(e),Go.assignHolesToShells(this._holeList,this._shellList),_e.sort(this._shellList,new ko.EnvelopeComparator);let n=!0;this._extractOnlyPolygonal&&(jo.findDisjointShells(this._shellList),n=!1),this._polyList=jo.extractPolygons(this._shellList,n)}getDangles(){return this.polygonize(),this._dangles}getCutEdges(){return this.polygonize(),this._cutEdges}getPolygons(){return this.polygonize(),this._polyList}add(){if(C(arguments[0],w))for(let t=arguments[0].iterator();t.hasNext();){const e=t.next();this.add(e)}else if(arguments[0]instanceof $){const t=arguments[0];this._geomFactory=t.getFactory(),null===this._graph&&(this._graph=new Bo(this._geomFactory)),this._graph.addEdge(t)}else arguments[0]instanceof H&&arguments[0].apply(this._lineStringAdder)}setCheckRingsValid(t){this._isCheckingRingsValid=t}findShellsAndHoles(t){this._holeList=new P,this._shellList=new P;for(let e=t.iterator();e.hasNext();){const t=e.next();t.computeHole(),t.isHole()?this._holeList.add(t):this._shellList.add(t)}}}class zo{constructor(){zo.constructor_.apply(this,arguments)}static constructor_(){this.p=null;const t=arguments[0];this.p=t}filter(t){t instanceof $&&this.p.add(t)}get interfaces_(){return[V]}}jo.LineStringAdder=zo;var Uo=Object.freeze({__proto__:null,Polygonizer:jo});class qo{constructor(){qo.constructor_.apply(this,arguments)}static constructor_(){this._li=new Wt,this._ptLocator=new yn,this._arg=null,this._nodes=new ti(new Mo),this._im=null,this._isolatedEdges=new P,this._invalidPoint=null;const t=arguments[0];this._arg=t}insertEdgeEnds(t){for(let e=t.iterator();e.hasNext();){const t=e.next();this._nodes.add(t)}}computeProperIntersectionIM(t,e){const n=this._arg[0].getGeometry().getDimension(),i=this._arg[1].getGeometry().getDimension(),r=t.hasProperIntersection(),o=t.hasProperInteriorIntersection();2===n&&2===i?r&&e.setAtLeast("212101212"):2===n&&1===i?(r&&e.setAtLeast("FFF0FFFF2"),o&&e.setAtLeast("1FFFFF1FF")):1===n&&2===i?(r&&e.setAtLeast("F0FFFFFF2"),o&&e.setAtLeast("1F1FFFFFF")):1===n&&1===i&&o&&e.setAtLeast("0FFFFFFFF")}labelIsolatedEdges(t,e){for(let n=this._arg[t].getEdgeIterator();n.hasNext();){const t=n.next();t.isIsolated()&&(this.labelIsolatedEdge(t,e,this._arg[e].getGeometry()),this._isolatedEdges.add(t))}}labelIsolatedEdge(t,e,n){if(n.getDimension()>0){const i=this._ptLocator.locate(t.getCoordinate(),n);t.getLabel().setAllLocations(e,i)}else t.getLabel().setAllLocations(e,Zt.EXTERIOR)}computeIM(){const t=new Jt;if(t.set(Zt.EXTERIOR,Zt.EXTERIOR,2),!this._arg[0].getGeometry().getEnvelopeInternal().intersects(this._arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(t),t;this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1);const e=this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(e,t);const n=new No,i=n.computeEdgeEnds(this._arg[0].getEdgeIterator());this.insertEdgeEnds(i);const r=n.computeEdgeEnds(this._arg[1].getEdgeIterator());return this.insertEdgeEnds(r),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(t),t}labelNodeEdges(){for(let t=this._nodes.iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg)}copyNodesAndLabels(t){for(let e=this._arg[t].getNodeIterator();e.hasNext();){const n=e.next();this._nodes.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}}labelIntersectionNodes(t){for(let e=this._arg[t].getEdgeIterator();e.hasNext();){const n=e.next(),i=n.getLabel().getLocation(t);for(let e=n.getEdgeIntersectionList().iterator();e.hasNext();){const n=e.next(),r=this._nodes.find(n.coord);r.getLabel().isNull(t)&&(i===Zt.BOUNDARY?r.setLabelBoundary(t):r.setLabel(t,Zt.INTERIOR))}}}labelIsolatedNode(t,e){const n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setAllLocations(e,n)}computeIntersectionNodes(t){for(let e=this._arg[t].getEdgeIterator();e.hasNext();){const n=e.next(),i=n.getLabel().getLocation(t);for(let e=n.getEdgeIntersectionList().iterator();e.hasNext();){const n=e.next(),r=this._nodes.addNode(n.coord);i===Zt.BOUNDARY?r.setLabelBoundary(t):r.getLabel().isNull(t)&&r.setLabel(t,Zt.INTERIOR)}}}labelIsolatedNodes(){for(let t=this._nodes.iterator();t.hasNext();){const e=t.next(),n=e.getLabel();p.isTrue(n.getGeometryCount()>0,"node with empty label found"),e.isIsolated()&&(n.isNull(0)?this.labelIsolatedNode(e,0):this.labelIsolatedNode(e,1))}}updateIM(t){for(let e=this._isolatedEdges.iterator();e.hasNext();)e.next().updateIM(t);for(let e=this._nodes.iterator();e.hasNext();){const n=e.next();n.updateIM(t),n.updateIMFromEdges(t)}}computeDisjointIM(t){const e=this._arg[0].getGeometry();e.isEmpty()||(t.set(Zt.INTERIOR,Zt.EXTERIOR,e.getDimension()),t.set(Zt.BOUNDARY,Zt.EXTERIOR,e.getBoundaryDimension()));const n=this._arg[1].getGeometry();n.isEmpty()||(t.set(Zt.EXTERIOR,Zt.INTERIOR,n.getDimension()),t.set(Zt.EXTERIOR,Zt.BOUNDARY,n.getBoundaryDimension()))}}class Vo{constructor(){Vo.constructor_.apply(this,arguments)}static constructor_(){this._rectEnv=null;const t=arguments[0];this._rectEnv=t.getEnvelopeInternal()}static contains(t,e){return new Vo(t).contains(e)}isContainedInBoundary(t){if(t instanceof ot)return!1;if(t instanceof et)return this.isPointContainedInBoundary(t);if(t instanceof $)return this.isLineStringContainedInBoundary(t);for(let e=0;e<t.getNumGeometries();e++){const n=t.getGeometryN(e);if(!this.isContainedInBoundary(n))return!1}return!0}isLineSegmentContainedInBoundary(t,e){if(t.equals(e))return this.isPointContainedInBoundary(t);if(t.x===e.x){if(t.x===this._rectEnv.getMinX()||t.x===this._rectEnv.getMaxX())return!0}else if(t.y===e.y&&(t.y===this._rectEnv.getMinY()||t.y===this._rectEnv.getMaxY()))return!0;return!1}isLineStringContainedInBoundary(t){const e=t.getCoordinateSequence(),n=new y,i=new y;for(let t=0;t<e.size()-1;t++)if(e.getCoordinate(t,n),e.getCoordinate(t+1,i),!this.isLineSegmentContainedInBoundary(n,i))return!1;return!0}isPointContainedInBoundary(){if(arguments[0]instanceof et){const t=arguments[0];return this.isPointContainedInBoundary(t.getCoordinate())}if(arguments[0]instanceof y){const t=arguments[0];return t.x===this._rectEnv.getMinX()||t.x===this._rectEnv.getMaxX()||t.y===this._rectEnv.getMinY()||t.y===this._rectEnv.getMaxY()}}contains(t){return!!this._rectEnv.contains(t.getEnvelopeInternal())&&!this.isContainedInBoundary(t)}}class Ho{constructor(){Ho.constructor_.apply(this,arguments)}static constructor_(){this._li=new Wt,this._rectEnv=null,this._diagUp0=null,this._diagUp1=null,this._diagDown0=null,this._diagDown1=null;const t=arguments[0];this._rectEnv=t,this._diagUp0=new y(t.getMinX(),t.getMinY()),this._diagUp1=new y(t.getMaxX(),t.getMaxY()),this._diagDown0=new y(t.getMinX(),t.getMaxY()),this._diagDown1=new y(t.getMaxX(),t.getMinY())}intersects(t,e){const n=new L(t,e);if(!this._rectEnv.intersects(n))return!1;if(this._rectEnv.intersects(t))return!0;if(this._rectEnv.intersects(e))return!0;if(t.compareTo(e)>0){const n=t;t=e,e=n}let i=!1;return e.y>t.y&&(i=!0),i?this._li.computeIntersection(t,e,this._diagDown0,this._diagDown1):this._li.computeIntersection(t,e,this._diagUp0,this._diagUp1),!!this._li.hasIntersection()}}class Yo{constructor(){Yo.constructor_.apply(this,arguments)}static constructor_(){this._rectangle=null,this._rectEnv=null;const t=arguments[0];this._rectangle=t,this._rectEnv=t.getEnvelopeInternal()}static intersects(t,e){return new Yo(t).intersects(e)}intersects(t){if(!this._rectEnv.intersects(t.getEnvelopeInternal()))return!1;const e=new Xo(this._rectEnv);if(e.applyTo(t),e.intersects())return!0;const n=new Wo(this._rectangle);if(n.applyTo(t),n.containsPoint())return!0;const i=new Ko(this._rectangle);return i.applyTo(t),!!i.intersects()}}class Xo extends Ce{constructor(){super(),Xo.constructor_.apply(this,arguments)}static constructor_(){this._rectEnv=null,this._intersects=!1;const t=arguments[0];this._rectEnv=t}isDone(){return!0===this._intersects}visit(t){const e=t.getEnvelopeInternal();return this._rectEnv.intersects(e)?this._rectEnv.contains(e)||e.getMinX()>=this._rectEnv.getMinX()&&e.getMaxX()<=this._rectEnv.getMaxX()||e.getMinY()>=this._rectEnv.getMinY()&&e.getMaxY()<=this._rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null}intersects(){return this._intersects}}class Wo extends Ce{constructor(){super(),Wo.constructor_.apply(this,arguments)}static constructor_(){this._rectSeq=null,this._rectEnv=null,this._containsPoint=!1;const t=arguments[0];this._rectSeq=t.getExteriorRing().getCoordinateSequence(),this._rectEnv=t.getEnvelopeInternal()}isDone(){return!0===this._containsPoint}visit(t){if(!(t instanceof ot))return null;const e=t.getEnvelopeInternal();if(!this._rectEnv.intersects(e))return null;const n=new y;for(let i=0;i<4;i++)if(this._rectSeq.getCoordinate(i,n),e.contains(n)&&Xe.containsPointInPolygon(n,t))return this._containsPoint=!0,null}containsPoint(){return this._containsPoint}}class Ko extends Ce{constructor(){super(),Ko.constructor_.apply(this,arguments)}static constructor_(){this._rectEnv=null,this._rectIntersector=null,this._hasIntersection=!1,this._p0=new y,this._p1=new y;const t=arguments[0];this._rectEnv=t.getEnvelopeInternal(),this._rectIntersector=new Ho(this._rectEnv)}intersects(){return this._hasIntersection}isDone(){return!0===this._hasIntersection}visit(t){const e=t.getEnvelopeInternal();if(!this._rectEnv.intersects(e))return null;const n=me.getLines(t);this.checkIntersectionWithLineStrings(n)}checkIntersectionWithLineStrings(t){for(let e=t.iterator();e.hasNext();){const t=e.next();if(this.checkIntersectionWithSegments(t),this._hasIntersection)return null}}checkIntersectionWithSegments(t){const e=t.getCoordinateSequence();for(let t=1;t<e.size();t++)if(e.getCoordinate(t-1,this._p0),e.getCoordinate(t,this._p1),this._rectIntersector.intersects(this._p0,this._p1))return this._hasIntersection=!0,null}}class Zo extends Co{constructor(){super(),Zo.constructor_.apply(this,arguments)}static constructor_(){if(this._relate=null,2===arguments.length){const t=arguments[0],e=arguments[1];Co.constructor_.call(this,t,e),this._relate=new qo(this._arg)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];Co.constructor_.call(this,t,e,n),this._relate=new qo(this._arg)}}static covers(t,e){return!(2===e.getDimension()&&t.getDimension()<2)&&!(1===e.getDimension()&&t.getDimension()<1&&e.getLength()>0)&&!!t.getEnvelopeInternal().covers(e.getEnvelopeInternal())&&(!!t.isRectangle()||new Zo(t,e).getIntersectionMatrix().isCovers())}static intersects(t,e){if(!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal()))return!1;if(t.isRectangle())return Yo.intersects(t,e);if(e.isRectangle())return Yo.intersects(e,t);if(t.isGeometryCollection()||e.isGeometryCollection()){for(let n=0;n<t.getNumGeometries();n++)for(let i=0;i<e.getNumGeometries();i++)if(t.getGeometryN(n).intersects(e.getGeometryN(i)))return!0;return!1}return new Zo(t,e).getIntersectionMatrix().isIntersects()}static touches(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new Zo(t,e).getIntersectionMatrix().isTouches(t.getDimension(),e.getDimension())}static equalsTopo(t,e){return!!t.getEnvelopeInternal().equals(e.getEnvelopeInternal())&&Zo.relate(t,e).isEquals(t.getDimension(),e.getDimension())}static relate(){return 2===arguments.length?new Zo(arguments[0],arguments[1]).getIntersectionMatrix():3===arguments.length?new Zo(arguments[0],arguments[1],arguments[2]).getIntersectionMatrix():void 0}static overlaps(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new Zo(t,e).getIntersectionMatrix().isOverlaps(t.getDimension(),e.getDimension())}static crosses(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new Zo(t,e).getIntersectionMatrix().isCrosses(t.getDimension(),e.getDimension())}static contains(t,e){return!(2===e.getDimension()&&t.getDimension()<2)&&!(1===e.getDimension()&&t.getDimension()<1&&e.getLength()>0)&&!!t.getEnvelopeInternal().contains(e.getEnvelopeInternal())&&(t.isRectangle()?Vo.contains(t,e):new Zo(t,e).getIntersectionMatrix().isContains())}getIntersectionMatrix(){return this._relate.computeIM()}}var Jo=Object.freeze({__proto__:null,RelateOp:Zo});class Qo{constructor(){Qo.constructor_.apply(this,arguments)}static constructor_(){this._pointGeom=null,this._otherGeom=null,this._geomFact=null;const t=arguments[0],e=arguments[1];this._pointGeom=t,this._otherGeom=e,this._geomFact=e.getFactory()}static union(t,e){return new Qo(t,e).union()}union(){const t=new yn,e=new lt;for(let n=0;n<this._pointGeom.getNumGeometries();n++){const i=this._pointGeom.getGeometryN(n).getCoordinate();t.locate(i,this._otherGeom)===Zt.EXTERIOR&&e.add(i)}if(0===e.size())return this._otherGeom;let n=null;const i=dt.toCoordinateArray(e);return n=1===i.length?this._geomFact.createPoint(i[0]):this._geomFact.createMultiPointFromCoords(i),ue.combine(n,this._otherGeom)}}class $o{constructor(){$o.constructor_.apply(this,arguments)}static constructor_(){this._geomFactory=null,this._polygons=new P,this._lines=new P,this._points=new P,this._dimension=J.FALSE}static extract(){if(C(arguments[0],w)){const t=arguments[0],e=new $o;return e.add(t),e}if(arguments[0]instanceof H){const t=arguments[0],e=new $o;return e.add(t),e}}getFactory(){return this._geomFactory}recordDimension(t){t>this._dimension&&(this._dimension=t)}getDimension(){return this._dimension}filter(t){return this.recordDimension(t.getDimension()),t instanceof ct||t.isEmpty()?null:t instanceof ot?(this._polygons.add(t),null):t instanceof $?(this._lines.add(t),null):t instanceof et?(this._points.add(t),null):void p.shouldNeverReachHere("Unhandled geometry type: "+t.getGeometryType())}getExtract(t){switch(t){case 0:return this._points;case 1:return this._lines;case 2:return this._polygons}return p.shouldNeverReachHere("Invalid dimension: "+t),null}isEmpty(){return this._polygons.isEmpty()&&this._lines.isEmpty()&&this._points.isEmpty()}add(){if(C(arguments[0],w)){const t=arguments[0];for(const e of t)this.add(e)}else if(arguments[0]instanceof H){const t=arguments[0];null===this._geomFactory&&(this._geomFactory=t.getFactory()),t.apply(this)}}get interfaces_(){return[Q]}}class ts{static union(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return wo.createEmptyResult(wo.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return H.checkNotGeometryCollection(t),H.checkNotGeometryCollection(e),xo.overlayOp(t,e,wo.UNION)}}class es{constructor(){es.constructor_.apply(this,arguments)}static constructor_(){this._geomFactory=null,this._g0=null,this._g1=null,this._isUnionSafe=null;const t=arguments[0],e=arguments[1];this._g0=t,this._g1=e,this._geomFactory=t.getFactory()}static containsProperly(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return!t.isNull()&&e.getX()>t.getMinX()&&e.getX()<t.getMaxX()&&e.getY()>t.getMinY()&&e.getY()<t.getMaxY()}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];return es.containsProperly(t,e)&&es.containsProperly(t,n)}}static union(t,e){return new es(t,e).union()}static intersects(t,e,n){return t.intersects(e)||t.intersects(n)}static overlapEnvelope(t,e){const n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();return n.intersection(i)}static extractBorderSegments(t,e,n){t.apply(new class{get interfaces_(){return[T]}filter(t,i){if(i<=0)return null;const r=t.getCoordinate(i-1),o=t.getCoordinate(i);if(es.intersects(e,r,o)&&!es.containsProperly(e,r,o)){const t=new Kt(r,o);n.add(t)}}isDone(){return!1}isGeometryChanged(){return!1}})}static unionBuffer(t,e){return t.getFactory().createGeometryCollection([t,e]).buffer(0)}isBorderSegmentsSame(t,e){const n=this.extractBorderSegments(this._g0,this._g1,e),i=new P;return es.extractBorderSegments(t,e,i),this.isEqual(n,i)}extractByEnvelope(t,e,n){const i=new P;for(let r=0;r<e.getNumGeometries();r++){const o=e.getGeometryN(r);if(o.getEnvelopeInternal().intersects(t))i.add(o);else{const t=o.copy();n.add(t)}}return this._geomFactory.buildGeometry(i)}isEqual(t,e){if(t.size()!==e.size())return!1;const n=new xt(t);for(const t of e)if(!n.contains(t))return!1;return!0}union(){const t=es.overlapEnvelope(this._g0,this._g1);if(t.isNull()){const t=this._g0.copy(),e=this._g1.copy();return ue.combine(t,e)}const e=new P,n=this.extractByEnvelope(t,this._g0,e),i=this.extractByEnvelope(t,this._g1,e),r=this.unionFull(n,i);let o=null;return this._isUnionSafe=this.isBorderSegmentsSame(r,t),o=this._isUnionSafe?this.combine(r,e):this.unionFull(this._g0,this._g1),o}combine(t,e){return e.size()<=0?t:(e.add(t),ue.combine(e))}unionFull(t,e){try{return ts.union(t,e)}catch(n){if(n instanceof ni)return es.unionBuffer(t,e);throw n}}extractBorderSegments(t,e,n){const i=new P;return es.extractBorderSegments(t,n,i),null!==e&&es.extractBorderSegments(e,n,i),i}isUnionOptimized(){return this._isUnionSafe}}class ns{constructor(){ns.constructor_.apply(this,arguments)}static constructor_(){this._inputPolys=null,this._geomFactory=null;const t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new P)}static restrictToPolygons(t){if(C(t,rt))return t;const e=xe.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(Pt.toPolygonArray(e))}static getGeometry(t,e){return e>=t.size()?null:t.get(e)}static union(t){return new ns(t).union()}reduceToGeometries(t){const e=new P;for(let n=t.iterator();n.hasNext();){const t=n.next();let i=null;C(t,E)?i=this.unionTree(t):t instanceof H&&(i=t),e.add(i)}return e}union(){if(null===this._inputPolys)throw new A("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();const t=new Li(ns.STRTREE_NODE_CAPACITY);for(let e=this._inputPolys.iterator();e.hasNext();){const n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;const e=t.itemsTree();return this.unionTree(e)}binaryUnion(){if(1===arguments.length){const t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(n-e<=1){const n=ns.getGeometry(t,e);return this.unionSafe(n,null)}if(n-e==2)return this.unionSafe(ns.getGeometry(t,e),ns.getGeometry(t,e+1));{const i=Math.trunc((n+e)/2),r=this.binaryUnion(t,e,i),o=this.binaryUnion(t,i,n);return this.unionSafe(r,o)}}}repeatedUnion(t){let e=null;for(let n=t.iterator();n.hasNext();){const t=n.next();e=null===e?t.copy():e.union(t)}return e}unionSafe(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionActual(t,e)}unionActual(t,e){const n=es.union(t,e);return ns.restrictToPolygons(n)}unionTree(t){const e=this.reduceToGeometries(t);return this.binaryUnion(e)}bufferUnion(){if(1===arguments.length){const t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return t.getFactory().createGeometryCollection([t,e]).buffer(0)}}}ns.STRTREE_NODE_CAPACITY=4;class is{constructor(){is.constructor_.apply(this,arguments)}static constructor_(){if(this._geomFact=null,this._extracter=null,1===arguments.length){if(C(arguments[0],w)){const t=arguments[0];this.extract(t)}else if(arguments[0]instanceof H){const t=arguments[0];this.extract(t)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._geomFact=e,this.extract(t)}}static union(){if(1===arguments.length){if(C(arguments[0],w))return new is(arguments[0]).union();if(arguments[0]instanceof H)return new is(arguments[0]).union()}else if(2===arguments.length)return new is(arguments[0],arguments[1]).union()}unionNoOpt(t){const e=this._geomFact.createPoint();return xo.overlayOp(t,e,wo.UNION)}unionWithNull(t,e){return null===t&&null===e?null:null===e?t:null===t?e:wo.union(t,e)}extract(){if(C(arguments[0],w)){const t=arguments[0];this._extracter=$o.extract(t)}else if(arguments[0]instanceof H){const t=arguments[0];this._extracter=$o.extract(t)}}union(){if(null===this._geomFact&&(this._geomFact=this._extracter.getFactory()),null===this._geomFact)return null;if(this._extracter.isEmpty())return this._geomFact.createEmpty(this._extracter.getDimension());const t=this._extracter.getExtract(0),e=this._extracter.getExtract(1),n=this._extracter.getExtract(2);let i=null;if(t.size()>0){const e=this._geomFact.buildGeometry(t);i=this.unionNoOpt(e)}let r=null;if(e.size()>0){const t=this._geomFact.buildGeometry(e);r=this.unionNoOpt(t)}let o=null;n.size()>0&&(o=ns.union(n));const s=this.unionWithNull(r,o);let a=null;return a=null===i?s:null===s?i:Qo.union(i,s),null===a?this._geomFact.createGeometryCollection():a}}var rs=Object.freeze({__proto__:null,UnaryUnionOp:is}),os=Object.freeze({__proto__:null,IsValidOp:Fo,ConsistentAreaTester:Ro}),ss=Object.freeze({__proto__:null,BoundaryOp:nr,IsSimpleOp:rr,buffer:kr,distance:zr,linemerge:io,overlay:bo,polygonize:Uo,relate:Jo,union:rs,valid:os});class as{constructor(){as.constructor_.apply(this,arguments)}static constructor_(){if(this._returnToOriginalPrecision=!0,this._cbr=null,0===arguments.length)as.constructor_.call(this,!0);else if(1===arguments.length){const t=arguments[0];this._returnToOriginalPrecision=t}}computeResultPrecision(t){return this._returnToOriginalPrecision&&this._cbr.addCommonBits(t),t}union(t,e){const n=this.removeCommonBits(t,e);return this.computeResultPrecision(n[0].union(n[1]))}intersection(t,e){const n=this.removeCommonBits(t,e);return this.computeResultPrecision(n[0].intersection(n[1]))}removeCommonBits(){if(1===arguments.length){const t=arguments[0];return this._cbr=new yo,this._cbr.add(t),this._cbr.removeCommonBits(t.copy())}if(2===arguments.length){const t=arguments[0],e=arguments[1];this._cbr=new yo,this._cbr.add(t),this._cbr.add(e);const n=new Array(2).fill(null);return n[0]=this._cbr.removeCommonBits(t.copy()),n[1]=this._cbr.removeCommonBits(e.copy()),n}}buffer(t,e){const n=this.removeCommonBits(t);return this.computeResultPrecision(n.buffer(e))}symDifference(t,e){const n=this.removeCommonBits(t,e);return this.computeResultPrecision(n[0].symDifference(n[1]))}difference(t,e){const n=this.removeCommonBits(t,e);return this.computeResultPrecision(n[0].difference(n[1]))}}class ls extends ce.CoordinateOperation{constructor(){super(),ls.constructor_.apply(this,arguments)}static constructor_(){this._targetPM=null,this._removeCollapsed=!0;const t=arguments[0],e=arguments[1];this._targetPM=t,this._removeCollapsed=e}edit(){if(2===arguments.length&&arguments[1]instanceof H&&arguments[0]instanceof Array){const t=arguments[0],e=arguments[1];if(0===t.length)return null;const n=new Array(t.length).fill(null);for(let e=0;e<t.length;e++){const i=new y(t[e]);this._targetPM.makePrecise(i),n[e]=i}const i=new S(n,!1).toCoordinateArray();let r=0;e instanceof $&&(r=2),e instanceof pt&&(r=4);let o=n;return this._removeCollapsed&&(o=null),i.length<r?o:i}return super.edit.apply(this,arguments)}}class us{constructor(){us.constructor_.apply(this,arguments)}static constructor_(){this._targetPM=null,this._removeCollapsed=!0,this._changePrecisionModel=!1,this._isPointwise=!1;const t=arguments[0];this._targetPM=t}static reduce(t,e){return new us(e).reduce(t)}static reducePointwise(t,e){const n=new us(e);return n.setPointwise(!0),n.reduce(t)}fixPolygonalTopology(t){let e=t;return this._changePrecisionModel||(e=this.changePM(t,this._targetPM)),Fr.bufferOp(e,0)}reducePointwise(t){let e=null;if(this._changePrecisionModel){const n=this.createFactory(t.getFactory(),this._targetPM);e=new ce(n)}else e=new ce;let n=this._removeCollapsed;return t.getDimension()>=2&&(n=!0),e.edit(t,new ls(this._targetPM,n))}changePM(t,e){return this.createEditor(t.getFactory(),e).edit(t,new ce.NoOpGeometryOperation)}setRemoveCollapsedComponents(t){this._removeCollapsed=t}createFactory(t,e){return new Pt(e,t.getSRID(),t.getCoordinateSequenceFactory())}setChangePrecisionModel(t){this._changePrecisionModel=t}reduce(t){const e=this.reducePointwise(t);return this._isPointwise?e:C(e,rt)?Fo.isValid(e)?e:this.fixPolygonalTopology(e):e}setPointwise(t){this._isPointwise=t}createEditor(t,e){if(t.getPrecisionModel()===e)return new ce;const n=this.createFactory(t,e);return new ce(n)}}class cs{constructor(){cs.constructor_.apply(this,arguments)}static constructor_(){if(this._geom=null,this._pts=null,this._start=null,this._end=null,2===arguments.length){const t=arguments[0],e=arguments[1];this._pts=t,this._start=e,this._end=e+1}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._pts=t,this._start=e,this._end=n}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._geom=t,this._pts=e,this._start=n,this._end=i}}computeDistanceLineLine(t,e){let n=o.MAX_VALUE;for(let i=this._start;i<this._end-1;i++){const r=this._pts.getCoordinate(i),o=this._pts.getCoordinate(i+1);for(let s=t._start;s<t._end-1;s++){const a=t._pts.getCoordinate(s),l=t._pts.getCoordinate(s+1),u=U.segmentToSegment(r,o,a,l);if(u<n&&(n=u,null!==e&&this.updateNearestLocationsLineLine(i,r,o,t,s,a,l,e),n<=0))return n}}return n}updateNearestLocationsPointLine(t,e,n,i,r,o){o[0]=new Br(this._geom,this._start,new y(t));const s=new Kt(i,r).closestPoint(t);o[1]=new Br(e._geom,n,new y(s))}size(){return this._end-this._start}getCoordinate(t){return this._pts.getCoordinate(this._start+t)}nearestLocations(t){const e=this.isPoint(),n=t.isPoint(),i=new Array(2).fill(null);if(e&&n){const e=this._pts.getCoordinate(this._start),n=t._pts.getCoordinate(t._start);i[0]=new Br(this._geom,this._start,new y(e)),i[1]=new Br(t._geom,t._start,new y(n))}else if(e){const e=this._pts.getCoordinate(this._start);this.computeDistancePointLine(e,t,i)}else if(n){const e=t._pts.getCoordinate(t._start);this.computeDistancePointLine(e,this,i);const n=i[0];i[0]=i[1],i[1]=n}else this.computeDistanceLineLine(t,i);return i}getEnvelope(){const t=new L;for(let e=this._start;e<this._end;e++)t.expandToInclude(this._pts.getX(e),this._pts.getY(e));return t}updateNearestLocationsLineLine(t,e,n,i,r,o,s,a){const l=new Kt(e,n),u=new Kt(o,s),c=l.closestPoints(u);a[0]=new Br(this._geom,t,new y(c[0])),a[1]=new Br(i._geom,r,new y(c[1]))}toString(){const t=new M;t.append("LINESTRING ( ");const e=new y;for(let n=this._start;n<this._end;n++)n>this._start&&t.append(", "),this._pts.getCoordinate(n,e),t.append(e.x+" "+e.y);return t.append(" )"),t.toString()}computeDistancePointLine(t,e,n){let i=o.MAX_VALUE;for(let r=e._start;r<e._end-1;r++){const o=e._pts.getCoordinate(r),s=e._pts.getCoordinate(r+1),a=U.pointToSegment(t,o,s);if(a<i&&(i=a,null!==n&&this.updateNearestLocationsPointLine(t,e,r,o,s,n),i<=0))return i}return i}isPoint(){return this._end-this._start==1}distance(t){const e=this.isPoint(),n=t.isPoint();let i=null;if(e&&n){const e=this._pts.getCoordinate(this._start),n=t._pts.getCoordinate(t._start);i=e.distance(n)}else if(e){const e=this._pts.getCoordinate(this._start);i=this.computeDistancePointLine(e,t,null)}else if(n){const e=t._pts.getCoordinate(t._start);i=this.computeDistancePointLine(e,this,null)}else i=this.computeDistanceLineLine(t,null);return i}}class hs{static addFacetSequences(t,e,n){let i=0;const r=e.size();for(;i<=r-1;){let o=i+hs.FACET_SEQUENCE_SIZE+1;o>=r-1&&(o=r);const s=new cs(t,e,i,o);n.add(s),i+=hs.FACET_SEQUENCE_SIZE}}static computeFacetSequences(t){const e=new P;return t.apply(new class{get interfaces_(){return[V]}filter(t){let n=null;(t instanceof $||t instanceof et)&&(n=t.getCoordinateSequence(),hs.addFacetSequences(t,n,e))}}),e}static build(t){const e=new Li(hs.STR_TREE_NODE_CAPACITY);for(let n=hs.computeFacetSequences(t).iterator();n.hasNext();){const t=n.next();e.insert(t.getEnvelope(),t)}return e.build(),e}}hs.FACET_SEQUENCE_SIZE=6,hs.STR_TREE_NODE_CAPACITY=4;class ps{constructor(){ps.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._minClearance=null,this._minClearancePts=null;const t=arguments[0];this._inputGeom=t}static getLine(t){return new ps(t).getLine()}static getDistance(t){return new ps(t).getDistance()}getLine(){return this.compute(),null===this._minClearancePts||null===this._minClearancePts[0]?this._inputGeom.getFactory().createLineString():this._inputGeom.getFactory().createLineString(this._minClearancePts)}compute(){if(null!==this._minClearancePts)return null;if(this._minClearancePts=new Array(2).fill(null),this._minClearance=o.MAX_VALUE,this._inputGeom.isEmpty())return null;const t=hs.build(this._inputGeom).nearestNeighbour(new fs),e=new fs;this._minClearance=e.distance(t[0],t[1]),this._minClearancePts=e.getCoordinates()}getDistance(){return this.compute(),this._minClearance}}class fs{constructor(){fs.constructor_.apply(this,arguments)}static constructor_(){this._minDist=o.MAX_VALUE,this._minPts=new Array(2).fill(null)}vertexDistance(t,e){for(let n=0;n<t.size();n++)for(let i=0;i<e.size();i++){const r=t.getCoordinate(n),o=e.getCoordinate(i);if(!r.equals2D(o)){const t=r.distance(o);if(t<this._minDist&&(this._minDist=t,this._minPts[0]=r,this._minPts[1]=o,0===t))return t}}return this._minDist}getCoordinates(){return this._minPts}segmentDistance(t,e){for(let n=0;n<t.size();n++)for(let i=1;i<e.size();i++){const r=t.getCoordinate(n),o=e.getCoordinate(i-1),s=e.getCoordinate(i);if(!r.equals2D(o)&&!r.equals2D(s)){const t=U.pointToSegment(r,o,s);if(t<this._minDist&&(this._minDist=t,this.updatePts(r,o,s),0===t))return t}}return this._minDist}distance(){if(arguments[0]instanceof bi&&arguments[1]instanceof bi){const t=arguments[1],e=arguments[0].getItem(),n=t.getItem();return this._minDist=o.MAX_VALUE,this.distance(e,n)}if(arguments[0]instanceof cs&&arguments[1]instanceof cs){const t=arguments[0],e=arguments[1];return this.vertexDistance(t,e),1===t.size()&&1===e.size()||this._minDist<=0||(this.segmentDistance(t,e),this._minDist<=0||this.segmentDistance(e,t)),this._minDist}}updatePts(t,e,n){this._minPts[0]=t;const i=new Kt(e,n);this._minPts[1]=new y(i.closestPoint(t))}get interfaces_(){return[Ti]}}ps.MinClearanceDistance=fs;class ds{constructor(){ds.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._minClearance=null,this._minClearancePts=null;const t=arguments[0];this._inputGeom=t}static getLine(t){return new ds(t).getLine()}static getDistance(t){return new ds(t).getDistance()}getLine(){return this.compute(),this._inputGeom.getFactory().createLineString(this._minClearancePts)}updateClearance(){if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];t<this._minClearance&&(this._minClearance=t,this._minClearancePts[0]=new y(e),this._minClearancePts[1]=new y(n))}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];if(t<this._minClearance){this._minClearance=t,this._minClearancePts[0]=new y(e);const r=new Kt(n,i);this._minClearancePts[1]=new y(r.closestPoint(e))}}}compute(){if(null!==this._minClearancePts)return null;this._minClearancePts=new Array(2).fill(null),this._minClearance=o.MAX_VALUE,this._inputGeom.apply(new gs(this))}getDistance(){return this.compute(),this._minClearance}}class gs{constructor(){gs.constructor_.apply(this,arguments)}static constructor_(){this.smc=null;const t=arguments[0];this.smc=t}filter(t){this.smc._inputGeom.apply(new ys(this.smc,t))}get interfaces_(){return[Y]}}class ys{constructor(){ys.constructor_.apply(this,arguments)}static constructor_(){this.smc=null,this._queryPt=null;const t=arguments[0],e=arguments[1];this.smc=t,this._queryPt=e}isGeometryChanged(){return!1}checkVertexDistance(t){const e=t.distance(this._queryPt);e>0&&this.smc.updateClearance(e,this._queryPt,t)}filter(t,e){this.checkVertexDistance(t.getCoordinate(e)),e>0&&this.checkSegmentDistance(t.getCoordinate(e-1),t.getCoordinate(e))}checkSegmentDistance(t,e){if(this._queryPt.equals2D(t)||this._queryPt.equals2D(e))return null;const n=U.pointToSegment(this._queryPt,e,t);n>0&&this.smc.updateClearance(n,this._queryPt,e,t)}isDone(){return!1}get interfaces_(){return[T]}}ds.VertexCoordinateFilter=gs,ds.ComputeMCCoordinateSequenceFilter=ys;var ms=Object.freeze({__proto__:null,CommonBits:go,CommonBitsOp:as,CommonBitsRemover:yo,EnhancedPrecisionOp:class{static union(t,e){let n=null;try{return t.union(e)}catch(t){if(!(t instanceof c))throw t;n=t}try{const i=new as(!0).union(t,e);if(!i.isValid())throw n;return i}catch(t){throw t instanceof c?n:t}}static intersection(t,e){let n=null;try{return t.intersection(e)}catch(t){if(!(t instanceof c))throw t;n=t}try{const i=new as(!0).intersection(t,e);if(!i.isValid())throw n;return i}catch(t){throw t instanceof c?n:t}}static buffer(t,e){let n=null;try{return t.buffer(e)}catch(t){if(!(t instanceof c))throw t;n=t}try{const i=new as(!0).buffer(t,e);if(!i.isValid())throw n;return i}catch(t){throw t instanceof c?n:t}}static symDifference(t,e){let n=null;try{return t.symDifference(e)}catch(t){if(!(t instanceof c))throw t;n=t}try{const i=new as(!0).symDifference(t,e);if(!i.isValid())throw n;return i}catch(t){throw t instanceof c?n:t}}static difference(t,e){let n=null;try{return t.difference(e)}catch(t){if(!(t instanceof c))throw t;n=t}try{const i=new as(!0).difference(t,e);if(!i.isValid())throw n;return i}catch(t){throw t instanceof c?n:t}}},GeometryPrecisionReducer:us,MinimumClearance:ps,SimpleMinimumClearance:ds});class _s{constructor(){_s.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._usePt=null,this._distanceTolerance=null,this._seg=new Kt;const t=arguments[0];this._pts=t}static simplify(t,e){const n=new _s(t);return n.setDistanceTolerance(e),n.simplify()}simplifySection(t,e){if(t+1===e)return null;this._seg.p0=this._pts[t],this._seg.p1=this._pts[e];let n=-1,i=t;for(let r=t+1;r<e;r++){const t=this._seg.distance(this._pts[r]);t>n&&(n=t,i=r)}if(n<=this._distanceTolerance)for(let n=t+1;n<e;n++)this._usePt[n]=!1;else this.simplifySection(t,i),this.simplifySection(i,e)}setDistanceTolerance(t){this._distanceTolerance=t}simplify(){this._usePt=new Array(this._pts.length).fill(null);for(let t=0;t<this._pts.length;t++)this._usePt[t]=!0;this.simplifySection(0,this._pts.length-1);const t=new S;for(let e=0;e<this._pts.length;e++)this._usePt[e]&&t.add(new y(this._pts[e]));return t.toCoordinateArray()}}class vs{constructor(){vs.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distanceTolerance=null,this._isEnsureValidTopology=!0;const t=arguments[0];this._inputGeom=t}static simplify(t,e){const n=new vs(t);return n.setDistanceTolerance(e),n.getResultGeometry()}setEnsureValid(t){this._isEnsureValidTopology=t}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():new xs(this._isEnsureValidTopology,this._distanceTolerance).transform(this._inputGeom)}setDistanceTolerance(t){if(t<0)throw new i("Tolerance must be non-negative");this._distanceTolerance=t}}class xs extends ge{constructor(){super(),xs.constructor_.apply(this,arguments)}static constructor_(){this._isEnsureValidTopology=!0,this._distanceTolerance=null;const t=arguments[0],e=arguments[1];this._isEnsureValidTopology=t,this._distanceTolerance=e}transformPolygon(t,e){if(t.isEmpty())return null;const n=super.transformPolygon.call(this,t,e);return e instanceof _t?n:this.createValidArea(n)}createValidArea(t){return this._isEnsureValidTopology?t.buffer(0):t}transformCoordinates(t,e){const n=t.toCoordinateArray();let i=null;return i=0===n.length?new Array(0).fill(null):_s.simplify(n,this._distanceTolerance),this._factory.getCoordinateSequenceFactory().create(i)}transformMultiPolygon(t,e){const n=super.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)}transformLinearRing(t,e){const n=e instanceof ot,i=super.transformLinearRing.call(this,t,e);return!n||i instanceof pt?i:null}}vs.DPTransformer=xs;class Cs extends Kt{constructor(){super(),Cs.constructor_.apply(this,arguments)}static constructor_(){if(this._parent=null,this._index=null,2===arguments.length){const t=arguments[0],e=arguments[1];Cs.constructor_.call(this,t,e,null,-1)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];Kt.constructor_.call(this,t,e),this._parent=n,this._index=i}}getIndex(){return this._index}getParent(){return this._parent}}class ws{constructor(){ws.constructor_.apply(this,arguments)}static constructor_(){if(this._parentLine=null,this._segs=null,this._resultSegs=new P,this._minimumSize=null,1===arguments.length){const t=arguments[0];ws.constructor_.call(this,t,2)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._parentLine=t,this._minimumSize=e,this.init()}}static extractCoordinates(t){const e=new Array(t.size()+1).fill(null);let n=null;for(let i=0;i<t.size();i++)n=t.get(i),e[i]=n.p0;return e[e.length-1]=n.p1,e}addToResult(t){this._resultSegs.add(t)}asLineString(){return this._parentLine.getFactory().createLineString(ws.extractCoordinates(this._resultSegs))}getResultSize(){const t=this._resultSegs.size();return 0===t?0:t+1}getParent(){return this._parentLine}getSegment(t){return this._segs[t]}getParentCoordinates(){return this._parentLine.getCoordinates()}getMinimumSize(){return this._minimumSize}asLinearRing(){return this._parentLine.getFactory().createLinearRing(ws.extractCoordinates(this._resultSegs))}getSegments(){return this._segs}init(){const t=this._parentLine.getCoordinates();this._segs=new Array(t.length-1).fill(null);for(let e=0;e<t.length-1;e++){const n=new Cs(t[e],t[e+1],this._parentLine,e);this._segs[e]=n}}getResultCoordinates(){return ws.extractCoordinates(this._resultSegs)}}class bs{constructor(){bs.constructor_.apply(this,arguments)}static constructor_(){this._index=new xi}remove(t){this._index.remove(new L(t.p0,t.p1),t)}add(){if(arguments[0]instanceof ws){const t=arguments[0].getSegments();for(let e=0;e<t.length;e++){const n=t[e];this.add(n)}}else if(arguments[0]instanceof Kt){const t=arguments[0];this._index.insert(new L(t.p0,t.p1),t)}}query(t){const e=new L(t.p0,t.p1),n=new Es(t);return this._index.query(e,n),n.getItems()}}class Es{constructor(){Es.constructor_.apply(this,arguments)}static constructor_(){this._querySeg=null,this._items=new P;const t=arguments[0];this._querySeg=t}visitItem(t){const e=t;L.intersects(e.p0,e.p1,this._querySeg.p0,this._querySeg.p1)&&this._items.add(t)}getItems(){return this._items}get interfaces_(){return[Re]}}class Is{constructor(){Is.constructor_.apply(this,arguments)}static constructor_(){this._li=new Wt,this._inputIndex=new bs,this._outputIndex=new bs,this._line=null,this._linePts=null,this._distanceTolerance=0;const t=arguments[0],e=arguments[1];this._inputIndex=t,this._outputIndex=e}static isInLineSection(t,e,n){if(n.getParent()!==t.getParent())return!1;const i=n.getIndex();return i>=e[0]&&i<e[1]}flatten(t,e){const n=this._linePts[t],i=this._linePts[e],r=new Kt(n,i);return this.remove(this._line,t,e),this._outputIndex.add(r),r}hasBadIntersection(t,e,n){return!!this.hasBadOutputIntersection(n)||!!this.hasBadInputIntersection(t,e,n)}setDistanceTolerance(t){this._distanceTolerance=t}simplifySection(t,e,n){n+=1;const i=new Array(2).fill(null);if(t+1===e){const e=this._line.getSegment(t);return this._line.addToResult(e),null}let r=!0;this._line.getResultSize()<this._line.getMinimumSize()&&n+1<this._line.getMinimumSize()&&(r=!1);const o=new Array(1).fill(null),s=this.findFurthestPoint(this._linePts,t,e,o);o[0]>this._distanceTolerance&&(r=!1);const a=new Kt;if(a.p0=this._linePts[t],a.p1=this._linePts[e],i[0]=t,i[1]=e,this.hasBadIntersection(this._line,i,a)&&(r=!1),r){const n=this.flatten(t,e);return this._line.addToResult(n),null}this.simplifySection(t,s,n),this.simplifySection(s,e,n)}hasBadOutputIntersection(t){for(let e=this._outputIndex.query(t).iterator();e.hasNext();){const n=e.next();if(this.hasInteriorIntersection(n,t))return!0}return!1}findFurthestPoint(t,e,n,i){const r=new Kt;r.p0=t[e],r.p1=t[n];let o=-1,s=e;for(let i=e+1;i<n;i++){const e=t[i],n=r.distance(e);n>o&&(o=n,s=i)}return i[0]=o,s}simplify(t){this._line=t,this._linePts=t.getParentCoordinates(),this.simplifySection(0,this._linePts.length-1,0)}remove(t,e,n){for(let i=e;i<n;i++){const e=t.getSegment(i);this._inputIndex.remove(e)}}hasInteriorIntersection(t,e){return this._li.computeIntersection(t.p0,t.p1,e.p0,e.p1),this._li.isInteriorIntersection()}hasBadInputIntersection(t,e,n){for(let i=this._inputIndex.query(n).iterator();i.hasNext();){const r=i.next();if(this.hasInteriorIntersection(r,n)){if(Is.isInLineSection(t,e,r))continue;return!0}}return!1}}class Ps{constructor(){Ps.constructor_.apply(this,arguments)}static constructor_(){this._inputIndex=new bs,this._outputIndex=new bs,this._distanceTolerance=0}setDistanceTolerance(t){this._distanceTolerance=t}simplify(t){for(let e=t.iterator();e.hasNext();)this._inputIndex.add(e.next());for(let e=t.iterator();e.hasNext();){const t=new Is(this._inputIndex,this._outputIndex);t.setDistanceTolerance(this._distanceTolerance),t.simplify(e.next())}}}class Ns{constructor(){Ns.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._lineSimplifier=new Ps,this._linestringMap=null;const t=arguments[0];this._inputGeom=t}static simplify(t,e){const n=new Ns(t);return n.setDistanceTolerance(e),n.getResultGeometry()}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():(this._linestringMap=new wt,this._inputGeom.apply(new Ts(this)),this._lineSimplifier.simplify(this._linestringMap.values()),new Ss(this._linestringMap).transform(this._inputGeom))}setDistanceTolerance(t){if(t<0)throw new i("Tolerance must be non-negative");this._lineSimplifier.setDistanceTolerance(t)}}class Ss extends ge{constructor(){super(),Ss.constructor_.apply(this,arguments)}static constructor_(){this._linestringMap=null;const t=arguments[0];this._linestringMap=t}transformCoordinates(t,e){if(0===t.size())return null;if(e instanceof $){const t=this._linestringMap.get(e);return this.createCoordinateSequence(t.getResultCoordinates())}return super.transformCoordinates.call(this,t,e)}}class Ts{constructor(){Ts.constructor_.apply(this,arguments)}static constructor_(){this.tps=null;const t=arguments[0];this.tps=t}filter(t){if(t instanceof $){const e=t;if(e.isEmpty())return null;const n=e.isClosed()?4:2,i=new ws(e,n);this.tps._linestringMap.put(e,i)}}get interfaces_(){return[V]}}Ns.LineStringTransformer=Ss,Ns.LineStringMapBuilderFilter=Ts;class Ls{constructor(){Ls.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._tolerance=null;const t=arguments[0],e=arguments[1];this._pts=t,this._tolerance=e*e}static simplify(t,e){return new Ls(t,e).simplify()}simplifyVertex(t){let e=t,n=e.getArea(),i=null;for(;null!==e;){const t=e.getArea();t<n&&(n=t,i=e),e=e._next}return null!==i&&n<this._tolerance&&i.remove(),t.isLive()?n:-1}simplify(){const t=Ms.buildLine(this._pts);let e=this._tolerance;do{e=this.simplifyVertex(t)}while(e<this._tolerance);const n=t.getCoordinates();return n.length<2?[n[0],new y(n[0])]:n}}class Ms{constructor(){Ms.constructor_.apply(this,arguments)}static constructor_(){this._pt=null,this._prev=null,this._next=null,this._area=Ms.MAX_AREA,this._isLive=!0;const t=arguments[0];this._pt=t}static buildLine(t){let e=null,n=null;for(let i=0;i<t.length;i++){const r=new Ms(t[i]);null===e&&(e=r),r.setPrev(n),null!==n&&(n.setNext(r),n.updateArea()),n=r}return e}getCoordinates(){const t=new S;let e=this;do{t.add(e._pt,!1),e=e._next}while(null!==e);return t.toCoordinateArray()}getArea(){return this._area}updateArea(){if(null===this._prev||null===this._next)return this._area=Ms.MAX_AREA,null;this._area=Math.abs(ee.area(this._prev._pt,this._pt,this._next._pt))}remove(){const t=this._prev,e=this._next;let n=null;return null!==this._prev&&(this._prev.setNext(e),this._prev.updateArea(),n=this._prev),null!==this._next&&(this._next.setPrev(t),this._next.updateArea(),null===n&&(n=this._next)),this._isLive=!1,n}isLive(){return this._isLive}setPrev(t){this._prev=t}setNext(t){this._next=t}}Ms.MAX_AREA=o.MAX_VALUE,Ls.VWVertex=Ms;class Os{constructor(){Os.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distanceTolerance=null,this._isEnsureValidTopology=!0;const t=arguments[0];this._inputGeom=t}static simplify(t,e){const n=new Os(t);return n.setDistanceTolerance(e),n.getResultGeometry()}setEnsureValid(t){this._isEnsureValidTopology=t}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():new Rs(this._isEnsureValidTopology,this._distanceTolerance).transform(this._inputGeom)}setDistanceTolerance(t){if(t<0)throw new i("Tolerance must be non-negative");this._distanceTolerance=t}}class Rs extends ge{constructor(){super(),Rs.constructor_.apply(this,arguments)}static constructor_(){this._isEnsureValidTopology=!0,this._distanceTolerance=null;const t=arguments[0],e=arguments[1];this._isEnsureValidTopology=t,this._distanceTolerance=e}transformPolygon(t,e){if(t.isEmpty())return null;const n=super.transformPolygon.call(this,t,e);return e instanceof _t?n:this.createValidArea(n)}createValidArea(t){return this._isEnsureValidTopology?t.buffer(0):t}transformCoordinates(t,e){const n=t.toCoordinateArray();let i=null;return i=0===n.length?new Array(0).fill(null):Ls.simplify(n,this._distanceTolerance),this._factory.getCoordinateSequenceFactory().create(i)}transformMultiPolygon(t,e){const n=super.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)}transformLinearRing(t,e){const n=e instanceof ot,i=super.transformLinearRing.call(this,t,e);return!n||i instanceof pt?i:null}}Os.VWTransformer=Rs;var As=Object.freeze({__proto__:null,DouglasPeuckerSimplifier:vs,TopologyPreservingSimplifier:Ns,VWSimplifier:Os});class Ds{constructor(){Ds.constructor_.apply(this,arguments)}static constructor_(){this._seg=null,this._segLen=null,this._splitPt=null,this._minimumLen=0;const t=arguments[0];this._seg=t,this._segLen=t.getLength()}static pointAlongReverse(t,e){const n=new y;return n.x=t.p1.x-e*(t.p1.x-t.p0.x),n.y=t.p1.y-e*(t.p1.y-t.p0.y),n}splitAt(){if(1===arguments.length){const t=arguments[0],e=this._minimumLen/this._segLen;if(t.distance(this._seg.p0)<this._minimumLen)return this._splitPt=this._seg.pointAlong(e),null;if(t.distance(this._seg.p1)<this._minimumLen)return this._splitPt=Ds.pointAlongReverse(this._seg,e),null;this._splitPt=t}else if(2===arguments.length){const t=arguments[0],e=arguments[1],n=this.getConstrainedLength(t)/this._segLen;e.equals2D(this._seg.p0)?this._splitPt=this._seg.pointAlong(n):this._splitPt=Ds.pointAlongReverse(this._seg,n)}}setMinimumLength(t){this._minimumLen=t}getConstrainedLength(t){return t<this._minimumLen?this._minimumLen:t}getSplitPoint(){return this._splitPt}}class Fs{findSplitPoint(t,e){}}class ks{static projectedSplitPoint(t,e){return t.getLineSegment().project(e)}findSplitPoint(t,e){const n=t.getLineSegment(),i=n.getLength()/2,r=new Ds(n),o=ks.projectedSplitPoint(t,e);let s=2*o.distance(e)*.8;return s>i&&(s=i),r.setMinimumLength(s),r.splitAt(o),r.getSplitPoint()}get interfaces_(){return[Fs]}}class Bs{static triArea(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)}static isInCircleDDNormalized(t,e,n,i){const r=D.valueOf(t.x).selfSubtract(i.x),o=D.valueOf(t.y).selfSubtract(i.y),s=D.valueOf(e.x).selfSubtract(i.x),a=D.valueOf(e.y).selfSubtract(i.y),l=D.valueOf(n.x).selfSubtract(i.x),u=D.valueOf(n.y).selfSubtract(i.y),c=r.multiply(a).selfSubtract(s.multiply(o)),h=s.multiply(u).selfSubtract(l.multiply(a)),p=l.multiply(o).selfSubtract(r.multiply(u)),f=r.multiply(r).selfAdd(o.multiply(o)),d=s.multiply(s).selfAdd(a.multiply(a)),g=l.multiply(l).selfAdd(u.multiply(u));return f.selfMultiply(h).selfAdd(d.selfMultiply(p)).selfAdd(g.selfMultiply(c)).doubleValue()>0}static checkRobustInCircle(t,e,n,i){const r=Bs.isInCircleNonRobust(t,e,n,i),o=Bs.isInCircleDDSlow(t,e,n,i),s=Bs.isInCircleCC(t,e,n,i),a=ee.circumcentre(t,e,n);j.out.println("p radius diff a = "+Math.abs(i.distance(a)-t.distance(a))/t.distance(a)),r===o&&r===s||(j.out.println("inCircle robustness failure (double result = "+r+", DD result = "+o+", CC result = "+s+")"),j.out.println(Yt.toLineString(new yt([t,e,n,i]))),j.out.println("Circumcentre = "+Yt.toPoint(a)+" radius = "+t.distance(a)),j.out.println("p radius diff a = "+Math.abs(i.distance(a)/t.distance(a)-1)),j.out.println("p radius diff b = "+Math.abs(i.distance(a)/e.distance(a)-1)),j.out.println("p radius diff c = "+Math.abs(i.distance(a)/n.distance(a)-1)),j.out.println())}static isInCircleDDFast(t,e,n,i){const r=D.sqr(t.x).selfAdd(D.sqr(t.y)).selfMultiply(Bs.triAreaDDFast(e,n,i)),o=D.sqr(e.x).selfAdd(D.sqr(e.y)).selfMultiply(Bs.triAreaDDFast(t,n,i)),s=D.sqr(n.x).selfAdd(D.sqr(n.y)).selfMultiply(Bs.triAreaDDFast(t,e,i)),a=D.sqr(i.x).selfAdd(D.sqr(i.y)).selfMultiply(Bs.triAreaDDFast(t,e,n));return r.selfSubtract(o).selfAdd(s).selfSubtract(a).doubleValue()>0}static isInCircleCC(t,e,n,i){const r=ee.circumcentre(t,e,n),o=t.distance(r);return i.distance(r)-o<=0}static isInCircleNormalized(t,e,n,i){const r=t.x-i.x,o=t.y-i.y,s=e.x-i.x,a=e.y-i.y,l=n.x-i.x,u=n.y-i.y;return(r*r+o*o)*(s*u-l*a)+(s*s+a*a)*(l*o-r*u)+(l*l+u*u)*(r*a-s*o)>0}static isInCircleDDSlow(t,e,n,i){const r=D.valueOf(i.x),o=D.valueOf(i.y),s=D.valueOf(t.x),a=D.valueOf(t.y),l=D.valueOf(e.x),u=D.valueOf(e.y),c=D.valueOf(n.x),h=D.valueOf(n.y),p=s.multiply(s).add(a.multiply(a)).multiply(Bs.triAreaDDSlow(l,u,c,h,r,o)),f=l.multiply(l).add(u.multiply(u)).multiply(Bs.triAreaDDSlow(s,a,c,h,r,o)),d=c.multiply(c).add(h.multiply(h)).multiply(Bs.triAreaDDSlow(s,a,l,u,r,o)),g=r.multiply(r).add(o.multiply(o)).multiply(Bs.triAreaDDSlow(s,a,l,u,c,h));return p.subtract(f).add(d).subtract(g).doubleValue()>0}static isInCircleNonRobust(t,e,n,i){return(t.x*t.x+t.y*t.y)*Bs.triArea(e,n,i)-(e.x*e.x+e.y*e.y)*Bs.triArea(t,n,i)+(n.x*n.x+n.y*n.y)*Bs.triArea(t,e,i)-(i.x*i.x+i.y*i.y)*Bs.triArea(t,e,n)>0}static isInCircleRobust(t,e,n,i){return Bs.isInCircleNormalized(t,e,n,i)}static triAreaDDSlow(t,e,n,i,r,o){return n.subtract(t).multiply(o.subtract(e)).subtract(i.subtract(e).multiply(r.subtract(t)))}static triAreaDDFast(t,e,n){const i=D.valueOf(e.x).selfSubtract(t.x).selfMultiply(D.valueOf(n.y).selfSubtract(t.y)),r=D.valueOf(e.y).selfSubtract(t.y).selfMultiply(D.valueOf(n.x).selfSubtract(t.x));return i.selfSubtract(r)}}class Gs{constructor(){Gs.constructor_.apply(this,arguments)}static constructor_(){if(this._p=null,1===arguments.length){const t=arguments[0];this._p=new y(t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._p=new y(t,e)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._p=new y(t,e,n)}}static interpolateZ(){if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=e.distance(n),r=t.distance(e),o=n.getZ()-e.getZ();return e.getZ()+o*(r/i)}if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=e.x,o=e.y,s=n.x-r,a=i.x-r,l=n.y-o,u=i.y-o,c=s*u-a*l,h=t.x-r,p=t.y-o,f=(u*h-a*p)/c,d=(-l*h+s*p)/c;return e.getZ()+f*(n.getZ()-e.getZ())+d*(i.getZ()-e.getZ())}}circleCenter(t,e){const n=new Gs(this.getX(),this.getY()),i=this.bisector(n,t),r=this.bisector(t,e),o=new te(i,r);let s=null;try{s=new Gs(o.getX(),o.getY())}catch(i){if(!(i instanceof $t))throw i;j.err.println("a: "+n+"  b: "+t+"  c: "+e),j.err.println(i)}return s}dot(t){return this._p.x*t.getX()+this._p.y*t.getY()}magn(){return Math.sqrt(this._p.x*this._p.x+this._p.y*this._p.y)}getZ(){return this._p.getZ()}bisector(t,e){const n=e.getX()-t.getX(),i=e.getY()-t.getY(),r=new te(t.getX()+n/2,t.getY()+i/2,1),o=new te(t.getX()-i+n/2,t.getY()+n+i/2,1);return new te(r,o)}equals(){if(1===arguments.length){const t=arguments[0];return this._p.x===t.getX()&&this._p.y===t.getY()}if(2===arguments.length){const t=arguments[0],e=arguments[1];return this._p.distance(t.getCoordinate())<e}}getCoordinate(){return this._p}isInCircle(t,e,n){return Bs.isInCircleRobust(t._p,e._p,n._p,this._p)}interpolateZValue(t,e,n){const i=t.getX(),r=t.getY(),o=e.getX()-i,s=n.getX()-i,a=e.getY()-r,l=n.getY()-r,u=o*l-s*a,c=this.getX()-i,h=this.getY()-r,p=(l*c-s*h)/u,f=(-a*c+o*h)/u;return t.getZ()+p*(e.getZ()-t.getZ())+f*(n.getZ()-t.getZ())}midPoint(t){const e=(this._p.x+t.getX())/2,n=(this._p.y+t.getY())/2,i=(this._p.getZ()+t.getZ())/2;return new Gs(e,n,i)}rightOf(t){return this.isCCW(t.dest(),t.orig())}isCCW(t,e){return(t._p.x-this._p.x)*(e._p.y-this._p.y)-(t._p.y-this._p.y)*(e._p.x-this._p.x)>0}getX(){return this._p.x}crossProduct(t){return this._p.x*t.getY()-this._p.y*t.getX()}setZ(t){this._p.setZ(t)}times(t){return new Gs(t*this._p.x,t*this._p.y)}cross(){return new Gs(this._p.y,-this._p.x)}leftOf(t){return this.isCCW(t.orig(),t.dest())}toString(){return"POINT ("+this._p.x+" "+this._p.y+")"}sub(t){return new Gs(this._p.x-t.getX(),this._p.y-t.getY())}getY(){return this._p.y}classify(t,e){const n=e.sub(t),i=this.sub(t),r=n.crossProduct(i);return r>0?Gs.LEFT:r<0?Gs.RIGHT:n.getX()*i.getX()<0||n.getY()*i.getY()<0?Gs.BEHIND:n.magn()<i.magn()?Gs.BEYOND:t.equals(this)?Gs.ORIGIN:e.equals(this)?Gs.DESTINATION:Gs.BETWEEN}sum(t){return new Gs(this._p.x+t.getX(),this._p.y+t.getY())}distance(t,e){return Math.sqrt(Math.pow(e.getX()-t.getX(),2)+Math.pow(e.getY()-t.getY(),2))}circumRadiusRatio(t,e){const n=this.circleCenter(t,e),i=this.distance(n,t);let r=this.distance(this,t),o=this.distance(t,e);return o<r&&(r=o),o=this.distance(e,this),o<r&&(r=o),i/r}}Gs.LEFT=0,Gs.RIGHT=1,Gs.BEYOND=2,Gs.BEHIND=3,Gs.BETWEEN=4,Gs.ORIGIN=5,Gs.DESTINATION=6;class js extends Gs{constructor(){super(),js.constructor_.apply(this,arguments)}static constructor_(){this._isOnConstraint=null,this._constraint=null;const t=arguments[0];Gs.constructor_.call(this,t)}getConstraint(){return this._constraint}setOnConstraint(t){this._isOnConstraint=t}merge(t){t._isOnConstraint&&(this._isOnConstraint=!0,this._constraint=t._constraint)}isOnConstraint(){return this._isOnConstraint}setConstraint(t){this._isOnConstraint=!0,this._constraint=t}}class zs{constructor(){zs.constructor_.apply(this,arguments)}static constructor_(){this._rot=null,this._vertex=null,this._next=null,this._data=null}static makeEdge(t,e){const n=new zs,i=new zs,r=new zs,o=new zs;n._rot=i,i._rot=r,r._rot=o,o._rot=n,n.setNext(n),i.setNext(o),r.setNext(r),o.setNext(i);const s=n;return s.setOrig(t),s.setDest(e),s}static swap(t){const e=t.oPrev(),n=t.sym().oPrev();zs.splice(t,e),zs.splice(t.sym(),n),zs.splice(t,e.lNext()),zs.splice(t.sym(),n.lNext()),t.setOrig(e.dest()),t.setDest(n.dest())}static splice(t,e){const n=t.oNext().rot(),i=e.oNext().rot(),r=e.oNext(),o=t.oNext(),s=i.oNext(),a=n.oNext();t.setNext(r),e.setNext(o),n.setNext(s),i.setNext(a)}static connect(t,e){const n=zs.makeEdge(t.dest(),e.orig());return zs.splice(n,t.lNext()),zs.splice(n.sym(),e),n}equalsNonOriented(t){return!!this.equalsOriented(t)||!!this.equalsOriented(t.sym())}toLineSegment(){return new Kt(this._vertex.getCoordinate(),this.dest().getCoordinate())}dest(){return this.sym().orig()}oNext(){return this._next}equalsOriented(t){return!(!this.orig().getCoordinate().equals2D(t.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(t.dest().getCoordinate()))}dNext(){return this.sym().oNext().sym()}lPrev(){return this._next.sym()}rPrev(){return this.sym().oNext()}rot(){return this._rot}oPrev(){return this._rot._next._rot}sym(){return this._rot._rot}setOrig(t){this._vertex=t}lNext(){return this.invRot().oNext().rot()}getLength(){return this.orig().getCoordinate().distance(this.dest().getCoordinate())}invRot(){return this._rot.sym()}setDest(t){this.sym().setOrig(t)}setData(t){this._data=t}getData(){return this._data}delete(){this._rot=null}orig(){return this._vertex}rNext(){return this._rot._next.invRot()}toString(){const t=this._vertex.getCoordinate(),e=this.dest().getCoordinate();return Yt.toLineString(t,e)}isLive(){return null!==this._rot}getPrimary(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()}dPrev(){return this.invRot().oNext().invRot()}setNext(t){this._next=t}}class Us{constructor(){Us.constructor_.apply(this,arguments)}static constructor_(){this._subdiv=null,this._isUsingTolerance=!1;const t=arguments[0];this._subdiv=t,this._isUsingTolerance=t.getTolerance()>0}insertSite(t){let e=this._subdiv.locate(t);if(this._subdiv.isVertexOfEdge(e,t))return e;this._subdiv.isOnEdge(e,t.getCoordinate())&&(e=e.oPrev(),this._subdiv.delete(e.oNext()));let n=this._subdiv.makeEdge(e.orig(),t);zs.splice(n,e);const i=n;do{n=this._subdiv.connect(e,n.sym()),e=n.oPrev()}while(e.lNext()!==i);for(;;){const r=e.oPrev();if(r.dest().rightOf(e)&&t.isInCircle(e.orig(),r.dest(),e.dest()))zs.swap(e),e=e.oPrev();else{if(e.oNext()===i)return n;e=e.oNext().lPrev()}}}insertSites(t){for(let e=t.iterator();e.hasNext();){const t=e.next();this.insertSite(t)}}}class qs{locate(t){}}class Vs{constructor(){Vs.constructor_.apply(this,arguments)}static constructor_(){this._subdiv=null,this._lastEdge=null;const t=arguments[0];this._subdiv=t,this.init()}init(){this._lastEdge=this.findEdge()}locate(t){this._lastEdge.isLive()||this.init();const e=this._subdiv.locateFromEdge(t,this._lastEdge);return this._lastEdge=e,e}findEdge(){return this._subdiv.getEdges().iterator().next()}get interfaces_(){return[qs]}}class Hs extends c{constructor(){super(),Hs.constructor_.apply(this,arguments)}static constructor_(){if(this._seg=null,1===arguments.length){if("string"==typeof arguments[0]){const t=arguments[0];c.constructor_.call(this,t)}else if(arguments[0]instanceof Kt){const t=arguments[0];c.constructor_.call(this,"Locate failed to converge (at edge: "+t+").  Possible causes include invalid Subdivision topology or very close sites"),this._seg=new Kt(t)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];c.constructor_.call(this,Hs.msgWithSpatial(t,e)),this._seg=new Kt(e)}}static msgWithSpatial(t,e){return null!==e?t+" [ "+e+" ]":t}getSegment(){return this._seg}}class Ys{visit(t){}}class Xs{constructor(){Xs.constructor_.apply(this,arguments)}static constructor_(){this._visitedKey=0,this._quadEdges=new P,this._startingEdge=null,this._tolerance=null,this._edgeCoincidenceTolerance=null,this._frameVertex=new Array(3).fill(null),this._frameEnv=null,this._locator=null,this._seg=new Kt,this._triEdges=new Array(3).fill(null);const t=arguments[0],e=arguments[1];this._tolerance=e,this._edgeCoincidenceTolerance=e/Xs.EDGE_COINCIDENCE_TOL_FACTOR,this.createFrame(t),this._startingEdge=this.initSubdiv(),this._locator=new Vs(this)}static getTriangleEdges(t,e){if(e[0]=t,e[1]=e[0].lNext(),e[2]=e[1].lNext(),e[2].lNext()!==e[0])throw new i("Edges do not form a triangle")}getTriangleVertices(t){const e=new Zs;return this.visitTriangles(e,t),e.getTriangleVertices()}isFrameVertex(t){return!!t.equals(this._frameVertex[0])||!!t.equals(this._frameVertex[1])||!!t.equals(this._frameVertex[2])}isVertexOfEdge(t,e){return!(!e.equals(t.orig(),this._tolerance)&&!e.equals(t.dest(),this._tolerance))}connect(t,e){const n=zs.connect(t,e);return this._quadEdges.add(n),n}getVoronoiCellPolygon(t,e){const n=new P,i=t;do{const e=t.rot().orig().getCoordinate();n.add(e),t=t.oPrev()}while(t!==i);const r=new S;r.addAll(n,!1),r.closeRing(),r.size()<4&&(j.out.println(r),r.add(r.get(r.size()-1),!0));const o=r.toCoordinateArray(),s=e.createPolygon(e.createLinearRing(o)),a=i.orig();return s.setUserData(a.getCoordinate()),s}setLocator(t){this._locator=t}initSubdiv(){const t=this.makeEdge(this._frameVertex[0],this._frameVertex[1]),e=this.makeEdge(this._frameVertex[1],this._frameVertex[2]);zs.splice(t.sym(),e);const n=this.makeEdge(this._frameVertex[2],this._frameVertex[0]);return zs.splice(e.sym(),n),zs.splice(n.sym(),t),t}isFrameBorderEdge(t){const e=new Array(3).fill(null);Xs.getTriangleEdges(t,e);const n=new Array(3).fill(null);Xs.getTriangleEdges(t.sym(),n);const i=t.lNext().dest();if(this.isFrameVertex(i))return!0;const r=t.sym().lNext().dest();return!!this.isFrameVertex(r)}makeEdge(t,e){const n=zs.makeEdge(t,e);return this._quadEdges.add(n),n}visitTriangles(t,e){this._visitedKey++;const n=new tn;n.push(this._startingEdge);const i=new xt;for(;!n.empty();){const r=n.pop();if(!i.contains(r)){const o=this.fetchTriangleToVisit(r,n,e,i);null!==o&&t.visit(o)}}}isFrameEdge(t){return!(!this.isFrameVertex(t.orig())&&!this.isFrameVertex(t.dest()))}isOnEdge(t,e){return this._seg.setCoordinates(t.orig().getCoordinate(),t.dest().getCoordinate()),this._seg.distance(e)<this._edgeCoincidenceTolerance}getEnvelope(){return new L(this._frameEnv)}createFrame(t){const e=t.getWidth(),n=t.getHeight();let i=0;i=e>n?10*e:10*n,this._frameVertex[0]=new Gs((t.getMaxX()+t.getMinX())/2,t.getMaxY()+i),this._frameVertex[1]=new Gs(t.getMinX()-i,t.getMinY()-i),this._frameVertex[2]=new Gs(t.getMaxX()+i,t.getMinY()-i),this._frameEnv=new L(this._frameVertex[0].getCoordinate(),this._frameVertex[1].getCoordinate()),this._frameEnv.expandToInclude(this._frameVertex[2].getCoordinate())}getTriangleCoordinates(t){const e=new Js;return this.visitTriangles(e,t),e.getTriangles()}getVertices(t){const e=new xt;for(let n=this._quadEdges.iterator();n.hasNext();){const i=n.next(),r=i.orig();!t&&this.isFrameVertex(r)||e.add(r);const o=i.dest();!t&&this.isFrameVertex(o)||e.add(o)}return e}fetchTriangleToVisit(t,e,n,i){let r=t,o=0,s=!1;do{this._triEdges[o]=r,this.isFrameEdge(r)&&(s=!0);const t=r.sym();i.contains(t)||e.push(t),i.add(r),o++,r=r.lNext()}while(r!==t);return s&&!n?null:this._triEdges}getEdges(){if(0===arguments.length)return this._quadEdges;if(1===arguments.length){const t=arguments[0],e=this.getPrimaryEdges(!1),n=new Array(e.size()).fill(null);let i=0;for(let r=e.iterator();r.hasNext();){const e=r.next();n[i++]=t.createLineString([e.orig().getCoordinate(),e.dest().getCoordinate()])}return t.createMultiLineString(n)}}getVertexUniqueEdges(t){const e=new P,n=new xt;for(let i=this._quadEdges.iterator();i.hasNext();){const r=i.next(),o=r.orig();n.contains(o)||(n.add(o),!t&&this.isFrameVertex(o)||e.add(r));const s=r.sym(),a=s.orig();n.contains(a)||(n.add(a),!t&&this.isFrameVertex(a)||e.add(s))}return e}getTriangleEdges(t){const e=new Ks;return this.visitTriangles(e,t),e.getTriangleEdges()}getPrimaryEdges(t){this._visitedKey++;const e=new P,n=new tn;n.push(this._startingEdge);const i=new xt;for(;!n.empty();){const r=n.pop();if(!i.contains(r)){const o=r.getPrimary();!t&&this.isFrameEdge(o)||e.add(o),n.push(r.oNext()),n.push(r.sym().oNext()),i.add(r),i.add(r.sym())}}return e}delete(t){zs.splice(t,t.oPrev()),zs.splice(t.sym(),t.sym().oPrev());const e=t.sym(),n=t.rot(),i=t.rot().sym();this._quadEdges.remove(t),this._quadEdges.remove(e),this._quadEdges.remove(n),this._quadEdges.remove(i),t.delete(),e.delete(),n.delete(),i.delete()}locateFromEdge(t,e){let n=0;const i=this._quadEdges.size();let r=e;for(;;){if(n++,n>i)throw new Hs(r.toLineSegment());if(t.equals(r.orig())||t.equals(r.dest()))break;if(t.rightOf(r))r=r.sym();else if(t.rightOf(r.oNext())){if(t.rightOf(r.dPrev()))break;r=r.dPrev()}else r=r.oNext()}return r}getTolerance(){return this._tolerance}getVoronoiCellPolygons(t){this.visitTriangles(new Ws,!0);const e=new P;for(let n=this.getVertexUniqueEdges(!1).iterator();n.hasNext();){const i=n.next();e.add(this.getVoronoiCellPolygon(i,t))}return e}getVoronoiDiagram(t){const e=this.getVoronoiCellPolygons(t);return t.createGeometryCollection(Pt.toGeometryArray(e))}getTriangles(t){const e=this.getTriangleCoordinates(!1),n=new Array(e.size()).fill(null);let i=0;for(let r=e.iterator();r.hasNext();){const e=r.next();n[i++]=t.createPolygon(t.createLinearRing(e))}return t.createGeometryCollection(n)}insertSite(t){let e=this.locate(t);if(t.equals(e.orig(),this._tolerance)||t.equals(e.dest(),this._tolerance))return e;let n=this.makeEdge(e.orig(),t);zs.splice(n,e);const i=n;do{n=this.connect(e,n.sym()),e=n.oPrev()}while(e.lNext()!==i);return i}locate(){if(1===arguments.length){if(arguments[0]instanceof Gs){const t=arguments[0];return this._locator.locate(t)}if(arguments[0]instanceof y){const t=arguments[0];return this._locator.locate(new Gs(t))}}else if(2===arguments.length){const t=arguments[0],e=arguments[1],n=this._locator.locate(new Gs(t));if(null===n)return null;let i=n;n.dest().getCoordinate().equals2D(t)&&(i=n.sym());let r=i;do{if(r.dest().getCoordinate().equals2D(e))return r;r=r.oNext()}while(r!==i);return null}}}class Ws{visit(t){const e=t[0].orig().getCoordinate(),n=t[1].orig().getCoordinate(),i=t[2].orig().getCoordinate(),r=ee.circumcentreDD(e,n,i),o=new Gs(r);for(let e=0;e<3;e++)t[e].rot().setOrig(o)}get interfaces_(){return[Ys]}}class Ks{constructor(){Ks.constructor_.apply(this,arguments)}static constructor_(){this._triList=new P}getTriangleEdges(){return this._triList}visit(t){this._triList.add(t)}get interfaces_(){return[Ys]}}class Zs{constructor(){Zs.constructor_.apply(this,arguments)}static constructor_(){this._triList=new P}visit(t){this._triList.add([t[0].orig(),t[1].orig(),t[2].orig()])}getTriangleVertices(){return this._triList}get interfaces_(){return[Ys]}}class Js{constructor(){Js.constructor_.apply(this,arguments)}static constructor_(){this._coordList=new S,this._triCoords=new P}checkTriangleSize(t){t.length>=2?Yt.toLineString(t[0],t[1]):t.length>=1&&Yt.toPoint(t[0])}visit(t){this._coordList.clear();for(let e=0;e<3;e++){const n=t[e].orig();this._coordList.add(n.getCoordinate())}if(this._coordList.size()>0){this._coordList.closeRing();const t=this._coordList.toCoordinateArray();if(4!==t.length)return null;this._triCoords.add(t)}}getTriangles(){return this._triCoords}get interfaces_(){return[Ys]}}Xs.TriangleCircumcentreVisitor=Ws,Xs.TriangleEdgesListVisitor=Ks,Xs.TriangleVertexListVisitor=Zs,Xs.TriangleCoordinatesVisitor=Js,Xs.EDGE_COINCIDENCE_TOL_FACTOR=1e3;class Qs{constructor(){Qs.constructor_.apply(this,arguments)}static constructor_(){if(this._ls=null,this._data=null,2===arguments.length){const t=arguments[0],e=arguments[1];this._ls=new Kt(t,e)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._ls=new Kt(t,e),this._data=n}else if(6===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],o=arguments[5];Qs.constructor_.call(this,new y(t,e,n),new y(i,r,o))}else if(7===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],o=arguments[5],s=arguments[6];Qs.constructor_.call(this,new y(t,e,n),new y(i,r,o),s)}}getLineSegment(){return this._ls}getEndZ(){return this._ls.getCoordinate(1).getZ()}getStartZ(){return this._ls.getCoordinate(0).getZ()}intersection(t){return this._ls.intersection(t.getLineSegment())}getStart(){return this._ls.getCoordinate(0)}getEnd(){return this._ls.getCoordinate(1)}getEndY(){return this._ls.getCoordinate(1).y}getStartX(){return this._ls.getCoordinate(0).x}equalsTopo(t){return this._ls.equalsTopo(t.getLineSegment())}getStartY(){return this._ls.getCoordinate(0).y}setData(t){this._data=t}getData(){return this._data}getEndX(){return this._ls.getCoordinate(1).x}toString(){return this._ls.toString()}}class $s extends c{constructor(){super(),$s.constructor_.apply(this,arguments)}static constructor_(){if(this._pt=null,1===arguments.length){const t=arguments[0];c.constructor_.call(this,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];c.constructor_.call(this,$s.msgWithCoord(t,e)),this._pt=new y(e)}}static msgWithCoord(t,e){return null!==e?t+" [ "+Yt.toPoint(e)+" ]":t}getCoordinate(){return this._pt}}class ta{constructor(){ta.constructor_.apply(this,arguments)}static constructor_(){this._initialVertices=null,this._segVertices=null,this._segments=new P,this._subdiv=null,this._incDel=null,this._convexHull=null,this._splitFinder=new ks,this._kdt=null,this._vertexFactory=null,this._computeAreaEnv=null,this._splitPt=null,this._tolerance=null;const t=arguments[0],e=arguments[1];this._initialVertices=new P(t),this._tolerance=e,this._kdt=new ci(e)}static computeVertexEnvelope(t){const e=new L;for(let n=t.iterator();n.hasNext();){const t=n.next();e.expandToInclude(t.getCoordinate())}return e}getInitialVertices(){return this._initialVertices}getKDT(){return this._kdt}enforceConstraints(){this.addConstraintVertices();let t=0,e=0;do{e=this.enforceGabriel(this._segments),t++}while(e>0&&t<ta.MAX_SPLIT_ITER);if(t===ta.MAX_SPLIT_ITER)throw new $s("Too many splitting iterations while enforcing constraints.  Last split point was at: ",this._splitPt)}insertSites(t){for(let e=t.iterator();e.hasNext();){const t=e.next();this.insertSite(t)}}getVertexFactory(){return this._vertexFactory}getPointArray(){const t=new Array(this._initialVertices.size()+this._segVertices.size()).fill(null);let e=0;for(let n=this._initialVertices.iterator();n.hasNext();){const i=n.next();t[e++]=i.getCoordinate()}for(let n=this._segVertices.iterator();n.hasNext();){const i=n.next();t[e++]=i.getCoordinate()}return t}setConstraints(t,e){this._segments=t,this._segVertices=e}computeConvexHull(){const t=new Pt,e=this.getPointArray(),n=new nn(e,t);this._convexHull=n.getConvexHull()}addConstraintVertices(){this.computeConvexHull(),this.insertSites(this._segVertices)}findNonGabrielPoint(t){const e=t.getStart(),n=t.getEnd(),i=new y((e.x+n.x)/2,(e.y+n.y)/2),r=e.distance(i),s=new L(i);s.expandBy(r);const a=this._kdt.query(s);let l=null,u=o.MAX_VALUE;for(let t=a.iterator();t.hasNext();){const o=t.next().getCoordinate();if(o.equals2D(e)||o.equals2D(n))continue;const s=i.distance(o);if(s<r){const t=s;(null===l||t<u)&&(l=o,u=t)}}return l}getConstraintSegments(){return this._segments}setSplitPointFinder(t){this._splitFinder=t}getConvexHull(){return this._convexHull}getTolerance(){return this._tolerance}enforceGabriel(t){const e=new P;let n=0;const i=new P;for(let r=t.iterator();r.hasNext();){const t=r.next(),o=this.findNonGabrielPoint(t);if(null===o)continue;this._splitPt=this._splitFinder.findSplitPoint(t,o);const s=this.createVertex(this._splitPt,t);this.insertSite(s).getCoordinate().equals2D(this._splitPt);const a=new Qs(t.getStartX(),t.getStartY(),t.getStartZ(),s.getX(),s.getY(),s.getZ(),t.getData()),l=new Qs(s.getX(),s.getY(),s.getZ(),t.getEndX(),t.getEndY(),t.getEndZ(),t.getData());e.add(a),e.add(l),i.add(t),n+=1}return t.removeAll(i),t.addAll(e),n}createVertex(){if(1===arguments.length){const t=arguments[0];let e=null;return e=null!==this._vertexFactory?this._vertexFactory.createVertex(t,null):new js(t),e}if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=null;return n=null!==this._vertexFactory?this._vertexFactory.createVertex(t,e):new js(t),n.setOnConstraint(!0),n}}getSubdivision(){return this._subdiv}computeBoundingBox(){const t=ta.computeVertexEnvelope(this._initialVertices),e=ta.computeVertexEnvelope(this._segVertices),n=new L(t);n.expandToInclude(e);const i=.2*n.getWidth(),r=.2*n.getHeight(),o=Math.max(i,r);this._computeAreaEnv=new L(n),this._computeAreaEnv.expandBy(o)}setVertexFactory(t){this._vertexFactory=t}formInitialDelaunay(){this.computeBoundingBox(),this._subdiv=new Xs(this._computeAreaEnv,this._tolerance),this._subdiv.setLocator(new Vs(this._subdiv)),this._incDel=new Us(this._subdiv),this.insertSites(this._initialVertices)}insertSite(){if(arguments[0]instanceof js){const t=arguments[0],e=this._kdt.insert(t.getCoordinate(),t);if(e.isRepeated()){const n=e.getData();return n.merge(t),n}return this._incDel.insertSite(t),t}if(arguments[0]instanceof y){const t=arguments[0];this.insertSite(this.createVertex(t))}}}ta.MAX_SPLIT_ITER=99;class ea{constructor(){ea.constructor_.apply(this,arguments)}static constructor_(){this._siteCoords=null,this._tolerance=0,this._subdiv=null}static extractUniqueCoordinates(t){if(null===t)return new S;const e=t.getCoordinates();return ea.unique(e)}static envelope(t){const e=new L;for(let n=t.iterator();n.hasNext();){const t=n.next();e.expandToInclude(t)}return e}static unique(t){const e=dt.copyDeep(t);return it.sort(e),new S(e,!1)}static toVertices(t){const e=new P;for(let n=t.iterator();n.hasNext();){const t=n.next();e.add(new Gs(t))}return e}create(){if(null!==this._subdiv)return null;const t=ea.envelope(this._siteCoords),e=ea.toVertices(this._siteCoords);this._subdiv=new Xs(t,this._tolerance),new Us(this._subdiv).insertSites(e)}setTolerance(t){this._tolerance=t}setSites(){if(arguments[0]instanceof H){const t=arguments[0];this._siteCoords=ea.extractUniqueCoordinates(t)}else if(C(arguments[0],w)){const t=arguments[0];this._siteCoords=ea.unique(dt.toCoordinateArray(t))}}getEdges(t){return this.create(),this._subdiv.getEdges(t)}getSubdivision(){return this.create(),this._subdiv}getTriangles(t){return this.create(),this._subdiv.getTriangles(t)}}class na{constructor(){na.constructor_.apply(this,arguments)}static constructor_(){this._siteCoords=null,this._constraintLines=null,this._tolerance=0,this._subdiv=null,this._constraintVertexMap=new Hn}static createConstraintSegments(){if(1===arguments.length){const t=arguments[0],e=me.getLines(t),n=new P;for(let t=e.iterator();t.hasNext();){const e=t.next();na.createConstraintSegments(e,n)}return n}if(2===arguments.length){const t=arguments[1],e=arguments[0].getCoordinates();for(let n=1;n<e.length;n++)t.add(new Qs(e[n-1],e[n]))}}createSiteVertices(t){const e=new P;for(let n=t.iterator();n.hasNext();){const t=n.next();this._constraintVertexMap.containsKey(t)||e.add(new js(t))}return e}create(){if(null!==this._subdiv)return null;const t=ea.envelope(this._siteCoords);let e=new P;null!==this._constraintLines&&(t.expandToInclude(this._constraintLines.getEnvelopeInternal()),this.createVertices(this._constraintLines),e=na.createConstraintSegments(this._constraintLines));const n=this.createSiteVertices(this._siteCoords),i=new ta(n,this._tolerance);i.setConstraints(e,new P(this._constraintVertexMap.values())),i.formInitialDelaunay(),i.enforceConstraints(),this._subdiv=i.getSubdivision()}setTolerance(t){this._tolerance=t}setConstraints(t){this._constraintLines=t}setSites(t){this._siteCoords=ea.extractUniqueCoordinates(t)}getEdges(t){return this.create(),this._subdiv.getEdges(t)}getSubdivision(){return this.create(),this._subdiv}getTriangles(t){return this.create(),this._subdiv.getTriangles(t)}createVertices(t){const e=t.getCoordinates();for(let t=0;t<e.length;t++){const n=new js(e[t]);this._constraintVertexMap.put(e[t],n)}}}class ia{constructor(){ia.constructor_.apply(this,arguments)}static constructor_(){this._siteCoords=null,this._tolerance=0,this._subdiv=null,this._clipEnv=null,this._diagramEnv=null}static clipGeometryCollection(t,e){const n=t.getFactory().toGeometry(e),i=new P;for(let r=0;r<t.getNumGeometries();r++){const o=t.getGeometryN(r);let s=null;e.contains(o.getEnvelopeInternal())?s=o:e.intersects(o.getEnvelopeInternal())&&(s=wo.intersection(n,o),s.setUserData(o.getUserData())),null===s||s.isEmpty()||i.add(s)}return t.getFactory().createGeometryCollection(Pt.toGeometryArray(i))}create(){if(null!==this._subdiv)return null;const t=ea.envelope(this._siteCoords);if(this._diagramEnv=this._clipEnv,null===this._diagramEnv){this._diagramEnv=t;const e=this._diagramEnv.getDiameter();this._diagramEnv.expandBy(e)}const e=ea.toVertices(this._siteCoords);this._subdiv=new Xs(t,this._tolerance),new Us(this._subdiv).insertSites(e)}getDiagram(t){this.create();const e=this._subdiv.getVoronoiDiagram(t);return ia.clipGeometryCollection(e,this._diagramEnv)}setTolerance(t){this._tolerance=t}setSites(){if(arguments[0]instanceof H){const t=arguments[0];this._siteCoords=ea.extractUniqueCoordinates(t)}else if(C(arguments[0],w)){const t=arguments[0];this._siteCoords=ea.unique(dt.toCoordinateArray(t))}}setClipEnvelope(t){this._clipEnv=t}getSubdivision(){return this.create(),this._subdiv}}var ra=Object.freeze({__proto__:null,Vertex:Gs}),oa=Object.freeze({__proto__:null,ConformingDelaunayTriangulationBuilder:na,DelaunayTriangulationBuilder:ea,VoronoiDiagramBuilder:ia,quadedge:ra});class sa{constructor(){sa.constructor_.apply(this,arguments)}static constructor_(){if(this._linearGeom=null,this._numLines=null,this._currentLine=null,this._componentIndex=0,this._vertexIndex=0,1===arguments.length){const t=arguments[0];sa.constructor_.call(this,t,0,0)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];sa.constructor_.call(this,t,e.getComponentIndex(),sa.segmentEndVertexIndex(e))}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];if(!C(t,W))throw new i("Lineal geometry is required");this._linearGeom=t,this._numLines=t.getNumGeometries(),this._componentIndex=e,this._vertexIndex=n,this.loadCurrentLine()}}static segmentEndVertexIndex(t){return t.getSegmentFraction()>0?t.getSegmentIndex()+1:t.getSegmentIndex()}getComponentIndex(){return this._componentIndex}getLine(){return this._currentLine}getVertexIndex(){return this._vertexIndex}getSegmentEnd(){return this._vertexIndex<this.getLine().getNumPoints()-1?this._currentLine.getCoordinateN(this._vertexIndex+1):null}next(){if(!this.hasNext())return null;this._vertexIndex++,this._vertexIndex>=this._currentLine.getNumPoints()&&(this._componentIndex++,this.loadCurrentLine(),this._vertexIndex=0)}loadCurrentLine(){if(this._componentIndex>=this._numLines)return this._currentLine=null,null;this._currentLine=this._linearGeom.getGeometryN(this._componentIndex)}getSegmentStart(){return this._currentLine.getCoordinateN(this._vertexIndex)}isEndOfLine(){return!(this._componentIndex>=this._numLines||this._vertexIndex<this._currentLine.getNumPoints()-1)}hasNext(){return!(this._componentIndex>=this._numLines||this._componentIndex===this._numLines-1&&this._vertexIndex>=this._currentLine.getNumPoints())}}class aa{constructor(){aa.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;const t=arguments[0];this._linearGeom=t}static indexOf(t,e){return new aa(t).indexOf(e)}static indexOfAfter(t,e,n){return new aa(t).indexOfAfter(e,n)}indexOf(t){return this.indexOfFromStart(t,-1)}indexOfFromStart(t,e){let n=o.MAX_VALUE,i=e,r=0;const s=new Kt,a=new sa(this._linearGeom);for(;a.hasNext();){if(!a.isEndOfLine()){s.p0=a.getSegmentStart(),s.p1=a.getSegmentEnd();const o=s.distance(t),l=this.segmentNearestMeasure(s,t,r);o<n&&l>e&&(i=l,n=o),r+=s.getLength()}a.next()}return i}indexOfAfter(t,e){if(e<0)return this.indexOf(t);const n=this._linearGeom.getLength();if(n<e)return n;const i=this.indexOfFromStart(t,e);return p.isTrue(i>=e,"computed index is before specified minimum index"),i}segmentNearestMeasure(t,e,n){const i=t.projectionFactor(e);return i<=0?n:i<=1?n+i*t.getLength():n+t.getLength()}}class la{constructor(){la.constructor_.apply(this,arguments)}static constructor_(){if(this._componentIndex=0,this._segmentIndex=0,this._segmentFraction=0,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this._componentIndex=t._componentIndex,this._segmentIndex=t._segmentIndex,this._segmentFraction=t._segmentFraction}else if(2===arguments.length){const t=arguments[0],e=arguments[1];la.constructor_.call(this,0,t,e)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];this._componentIndex=t,this._segmentIndex=e,this._segmentFraction=n,this.normalize()}else if(4===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._componentIndex=t,this._segmentIndex=e,this._segmentFraction=n,i&&this.normalize()}}static getEndLocation(t){const e=new la;return e.setToEnd(t),e}static pointAlongSegmentByFraction(t,e,n){if(n<=0)return t;if(n>=1)return e;const i=(e.x-t.x)*n+t.x,r=(e.y-t.y)*n+t.y,o=(e.getZ()-t.getZ())*n+t.getZ();return new y(i,r,o)}static compareLocationValues(t,e,n,i,r,o){return t<i?-1:t>i?1:e<r?-1:e>r?1:n<o?-1:n>o?1:0}static numSegments(t){const e=t.getNumPoints();return e<=1?0:e-1}getSegmentIndex(){return this._segmentIndex}getComponentIndex(){return this._componentIndex}isEndpoint(t){const e=t.getGeometryN(this._componentIndex),n=la.numSegments(e);return this._segmentIndex>=n||this._segmentIndex===n-1&&this._segmentFraction>=1}isValid(t){if(this._componentIndex<0||this._componentIndex>=t.getNumGeometries())return!1;const e=t.getGeometryN(this._componentIndex);return!(this._segmentIndex<0||this._segmentIndex>e.getNumPoints()||this._segmentIndex===e.getNumPoints()&&0!==this._segmentFraction||this._segmentFraction<0||this._segmentFraction>1)}normalize(){this._segmentFraction<0&&(this._segmentFraction=0),this._segmentFraction>1&&(this._segmentFraction=1),this._componentIndex<0&&(this._componentIndex=0,this._segmentIndex=0,this._segmentFraction=0),this._segmentIndex<0&&(this._segmentIndex=0,this._segmentFraction=0),1===this._segmentFraction&&(this._segmentFraction=0,this._segmentIndex+=1)}toLowest(t){const e=t.getGeometryN(this._componentIndex),n=la.numSegments(e);return this._segmentIndex<n?this:new la(this._componentIndex,n-1,1,!1)}getCoordinate(t){const e=t.getGeometryN(this._componentIndex),n=e.getCoordinateN(this._segmentIndex);if(this._segmentIndex>=la.numSegments(e))return n;const i=e.getCoordinateN(this._segmentIndex+1);return la.pointAlongSegmentByFraction(n,i,this._segmentFraction)}getSegmentFraction(){return this._segmentFraction}getSegment(t){const e=t.getGeometryN(this._componentIndex),n=e.getCoordinateN(this._segmentIndex);if(this._segmentIndex>=la.numSegments(e)){const t=e.getCoordinateN(e.getNumPoints()-2);return new Kt(t,n)}const i=e.getCoordinateN(this._segmentIndex+1);return new Kt(n,i)}clamp(t){if(this._componentIndex>=t.getNumGeometries())return this.setToEnd(t),null;if(this._segmentIndex>=t.getNumPoints()){const e=t.getGeometryN(this._componentIndex);this._segmentIndex=la.numSegments(e),this._segmentFraction=1}}setToEnd(t){this._componentIndex=t.getNumGeometries()-1;const e=t.getGeometryN(this._componentIndex);this._segmentIndex=la.numSegments(e),this._segmentFraction=0}compareTo(t){const e=t;return this._componentIndex<e._componentIndex?-1:this._componentIndex>e._componentIndex?1:this._segmentIndex<e._segmentIndex?-1:this._segmentIndex>e._segmentIndex?1:this._segmentFraction<e._segmentFraction?-1:this._segmentFraction>e._segmentFraction?1:0}copy(){return new la(this._componentIndex,this._segmentIndex,this._segmentFraction)}toString(){return"LinearLoc["+this._componentIndex+", "+this._segmentIndex+", "+this._segmentFraction+"]"}isOnSameSegment(t){return this._componentIndex===t._componentIndex&&(this._segmentIndex===t._segmentIndex||t._segmentIndex-this._segmentIndex==1&&0===t._segmentFraction||this._segmentIndex-t._segmentIndex==1&&0===this._segmentFraction)}snapToVertex(t,e){if(this._segmentFraction<=0||this._segmentFraction>=1)return null;const n=this.getSegmentLength(t),i=this._segmentFraction*n,r=n-i;i<=r&&i<e?this._segmentFraction=0:r<=i&&r<e&&(this._segmentFraction=1)}compareLocationValues(t,e,n){return this._componentIndex<t?-1:this._componentIndex>t?1:this._segmentIndex<e?-1:this._segmentIndex>e?1:this._segmentFraction<n?-1:this._segmentFraction>n?1:0}getSegmentLength(t){const e=t.getGeometryN(this._componentIndex);let n=this._segmentIndex;this._segmentIndex>=la.numSegments(e)&&(n=e.getNumPoints()-2);const i=e.getCoordinateN(n),r=e.getCoordinateN(n+1);return i.distance(r)}isVertex(){return this._segmentFraction<=0||this._segmentFraction>=1}get interfaces_(){return[s]}}class ua{constructor(){ua.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;const t=arguments[0];this._linearGeom=t}static indexOf(t,e){return new ua(t).indexOf(e)}static indexOfAfter(t,e,n){return new ua(t).indexOfAfter(e,n)}indexOf(t){return this.indexOfFromStart(t,null)}indexOfFromStart(t,e){let n=o.MAX_VALUE,i=0,r=0,s=-1;const a=new Kt;for(let o=new sa(this._linearGeom);o.hasNext();o.next())if(!o.isEndOfLine()){a.p0=o.getSegmentStart(),a.p1=o.getSegmentEnd();const l=a.distance(t),u=a.segmentFraction(t),c=o.getComponentIndex(),h=o.getVertexIndex();l<n&&(null===e||e.compareLocationValues(c,h,u)<0)&&(i=c,r=h,s=u,n=l)}return n===o.MAX_VALUE?new la(e):new la(i,r,s)}indexOfAfter(t,e){if(null===e)return this.indexOf(t);const n=la.getEndLocation(this._linearGeom);if(n.compareTo(e)<=0)return n;const i=this.indexOfFromStart(t,e);return p.isTrue(i.compareTo(e)>=0,"computed location is before specified minimum location"),i}}class ca{constructor(){ca.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;const t=arguments[0];this._linearGeom=t}static indicesOf(t,e){return new ca(t).indicesOf(e)}indicesOf(t){const e=t.getGeometryN(0).getCoordinateN(0),n=t.getGeometryN(t.getNumGeometries()-1),i=n.getCoordinateN(n.getNumPoints()-1),r=new ua(this._linearGeom),o=new Array(2).fill(null);return o[0]=r.indexOf(e),0===t.getLength()?o[1]=o[0].copy():o[1]=r.indexOfAfter(i,o[0]),o}}class ha{constructor(){ha.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;const t=arguments[0];this._linearGeom=t}static getLength(t,e){return new ha(t).getLength(e)}static getLocation(){if(2===arguments.length){const t=arguments[1];return new ha(arguments[0]).getLocation(t)}if(3===arguments.length){const t=arguments[1],e=arguments[2];return new ha(arguments[0]).getLocation(t,e)}}getLength(t){let e=0;const n=new sa(this._linearGeom);for(;n.hasNext();){if(!n.isEndOfLine()){const i=n.getSegmentStart(),r=n.getSegmentEnd().distance(i);if(t.getComponentIndex()===n.getComponentIndex()&&t.getSegmentIndex()===n.getVertexIndex())return e+r*t.getSegmentFraction();e+=r}n.next()}return e}resolveHigher(t){if(!t.isEndpoint(this._linearGeom))return t;let e=t.getComponentIndex();if(e>=this._linearGeom.getNumGeometries()-1)return t;do{e++}while(e<this._linearGeom.getNumGeometries()-1&&0===this._linearGeom.getGeometryN(e).getLength());return new la(e,0,0)}getLocation(){if(1===arguments.length){const t=arguments[0];return this.getLocation(t,!0)}if(2===arguments.length){const t=arguments[0],e=arguments[1];let n=t;t<0&&(n=this._linearGeom.getLength()+t);const i=this.getLocationForward(n);return e?i:this.resolveHigher(i)}}getLocationForward(t){if(t<=0)return new la;let e=0;const n=new sa(this._linearGeom);for(;n.hasNext();){if(n.isEndOfLine()){if(e===t){const t=n.getComponentIndex(),e=n.getVertexIndex();return new la(t,e,0)}}else{const i=n.getSegmentStart(),r=n.getSegmentEnd().distance(i);if(e+r>t){const i=(t-e)/r,o=n.getComponentIndex(),s=n.getVertexIndex();return new la(o,s,i)}e+=r}n.next()}return la.getEndLocation(this._linearGeom)}}class pa{constructor(){pa.constructor_.apply(this,arguments)}static constructor_(){this._geomFact=null,this._lines=new P,this._coordList=null,this._ignoreInvalidLines=!1,this._fixInvalidLines=!1,this._lastPt=null;const t=arguments[0];this._geomFact=t}getGeometry(){return this.endLine(),this._geomFact.buildGeometry(this._lines)}getLastCoordinate(){return this._lastPt}endLine(){if(null===this._coordList)return null;if(this._ignoreInvalidLines&&this._coordList.size()<2)return this._coordList=null,null;const t=this._coordList.toCoordinateArray();let e=t;this._fixInvalidLines&&(e=this.validCoordinateSequence(t)),this._coordList=null;let n=null;try{n=this._geomFact.createLineString(e)}catch(t){if(!(t instanceof i))throw t;if(!this._ignoreInvalidLines)throw t}null!==n&&this._lines.add(n)}setFixInvalidLines(t){this._fixInvalidLines=t}add(){if(1===arguments.length){const t=arguments[0];this.add(t,!0)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];null===this._coordList&&(this._coordList=new S),this._coordList.add(t,e),this._lastPt=t}}setIgnoreInvalidLines(t){this._ignoreInvalidLines=t}validCoordinateSequence(t){return t.length>=2?t:[t[0],t[0]]}}class fa{constructor(){fa.constructor_.apply(this,arguments)}static constructor_(){this._line=null;const t=arguments[0];this._line=t}static extract(t,e,n){return new fa(t).extract(e,n)}computeLinear(t,e){const n=new pa(this._line.getFactory());n.setFixInvalidLines(!0),t.isVertex()||n.add(t.getCoordinate(this._line));for(let i=new sa(this._line,t);i.hasNext()&&!(e.compareLocationValues(i.getComponentIndex(),i.getVertexIndex(),0)<0);i.next()){const t=i.getSegmentStart();n.add(t),i.isEndOfLine()&&n.endLine()}return e.isVertex()||n.add(e.getCoordinate(this._line)),n.getGeometry()}computeLine(t,e){const n=this._line.getCoordinates(),i=new S;let r=t.getSegmentIndex();t.getSegmentFraction()>0&&(r+=1);let o=e.getSegmentIndex();1===e.getSegmentFraction()&&(o+=1),o>=n.length&&(o=n.length-1),t.isVertex()||i.add(t.getCoordinate(this._line));for(let t=r;t<=o;t++)i.add(n[t]);e.isVertex()||i.add(e.getCoordinate(this._line)),i.size()<=0&&i.add(t.getCoordinate(this._line));let s=i.toCoordinateArray();return s.length<=1&&(s=[s[0],s[0]]),this._line.getFactory().createLineString(s)}extract(t,e){return e.compareTo(t)<0?this.reverse(this.computeLinear(e,t)):this.computeLinear(t,e)}reverse(t){return C(t,W)?t.reverse():(p.shouldNeverReachHere("non-linear geometry encountered"),null)}}class da{constructor(){da.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;const t=arguments[0];this._linearGeom=t}clampIndex(t){const e=this.positiveIndex(t),n=this.getStartIndex();if(e<n)return n;const i=this.getEndIndex();return e>i?i:e}locationOf(){if(1===arguments.length){const t=arguments[0];return ha.getLocation(this._linearGeom,t)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return ha.getLocation(this._linearGeom,t,e)}}project(t){return aa.indexOf(this._linearGeom,t)}positiveIndex(t){return t>=0?t:this._linearGeom.getLength()+t}extractPoint(){if(1===arguments.length){const t=arguments[0];return ha.getLocation(this._linearGeom,t).getCoordinate(this._linearGeom)}if(2===arguments.length){const t=arguments[0],e=arguments[1],n=ha.getLocation(this._linearGeom,t).toLowest(this._linearGeom);return n.getSegment(this._linearGeom).pointAlongOffset(n.getSegmentFraction(),e)}}isValidIndex(t){return t>=this.getStartIndex()&&t<=this.getEndIndex()}getEndIndex(){return this._linearGeom.getLength()}getStartIndex(){return 0}indexOfAfter(t,e){return aa.indexOfAfter(this._linearGeom,t,e)}extractLine(t,e){const n=this.clampIndex(t),i=this.clampIndex(e),r=n===i,o=this.locationOf(n,r),s=this.locationOf(i);return fa.extract(this._linearGeom,o,s)}indexOf(t){return aa.indexOf(this._linearGeom,t)}indicesOf(t){const e=ca.indicesOf(this._linearGeom,t);return[ha.getLength(this._linearGeom,e[0]),ha.getLength(this._linearGeom,e[1])]}}class ga{constructor(){ga.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;const t=arguments[0];this._linearGeom=t,this.checkGeometryType()}clampIndex(t){const e=t.copy();return e.clamp(this._linearGeom),e}project(t){return ua.indexOf(this._linearGeom,t)}checkGeometryType(){if(!(this._linearGeom instanceof $||this._linearGeom instanceof It))throw new i("Input geometry must be linear")}extractPoint(){if(1===arguments.length)return arguments[0].getCoordinate(this._linearGeom);if(2===arguments.length){const t=arguments[1],e=arguments[0].toLowest(this._linearGeom);return e.getSegment(this._linearGeom).pointAlongOffset(e.getSegmentFraction(),t)}}isValidIndex(t){return t.isValid(this._linearGeom)}getEndIndex(){return la.getEndLocation(this._linearGeom)}getStartIndex(){return new la}indexOfAfter(t,e){return ua.indexOfAfter(this._linearGeom,t,e)}extractLine(t,e){return fa.extract(this._linearGeom,t,e)}indexOf(t){return ua.indexOf(this._linearGeom,t)}indicesOf(t){return ca.indicesOf(this._linearGeom,t)}}var ya=Object.freeze({__proto__:null,LengthIndexedLine:da,LengthLocationMap:ha,LinearGeometryBuilder:pa,LinearIterator:sa,LinearLocation:la,LocationIndexedLine:ga});class ma{static transform(t,e){const n=new P;for(let i=t.iterator();i.hasNext();)n.add(e.execute(i.next()));return n}static select(t,e){const n=new P;for(let i=t.iterator();i.hasNext();){const t=i.next();Boolean.TRUE.equals(e.execute(t))&&n.add(t)}return n}static apply(t,e){for(let n=t.iterator();n.hasNext();)e.execute(n.next())}}ma.Function=function(){};class _a{constructor(){_a.constructor_.apply(this,arguments)}static constructor_(){this.pts=null,this.n=0;const t=arguments[0];this.pts=new Array(t).fill(null)}filter(t){this.pts[this.n++]=t}getCoordinates(){return this.pts}get interfaces_(){return[Y]}}class va{constructor(){va.constructor_.apply(this,arguments)}static constructor_(){this._n=0}filter(t){this._n++}getCount(){return this._n}get interfaces_(){return[Y]}}class xa{constructor(){xa.constructor_.apply(this,arguments)}static constructor_(){this._counts=new wt}count(t){const e=this._counts.get(t);return null===e?0:e.count()}add(t){const e=this._counts.get(t);null===e?this._counts.put(t,new Ca(1)):e.increment()}}class Ca{constructor(){Ca.constructor_.apply(this,arguments)}static constructor_(){if(this.count=0,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.count=t}}count(){return this.count}increment(){this.count++}}function wa(){}function ba(){}function Ea(){}xa.Counter=Ca;class Ia extends n{}function Pa(){}class Na{static chars(t,e){const n=new Array(e).fill(null);for(let i=0;i<e;i++)n[i]=t;return new String(n)}static getStackTrace(){if(1===arguments.length){const t=arguments[0],e=new Ea,n=new wa;return t.printStackTrace(n),e.toString()}if(2===arguments.length){const t=arguments[0],e=arguments[1];let n="";new ba(Na.getStackTrace(t));const i=new Pa;for(let t=0;t<e;t++)try{n+=i.readLine()+Na.NEWLINE}catch(t){if(!(t instanceof Ia))throw t;p.shouldNeverReachHere()}return n}}static spaces(t){return Na.chars(" ",t)}static split(t,e){const n=e.length,i=new P;let r=""+t,o=r.indexOf(e);for(;o>=0;){const t=r.substring(0,o);i.add(t),r=r.substring(o+n),o=r.indexOf(e)}r.length>0&&i.add(r);const s=new Array(i.size()).fill(null);for(let t=0;t<s.length;t++)s[t]=i.get(t);return s}}Na.NEWLINE=j.getProperty("line.separator");var Sa=Object.freeze({__proto__:null,CollectionUtil:ma,CoordinateArrayFilter:_a,CoordinateCountFilter:va,GeometricShapeFactory:we,NumberUtil:e,ObjectCounter:xa,PriorityQueue:Ei,StringUtil:Na,UniqueCoordinateArrayFilter:en});$.prototype.getBoundary=function(){return nr.getBoundary(this)},It.prototype.getBoundary=function(){return nr.getBoundary(this)},H.prototype.equalsTopo=function(t){return Zo.equalsTopo(this,t)},H.prototype.equals=function(t){return null!==t&&Zo.equalsTopo(this,t)},H.prototype.union=function(){if(0===arguments.length)return is.union(this);if(1===arguments.length){const t=arguments[0];return ts.union(this,t)}},H.prototype.isValid=function(){return Fo.isValid(this)},H.prototype.intersection=function(t){return wo.intersection(this,t)},H.prototype.covers=function(t){return Zo.covers(this,t)},H.prototype.coveredBy=function(t){return Zo.covers(t,this)},H.prototype.touches=function(t){return Zo.touches(this,t)},H.prototype.intersects=function(t){return Zo.intersects(this,t)},H.prototype.within=function(t){return Zo.contains(t,this)},H.prototype.overlaps=function(t){return Zo.overlaps(this,t)},H.prototype.disjoint=function(t){return Zo.disjoint(this,t)},H.prototype.crosses=function(t){return Zo.crosses(this,t)},H.prototype.buffer=function(){if(1===arguments.length){const t=arguments[0];return Fr.bufferOp(this,t)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return Fr.bufferOp(this,t,e)}if(3===arguments.length){const t=arguments[0],e=arguments[1],n=arguments[2];return Fr.bufferOp(this,t,e,n)}},H.prototype.convexHull=function(){return new nn(this).getConvexHull()},H.prototype.relate=function(){if(1===arguments.length){const t=arguments[0];return Zo.relate(this,t)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return Zo.relate(this,t).matches(e)}},H.prototype.getCentroid=function(){if(this.isEmpty())return this._factory.createPoint();const t=Qe.getCentroid(this);return this.createPointFromInternalCoord(t,this)},H.prototype.getInteriorPoint=function(){if(this.isEmpty())return this._factory.createPoint();let t=null;const e=this.getDimension();t=0===e?new cn(this):1===e?new un(this):new on(this);const n=t.getInteriorPoint();return this.createPointFromInternalCoord(n,this)},H.prototype.symDifference=function(t){return wo.symDifference(this,t)},H.prototype.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},H.prototype.toText=function(){return(new Yt).write(this)},H.prototype.toString=function(){this.toText()},H.prototype.contains=function(t){return Zo.contains(this,t)},H.prototype.difference=function(t){return wo.difference(this,t)},H.prototype.isSimple=function(){return new rr(this).isSimple()},H.prototype.isWithinDistance=function(t,e){return!(this.getEnvelopeInternal().distance(t.getEnvelopeInternal())>e)&&jr.isWithinDistance(this,t,e)},H.prototype.distance=function(t){return jr.distance(this,t)},t.algorithm=vn,t.densify=wn,t.dissolve=Ln,t.geom=Pe,t.geomgraph=ai,t.index=Ri,t.io=Gi,t.linearref=ya,t.noding=er,t.operation=ss,t.precision=ms,t.simplify=As,t.triangulate=oa,t.util=Sa,t.version="2.9.2 (dc06c3b)",Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){"use strict";e.__esModule=!0;var i,r=n(110),o=(i=r)&&i.__esModule?i:{default:i};e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,o.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}()},function(t,e,n){var i,r,o;o=function(){var t,e={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},n=function(){var t=function(t){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=t.xField||t.defaultXField,this._yField=t.yField||t.defaultYField,this._valueField=t.valueField||t.defaultValueField,t.radius&&(this._cfgRadius=t.radius)},n=e.defaultRadius;return t.prototype={_organiseData:function(t,e){var i=t[this._xField],r=t[this._yField],o=this._radi,s=this._data,a=this._max,l=this._min,u=t[this._valueField]||1,c=t.radius||this._cfgRadius||n;s[i]||(s[i]=[],o[i]=[]),s[i][r]?s[i][r]+=u:(s[i][r]=u,o[i][r]=c);var h=s[i][r];return h>a?(e?this.setDataMax(h):this._max=h,!1):h<l?(e?this.setDataMin(h):this._min=h,!1):{x:i,y:r,value:u,radius:c,min:l,max:a}},_unOrganizeData:function(){var t=[],e=this._data,n=this._radi;for(var i in e)for(var r in e[i])t.push({x:i,y:r,radius:n[i][r],value:e[i][r]});return{min:this._min,max:this._max,data:t}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0)for(var t=arguments[0],e=t.length;e--;)this.addData.call(this,t[e]);else{var n=this._organiseData(arguments[0],!0);n&&(0===this._data.length&&(this._min=this._max=n.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[n]}))}return this},setData:function(t){var e=t.data,n=e.length;this._data=[],this._radi=[];for(var i=0;i<n;i++)this._organiseData(e[i],!1);return this._max=t.max,this._min=t.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(t){return this._max=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(t){return this._min=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(t){this._coordinator=t},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},t}(),i=function(){var t=function(t){var e=t.gradient||t.defaultGradient,n=document.createElement("canvas"),i=n.getContext("2d");n.width=256,n.height=1;var r=i.createLinearGradient(0,0,256,1);for(var o in e)r.addColorStop(o,e[o]);return i.fillStyle=r,i.fillRect(0,0,256,1),i.getImageData(0,0,256,1).data},e=function(t,e){var n=document.createElement("canvas"),i=n.getContext("2d"),r=t,o=t;if(n.width=n.height=2*t,1==e)i.beginPath(),i.arc(r,o,t,0,2*Math.PI,!1),i.fillStyle="rgba(0,0,0,1)",i.fill();else{var s=i.createRadialGradient(r,o,t*e,r,o,t);s.addColorStop(0,"rgba(0,0,0,1)"),s.addColorStop(1,"rgba(0,0,0,0)"),i.fillStyle=s,i.fillRect(0,0,2*t,2*t)}return n};function n(e){var n=e.container,i=this.shadowCanvas=document.createElement("canvas"),r=this.canvas=e.canvas||document.createElement("canvas"),o=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(e.container)||{});r.className="heatmap-canvas",this._width=r.width=i.width=e.width||+o.width.replace(/px/,""),this._height=r.height=i.height=e.height||+o.height.replace(/px/,""),this.shadowCtx=i.getContext("2d"),this.ctx=r.getContext("2d"),r.style.cssText=i.style.cssText="position:absolute;left:0;top:0;",n.style.position="relative",n.appendChild(r),this._palette=t(e),this._templates={},this._setStyles(e)}return n.prototype={renderPartial:function(t){t.data.length>0&&(this._drawAlpha(t),this._colorize())},renderAll:function(t){this._clear(),t.data.length>0&&(this._drawAlpha(function(t){for(var e=[],n=t.min,i=t.max,r=t.radi,o=(t=t.data,Object.keys(t)),s=o.length;s--;)for(var a=o[s],l=Object.keys(t[a]),u=l.length;u--;){var c=l[u],h=t[a][c],p=r[a][c];e.push({x:a,y:c,value:h,radius:p})}return{min:n,max:i,data:e}}(t)),this._colorize())},_updateGradient:function(e){this._palette=t(e)},updateConfig:function(t){t.gradient&&this._updateGradient(t),this._setStyles(t)},setDimensions:function(t,e){this._width=t,this._height=e,this.canvas.width=this.shadowCanvas.width=t,this.canvas.height=this.shadowCanvas.height=e},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(t){this._blur=0==t.blur?0:t.blur||t.defaultBlur,t.backgroundColor&&(this.canvas.style.backgroundColor=t.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=t.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=t.height||this._height,this._opacity=255*(t.opacity||0),this._maxOpacity=255*(t.maxOpacity||t.defaultMaxOpacity),this._minOpacity=255*(t.minOpacity||t.defaultMinOpacity),this._useGradientOpacity=!!t.useGradientOpacity},_drawAlpha:function(t){for(var n=this._min=t.min,i=this._max=t.max,r=(t=t.data||[]).length,o=1-this._blur;r--;){var s,a=t[r],l=a.x,u=a.y,c=a.radius,h=Math.min(a.value,i),p=l-c,f=u-c,d=this.shadowCtx;this._templates[c]?s=this._templates[c]:this._templates[c]=s=e(c,o);var g=(h-n)/(i-n);d.globalAlpha=g<.01?.01:g,d.drawImage(s,p,f),p<this._renderBoundaries[0]&&(this._renderBoundaries[0]=p),f<this._renderBoundaries[1]&&(this._renderBoundaries[1]=f),p+2*c>this._renderBoundaries[2]&&(this._renderBoundaries[2]=p+2*c),f+2*c>this._renderBoundaries[3]&&(this._renderBoundaries[3]=f+2*c)}},_colorize:function(){var t=this._renderBoundaries[0],e=this._renderBoundaries[1],n=this._renderBoundaries[2]-t,i=this._renderBoundaries[3]-e,r=this._width,o=this._height,s=this._opacity,a=this._maxOpacity,l=this._minOpacity,u=this._useGradientOpacity;t<0&&(t=0),e<0&&(e=0),t+n>r&&(n=r-t),e+i>o&&(i=o-e);for(var c=this.shadowCtx.getImageData(t,e,n,i),h=c.data,p=h.length,f=this._palette,d=3;d<p;d+=4){var g,y=h[d],m=4*y;m&&(g=s>0?s:y<a?y<l?l:y:a,h[d-3]=f[m],h[d-2]=f[m+1],h[d-1]=f[m+2],h[d]=u?f[m+3]:g)}c.data=h,this.ctx.putImageData(c,t,e),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(t){var e=this.shadowCtx.getImageData(t.x,t.y,1,1).data[3],n=this._max,i=this._min;return Math.abs(n-i)*(e/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},n}(),r=(t=!1,"canvas2d"===e.defaultRenderer&&(t=i),t),o=function(){for(var t={},e=arguments.length,n=0;n<e;n++){var i=arguments[n];for(var r in i)t[r]=i[r]}return t},s=function(){var t=function(){function t(){this.cStore={}}return t.prototype={on:function(t,e,n){var i=this.cStore;i[t]||(i[t]=[]),i[t].push((function(t){return e.call(n,t)}))},emit:function(t,e){var n=this.cStore;if(n[t])for(var i=n[t].length,r=0;r<i;r++)(0,n[t][r])(e)}},t}(),i=function(t){var e=t._renderer,n=t._coordinator,i=t._store;n.on("renderpartial",e.renderPartial,e),n.on("renderall",e.renderAll,e),n.on("extremachange",(function(e){t._config.onExtremaChange&&t._config.onExtremaChange({min:e.min,max:e.max,gradient:t._config.gradient||t._config.defaultGradient})})),i.setCoordinator(n)};function s(){var s=this._config=o(e,arguments[0]||{});if(this._coordinator=new t,s.plugin){var a=s.plugin;if(!e.plugins[a])throw new Error("Plugin '"+a+"' not found. Maybe it was not registered.");var l=e.plugins[a];this._renderer=new l.renderer(s),this._store=new l.store(s)}else this._renderer=new r(s),this._store=new n(s);i(this)}return s.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(t){return this._config=o(this._config,t),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(t){return this._store.getValueAt?this._store.getValueAt(t):this._renderer.getValueAt?this._renderer.getValueAt(t):null}},s}();return{create:function(t){return new s(t)},register:function(t,n){e.plugins[t]=n}}},t.exports?t.exports=o():void 0===(r="function"==typeof(i=o)?i.call(e,n,e,t):i)||(t.exports=r)},function(t,e,n){t.exports={default:n(209),__esModule:!0}},function(t,e,n){n(121),t.exports=n(9).Object.assign},function(t,e,n){var i=n(11);i(i.S+i.F,"Object",{assign:n(79)})},function(t,e,n){var i=n(37),r=n(49),o=n(123);t.exports=function(t){return function(e,n,s){var a,l=i(e),u=r(l.length),c=o(s,u);if(t&&n!=n){for(;u>c;)if((a=l[c++])!=a)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}}},function(t,e,n){var i=n(57),r=Math.max,o=Math.min;t.exports=function(t,e){return(t=i(t))<0?r(t+e,0):o(t,e)}},function(t,e,n){n(62),n(44),n(46),n(130),n(135),n(136),t.exports=n(9).Promise},function(t,e,n){var i=n(57),r=n(56);t.exports=function(t){return function(e,n){var o,s,a=String(r(e)),l=i(n),u=a.length;return l<0||l>=u?t?"":void 0:(o=a.charCodeAt(l))<55296||o>56319||l+1===u||(s=a.charCodeAt(l+1))<56320||s>57343?t?a.charAt(l):o:t?a.slice(l,l+2):s-56320+(o-55296<<10)+65536}}},function(t,e,n){"use strict";var i=n(82),r=n(36),o=n(45),s={};n(27)(s,n(14)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=i(s,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e,n){"use strict";var i=n(128),r=n(129),o=n(39),s=n(37);t.exports=n(81)(Array,"Array",(function(t,e){this._t=s(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var i,r,o,s,a=n(43),l=n(12),u=n(32),c=n(64),h=n(11),p=n(15),f=n(40),d=n(65),g=n(52),y=n(88),m=n(89).set,_=n(132)(),v=n(67),x=n(90),C=n(133),w=n(91),b=l.TypeError,E=l.process,I=E&&E.versions,P=I&&I.v8||"",N=l.Promise,S="process"==c(E),T=function(){},L=r=v.f,M=!!function(){try{var t=N.resolve(1),e=(t.constructor={})[n(14)("species")]=function(t){t(T,T)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(T)instanceof e&&0!==P.indexOf("6.6")&&-1===C.indexOf("Chrome/66")}catch(t){}}(),O=function(t){var e;return!(!p(t)||"function"!=typeof(e=t.then))&&e},R=function(t,e){if(!t._n){t._n=!0;var n=t._c;_((function(){for(var i=t._v,r=1==t._s,o=0,s=function(e){var n,o,s,a=r?e.ok:e.fail,l=e.resolve,u=e.reject,c=e.domain;try{a?(r||(2==t._h&&F(t),t._h=1),!0===a?n=i:(c&&c.enter(),n=a(i),c&&(c.exit(),s=!0)),n===e.promise?u(b("Promise-chain cycle")):(o=O(n))?o.call(n,l,u):l(n)):u(i)}catch(t){c&&!s&&c.exit(),u(t)}};n.length>o;)s(n[o++]);t._c=[],t._n=!1,e&&!t._h&&A(t)}))}},A=function(t){m.call(l,(function(){var e,n,i,r=t._v,o=D(t);if(o&&(e=x((function(){S?E.emit("unhandledRejection",r,t):(n=l.onunhandledrejection)?n({promise:t,reason:r}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",r)})),t._h=S||D(t)?2:1),t._a=void 0,o&&e.e)throw e.v}))},D=function(t){return 1!==t._h&&0===(t._a||t._c).length},F=function(t){m.call(l,(function(){var e;S?E.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})}))},k=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),R(e,!0))},B=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw b("Promise can't be resolved itself");(e=O(t))?_((function(){var i={_w:n,_d:!1};try{e.call(t,u(B,i,1),u(k,i,1))}catch(t){k.call(i,t)}})):(n._v=t,n._s=1,R(n,!1))}catch(t){k.call({_w:n,_d:!1},t)}}};M||(N=function(t){d(this,N,"Promise","_h"),f(t),i.call(this);try{t(u(B,this,1),u(k,this,1))}catch(t){k.call(this,t)}},(i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(68)(N.prototype,{then:function(t,e){var n=L(y(this,N));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=S?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&R(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new i;this.promise=t,this.resolve=u(B,t,1),this.reject=u(k,t,1)},v.f=L=function(t){return t===N||t===s?new o(t):r(t)}),h(h.G+h.W+h.F*!M,{Promise:N}),n(45)(N,"Promise"),n(134)("Promise"),s=n(9).Promise,h(h.S+h.F*!M,"Promise",{reject:function(t){var e=L(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(a||!M),"Promise",{resolve:function(t){return w(a&&this===s?N:this,t)}}),h(h.S+h.F*!(M&&n(92)((function(t){N.all(t).catch(T)}))),"Promise",{all:function(t){var e=this,n=L(e),i=n.resolve,r=n.reject,o=x((function(){var n=[],o=0,s=1;g(t,!1,(function(t){var a=o++,l=!1;n.push(void 0),s++,e.resolve(t).then((function(t){l||(l=!0,n[a]=t,--s||i(n))}),r)})),--s||i(n)}));return o.e&&r(o.v),n.promise},race:function(t){var e=this,n=L(e),i=n.reject,r=x((function(){g(t,!1,(function(t){e.resolve(t).then(n.resolve,i)}))}));return r.e&&i(r.v),n.promise}})},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var i=n(12),r=n(89).set,o=i.MutationObserver||i.WebKitMutationObserver,s=i.process,a=i.Promise,l="process"==n(42)(s);t.exports=function(){var t,e,n,u=function(){var i,r;for(l&&(i=s.domain)&&i.exit();t;){r=t.fn,t=t.next;try{r()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(l)n=function(){s.nextTick(u)};else if(!o||i.navigator&&i.navigator.standalone)if(a&&a.resolve){var c=a.resolve(void 0);n=function(){c.then(u)}}else n=function(){r.call(i,u)};else{var h=!0,p=document.createTextNode("");new o(u).observe(p,{characterData:!0}),n=function(){p.data=h=!h}}return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}},function(t,e,n){var i=n(12).navigator;t.exports=i&&i.userAgent||""},function(t,e,n){"use strict";var i=n(12),r=n(9),o=n(18),s=n(20),a=n(14)("species");t.exports=function(t){var e="function"==typeof r[t]?r[t]:i[t];s&&e&&!e[a]&&o.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){"use strict";var i=n(11),r=n(9),o=n(12),s=n(88),a=n(91);i(i.P+i.R,"Promise",{finally:function(t){var e=s(this,r.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return a(e,t()).then((function(){return n}))}:t,n?function(n){return a(e,t()).then((function(){throw n}))}:t)}})},function(t,e,n){"use strict";var i=n(11),r=n(67),o=n(90);i(i.S,"Promise",{try:function(t){var e=r.f(this),n=o(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){t.exports={default:n(138),__esModule:!0}},function(t,e,n){n(44),n(139),t.exports=n(9).Array.from},function(t,e,n){"use strict";var i=n(32),r=n(11),o=n(38),s=n(86),a=n(87),l=n(49),u=n(140),c=n(66);r(r.S+r.F*!n(92)((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,r,h,p=o(t),f="function"==typeof this?this:Array,d=arguments.length,g=d>1?arguments[1]:void 0,y=void 0!==g,m=0,_=c(p);if(y&&(g=i(g,d>2?arguments[2]:void 0,2)),null==_||f==Array&&a(_))for(n=new f(e=l(p.length));e>m;m++)u(n,m,y?g(p[m],m):p[m]);else for(h=_.call(p),n=new f;!(r=h.next()).done;m++)u(n,m,y?s(h,g,[r.value,m],!0):r.value);return n.length=m,n}})},function(t,e,n){"use strict";var i=n(18),r=n(36);t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},function(t,e,n){t.exports={default:n(142),__esModule:!0}},function(t,e,n){n(44),n(46),t.exports=n(70).f("iterator")},function(t,e,n){t.exports={default:n(144),__esModule:!0}},function(t,e,n){n(145),n(62),n(148),n(149),t.exports=n(9).Symbol},function(t,e,n){"use strict";var i=n(12),r=n(24),o=n(20),s=n(11),a=n(63),l=n(47).KEY,u=n(33),c=n(59),h=n(45),p=n(50),f=n(14),d=n(70),g=n(71),y=n(146),m=n(93),_=n(19),v=n(15),x=n(38),C=n(37),w=n(54),b=n(36),E=n(82),I=n(147),P=n(95),N=n(61),S=n(18),T=n(41),L=P.f,M=S.f,O=I.f,R=i.Symbol,A=i.JSON,D=A&&A.stringify,F=f("_hidden"),k=f("toPrimitive"),B={}.propertyIsEnumerable,G=c("symbol-registry"),j=c("symbols"),z=c("op-symbols"),U=Object.prototype,q="function"==typeof R&&!!N.f,V=i.QObject,H=!V||!V.prototype||!V.prototype.findChild,Y=o&&u((function(){return 7!=E(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a}))?function(t,e,n){var i=L(U,e);i&&delete U[e],M(t,e,n),i&&t!==U&&M(U,e,i)}:M,X=function(t){var e=j[t]=E(R.prototype);return e._k=t,e},W=q&&"symbol"==typeof R.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof R},K=function(t,e,n){return t===U&&K(z,e,n),_(t),e=w(e,!0),_(n),r(j,e)?(n.enumerable?(r(t,F)&&t[F][e]&&(t[F][e]=!1),n=E(n,{enumerable:b(0,!1)})):(r(t,F)||M(t,F,b(1,{})),t[F][e]=!0),Y(t,e,n)):M(t,e,n)},Z=function(t,e){_(t);for(var n,i=y(e=C(e)),r=0,o=i.length;o>r;)K(t,n=i[r++],e[n]);return t},J=function(t){var e=B.call(this,t=w(t,!0));return!(this===U&&r(j,t)&&!r(z,t))&&(!(e||!r(this,t)||!r(j,t)||r(this,F)&&this[F][t])||e)},Q=function(t,e){if(t=C(t),e=w(e,!0),t!==U||!r(j,e)||r(z,e)){var n=L(t,e);return!n||!r(j,e)||r(t,F)&&t[F][e]||(n.enumerable=!0),n}},$=function(t){for(var e,n=O(C(t)),i=[],o=0;n.length>o;)r(j,e=n[o++])||e==F||e==l||i.push(e);return i},tt=function(t){for(var e,n=t===U,i=O(n?z:C(t)),o=[],s=0;i.length>s;)!r(j,e=i[s++])||n&&!r(U,e)||o.push(j[e]);return o};q||(a((R=function(){if(this instanceof R)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),e=function(n){this===U&&e.call(z,n),r(this,F)&&r(this[F],t)&&(this[F][t]=!1),Y(this,t,b(1,n))};return o&&H&&Y(U,t,{configurable:!0,set:e}),X(t)}).prototype,"toString",(function(){return this._k})),P.f=Q,S.f=K,n(94).f=I.f=$,n(51).f=J,N.f=tt,o&&!n(43)&&a(U,"propertyIsEnumerable",J,!0),d.f=function(t){return X(f(t))}),s(s.G+s.W+s.F*!q,{Symbol:R});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)f(et[nt++]);for(var it=T(f.store),rt=0;it.length>rt;)g(it[rt++]);s(s.S+s.F*!q,"Symbol",{for:function(t){return r(G,t+="")?G[t]:G[t]=R(t)},keyFor:function(t){if(!W(t))throw TypeError(t+" is not a symbol!");for(var e in G)if(G[e]===t)return e},useSetter:function(){H=!0},useSimple:function(){H=!1}}),s(s.S+s.F*!q,"Object",{create:function(t,e){return void 0===e?E(t):Z(E(t),e)},defineProperty:K,defineProperties:Z,getOwnPropertyDescriptor:Q,getOwnPropertyNames:$,getOwnPropertySymbols:tt});var ot=u((function(){N.f(1)}));s(s.S+s.F*ot,"Object",{getOwnPropertySymbols:function(t){return N.f(x(t))}}),A&&s(s.S+s.F*(!q||u((function(){var t=R();return"[null]"!=D([t])||"{}"!=D({a:t})||"{}"!=D(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=e=i[1],(v(e)||void 0!==t)&&!W(t))return m(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!W(e))return e}),i[1]=e,D.apply(A,i)}}),R.prototype[k]||n(27)(R.prototype,k,R.prototype.valueOf),h(R,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){var i=n(41),r=n(61),o=n(51);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var s,a=n(t),l=o.f,u=0;a.length>u;)l.call(t,s=a[u++])&&e.push(s);return e}},function(t,e,n){var i=n(37),r=n(94).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?function(t){try{return r(t)}catch(t){return s.slice()}}(t):r(i(t))}},function(t,e,n){n(71)("asyncIterator")},function(t,e,n){n(71)("observable")},function(t,e,n){n(46),n(44),t.exports=n(151)},function(t,e,n){var i=n(19),r=n(66);t.exports=n(9).getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},function(t,e,n){"use strict";var i=n(16),r=n(96),o=n(153),s=n(102);function a(t){var e=new o(t),n=r(o.prototype.request,e);return i.extend(n,o.prototype,e),i.extend(n,e),n}var l=a(n(99));l.Axios=o,l.create=function(t){return a(s(l.defaults,t))},l.Cancel=n(103),l.CancelToken=n(166),l.isCancel=n(98),l.all=function(t){return Promise.all(t)},l.spread=n(167),t.exports=l,t.exports.default=l},function(t,e,n){"use strict";var i=n(16),r=n(97),o=n(154),s=n(155),a=n(102);function l(t){this.defaults=t,this.interceptors={request:new o,response:new o}}l.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=a(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=[s,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));e.length;)n=n.then(e.shift(),e.shift());return n},l.prototype.getUri=function(t){return t=a(this.defaults,t),r(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(t){l.prototype[t]=function(e,n){return this.request(a(n||{},{method:t,url:e}))}})),i.forEach(["post","put","patch"],(function(t){l.prototype[t]=function(e,n,i){return this.request(a(i||{},{method:t,url:e,data:n}))}})),t.exports=l},function(t,e,n){"use strict";var i=n(16);function r(){this.handlers=[]}r.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},r.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},r.prototype.forEach=function(t){i.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=r},function(t,e,n){"use strict";var i=n(16),r=n(156),o=n(98),s=n(99);function a(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return a(t),t.headers=t.headers||{},t.data=r(t.data,t.headers,t.transformRequest),t.headers=i.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||s.adapter)(t).then((function(e){return a(t),e.data=r(e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(a(t),e&&e.response&&(e.response.data=r(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},function(t,e,n){"use strict";var i=n(16);t.exports=function(t,e,n){return i.forEach(n,(function(n){t=n(t,e)})),t}},function(t,e,n){"use strict";var i=n(16);t.exports=function(t,e){i.forEach(t,(function(n,i){i!==e&&i.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[i])}))}},function(t,e,n){"use strict";var i=n(101);t.exports=function(t,e,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?e(i("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}},function(t,e,n){"use strict";t.exports=function(t,e,n,i,r){return t.config=e,n&&(t.code=n),t.request=i,t.response=r,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},function(t,e,n){"use strict";var i=n(16);t.exports=i.isStandardBrowserEnv()?{write:function(t,e,n,r,o,s){var a=[];a.push(t+"="+encodeURIComponent(e)),i.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),i.isString(r)&&a.push("path="+r),i.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,n){"use strict";var i=n(162),r=n(163);t.exports=function(t,e){return t&&!i(e)?r(t,e):e}},function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,n){"use strict";var i=n(16),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,o,s={};return t?(i.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=i.trim(t.substr(0,o)).toLowerCase(),n=i.trim(t.substr(o+1)),e){if(s[e]&&r.indexOf(e)>=0)return;s[e]="set-cookie"===e?(s[e]?s[e]:[]).concat([n]):s[e]?s[e]+", "+n:n}})),s):s}},function(t,e,n){"use strict";var i=n(16);t.exports=i.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(t){var i=t;return e&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=r(window.location.href),function(e){var n=i.isString(e)?r(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},function(t,e,n){"use strict";var i=n(103);function r(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;t((function(t){n.reason||(n.reason=new i(t),e(n.reason))}))}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var t;return{token:new r((function(e){t=e})),cancel:t}},t.exports=r},function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,n){n(169);var i=n(9).Object;t.exports=function(t,e){return i.defineProperties(t,e)}},function(t,e,n){var i=n(11);i(i.S+i.F*!n(20),"Object",{defineProperties:n(83)})},function(module,__webpack_exports__,__webpack_require__){"use strict";var babel_runtime_core_js_reflect_set__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(111),babel_runtime_core_js_reflect_set__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(babel_runtime_core_js_reflect_set__WEBPACK_IMPORTED_MODULE_0__),babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10),babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_1__),babel_runtime_core_js_promise__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3),babel_runtime_core_js_promise__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(babel_runtime_core_js_promise__WEBPACK_IMPORTED_MODULE_2__),babel_runtime_core_js_weak_map__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(112),babel_runtime_core_js_weak_map__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(babel_runtime_core_js_weak_map__WEBPACK_IMPORTED_MODULE_3__),babel_runtime_core_js_get_iterator__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6),babel_runtime_core_js_get_iterator__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(babel_runtime_core_js_get_iterator__WEBPACK_IMPORTED_MODULE_4__),babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_5__),babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1),babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6__),_Sf3d__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(0),axios__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(17),axios__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_8__),_multiEarthSyncHelper__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(113),wkt_parser_helper__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(114),wkt_parser_helper__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(wkt_parser_helper__WEBPACK_IMPORTED_MODULE_10__),dat=__webpack_require__(183),tj=__webpack_require__(184);_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util=function(){},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.axios=axios__WEBPACK_IMPORTED_MODULE_8___default.a.create({}),_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.dat=dat,_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.genDataGui=function(t){var e={},n=function(t,e){for(var n in t)try{i(t,n,e)}catch(t){console.warn(t)}},i=function(i,r,o){var s=i[r];if(!s.noConfig)if(s.type==_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PropertyType.Position){var a=function(){t[r]=(new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d).fromLngLat(e[r+"_lng"],e[r+"_lat"],e[r+"_height"])},l=t[r].exportLngLatHeightArray();e[r+"_lng"]=l[0],e[r+"_lat"]=l[1],e[r+"_height"]=l[2],(c=o.addFolder(r)).add(e,r+"_lng",-180,180).step(1e-4).onChange(a),c.add(e,r+"_lat",-90,90).step(1e-4).onChange(a),c.add(e,r+"_height").step(1).onChange(a)}else if(s.type==_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PropertyType.Color){e[r]=t[r].export255Array(),(h=o.addColor(e,r)).onChange((function(e){t[r]=new(Function.prototype.bind.apply(_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Color,[null].concat(babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(e))))}))}else if(s.type==_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PropertyType.Dictionary){var u={};s.options.forEach((function(t){u[t.key]=t.value})),e[r]=t[r],(h=o.add(e,r,u)).onChange((function(e){t[r]=e}))}else if(s.type==_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PropertyType.Combine){var c=o.addFolder(r);n(s.items,c)}else if("function"==typeof s)e[r]=s,h=o.add(e,r);else{e[r]=t[r];var h=null;if((h=s.range?o.add.apply(o,[e,r].concat(babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(s.range))):o.add(e,r)).onChange((function(e){t[r]=e})),s.type==_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PropertyType.Float){var p=.01;isNaN(s.step)||(p=s.step),h.step(p)}else if(s.type==_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PropertyType.Int){p=1;isNaN(s.step)||(p=s.step),h.step(p)}}};return n(t.config,new dat.GUI),e},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.guid=function(){try{for(var t=String.fromCharCode(65+Math.floor(26*Math.random())),e=0;e<31;++e){var n=Math.floor(62*Math.random());t+=n<10?n.toString():n<36?String.fromCharCode(65+n-10):String.fromCharCode(97+n-10-26)}return t}catch(t){return null}},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.wgs2gcj=function(t){try{var e=0,n=0,i=null;if(!(t instanceof _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d))throw"";e=(i=t.exportLngLatHeightArray())[0],n=i[1];var r=3.141592653589793,o=6378245,s=.006693421622965943;if(!function(t,e){return!(t<72.004||t>137.8347)&&!(e<.8293||e>55.8271)}(e,n))return(new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d).fromLngLat(e,n,i[2]);var a=function(t,e){var n=2*t-100+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*r)+20*Math.sin(2*t*r))/3,n+=2*(20*Math.sin(e*r)+40*Math.sin(e/3*r))/3,n+=2*(160*Math.sin(e/12*r)+320*Math.sin(e*r/30))/3}(e-105,n-35),l=function(t,e){var n=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*r)+20*Math.sin(2*t*r))/3,n+=2*(20*Math.sin(t*r)+40*Math.sin(t/3*r))/3,n+=2*(150*Math.sin(t/12*r)+300*Math.sin(t/30*r))/3}(e-105,n-35),u=n/180*r,c=Math.sin(u);c=1-s*c*c;var h=Math.sqrt(c);a=180*a/(o*(1-s)/(c*h)*r),l=180*l/(o/h*Math.cos(u)*r);var p=n+a,f=e+l;return(new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d).fromLngLat(f,p,i[2])}catch(t){return null}},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.gcj2wgs84=function(t){var e=0,n=0,i=null;try{if(!(t instanceof _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d))throw"";e=(i=t.exportLngLatHeightArray())[0],n=i[1];var r=3.141592653589793,o=6378245,s=.006693421622965943;if(!function(t,e){return!(t<72.004||t>137.8347)&&!(e<.8293||e>55.8271)}(e,n))return(new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d).fromLngLat(e,n,i[2]);var a=function(t,e){var n=2*t-100+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*r)+20*Math.sin(2*t*r))/3,n+=2*(20*Math.sin(e*r)+40*Math.sin(e/3*r))/3,n+=2*(160*Math.sin(e/12*r)+320*Math.sin(e*r/30))/3}(e-105,n-35),l=function(t,e){var n=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*r)+20*Math.sin(2*t*r))/3,n+=2*(20*Math.sin(t*r)+40*Math.sin(t/3*r))/3,n+=2*(150*Math.sin(t/12*r)+300*Math.sin(t/30*r))/3}(e-105,n-35),u=n/180*r,c=Math.sin(u);c=1-s*c*c;var h=Math.sqrt(c);a=180*a/(o*(1-s)/(c*h)*r),l=180*l/(o/h*Math.cos(u)*r);var p=n+a,f=e+l;return(new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d).fromLngLat(2*e-f,2*n-p,i[2])}catch(t){return null}},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.getLevelByHeight=function(t){var e=-40467.74;return Math.round(e+80955.31/(1+Math.pow(t/91610.74,7096758e-11)))},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.getHeightByLevel=function(t){var e=-40467.74;return 91610.74*Math.pow(80955.31/(t-e)-1,1/7096758e-11)},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.pickCoordAnyway=function(t){var e=_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.pickCoord(babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_5___default()({relative:!0},t,{wholeScene:!0}));return e||(e=_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.pickCoord(babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_5___default()({relative:!0},t,{wholeScene:!1}))),e},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.pickCoord=function(t){try{var e=isNaN(t.x)?0:t.x,n=isNaN(t.y)?0:t.y;if(!1===t.relative){var i=_sf3d.container.getBoundingClientRect();e-=i.x,n-=i.y}var r=new Cesium.Cartesian2(e,n),o=null,s=window._cesium;if(s)if(t.wholeScene)o=s.scene.pickPosition(r);else{var a=s.camera.getPickRay(r);o=s.scene.globe.pick(a,s.scene)}return o?(new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d).fromCartesian(o):null}catch(t){return null}},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.sampleHeight=function(t){var e=_sf3d.viewer,n=Cesium.Cartographic.fromDegrees(t.lng,t.lat);if(!0===t.wholeScene){var i=e.scene.sampleHeight(n,t.objectsToExclude||[]);return void 0===i&&(i=e.scene.globe.getHeight(n)),i}return e.scene.globe.getHeight(n)},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.Point2ScreenCoord=function(t){if(t instanceof _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d&&_cesium){var e=Cesium.SceneTransforms.wgs84ToWindowCoordinates(_cesium.scene,t.exportCartesian());return[e.x,e.y]}return null},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.Point3dCollection2Geojson=function(t){var e={type:"FeatureCollection",features:[]};return Array.isArray(t)&&t.forEach((function(t){!function(t){switch(t.dtype){case _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PointCollectionType.Points:var n={geometry:{type:"MultiPoints",coordinates:[]},type:"Feature"};t.forEach((function(t){n.geometry.coordinates.push(t.exportLngLatArray())})),n.properties=t.properties,e.features.push(n);break;case _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PointCollectionType.PolyLine:n={geometry:{type:"LineString",coordinates:[]},type:"Feature"};t.forEach((function(t){n.geometry.coordinates.push(t.exportLngLatArray())})),n.properties=t.properties,e.features.push(n);break;case _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PointCollectionType.Polygon:n={geometry:{type:"Polygon",coordinates:[[]]},type:"Feature"};t.forEach((function(t){n.geometry.coordinates[0].push(t.exportLngLatArray())})),n.properties=t.properties,e.features.push(n);break;default:console.warn("geojson type is not define")}}(t)})),e},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.Kml2Geojson=function(t){return tj.kml(t)},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.Wkt2Geojson=function(t){return wkt_parser_helper__WEBPACK_IMPORTED_MODULE_10___default.a.parseFromWK(t,!0)},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.GeoJson2Point3dCollection=function(t){var e=[],n=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3dCollection;n.dtype=_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PointCollectionType.Points;var i=function(t,i){var r;switch(i.type){case"LineString Z":case"LineString":(o=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3dCollection(t?t.id:null)).dtype=_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PointCollectionType.PolyLine,i.coordinates.forEach((function(t){var e,n=(e=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d).fromLngLat.apply(e,babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(t));o.addPoint3d(n)})),o.properties=t,e.push(o);break;case"Polygon Z":case"Polygon":var o;(o=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3dCollection(t?t.id:null)).dtype=_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PointCollectionType.Polygon,i.coordinates.forEach((function(t){t.forEach((function(t){var e,n=(e=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d).fromLngLat.apply(e,babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(t));o.addPoint3d(n)}))})),o.properties=t,e.push(o);break;case"Point Z":case"Point":var s=(r=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d(t?t.id:null)).fromLngLat.apply(r,babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(i.coordinates));s.properties=t,n.addPoint3d(s);break;case"MultiPoint":i.coordinates.forEach((function(e){var i,r=(i=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d(t?t.id:null)).fromLngLat.apply(i,babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(e));r.properties=t,n.addPoint3d(r)}));break;case"MultiLineString":i.coordinates.forEach((function(n){var i=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3dCollection(t?t.id:null);i.dtype=_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PointCollectionType.PolyLine,i.properties=t,n.forEach((function(t){var n,r=(n=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d).fromLngLat.apply(n,babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(t));i.addPoint3d(r),e.push(i)}))}));break;case"MultiPolygon":i.coordinates.forEach((function(n){var i=null,r=function(t,e){var n=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3dCollection(t?t.id:null);return n.dtype=_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.PointCollectionType.Polygon,e.forEach((function(t){var e,i=(e=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d).fromLngLat.apply(e,babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(t));n.addPoint3d(i)})),n.properties=t,n};n.forEach((function(e,n){0===n?i=r(t,e):i.holes.push(r(babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_5___default()({},t,{id:null}),e))})),e.push(i)}))}};return"FeatureCollection"==t.type?t.features.forEach((function(t){i(t.properties,t.geometry)})):"Feature"==t.type?i(t.properties,t.geometry):"GeometryCollection"==t.type&&t.geometries.forEach((function(t){i(null,t)})),n.size>0&&e.push(n),e},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.genLayerFromConfig=function(config){var layer=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Layer({name:config.name});switch(config.dtype){case _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.LayerDataType.Maptiles:layer.instances.push(new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Maptile(config));break;case _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.LayerDataType.Terrain:layer.instances.push(new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Terrain(config));break;case _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.LayerDataType.Tileset:layer.instances.push(new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.TilesetModel(config));break;case _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.LayerDataType.Geojson:_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.axios.get(config.url).then((function(geojson){var collections=_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.GeoJson2Point3dCollection(geojson);for(var prop in Array.isArray(collections)&&(config.traces=collections,1==collections.length&&(config.trace=collections[0])),config){var _ref7;if(Array.isArray(config[prop]))if(3==config[prop].length)config[prop]=(_ref7=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d).fromLngLat.apply(_ref7,babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(config[prop]));else 4==config[prop].length&&(config[prop]=new(Function.prototype.bind.apply(_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Color,[null].concat(babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(config[prop])))))}eval("var instance = new Sf3d."+config.typeName+"(config)"),layer.instances.push(instance)}))}return layer},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.genCurvePoints=function(t,e,n,i){var r=function(t,e){for(var n=[],i=0;i<e;i++){var r=o(t,i/e);n.push([r.x,r.y])}return n},o=function(t,e){for(var n=t.length,i=0,r=0,o=function(t,e){for(var n=1,i=1;e>0;)n*=t,i*=e,t--,e--;return n/i},s=0;s<n;s++){var a=t[s];i+=a.x*Math.pow(1-e,n-1-s)*Math.pow(e,s)*o(n-1,s),r+=a.y*Math.pow(1-e,n-1-s)*Math.pow(e,s)*o(n-1,s)}return{x:i,y:r}},s=t.exportLngLatHeightArray(),a=e.exportLngLatHeightArray(),l=s[0],u=s[1],c=a[0],h=a[1],p=function(t,e,n){var o=[{x:t[0],y:t[1]},{x:e[0],y:e[1]},{x:n[0],y:n[1]}];return r(o,i)}([u,0],[(h+u)/2,n],[h,0]),f=new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3dCollection;return p.forEach((function(t){var e=(c-l)*(t[0]-u)/(h-u)+l;f.addPoint3d((new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Point3d).fromLngLat(e,t[0],t[1]))})),f},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.calcColorByRange=function(t,e,n){var i=t/3,r=parseInt(e/i);r<0&&(r=0);var o=parseInt(e%i*255/i);o<0&&(o=0);var s=[];if(0==r)s=[0,parseFloat(o)/255,1];else if(1==r){var a=parseFloat(o)/255;s=[a,1,1-a]}else s=2==r?[1,1-parseFloat(o)/255,0]:[1,0,0];return s.forEach((function(t,e){s[e]=255*t})),new(Function.prototype.bind.apply(_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Color,[null].concat(babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_6___default()(s),[isNaN(n)?1:n])))},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.hsv2Rgb=function(t,e,n){e/=100,n/=100;var i=0,r=0,o=0,s=parseInt(t/60%6),a=t/60-s,l=n*(1-e),u=n*(1-a*e),c=n*(1-(1-a)*e);switch(s){case 0:i=n,r=c,o=l;break;case 1:i=u,r=n,o=l;break;case 2:i=l,r=n,o=c;break;case 3:i=l,r=u,o=n;break;case 4:i=c,r=l,o=n;break;case 5:i=n,r=l,o=u}return new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Color(i,r,o)},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.getFeatureInfo=function(t){if(t){if(t instanceof Cesium.Cesium3DTileFeature){var e=t.getPropertyNames(),n=[],i=!0,r=!1,o=void 0;try{for(var s,a=babel_runtime_core_js_get_iterator__WEBPACK_IMPORTED_MODULE_4___default()(e);!(i=(s=a.next()).done);i=!0){var l=s.value;n.push({key:l,value:t.getProperty(l)})}}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return n}if(t.id&&t.id instanceof Cesium.Entity){var u=[],c=t.id;if(c.properties){var h=c.properties.getValue();for(var p in h)u.push({key:p,value:h[p]})}return u}}return null},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.getFeatureInfoAsObject=function(t){var e=_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.getFeatureInfo(t);if(e){var n={};return e.forEach((function(t){return n[t.key]=t.value})),n}return null},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.highlightFeature=function(t,e){t&&t instanceof Cesium.Cesium3DTileFeature&&(t._ocolor||(t._ocolor=Cesium.Color.clone(t.color)),t.color=Cesium.Color.clone(e||Cesium.Color.RED,t.color))},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.stopHighlightFeature=function(t){t&&t instanceof Cesium.Cesium3DTileFeature&&(t._ocolor||(t._ocolor=Cesium.Color.clone(t.color)),t.color=Cesium.Color.clone(t._ocolor,t.color))},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.highlightFeatureByStyle=function(t,e){var n=babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_5___default()({type:1,color:new _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Color(255,255,0,1),idField:void 0},e||{}),i=n.type,r=n.color,o=n.idField;if(t&&t instanceof Cesium.Cesium3DTileFeature){o||(o=t.getPropertyNames()[0]);var s=r instanceof _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Color?"rgba("+r.export255Array().join(",")+")":"color('red')";1===i?t.tileset.style=new Cesium.Cesium3DTileStyle({color:{conditions:[["${feature['"+o+"']} === '"+t.getProperty(o)+"'",s],["true","color('white')"]]}}):2===i&&(t.tileset.style=new Cesium.Cesium3DTileStyle({color:{conditions:[["${feature['"+o+"']} === '"+t.getProperty(o)+"'","color('white')"],["true",s]]}}))}},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.stopHighlightFeatureByStyle=function(t){if(t){var e=new Cesium.Cesium3DTileStyle({color:{conditions:[["true","color('white')"]]}});t instanceof _Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.TilesetModel?t.instance._tileset.style=e:t instanceof Cesium.Cesium3DTileFeature?t.tileset.style=e:t instanceof Cesium.Cesium3DTileset&&(t.style=e)}},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.randomCssColor=function(){return"#"+Math.floor(16777215*Math.random()).toString(16).padStart(6,"0")};var pickSettingMap=new babel_runtime_core_js_weak_map__WEBPACK_IMPORTED_MODULE_3___default.a;_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.beforePickingPosition=function(t){pickSettingMap.has(t)||pickSettingMap.set(t,{depthTestAgainstTerrain:t.scene.globe.depthTestAgainstTerrain}),t.scene.globe.depthTestAgainstTerrain=!0},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.afterPickPosition=function(t){if(pickSettingMap.has(t)){var e=pickSettingMap.get(t);t.scene.globe.depthTestAgainstTerrain=e.depthTestAgainstTerrain,pickSettingMap.delete(t)}},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.xePlotReady=function(){return XE&&XE.Obj&&XE.Obj.Plots?babel_runtime_core_js_promise__WEBPACK_IMPORTED_MODULE_2___default.a.resolve():XE.HTML.loadJS(XE.HTML.xbsjEarthDir.replace("/XbsjEarth/","")+"/XbsjEarth-Plugins/plottingSymbol2/plottingSymbol2.js")},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.mapvReady=function(){return window.mapv?babel_runtime_core_js_promise__WEBPACK_IMPORTED_MODULE_2___default.a.resolve():XE.HTML.loadMapV()};var deepProxy=_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.DeepProxy=function(t,e){if("object"===(void 0===t?"undefined":babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_1___default()(t)))for(var n in t)"object"===babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_1___default()(t[n])&&(t[n]=deepProxy(t[n],e));return new Proxy(t,{set:function(t,n,i,r){"object"===(void 0===i?"undefined":babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_1___default()(i))&&(i=deepProxy(i,e));var o=null==t[n]?"create":"modify";return Array.isArray(t)&&"length"===n||t[n]!==i&&e(o,{target:t,key:n,value:i}),babel_runtime_core_js_reflect_set__WEBPACK_IMPORTED_MODULE_0___default()(t,n,i,r)}})},radiansPerDegree=Math.PI/180,degreesPerRadian=180/Math.PI;_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.getBearing=function(t,e){var n=t.lat*radiansPerDegree,i=t.lng*radiansPerDegree,r=e.lat*radiansPerDegree,o=e.lng*radiansPerDegree,s=-Math.atan2(Math.sin(i-o)*Math.cos(r),Math.cos(n)*Math.sin(r)-Math.sin(n)*Math.cos(r)*Math.cos(i-o));return s<0&&(s+=2*Math.PI),s*=degreesPerRadian},_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util.syncHelper=_multiEarthSyncHelper__WEBPACK_IMPORTED_MODULE_9__;var _unused_webpack_default_export=_Sf3d__WEBPACK_IMPORTED_MODULE_7__.a.Util},function(t,e,n){n(172),t.exports=n(9).Reflect.set},function(t,e,n){var i=n(18),r=n(95),o=n(85),s=n(24),a=n(11),l=n(36),u=n(19),c=n(15);a(a.S,"Reflect",{set:function t(e,n,a){var h,p,f=arguments.length<4?e:arguments[3],d=r.f(u(e),n);if(!d){if(c(p=o(e)))return t(p,n,a,f);d=l(0)}if(s(d,"value")){if(!1===d.writable||!c(f))return!1;if(h=r.f(f,n)){if(h.get||h.set||!1===h.writable)return!1;h.value=a,i.f(f,n,h)}else i.f(f,n,l(0,a));return!0}return void 0!==d.set&&(d.set.call(f,a),!0)}})},function(t,e,n){n(62),n(46),n(174),n(179),n(181),t.exports=n(9).WeakMap},function(t,e,n){"use strict";var i,r=n(12),o=n(72)(0),s=n(63),a=n(47),l=n(79),u=n(177),c=n(15),h=n(73),p=n(73),f=!r.ActiveXObject&&"ActiveXObject"in r,d=a.getWeak,g=Object.isExtensible,y=u.ufstore,m=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},_={get:function(t){if(c(t)){var e=d(t);return!0===e?y(h(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return u.def(h(this,"WeakMap"),t,e)}},v=t.exports=n(178)("WeakMap",m,_,u,!0,!0);p&&f&&(l((i=u.getConstructor(m,"WeakMap")).prototype,_),a.NEED=!0,o(["delete","has","get","set"],(function(t){var e=v.prototype,n=e[t];s(e,t,(function(e,r){if(c(e)&&!g(e)){this._f||(this._f=new i);var o=this._f[t](e,r);return"set"==t?this:o}return n.call(this,e,r)}))})))},function(t,e,n){var i=n(176);t.exports=function(t,e){return new(i(t))(e)}},function(t,e,n){var i=n(15),r=n(93),o=n(14)("species");t.exports=function(t){var e;return r(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var i=n(68),r=n(47).getWeak,o=n(19),s=n(15),a=n(65),l=n(52),u=n(72),c=n(24),h=n(73),p=u(5),f=u(6),d=0,g=function(t){return t._l||(t._l=new y)},y=function(){this.a=[]},m=function(t,e){return p(t.a,(function(t){return t[0]===e}))};y.prototype={get:function(t){var e=m(this,t);if(e)return e[1]},has:function(t){return!!m(this,t)},set:function(t,e){var n=m(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=f(this.a,(function(e){return e[0]===t}));return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,o){var u=t((function(t,i){a(t,u,e,"_i"),t._t=e,t._i=d++,t._l=void 0,null!=i&&l(i,n,t[o],t)}));return i(u.prototype,{delete:function(t){if(!s(t))return!1;var n=r(t);return!0===n?g(h(this,e)).delete(t):n&&c(n,this._i)&&delete n[this._i]},has:function(t){if(!s(t))return!1;var n=r(t);return!0===n?g(h(this,e)).has(t):n&&c(n,this._i)}}),u},def:function(t,e,n){var i=r(o(e),!0);return!0===i?g(t).set(e,n):i[t._i]=n,t},ufstore:g}},function(t,e,n){"use strict";var i=n(12),r=n(11),o=n(47),s=n(33),a=n(27),l=n(68),u=n(52),c=n(65),h=n(15),p=n(45),f=n(18).f,d=n(72)(0),g=n(20);t.exports=function(t,e,n,y,m,_){var v=i[t],x=v,C=m?"set":"add",w=x&&x.prototype,b={};return g&&"function"==typeof x&&(_||w.forEach&&!s((function(){(new x).entries().next()})))?(x=e((function(e,n){c(e,x,t,"_c"),e._c=new v,null!=n&&u(n,m,e[C],e)})),d("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(t){var e="add"==t||"set"==t;!(t in w)||_&&"clear"==t||a(x.prototype,t,(function(n,i){if(c(this,x,t),!e&&_&&!h(n))return"get"==t&&void 0;var r=this._c[t](0===n?0:n,i);return e?this:r}))})),_||f(x.prototype,"size",{get:function(){return this._c.size}})):(x=y.getConstructor(e,t,m,C),l(x.prototype,n),o.NEED=!0),p(x,t),b[t]=x,r(r.G+r.W+r.F,b),_||y.setStrong(x,t,m),x}},function(t,e,n){n(180)("WeakMap")},function(t,e,n){"use strict";var i=n(11);t.exports=function(t){i(i.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){n(182)("WeakMap")},function(t,e,n){"use strict";var i=n(11),r=n(40),o=n(32),s=n(52);t.exports=function(t){i(i.S,t,{from:function(t){var e,n,i,a,l=arguments[1];return r(this),(e=void 0!==l)&&r(l),null==t?new this:(n=[],e?(i=0,a=o(l,arguments[2],2),s(t,!1,(function(t){n.push(a(t,i++))}))):s(t,!1,n.push,n),new this(n))}})}},function(t,e,n){"use strict";function i(t,e){var n=t.__state.conversionName.toString(),i=Math.round(t.r),r=Math.round(t.g),o=Math.round(t.b),s=t.a,a=Math.round(t.h),l=t.s.toFixed(1),u=t.v.toFixed(1);if(e||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var c=t.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===n?"rgb("+i+","+r+","+o+")":"CSS_RGBA"===n?"rgba("+i+","+r+","+o+","+s+")":"HEX"===n?"0x"+t.hex.toString(16):"RGB_ARRAY"===n?"["+i+","+r+","+o+"]":"RGBA_ARRAY"===n?"["+i+","+r+","+o+","+s+"]":"RGB_OBJ"===n?"{r:"+i+",g:"+r+",b:"+o+"}":"RGBA_OBJ"===n?"{r:"+i+",g:"+r+",b:"+o+",a:"+s+"}":"HSV_OBJ"===n?"{h:"+a+",s:"+l+",v:"+u+"}":"HSVA_OBJ"===n?"{h:"+a+",s:"+l+",v:"+u+",a:"+s+"}":"unknown format"}n.r(e),n.d(e,"color",(function(){return ut})),n.d(e,"controllers",(function(){return ct})),n.d(e,"dom",(function(){return ht})),n.d(e,"gui",(function(){return pt})),n.d(e,"GUI",(function(){return ft}));var r=Array.prototype.forEach,o=Array.prototype.slice,s={BREAK:{},extend:function(t){return this.each(o.call(arguments,1),(function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(n){this.isUndefined(e[n])||(t[n]=e[n])}.bind(this))}),this),t},defaults:function(t){return this.each(o.call(arguments,1),(function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(n){this.isUndefined(t[n])&&(t[n]=e[n])}.bind(this))}),this),t},compose:function(){var t=o.call(arguments);return function(){for(var e=o.call(arguments),n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},each:function(t,e,n){if(t)if(r&&t.forEach&&t.forEach===r)t.forEach(e,n);else if(t.length===t.length+0){var i,o=void 0;for(o=0,i=t.length;o<i;o++)if(o in t&&e.call(n,t[o],o)===this.BREAK)return}else for(var s in t)if(e.call(n,t[s],s)===this.BREAK)return},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i=void 0;return function(){var r=this,o=arguments;function s(){i=null,n||t.apply(r,o)}var a=n||!i;clearTimeout(i),i=setTimeout(s,e),a&&t.apply(r,o)}},toArray:function(t){return t.toArray?t.toArray():o.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return isNaN(t)})),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return t instanceof Function}},a=[{litmus:s.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:i},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:i},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:i},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:i}}},{litmus:s.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:s.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:s.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(s.isNumber(t.r)&&s.isNumber(t.g)&&s.isNumber(t.b)&&s.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(s.isNumber(t.r)&&s.isNumber(t.g)&&s.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(s.isNumber(t.h)&&s.isNumber(t.s)&&s.isNumber(t.v)&&s.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(s.isNumber(t.h)&&s.isNumber(t.s)&&s.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}],l=void 0,u=void 0,c=function(){u=!1;var t=arguments.length>1?s.toArray(arguments):arguments[0];return s.each(a,(function(e){if(e.litmus(t))return s.each(e.conversions,(function(e,n){if(l=e.read(t),!1===u&&!1!==l)return u=l,l.conversionName=n,l.conversion=e,s.BREAK})),s.BREAK})),u},h=void 0,p={hsv_to_rgb:function(t,e,n){var i=Math.floor(t/60)%6,r=t/60-Math.floor(t/60),o=n*(1-e),s=n*(1-r*e),a=n*(1-(1-r)*e),l=[[n,a,o],[s,n,o],[o,n,a],[o,s,n],[a,o,n],[n,o,s]][i];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(t,e,n){var i=Math.min(t,e,n),r=Math.max(t,e,n),o=r-i,s=void 0;return 0===r?{h:NaN,s:0,v:0}:(s=t===r?(e-n)/o:e===r?2+(n-t)/o:4+(t-e)/o,(s/=6)<0&&(s+=1),{h:360*s,s:o/r,v:r/255})},rgb_to_hex:function(t,e,n){var i=this.hex_with_component(0,2,t);return i=this.hex_with_component(i,1,e),i=this.hex_with_component(i,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(t,e,n){return n<<(h=8*e)|t&~(255<<h)}},f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},g=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),y=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},m=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},_=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},v=function(){function t(){if(d(this,t),this.__state=c.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return g(t,[{key:"toString",value:function(){return i(this)}},{key:"toHexString",value:function(){return i(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),t}();function x(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space||v.recalculateRGB(this,e,n),this.__state[e]},set:function(t){"RGB"!==this.__state.space&&(v.recalculateRGB(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function C(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space||v.recalculateHSV(this),this.__state[e]},set:function(t){"HSV"!==this.__state.space&&(v.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=t}})}v.recalculateRGB=function(t,e,n){if("HEX"===t.__state.space)t.__state[e]=p.component_from_hex(t.__state.hex,n);else{if("HSV"!==t.__state.space)throw new Error("Corrupted color state");s.extend(t.__state,p.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}},v.recalculateHSV=function(t){var e=p.rgb_to_hsv(t.r,t.g,t.b);s.extend(t.__state,{s:e.s,v:e.v}),s.isNaN(e.h)?s.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h},v.COMPONENTS=["r","g","b","h","s","v","hex","a"],x(v.prototype,"r",2),x(v.prototype,"g",1),x(v.prototype,"b",0),C(v.prototype,"h"),C(v.prototype,"s"),C(v.prototype,"v"),Object.defineProperty(v.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(v.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=p.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}});var w=function(){function t(e,n){d(this,t),this.initialValue=e[n],this.domElement=document.createElement("div"),this.object=e,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return g(t,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),t}(),b={};s.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},(function(t,e){s.each(t,(function(t){b[t]=e}))}));var E=/(\d+(\.\d+)?)px/;function I(t){if("0"===t||s.isUndefined(t))return 0;var e=t.match(E);return s.isNull(e)?0:parseFloat(e[1])}var P={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(t,e,n){var i=n,r=e;s.isUndefined(r)&&(r=!0),s.isUndefined(i)&&(i=!0),t.style.position="absolute",r&&(t.style.left=0,t.style.right=0),i&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,e,n,i){var r=n||{},o=b[e];if(!o)throw new Error("Event type "+e+" not supported.");var a=document.createEvent(o);switch(o){case"MouseEvents":var l=r.x||r.clientX||0,u=r.y||r.clientY||0;a.initMouseEvent(e,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,l,u,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=a.initKeyboardEvent||a.initKeyEvent;s.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(e,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:a.initEvent(e,r.bubbles||!1,r.cancelable||!0)}s.defaults(a,i),t.dispatchEvent(a)},bind:function(t,e,n,i){var r=i||!1;return t.addEventListener?t.addEventListener(e,n,r):t.attachEvent&&t.attachEvent("on"+e,n),P},unbind:function(t,e,n,i){var r=i||!1;return t.removeEventListener?t.removeEventListener(e,n,r):t.detachEvent&&t.detachEvent("on"+e,n),P},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);-1===n.indexOf(e)&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return P},removeClass:function(t,e){if(e)if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),i=n.indexOf(e);-1!==i&&(n.splice(i,1),t.className=n.join(" "))}else t.className=void 0;return P},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var e=getComputedStyle(t);return I(e["border-left-width"])+I(e["border-right-width"])+I(e["padding-left"])+I(e["padding-right"])+I(e.width)},getHeight:function(t){var e=getComputedStyle(t);return I(e["border-top-width"])+I(e["border-bottom-width"])+I(e["padding-top"])+I(e["padding-bottom"])+I(e.height)},getOffset:function(t){var e=t,n={left:0,top:0};if(e.offsetParent)do{n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent}while(e);return n},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}},N=function(t){function e(t,n){d(this,e);var i=_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),r=i;return i.__prev=i.getValue(),i.__checkbox=document.createElement("input"),i.__checkbox.setAttribute("type","checkbox"),P.bind(i.__checkbox,"change",(function(){r.setValue(!r.__prev)}),!1),i.domElement.appendChild(i.__checkbox),i.updateDisplay(),i}return m(e,t),g(e,[{key:"setValue",value:function(t){var n=y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(w),S=function(t){function e(t,n,i){d(this,e);var r=_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=i,a=r;if(r.__select=document.createElement("select"),s.isArray(o)){var l={};s.each(o,(function(t){l[t]=t})),o=l}return s.each(o,(function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),a.__select.appendChild(n)})),r.updateDisplay(),P.bind(r.__select,"change",(function(){var t=this.options[this.selectedIndex].value;a.setValue(t)})),r.domElement.appendChild(r.__select),r}return m(e,t),g(e,[{key:"setValue",value:function(t){var n=y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return P.isActive(this.__select)?this:(this.__select.value=this.getValue(),y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(w),T=function(t){function e(t,n){d(this,e);var i=_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),r=i;function o(){r.setValue(r.__input.value)}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),P.bind(i.__input,"keyup",o),P.bind(i.__input,"change",o),P.bind(i.__input,"blur",(function(){r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())})),P.bind(i.__input,"keydown",(function(t){13===t.keyCode&&this.blur()})),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return m(e,t),g(e,[{key:"updateDisplay",value:function(){return P.isActive(this.__input)||(this.__input.value=this.getValue()),y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(w);function L(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var M=function(t){function e(t,n,i){d(this,e);var r=_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=i||{};return r.__min=o.min,r.__max=o.max,r.__step=o.step,s.isUndefined(r.__step)?0===r.initialValue?r.__impliedStep=1:r.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(r.initialValue))/Math.LN10))/10:r.__impliedStep=r.__step,r.__precision=L(r.__impliedStep),r}return m(e,t),g(e,[{key:"setValue",value:function(t){var n=t;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(t){return this.__min=t,this}},{key:"max",value:function(t){return this.__max=t,this}},{key:"step",value:function(t){return this.__step=t,this.__impliedStep=t,this.__precision=L(t),this}}]),e}(w);var O=function(t){function e(t,n,i){d(this,e);var r=_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i));r.__truncationSuspended=!1;var o=r,a=void 0;function l(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function u(t){var e=a-t.clientY;o.setValue(o.getValue()+e*o.__impliedStep),a=t.clientY}function c(){P.unbind(window,"mousemove",u),P.unbind(window,"mouseup",c),l()}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),P.bind(r.__input,"change",(function(){var t=parseFloat(o.__input.value);s.isNaN(t)||o.setValue(t)})),P.bind(r.__input,"blur",(function(){l()})),P.bind(r.__input,"mousedown",(function(t){P.bind(window,"mousemove",u),P.bind(window,"mouseup",c),a=t.clientY})),P.bind(r.__input,"keydown",(function(t){13===t.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,l())})),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return m(e,t),g(e,[{key:"updateDisplay",value:function(){var t,n,i;return this.__input.value=this.__truncationSuspended?this.getValue():(t=this.getValue(),n=this.__precision,i=Math.pow(10,n),Math.round(t*i)/i),y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(M);function R(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)}var A=function(t){function e(t,n,i,r,o){d(this,e);var s=_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{min:i,max:r,step:o})),a=s;function l(t){t.preventDefault();var e=a.__background.getBoundingClientRect();return a.setValue(R(t.clientX,e.left,e.right,a.__min,a.__max)),!1}function u(){P.unbind(window,"mousemove",l),P.unbind(window,"mouseup",u),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function c(t){var e=t.touches[0].clientX,n=a.__background.getBoundingClientRect();a.setValue(R(e,n.left,n.right,a.__min,a.__max))}function h(){P.unbind(window,"touchmove",c),P.unbind(window,"touchend",h),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}return s.__background=document.createElement("div"),s.__foreground=document.createElement("div"),P.bind(s.__background,"mousedown",(function(t){document.activeElement.blur(),P.bind(window,"mousemove",l),P.bind(window,"mouseup",u),l(t)})),P.bind(s.__background,"touchstart",(function(t){if(1!==t.touches.length)return;P.bind(window,"touchmove",c),P.bind(window,"touchend",h),c(t)})),P.addClass(s.__background,"slider"),P.addClass(s.__foreground,"slider-fg"),s.updateDisplay(),s.__background.appendChild(s.__foreground),s.domElement.appendChild(s.__background),s}return m(e,t),g(e,[{key:"updateDisplay",value:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(M),D=function(t){function e(t,n,i){d(this,e);var r=_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=r;return r.__button=document.createElement("div"),r.__button.innerHTML=void 0===i?"Fire":i,P.bind(r.__button,"click",(function(t){return t.preventDefault(),o.fire(),!1})),P.addClass(r.__button,"button"),r.domElement.appendChild(r.__button),r}return m(e,t),g(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(w),F=function(t){function e(t,n){d(this,e);var i=_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));i.__color=new v(i.getValue()),i.__temp=new v(0);var r=i;i.domElement=document.createElement("div"),P.makeSelectable(i.domElement,!1),i.__selector=document.createElement("div"),i.__selector.className="selector",i.__saturation_field=document.createElement("div"),i.__saturation_field.className="saturation-field",i.__field_knob=document.createElement("div"),i.__field_knob.className="field-knob",i.__field_knob_border="2px solid ",i.__hue_knob=document.createElement("div"),i.__hue_knob.className="hue-knob",i.__hue_field=document.createElement("div"),i.__hue_field.className="hue-field",i.__input=document.createElement("input"),i.__input.type="text",i.__input_textShadow="0 1px 1px ",P.bind(i.__input,"keydown",(function(t){13===t.keyCode&&f.call(this)})),P.bind(i.__input,"blur",f),P.bind(i.__selector,"mousedown",(function(){P.addClass(this,"drag").bind(window,"mouseup",(function(){P.removeClass(r.__selector,"drag")}))})),P.bind(i.__selector,"touchstart",(function(){P.addClass(this,"drag").bind(window,"touchend",(function(){P.removeClass(r.__selector,"drag")}))}));var o,a=document.createElement("div");function l(t){y(t),P.bind(window,"mousemove",y),P.bind(window,"touchmove",y),P.bind(window,"mouseup",h),P.bind(window,"touchend",h)}function u(t){m(t),P.bind(window,"mousemove",m),P.bind(window,"touchmove",m),P.bind(window,"mouseup",p),P.bind(window,"touchend",p)}function h(){P.unbind(window,"mousemove",y),P.unbind(window,"touchmove",y),P.unbind(window,"mouseup",h),P.unbind(window,"touchend",h),g()}function p(){P.unbind(window,"mousemove",m),P.unbind(window,"touchmove",m),P.unbind(window,"mouseup",p),P.unbind(window,"touchend",p),g()}function f(){var t=c(this.value);!1!==t?(r.__color.__state=t,r.setValue(r.__color.toOriginal())):this.value=r.__color.toString()}function g(){r.__onFinishChange&&r.__onFinishChange.call(r,r.__color.toOriginal())}function y(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=r.__saturation_field.getBoundingClientRect(),n=t.touches&&t.touches[0]||t,i=n.clientX,o=n.clientY,s=(i-e.left)/(e.right-e.left),a=1-(o-e.top)/(e.bottom-e.top);return a>1?a=1:a<0&&(a=0),s>1?s=1:s<0&&(s=0),r.__color.v=a,r.__color.s=s,r.setValue(r.__color.toOriginal()),!1}function m(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=r.__hue_field.getBoundingClientRect(),n=1-((t.touches&&t.touches[0]||t).clientY-e.top)/(e.bottom-e.top);return n>1?n=1:n<0&&(n=0),r.__color.h=360*n,r.setValue(r.__color.toOriginal()),!1}return s.extend(i.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),s.extend(i.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:i.__field_knob_border+(i.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),s.extend(i.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),s.extend(i.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),s.extend(a.style,{width:"100%",height:"100%",background:"none"}),B(a,"top","rgba(0,0,0,0)","#000"),s.extend(i.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(o=i.__hue_field).style.background="",o.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",o.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.extend(i.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:i.__input_textShadow+"rgba(0,0,0,0.7)"}),P.bind(i.__saturation_field,"mousedown",l),P.bind(i.__saturation_field,"touchstart",l),P.bind(i.__field_knob,"mousedown",l),P.bind(i.__field_knob,"touchstart",l),P.bind(i.__hue_field,"mousedown",u),P.bind(i.__hue_field,"touchstart",u),i.__saturation_field.appendChild(a),i.__selector.appendChild(i.__field_knob),i.__selector.appendChild(i.__saturation_field),i.__selector.appendChild(i.__hue_field),i.__hue_field.appendChild(i.__hue_knob),i.domElement.appendChild(i.__input),i.domElement.appendChild(i.__selector),i.updateDisplay(),i}return m(e,t),g(e,[{key:"updateDisplay",value:function(){var t=c(this.getValue());if(!1!==t){var e=!1;s.each(v.COMPONENTS,(function(n){if(!s.isUndefined(t[n])&&!s.isUndefined(this.__color.__state[n])&&t[n]!==this.__color.__state[n])return e=!0,{}}),this),e&&s.extend(this.__color.__state,t)}s.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,i=255-n;s.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,B(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),s.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+i+","+i+","+i+",.7)"})}}]),e}(w),k=["-moz-","-o-","-webkit-","-ms-",""];function B(t,e,n,i){t.style.background="",s.each(k,(function(r){t.style.cssText+="background: "+r+"linear-gradient("+e+", "+n+" 0%, "+i+" 100%); "}))}var G=function(t,e){var n=e||document,i=document.createElement("style");i.type="text/css",i.innerHTML=t;var r=n.getElementsByTagName("head")[0];try{r.appendChild(i)}catch(t){}},j='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',z=function(t,e){var n=t[e];return s.isArray(arguments[2])||s.isObject(arguments[2])?new S(t,e,arguments[2]):s.isNumber(n)?s.isNumber(arguments[2])&&s.isNumber(arguments[3])?s.isNumber(arguments[4])?new A(t,e,arguments[2],arguments[3],arguments[4]):new A(t,e,arguments[2],arguments[3]):s.isNumber(arguments[4])?new O(t,e,{min:arguments[2],max:arguments[3],step:arguments[4]}):new O(t,e,{min:arguments[2],max:arguments[3]}):s.isString(n)?new T(t,e):s.isFunction(n)?new D(t,e,""):s.isBoolean(n)?new N(t,e):null};var U=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)},q=function(){function t(){d(this,t),this.backgroundElement=document.createElement("div"),s.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),P.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),s.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;P.bind(this.backgroundElement,"click",(function(){e.hide()}))}return g(t,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),s.defer((function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var t=this,e=function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",P.unbind(t.domElement,"webkitTransitionEnd",e),P.unbind(t.domElement,"transitionend",e),P.unbind(t.domElement,"oTransitionEnd",e)};P.bind(this.domElement,"webkitTransitionEnd",e),P.bind(this.domElement,"transitionend",e),P.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-P.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-P.getHeight(this.domElement)/2+"px"}}]),t}();G(function(t){if(t&&"undefined"!=typeof window){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t,document.head.appendChild(e),t}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var V=function(){try{return!!window.localStorage}catch(t){return!1}}(),H=void 0,Y=!0,X=void 0,W=!1,K=[],Z=function t(e){var n=this,i=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),P.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=s.defaults(i,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),i=s.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),s.isUndefined(i.load)?i.load={preset:"Default"}:i.preset&&(i.load.preset=i.preset),s.isUndefined(i.parent)&&i.hideable&&K.push(this),i.resizable=s.isUndefined(i.parent)&&i.resizable,i.autoPlace&&s.isUndefined(i.scrollable)&&(i.scrollable=!0);var r,o=V&&"true"===localStorage.getItem(nt(this,"isLocal")),a=void 0,l=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},closeOnTop:{get:function(){return i.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:i.load.preset},set:function(t){n.parent?n.getRoot().preset=t:i.load.preset=t,function(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}(this),n.revert()}},width:{get:function(){return i.width},set:function(t){i.width=t,at(n,t)}},name:{get:function(){return i.name},set:function(t){i.name=t,l&&(l.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(e){i.closed=e,i.closed?P.addClass(n.__ul,t.CLASS_CLOSED):P.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return o},set:function(t){V&&(o=t,t?P.bind(window,"unload",a):P.unbind(window,"unload",a),localStorage.setItem(nt(n,"isLocal"),t))}}}),s.isUndefined(i.parent)){if(this.closed=i.closed||!1,P.addClass(this.domElement,t.CLASS_MAIN),P.makeSelectable(this.domElement,!1),V&&o){n.useLocalStorage=!0;var u=localStorage.getItem(nt(this,"gui"));u&&(i.load=JSON.parse(u))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,P.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),i.closeOnTop?(P.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(P.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),P.bind(this.__closeButton,"click",(function(){n.closed=!n.closed}))}else{void 0===i.closed&&(i.closed=!0);var c=document.createTextNode(i.name);P.addClass(c,"controller-name"),l=J(n,c);P.addClass(this.__ul,t.CLASS_CLOSED),P.addClass(l,"title"),P.bind(l,"click",(function(t){return t.preventDefault(),n.closed=!n.closed,!1})),i.closed||(this.closed=!1)}i.autoPlace&&(s.isUndefined(i.parent)&&(Y&&(X=document.createElement("div"),P.addClass(X,"dg"),P.addClass(X,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(X),Y=!1),X.appendChild(this.domElement),P.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||at(n,i.width)),this.__resizeHandler=function(){n.onResizeDebounced()},P.bind(window,"resize",this.__resizeHandler),P.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),P.bind(this.__ul,"transitionend",this.__resizeHandler),P.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&st(this),a=function(){V&&"true"===localStorage.getItem(nt(n,"isLocal"))&&localStorage.setItem(nt(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=a,i.parent||((r=n.getRoot()).width+=1,s.defer((function(){r.width-=1})))};function J(t,e,n){var i=document.createElement("li");return e&&i.appendChild(e),n?t.__ul.insertBefore(i,n):t.__ul.appendChild(i),t.onResize(),i}function Q(t){P.unbind(window,"resize",t.__resizeHandler),t.saveToLocalStorageIfPossible&&P.unbind(window,"unload",t.saveToLocalStorageIfPossible)}function $(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];n.innerHTML=e?n.value+"*":n.value}function tt(t,e){var n=t.getRoot(),i=n.__rememberedObjects.indexOf(e.object);if(-1!==i){var r=n.__rememberedObjectIndecesToControllers[i];if(void 0===r&&(r={},n.__rememberedObjectIndecesToControllers[i]=r),r[e.property]=e,n.load&&n.load.remembered){var o=n.load.remembered,s=void 0;if(o[t.preset])s=o[t.preset];else{if(!o.Default)return;s=o.Default}if(s[i]&&void 0!==s[i][e.property]){var a=s[i][e.property];e.initialValue=a,e.setValue(a)}}}}function et(t,e,n,i){if(void 0===e[n])throw new Error('Object "'+e+'" has no property "'+n+'"');var r=void 0;if(i.color)r=new F(e,n);else{var o=[e,n].concat(i.factoryArgs);r=z.apply(t,o)}i.before instanceof w&&(i.before=i.before.__li),tt(t,r),P.addClass(r.domElement,"c");var a=document.createElement("span");P.addClass(a,"property-name"),a.innerHTML=r.property;var l=document.createElement("div");l.appendChild(a),l.appendChild(r.domElement);var u=J(t,l,i.before);return P.addClass(u,Z.CLASS_CONTROLLER_ROW),r instanceof F?P.addClass(u,"color"):P.addClass(u,f(r.getValue())),function(t,e,n){if(n.__li=e,n.__gui=t,s.extend(n,{options:function(e){if(arguments.length>1){var i=n.__li.nextElementSibling;return n.remove(),et(t,n.object,n.property,{before:i,factoryArgs:[s.toArray(arguments)]})}if(s.isArray(e)||s.isObject(e)){var r=n.__li.nextElementSibling;return n.remove(),et(t,n.object,n.property,{before:r,factoryArgs:[e]})}},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof A){var i=new O(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});s.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(t){var e=n[t],r=i[t];n[t]=i[t]=function(){var t=Array.prototype.slice.call(arguments);return r.apply(i,t),e.apply(n,t)}})),P.addClass(e,"has-slider"),n.domElement.insertBefore(i.domElement,n.domElement.firstElementChild)}else if(n instanceof O){var r=function(e){if(s.isNumber(n.__min)&&s.isNumber(n.__max)){var i=n.__li.firstElementChild.firstElementChild.innerHTML,r=n.__gui.__listening.indexOf(n)>-1;n.remove();var o=et(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return o.name(i),r&&o.listen(),o}return e};n.min=s.compose(r,n.min),n.max=s.compose(r,n.max)}else n instanceof N?(P.bind(e,"click",(function(){P.fakeEvent(n.__checkbox,"click")})),P.bind(n.__checkbox,"click",(function(t){t.stopPropagation()}))):n instanceof D?(P.bind(e,"click",(function(){P.fakeEvent(n.__button,"click")})),P.bind(e,"mouseover",(function(){P.addClass(n.__button,"hover")})),P.bind(e,"mouseout",(function(){P.removeClass(n.__button,"hover")}))):n instanceof F&&(P.addClass(e,"color"),n.updateDisplay=s.compose((function(t){return e.style.borderLeftColor=n.__color.toString(),t}),n.updateDisplay),n.updateDisplay());n.setValue=s.compose((function(e){return t.getRoot().__preset_select&&n.isModified()&&$(t.getRoot(),!0),e}),n.setValue)}(t,u,r),t.__controllers.push(r),r}function nt(t,e){return document.location.href+"."+e}function it(t,e,n){var i=document.createElement("option");i.innerHTML=e,i.value=e,t.__preset_select.appendChild(i),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function rt(t,e){e.style.display=t.useLocalStorage?"block":"none"}function ot(t){var e=t.__save_row=document.createElement("li");P.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),P.addClass(e,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",P.addClass(n,"button gears");var i=document.createElement("span");i.innerHTML="Save",P.addClass(i,"button"),P.addClass(i,"save");var r=document.createElement("span");r.innerHTML="New",P.addClass(r,"button"),P.addClass(r,"save-as");var o=document.createElement("span");o.innerHTML="Revert",P.addClass(o,"button"),P.addClass(o,"revert");var a=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?s.each(t.load.remembered,(function(e,n){it(t,n,n===t.preset)})):it(t,"Default",!1),P.bind(a,"change",(function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value})),e.appendChild(a),e.appendChild(n),e.appendChild(i),e.appendChild(r),e.appendChild(o),V){var l=document.getElementById("dg-local-explain"),u=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(nt(0,"isLocal"))&&u.setAttribute("checked","checked"),rt(t,l),P.bind(u,"change",(function(){t.useLocalStorage=!t.useLocalStorage,rt(t,l)}))}var c=document.getElementById("dg-new-constructor");P.bind(c,"keydown",(function(t){!t.metaKey||67!==t.which&&67!==t.keyCode||H.hide()})),P.bind(n,"click",(function(){c.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),H.show(),c.focus(),c.select()})),P.bind(i,"click",(function(){t.save()})),P.bind(r,"click",(function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)})),P.bind(o,"click",(function(){t.revert()}))}function st(t){var e=void 0;function n(n){return n.preventDefault(),t.width+=e-n.clientX,t.onResize(),e=n.clientX,!1}function i(){P.removeClass(t.__closeButton,Z.CLASS_DRAG),P.unbind(window,"mousemove",n),P.unbind(window,"mouseup",i)}function r(r){return r.preventDefault(),e=r.clientX,P.addClass(t.__closeButton,Z.CLASS_DRAG),P.bind(window,"mousemove",n),P.bind(window,"mouseup",i),!1}t.__resize_handle=document.createElement("div"),s.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),P.bind(t.__resize_handle,"mousedown",r),P.bind(t.__closeButton,"mousedown",r),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function at(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function lt(t,e){var n={};return s.each(t.__rememberedObjects,(function(i,r){var o={},a=t.__rememberedObjectIndecesToControllers[r];s.each(a,(function(t,n){o[n]=e?t.initialValue:t.getValue()})),n[r]=o})),n}Z.toggleHide=function(){W=!W,s.each(K,(function(t){t.domElement.style.display=W?"none":""}))},Z.CLASS_AUTO_PLACE="a",Z.CLASS_AUTO_PLACE_CONTAINER="ac",Z.CLASS_MAIN="main",Z.CLASS_CONTROLLER_ROW="cr",Z.CLASS_TOO_TALL="taller-than-window",Z.CLASS_CLOSED="closed",Z.CLASS_CLOSE_BUTTON="close-button",Z.CLASS_CLOSE_TOP="close-top",Z.CLASS_CLOSE_BOTTOM="close-bottom",Z.CLASS_DRAG="drag",Z.DEFAULT_WIDTH=245,Z.TEXT_CLOSED="Close Controls",Z.TEXT_OPEN="Open Controls",Z._keydownHandler=function(t){"text"===document.activeElement.type||72!==t.which&&72!==t.keyCode||Z.toggleHide()},P.bind(window,"keydown",Z._keydownHandler,!1),s.extend(Z.prototype,{add:function(t,e){return et(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return et(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;s.defer((function(){e.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&X.removeChild(this.domElement);var t=this;s.each(this.__folders,(function(e){t.removeFolder(e)})),P.unbind(window,"keydown",Z._keydownHandler,!1),Q(this)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new Z(e);this.__folders[t]=n;var i=J(this,n.domElement);return P.addClass(i,"folder"),n},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],Q(t);var e=this;s.each(t.__folders,(function(e){t.removeFolder(e)})),s.defer((function(){e.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=P.getOffset(t.__ul).top,n=0;s.each(t.__ul.childNodes,(function(e){t.autoPlace&&e===t.__save_row||(n+=P.getHeight(e))})),window.innerHeight-e-20<n?(P.addClass(t.domElement,Z.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):(P.removeClass(t.domElement,Z.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&s.defer((function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"})),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},onResizeDebounced:s.debounce((function(){this.onResize()}),50),remember:function(){if(s.isUndefined(H)&&((H=new q).domElement.innerHTML=j),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;s.each(Array.prototype.slice.call(arguments),(function(e){0===t.__rememberedObjects.length&&ot(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)})),this.autoPlace&&at(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=lt(this)),t.folders={},s.each(this.__folders,(function(e,n){t.folders[n]=e.getSaveObject()})),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=lt(this),$(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=lt(this,!0)),this.load.remembered[t]=lt(this),this.preset=t,it(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){s.each(this.__controllers,(function(e){this.getRoot().load.remembered?tt(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())}),this),s.each(this.__folders,(function(t){t.revert(t)})),t||$(this.getRoot(),!1)},listen:function(t){var e=0===this.__listening.length;this.__listening.push(t),e&&function t(e){0!==e.length&&U.call(window,(function(){t(e)}));s.each(e,(function(t){t.updateDisplay()}))}(this.__listening)},updateDisplay:function(){s.each(this.__controllers,(function(t){t.updateDisplay()})),s.each(this.__folders,(function(t){t.updateDisplay()}))}});var ut={Color:v,math:p,interpret:c},ct={Controller:w,BooleanController:N,OptionController:S,StringController:T,NumberController:M,NumberControllerBox:O,NumberControllerSlider:A,FunctionController:D,ColorController:F},ht={dom:P},pt={GUI:Z},ft=Z,dt={color:ut,controllers:ct,dom:ht,gui:pt,GUI:ft};e.default=dt},function(t,e,n){!function(t){"use strict";function e(t){return t&&t.normalize&&t.normalize(),t&&t.textContent||""}function n(t,e){const n=t.getElementsByTagName(e);return n.length?n[0]:null}function i(t){const i={};if(t){const r=n(t,"line");if(r){const t=e(n(r,"color")),o=parseFloat(e(n(r,"opacity"))),s=parseFloat(e(n(r,"width")));t&&(i.stroke=t),isNaN(o)||(i["stroke-opacity"]=o),isNaN(s)||(i["stroke-width"]=96*s/25.4)}}return i}function r(t){let n=[];if(null!==t)for(let i=0;i<t.childNodes.length;i++){const o=t.childNodes[i];if(1!==o.nodeType)continue;const s=["heart","gpxtpx:hr","hr"].includes(o.nodeName)?"heart":o.nodeName;if("gpxtpx:TrackPointExtension"===s)n=n.concat(r(o));else{const t=e(o);n.push([s,isNaN(t)?t:parseFloat(t)])}}return n}function o(t,i){const r={};let o,s;for(s=0;s<i.length;s++)o=n(t,i[s]),o&&(r[i[s]]=e(o));return r}function s(t){const n=o(t,["name","cmt","desc","type","time","keywords"]),i=t.getElementsByTagNameNS("http://www.garmin.com/xmlschemas/GpxExtensions/v3","*");for(let r=0;r<i.length;r++){const o=i[r];o.parentNode.parentNode===t&&(n[o.tagName.replace(":","_")]=e(o))}const r=t.getElementsByTagName("link");r.length&&(n.links=[]);for(let t=0;t<r.length;t++)n.links.push(Object.assign({href:r[t].getAttribute("href")},o(r[t],["text","type"])));return n}function a(t){const i=[parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))],o=n(t,"ele"),s=n(t,"time");if(o){const t=parseFloat(e(o));isNaN(t)||i.push(t)}return{coordinates:i,time:s?e(s):null,extendedValues:r(n(t,"extensions"))}}function l(t){const e=u(t,"rtept");if(e)return{type:"Feature",properties:Object.assign(s(t),i(n(t,"extensions")),{_gpxType:"rte"}),geometry:{type:"LineString",coordinates:e.line}}}function u(t,e){const n=t.getElementsByTagName(e);if(n.length<2)return;const i=[],r=[],o={};for(let t=0;t<n.length;t++){const e=a(n[t]);i.push(e.coordinates),e.time&&r.push(e.time);for(let i=0;i<e.extendedValues.length;i++){const[r,s]=e.extendedValues[i],a="heart"===r?r:r.replace("gpxtpx:","")+"s";o[a]||(o[a]=Array(n.length).fill(null)),o[a][t]=s}}return{line:i,times:r,extendedValues:o}}function c(t){const e=t.getElementsByTagName("trkseg"),r=[],o=[],a=[];for(let t=0;t<e.length;t++){const n=u(e[t],"trkpt");n&&(a.push(n),n.times&&n.times.length&&o.push(n.times))}if(0===a.length)return;const l=a.length>1,c=Object.assign(s(t),i(n(t,"extensions")),{_gpxType:"trk"},o.length?{coordinateProperties:{times:l?o:o[0]}}:{});for(let t=0;t<a.length;t++){const e=a[t];r.push(e.line);for(const[n,i]of Object.entries(e.extendedValues)){c.coordinateProperties||(c.coordinateProperties={});const e=c.coordinateProperties;l?(e[n]||(e[n]=a.map(t=>new Array(t.line.length).fill(null))),e[n][t]=i):e[n]=i}}return{type:"Feature",properties:c,geometry:l?{type:"MultiLineString",coordinates:r}:{type:"LineString",coordinates:r[0]}}}function*h(t){const e=t.getElementsByTagName("trk"),n=t.getElementsByTagName("rte"),i=t.getElementsByTagName("wpt");for(let t=0;t<e.length;t++){const n=c(e[t]);n&&(yield n)}for(let t=0;t<n.length;t++){const e=l(n[t]);e&&(yield e)}for(let t=0;t<i.length;t++)yield(r=i[t],{type:"Feature",properties:Object.assign(s(r),o(r,["sym"])),geometry:{type:"Point",coordinates:a(r).coordinates}});var r}const p=[["heartRate","heartRates"],["Cadence","cadences"],["Speed","speeds"],["Watts","watts"]],f=[["TotalTimeSeconds","totalTimeSeconds"],["DistanceMeters","distanceMeters"],["MaximumSpeed","maxSpeed"],["AverageHeartRateBpm","avgHeartRate"],["MaximumHeartRateBpm","maxHeartRate"],["AvgSpeed","avgSpeed"],["AvgWatts","avgWatts"],["MaxWatts","maxWatts"]];function d(t,i){const r=[];for(const[o,s]of i){let i=n(t,o);if(!i){const e=t.getElementsByTagNameNS("http://www.garmin.com/xmlschemas/ActivityExtension/v2",o);e.length&&(i=e[0])}const a=parseFloat(e(i));isNaN(a)||r.push([s,a])}return r}function g(t){const i=e(n(t,"LongitudeDegrees")),r=e(n(t,"LatitudeDegrees"));if(!i.length||!r.length)return null;const o=[parseFloat(i),parseFloat(r)],s=n(t,"AltitudeMeters"),a=n(t,"HeartRateBpm"),l=n(t,"Time");let u;return s&&(u=parseFloat(e(s)),isNaN(u)||o.push(u)),{coordinates:o,time:l?e(l):null,heartRate:a?parseFloat(e(a)):null,extensions:d(t,p)}}function y(t,e){const n=t.getElementsByTagName(e),i=[],r=[],o=[];if(n.length<2)return null;const s={extendedProperties:{}};for(let t=0;t<n.length;t++){const e=g(n[t]);if(null!==e){i.push(e.coordinates),e.time&&r.push(e.time),e.heartRate&&o.push(e.heartRate);for(const[i,r]of e.extensions)s.extendedProperties[i]||(s.extendedProperties[i]=Array(n.length).fill(null)),s.extendedProperties[i][t]=r}}return Object.assign(s,{line:i,times:r,heartRates:o})}function m(t){const i=t.getElementsByTagName("Track"),r=[],o=[],s=[],a=[];let l;const u=function(t){const e={};for(const[n,i]of t)e[n]=i;return e}(d(t,f)),c=n(t,"Name");c&&(u.name=e(c));for(let t=0;t<i.length;t++)l=y(i[t],"Trackpoint"),l&&(r.push(l.line),l.times.length&&o.push(l.times),l.heartRates.length&&s.push(l.heartRates),a.push(l.extendedProperties));for(let t=0;t<a.length;t++){const e=a[t];for(const n in e)1===i.length?u[n]=l.extendedProperties[n]:(u[n]||(u[n]=r.map(t=>Array(t.length).fill(null))),u[n][t]=e[n])}if(0!==r.length)return(o.length||s.length)&&(u.coordinateProperties=Object.assign(o.length?{times:1===r.length?o[0]:o}:{},s.length?{heart:1===r.length?s[0]:s}:{})),{type:"Feature",properties:u,geometry:{type:1===r.length?"LineString":"MultiLineString",coordinates:1===r.length?r[0]:r}}}function*_(t){const e=t.getElementsByTagName("Lap");for(let t=0;t<e.length;t++){const n=m(e[t]);n&&(yield n)}const n=t.getElementsByTagName("Courses");for(let t=0;t<n.length;t++){const e=m(n[t]);e&&(yield e)}}const v=/\s*/g,x=/^\s*|\s*$/g,C=/\s+/;function w(t){if(!t||!t.length)return 0;let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n)|0;return e}function b(t){return t.replace(v,"").split(",").map(parseFloat)}function E(t){return t.replace(x,"").split(C).map(b)}function I(t){if(void 0!==t.xml)return t.xml;if(t.tagName){let e=t.tagName;for(let n=0;n<t.attributes.length;n++)e+=t.attributes[n].name+t.attributes[n].value;for(let n=0;n<t.childNodes.length;n++)e+=I(t.childNodes[n]);return e}return"#text"===t.nodeName?(t.nodeValue||t.value||"").trim():"#cdata-section"===t.nodeName?t.nodeValue:""}const P=["Polygon","LineString","Point","Track","gx:Track"];function N(t,i,r){let o=e(n(i,"color"))||"";const s="stroke"==r||"fill"===r?r:r+"-color";"#"===o.substr(0,1)&&(o=o.substr(1)),6===o.length||3===o.length?t[s]=o:8===o.length&&(t[r+"-opacity"]=parseInt(o.substr(0,2),16)/255,t[s]="#"+o.substr(6,2)+o.substr(4,2)+o.substr(2,2))}function S(t,i,r,o){const s=parseFloat(e(n(i,r)));isNaN(s)||(t[o]=s)}function T(t){let n=t.getElementsByTagName("coord");const i=[],r=[];0===n.length&&(n=t.getElementsByTagName("gx:coord"));for(let t=0;t<n.length;t++)i.push(e(n[t]).split(" ").map(parseFloat));const o=t.getElementsByTagName("when");for(let t=0;t<o.length;t++)r.push(e(o[t]));return{coords:i,times:r}}function L(t,i,r,o){const s=function t(i){let r,o,s,a,l;const u=[],c=[];if(n(i,"MultiGeometry"))return t(n(i,"MultiGeometry"));if(n(i,"MultiTrack"))return t(n(i,"MultiTrack"));if(n(i,"gx:MultiTrack"))return t(n(i,"gx:MultiTrack"));for(s=0;s<P.length;s++)if(o=i.getElementsByTagName(P[s]),o)for(a=0;a<o.length;a++)if(r=o[a],"Point"===P[s])u.push({type:"Point",coordinates:b(e(n(r,"coordinates")))});else if("LineString"===P[s])u.push({type:"LineString",coordinates:E(e(n(r,"coordinates")))});else if("Polygon"===P[s]){const t=r.getElementsByTagName("LinearRing"),i=[];for(l=0;l<t.length;l++)i.push(E(e(n(t[l],"coordinates"))));u.push({type:"Polygon",coordinates:i})}else if("Track"===P[s]||"gx:Track"===P[s]){const t=T(r);u.push({type:"LineString",coordinates:t.coords}),t.times.length&&c.push(t.times)}return{geoms:u,coordTimes:c}}(t);let a;const l={},u=e(n(t,"name")),c=e(n(t,"address"));let h=e(n(t,"styleUrl"));const p=e(n(t,"description")),f=n(t,"TimeSpan"),d=n(t,"TimeStamp"),g=n(t,"ExtendedData");let y=n(t,"IconStyle"),m=n(t,"LabelStyle"),_=n(t,"LineStyle"),v=n(t,"PolyStyle");const x=n(t,"visibility");if(u&&(l.name=u),c&&(l.address=c),h){"#"!==h[0]&&(h="#"+h),l.styleUrl=h,i[h]&&(l.styleHash=i[h]),r[h]&&(l.styleMapHash=r[h],l.styleHash=i[r[h].normal]);const t=o[l.styleHash];t&&(y||(y=n(t,"IconStyle")),m||(m=n(t,"LabelStyle")),_||(_=n(t,"LineStyle")),v||(v=n(t,"PolyStyle")))}if(p&&(l.description=p),f){const t=e(n(f,"begin")),i=e(n(f,"end"));l.timespan={begin:t,end:i}}if(d&&(l.timestamp=e(n(d,"when"))),y){N(l,y,"icon"),S(l,y,"scale","icon-scale"),S(l,y,"heading","icon-heading");const t=n(y,"hotSpot");if(t){const e=parseFloat(t.getAttribute("x")),n=parseFloat(t.getAttribute("y"));isNaN(e)||isNaN(n)||(l["icon-offset"]=[e,n])}const i=n(y,"Icon");if(i){const t=e(n(i,"href"));t&&(l.icon=t)}}if(m&&(N(l,m,"label"),S(l,m,"scale","label-scale")),_&&(N(l,_,"stroke"),S(l,_,"width","stroke-width")),v){N(l,v,"fill");const t=e(n(v,"fill")),i=e(n(v,"outline"));t&&(l["fill-opacity"]="1"===t?l["fill-opacity"]||1:0),i&&(l["stroke-opacity"]="1"===i?l["stroke-opacity"]||1:0)}if(g){const t=g.getElementsByTagName("Data"),i=g.getElementsByTagName("SimpleData");for(a=0;a<t.length;a++)l[t[a].getAttribute("name")]=e(n(t[a],"value"));for(a=0;a<i.length;a++)l[i[a].getAttribute("name")]=e(i[a])}x&&(l.visibility=e(x)),s.coordTimes.length&&(l.coordinateProperties={times:1===s.coordTimes.length?s.coordTimes[0]:s.coordTimes});const C={type:"Feature",geometry:0===s.geoms.length?null:1===s.geoms.length?s.geoms[0]:{type:"GeometryCollection",geometries:s.geoms},properties:l};return t.getAttribute("id")&&(C.id=t.getAttribute("id")),C}function*M(t){const i={},r={},o={},s=t.getElementsByTagName("Placemark"),a=t.getElementsByTagName("Style"),l=t.getElementsByTagName("StyleMap");for(let t=0;t<a.length;t++){const e=a[t],n=w(I(e)).toString(16);let o=e.getAttribute("id");o||"CascadingStyle"!==e.parentNode.tagName.replace("gx:","")||(o=e.parentNode.getAttribute("kml:id")||e.parentNode.getAttribute("id")),i["#"+o]=n,r[n]=e}for(let t=0;t<l.length;t++){i["#"+l[t].getAttribute("id")]=w(I(l[t])).toString(16);const r=l[t].getElementsByTagName("Pair"),s={};for(let t=0;t<r.length;t++)s[e(n(r[t],"key"))]=e(n(r[t],"styleUrl"));o["#"+l[t].getAttribute("id")]=s}for(let t=0;t<s.length;t++){const e=L(s[t],i,o,r);e&&(yield e)}}t.gpx=function(t){return{type:"FeatureCollection",features:Array.from(h(t))}},t.gpxGen=h,t.kml=function(t){return{type:"FeatureCollection",features:Array.from(M(t))}},t.kmlGen=M,t.tcx=function(t){return{type:"FeatureCollection",features:Array.from(_(t))}},t.tcxGen=_,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){e.Types=n(23),e.Geometry=n(28),e.Point=n(29),e.LineString=n(75),e.Polygon=n(76),e.MultiPoint=n(105),e.MultiLineString=n(106),e.MultiPolygon=n(107),e.GeometryCollection=n(108)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],i=e[1];return 3*(n+i)/4-i},e.toByteArray=function(t){var e,n,i=u(t),s=i[0],a=i[1],l=new o(function(t,e,n){return 3*(e+n)/4-n}(0,s,a)),c=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],l[c++]=e>>16&255,l[c++]=e>>8&255,l[c++]=255&e;2===a&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,l[c++]=255&e);1===a&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,l[c++]=e>>8&255,l[c++]=255&e);return l},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,o=[],s=0,a=n-r;s<a;s+=16383)o.push(c(t,s,s+16383>a?a:s+16383));1===r?(e=t[n-1],o.push(i[e>>2]+i[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],o.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"="));return o.join("")};for(var i=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=s.length;a<l;++a)i[a]=s[a],r[s.charCodeAt(a)]=a;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,n){for(var r,o,s=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(i[(o=r)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,n,i,r){var o,s,a=8*r-i-1,l=(1<<a)-1,u=l>>1,c=-7,h=n?r-1:0,p=n?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-c)-1,f>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=p,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=i;c>0;s=256*s+t[e+h],h+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,i),o-=u}return(f?-1:1)*s*Math.pow(2,o-i)},e.write=function(t,e,n,i,r,o){var s,a,l,u=8*o-r-1,c=(1<<u)-1,h=c>>1,p=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:o-1,d=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*l-1)*Math.pow(2,r),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;t[n+f]=255&a,f+=d,a/=256,r-=8);for(s=s<<r|a,u+=r;u>0;t[n+f]=255&s,f+=d,s/=256,u-=8);t[n+f-d]|=128*g}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){(function(e){function n(t,e){this.buffer=t,this.position=0,this.isBigEndian=e||!1}function i(t,e,n){return function(){var i;return i=this.isBigEndian?e.call(this.buffer,this.position):t.call(this.buffer,this.position),this.position+=n,i}}t.exports=n,n.prototype.readUInt8=i(e.prototype.readUInt8,e.prototype.readUInt8,1),n.prototype.readUInt16=i(e.prototype.readUInt16LE,e.prototype.readUInt16BE,2),n.prototype.readUInt32=i(e.prototype.readUInt32LE,e.prototype.readUInt32BE,4),n.prototype.readInt8=i(e.prototype.readInt8,e.prototype.readInt8,1),n.prototype.readInt16=i(e.prototype.readInt16LE,e.prototype.readInt16BE,2),n.prototype.readInt32=i(e.prototype.readInt32LE,e.prototype.readInt32BE,4),n.prototype.readFloat=i(e.prototype.readFloatLE,e.prototype.readFloatBE,4),n.prototype.readDouble=i(e.prototype.readDoubleLE,e.prototype.readDoubleBE,8),n.prototype.readVarInt=function(){var t,e=0,n=0;do{e+=(127&(t=this.buffer[this.position+n]))<<7*n,n++}while(t>=128);return this.position+=n,e}}).call(this,n(74).Buffer)},function(t,e,n){t.exports=o;var i=n(23),r=n(29);function o(t){this.value=t,this.position=0}o.prototype.match=function(t){this.skipWhitespaces();for(var e=0;e<t.length;e++)if(0===this.value.substring(this.position).indexOf(t[e]))return this.position+=t[e].length,t[e];return null},o.prototype.matchRegex=function(t){this.skipWhitespaces();for(var e=0;e<t.length;e++){var n=this.value.substring(this.position).match(t[e]);if(n)return this.position+=n[0].length,n}return null},o.prototype.isMatch=function(t){this.skipWhitespaces();for(var e=0;e<t.length;e++)if(0===this.value.substring(this.position).indexOf(t[e]))return this.position+=t[e].length,!0;return!1},o.prototype.matchType=function(){var t=this.match([i.wkt.Point,i.wkt.LineString,i.wkt.Polygon,i.wkt.MultiPoint,i.wkt.MultiLineString,i.wkt.MultiPolygon,i.wkt.GeometryCollection]);if(!t)throw new Error("Expected geometry type");return t},o.prototype.matchDimension=function(){switch(this.match(["ZM","Z","M"])){case"ZM":return{hasZ:!0,hasM:!0};case"Z":return{hasZ:!0,hasM:!1};case"M":return{hasZ:!1,hasM:!0};default:return{hasZ:!1,hasM:!1}}},o.prototype.expectGroupStart=function(){if(!this.isMatch(["("]))throw new Error("Expected group start")},o.prototype.expectGroupEnd=function(){if(!this.isMatch([")"]))throw new Error("Expected group end")},o.prototype.matchCoordinate=function(t){var e;if(!(e=t.hasZ&&t.hasM?this.matchRegex([/^(\S*)\s+(\S*)\s+(\S*)\s+([^\s,)]*)/]):t.hasZ||t.hasM?this.matchRegex([/^(\S*)\s+(\S*)\s+([^\s,)]*)/]):this.matchRegex([/^(\S*)\s+([^\s,)]*)/])))throw new Error("Expected coordinates");return t.hasZ&&t.hasM?new r(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])):t.hasZ?new r(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])):t.hasM?new r(parseFloat(e[1]),parseFloat(e[2]),void 0,parseFloat(e[3])):new r(parseFloat(e[1]),parseFloat(e[2]))},o.prototype.matchCoordinates=function(t){var e=[];do{var n=this.isMatch(["("]);e.push(this.matchCoordinate(t)),n&&this.expectGroupEnd()}while(this.isMatch([","]));return e},o.prototype.skipWhitespaces=function(){for(;this.position<this.value.length&&" "===this.value[this.position];)this.position++}},function(t,e,n){n(195),t.exports=-9007199254740991},function(t,e,n){var i=n(11);i(i.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){t.exports={default:n(197),__esModule:!0}},function(t,e,n){n(46),n(44),t.exports=n(198)},function(t,e,n){var i=n(64),r=n(14)("iterator"),o=n(39);t.exports=n(9).isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||o.hasOwnProperty(i(e))}},function(t,e,n){var i=n(9),r=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return r.stringify.apply(r,arguments)}},function(t,e,n){n(201),t.exports=n(9).Object.keys},function(t,e,n){var i=n(38),r=n(41);n(109)("keys",(function(){return function(t){return r(i(t))}}))},function(t,e,n){n(203);var i=n(9).Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}},function(t,e,n){var i=n(11);i(i.S+i.F*!n(20),"Object",{defineProperty:n(18).f})},function(t,e,n){n(205),t.exports=9007199254740991},function(t,e,n){var i=n(11);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e){void 0!==Array.prototype.flat&&0!==(Array.prototype.flat.name+"").indexOf("_")||(Array.prototype.flat=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!Number(t)||Number(t)<0)return this;var e=[];return this.forEach((function(n){Array.isArray(n)?e=e.concat(n.flat(--t)):e.push(n)})),e}),void 0===Array.prototype.flatMap&&(Array.prototype.flatMap=function(t){return this.flat().map(t)})},function(t,e,n){var i=function(){return this}()||Function("return this")(),r=i.regeneratorRuntime&&Object.getOwnPropertyNames(i).indexOf("regeneratorRuntime")>=0,o=r&&i.regeneratorRuntime;if(i.regeneratorRuntime=void 0,t.exports=n(208),r)i.regeneratorRuntime=o;else try{delete i.regeneratorRuntime}catch(t){i.regeneratorRuntime=void 0}},function(t,e){!function(e){"use strict";var n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag",l="object"==typeof t,u=e.regeneratorRuntime;if(u)l&&(t.exports=u);else{(u=e.regeneratorRuntime=l?t.exports:{}).wrap=g;var c={},h={};h[o]=function(){return this};var p=Object.getPrototypeOf,f=p&&p(p(P([])));f&&f!==n&&i.call(f,o)&&(h=f);var d=v.prototype=m.prototype=Object.create(h);_.prototype=d.constructor=v,v.constructor=_,v[a]=_.displayName="GeneratorFunction",u.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},u.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(d),t},u.awrap=function(t){return{__await:t}},x(C.prototype),C.prototype[s]=function(){return this},u.AsyncIterator=C,u.async=function(t,e,n,i){var r=new C(g(t,e,n,i));return u.isGeneratorFunction(e)?r:r.next().then((function(t){return t.done?t.value:r.next()}))},x(d),d[a]="Generator",d[o]=function(){return this},d.toString=function(){return"[object Generator]"},u.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},u.values=P,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return s.type="throw",s.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;E(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:P(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}}}function g(t,e,n,i){var r=e&&e.prototype instanceof m?e:m,o=Object.create(r.prototype),s=new I(i||[]);return o._invoke=function(t,e,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return N()}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===c)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=y(t,e,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(t,n,s),o}function y(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function m(){}function _(){}function v(){}function x(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function C(t){var e;this._invoke=function(n,r){function o(){return new Promise((function(e,o){!function e(n,r,o,s){var a=y(t[n],t,r);if("throw"!==a.type){var l=a.arg,u=l.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then((function(t){e("next",t,o,s)}),(function(t){e("throw",t,o,s)})):Promise.resolve(u).then((function(t){l.value=t,o(l)}),s)}s(a.arg)}(n,r,e,o)}))}return e=e?e.then(o,o):o()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var i=y(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,c;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function P(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(i.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:N}}function N(){return{value:void 0,done:!0}}}(function(){return this}()||Function("return this")())},function(t,e,n){n(210),t.exports=n(9).Object.freeze},function(t,e,n){var i=n(15),r=n(47).onFreeze;n(109)("freeze",(function(t){return function(e){return t&&i(e)?t(r(e)):e}}))},function(t,e,n){"use strict";n.r(e),n.d(e,"noConflict",(function(){return ch}));var i=n(4),r=n.n(i),o=n(2),s=n.n(o),a=n(3),l=n.n(a),u=n(0);u.a.Object=function(t){var e=t||u.a.Util.guid();Object.defineProperty(this,"id",{get:function(){return e},enumerable:!0})},u.a.Object.prototype.type="Object";u.a.Object;var c=n(1),h=n.n(c);u.a.EventManager=function(){},u.a.EventManager.prototype.on=function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;t.split(" ").forEach((function(t){void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}))},u.a.EventManager.prototype.off=function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var i=n.indexOf(e);-1!==i&&n.splice(i,1)}}},u.a.EventManager.prototype.emit=function(t){var e=this;if(void 0!==this._listeners){var n=this._listeners[t.type];if(void 0!==n)t.target=this,n.slice(0).forEach((function(n){if(n)try{n.call(e,t)}catch(t){throw console.error("事件回调执行异常！"),t}}))}};var p=u.a.EventManager,f=n(22),d=n(10),g=n.n(d),y=n(6),m=n.n(y),_=180/Math.PI,v=Math.PI/180,x=function(){return"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".replace(/x/g,(function(t){return(16*Math.random()|0).toString(16)}))},C=function(t,e,n){var i;return t?void 0===(i=t[e])?n:i:n},w=function(t,e,n){if(!t)return null;for(var i=0,r=t.length;i<r;i++)if(t[i][e]==n)return t[i];return null},b=function(t,e){var n=null;return function(){var i=arguments;n&&clearTimeout(n),n=setTimeout((function(){t.apply(null,i)}),e)}},E=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=!0,r=!1,o=void 0;try{for(var s,a=m()(e);!(i=(s=a.next()).done);i=!0){var l=s.value;if(l instanceof Sf3d)return l;if("object"===(void 0===l?"undefined":g()(l))){var u=null;for(var c in l)if((u=l[c])instanceof Sf3d)return u}}}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return null},I=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=!0,r=!1,o=void 0;try{for(var s,a=m()(e);!(i=(s=a.next()).done);i=!0){var l=s.value;if(l instanceof XE.Earth)return l;if("object"===(void 0===l?"undefined":g()(l))){var u=null;for(var c in l)if((u=l[c])instanceof XE.Earth)return u}}}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return null},P=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=!0,r=!1,o=void 0;try{for(var s,a=m()(e);!(i=(s=a.next()).done);i=!0){var l=s.value;if(l instanceof Cesium.Viewer)return l;if(l instanceof XE.Earth)return l.czm.viewer;if("object"===(void 0===l?"undefined":g()(l))){var u=null;for(var c in l){if((u=l[c])instanceof Cesium.Viewer)return u;if(u instanceof XE.Earth)return u.czm.viewer}}}}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return null},N=new Cesium.Cartographic,S=(new Cesium.Cartographic,function(){var t=window._cesium,e=t.camera;return Math.tan(e.frustum.fovy/2)*e.positionCartographic.height*2/t.canvas.height}),T=function(t){return t.map((function(t){return t*_}))},L=function(t){return t.map((function(t){return t*v}))},M=function(t){return[t[0]*_,t[1]*_,t[2]]},O=function(t){return[t[0]*v,t[1]*v,t[2]]},R=new Cesium.Cartesian3,A=new Cesium.Cartesian3,D=function(t,e,n,i,r,o){return Cesium.Cartesian3.fromDegrees(t,e,n,null,R),Cesium.Cartesian3.fromDegrees(i,r,o,null,A),Cesium.Cartesian3.distance(R,A)},F=(new Cesium.Cartographic,new Cesium.Cartographic,new Cesium.EllipsoidGeodesic,function(t){if(t&&!(t.length<2))return!1===function(t){if(t&&!(t.length<2)){var e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]}}(t)&&t.push([t[0][0],t[0][1]]),t});u.a.Camera=function(t,e){var n=this;this.config={fov:{name:"视角",default:Math.PI/3,type:u.a.PropertyType.Float,range:[0,Math.PI]},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},orth:{name:"正交",default:!1,type:u.a.PropertyType.Boolean},near:{name:"近平面",default:.1,type:u.a.PropertyType.Float},far:{name:"远平面",default:1e10,type:u.a.PropertyType.Float},heading:{name:"航向角",default:_cesium.camera.heading,type:u.a.PropertyType.Float,noConfig:!0},pitch:{name:"俯仰角",default:_cesium.camera.pitch,type:u.a.PropertyType.Float,noConfig:!0},roll:{name:"翻滚角",default:_cesium.camera.roll,type:u.a.PropertyType.Float,noConfig:!0},minHeight:{name:"最小高度",default:0,type:u.a.PropertyType.Float},maxHeight:{name:"最大高度",default:1e10,type:u.a.PropertyType.Float}},t.on("onEachFrame",(function(){f.a.update()})),_cesium.camera.moveStart.addEventListener((function(t){n.emit({type:"onCameraMoveStart",data:t})})),_cesium.camera.moveEnd.addEventListener((function(t){n.emit({type:"onCameraMoveEnd",data:t})})),_cesium.camera.changed.addEventListener((function(t){n.emit({type:"onCameraChange",data:t})}));var i=e.position instanceof u.a.Point3d?e.position:(new u.a.Point3d).fromCartesian(_cesium.camera.position);Object.defineProperty(this,"position",{get:function(){return(new u.a.Point3d).fromCartesian(_cesium.camera.position)},set:function(t){t instanceof u.a.Point3d&&(i=t,_cesium.camera.position=i.exportCartesian())},enumerable:!0});var r=isNaN(e.fov)?this.config.fov.default:e.fov;Object.defineProperty(this,"fov",{get:function(){return r},set:function(t){isNaN(t)||(r=t,_cesium.camera.frustum.fov=r)},enumerable:!0});var o=isNaN(e.orth)?this.config.orth.default:e.orth;Object.defineProperty(this,"orth",{get:function(){return o},set:function(t){(o=!!t)?_cesium.camera.switchToOrthographicFrustum():_cesium.camera.switchToPerspectiveFrustum()},enumerable:!0});var s=isNaN(e.near)?this.config.near.default:e.near;Object.defineProperty(this,"near",{get:function(){return s},set:function(t){isNaN(t)||(s=t,_cesium.camera.frustum.near=s)},enumerable:!0});var a=isNaN(e.minHeight)?this.config.minHeight.default:e.minHeight;Object.defineProperty(this,"minHeight",{get:function(){return a},set:function(t){isNaN(t)||(a=t,_cesium.scene.screenSpaceCameraController.minimumZoomDistance=a)},enumerable:!0});var c=isNaN(e.maxHeight)?this.config.maxHeight.default:e.maxHeight;Object.defineProperty(this,"maxHeight",{get:function(){return c},set:function(t){isNaN(t)||(c=t,_cesium.scene.screenSpaceCameraController.maximumZoomDistance=c)},enumerable:!0});var p=isNaN(e.far)?this.config.far.default:e.far;Object.defineProperty(this,"far",{get:function(){return p},set:function(t){isNaN(t)||(p=t,_cesium.camera.frustum.far=p)},enumerable:!0});var d=isNaN(e.heading)?this.config.heading.default:e.heading;Object.defineProperty(this,"heading",{get:function(){return 180*_cesium.camera.heading/Math.PI},set:function(t){isNaN(t)||(d=t,_cesium.camera.setView({orientation:{heading:Cesium.Math.toRadians(d),pitch:Cesium.Math.toRadians(n.pitch),roll:Cesium.Math.toRadians(n.roll)}}))},enumerable:!0});var g=isNaN(e.pitch)?this.config.pitch.default:e.pitch;Object.defineProperty(this,"pitch",{get:function(){return 180*_cesium.camera.pitch/Math.PI},set:function(t){isNaN(t)||(g=t,_cesium.camera.setView({orientation:{heading:Cesium.Math.toRadians(n.heading),pitch:Cesium.Math.toRadians(g),roll:Cesium.Math.toRadians(n.roll)}}))},enumerable:!0});var y=isNaN(e.far)?this.config.roll.default:e.roll;Object.defineProperty(this,"roll",{get:function(){return 180*_cesium.camera.roll/Math.PI},set:function(t){isNaN(t)||(y=t,_cesium.camera.setView({orientation:{heading:Cesium.Math.toRadians(n.heading),pitch:Cesium.Math.toRadians(n.pitch),roll:Cesium.Math.toRadians(y)}}))},enumerable:!0});var m=!1,_=t.viewer,v=void 0;Object.defineProperty(this,"fixPosition",{get:function(){return m},set:function(t){if(!!t!=m){var e=m=!!t;_.scene.screenSpaceCameraController.enableTranslate=!e,_.scene.screenSpaceCameraController.enableRotate=!e,_.scene.screenSpaceCameraController.enableTilt=!e,_.scene.screenSpaceCameraController.enableZoom=!e,void 0===v&&(v=_.scene.screenSpaceCameraController.lookEventTypes),_.scene.screenSpaceCameraController.lookEventTypes=e?Cesium.CameraEventType.LEFT_DRAG:v}},enumerable:!0}),this.flyToPoint=function(t){return new l.a((function(e,n){try{t.position instanceof u.a.Point3d?_cesium.camera.flyTo({destination:t.position.exportCartesian(),complete:function(){e()},duration:isNaN(t.duration)?0:t.duration,orientation:{heading:isNaN(t.heading)?0:Cesium.Math.toRadians(t.heading),pitch:isNaN(t.pitch)?0:Cesium.Math.toRadians(t.pitch),roll:0}}):n()}catch(t){n()}}))},this.flyto=function(t){return new l.a((function(e,n){var i=_cesium,r=C(t,"duration",3),o=Cesium.Cartesian3.fromDegrees(t.longitude,t.latitude,t.height),s=C(t,"heading",0),a=C(t,"pitch",-90),l=C(t,"roll",0),u=C(t,"easingFunction",Cesium.EasingFunction.SINUSOIDAL_IN_OUT),c=C(t,"maxHeight",250);i.camera.flyTo({destination:o,orientation:Cesium.HeadingPitchRoll.fromDegrees(s,a,l),duration:r,endTransform:Cesium.Matrix4.IDENTITY,maximumHeight:c,easingFunction:u,complete:function(){e()}})}))},this.getPose=function(){var t=_cesium,e=t.camera.positionCartographic;return{longitude:180*e.longitude/Math.PI,latitude:180*e.latitude/Math.PI,height:e.height,heading:180*t.camera.heading/Math.PI,pitch:180*t.camera.pitch/Math.PI,roll:180*t.camera.roll/Math.PI}},this.focusOnPoint=function(t){return new l.a((function(e,n){try{if(t.position instanceof u.a.Point3d){var i,r=new Cesium.BoundingSphere(t.position.exportCartesian(),isNaN(t.distance)?100:t.distance);if(t.offset&&t.offset instanceof Array)r.center=Cesium.Matrix4.multiplyByPoint(Cesium.Transforms.eastNorthUpToFixedFrame(t.position.exportCartesian()),(i=Cesium.Cartesian3).fromElements.apply(i,h()(t.offset)),new Cesium.Cartesian3);_cesium.camera.flyToBoundingSphere(r,{complete:function(){e()},cancel:function(){n()},duration:isNaN(t.duration)?0:t.duration,offset:new Cesium.HeadingPitchRange(isNaN(t.heading)?0:Cesium.Math.toRadians(t.heading),isNaN(t.pitch)?0:Cesium.Math.toRadians(t.pitch),0)})}else n()}catch(t){n()}}))},this.focusOnSphere=function(t){return new l.a((function(e,n){try{if(t.boundingSphere instanceof Cesium.BoundingSphere){var i,r=t.boundingSphere;if(t.offset&&t.offset instanceof Array)r.center=Cesium.Matrix4.multiplyByPoint(Cesium.Transforms.eastNorthUpToFixedFrame(r.center),(i=Cesium.Cartesian3).fromElements.apply(i,h()(t.offset)),new Cesium.Cartesian3);_cesium.camera.flyToBoundingSphere(r,{complete:function(){e()},cancel:function(){n()},duration:isNaN(t.duration)?3:t.duration,offset:new Cesium.HeadingPitchRange(isNaN(t.heading)?0:Cesium.Math.toRadians(t.heading),isNaN(t.pitch)?0:Cesium.Math.toRadians(t.pitch),isNaN(t.distance)?0:t.distance),maximumHeight:isNaN(t.maxHeight)?250:t.maxHeight,easingFunction:Cesium.EasingFunction.SINUSOIDAL_IN_OUT})}else n()}catch(t){n()}}))},this.rotateVertical=function(t){return new l.a((function(e,n){try{var i=_cesium.camera.pickEllipsoid(new Cesium.Cartesian2(_cesium.canvas.clientWidth/2,_cesium.canvas.clientHeight/2));if(i){var r=Cesium.Cartesian3.distance(i,_cesium.camera.position),o={pitch:_cesium.camera.pitch},s=_cesium.camera.heading;new f.a.Tween(o).to({pitch:isNaN(t.pitch)?0:Cesium.Math.toRadians(t.pitch)},isNaN(t.duration)?0:1e3*t.duration).easing(f.a.Easing.Quadratic.InOut).onUpdate((function(){_cesium.camera.lookAt(i,new Cesium.HeadingPitchRange(s,o.pitch,r)),_cesium.camera.lookAtTransform(Cesium.Matrix4.IDENTITY)})).onComplete((function(){e()})).start()}}catch(t){n()}}))},this.rotateHorizontal=function(t){return new l.a((function(e,n){try{var i=_cesium.camera.pickEllipsoid(new Cesium.Cartesian2(_cesium.canvas.clientWidth/2,_cesium.canvas.clientHeight/2));if(i){var r={heading:_cesium.camera.heading},o=_cesium.camera.pitch,s=Cesium.Cartesian3.distance(_cesium.camera.position,i);new f.a.Tween(r).to({heading:isNaN(t.heading)?0:Cesium.Math.toRadians(t.heading)},isNaN(t.duration)?0:1e3*t.duration).easing(t.easing?t.easing:f.a.Easing.Quadratic.InOut).onUpdate((function(){_cesium.camera.lookAt(i,new Cesium.HeadingPitchRange(r.heading,o,s)),_cesium.camera.lookAtTransform(Cesium.Matrix4.IDENTITY)})).onComplete((function(){e()})).start()}}catch(t){n()}}))};var x=null;this.autoRotate=function(t){if(t=t||{},!x){var e=t.center?t.center:_cesium.camera.pickEllipsoid(new Cesium.Cartesian2(_cesium.canvas.clientWidth/2,_cesium.canvas.clientHeight/2));if(e){var n=_cesium.camera.pitch;x=setInterval((function(){var i=Cesium.Cartesian3.distance(_cesium.camera.position,e),r=_cesium.camera.heading;_cesium.camera.lookAt(e,new Cesium.HeadingPitchRange(r+=Cesium.Math.toRadians(isNaN(t.step)?.2:t.step),n,i)),_cesium.camera.lookAtTransform(Cesium.Matrix4.IDENTITY)}),50)}}},this.stopAutoRotate=function(){x&&(clearInterval(x),x=null)},this.getStats=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window._cesium;return t?{up:t.camera.up.clone(),direction:t.camera.direction.clone(),position:t.camera.position.clone(),heading:t.camera.heading,pitch:t.camera.pitch,roll:t.camera.roll}:null},this.getStatsJSON=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window._cesium;return t?{up:[t.camera.up.x,t.camera.up.y,t.camera.up.z],direction:[t.camera.direction.x,t.camera.direction.y,t.camera.direction.z],position:[t.camera.position.x,t.camera.position.y,t.camera.position.z],heading:t.camera.heading,pitch:t.camera.pitch,roll:t.camera.roll}:null},this.applyStats=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window._cesium;try{return new l.a((function(n,i){e.camera.flyTo({destination:t.position,orientation:{direction:t.direction,up:t.up},duration:isNaN(t.duration)?0:t.duration,complete:function(){n()}})}))}catch(t){console.warn(t)}},this.applyStatsJSON=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window._cesium;try{var n={up:new(Function.prototype.bind.apply(Cesium.Cartesian3,[null].concat(h()(t.up)))),direction:new(Function.prototype.bind.apply(Cesium.Cartesian3,[null].concat(h()(t.direction)))),position:new(Function.prototype.bind.apply(Cesium.Cartesian3,[null].concat(h()(t.position)))),heading:t.heading,pitch:t.pitch,roll:t.roll};return this.applyStats(n,e)}catch(t){console.warn(t)}},this.getView=function(){var t=null;try{var e=_cesium.camera.computeViewRectangle();e&&((t={}).minX=e.west/Math.PI*180,t.maxY=e.north/Math.PI*180,t.maxX=e.east/Math.PI*180,t.minY=e.south/Math.PI*180,t.height=Math.ceil(_cesium.camera.positionCartographic.height),t.level=u.a.Util.getLevelByHeight(t.height),t.centerX=(t.minx+t.maxx)/2,t.centerY=(t.miny+t.maxy)/2)}catch(t){}return t}},r()(u.a.Camera.prototype,p.prototype);u.a.Camera;var k=n(17),B=n.n(k);u.a.AssetManager=function(){},u.a.AssetManager.axios=B.a.create({}),u.a.AssetManager.assetsMap={},u.a.AssetManager.getImage=function(t){var e=function(t,e){n.push(new l.a((function(e,n){if(t)if(u.a.AssetManager.assetsMap[t])e(u.a.AssetManager.assetsMap[t]);else{var i=new Image;i.src=t,i.onload=function(){u.a.AssetManager.assetsMap[t]=i,e(u.a.AssetManager.assetsMap[t])}}else e(null)})))},n=[];return Array.isArray(t)?t.forEach((function(t,n){e(t)})):e(t),l.a.all(n)};u.a.AssertManager;u.a.DomMarkerManager=function(t){var e=[],n=function(){e.forEach((function(t){if(t)if(t.show){var e=t.xyz.exportCartesian(),n=Cesium.Cartesian3.distance(_cesium.camera.position,e),i=1;i=n<=t.near?t.nearScale:n>=t.near&&n<=t.far?t.nearScale-(n-t.near)/(t.far-t.near)*(t.nearScale-t.farScale):t.farScale,t.style.transform=(t.__translate||"")+"scale("+i+","+i+")";var r=Cesium.SceneTransforms.wgs84ToWindowCoordinates(_cesium.scene,e);r&&(t.style.top=parseInt(r.y)+t.offset[1]+"px",t.style.left=parseInt(r.x)+t.offset[0]+"px",t.style.display="block")}else t.style.display="none"}))};t.on("onEachFrame",n),this.add=function(n,i){e.push(n),!i&&t.container.append(n)},this.remove=function(t,n){var i=e.findIndex((function(e){return e.id==t}));i>=0&&!n&&e[i].remove(),e.splice(i,1)},this.clear=function(){for(;e.length>0;){e.pop().remove()}},this.destroy=function(){t.off("onEachFrame",n),e=[]}};u.a.DomMarkerManager;u.a.AnimateManager=function(){var t=this,e={};function n(){return performance?performance.now():Date.now()}this.pause=function(t){if(t){var n=e[t];if(n){if(n.curPlayIndex>=-1){var i=n.tweens[n.curPlayIndex+1];i&&i.pause()}n.hasStop=!0}}},this.resume=function(t){if(t){var n=e[t];if(n){if(n.curPlayIndex>=-1){var i=n.tweens[n.curPlayIndex+1];i&&i.resume()}n.hasStop=!1}}},this.remove=function(t){if(t){var n=e[t];if(n){if(n.curPlayIndex>=0){var i=n.tweens[n.curPlayIndex+1];i&&i.stop()}n.hasStop=!0,n.finishedTrace&&window._cesium.entities.remove(n.finishedTrace),n.unFinishedTrace&&window._cesium.entities.remove(n.unFinishedTrace),n.startPoint&&n.startPoint.destroy(),n.finishPoint&&n.finishPoint.destroy(),delete e[t]}}},this.updateSpeed=function(t,i){if(t){var r=e[t];r&&(r.speedRatio=i||1,r.tweens.forEach((function(t,e){var o=t._duration_normal;if(e===r.curPlayIndex+1){var s=n(),a=(s-t._startTime)/t._duration;t.duration(o/i),t._startTime=s-t._duration*a}else t.duration(o/i)})))}},this.playAt=function(i,r){if(i){var o=e[i];if(o){var s=function(t,e,n){var i=0,r={index:-1,ratio:0};return t.points.find((function(t,o,s){if(o<s.length-1){var a=s[o+1],l=n;if(isNaN(a.time)||isNaN(t.time)||(l=a.time-t.time),(i+=l)>=e)return r.index=o,r.ratio=(e-(i-l))/l,!0}})),r}(o,r,t.defaultDuration);if(s.index>=0){var a=o.curPlayIndex===s.index-1;if(o.curPlayIndex<o.size-2){var l=o.tweens[o.curPlayIndex+1];a||l.stop()}var u=o.tweens[s.index];if(u){a||(u.start(),o.curPlayIndex=s.index-1);var c=n();u._startTime=c-u._duration*s.ratio,u.update()}}}}},this.drawTrace=function(t){if(t&&t.id){var n=e[t.id];if(n.size>1){var i=isNaN(t.lineWidth)?1:t.lineWidth;i=isNaN(t.finishedWidth)?i:t.finishedWidth,n.finishedTrace=window._cesium.entities.add({show:!1!==t.showFinishedRoute,polyline:{positions:new Cesium.CallbackProperty((function(){try{var t=[];return n.size>=1?(t=n.curPlayIndex>=0?n.cut(0,n.curPlayIndex+2).exportCartesianArray():[n.getByIndex(0).exportCartesian()],n.curPos instanceof u.a.Point3d?t.push(n.curPos.exportCartesian()):t.push(n.getByIndex(0).exportCartesian()),t):t.push(new Cesium.Cartesian3(0,0,0),new Cesium.Cartesian3(0,0,1))}catch(t){console.warn(t)}}),!1),width:i,material:t.finishedMaterial?t.finishedMaterial:t.finishedColor instanceof u.a.Color?t.finishedColor.color:(new u.a.Color).fromCss("rgba(0,255,0,1)").color,clampToGround:!!t.clampToGround}});var r=isNaN(t.lineWidth)?1:t.lineWidth;r=isNaN(t.unFinishedWidth)?r:t.unFinishedWidth,n.unFinishedTrace=window._cesium.entities.add({show:!1!==t.showUnFinishedRoute,polyline:{positions:new Cesium.CallbackProperty((function(){if(n.size>=1){if(n.curPlayIndex<n.size-2){var t=n.cut(n.curPlayIndex+2,n.size),e=null;return e=n.curPos?n.curPos:n.getByIndex(0),t.exportCartesianArray(!0).concat(e.exportCartesian())}var i=n.getByIndex(n.size-1);return[i.exportCartesian(),i.exportCartesian()]}return[new Cesium.Cartesian3(0,0,0),new Cesium.Cartesian3(0,0,1)]}),!1),width:r,material:t.unFinishedMaterial?t.unFinishedMaterial:t.unFinishedColor instanceof u.a.Color?t.unFinishedColor.color:(new u.a.Color).fromCss("rgba(255,0,0,1)").color,clampToGround:!!t.clampToGround}})}}},this.drawStartPoint=function(t){if(t&&t.id){var n=e[t.id];if(n&&n.size>0){var i=new u.a.Point3dCollection;return i.addPoint3d(n.getByIndex(0)),t.trace=i,n.startPoint=new u.a.Billboards(t),n.startPoint}}},this.drawFinishPoint=function(t){if(t&&t.id){var n=e[t.id];if(n&&n.size>1){var i=new u.a.Point3dCollection;return i.addPoint3d(n.getByIndex(n.size-1)),t.trace=i,n.finishPoint=new u.a.Billboards(t),n.finishPoint}}};var i=function(t){if(t.size>0){if(!t.cp){var e=t.getByIndex(0).exportCartesian().clone();t.cp=r(e,t,0)}t.ce||(t.ce=window._cesium.entities.add({position:new Cesium.CallbackProperty((function(){return t.cp}),!1),point:{color:new Cesium.Color(1,1,1,0)}}))}},r=function(t,e,n){var i=e.ce_offset||0;if(0===i)return t;var r=Cesium.Cartographic.fromCartesian(t);r=[Cesium.Math.toDegrees(r.longitude),Cesium.Math.toDegrees(r.latitude),r.height];var o=e.getByIndex(n).exportLngLatHeightArray(),s=e.getByIndex(n+1).exportLngLatHeightArray(),a=new Cesium.Cartesian2(o[0],o[1]),l=new Cesium.Cartesian2(s[0],s[1]),u=Cesium.Cartesian2.subtract(l,a,new Cesium.Cartesian2),c=Cesium.Cartesian2.angleBetween(u,new Cesium.Cartesian2(1,0));s[1]<o[1]&&(c=2*Math.PI-c),c+=i<0?Math.PI/2:-Math.PI/2;var h=Math.abs(i)/(2*Math.PI*Cesium.Ellipsoid.WGS84.radii.x/360),p=[r[0]+h*Math.cos(c),r[1]+h*Math.sin(c)];return new Cesium.Cartesian3.fromDegrees(p[0],p[1],r.height)};this.createTrace=function(t){t=t||new u.a.Point3dCollection;return e[t.id]=t,t.curPlayIndex=-1,t.tweens=[],t.speedRatio=1,i(t),t.id},this.addPoint2Trace=function(n){if(n.id){var r=e[n.id];if(r instanceof u.a.Point3dCollection&&n.point instanceof u.a.Point3d){var o=r.tweens.length;r.addPoint3d(n.point),r.curPlayIndex>=o-1&&!r.hasStop&&t.play(n),i(r)}}},this.play=function(t){var n=this;if(t.id){var i=e[t.id];if(i.hasStop=!1,"function"==typeof t.update&&(i.update=t.update),"function"==typeof t.complete&&(i.complete=t.complete),"function"==typeof t.step&&(i.step=t.step),i instanceof u.a.Point3dCollection&&i.size>1){var o=[];i.forEach((function(e,s){s<i.size-1&&s>i.curPlayIndex&&o.push(function(e){var o=i.getByIndex(e),s=i.getByIndex(e+1),a={lng:o.lng,lat:o.lat,height:o.height,heading:o.heading},l={lng:s.lng,lat:s.lat,height:s.height,heading:s.heading},c={lng:l.lng,lat:l.lat,height:l.height};isNaN(a.heading)||isNaN(a.heading)||(c.heading=l.heading);var h=3e3;isNaN(s.time)||isNaN(o.time)||(h=s.time-o.time);var p=new f.a.Tween(a).to(c,h/i.speedRatio).onComplete((function(){i.curPlayIndex=e,e==i.tweens.length-1&&(i.curPlayIndex<i.size-2?n.play(t):("function"==typeof i.complete&&i.complete(),t.loop&&(i.curPlayIndex=-1,i.tweens=[],n.play(t)))),i.step&&i.step(e)})).onUpdate((function(){var t=Cesium.Cartesian3.fromDegrees(a.lng,a.lat,a.height,null,i.cp);i.cp=r(t,i,e),i.update&&i.update(a,e),i.curPos=(new u.a.Point3d).fromLngLat(a.lng,a.lat,a.height)})).easing(f.a.Easing.Linear.None);return p._duration_normal=h,p}(s))})),Array.isArray(o)&&o.length>0&&(o.forEach((function(t,e){e<o.length-1&&t.chain(o[e+1])})),o[0].start(),i.tweens=i.tweens.concat(o))}}};var o=null,s=function(){o&&o(),o=null};this.follow=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{offset:0};s();var r=e[t];r&&(r.ce_offset=i.offset,window._cesium.trackedEntity=r.ce,"function"==typeof n&&(o=window._cesium.scene.postRender.addEventListener((function(){!1===window._cesium._needTrackedEntityUpdate&&(n(t),s())}))))},this.stopFollow=function(){s(),window._cesium.trackedEntity=null}},u.a.AnimateManager.prototype.type="AnimateManager";u.a.AnimateManager;var G=n(8),j=n.n(G),z=function(t,e){t.viewer=e.viewer,t.name=e.name||x();var n=t._ds=new Cesium.CustomDataSource(t.name);t.viewer.dataSources.add(n)},U=function(t){t._ds&&t._ds.entities.removeAll()},q=function(t){return t._ds.entities},V=u.a.EntityManager=function(t){var e=s()({},t,{viewer:P.apply(void 0,arguments)||_cesium});z(this,e)};j()(V.prototype,{dataSource:{get:function(){return this._ds}},entities:{get:function(){return this._ds.entities}},visible:{get:function(){return!1!==this._ds.show},set:function(t){this._ds.show=!!t}}}),V.prototype.add=function(t){var e=this._ds.entities;if(t instanceof Array){var n=[];e.suspendEvents();for(var i=0;i<t.length;i++){var r=e.add(t[i]);n.push(r)}return e.resumeEvents(),n}return e.add(t)},V.prototype.destroy=function(){var t;U(t=this),t._ds&&t.viewer.dataSources.remove(t._ds,!0),delete t._ds,delete t.viewer},V.prototype.clear=function(){U(this)},V.prototype.removeAll=function(){U(this)},V.prototype.contains=function(t){return q(this).contains(t)},V.prototype.getById=function(t){return q(this).getById(t)},V.prototype.remove=function(t){return q(this).remove(t)},V.prototype.removeById=function(t){return q(this).removeById(t)},V.prototype.getOrCreateEntity=function(t){return q(this).getOrCreateEntity(t)},V.prototype.beginAdd=function(){this._ds.entities.suspendEvents()},V.prototype.endAdd=function(){this._ds.entities.resumeEvents()},V.prototype.show=function(){this._ds.show=!0},V.prototype.hide=function(){this._ds.show=!1};new Cesium.Cartographic;var H=new Cesium.Cartesian2,Y=function(t,e){t.viewer=e.viewer,t._em=new V({viewer:e.viewer}),t._ehCluster=t._em.dataSource.clustering.clusterEvent.addEventListener((function(e,n){"function"==typeof t._onClustering&&t._onClustering(e,n)})),t._ms=[],t._cms=[],t._minClusterNum=null==e.minClusterNum?2:e.minClusterNum,t._gridPxSize=null==e.clusterSize?50:e.clusterSize;var n=ut[C(e,"clusterType","aggregation")]||ct;t._onClusterRenderOne=e.onClusterRenderOne||n,t._onClusterMarkerClick=null},X=function(t){t._ms.splice(0,t._ms.length),t._cms.splice(0,t._cms.length),t._em.removeAll(),J(t),tt(t),it(t)},W=function(t){var e=C(t,"position",null);if(!e)return null;if(!(e instanceof Cesium.Cartesian3))if(e instanceof Array)e=Cesium.Cartesian3.fromDegrees(e[0],e[1],e[2]);else if(null!=e.lon)e=Cesium.Cartesian3.fromDegrees(e.lon,e.lat,e.height);else{if(!(e instanceof u.a.Point3d))return null;e=e.point}return s()({},t,{position:e})},K=function(t){J(t),t.handler&&t.handler.destroy(),delete t.handler},Z=function(t){J(t),t.handler||(t.handler=new Cesium.ScreenSpaceEventHandler(t.viewer.scene.canvas)),t.handler.setInputAction((function(e){var n=t.viewer.scene.pick(e.position);if(null!=n&&n.id&&n.id instanceof Cesium.Entity&&t._em.contains(n.id)){var i=w(t._ms,"id",n.id.id);i?"function"==typeof i.options.onClick&&i.options.onClick(i.id,i.options,n.id.position.getValue()):(i=w(t._cms,"id",n.id.id))&&"function"==typeof t._onClusterMarkerClick&&t._onClusterMarkerClick(i.id,i.data,n.id.position.getValue())}}),Cesium.ScreenSpaceEventType.LEFT_CLICK)},J=function(t){t.handler&&t.handler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK)},Q=function(t){tt(t),t.dblhandler&&t.dblhandler.destroy(),delete t.dblhandler},$=function(t){tt(t),t.dblhandler||(t.dblhandler=new Cesium.ScreenSpaceEventHandler(t.viewer.scene.canvas)),t.dblhandler.setInputAction((function(e){var n=t.viewer.scene.pick(e.position);if(null!=n&&n.id&&n.id instanceof Cesium.Entity&&t._em.contains(n.id)){var i=w(t._ms,"id",n.id.id);i?"function"==typeof i.options.onDblClick&&i.options.onDblClick(i.id,i.options,n.id.position.getValue()):(i=w(t._cms,"id",n.id.id))&&"function"==typeof t._onClusterMarkerDblClick&&t._onClusterMarkerDblClick(i.id,i.data,n.id.position.getValue())}}),Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)},tt=function(t){t.dblhandler&&t.dblhandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)},et=function(t){it(t),t.mmhandler&&t.mmhandler.destroy(),delete t.mmhandler},nt=function(t){it(t),t.mmhandler||(t.mmhandler=new Cesium.ScreenSpaceEventHandler(t.viewer.scene.canvas));var e=t.mmhandler;e.setInputAction((function(e){t._fmm=!0}),Cesium.ScreenSpaceEventType.LEFT_DOWN),e.setInputAction((function(e){t._fmm=!1}),Cesium.ScreenSpaceEventType.LEFT_UP),e.setInputAction((function(e){t._fmm=!0}),Cesium.ScreenSpaceEventType.RIGHT_DOWN),e.setInputAction((function(e){t._fmm=!1}),Cesium.ScreenSpaceEventType.RIGHT_UP),e.setInputAction((function(e){t._fmm=!0}),Cesium.ScreenSpaceEventType.MIDDLE_DOWN),e.setInputAction((function(e){t._fmm=!1}),Cesium.ScreenSpaceEventType.MIDDLE_UP),e.setInputAction((function(e){if(t.movePicking&&(t.mouseDownMovePicking||!t._fmm)){var n=t.viewer.scene.pick(e.endPosition),i=!1;if(null!=n&&n.id&&n.id instanceof Cesium.Entity&&t._em.contains(n.id)){var r=w(t._ms,"id",n.id.id);r?(t._lhm?r!==t._lhm.mi&&("cm"===t._lhm.type?"function"==typeof t._onClusterMarkerMouseOut&&t._onClusterMarkerMouseOut(t._lhm.mi.id,t._lhm.mi.data):"function"==typeof t._lhm.mi.options.onMouseOut&&t._lhm.mi.options.onMouseOut(t._lhm.mi.id,t._lhm.mi.options),t._lhm={mi:r,type:"m"},"function"==typeof r.options.onMouseOver&&r.options.onMouseOver(r.id,r.options,n.id.position.getValue())):(t._lhm={mi:r,type:"m"},"function"==typeof r.options.onMouseOver&&r.options.onMouseOver(r.id,r.options,n.id.position.getValue())),i=!0):(r=w(t._cms,"id",n.id.id))&&(t._lhm?r!==t._lhm.mi&&("cm"===t._lhm.type?"function"==typeof t._onClusterMarkerMouseOut&&t._onClusterMarkerMouseOut(t._lhm.mi.id,t._lhm.mi.data):"function"==typeof t._lhm.mi.options.onMouseOut&&t._lhm.mi.options.onMouseOut(t._lhm.mi.id,t._lhm.mi.options),t._lhm={mi:r,type:"cm"},"function"==typeof t._onClusterMarkerMouseOver&&t._onClusterMarkerMouseOver(r.id,r.data,n.id.position.getValue())):(t._lhm={mi:r,type:"cm"},"function"==typeof t._onClusterMarkerMouseOver&&t._onClusterMarkerMouseOver(r.id,r.data,n.id.position.getValue())),i=!0)}i||t._lhm&&("cm"===t._lhm.type?"function"==typeof t._onClusterMarkerMouseOut&&t._onClusterMarkerMouseOut(t._lhm.mi.id,t._lhm.mi.data):"function"==typeof t._lhm.mi.options.onMouseOut&&t._lhm.mi.options.onMouseOut(t._lhm.mi.id,t._lhm.mi.options),t._lhm=null)}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE)},it=function(t){t.mmhandler&&(t.mmhandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOWN),t.mmhandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_UP),t.mmhandler.removeInputAction(Cesium.ScreenSpaceEventType.RIGHT_DOWN),t.mmhandler.removeInputAction(Cesium.ScreenSpaceEventType.RIGHT_UP),t.mmhandler.removeInputAction(Cesium.ScreenSpaceEventType.MIDDLE_DOWN),t.mmhandler.removeInputAction(Cesium.ScreenSpaceEventType.MIDDLE_UP),t.mmhandler.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE))},rt=function(t,e,n,i){if(e&&0!=e.length){for(var r=t._minClusterNum,o=t.viewer.canvas.width,s=t.viewer.canvas.height,a=t._gridPxSize,l=[],u=0;u<=o;u+=a)for(var c=0;c<=s;c+=a)l.push({r:[u,c,u+a,c+a],es:[]});for(var h=[],p=(u=0,e.length);u<p;u++){var f=e[u],d=f.ei.position,g=Cesium.SceneTransforms.wgs84ToWindowCoordinates(t.viewer.scene,d,H);if(g){for(var y=!1,m=(c=0,l.length);c<m;c++){var _=l[c];if(ot(_.r,[g.x,g.y])){_.es.push(f),y=!0;break}}y||h.push(f)}else h.push(f)}t._cms.splice(0,t._cms.length);var v=i;for(u=0,p=l.length;u<p;u++){var x=(_=l[u]).es.length;if(x<r)if("function"==typeof v)for(c=0;c<x;c++){!1!==(w=v({id:_.es[c].id,options:_.es[c].options},1))&&t._em.add(null==w?_.es[c].ei:w)}else for(c=0;c<x;c++)t._em.add(_.es[c].ei);else{var C=_.es[0].ei.position;if("function"==typeof v){var w,b=_.es.map((function(t){return t}));if(null!=(w=v({position:C,els:b},_.es.length))){var E=t._em.add(w);t._cms.push({id:E.id,data:b})}}}}}},ot=function(t,e){return!(!e||!t)&&(e[0]>=t[0]&&e[0]<t[2]&&e[1]>=t[1]&&e[1]<t[3])},st={},at=new Cesium.PinBuilder,lt=function(t,e){var n=null==e?Cesium.Color.LIMEGREEN:e,i=t+"_"+n.toRgba(),r=st[i];if(!r){var o=t.toString().length;o=10*(o<1?1:o)+28,r=st[i]=at.fromText(t,n,o).toDataURL()}return r},ut={aggregation:function(t,e){if(1==e)return null;var n={clampToGround:!0,image:lt(e)};return t.els.length>0&&t.els[0].ei.billboard&&t.els[0].ei.billboard.hasOwnProperty("disableDepthTestDistance")&&(n.disableDepthTestDistance=t.els[0].ei.billboard.disableDepthTestDistance),{position:t.position,billboard:n}},dilute:function(t,e){return e>1?t.els[0].ei:null}},ct=ut.aggregation,ht=u.a.MarkerManager=function(t){var e=s()({},t,{viewer:P.apply(void 0,arguments)||_cesium});Y(this,e)};j()(ht.prototype,{entities:{get:function(){return this._em.entities}},visible:{get:function(){return this._em.visible},set:function(t){this._em.visible=!!t}},clustering:{get:function(){return this._em.dataSource.clustering.enabled},set:function(t){this._em.dataSource.clustering.enabled=t}},onClustering:{set:function(t){this._onClustering=t}},minClusterNum:{get:function(){return this._minClusterNum},set:function(t){var e=Number(t);this._minClusterNum=isNaN(e)?2:e}},clusterSize:{get:function(){return this._gridPxSize},set:function(t){var e=Number(t);this._gridPxSize=isNaN(e)?50:e}},onClusterRenderOne:{set:function(t){this._onClusterRenderOne=t}},onClusterMarkerClick:{set:function(t){this._onClusterMarkerClick=t}},onClusterMarkerDblClick:{set:function(t){this._onClusterMarkerDblClick=t}},onClusterMarkerMouseOver:{set:function(t){this._onClusterMarkerMouseOver=t}},onClusterMarkerMouseOut:{set:function(t){this._onClusterMarkerMouseOut=t}}}),ht.prototype.destroy=function(){var t;K(t=this),Q(t),et(t),t._ehCluster&&(t._ehCluster(),delete t._ehCluster),t._rel&&(t._rel(),delete t._rel),X(t),t._em.destroy(),delete t._em,delete t._ms,delete t.viewer},ht.prototype.clear=function(){X(this)},ht.prototype.add=function(t){return function(t,e,n){var i=W(e);if(!i)return null;var r=i.id;return null==r&&(r=i.id=x()),!n&&t._em.add(i),t._ms.push({id:r,ei:i,options:e}),1==t._ms.length&&($(t),Z(t),nt(t)),r}(this,t,this._isClustering)},ht.prototype.remove=function(t){!function(t,e){t._em.removeById(e),function(t,e,n){if(!t)return null;for(var i=[],r=0;r<t.length;r++)t[r][e]==n&&i.push(t.splice(r--,1)[0])}(t._ms,"id",e),0==t._ms.length&&(J(t),tt(t),it(t))}(this,t)},ht.prototype.getById=function(t){return this._em.getById(t)},ht.prototype.show=function(){this._em.show()},ht.prototype.hide=function(){this._em.hide()},ht.prototype.beginAdd=function(){this._em.beginAdd()},ht.prototype.endAdd=function(){this._em.endAdd()},ht.prototype.beginCluster=function(t){var e,n,i,r=this;(r._rel&&(r._rel(),delete r._rel),r.viewer.scene)&&(t&&"function"==typeof t.onClusterMarkerClick&&(r._onClusterMarkerClick=t.onClusterMarkerClick),t&&"function"==typeof t.onClusterMarkerDblClick&&(r._onClusterMarkerDblClick=t.onClusterMarkerDblClick),r.enableCluster=!0,r._isClustering=!0,r._em.removeAll(),rt(r,r._ms,r.viewer.scene,r._onClusterRenderOne),r._rel=r.viewer.scene.camera.changed.addEventListener((e=function(t){null!=t&&t<.05||!r.enableCluster||(r._em.removeAll(),rt(r,r._ms,r.viewer.scene,r._onClusterRenderOne))},n=100,i=null,function(){var t=arguments;i&&clearTimeout(i),i=setTimeout((function(){e.apply(null,t)}),n)})))},ht.prototype.stopCluster=function(){var t=this;this._rel&&(this._rel(),delete this._rel),delete t._isClustering,t._em.removeAll(),t._em.beginAdd();for(var e=0;e<t._ms.length;e++)t._em.add(t._ms[e].ei);t._em.endAdd()};u.a.Color=function(t,e,n,i){var r=this;t>1&&(t/=255),e>1&&(e/=255),n>1&&(n/=255),i>1&&(i/=255);var o=null;Object.defineProperty(this,"r",{get:function(){var t=r.exportArray();return Array.isArray(t)?t[0]:null},set:function(t){if(!isNaN(t)){o=t;var e=r.exportArray();Array.isArray(e)&&(e[0]=o,r.color=new(Function.prototype.bind.apply(Cesium.Color,[null].concat(h()(e)))))}},enumerable:!0});var s=null;Object.defineProperty(this,"g",{get:function(){var t=r.exportArray();return Array.isArray(t)?t[1]:null},set:function(t){if(!isNaN(t)){s=t;var e=r.exportArray();Array.isArray(e)&&(e[1]=s,r.color=new(Function.prototype.bind.apply(Cesium.Color,[null].concat(h()(e)))))}},enumerable:!0});var a=null;Object.defineProperty(this,"b",{get:function(){var t=r.exportArray();return Array.isArray(t)?t[2]:null},set:function(t){if(!isNaN(t)){a=t;var e=r.exportArray();Array.isArray(e)&&(e[2]=a,r.color=new(Function.prototype.bind.apply(Cesium.Color,[null].concat(h()(e)))))}},enumerable:!0});var l=null;Object.defineProperty(this,"a",{get:function(){var t=r.exportArray();return Array.isArray(t)?t[3]:null},set:function(t){if(!isNaN(t)){l=t;var e=r.exportArray();Array.isArray(e)&&(e[3]=l,r.color=new(Function.prototype.bind.apply(Cesium.Color,[null].concat(h()(e)))))}},enumerable:!0}),this.color=new Cesium.Color(isNaN(t)?1:t,isNaN(e)?1:e,isNaN(n)?1:n,isNaN(i)?1:i)},u.a.Color.prototype.type="Color",u.a.Color.prototype.fromCss=function(t){return this.color=Cesium.Color.fromCssColorString(t),this},u.a.Color.prototype.exportCss=function(t){return t?this.color.toCssColorString():this.color.toCssHexString()},u.a.Color.prototype.exportArray=function(){return[this.color.red,this.color.green,this.color.blue,this.color.alpha]},u.a.Color.prototype.export255Array=function(t){return[parseInt(255*this.color.red),parseInt(255*this.color.green),parseInt(255*this.color.blue),t?parseInt(255*this.color.alpha):this.color.alpha]},u.a.Color.randomColor=function(t){var e=(new u.a.Color).fromCss(u.a.Util.randomCssColor());return isNaN(t)||(e.a=t),e};u.a.Color;u.a.Point3d=function(t){u.a.Object.call(this,t);var e=this,n=null;window.Object.defineProperty(this,"lng",{get:function(){var t=e.exportLngLatHeightArray();return Array.isArray(t)?t[0]:null},set:function(t){if(!isNaN(t)){n=t;var i=e.exportLngLatHeightArray();Array.isArray(i)&&(i[0]=n,e.fromLngLat.apply(e,h()(i)))}},enumerable:!0});var i=null;window.Object.defineProperty(this,"lat",{get:function(){var t=e.exportLngLatHeightArray();return Array.isArray(t)?t[1]:null},set:function(t){if(!isNaN(t)){i=t;var n=e.exportLngLatHeightArray();Array.isArray(n)&&(n[1]=i,e.fromLngLat.apply(e,h()(n)))}},enumerable:!0});var r=null;window.Object.defineProperty(this,"height",{get:function(){var t=e.exportLngLatHeightArray();return Array.isArray(t)?t[2]:null},set:function(t){if(!isNaN(t)){r=t;var n=e.exportLngLatHeightArray();Array.isArray(n)&&(n[2]=r,e.fromLngLat.apply(e,h()(n)))}},enumerable:!0})},u.a.Point3d.prototype.type="Point3d",u.a.Point3d.prototype.fromLngLat=function(t,e,n){return isNaN(t)||isNaN(e)||(this.point=Cesium.Cartesian3.fromDegrees(t,e,isNaN(n)?0:n)),this},u.a.Point3d.prototype.fromLngLatHeightArray=function(t,e,n){return this.fromLngLat(t,e,n)},u.a.Point3d.prototype.applyOffset=function(t,e,n){var i=0,r=0,o=0;return isNaN(t)||(i=this.lng+t),isNaN(e)||(r=this.lat+e),isNaN(n)||(o=this.height+n),(new u.a.Point3d).fromLngLat(i,r,o)},u.a.Point3d.prototype.fromRadian=function(t,e,n){return isNaN(t)||isNaN(e)||(this.point=Cesium.Cartesian3.fromDegrees(Cesium.Math.toDegrees(t),Cesium.Math.toDegrees(e),isNaN(n)?0:n)),this},u.a.Point3d.prototype.fromCartesian=function(t){return t instanceof Cesium.Cartesian3&&(this.point=t.clone()),this},u.a.Point3d.prototype.distanceTo=function(t){if(t instanceof u.a.Point3d)return Cesium.Cartesian3.distance(this.point,t.point)},u.a.Point3d.prototype.exportLngLatHeightArray=function(){var t=_cesium.scene.globe.ellipsoid.cartesianToCartographic(this.point),e=Cesium.Math.toDegrees(t.latitude);return[Cesium.Math.toDegrees(t.longitude),e,t.height]},u.a.Point3d.prototype.exportLngLatArray=function(){try{var t=_cesium.scene.globe.ellipsoid.cartesianToCartographic(this.point),e=Cesium.Math.toDegrees(t.latitude);return[Cesium.Math.toDegrees(t.longitude),e]}catch(t){return console.warn(t),[]}},u.a.Point3d.prototype.exportCartesian=function(){return this.point},u.a.Point3d.prototype.exportRadianHeightArray=function(){var t=this.exportLngLatHeightArray();if(Array.isArray(t)&&3==t.length)return[t[0]*Math.PI/180,t[1]*Math.PI/180,t[2]]},u.a.Point3d.prototype.exportRadianArray=function(){var t=this.exportLngLatArray();if(Array.isArray(t)&&2==t.length)return[t[0]*Math.PI/180,t[1]*Math.PI/180]},u.a.Point3d.prototype.clone=function(){return(new u.a.Point3d).fromCartesian(this.point.clone())},u.a.Point3d.prototype.equal=function(t){return t instanceof u.a.Point3d&&(this.point.x==t.point.x&&this.point.y==t.point.y&&this.point.z==t.point.z)},u.a.Point3d.prototype.union=function(t){if(t instanceof u.a.Point3d){var e=new Point3dCollection;return e.addPoint3d(this),e.addPoint3d(t),e}};u.a.Point3d;u.a.Element=function(t){u.a.Object.call(this,t)},u.a.Element.prototype.type="Element",u.a.Element.prototype.show=function(){Array.isArray(this.instance)?this.instance.forEach((function(t){t.show=!0})):this.instance.show=!0},u.a.Element.prototype.hide=function(){Array.isArray(this.instance)?this.instance.forEach((function(t){t.show=!1})):this.instance.show=!1},u.a.Element.prototype.export=function(){if(this.config){for(var t in this.config)this.config[t].curValue=this[t]||this.config[t].default;return this.config.type=this.type,this.config}return null},u.a.Element.prototype.focus=function(t){var e=this;t=t||{};var n=e.config.trace instanceof u.a.Point3dCollection?e.config.trace:e.config.trace&&e.config.trace.default instanceof u.a.Point3dCollection?e.config.trace.default:void 0;return this.position instanceof u.a.Point3d?(t.position=this.position,_sf3d.camera.focusOnPoint(t)):this.trace instanceof u.a.Point3dCollection?(t.boundingSphere=this.trace.exportBoundingSphere(),_sf3d.camera.focusOnSphere(t)):n?(t.boundingSphere=n.exportBoundingSphere(),_sf3d.camera.focusOnSphere(t)):Array.isArray(this.traces)?(t.boundingSphere=u.a.Point3dCollection.union(this.traces).exportBoundingSphere(),_sf3d.camera.focusOnSphere(t)):Array.isArray(this.config.traces)?(t.boundingSphere=u.a.Point3dCollection.union(this.config.traces).exportBoundingSphere(),_sf3d.camera.focusOnSphere(t)):Array.isArray(this.config.traces&&this.config.traces.default)?(t.boundingSphere=u.a.Point3dCollection.union(this.config.traces.default).exportBoundingSphere(),_sf3d.camera.focusOnSphere(t)):null},u.a.Element.prototype.applyTag=function(t){var e=this;Array.isArray(this.instance)?this.instance.forEach((function(n){n.tag=t,n.sf3dObject=e})):this.instance&&(this.instance.tag=t,this.instance.sf3dObject=e)},u.a.Element.prototype.destroy=function(){var t=function(t){t instanceof u.a.Object?t.destroy():function t(e){e&&(e instanceof Cesium.Primitive||e instanceof Cesium.Cesium3DTileset||e instanceof Cesium.PointPrimitiveCollection||e instanceof Cesium.BillboardCollection||e instanceof Cesium.LabelCollection||e instanceof Cesium.ParticleSystem||e instanceof Cesium.ClassificationPrimitive?_cesium.scene.primitives.remove(e):e instanceof Cesium.Entity?_cesium.entities.removeById(e.id):e instanceof Cesium.GroundPrimitive||e instanceof Cesium.GroundPolylinePrimitive?_cesium.scene.groundPrimitives.remove(e):e instanceof Array?e.forEach((function(e){t(e)})):e instanceof u.a.Element||e.xbsjGuid?e.destroy():_cesium.scene.primitives.remove(e))}(t)};Array.isArray(this.instance)?this.instance.forEach((function(e){t(e)})):t(this.instance),this.viewer=null,this.earthsdk=null,this.map3d=null};u.a.Element;var pt=n(7);u.a.Point3dCollection=function(t){u.a.Object.call(this,t);var e=this;this.points=[],Object.defineProperty(this,"size",{get:function(){return e.points.length},enumerable:!0}),this.dtype=u.a.PointCollectionType.Points,this.holes=[]},u.a.Point3dCollection.prototype.type="Point3dCollection",u.a.Point3dCollection.prototype.fromLngLatHeightArray=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e+=3){var n=(new u.a.Point3d).fromLngLat(t[e],t[e+1],t[e+2]);this.addPoint3d(n)}return this},u.a.Point3dCollection.prototype.cut=function(t,e){var n=[];this.points.forEach((function(i,r){r>=t&&r<e&&n.push(i)}));var i=new u.a.Point3dCollection;return i.points=n,i},u.a.Point3dCollection.prototype.fromLngLatArray=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e+=2){var n=(new u.a.Point3d).fromLngLat(t[e],t[e+1],0);this.addPoint3d(n)}return this},u.a.Point3dCollection.prototype.fromRadianHeightArray=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e+=3){var n=(new u.a.Point3d).fromLngLat(180*t[e]/Math.PI,180*t[e+1]/Math.PI,t[e+1]);this.addPoint3d(n)}return this},u.a.Point3dCollection.prototype.fromRadianArray=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e+=2){var n=(new u.a.Point3d).fromLngLat(180*t[e]/Math.PI,180*t[e+1]/Math.PI,0);this.addPoint3d(n)}return this},u.a.Point3dCollection.prototype.removeByIndex=function(t){return Array.isArray(this.points)&&this.points.splice(t,1),this},u.a.Point3dCollection.prototype.removeById=function(t){var e=this.points.findIndex((function(e){return e.id==t}));return e>=0&&Array.isArray(this.points)&&this.points.splice(e,1),this},u.a.Point3dCollection.prototype.addPoint3d=function(t){return t instanceof u.a.Point3d&&(this.points||(this.points=[]),this.points.push(t)),this},u.a.Point3dCollection.prototype.getByIndex=function(t){return this.points[t]},u.a.Point3dCollection.prototype.setByIndex=function(t,e){this.points[t]=e.point},u.a.Point3dCollection.prototype.getById=function(t){if(Array.isArray(this.points))return this.points.find((function(e){return e.id==t}))},u.a.Point3dCollection.prototype.forEach=function(t){this.points.forEach((function(e,n){return t(e,n)}))},u.a.Point3dCollection.prototype.map=function(t){return this.points.map(t)},u.a.Point3dCollection.prototype.reverse=function(){return this.points.reverse(),this},u.a.Point3dCollection.prototype.exportRadianHeightArray=function(){var t=[];return Array.isArray(this.points)&&this.points.forEach((function(e){t=t.concat(e.exportRadianHeightArray())})),t},u.a.Point3dCollection.prototype.exportRadianArray=function(){var t=[];return Array.isArray(this.points)&&this.points.forEach((function(e){t=t.concat(e.exportRadianArray())})),t},u.a.Point3dCollection.prototype.exportLngLatArray=function(){var t=[];return Array.isArray(this.points)&&this.points.forEach((function(e){t=t.concat(e.exportLngLatArray())})),t},u.a.Point3dCollection.prototype.exportLnglatHeightArray=function(){var t=[];return Array.isArray(this.points)&&this.points.forEach((function(e){t=t.concat(e.exportLngLatHeightArray())})),t},u.a.Point3dCollection.prototype.exportCartesianArray=function(t){var e=[];if(t)for(var n=this.points.length-1;n>=0;n--)e=e.concat(this.points[n].exportCartesian());else Array.isArray(this.points)&&this.points.forEach((function(t){e=e.concat(t.exportCartesian())}));return e},u.a.Point3dCollection.prototype.exportCartesianArrayWithoutHeight=function(){var t=[];return Array.isArray(this.points)&&this.points.forEach((function(e){var n,i=e.exportLngLatArray();t=t.concat((n=Cesium.Cartesian3).fromDegrees.apply(n,h()(i)))})),t},u.a.Point3dCollection.prototype.applyHeight=function(t){var e=this;return Array.isArray(this.points)&&this.points.forEach((function(n,i){var r,o=n.exportLngLatArray();e.points[i]=(r=new u.a.Point3d).fromLngLat.apply(r,h()(o).concat([t]))})),this},u.a.Point3dCollection.prototype.clone=function(){var t=new u.a.Point3dCollection;return this.points.forEach((function(e){t.addPoint3d(e.clone())})),t},u.a.Point3dCollection.prototype.isPointInside=function(t){try{var e=this.points;e[0].equal(e[e.length-1])||(e=this.points.concat(e[0]));var n=pt.point(t.exportLngLatArray()),i=[];e.forEach((function(t){i.push(t.exportLngLatArray())}));var r=pt.polygon([i]);return pt.booleanPointInPolygon(n,r)}catch(t){return console.warn(t),!1}},u.a.Point3dCollection.prototype.exportBoundingSphere=function(){return Cesium.BoundingSphere.fromPoints(this.exportCartesianArray())},u.a.Point3dCollection.prototype.exportCenter=function(){var t=[];if(this.size>=2){var e;this.points.forEach((function(e){t.push(pt.point(e.exportLngLatArray()))}));var n=pt.center(pt.featureCollection(t));return(e=new u.a.Point3d).fromLngLat.apply(e,h()(n.geometry.coordinates))}if(1==this.size)return(new u.a.Point3d).fromCartesian(this.points[0])},u.a.Point3dCollection.prototype.getBounds=function(){try{var t=this.exportLngLatArray(),e=[],n=[];return t.forEach((function(t,i){i%2==0?e.push(t):n.push(t)})),{max:(new u.a.Point3d).fromLngLat(Math.max.apply(Math,e),Math.max.apply(Math,n)),min:(new u.a.Point3d).fromLngLat(Math.min.apply(Math,e),Math.min.apply(Math,n))}}catch(t){return null}},u.a.Point3dCollection.prototype.getArea=function(){var t=0;if(this.points){var e=[];this.points.forEach((function(t){e.push(t.exportLngLatArray())}));var n=e.length-1;e[n][0]==e[0][0]&&e[n][1]==e[0][1]||e.push([e[0][0],e[0][1]]);var i=pt.polygon([e]);t=pt.area(i)}return t},u.a.Point3dCollection.prototype.scale=function(t){if(this.points){var e=[];this.points.forEach((function(t){e.push(t.exportLngLatHeightArray())})),this.points[0].equal(this.points[this.points.length-1])||e.push(this.points[0].exportLngLatHeightArray());var n=pt.polygon([e]),i=pt.transformScale(n,isNaN(t)?1:t),r=null;i&&(r=new u.a.Point3dCollection,i.geometry.coordinates[0].forEach((function(t){var e;r.addPoint3d((e=new u.a.Point3d).fromLngLat.apply(e,h()(t)))})))}return r},u.a.Point3dCollection.union=function(t){var e=null;return Array.isArray(t)&&(e=new u.a.Point3dCollection,t.forEach((function(t){t&&t instanceof u.a.Point3dCollection&&t.forEach((function(t){e.addPoint3d(t)}))}))),e},u.a.Point3dCollection.genCircle=function(t){var e=null;try{if(t.center instanceof u.a.Point3d){var n=pt.circle(t.center.exportLngLatArray(),t.radius,{steps:isNaN(t.steps)?64:t.steps,units:"kilometers"});n&&(e=new u.a.Point3dCollection,n.geometry.coordinates[0].forEach((function(t){var n;e.addPoint3d((n=new u.a.Point3d).fromLngLat.apply(n,h()(t)))})))}}catch(t){}return e};u.a.Point3dCollection,n(170);var ft=n(35),dt=n.n(ft),gt=n(5),yt=n.n(gt),mt=function(t){return document.getElementById(t||"toolTip-"+_sf3d.container.getAttribute("id"))},_t=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(t.map3d||_sf3d).container,n=mt("toolTip-"+e.getAttribute("id"));if(n){n.style.display="block";var i=e.getBoundingClientRect();if(t.position){var r=t.offset||[10,20];n.style.left=t.position[0]+r[0]+i.x+"px",n.style.top=t.position[1]+r[1]+i.y+"px"}t.content&&(n.innerHTML=t.content)}},vt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=mt("toolTip-"+(t.map3d||_sf3d).container.getAttribute("id"));e&&(e.style.display="none",e.innerHTML="",e.style.left="0px",e.style.top="0px")},xt={POINT:"point",POLYLINE:"polyline",POLYGON:"polygon",EXTRUDEDPOLYGON:"extrudedpolygon",CIRCLE:"circle",RECTANGLE:"rectangle"};u.a.MarkTool=function(t,e){var n=this,i=t.viewer,r=new Cesium.ScreenSpaceEventHandler(i.scene.canvas),o=e||{},a=[],l=[],c=[],p=[],f=[],d=[],g=[],y={},m=[],_=null,v=null,x=null,C=function(t,e){for(var n=m.length-1;n>=0;n--)m[n]===t&&m.splice(n,1);e&&i.entities.remove(t)},w=function(){for(;m.length>0;)i.entities.remove(m.pop())};this.config={pointColor:{name:"点颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,0,0,1)},pointSize:{name:"点尺寸",type:u.a.PropertyType.Float,default:5},lineColor:{name:"线颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,0,0,.5)},lineWidth:{name:"线宽",type:u.a.PropertyType.Float,default:3},areaColor:{name:"面颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,0,0,.5)}};var b=o.pointColor instanceof u.a.Color?o.pointColor:this.config.pointColor.default;Object.defineProperty(this,"pointColor",{get:function(){return b},set:function(t){t instanceof u.a.Color&&(b=t,a.filter((function(t){return t.point})).forEach((function(t){t.point.color=b.color,t.point.outlineColor=b.color})))},enumerable:!0});var E=isNaN(o.pointSize)?this.config.pointSize.default:o.pointSize;Object.defineProperty(this,"pointSize",{get:function(){return E},set:function(t){isNaN(t)||(E=t,a.filter((function(t){return t.point})).forEach((function(t){t.point.pixelSize=E})))},enumerable:!0});var I=o.lineColor instanceof u.a.Color?o.lineColor:this.config.lineColor.default;Object.defineProperty(this,"lineColor",{get:function(){return I},set:function(t){t instanceof u.a.Color&&(I=t,a.filter((function(t){return t.polyline})).forEach((function(t){t.polyline.material=I.color})))},enumerable:!0});var P=isNaN(o.lineWidth)?this.config.lineWidth.default:o.lineWidth;Object.defineProperty(this,"lineWidth",{get:function(){return P},set:function(t){isNaN(t)||(P=t,a.filter((function(t){return t.polyline})).forEach((function(t){t.polyline.width=P})))},enumerable:!0});var N=o.areaColor instanceof u.a.Color?o.areaColor:this.config.areaColor.default;Object.defineProperty(this,"areaColor",{get:function(){return N},set:function(t){t instanceof u.a.Color&&(N=t,a.filter((function(t){return t.polygon||t.ellipse})).forEach((function(t){t.polygon&&(t.polygon.material=N.color),t.ellipse&&(t.ellipse.material=N.color)})))},enumerable:!0});var S=new Cesium.EllipsoidGeodesic;function T(t,e,n,i){switch(this.tag){case xt.EXTRUDEDPOLYGON:if("height"===e){var r=this.polygon.hierarchy.getValue().positions.map((function(t){return Cesium.Cartographic.fromCartesian(t).height})).max();this.polygon.extrudedHeight=r+n.getValue()}}}this.startDrawPoint=function(){n.finish(!0),u.a.Util.beforePickingPosition(i),r=new Cesium.ScreenSpaceEventHandler(i.scene.canvas),n.emit({type:"onStartDrawPoint"});var e=null;document.body.style.cursor="cross";var o=[];r.setInputAction((function(e){_t({map3d:t,position:[e.endPosition.x,e.endPosition.y],content:"<p>左键绘制</p><p>右键结束</p>"})}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),r.setInputAction((function(t){document.onmousemove=null;var r=Ct({x:t.position.x,y:t.position.y,relative:!0,wholeScene:!0}),s=u.a.Util.guid();r&&(r._draw_id_=s,l.push(r),o.push(r),(e=i.entities.add({id:s,position:r.exportCartesian(),point:{color:b.color,pixelSize:E}})).tag=xt.POINT,a.push(e)),n.emit({type:"onAddPoint",data:r})}),Cesium.ScreenSpaceEventType.LEFT_CLICK),r.setInputAction((function(){r.destroy(),vt({map3d:t}),document.body.style.cursor="default";var e=new u.a.Point3dCollection;o.forEach((function(t){e.addPoint3d(t)})),n.emit({type:"onPointsDrawn",data:e,drawId:o.map((function(t){return t._draw_id_}))}),u.a.Util.afterPickPosition(i)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.startDrawPolyline=function(e){var o=e=s()({clampToGround:!1,heightReference:Cesium.HeightReference.NONE},e||{}),l=(o.rclickFinish,o.rclickAddPoint,o.dblclickFinish),p=void 0===l||l;o.dblclickAddPoint;n.finish(!0),u.a.Util.beforePickingPosition(i),r=new Cesium.ScreenSpaceEventHandler(i.scene.canvas),n.emit({type:"onStartDrawPolyline"});var f=[],d=null,g=null,y=[];document.body.style.cursor="cross";var _=e.num||0,v=u.a.Util.guid();r.setInputAction((function(e){if(_t({map3d:t,position:[e.endPosition.x,e.endPosition.y],content:f.length>=6?"<p>左键绘制</p><p>右键结束</p>":"<p>左键绘制</p><p>右键取消</p>"}),f.length>=3){var n=Ct({x:e.endPosition.x,y:e.endPosition.y,relative:!0,wholeScene:!0});n&&(y=n.exportLngLatHeightArray())}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),r.setInputAction((function(t){document.onmousemove=null;var o,s=Ct({x:t.position.x,y:t.position.y,relative:!0,wholeScene:!0});if(s)if(0==f.length)(o=f).push.apply(o,h()(s.exportLngLatHeightArray())),g=i.entities.add({position:s.exportCartesian(),point:{color:b.color,pixelSize:E}}),m.push(g),d=i.entities.add({id:v,polyline:{positions:new Cesium.CallbackProperty((function(){return d&&d.hasConfirm?Cesium.Cartesian3.fromDegreesArrayHeights(f):Cesium.Cartesian3.fromDegreesArrayHeights(f.concat(y))}),!1),material:I.color,width:P,clampToGround:!!e.clampToGround,classificationType:e.classificationType}}),m.push(d);else if(f.length>=3){var l;if((l=f).push.apply(l,h()(s.exportLngLatHeightArray())),C(g,!0),_>1&&f.length>=3*_){r.destroy(),d.hasConfirm=!0,d.polyline.positions=Cesium.Cartesian3.fromDegreesArrayHeights(f),d.tag=xt.POLYLINE,C(d,!1),a.push(d),c.push(f.concat([])),c[c.length-1]._draw_id_=v;var p=(new u.a.Point3dCollection).fromLngLatHeightArray(f);f=[],document.body.style.cursor="default",n.emit({type:"onPolylineDrawn",data:p,drawingEntities:[g,d],drawId:v}),u.a.Util.afterPickPosition(i)}}n.emit({type:"onAddPoint",data:s})}),Cesium.ScreenSpaceEventType.LEFT_CLICK),r.setInputAction((function(e){if(p){r.destroy(),0==f.length||(3==f.length?(C(g,!0),C(d,!0)):(d.hasConfirm=!0,d.polyline.positions=Cesium.Cartesian3.fromDegreesArrayHeights(f),d.tag=xt.POLYLINE,a.push(d),C(d,!1),c.push(f.concat([]))));var o=(new u.a.Point3dCollection).fromLngLatHeightArray(f);f=[],vt({map3d:t}),document.body.style.cursor="default",n.emit({type:"onPolylineDrawn",data:o,drawingEntities:[g,d],drawId:v}),u.a.Util.afterPickPosition(i)}}),Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),r.setInputAction((function(){r.destroy(),0==f.length||(3==f.length?(C(g,!0),C(d,!0)):(d.hasConfirm=!0,d.polyline.positions=Cesium.Cartesian3.fromDegreesArrayHeights(f),d.tag=xt.POLYLINE,a.push(d),C(d,!1),c.push(f.concat([])),c[c.length-1]._draw_id_=v));var e=(new u.a.Point3dCollection).fromLngLatHeightArray(f);f=[],vt({map3d:t}),document.body.style.cursor="default",n.emit({type:"onPolylineDrawn",data:e,drawingEntities:[g,d],drawId:v}),u.a.Util.afterPickPosition(i)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.startDrawPolygon=function(e){var o=e=s()({clampToGround:!1,heightReference:Cesium.HeightReference.NONE},e||{}),l=(o.rclickFinish,o.rclickAddPoint,o.dblclickFinish),c=void 0===l||l;o.dblclickAddPoint;n.finish(!0),u.a.Util.beforePickingPosition(i),r=new Cesium.ScreenSpaceEventHandler(i.scene.canvas),n.emit({type:"onStartDrawPolygon"});var f=[],d=[],g=null,y=null;document.body.style.cursor="cross";var _=u.a.Util.guid();r.setInputAction((function(e){if(_t({map3d:t,position:[e.endPosition.x,e.endPosition.y],content:f.length>=9?"<p>左键绘制</p><p>右键结束</p>":"<p>左键绘制</p><p>右键取消</p>"}),f.length>=3){var n=Ct({x:e.endPosition.x,y:e.endPosition.y,relative:!0,wholeScene:!0});n&&(d=n.exportLngLatHeightArray())}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),r.setInputAction((function(t){document.onmousemove=null;var r,o=Ct({x:t.position.x,y:t.position.y,relative:!0,wholeScene:!0});if(o)if(0==f.length)(r=f).push.apply(r,h()(o.exportLngLatHeightArray())),g=i.entities.add({position:f[f.length-1],polyline:{positions:new Cesium.CallbackProperty((function(){return Cesium.Cartesian3.fromDegreesArrayHeights(f.concat(d))}),!1),material:I.color,width:P,clampToGround:!!e.clampToGround,classificationType:e.classificationType}}),m.push(g);else if(3==f.length){var s;(s=f).push.apply(s,h()(o.exportLngLatHeightArray())),y=i.entities.add({id:_,polygon:{hierarchy:new Cesium.CallbackProperty((function(){return y&&y.hasConfirm?new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(f)):new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(f.concat(d)))}),!1),perPositionHeight:!0!==e.clampToGround,material:N.color,classificationType:e.classificationType,heightReference:e.heightReference}}),m.push(y),C(g,!0)}else{var a;(a=f).push.apply(a,h()(o.exportLngLatHeightArray())),f[f.length-1]=0}n.emit({type:"onAddPoint",data:o})}),Cesium.ScreenSpaceEventType.LEFT_CLICK),r.setInputAction((function(e){if(c){r.destroy(),0==f.length||(3==f.length?C(g,!0):6==f.length?C(y,!0):(p.push(f.concat([])),p[p.length-1]._draw_id_=_,y.hasConfirm=!0,y.polygon.hierarchy=new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(f)),y.tag=xt.POLYGON,a.push(y),C(y,!1)));var o=(new u.a.Point3dCollection).fromLngLatHeightArray(f);f=[],vt({map3d:t}),document.body.style.cursor="default",n.emit({type:"onPolygonDrawn",data:o,drawId:_}),u.a.Util.afterPickPosition(i)}}),Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),r.setInputAction((function(e){r.destroy(),0==f.length||(3==f.length?C(g,!0):6==f.length?C(y,!0):(p.push(f.concat([])),p[p.length-1]._draw_id_=_,y.hasConfirm=!0,y.polygon.hierarchy=new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(f)),y.tag=xt.POLYGON,a.push(y),C(y,!1)));var o=(new u.a.Point3dCollection).fromLngLatHeightArray(f);f=[],vt({map3d:t}),document.body.style.cursor="default",n.emit({type:"onPolygonDrawn",data:o,drawId:_}),u.a.Util.afterPickPosition(i)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.startDrawCircle=function(e){o=s()({clampToGround:void 0!==e&&void 0!==e.clampToGround&&e.clampToGround,heightReference:Cesium.HeightReference.NONE},o||{},{showRadius:void 0!==e&&void 0!==e.showRadius&&e.showRadius}),n.finish(!0),u.a.Util.beforePickingPosition(i),r=new Cesium.ScreenSpaceEventHandler(i.scene.canvas),n.emit({type:"onStartDrawCircle"});var l=null,c=null,h=null;document.body.style.cursor="cross";var p=u.a.Util.guid();r.setInputAction((function(e){var n=0;if(l){var i=Ct({x:e.endPosition.x,y:e.endPosition.y,relative:!0,wholeScene:!0});i&&(h=i.exportCartesian(),n=L(c,h),l.ellipse.semiMajorAxis.setValue(n),l.ellipse.semiMinorAxis.setValue(n)),_t({map3d:t,position:[e.endPosition.x,e.endPosition.y],content:"<p>半径："+n.toFixed(0)+"米</p><p>单击左键或右键结束</p>"})}else _t({map3d:t,position:[e.endPosition.x,e.endPosition.y],content:"<p>左键绘制圆心</p><p>右键取消</p>"})}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),r.setInputAction((function(e){document.onmousemove=null;var s=Ct({x:e.position.x,y:e.position.y,relative:!0,wholeScene:!0});if(s){if(l){h=s.exportCartesian();var f=L(c,h);if(o.showRadius){var g=[];g.push(c),g.push(h),v=new Cesium.Entity({id:p+"cc",position:c,point:{pixelSize:5,color:b.color,clampToGround:o.clampToGround,outlineColor:b.color,outlineWidth:5}}),_=new Cesium.Entity({id:p+"cl",show:!0,name:"线",polyline:{positions:g,width:4,material:I.color,clampToGround:o.clampToGround}});var y=Math.round(f)+"米";(x=new Cesium.Entity({id:p+"cla",position:h,label:{disableDepthTestDistance:1e3,text:y}})).label.scale=1,x.label.showBackground=!0,_cesium.entities.add(_),_cesium.entities.add(v),_cesium.entities.add(x),a.push(_),a.push(v),a.push(x)}else;l.ellipse.semiMajorAxis.setValue(f),l.ellipse.semiMinorAxis.setValue(f),l=null;var m={center:(new u.a.Point3d).fromCartesian(c),point:(new u.a.Point3d).fromCartesian(h),radius:f};d.push(m),d[d.length-1]._draw_id_=p,n.emit({type:"onCircleDrawn",data:m,drawId:p}),vt({map3d:t}),document.body.style.cursor="default",u.a.Util.afterPickPosition(i),r.destroy()}else c=s.exportCartesian(),h=s.exportCartesian().clone(),(l=i.entities.add({id:p,position:c,ellipse:{semiMajorAxis:1e-4,semiMinorAxis:1e-4,material:N.color,classificationType:o.classificationType,heightReference:o.heightReference}})).tag=xt.CIRCLE,a.push(l);n.emit({type:"onAddPoint",data:s})}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),r.setInputAction((function(e){if(r.destroy(),vt({map3d:t}),l){var s=Ct({x:e.position.x,y:e.position.y,relative:!0,wholeScene:!0});if(s){h=s.exportCartesian();var f=L(c,h);if(o.showRadius){var g=[];g.push(c),g.push(h),v=new Cesium.Entity({id:p+"cc",position:c,point:{pixelSize:5,color:b.color,clampToGround:o.clampToGround,outlineColor:b.color,outlineWidth:5}}),_=new Cesium.Entity({id:p+"cl",show:!0,name:"线",polyline:{positions:g,width:4,material:I.color,clampToGround:o.clampToGround}});var y=Math.round(f)+"米";(x=new Cesium.Entity({id:p+"cla",position:h,label:{disableDepthTestDistance:1e3,text:y}})).label.scale=1,x.label.showBackground=!0,_cesium.entities.add(_),_cesium.entities.add(v),_cesium.entities.add(x),a.push(_),a.push(v),a.push(x)}else;l.ellipse.semiMajorAxis.setValue(f),l.ellipse.semiMinorAxis.setValue(f),l=null;var m={center:(new u.a.Point3d).fromCartesian(c),point:(new u.a.Point3d).fromCartesian(h),radius:f};d.push(m),n.emit({type:"onCircleDrawn",data:m,drawId:p}),document.body.style.cursor="default",u.a.Util.afterPickPosition(i)}}}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.startDrawRectangle=function(e){e=s()({clampToGround:!1,heightReference:Cesium.HeightReference.NONE},e||{}),n.finish(!0),u.a.Util.beforePickingPosition(i),r=new Cesium.ScreenSpaceEventHandler(i.scene.canvas),n.emit({type:"onStartDrawRectangle"});var o=null,l=null,c=null;document.body.style.cursor="cross";var h=u.a.Util.guid();r.setInputAction((function(e){if(o){var n=Ct({x:e.endPosition.x,y:e.endPosition.y,relative:!0,wholeScene:!0});n&&(c=n),_t({map3d:t,position:[e.endPosition.x,e.endPosition.y],content:"<p>单击左键或右键结束</p>"})}else _t({map3d:t,position:[e.endPosition.x,e.endPosition.y],content:"<p>左键绘制</p><p>右键取消</p>"})}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),r.setInputAction((function(s){document.onmousemove=null;var p=Ct({x:s.position.x,y:s.position.y,relative:!0,wholeScene:!0});if(p){if(o){c=p,o=null;var f=l.exportRadianArray(),d=yt()(f,2),y=d[0],m=d[1],_=c.exportRadianArray(),v=yt()(_,2),x=v[0],C=v[1],w=y<=x?[y,x]:[x,y],b=yt()(w,2),E=b[0],I=b[1],P=m<=C?[m,C]:[C,m],S=yt()(P,2),T=S[0],L=S[1],M={start:l,end:c,points:(new u.a.Point3dCollection).fromRadianHeightArray([E,T,0,E,L,0,I,L,0,I,T,0])};g.push(M),g[g.length-1]._draw_id_=h,n.emit({type:"onRectangleDrawn",data:M,drawId:h}),vt({map3d:t}),document.body.style.cursor="default",u.a.Util.afterPickPosition(i),r.destroy()}else l=p,c=p.clone(),(o=i.entities.add({id:h,rectangle:{coordinates:new Cesium.CallbackProperty((function(){var t=l.exportRadianArray(),e=yt()(t,2),n=e[0],i=e[1],r=c.exportRadianArray(),o=yt()(r,2),s=o[0],a=o[1],u=n<=s?[n,s]:[s,n],h=yt()(u,2),p=h[0],f=h[1],d=i<=a?[i,a]:[a,i],g=yt()(d,2),y=g[0],m=g[1];return new Cesium.Rectangle(p,y,f,m)}),!1),material:N.color,classificationType:e.classificationType,heightReference:e.heightReference}})).tag=xt.RECTANGLE,a.push(o);n.emit({type:"onAddPoint",data:p})}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),r.setInputAction((function(e){if(r.destroy(),vt({map3d:t}),o){var s=Ct({x:e.position.x,y:e.position.y,relative:!0,wholeScene:!0});if(s){c=s,o=null;var a=l.exportRadianArray(),p=yt()(a,2),f=p[0],d=p[1],y=c.exportRadianArray(),m=yt()(y,2),_=m[0],v=m[1],x=f<=_?[f,_]:[_,f],C=yt()(x,2),w=C[0],b=C[1],E=d<=v?[d,v]:[v,d],I=yt()(E,2),P=I[0],N=I[1],S={start:l,end:c,points:(new u.a.Point3dCollection).fromRadianHeightArray([w,P,0,w,N,0,b,N,0,b,P,0])};g.push(S),g[g.length-1]._draw_id_=h,n.emit({type:"onRectangleDrawn",data:S,drawId:h}),document.body.style.cursor="default",u.a.Util.afterPickPosition(i)}}}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.startDrawExtrudedPolygon=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{height:100};e||(e={});var o=e,s=(o.rclickFinish,o.rclickAddPoint,o.dblclickFinish),l=void 0===s||s;o.dblclickAddPoint;n.finish(!0),u.a.Util.beforePickingPosition(i),r=new Cesium.ScreenSpaceEventHandler(i.scene.canvas),n.emit({type:"onStartDrawExtrudedPolygon"});var c=[],p=dt.a,d=[],g=null,_=null;document.body.style.cursor="cross";var v=u.a.Util.guid();r.setInputAction((function(e){if(_t({map3d:t,position:[e.endPosition.x,e.endPosition.y],content:c.length>=9?"<p>左键绘制</p><p>右键结束</p>":"<p>左键绘制</p><p>右键取消</p>"}),c.length>=3){var n=Ct({x:e.endPosition.x,y:e.endPosition.y,relative:!0,wholeScene:!0});n&&(d=n.exportLngLatHeightArray())}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),r.setInputAction((function(t){document.onmousemove=null;var r,o=Ct({x:t.position.x,y:t.position.y,relative:!0,wholeScene:!0});if(o)if(p=Math.max(p,o.height),0==c.length)(r=c).push.apply(r,h()(o.exportLngLatHeightArray())),g=i.entities.add({position:c[c.length-1],polyline:{positions:new Cesium.CallbackProperty((function(){return Cesium.Cartesian3.fromDegreesArrayHeights(c.concat(d))}),!1),material:I.color,width:P,clampToGround:!!e.clampToGround}}),m.push(g);else if(3==c.length){var s;(s=c).push.apply(s,h()(o.exportLngLatHeightArray())),_=i.entities.add({id:v,polygon:{hierarchy:new Cesium.CallbackProperty((function(){return _&&_.hasConfirm?new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(c)):new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(c.concat(d)))}),!1),outline:!0,outlineColor:I.color,outlineWidth:P,clampToGround:!1,perPositionHeight:!0,extrudedHeight:new Cesium.CallbackProperty((function(){return p+e.height}),!1),extrudedHeightReference:Cesium.HeightReference.NONE,material:N.color}}),m.push(_),C(g,!0)}else{var a;(a=c).push.apply(a,h()(o.exportLngLatHeightArray()))}n.emit({type:"onAddPoint",data:o})}),Cesium.ScreenSpaceEventType.LEFT_CLICK),r.setInputAction((function(o){if(l){if(r.destroy(),0==c.length);else if(3==c.length)C(g,!0);else if(6==c.length)C(_,!0);else{var s={points:(new u.a.Point3dCollection).fromLngLatHeightArray(c),height:e.height};f.push(s),f[f.length-1]._draw_id_=v,_.hasConfirm=!0,_.polygon.hierarchy=new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(c)),_.polygon.extrudedHeight=p+e.height,_.tag=xt.EXTRUDEDPOLYGON,_.properties={height:e.height},y[v]=_.properties.definitionChanged.addEventListener(T,_),a.push(_),C(_,!1),n.emit({type:"onExtrudedPolygonDrawn",data:s,drawId:v})}c=[],vt({map3d:t}),document.body.style.cursor="default",u.a.Util.afterPickPosition(i)}}),Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),r.setInputAction((function(o){if(r.destroy(),0==c.length);else if(3==c.length)C(g,!0);else if(6==c.length)C(_,!0);else{var s={points:(new u.a.Point3dCollection).fromLngLatHeightArray(c),height:e.height};f.push(s),f[f.length-1]._draw_id_=v,_.hasConfirm=!0,_.polygon.hierarchy=new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(c)),_.polygon.extrudedHeight=p+e.height,_.tag=xt.EXTRUDEDPOLYGON,_.properties={height:e.height},y[v]=_.properties.definitionChanged.addEventListener(T,_),a.push(_),C(_,!1),n.emit({type:"onExtrudedPolygonDrawn",data:s,drawId:v})}c=[],vt({map3d:t}),document.body.style.cursor="default",u.a.Util.afterPickPosition(i)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)};var L=function(t,e){var n=Cesium.Cartographic.fromCartesian(t),i=Cesium.Cartographic.fromCartesian(e);return n&&i?(S.setEndPoints(n,i),S.surfaceDistance):0};this.finish=function(e){w(),vt({map3d:t}),u.a.Util.afterPickPosition(i),r&&(r.destroy(),r=null,e||n.emit({type:"onFinish"}))},this.clear=function(e){a&&a.forEach((function(t){y[t.id]&&y[t.id](),delete y[t.id],_cesium.entities.remove(t)})),a=[],l=[],c=[],p=[],d=[],g=[],u.a.Util.afterPickPosition(i),w(),vt({map3d:t}),r&&(r.destroy(),r=null,e||n.emit({type:"onClear"}))},this.destroy=function(){r&&r.destroy(),n.clear(),n.finish(),n.emit({type:"onDestroy"})},this.exportResult=function(){var t=new u.a.Point3dCollection;l.forEach((function(e){t.addPoint3d(e)}));var e=[];c.forEach((function(t){e.push((new u.a.Point3dCollection).fromLngLatHeightArray(t))}));var n=[];p.forEach((function(t){n.push((new u.a.Point3dCollection).fromLngLatHeightArray(t))}));var i=[];return f.forEach((function(t){i.push((new u.a.Point3dCollection).fromLngLatHeightArray(t))})),{points:t,polylines:e,polygons:n,extrudedPolygons:i,circles:[].concat(h()(d)),rectangles:[].concat(h()(g))}},this.getDrawnResultById=function(t){return a.find((function(e){return e.id===t}))},this.getAllDrawnResults=function(){return a},this.removeDrawnResultById=function(t){a.find((function(e,n){return e.id===t&&(y[e.id]&&y[e.id](),delete y[e.id],_cesium.entities.removeById(e.id),e.ellipse?(_cesium.entities.removeById(e.id+"cc"),_cesium.entities.removeById(e.id+"cl"),_cesium.entities.removeById(e.id+"cla"),a.splice(n,4)):a.splice(n,1),!0)})),[l,c,p,f,d,g].forEach((function(e){e.find((function(n,i){return n._draw_id_===t&&(e.splice(i,1),!0)}))}))}},u.a.MarkTool.PlotTypes=xt;var Ct=function(t){var e=t.x,n=t.y,i=u.a.Util.pickCoord({x:e,y:n,relative:!0,wholeScene:!0});return i||(i=u.a.Util.pickCoord({x:e,y:n,relative:!0})),i};r()(u.a.MarkTool.prototype,u.a.EventManager.prototype);u.a.MarkTool;var wt=n(21),bt=n.n(wt),Et=n(115),It="position",Pt="angle",Nt="distance",St="clampdistance",Tt="area",Lt="projectedarea",Mt="height",Ot="verticalhorizontaldistances",Rt="projectedxyzdifferencing",At="pointtoline",Dt="arc",Ft="volume",kt=Math.PI/180,Bt=180/Math.PI,Gt=function(t){for(var e=0,n=0;n<t.length-2;n++){var i=(n+1)%t.length,r=(n+2)%t.length,o=zt(t[n],t[i],t[r]);e+=jt((new Sf3d.Point3d).fromLngLat(t[n].lon,t[n].lat,t[n].hei).exportCartesian(),(new Sf3d.Point3d).fromLngLat(t[i].lon,t[i].lat,t[i].hei).exportCartesian())*jt((new Sf3d.Point3d).fromLngLat(t[i].lon,t[i].lat,t[i].hei).exportCartesian(),(new Sf3d.Point3d).fromLngLat(t[r].lon,t[r].lat,t[r].hei).exportCartesian())*Math.abs(Math.sin(o))}return e},jt=function(t,e){var n=Cesium.Cartographic.fromCartesian(t),i=Cesium.Cartographic.fromCartesian(e),r=new Cesium.EllipsoidGeodesic;r.setEndPoints(n,i);var o=r.surfaceDistance;return o=Math.sqrt(Math.pow(o,2)+Math.pow(i.height-n.height,2))},zt=function(t,e,n){var i=Ut(e,t)-Ut(e,n);return i<0&&(i+=360),i>180&&(i=360-i),parseFloat(i.toFixed(2))},Ut=function(t,e){var n=t.lat*kt,i=t.lon*kt,r=e.lat*kt,o=e.lon*kt,s=-Math.atan2(Math.sin(i-o)*Math.cos(r),Math.cos(n)*Math.sin(r)-Math.sin(n)*Math.cos(r)*Math.cos(i-o));return s<0&&(s+=2*Math.PI),s*=Bt},qt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],i=document.createElement("div"),r=e.width||20,o=e.height||r;i.style.width=r+"px",i.style.height=o+"px",i.style.color="red",i.style.backgroundColor="rgba(0.165, 0.165, 0.165, 0.8)",i.style.cursor="pointer",i.onclick=n;var s=document.createElement("div");return s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.style.width="100%",s.style.height="16px",s.style.fontFamily="sans-serif",s.style.fontSize="24px",s.style.fontWeight="bold",s.innerHTML="&#215;",i.appendChild(s),new Sf3d.DomMarker({map3d:e.map3d,position:t,dom:i,farScale:1,offsetX:(e.offsetX||0)-r/2,offsetY:(e.offsetY||0)-o/2})},Vt=function(t){if(t.length<6)return!1;var e=t.slice(-3),n=t.slice(-6).slice(0,3);return void 0===e.find((function(t,e){return t!==n[e]}))&&(t.splice(t.length-3,3),!0)},Ht=function(t,e,n,i){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(t.tagLabel){i.entities.remove(t.tagLabel);var o=e.findIndex((function(e){return e===t.tagLabel}));o>=0&&e.splice(o,1),t.tagLabel=void 0}if(t.tagPoint){i.entities.remove(t.tagPoint);var s=e.findIndex((function(e){return e===t.tagPoint}));s>=0&&e.splice(s,1),t.tagPoint=void 0}if(t.labels&&t.labels.forEach((function(t){i.entities.remove(t)})),t.subs&&(t.subs.forEach((function(t){i.entities.remove(t)})),t.subs=void 0),t.dm&&(t.dm.destroy(),t.dm=void 0),r){var a=e.findIndex((function(e){return e===t}));a>=0&&e.splice(a,1)}i.entities.remove(t),delete n[t.id]};var Yt=function(t,e){var n=e.points[0],i=e.points[1],r=function(t,e,n){var i=n.lat-e.lat,r=e.lng-n.lng,o=n.lng*e.lat-e.lng*n.lat;return i*i+r*r<1e-13?e:Math.abs(i*t.lng+r*t.lat+o)<1e-13?t:{lng:(r*r*t.lng-i*r*t.lat-i*o)/(i*i+r*r),lat:(-i*r*t.lng+i*i*t.lat-r*o)/(i*i+r*r),height:t.height}}((new Sf3d.Point3d).fromLngLat(t.lng,t.lat,n.height),n,i),o=(new Sf3d.Point3d).fromLngLat(r.lng,r.lat,r.height);return{footPoint:(new Sf3d.Point3d).fromLngLat(r.lng,r.lat,r.height),distance:jt(t.exportCartesian(),o.exportCartesian())}},Xt=function(t){var e=t.points;if(!e||3!==e.length)return null;var n,i,r,o,s,a,l,u,c,p,f,d,g,y,m,_,v,x,C,w=function(t,e){var n=0;if(null==t||null==e)return 0;var i=Math.asin(Math.abs(parseFloat(e.y-t.y))/b(t,e));return e.y>=t.y&&e.x>=t.x?i+Math.PI:e.y>=t.y&&e.x<t.x?2*Math.PI-i:e.y<t.y&&e.x<t.x?i:(e.y<t.y&&e.x>=t.x&&(n=Math.PI-i),n)},b=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},E=function(t,e,n){var i=n*Math.cos(.017453292519943295*e),r=n*Math.sin(.017453292519943295*e);return new Cesium.Cartesian2(t.x+i,t.y+r)},I=[],P=new Cesium.Cartesian2;if(n=new(Function.prototype.bind.apply(Cesium.Cartesian2,[null].concat(h()(e[0].exportLngLatArray())))),i=new(Function.prototype.bind.apply(Cesium.Cartesian2,[null].concat(h()(e[1].exportLngLatArray())))),(r=new(Function.prototype.bind.apply(Cesium.Cartesian2,[null].concat(h()(e[2].exportLngLatArray())))))&&!Cesium.Cartesian2.equals(i,r)&&(a=-(i.x-n.x)/(i.y-n.y),l=-(r.x-i.x)/(r.y-i.y),u=(n.x+i.x)/2,c=(i.x+r.x)/2,p=(n.y+i.y)/2,f=(i.y+r.y)/2,P.x=(a*u-l*c+f-p)/(a-l),P.y=a*(P.x-u)+p,x=i,(C=w(v=P,n)-w(v,x))<0&&(C+=2*Math.PI),o=C,d=b(P,i),o>0||o<0))if(o=180*o/Math.PI,g=P,m=(y=i).x-g.x,_=y.y-g.y,s=0==m?_>0?90:-90:180*Math.atan2(_,m)/3.141592653589793,"right"==function(t,e,n){var i=(e.y-t.y)*(n.x-t.x)-(n.y-t.y)*(e.x-t.x);return i>0?"left":i<0?"right":null}(n,i,r))for(var N=s;N<=o+s;N++){var S=E(P,N,d);I.push(S)}else for(N=o+s;N<=s+360;N++){S=E(P,N,d);I.push(S)}return I.map((function(t){return[t.x,t.y,e[0].height]})).flat()},Wt=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"geojson";switch(n){case"geojson":return Kt(t,e);case"csv":var i=Zt(t,e);return i.map((function(t,e){return e>0&&(t[9]='"'+(t[9]||"")+'"',t[10]='"'+t[10]+'"',t[11]='"'+(t[11]||"")+'"'),t.join(",")})).join("\r\n")}};function Kt(t,e){return{type:"FeatureCollection",features:t.map((function(t){var n=null,i={type:t.tag},o=e[t.id],s=function(t){var e={};if(t.polygon){if(t.polygon.outline&&t.polygon.outline.getValue()){var n=t.polygon.outlineColor.getValue();n&&(e.stroke=n.toCssHexString().slice(0,7),e["stroke-opacity"]=n.alpha),t.polygon.outlineWidth&&t.polygon.outlineWidth.getValue()&&(e["stroke-width"]=t.polygon.outlineWidth.getValue())}if(t.polygon.material instanceof Cesium.ColorMaterialProperty&&t.polygon.material.getValue()){var i=t.polygon.material.getValue().color;e.fill=i.toCssHexString().slice(0,7),e["fill-opacity"]=i.alpha}}if(t.polyline){if(t.polyline.material instanceof Cesium.ColorMaterialProperty&&t.polyline.material.getValue()){var r=t.polyline.material.getValue().color;e.stroke=r.toCssHexString().slice(0,7),e["stroke-opacity"]=r.alpha}t.polyline.width&&t.polyline.width.getValue()&&(e["stroke-width"]=t.polyline.width.getValue())}if(t.point){if(t.point.color){var o=t.point.color.getValue();o&&(e.color=o.toCssHexString().slice(0,7),e.opacity=o.alpha)}t.point.pixelSize&&(e.size=t.point.pixelSize.getValue())}t.billboard;return e}(t);switch(r()(i,s),t.tag){case It:n={type:"Point",coordinates:o.exportLngLatHeightArray()};break;case Pt:n={type:"LineString",coordinates:o.map((function(t,e){return e%3==0&&o.slice(e,e+3)})).filter(Boolean)},i.angle=t.angle,i.unit="°";break;case Nt:n={type:"LineString",coordinates:o.map((function(t,e){return e%3==0&&o.slice(e,e+3)})).filter(Boolean)},i.distance=t.distance,i.distances=bt()(t.distances),i.unit="m";break;case St:n={type:"LineString",coordinates:o.map((function(t,e){return e%3==0&&o.slice(e,e+3)})).filter(Boolean)},i.distance=t.clampdistance,i.distances=bt()(t.clampdistances),i.unit="m";break;case Tt:case Lt:n={type:"Polygon",coordinates:[o.map((function(t,e){return e%3==0&&o.slice(e,e+3)})).filter(Boolean)]},i.area=t.area,i.unit="㎡";break;case Mt:n={type:"LineString",coordinates:o.map((function(t,e){return e%3==0&&o.slice(e,e+3)})).filter(Boolean)},i.distance=t.distances[0],i.unit="m";break;case Ot:n={type:"LineString",coordinates:o.map((function(t,e){return e%3==0&&o.slice(e,e+3)})).filter(Boolean)},i.vertical=t.distances[1],i.horizontal=t.distances[2],i.straight=t.distances[3],i.unit="m";break;case Rt:n={type:"LineString",coordinates:o.map((function(t,e){return e%3==0&&o.slice(e,e+3)})).filter(Boolean)},i.x=t.distances[4][0],i.y=t.distances[4][1],i.z=t.distances[4][2],i.unit="m";break;case At:n={type:"MultiLineString",coordinates:o.map((function(t){return t.map((function(e,n){return n%3==0&&t.slice(n,n+3)})).filter(Boolean)}))},i.distance=t.distance,i.unit="m",i.desc="MultiLineString:[[PointToMeasure, FootPointOnLine], [LineStartPoint, LineEndPoint]]";break;case Dt:n={type:"LineString",coordinates:o.map((function(t,e){return e%3==0&&o.slice(e,e+3)})).filter(Boolean)},i.distance=t.distance,i.unit="m";break;case Ft:n={type:"Polygon",coordinates:o.map((function(t,e){return e%3==0&&o.slice(e,e+3)})).filter(Boolean)},i.unit="m³"}return{type:"Feature",properties:i,geometry:n}}))}}function Zt(t,e){return[["type","angle","distance","verticaldistance","horizontaldistance","projectedxdifference","projectedydifference","projectedzdifference","area","unit","wkt","desc"]].concat(t.map((function(t){var n=new Array(12);n[0]=t.tag;var i=e[t.id];switch(t.tag){case It:n[9]="",n[10]="POINT Z ("+i.exportLngLatHeightArray().join(" ")+")";break;case Pt:n[1]=t.angle,n[10]="LINESTRING Z ("+i.map((function(t,e){return e%3==0&&i.slice(e,e+3).join(" ")})).filter(Boolean).join(",")+")";break;case Nt:n[2]=t.distance,n[9]="m",n[10]="LINESTRING Z ("+i.map((function(t,e){return e%3==0&&i.slice(e,e+3).join(" ")})).filter(Boolean).join(",")+")";break;case St:n[2]=t.clampdistance,n[9]="m",n[10]="LINESTRING Z ("+i.map((function(t,e){return e%3==0&&i.slice(e,e+3).join(" ")})).filter(Boolean).join(",")+")";break;case Tt:case Lt:n[8]=t.area,n[9]="㎡",n[10]="POLYGON Z (("+i.map((function(t,e){return e%3==0&&i.slice(e,e+3).join(" ")})).filter(Boolean).join(",")+"))";break;case Mt:n[2]=t.distances[0],n[9]="m",n[10]="LINESTRING Z ("+i.map((function(t,e){return e%3==0&&i.slice(e,e+3).join(" ")})).filter(Boolean).join(",")+")";break;case Ot:n[3]=t.distances[1],n[4]=t.distances[2],n[2]=t.distances[3],n[9]="m",n[10]="LINESTRING Z ("+i.map((function(t,e){return e%3==0&&i.slice(e,e+3).join(" ")})).filter(Boolean).join(",")+")";break;case Rt:n[5]=t.distances[4][0],n[6]=t.distances[4][1],n[7]=t.distances[4][2],n[9]="m",n[10]="LINESTRING Z ("+i.map((function(t,e){return e%3==0&&i.slice(e,e+3).join(" ")})).filter(Boolean).join(",")+")";break;case At:n[2]=t.distance,n[9]="m",n[10]="MULTILINESTRING Z (\n                    ("+i[0].map((function(t,e){return e%3==0&&i[0].slice(e,e+3).join(" ")})).filter(Boolean).join(",")+"),\n                    ("+i[1].map((function(t,e){return e%3==0&&i[1].slice(e,e+3).join(" ")})).filter(Boolean).join(",")+"))",n[11]="MultiLineString:[[PointToMeasure, FootPointOnLine], [LineStartPoint, LineEndPoint]]";break;case Dt:n[2]=t.distance,n[9]="m",n[10]="LINESTRING Z ("+i.map((function(t,e){return e%3==0&&i.slice(e,e+3).join(" ")})).filter(Boolean).join(",")+")"}return n})))}var Jt=function(t){return Sf3d.Util.beforePickingPosition(t)},Qt=function(t){return Sf3d.Util.afterPickPosition(t)},$t=void 0,te=function(t){$t=$t||new Et.io.GeoJSONReader;try{var e={type:"Polygon",coordinates:[t.map((function(t,e,n){return e%3==0&&[t,n[e+1]]})).filter(Boolean).concat([t.slice(0,2)])]};if(!$t.read(e).isValid())return"多边形不能自相交！"}catch(t){console.warn(t)}return null};u.a.MeasureTool=function(t,e){var n=this,i=t.viewer,r=e||{},o=[],a={},l=[],c=[],p=[],f=[],d=function(t,e){for(var n=f.length-1;n>=0;n--)f[n]===t&&f.splice(n,1);e&&(t instanceof Array?t.forEach((function(t){return i.entities.remove(t)})):i.entities.remove(t))},g=function(){for(;f.length>0;){var t=f.pop();t instanceof Array?t.forEach((function(t){return i.entities.remove(t)})):i.entities.remove(t)}};this.config={pointColor:{name:"点颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,0,0,1)},pointSize:{name:"点尺寸",type:u.a.PropertyType.Float,default:5},lineColor:{name:"线颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,0,0,.5)},lineWidth:{name:"线宽",type:u.a.PropertyType.Float,default:3},areaColor:{name:"面颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,0,0,.5)}};var y=r.pointColor instanceof u.a.Color?r.pointColor:this.config.pointColor.default;Object.defineProperty(this,"pointColor",{get:function(){return y},set:function(t){t instanceof u.a.Color&&(y=t,o.filter((function(t){return t.point})).forEach((function(t){t.point.color=y.color})))},enumerable:!0});var m=isNaN(r.pointSize)?this.config.pointSize.default:r.pointSize;Object.defineProperty(this,"pointSize",{get:function(){return m},set:function(t){isNaN(t)||(m=t,o.filter((function(t){return t.point})).forEach((function(t){t.point.pixelSize=m})))},enumerable:!0});var _=r.lineColor instanceof u.a.Color?r.lineColor:this.config.lineColor.default;Object.defineProperty(this,"lineColor",{get:function(){return _},set:function(t){t instanceof u.a.Color&&(_=t,o.filter((function(t){return t.polyline})).forEach((function(t){t.polyline.material=_.color})))}});var v=isNaN(r.lineWidth)?this.config.lineWidth.default:r.lineWidth;Object.defineProperty(this,"lineWidth",{get:function(){return v},set:function(t){isNaN(t)||(v=t,o.filter((function(t){return t.polyline})).forEach((function(t){t.polyline.width=v})))},enumerable:!0});var x=r.areaColor instanceof u.a.Color?r.areaColor:this.config.areaColor.default;Object.defineProperty(this,"areaColor",{get:function(){return x},set:function(t){t instanceof u.a.Color&&(x=t,o.filter((function(t){return t.polygon})).forEach((function(t){t.polygon.material=x.color})))},enumerable:!0});var C=r.labelBackgroundColor instanceof u.a.Color?r.labelBackgroundColor:new u.a.Color(0,0,0,.8);Object.defineProperty(this,"labelBackgroundColor",{get:function(){return C},set:function(t){t instanceof u.a.Color&&(C=t)},enumerable:!0});var w=isNaN(r.pixelThresold)?5:parseFloat(r.pixelThresold),b=new Cesium.ScreenSpaceEventHandler(i.scene.canvas);document.getElementById("toolTip");this.startMeasurePosition=function(){n.finish(!0),Jt(i),b=new Cesium.ScreenSpaceEventHandler(i.scene.canvas);var e=null;document.body.style.cursor="cross",b.setInputAction((function(e){_t({map3d:t,position:[e.endPosition.x,e.endPosition.y],content:"<p>左键拾取</p><p>右键结束</p>"})}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),b.setInputAction((function(t){document.onmousemove=null;var r=u.a.Util.pickCoordAnyway({x:t.position.x,y:t.position.y,relative:!0});if(r){l.push(r);var s=r.exportLngLatHeightArray();(e=i.entities.add({position:r.exportCartesian(),point:{color:y.color,pixelSize:m},label:{text:"lng:"+s[0]+"\nlat:"+s[1]+"\nheight:"+s[2],showBackground:!0,font:"12px",backgroundColor:Cesium.Color.fromCssColorString("rgba(0,0,0,0.8)"),pixelOffset:new Cesium.Cartesian2(80,-40),disableDepthTestDistance:Number.POSITIVE_INFINITY}})).tag=It,a[e.id]=r,o.push(e),n.emit({type:"onMeasurePoint",data:{point:r}})}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),b.setInputAction((function(){b.destroy(),vt({map3d:t}),Qt(i),document.body.style.cursor="default"}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.startMeasureAngle=function(){n.finish(!0),Jt(i),b=new Cesium.ScreenSpaceEventHandler(i.scene.canvas);var e=[],r=null,s=null,l=[];document.body.style.cursor="cross";var p=null,g=0,x="<p>拾取起点</p>";b.setInputAction((function(n){if(_t({map3d:t,position:[n.endPosition.x,n.endPosition.y],content:x+"<p>右键取消</p>"}),e.length>=3){var i=u.a.Util.pickCoordAnyway({x:n.endPosition.x,y:n.endPosition.y,relative:!0});i&&(l=i.exportLngLatHeightArray())}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),b.setInputAction((function(w){document.onmousemove=null;var E,I=u.a.Util.pickCoordAnyway({x:w.position.x,y:w.position.y,relative:!0});if(I)if(0==e.length)x="<p>拾取拐点</p>",(E=e).push.apply(E,h()(I.exportLngLatHeightArray())),s=i.entities.add({position:I.exportCartesian(),point:{heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,color:y.color,pixelSize:m}}),f.push(s),r=i.entities.add({show:!0,polyline:{positions:new Cesium.CallbackProperty((function(){return r&&r.hasConfirm?Cesium.Cartesian3.fromDegreesArrayHeights(e):Cesium.Cartesian3.fromDegreesArrayHeights(e.concat(l))}),!1),material:_.color,width:v}}),f.push(r),r.tag=Pt;else if(e.length>=3){var P,N;if(x="<p>选择终点</p>",(P=e).push.apply(P,h()(I.exportLngLatHeightArray())),d(s,!0),9==e.length)b.destroy(),g=zt({lon:e[0],lat:e[1],hei:e[2]},{lon:e[3],lat:e[4],hei:e[5]},{lon:e[6],lat:e[7],hei:e[8]}),p=i.entities.add({point:{pixelSize:m,color:y.color},position:(new u.a.Point3d).fromLngLat(e[3],e[4],e[5]).exportCartesian(),label:{text:"角度:"+g+"°",showBackground:!0,font:"12px",backgroundColor:C.color,pixelOffset:new Cesium.Cartesian2(3,-20),disableDepthTestDistance:Number.POSITIVE_INFINITY}}),r.tagLabel=p,r.angle=g,r.hasConfirm=!0,r.polyline.positions=Cesium.Cartesian3.fromDegreesArrayHeights(e),d(r,!1),o.push(r),c.push(e.concat([])),a[r.id]=c[c.length-1],r.dm=qt((N=new u.a.Point3d).fromLngLat.apply(N,h()(e.slice(-6).slice(0,3))),{offsetX:20,offsetY:20,map3d:t},(function(){Ht(r,o,a,i),delete a[r.id],n.emit({type:"onDelMeasureAngle",data:{}})})),vt({map3d:t}),document.body.style.cursor="default",Qt(i),n.emit({type:"onMeasureAngle",data:{angle:g,positions:[].concat(e)}}),e=[]}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),b.setInputAction((function(){b.destroy(),e.length<9&&(d(s,!0),d(r,!0)),e=[],vt({map3d:t}),document.body.style.cursor="default",Qt(i)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.startMeasureDistance=function(e){var r=e=s()({clamp:!1,heightReference:Cesium.HeightReference.NONE,classificationType:Cesium.ClassificationType.BOTH},e||{}),l=r.rclickFinish,p=void 0===l||l,g=r.rclickAddPoint,x=void 0!==g&&g,E=r.dblclickFinish,I=void 0===E||E,P=(r.dblclickAddPoint,r.clamp),N=r.heightReference;n.finish(!0),Jt(i),b=new Cesium.ScreenSpaceEventHandler(i.scene.canvas);var S=[],T=null,L=null,M=[],O=[],R=0;f.push(O),document.body.style.cursor="cross",b.setInputAction((function(e){if(S.length>=3){var n=u.a.Util.pickCoordAnyway({x:e.endPosition.x,y:e.endPosition.y,relative:!0});if(!n)return;M=n.exportLngLatHeightArray();var i=(new u.a.Point3d).fromLngLat(S[S.length-3],S[S.length-2],S[S.length-1]).distanceTo((new u.a.Point3d).fromLngLat(M[0],M[1],M[2]));_t({map3d:t,position:[e.endPosition.x,e.endPosition.y],content:S.length>=6?"<p>距离："+i.toFixed(3)+"米</p><p>右键结束</p>":"<p>距离："+i.toFixed(3)+"米</p><p>右键取消</p>"})}else _t({map3d:t,content:"<p>左键拾取</p><p>右键取消</p>",position:[e.endPosition.x,e.endPosition.y]})}),Cesium.ScreenSpaceEventType.MOUSE_MOVE);var A=null;b.setInputAction((function(t){if(!(A&&Cesium.Cartesian2.distance(t.position,A)<=w)){A=t.position.clone(),document.onmousemove=null;var n,r=u.a.Util.pickCoordAnyway({x:t.position.x,y:t.position.y,relative:!0});if(r)if(0==S.length)(n=S).push.apply(n,h()(r.exportLngLatHeightArray())),L=i.entities.add({position:r.exportCartesian(),point:{heightReference:N,color:y.color,pixelSize:m}}),f.push(L),T=i.entities.add({polyline:{positions:new Cesium.CallbackProperty((function(){return T&&T.hasConfirm?Cesium.Cartesian3.fromDegreesArrayHeights(S):Cesium.Cartesian3.fromDegreesArrayHeights(S.concat(M))}),!1),material:_.color,width:v,clampToGround:P,classificationType:e.classificationType}}),f.push(T),T.distances=[],T.tag=Nt;else if(S.length>=3){var o;if((o=S).push.apply(o,h()(r.exportLngLatHeightArray())),!Vt(S)){var s=(new u.a.Point3d).fromLngLat(S[S.length-3],S[S.length-2],S[S.length-1]).distanceTo((new u.a.Point3d).fromLngLat(S[S.length-6],S[S.length-5],S[S.length-4])),a=i.entities.add({position:(new u.a.Point3d).fromLngLat(S[S.length-3],S[S.length-2],S[S.length-1]).exportCartesian(),label:{text:"距离:"+s.toFixed(3)+"米",showBackground:!0,font:"12px",backgroundColor:C.color,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,heightReference:N,disableDepthTestDistance:Number.POSITIVE_INFINITY}});O.push(a),T.distances.push(s),R+=s}d(L,!0)}}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),b.setInputAction((function(e){if(I){if(b.destroy(),0==S.length);else if(3==S.length)d(L,!0),d(T,!0),d(O,!0);else{var r;T.hasConfirm=!0,T.polyline.positions=Cesium.Cartesian3.fromDegreesArrayHeights(S),T.distance=R,d(T,!1),o.push(T),d(O,!1),T.labels=O,c.push(S.concat([])),a[T.id]=c[c.length-1],T.dm=qt((r=new u.a.Point3d).fromLngLat.apply(r,h()(S.slice(-3))),{offsetX:20,offsetY:20,map3d:t},(function(){Ht(T,o,a,i),n.emit({type:"onDelMeasureDistance",data:{}})})),O.length>0&&(O[O.length-1].label.text+="\n总长:"+R.toFixed(3)+"米")}vt({map3d:t}),document.body.style.cursor="default",Qt(i),n.emit({type:"onMeasureDistance",data:{distance:R,distances:T.distances,positions:[].concat(S)}}),S=[]}}),Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),b.setInputAction((function(e){if(x){var r,s=u.a.Util.pickCoordAnyway({x:e.position.x,y:e.position.y,relative:!0});if(s)if(0==S.length)(r=S).push.apply(r,h()(s.exportLngLatHeightArray())),L=i.entities.add({position:s.exportCartesian(),point:{heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,color:y.color,pixelSize:m}}),f.push(L),T=i.entities.add({polyline:{positions:new Cesium.CallbackProperty((function(){return T&&T.hasConfirm?Cesium.Cartesian3.fromDegreesArrayHeights(S):Cesium.Cartesian3.fromDegreesArrayHeights(S.concat(M))}),!1),material:_.color,width:v,clampToGround:P}}),f.push(T),T.distances=[],T.tag=Nt;else if(S.length>=3){var l;if((l=S).push.apply(l,h()(s.exportLngLatHeightArray())),!Vt(S)){var g=(new u.a.Point3d).fromLngLat(S[S.length-3],S[S.length-2],S[S.length-1]).distanceTo((new u.a.Point3d).fromLngLat(S[S.length-6],S[S.length-5],S[S.length-4])),w=i.entities.add({position:(new u.a.Point3d).fromLngLat(S[S.length-3],S[S.length-2],S[S.length-1]).exportCartesian(),label:{text:"距离:"+g.toFixed(3)+"米",showBackground:!0,font:"12px",backgroundColor:C.color,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,heightReference:N,disableDepthTestDistance:Number.POSITIVE_INFINITY}});O.push(w),T.distances.push(g)}d(L,!0)}}if(p){if(b.destroy(),0==S.length);else if(3==S.length)d(L,!0),d(T,!0),d(O,!0);else{var E;T.hasConfirm=!0,T.polyline.positions=Cesium.Cartesian3.fromDegreesArrayHeights(S),T._index_=c.length,T.distance=R,d(T,!1),o.push(T),d(O,!1),T.labels=O,c.push(S.concat([])),a[T.id]=c[c.length-1],T.dm=qt((E=new u.a.Point3d).fromLngLat.apply(E,h()(S.slice(-3))),{offsetX:20,offsetY:20,map3d:t},(function(){Ht(T,o,a,i),n.emit({type:"onDelMeasureDistance",data:{}})})),O.length>0&&(O[O.length-1].label.text+="\n总长:"+R.toFixed(3)+"米")}vt({map3d:t}),document.body.style.cursor="default",Qt(i),n.emit({type:"onMeasureDistance",data:{distance:R,distances:T.distances,positions:[].concat(S)}}),S=[]}}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.startMeasureClampDistance=function(e){var r=e=s()({len:10,maxNum:50,heightReference:Cesium.HeightReference.NONE,classificationType:Cesium.ClassificationType.BOTH},e||{}),l=r.rclickFinish,p=void 0===l||l,g=r.rclickAddPoint,x=void 0!==g&&g,P=r.dblclickFinish,N=void 0===P||P;r.dblclickAddPoint;n.finish(!0),Jt(i),b=new Cesium.ScreenSpaceEventHandler(i.scene.canvas);var S=[],T=null,L=null,M=[],O=[],R=0;f.push(O),document.body.style.cursor="cross",b.setInputAction((function(e){if(S.length>=3){var n,i,r=u.a.Util.pickCoordAnyway({x:e.endPosition.x,y:e.endPosition.y,relative:!0});if(!r)return;M=r.exportLngLatHeightArray();var o=Cesium.Cartesian3.distance((n=Cesium.Cartesian3).fromDegrees.apply(n,h()(S.slice(-3))),(i=Cesium.Cartesian3).fromDegrees.apply(i,h()(M)));_t({map3d:t,content:S.length>=6?"<p>距离："+o.toFixed(3)+"米</p><p>右键结束</p>":"<p>距离："+o.toFixed(3)+"米</p><p>右键取消</p>",position:[e.endPosition.x,e.endPosition.y]})}else _t({map3d:t,content:"<p>左键拾取</p><p>右键取消</p>",position:[e.endPosition.x,e.endPosition.y]})}),Cesium.ScreenSpaceEventType.MOUSE_MOVE);var A=null;b.setInputAction((function(t){if(!(A&&Cesium.Cartesian2.distance(t.position,A)<=w)){A=t.position.clone(),document.onmousemove=null;var n,r=u.a.Util.pickCoordAnyway({x:t.position.x,y:t.position.y,relative:!0});if(r)if(0==S.length)(n=S).push.apply(n,h()(r.exportLngLatHeightArray())),L=i.entities.add({position:r.exportCartesian(),point:{heightReference:e.heightDifference,color:y.color,pixelSize:m}}),f.push(L),T=i.entities.add({polyline:{positions:new Cesium.CallbackProperty((function(){return T&&T.hasConfirm?Cesium.Cartesian3.fromDegreesArrayHeights(S):Cesium.Cartesian3.fromDegreesArrayHeights(S.concat(M))}),!1),material:_.color,width:v,clampToGround:!0,classificationType:e.classificationType}}),f.push(T),T.clampdistances=[],T.tag=St;else if(S.length>=3){var o;if((o=S).push.apply(o,h()(r.exportLngLatHeightArray())),!Vt(S)){var s,a=(s=Cesium.Cartesian3).distance.apply(s,h()(Cesium.Cartesian3.fromDegreesArrayHeights(S.slice(-6)))),l=I(Cesium.Cartesian3.fromDegreesArrayHeights(S.slice(-6)),E(a,e.len,e.maxNum)),c=i.entities.add({position:(new u.a.Point3d).fromLngLat(S[S.length-3],S[S.length-2],S[S.length-1]).exportCartesian(),label:{text:"距离:"+l.toFixed(3)+"米",showBackground:!0,font:"12px",backgroundColor:C.color,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,heightReference:e.heightDifference,disableDepthTestDistance:Number.POSITIVE_INFINITY}});O.push(c),T.clampdistances.push(l),R+=l}d(L,!0)}}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),b.setInputAction((function(e){if(N){if(b.destroy(),0==S.length);else if(3==S.length)d(L,!0),d(T,!0),d(O,!0);else{var r;T.hasConfirm=!0,T.polyline.positions=Cesium.Cartesian3.fromDegreesArrayHeights(S),T.clampdistance=R,d(T,!1),o.push(T),d(O,!1),T.labels=O,c.push(S.concat([])),a[T.id]=c[c.length-1],T.dm=qt((r=new u.a.Point3d).fromLngLat.apply(r,h()(S.slice(-3))),{offsetX:20,offsetY:20,map3d:t},(function(){Ht(T,o,a,i),n.emit({type:"onDelMeasureClampDistance",data:{}})})),O.length>0&&(O[O.length-1].label.text+="\n总长:"+R.toFixed(3)+"米")}vt({map3d:t}),document.body.style.cursor="default",Qt(i),n.emit({type:"onMeasureClampDistance",data:{distance:R,distances:T.clampdistances,positions:[].concat(S)}}),S=[]}}),Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),b.setInputAction((function(r){if(x){var s,l=u.a.Util.pickCoordAnyway({x:r.position.x,y:r.position.y,relative:!0});if((s=S).push.apply(s,h()(l.exportLngLatHeightArray())),!Vt(S)){var f,g=(f=Cesium.Cartesian3).distance.apply(f,h()(Cesium.Cartesian3.fromDegreesArrayHeights(S.slice(-6)))),y=I(Cesium.Cartesian3.fromDegreesArrayHeights(S.slice(-6)),E(g,e.len,e.maxNum)),m=i.entities.add({position:(new u.a.Point3d).fromLngLat(S[S.length-3],S[S.length-2],S[S.length-1]).exportCartesian(),label:{text:"距离:"+y.toFixed(3)+"米",showBackground:!0,font:"12px",backgroundColor:C.color,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,heightReference:heightReference,disableDepthTestDistance:Number.POSITIVE_INFINITY}});O.push(m),T.clampdistances.push(y)}}if(p){if(b.destroy(),0==S.length);else if(3==S.length)d(L,!0),d(T,!0),d(O,!0);else{var _;T.hasConfirm=!0,T.polyline.positions=Cesium.Cartesian3.fromDegreesArrayHeights(S),T.clampdistance=R,d(T,!1),o.push(T),d(O,!1),T.labels=O,c.push(S.concat([])),a[T.id]=c[c.length-1],T.dm=qt((_=new u.a.Point3d).fromLngLat.apply(_,h()(S.slice(-3))),{offsetX:20,offsetY:20,map3d:t},(function(){Ht(T,o,a,i),n.emit({type:"onDelMeasureClampDistance",data:{}})})),O.length>0&&(O[O.length-1].label.text+="\n总长:"+R.toFixed(3)+"米")}vt({map3d:t}),document.body.style.cursor="default",Qt(i),n.emit({type:"onMeasureClampDistance",data:{distance:R,distances:T.clampdistances,positions:[].concat(S)}}),S=[]}}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)};var E=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;return t/Math.min(t/e,n)/634e4},I=function(t,e){var n=function(t,e,n,i){i||(i=window._cesium);var r=Cesium.PolylinePipeline.generateArc({positions:t,granularity:null!=e&&e>0?e:1e-5});return r?Cesium.Cartesian3.unpackArray(r,n):t}(t,e,null,i);if(!n||n.length<2)return 0;var r=i.scene.clampToHeight(n[0]);return r||(r=n[0]),n.slice(1).reduce((function(t,e){var n=i.scene.clampToHeight(e);n||(n=e);var o=Cesium.Cartesian3.distance(r,n);return r=n,t+o}),0)};function P(e){var n=this;e=s()({valueFn:function(t){return 0},heightDifference:!1,heightDifferenceText:"高度差",vertical:!1,verticalText:"垂直距离",horizontal:!1,horizontalText:"水平距离",straight:!1,straightText:"直线距离",projectXYZ:!1,projectXYZText:"XYZ坐标差",projectXYZTexts:["X","Y","Z"]},e||{}),b&&b.destroy(),Jt(i),b=new Cesium.ScreenSpaceEventHandler(i.scene.canvas);var r=[],l=null,p=new Array(5);p.fill(0),p[4]=[0,0,0];var g=null,v=null,x=null;function w(t,e){return[!!e.heightDifference&&"<p>"+e.heightDifferenceText+"："+Math.abs(t[0])+"米</p>",!!e.vertical&&"<p>"+e.verticalText+"："+t[1]+"米</p>",!!e.horizontal&&"<p>"+e.horizontalText+"："+t[2]+"米</p>",!!e.straight&&"<p>"+e.straightText+"："+t[3]+"米</p>",!!e.projectXYZ&&e.projectXYZText+"\n                                    <p>"+e.projectXYZTexts[0]+"："+t[4][0]+"米</p>\n                                    <p>"+e.projectXYZTexts[1]+"："+t[4][1]+"米</p>\n                                    <p>"+e.projectXYZTexts[2]+"："+t[4][2]+"米</p>","<p>右键结束</p>"].filter(Boolean).join("")}b.setInputAction((function(n){var i=u.a.Util.pickCoordAnyway(s()({},n.endPosition));i&&(g=i.exportCartesian(),r.length>=2?(Cesium.defined(l)?(r.pop(),r.push(g)):l=new E(r),function(t,e,n){var i=Cesium.Cartographic.fromCartesian(t[0]),r=Cesium.Cartographic.fromCartesian(t[1]);if(n.heightDifference){var o=r.height-i.height;e[0]=parseFloat(o.toFixed(2))}if(n.vertical){o=Math.abs(r.height-i.height);e[1]=parseFloat(o.toFixed(2))}if(n.horizontal){var s=(new Sf3d.Point3d).fromRadian(i.longitude,i.latitude,0),a=(new Sf3d.Point3d).fromRadian(r.longitude,r.latitude,0);e[2]=parseFloat(jt(a.exportCartesian(),s.exportCartesian()).toFixed(2))}if(n.straight&&(e[3]=parseFloat(jt.apply(void 0,h()(t)).toFixed(2))),n.projectXYZ){var l=new Cesium.WebMercatorProjection,u=l.project(i),c=l.project(r),p=Cesium.Cartesian3.subtract(c,u,new Cesium.Cartesian3);e[4]=[parseFloat(p.x.toFixed(2)),parseFloat(p.y.toFixed(2)),parseFloat(p.z.toFixed(2))]}}(r,p,e),_t({map3d:t,content:w(p,e),position:[n.endPosition.x,n.endPosition.y]})):_t({map3d:t,content:"<p>左键拾取</p><p>单击右键取消</p>",position:[n.endPosition.x,n.endPosition.y]}))}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),b.setInputAction((function(t){document.onmousemove=null;var e=u.a.Util.pickCoordAnyway(s()({},t.position));e&&(g=e.exportCartesian(),0==r.length&&(r.push(g.clone()),r.push(g),v=i.entities.add({name:"顶点",position:r[0],point:{pixelSize:m,color:y.color,disableDepthTestDistance:Number.POSITIVE_INFINITY}}),f.push(v)))}),Cesium.ScreenSpaceEventType.LEFT_CLICK),b.setInputAction((function(l){if(b.destroy(),vt({map3d:t}),r.length>0&&x){var h=function(t,e){return[!!e.heightDifference&&e.heightDifferenceText+"："+Math.abs(t[0])+"米",!!e.projectXYZ&&e.projectXYZText+"\n"+e.projectXYZTexts[0]+"："+t[4][0]+"米\n"+e.projectXYZTexts[1]+"："+t[4][1]+"米\n"+e.projectXYZTexts[2]+"："+t[4][2]+"米"].filter(Boolean).join("\n")}(p,e),f=i.entities.add({name:"直线距离",position:r[1],point:{pixelSize:new Cesium.CallbackProperty((function(){return m}),!1),color:new Cesium.CallbackProperty((function(){return y.color}),!1)},label:h?{text:h,font:"16px sans-serif",style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.WHITE,showBackground:!0,backgroundColor:C.color,backgroundPadding:new Cesium.Cartesian2(8,5),outlineColor:Cesium.Color.BLACK,outlineWidth:3,disableDepthTestDistance:Number.POSITIVE_INFINITY,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,pixelOffset:new Cesium.Cartesian2(3,-3)}:void 0});c.push(r.map((function(t){return(new u.a.Point3d).fromCartesian(t)})).map((function(t){return t.exportLngLatHeightArray()})).flatMap((function(t){return t}))),o.push(x),a[x.id]=c[c.length-1],x.tag=e.tag,x.distances=p,x.tagLabel=f,x.tagPoint=v,d(v,!1),d(x,!1),x.subs=function(t,e,n,i,r){var o=[],a=Cesium.Cartographic.fromCartesian(e[0]),l=Cesium.Cartographic.fromCartesian(e[1]),u={name:"测距辅助线",polyline:{show:!0,positions:[],material:new Cesium.ColorMaterialProperty(new Cesium.CallbackProperty((function(){return r.lineColor.color}),!1)),width:new Cesium.CallbackProperty((function(){return r.lineWidth}),!1)}},c={font:"14px sans-serif",style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.WHITE,showBackground:!0,backgroundColor:Cesium.Color.BLACK.withAlpha(.5),backgroundPadding:new Cesium.Cartesian2(8,5),outlineColor:Cesium.Color.BLACK,outlineWidth:3,disableDepthTestDistance:Number.POSITIVE_INFINITY,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,pixelOffset:new Cesium.Cartesian2(3,-3)},h=void 0,p=void 0,f=void 0,d=new Cesium.Cartographic((a.longitude+l.longitude)/2,(a.latitude+l.latitude)/2,(a.height+l.height)/2),g=l.height-a.height;if(Math.abs(g)<.2&&(g=0),g>0?((h=a.clone()).height=l.height,p=new Cesium.Cartographic((a.longitude+h.longitude)/2,(a.latitude+h.latitude)/2,(a.height+h.height)/2),f=new Cesium.Cartographic((l.longitude+h.longitude)/2,(l.latitude+h.latitude)/2,(l.height+h.height)/2)):g<0&&((h=l.clone()).height=a.height,p=new Cesium.Cartographic((l.longitude+h.longitude)/2,(l.latitude+h.latitude)/2,(l.height+h.height)/2),f=new Cesium.Cartographic((a.longitude+h.longitude)/2,(a.latitude+h.latitude)/2,(a.height+h.height)/2)),null!=h){if(i.vertical||i.horizontal||i.straight){var y=t.entities.add({name:"距离测量辅助点",position:Cesium.Cartographic.toCartesian(h),point:{pixelSize:new Cesium.CallbackProperty((function(){return r.pointSize}),!1),color:new Cesium.CallbackProperty((function(){return r.pointColor.color}),!1),disableDepthTestDistance:Number.POSITIVE_INFINITY,heightReference:Cesium.HeightReference.none}});o.push(y)}if(i.vertical){var m=t.entities.add(s()({},u,{polyline:s()({},u.polyline,{positions:[e[1].clone(),Cesium.Cartographic.toCartesian(h)]})}));o.push(m);var _=t.entities.add({name:i.verticalText+"标注",position:Cesium.Cartographic.toCartesian(p),label:s()({},c,{text:i.verticalText+"："+n[1]+"米"})});o.push(_)}if(i.horizontal){m=t.entities.add(s()({},u,{polyline:s()({},u.polyline,{positions:[e[0].clone(),Cesium.Cartographic.toCartesian(h)]})}));o.push(m);var v=t.entities.add({name:i.horizontalText+"标注",position:Cesium.Cartographic.toCartesian(f),label:s()({},c,{text:i.horizontalText+"："+n[2]+"米"})});o.push(v)}}if(i.straight){var x=t.entities.add({name:i.straightText+"标注",position:Cesium.Cartographic.toCartesian(d),label:s()({},c,{text:i.straightText+"："+n[3]+"米"})});o.push(x)}return o}(i,r,p,e,n),x.dm=qt((new u.a.Point3d).fromCartesian(r[r.length-1]),{offsetX:20,offsetY:20,map3d:t},(function(){Ht(x,o,a,i),n.emit({type:"onDel"+e.type,data:{}})})),Qt(i),n.emit({type:"on"+e.type,data:{value:e.valueFn(p),positions:r.map((function(t){return(new u.a.Point3d).fromCartesian(t).exportLngLatHeightArray()})).flat()}})}else d(v,!0),d(x,!0),Qt(i);document.body.style.cursor="default"}),Cesium.ScreenSpaceEventType.RIGHT_CLICK);var E=function(){function t(t){this.options={name:"起始点连线",polyline:{show:!0,positions:[],material:_.color,width:3,disableDepthTestDistance:Number.POSITIVE_INFINITY}},this.positions=t,this._init()}return t.prototype._init=function(){var t=this;this.options.polyline.positions=new Cesium.CallbackProperty((function(){return t.positions}),!1),x=i.entities.add(this.options),f.push(x)},t}()}this.startMeasureArea=function(e){var r=(e=s()({clamp:!1,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,classificationType:Cesium.ClassificationType.BOTH},e||{}))||{},l=r.rclickFinish,c=void 0===l||l,g=r.rclickAddPoint,y=void 0!==g&&g,m=r.dblclickFinish,w=void 0===m||m,E=(r.dblclickAddPoint,r.clamp),I=r.heightReference;n.finish(!0),Jt(i),b=new Cesium.ScreenSpaceEventHandler(i.scene.canvas);var P=[],N=[],S=null,T=null,L=!0;document.body.style.cursor="cross",b.setInputAction((function(e){var n=P.length>=9?"<p>左键拾取</p><p>右键结束</p>":"<p>左键拾取</p><p>右键取消</p>";if(L=!0,P.length>=3){var i=u.a.Util.pickCoordAnyway({x:e.endPosition.x,y:e.endPosition.y,relative:!0});if(i&&(N=i.exportLngLatHeightArray(),P.length>6)){var r=te(P.concat(N));r&&(n="<p>"+r+"</p><p>右键结束</p>",L=!1)}}_t({map3d:t,content:n,position:[e.endPosition.x,e.endPosition.y]})}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),b.setInputAction((function(t){if(!1!==L){document.onmousemove=null;var n,r=u.a.Util.pickCoordAnyway({x:t.position.x,y:t.position.y,relative:!0});if(r)if(0==P.length)(n=P).push.apply(n,h()(r.exportLngLatHeightArray())),S=i.entities.add({position:P[P.length-1],polyline:{positions:new Cesium.CallbackProperty((function(){return Cesium.Cartesian3.fromDegreesArrayHeights(P.concat(N))}),!1),material:_.color,width:v,clampToGround:E,classificationType:e.classificationType}}),f.push(S);else if(3==P.length){var o;(o=P).push.apply(o,h()(r.exportLngLatHeightArray())),T=i.entities.add({polygon:{hierarchy:new Cesium.CallbackProperty((function(){return T&&T.hasConfirm?new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(P)):new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(P.concat(N)))}),!1),material:x.color,heightReference:I,classificationType:e.classificationType}}),f.push(T),T.tag=Tt,d(S,!0)}else{var s;(s=P).push.apply(s,h()(r.exportLngLatHeightArray()))}}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),b.setInputAction((function(e){if(!1!==L&&w){if(b.destroy(),0==P.length);else if(3==P.length)d(S,!0);else if(6==P.length)d(T,!0);else{var r,s=[],l=[];P.forEach((function(t,e){e%3==0&&(s.push({lon:P[e],lat:P[e+1],hei:P[e+2]}),l.push((new u.a.Point3d).fromLngLat(P[e],P[e+1],P[e+2]).exportCartesian()))}));var c=Cesium.BoundingSphere.fromPoints(l).center,f=Gt(s),g=i.entities.add({position:c,label:{text:"面积:"+Number(f.toFixed(3))+"㎡",showBackground:!0,font:"12px",backgroundColor:C.color,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,heightReference:I,eyeOffset:new Cesium.Cartesian3(0,0,-5),disableDepthTestDistance:Number.POSITIVE_INFINITY}});p.push(P.concat([])),T.hasConfirm=!0,T.polygon.hierarchy=new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(P)),T.tagLabel=g,T.area=f,d(T,!1),o.push(T),a[T.id]=p[p.length-1],T.dm=qt((r=new u.a.Point3d).fromLngLat.apply(r,h()(P.slice(-3))),{offsetX:3,offsetY:3,map3d:t},(function(){Ht(T,o,a,i),n.emit({type:"onDelMeasureArea",data:{}})}))}vt({map3d:t}),document.body.style.cursor="default",Qt(i),n.emit({type:"onMeasureArea",data:{area:T.area,positions:[].concat(P)}}),P=[]}}),Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),b.setInputAction((function(e){if(y){var r,s=u.a.Util.pickCoordAnyway({x:e.position.x,y:e.position.y,relative:!0});if(s)if(0==P.length)(r=P).push.apply(r,h()(s.exportLngLatHeightArray())),S=i.entities.add({position:P[P.length-1],polyline:{positions:new Cesium.CallbackProperty((function(){return Cesium.Cartesian3.fromDegreesArrayHeights(P.concat(N))}),!1),material:_.color,width:v,clampToGround:E}}),f.push(S);else if(3==P.length){var l;(l=P).push.apply(l,h()(s.exportLngLatHeightArray())),T=i.entities.add({polygon:{hierarchy:new Cesium.CallbackProperty((function(){return T&&T.hasConfirm?new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(P)):new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(P.concat(N)))}),!1),material:x.color,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND}}),f.push(T),T.tag=Tt,d(S,!0)}else{var g;(g=P).push.apply(g,h()(s.exportLngLatHeightArray())),P[P.length-1]=0}}if(c){if(b.destroy(),0==P.length);else if(3==P.length)d(S,!0);else if(6==P.length)d(T,!0);else{var m,w=[],L=[];P.forEach((function(t,e){e%3==0&&(w.push({lon:P[e],lat:P[e+1],hei:P[e+2]}),L.push((new u.a.Point3d).fromLngLat(P[e],P[e+1],P[e+2]).exportCartesian()))}));var M=Cesium.BoundingSphere.fromPoints(L).center,O=Gt(w),R=i.entities.add({position:M,label:{text:"面积:"+Number(O.toFixed(3))+"㎡",showBackground:!0,font:"12px",backgroundColor:C.color,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,heightReference:I,eyeOffset:new Cesium.Cartesian3(0,0,-5),disableDepthTestDistance:Number.POSITIVE_INFINITY}});p.push(P.concat([])),T.hasConfirm=!0,T.polygon.hierarchy=new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(P)),T.tagLabel=R,T.area=O,d(T,!1),o.push(T),a[T.id]=p[p.length-1],T.dm=qt((m=new u.a.Point3d).fromLngLat.apply(m,h()(P.slice(-3))),{offsetX:3,offsetY:3,map3d:t},(function(){Ht(T,o,a,i),n.emit({type:"onDelMeasureArea",data:{}})}))}vt({map3d:t}),document.body.style.cursor="default",Qt(i),n.emit({type:"onMeasureArea",data:{area:T.area,positions:[].concat(P)}}),P=[]}}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.startMeasureProjectedArea=function(e){var r=(e=s()({clamp:!1,classificationType:Cesium.ClassificationType.BOTH},e||{}))||{},l=r.rclickFinish,c=void 0===l||l,g=r.rclickAddPoint,y=void 0!==g&&g,m=r.dblclickFinish,w=void 0===m||m,E=(r.dblclickAddPoint,r.clamp);n.finish(!0),b=new Cesium.ScreenSpaceEventHandler(i.scene.canvas);var I=[],P=[],N=null,S=null,T=1e5,L=-1e5,M=L,O=!0;function R(){var e,r=[],l=[];M=L-T<5?T+5:T+1.2*(L-T),I.forEach((function(t,e){e%3==0&&(r.push({lon:I[e],lat:I[e+1],hei:M}),l.push((new u.a.Point3d).fromLngLat(I[e],I[e+1],M).exportCartesian()))}));var c=Cesium.Rectangle.center(Cesium.PolygonGeometry.computeRectangle({polygonHierarchy:{positions:l}})),f=Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,M),g=Gt(r),y=i.entities.add({position:f,label:{text:"投影面积:"+Number(g.toFixed(3))+"㎡",showBackground:!0,font:"12px",backgroundColor:C.color,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,heightReference:Cesium.HeightReference.NONE,pixelOffset:new Cesium.Cartesian2(0,-5),eyeOffset:new Cesium.Cartesian3(0,0,-5),disableDepthTestDistance:Number.POSITIVE_INFINITY}});d(S,!0),(S=i.entities.add({polygon:{hierarchy:new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(I.map((function(t,e){return e%3==2?M:t})))),perPositionHeight:!0,heightReference:Cesium.HeightReference.NONE,material:new Cesium.ColorMaterialProperty(new Cesium.CallbackProperty((function(){return x.color}),!1)),outline:!0,outlineColor:_.color,outlineWidth:v}})).tag=Lt,p.push(I.concat([])),S.hasConfirm=!0,S.tagLabel=y,S.area=g,o.push(S),a[S.id]=p[p.length-1],S.subs=function(t,e,n,i){for(var r=[],o={polyline:{show:!0,positions:[],material:new Cesium.PolylineDashMaterialProperty({color:new Cesium.CallbackProperty((function(){return i.lineColor.color}),!1)}),width:new Cesium.CallbackProperty((function(){return i.lineWidth}),!1)}},a=0;a<e.length-2;a+=3){var l,u,c=[e[a],e[a+1],e[a+2],e[a],e[a+1],n],p=t.entities.add({name:"投影面积辅助线",polyline:s()({},o.polyline,{positions:Cesium.Cartesian3.fromDegreesArrayHeights(c)})}),f=t.entities.add({name:"投影面积辅助点",position:(l=new Sf3d.Point3d).fromLngLat.apply(l,h()(c.slice(0,3))).exportCartesian(),point:{pixelSize:new Cesium.CallbackProperty((function(){return i.pointSize}),!1),color:new Cesium.CallbackProperty((function(){return i.pointColor.color}),!1),disableDepthTestDistance:Number.POSITIVE_INFINITY,heightReference:Cesium.HeightReference.none}}),d=t.entities.add({name:"投影面积辅助点",position:(u=new Sf3d.Point3d).fromLngLat.apply(u,h()(c.slice(-3))).exportCartesian(),point:{pixelSize:new Cesium.CallbackProperty((function(){return i.pointSize}),!1),color:new Cesium.CallbackProperty((function(){return i.pointColor.color}),!1),disableDepthTestDistance:Number.POSITIVE_INFINITY,heightReference:Cesium.HeightReference.none}});r.push(p),r.push(f),r.push(d)}return r}(i,I,M,n),S.dm=qt((e=new u.a.Point3d).fromLngLat.apply(e,h()(I.slice(-3).map((function(t,e){return e%3==2?M:t})))),{offsetX:3,offsetY:3,map3d:t},(function(){Ht(S,o,a,i),n.emit({type:"onDelMeasureProjectedArea",data:{}})})),n.emit({type:"onMeasureProjectedArea",data:{area:S.area,positions:[].concat(I)}})}Jt(i),document.body.style.cursor="cross",b.setInputAction((function(e){O=!0;var n=I.length>=9?"<p>左键拾取</p><p>右键结束</p>":"<p>左键拾取</p><p>右键取消</p>";if(I.length>=3){var i=u.a.Util.pickCoordAnyway({x:e.endPosition.x,y:e.endPosition.y,relative:!0});if(i)if(P=i.exportLngLatHeightArray(),I.length>6){var r=te(I.concat(P));r?(n="<p>"+r+"</p><p>右键结束</p>",O=!1):(T=Math.min(T,P[2]),L=Math.max(L,P[2]))}else T=Math.min(T,P[2]),L=Math.max(L,P[2])}_t({map3d:t,content:n,position:[e.endPosition.x,e.endPosition.y]})}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),b.setInputAction((function(t){if(!1!==O){document.onmousemove=null;var n,r=u.a.Util.pickCoordAnyway({x:t.position.x,y:t.position.y,relative:!0});if(r)if(T=Math.min(T,r.height),L=Math.max(L,r.height),0==I.length)(n=I).push.apply(n,h()(r.exportLngLatHeightArray())),N=i.entities.add({position:I[I.length-1],polyline:{positions:new Cesium.CallbackProperty((function(){return Cesium.Cartesian3.fromDegreesArrayHeights(I.concat(P))}),!1),material:_.color,width:v,clampToGround:!1,classificationType:e.classificationType}}),f.push(N);else if(3==I.length){var o;(o=I).push.apply(o,h()(r.exportLngLatHeightArray())),S=i.entities.add({polygon:{hierarchy:new Cesium.CallbackProperty((function(){return S&&S.hasConfirm?new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(I)):new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(I.concat(P)))}),!1),perPositionHeight:!0,material:x.color,heightReference:Cesium.HeightReference.NONE,classificationType:e.classificationType}}),f.push(S),d(N,!0)}else{var s;(s=I).push.apply(s,h()(r.exportLngLatHeightArray())),I[I.length-1]=0}}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),b.setInputAction((function(e){!1!==O&&w&&(b.destroy(),0==I.length||(3==I.length?d(N,!0):6==I.length?d(S,!0):R()),vt({map3d:t}),document.body.style.cursor="default",I=[])}),Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),b.setInputAction((function(e){if(y){var n,r=u.a.Util.pickCoordAnyway({x:e.position.x,y:e.position.y,relative:!0});if(r)if(0==I.length)(n=I).push.apply(n,h()(r.exportLngLatHeightArray())),N=i.entities.add({position:I[I.length-1],polyline:{positions:new Cesium.CallbackProperty((function(){return Cesium.Cartesian3.fromDegreesArrayHeights(I.concat(P))}),!1),material:_.color,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,width:v,clampToGround:E}}),f.push(N);else if(3==I.length){var o;(o=I).push.apply(o,h()(r.exportLngLatHeightArray())),S=i.entities.add({polygon:{hierarchy:new Cesium.CallbackProperty((function(){return S&&S.hasConfirm?new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(I)):new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(I.concat(P)))}),!1),material:x.color,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND}}),f.push(S),S.tag="projectedarea",d(N,!0)}else{var s;(s=I).push.apply(s,h()(r.exportLngLatHeightArray())),I[I.length-1]=0}}c&&(b.destroy(),0==I.length||(3==I.length?d(N,!0):6==I.length?d(S,!0):R()),vt({map3d:t}),document.body.style.cursor="default",I=[])}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.startMeasureHeight=function(){return P.call(this,{type:"MeasureHeight",tag:Mt,heightDifference:!0,valueFn:function(t){return t[0]}})},this.startMeasureVerticalHorizontalDistances=function(){return P.call(this,{type:"MeasureVerticalHorizontalDistances",tag:Ot,vertical:!0,horizontal:!0,straight:!0,valueFn:function(t){return{vertical:t[1],horizontal:t[2],straight:t[3]}}})},this.startMeasureProjectedXYZDifferencing=function(){return P.call(this,{type:"MeasureProjectedXYZDifferencing",tag:Rt,projectXYZ:!0,valueFn:function(t){return t[4]}})},this.startMeasurePointLineDistance=function(){var e=this;Jt(i),b&&b.destroy(),b=new Cesium.ScreenSpaceEventHandler(i.scene.canvas);var n=[],r=void 0,l=void 0,c=void 0,p=void 0,g=void 0,x="<p>左键拾取水平线起点</p>";function w(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Qt(i),b.destroy(),vt({map3d:t}),d(r,e),d(l,e),d(p,e)}b.setInputAction((function(e){_t({map3d:t,content:x+"<p>右键取消</p>",position:[e.endPosition.x,e.endPosition.y]});var i=u.a.Util.pickCoordAnyway(s()({},e.endPosition));i&&(g=i,3===n.length&&(g.height=n[2]))}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),b.setInputAction((function(d){document.onmousemove=null;var b,E=u.a.Util.pickCoordAnyway(s()({},d.position));if(E)if(0===n.length)(b=n).push.apply(b,h()(E.exportLngLatHeightArray())),r=i.entities.add({name:"点到线距离起点",position:E.exportCartesian().clone(),point:{pixelSize:new Cesium.CallbackProperty((function(){return m}),!1),color:new Cesium.CallbackProperty((function(){return y.color}),!1),disableDepthTestDistance:Number.POSITIVE_INFINITY,heightReference:Cesium.HeightReference.none}}),(p=i.entities.add({polyline:{positions:new Cesium.CallbackProperty((function(){return!0===p.hasConfirm||6===n.length?Cesium.Cartesian3.fromDegreesArrayHeights(n.slice(0,6)):Cesium.Cartesian3.fromDegreesArrayHeights(n.slice(0,3).concat(g.exportLngLatHeightArray()))}),!1),material:_.color,width:v,clampToGround:!1}})).hasConfirm=!1,f.push(r),f.push(p),x="<p>左键拾取水平线终点</p>";else if(3===n.length){var I;E.height=n[2],n=(I=n).concat.apply(I,h()(E.exportLngLatHeightArray())),l=i.entities.add({name:"点到线距离终点",position:E.exportCartesian().clone(),point:{pixelSize:new Cesium.CallbackProperty((function(){return m}),!1),color:new Cesium.CallbackProperty((function(){return y.color}),!1),disableDepthTestDistance:Number.POSITIVE_INFINITY,heightReference:Cesium.HeightReference.none}}),f.push(l),x="<p>左键拾取测量点</p>"}else if(6===n.length){var P;n=(P=n).concat.apply(P,h()(E.exportLngLatHeightArray()));var N=Yt(E,(new u.a.Point3dCollection).fromLngLatHeightArray(n.slice(0,6))),S=N.distance,T=N.footPoint;(c=i.entities.add({name:"点到线距离测量点",position:E.exportCartesian().clone(),point:{pixelSize:new Cesium.CallbackProperty((function(){return m}),!1),color:new Cesium.CallbackProperty((function(){return y.color}),!1),disableDepthTestDistance:Number.POSITIVE_INFINITY,heightReference:Cesium.HeightReference.none},label:{text:"点到线距离："+S.toFixed(2)+"米",font:"14px sans-serif",style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.WHITE,showBackground:!0,backgroundColor:C.color,backgroundPadding:new Cesium.Cartesian2(8,5),outlineColor:Cesium.Color.BLACK,outlineWidth:3,disableDepthTestDistance:Number.POSITIVE_INFINITY,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,pixelOffset:new Cesium.Cartesian2(3,-3)}})).tag=At,c.distance=S,p.hasConfirm=!0,o.push(c),a[c.id]=[E.exportLngLatHeightArray().concat(T.exportLngLatHeightArray()),n.slice(0,6)],c.subs=function(t,e,n,i,r){var o,a,l=[],u={polyline:{show:!0,positions:[],material:new Cesium.PolylineDashMaterialProperty({color:new Cesium.CallbackProperty((function(){return r.lineColor.color}),!1)}),width:new Cesium.CallbackProperty((function(){return r.lineWidth}),!1)}},c=t.entities.add({name:"点到线距离垂足",position:i.exportCartesian(),point:{pixelSize:new Cesium.CallbackProperty((function(){return r.pointSize}),!1),color:new Cesium.CallbackProperty((function(){return r.pointColor.color}),!1),disableDepthTestDistance:Number.POSITIVE_INFINITY,heightReference:Cesium.HeightReference.none}});l.push(c);var p=t.entities.add({name:"垂线",polyline:s()({},u.polyline,{positions:Cesium.Cartesian3.fromDegreesArrayHeights([].concat(e.slice(6)).concat(i.exportLngLatHeightArray()))})});l.push(p);var f=(o=new Sf3d.Point3d).fromLngLat.apply(o,h()(e.slice(0,3))),d=(a=new Sf3d.Point3d).fromLngLat.apply(a,h()(e.slice(3,6))),g=jt(f.exportCartesian(),d.exportCartesian(0)),y=jt(i.exportCartesian(),f.exportCartesian(0)),m=jt(i.exportCartesian(),d.exportCartesian(0));if(y>g||m>g){var _=y>m?3:0,v=t.entities.add({name:"延长线",polyline:s()({},u.polyline,{positions:Cesium.Cartesian3.fromDegreesArrayHeights([].concat(e.slice(_,_+3)).concat(i.exportLngLatHeightArray()))})});l.push(v)}return l}(i,n,0,T,e),c.subs.push(p,r,l),c.dm=qt(E,{offsetX:20,offsetY:20,map3d:t},(function(){Ht(c,o,a,i),n=[],e.emit({type:"onDelMeasurePointLineDistance",data:{}})})),w(),e.emit({type:"onMeasurePointLineDistance",data:{distance:S,positions:[].concat(n)}})}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),b.setInputAction((function(t){w(!0)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.startMeasureArcLength=function(e){e=s()({clamp:!0},e||{});var n=this;b&&b.destroy(),b=new Cesium.ScreenSpaceEventHandler(i.scene.canvas);var r=[],l=[],c=void 0,p=[],g="<p>左键拾圆弧起点</p>";function x(){b.destroy(),vt({map3d:t}),p.forEach((function(t){return d(t,!0)})),p=[],d(c,!1)}b.setInputAction((function(e){_t({map3d:t,content:g+"<p>右键取消</p>",position:[e.endPosition.x,e.endPosition.y]});var n,i=u.a.Util.pickCoord(s()({},e.endPosition,{relative:!0}));i&&(6===r.length&&(l=Xt((new u.a.Point3dCollection).fromLngLatHeightArray((n=r.slice(0,6)).concat.apply(n,h()(i.exportLngLatHeightArray()))))))}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),b.setInputAction((function(d){var w=u.a.Util.pickCoord(s()({},d.position,{relative:!0}));if(w)if(0===r.length){r.push.apply(r,h()(w.exportLngLatHeightArray()));var b=i.entities.add({name:"弧长测量点",position:w.exportCartesian().clone(),point:{pixelSize:new Cesium.CallbackProperty((function(){return m}),!1),color:new Cesium.CallbackProperty((function(){return y.color}),!1),disableDepthTestDistance:Number.POSITIVE_INFINITY,heightReference:Cesium.HeightReference.none}});(c=i.entities.add({polyline:{positions:new Cesium.CallbackProperty((function(){if(!c.hasConfirm)return Cesium.Cartesian3.fromDegreesArrayHeights(l)}),!1),material:new Cesium.ColorMaterialProperty(new Cesium.CallbackProperty((function(){return _.color}),!1)),width:new Cesium.CallbackProperty((function(){return v}),!1),clampToGround:e.clamp,classificationType:e.classificationType}})).hasConfirm=!1,c.tag=Dt,p.push(b),f.push(b),f.push(c),g="<p>左键拾圆弧终点</p>"}else if(3===r.length){r.push.apply(r,h()(w.exportLngLatHeightArray()));b=i.entities.add({name:"弧长测量点",position:w.exportCartesian().clone(),point:{pixelSize:new Cesium.CallbackProperty((function(){return m}),!1),color:new Cesium.CallbackProperty((function(){return y.color}),!1),disableDepthTestDistance:Number.POSITIVE_INFINITY,heightReference:Cesium.HeightReference.none}});p.push(b),f.push(b),g="<p>左键拾取控制点</p>"}else if(6===r.length){r.push.apply(r,h()(w.exportLngLatHeightArray())),l=Xt((new u.a.Point3dCollection).fromLngLatHeightArray(r));b=i.entities.add({name:"弧长测量点",position:w.exportCartesian().clone(),point:{pixelSize:new Cesium.CallbackProperty((function(){return m}),!1),color:new Cesium.CallbackProperty((function(){return y.color}),!1),disableDepthTestDistance:Number.POSITIVE_INFINITY,heightReference:Cesium.HeightReference.none}});p.push(b),f.push(b);var E=function(t,e){for(var n=0,i=0;i<t.length-3;i+=3){var r,o,s=(r=Cesium.Cartesian3).fromDegrees.apply(r,h()(t.slice(i,i+3))),a=(o=Cesium.Cartesian3).fromDegrees.apply(o,h()(t.slice(i+3,i+6)));n+=jt(s,a)}return n}(l),I=i.entities.add({name:"弧长测量点",position:w.exportCartesian().clone(),label:{text:"弧长："+E.toFixed(2)+"米",font:"14px sans-serif",style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.WHITE,showBackground:!0,backgroundColor:C.color,backgroundPadding:new Cesium.Cartesian2(8,5),outlineColor:Cesium.Color.BLACK,outlineWidth:3,disableDepthTestDistance:Number.POSITIVE_INFINITY,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,pixelOffset:new Cesium.Cartesian2(3,-3)}});c.polyline.positions=Cesium.Cartesian3.fromDegreesArrayHeights(l),c.hasConfirm=!0,c.labels=[I],c.distance=E,a[c.id]=[].concat(l),c.dm=qt(w,{offsetX:20,offsetY:20,map3d:t},(function(){Ht(c,o,a,i),l=[],n.emit({type:"onDelMeasureArcLength",data:{}})})),o.push(c),x(),n.emit({type:"onMeasureArcLength",data:{distance:E,positions:[].concat(l)}})}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),b.setInputAction((function(t){u.a.Util.pickCoordAnyway(s()({},t.position))&&(x(),d(c,!0))}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.finish=function(e){vt({map3d:t}),g(),b&&(b.destroy(),b=null,e||n.emit({type:"onFinish"})),Qt(i)},this.clear=function(){g(),o&&o.forEach((function(t){Ht(t,o,a,_cesium,!1)})),o=[],a={},l=[],c=[],p=[],n.emit({type:"onClear"})},this.destroy=function(){b&&b.destroy(),n.clear(),n.finish(),n.emit({type:"onDestroy"})},this.export=function(t){return Wt(o,a,t)},this.exportResult=function(){var t={positions:[],distances:[],clampdistances:[],angles:[],areas:[],projectdareas:[]};return o.forEach((function(e){"position"==e.tag?t.positions.push((new u.a.Point3d).fromCartesian(e.position)):"distance"==e.tag?t.distances.push(e.distances):"clampdistance"==e.tag?t.clampdistances.push(e.clampdistances):"angle"==e.tag?t.angles.push(e.angle):"area"==e.tag?t.areas.push(e.area):"projectedarea"==e.tag&&t.projectdareas.push(e.area)})),t}},r()(u.a.MeasureTool.prototype,u.a.EventManager.prototype);u.a.MeasureTool;function ee(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function ne(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!se(t[0])||!se(t[1]))throw new Error("coordinates must contain numbers");return ee({type:"Point",coordinates:t},e,n)}function ie(t,e,n){void 0===n&&(n={});for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return ee({type:"Polygon",coordinates:t},e,n)}function re(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return ee({type:"LineString",coordinates:t},e,n)}function oe(t,e,n){return void 0===n&&(n={}),ee({type:"MultiPolygon",coordinates:t},e,n)}function se(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}u.a.RouteRecorder=function(t){var e=this,n=t||{};this.config={speed:{name:"速度",type:u.a.PropertyType.Float,default:10},routeLoop:{name:"轨迹循环",type:u.a.PropertyType.Boolean,default:!0},loopPlay:{name:"循环",type:u.a.PropertyType.Boolean,default:!0},show:{name:"显示轨迹",type:u.a.PropertyType.Boolean,default:!1}};var i=isNaN(n.speed)?this.config.speed.default:n.speed;Object.defineProperty(this,"speed",{get:function(){return i},set:function(t){isNaN(t)||(i=t,e.instance.currentSpeed=i)},enumerable:!0});var r=!1!==n.routeLoop;Object.defineProperty(this,"routeLoop",{get:function(){return r},set:function(t){r=!!t,e.instance.loop=r},enumerable:!0});var o=!1!==n.loopPlay;Object.defineProperty(this,"loopPlay",{get:function(){return o},set:function(t){o=!!t,e.instance.loopPlay=o},enumerable:!0});var s=!0===n.show;Object.defineProperty(this,"show",{get:function(){return s},set:function(t){s=t,e.instance.showHelper=s,e.instance.showDirection=s},enumerable:!0});var a={xbsjType:"Path",positions:this.positions?this.positions:[],rotations:this.rotations?this.rotations:[],showHelper:s,loop:r,showDirection:s,playing:!1,loopPlay:o,currentSpeed:i,slices:0};this.instance=new XE.Obj.Path(I.apply(void 0,arguments)||_earthsdk),this.instance.xbsjFromJSON(a),this.instance&&(this.instance.cameraAttached=!1);var l=[],c=[],p=null,f=[],d=!1,g=function(){if(!(e.instance.currentD<=c[c.length-1]))return c.length;for(var t=0;t<c.length;t++)if(e.instance.currentD<=c[t])return t};this.addPoint=function(){var t=(new u.a.Point3d).fromCartesian(_cesium.camera.position);if(l.length>=1){var n=t.distanceTo(l[l.length-1]);c.length>=1?c.push(n+c[c.length-1]):c.push(n)}f.push({emit:!1}),l.push(t),e.instance.positions.push(t.exportRadianHeightArray()),e.instance.rotations.push([_cesium.camera.heading,_cesium.camera.pitch,_cesium.camera.roll])},this.play=function(){e.instance.playing=!0,e.instance.cameraAttached=!0,clearInterval(p),p=setInterval((function(){try{var t=g();if(t<f.length){var n=f[t];n&&(0==t&&0==d&&(d=!0,f.forEach((function(t){t.emit=!1}))),n.emit||(e.emit({type:"onIndexEventEmit",index:t}),n.emit=!0,t==c.length&&(d=!1)))}}catch(t){}}),100)},this.pause=function(){e.instance.playing=!1,e.instance.cameraAttached=!1,clearInterval(p)},this.clear=function(){e.instance.positions=[],e.instance.rotations=[],l=[],c=[],f=[],clearInterval(p),d=!1},this.removeAtIndex=function(t){e.instance.positions.splice(t,1),e.instance.rotations.splice(t,1)},this.import=function(t){try{t instanceof u.a.Point3dCollection&&t.forEach((function(t){e.instance.positions.push(t.exportRadianHeightArray()),e.instance.rotations.push(t.rotation)}))}catch(t){}},this.importPoint=function(t){try{t.points.forEach((function(t,n){var i=t.position,r=t.rotation;e.instance.positions.push(i),e.instance.rotations.push(r)}))}catch(t){throw new Error("传入的目标对象错误")}},this.export=function(){var t=new u.a.Point3dCollection;return this.instance.positions.forEach((function(n,i){var r,o=(r=new u.a.Point3d).fromRadian.apply(r,h()(n));o.rotation=e.instance.rotations[i],t.addPoint3d(o)})),t},this.export2=function(){return{positions:this.instance.positions,rotations:this.instance.rotations}},this.import2=function(t){if(this.instance.positions=t.positions,this.instance.rotations=t.rotations,f=[],l=[],c=[],this.instance.positions.forEach((function(t){var e,n=(e=new u.a.Point3d).fromRadian.apply(e,h()(t));l.push(n),f.push({emit:!1})})),l.length>=1)for(var e=1;e<l.length;e++){var n=l[e].distanceTo(l[e-1]);c.length>=1?c.push(n+c[c.length-1]):c.push(n)}}},r()(u.a.RouteRecorder.prototype,u.a.EventManager.prototype),u.a.RouteRecorder.prototype.destroy=function(){this.clear(),this.instance&&(this.instance.cameraAttached=!1,this.instance.destroy(),this.instance=null)};u.a.RouteRecorder;function ae(t){(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame||function(t){window.clearTimeout(t)})(t)}u.a.ShadowAnalysis=function(t){var e=this,n=t||{};this.config={startTime:{name:"开始时间",type:u.a.PropertyType.Int,default:6},endTime:{name:"结束时间",type:u.a.PropertyType.Int,default:20},currentTime:{name:"当前时间",type:u.a.PropertyType.Int,default:6},speed:{name:"速度",type:u.a.PropertyType.Int,default:1},initTime:{name:"初始时间",type:u.a.PropertyType.Float,default:new Date((new Date).toLocaleDateString()).getTime()}};var i=isNaN(n.startTime)?this.config.startTime.default:n.startTime;Object.defineProperty(this,"startTime",{get:function(){return i},set:function(t){isNaN(t)||(i=t)},enumerable:!0});var r=isNaN(n.endTime)?this.config.endTime.default:n.endTime;Object.defineProperty(this,"endTime",{get:function(){return r},set:function(t){isNaN(t)||(r=t)},enumerable:!0});var o=isNaN(n.currentTime)?this.config.currentTime.default:n.currentTime;Object.defineProperty(this,"currentTime",{get:function(){return o},set:function(t){isNaN(t)||(o=t)},enumerable:!0});var s=isNaN(n.speed)?this.config.speed.default:n.speed;Object.defineProperty(this,"speed",{get:function(){return s},set:function(t){isNaN(t)||(s=t)},enumerable:!0});var a=isNaN(n.initTime)?this.config.initTime.default:n.initTime;Object.defineProperty(this,"initTime",{get:function(){return a},set:function(t){isNaN(t)||(a=t)},enumerable:!0});var l=null,c=function t(){if(o>r)e.clear();else{var n=a+60*o*60*1e3;_cesium.clock.currentTime=Cesium.JulianDate.fromDate(new Date(n)),o+=.01*s,i=function(){return t()},l=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)})(i)}var i};this.start=function(){_cesium.scene.globe.enableLighting=!0,_cesium.shadows=Cesium.ShadowMode.ENABLED,_cesium.terrainShadows=Cesium.ShadowMode.ENABLED,_cesium.shouldAnimate=!0,_cesium.shadowMap.maximumDistance=5e3,_cesium.shadowMap.softShadows=!0,_cesium.shadowMap.darkness=.3,c()},this.stop=function(){l&&(ae(l),l=null)},this.clear=function(){l&&(ae(l),l=null),o=i,_cesium.scene.globe.enableLighting=!1,_cesium.shadows=Cesium.ShadowMode.DISABLED,_cesium.terrainShadows=Cesium.ShadowMode.DISABLED},this.addSpeed=function(){(s+=2)>10&&(s=1)}};u.a.ShadowAnalysis;var le=n(25),ue=n.n(le);function ce(t,e){t.scene.globe;var n=[2,2],i=[],r=new Array(e.length);return e.forEach((function(e,o){var s=function(e){try{var i=new Cesium.Cartesian2(e[0],e[1]);if(t.scene.pick(i,n[0],n[1])){var r=t.scene.pickPosition(i);return null==r&&console.warn("pick position fail",e),r}}catch(t){console.error(t)}}(e);if(void 0===s)i.push(e);else{var a=Cesium.Cartographic.fromCartesian(s),l=[Cesium.Math.toDegrees(a.longitude),Cesium.Math.toDegrees(a.latitude),a.height];r[o]=l}})),{points:r}}function he(t,e){console.debug("extract start");var n=(new Date).getTime(),i=function(t,e){var n=t.canvas.width,i=t.canvas.height,r=t.scene.drawingBufferHeight,o=t.scene.context._gl,s=o.createFramebuffer();if(o.bindFramebuffer(o.FRAMEBUFFER,s),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e._texture,0),o.checkFramebufferStatus(o.FRAMEBUFFER)==o.FRAMEBUFFER_COMPLETE){var a=new Uint8Array(n*i*4);o.readPixels(0,0,n,i,o.RGBA,o.UNSIGNED_BYTE,a);for(var l=[],u=0;u<i;u++)for(var c=0;c<n;c++){var h=[c,r-u],p=4*(h[1]*n+h[0]),f=a.slice(p,p+4);255===f[0]&&255===f[3]&&l.push([c,u])}return l}return console.warn("checkFramebufferStatus failed"),[]}(t,e);i=function(t){if((t=t.sort((function(t,e){return t[0]-e[0]})).map((function(t,e,n){if(!(n[e-1]&&n[e-1][0]===t[0]||n[e+1]&&n[e+1][0]===t[0]))return t})).filter(Boolean)).length>0){var e=pt.lineString(t,{});t=pt.simplify(e,{tolerance:.01,highQuality:!0}).geometry.coordinates}return t}(i);(new Date).getTime();var r=ce(t,i).points;return console.debug("extract finish, total cost: ",(new Date).getTime()-n,"ms"),{pixels:i,points:r,size:[t.canvas.width,t.canvas.height]}}function pe(t,e,n){return t.map((function(t,i){var r=n.map((function(t){var n=function(t){var n=e[t.join(",")];if(n&&ue()(n).length>0)return n}(t);if(n&&n[i])return{pixel:t,value:n[i]}})).filter(Boolean);if(r.length>0)return new Cesium.LinearSpline({times:r.map((function(t){return t.pixel[0]})),points:r.map((function(t){return new(Function.prototype.bind.apply(Cesium.Cartesian3,[null].concat(h()(t.value))))}))})})).filter(Boolean)}function fe(t,e){var n,i,r,o=e.canvas,s=o.getContext("2d"),a=e.padding||[10,10],l=e.skylineExtractSize,u=(n=t.map((function(t){return t.pixelPoints})),i=l,r=n.map((function(t){if(t.length>0){var e=[t[0][0],i[1],t[t.length-1][0],0];return t.forEach((function(t){e[1]=Math.min(e[1],t[1]),e[3]=Math.max(e[3],t[1])})),e}return[0,0,0,0]})),[Math.min.apply(Math,h()(r.map((function(t){return t[0]})))),Math.min.apply(Math,h()(r.map((function(t){return t[1]})))),Math.max.apply(Math,h()(r.map((function(t){return t[2]})))),Math.max.apply(Math,h()(r.map((function(t){return t[3]}))))]),c=[o.width,(u[3]-u[1])*((o.width-2*a[0])/l[0])+2*a[1]];o.height=c[1],s.clearRect(0,0,o.width,o.height);var p=c[1],f=[u[2]-u[0],u[3]-u[1]],d=[(c[0]-2*a[0])/f[0],(c[1]-2*a[1])/f[1]],g={},y=[];t.forEach((function(t,n){var i=t.pixelPoints,r=t.geoPoints;s.strokeStyle=e.skylineColor?e.skylineColor[n]:"#f00",s.lineWidth=e.skylineWidth?e.skylineWidth[n]:1,s.beginPath(),i.forEach((function(t,e){var i=function(t){return[Math.round(d[0]*t[0]+a[0]),Math.round(d[0]*(t[1]-u[1])+a[1])]}(t);0===e?s.moveTo.apply(s,h()(i)):s.lineTo.apply(s,h()(i));var o=i.join(","),l=g[o]||{},c=r[e];c&&(l[n]=c),g[o]=l,y.push(i)})),s.stroke()})),s.strokeStyle=e.xAxisColor||"#000",s.lineWidth=e.xAxisWidth||3,s.beginPath(),s.moveTo(0,p),s.lineTo(c[0],p),s.stroke(),s.strokeStyle=e.yAxisColor||"#000",s.lineWidth=e.yAxisWidth||3,s.beginPath(),s.moveTo(0,p),s.lineTo(0,0),s.stroke(),o.style.cursor="crosshair";var m=e.onHover,_=pe(t,g,y);if(m){var v=function(t){var e=t.offsetX,n=t.offsetY,i=s.getImageData.apply(s,[e,n].concat([3,3]));if(i&&i.data.filter(Boolean).length>0){var r={};_.forEach((function(t,n){var i=t.evaluate(e,new Cesium.Cartesian3);r[n]=[i.x,i.y,i.z]})),ue()(r).length>0?m([e,n],r,o):m([e,n],null,o)}else m([e,n],null,o)};o.addEventListener("mousemove",v),o.__mouse_move=v}return o}function de(t,e,n){var i=document.getElementById("skyline-2d-tip");!i&&n&&((i=document.createElement("div")).setAttribute("id","skyline-2d-tip"),i.style.position="absolute",i.style["z-index"]=9999,i.classList.add("skyline-2d-tip"),t.parentElement.appendChild(i)),i&&(i.style.display="none",i.innerHTML=""),n&&(i.style.display="block",i.innerHTML=""+n,i.style.left=t.offsetLeft+e[0]+10+"px",i.style.top=t.offsetTop+e[1]+"px",e[0]>1*t.width/2?i.style.transform="translate(-100%, 10px)":i.style.transform="translate(0px, 0px)")}var ge=null;function ye(){u.a.Util.beforePickingPosition(_cesium);var t=Cesium.PostProcessStageLibrary.createEdgeDetectionStage();ge=new Cesium.PostProcessStage({name:"czm_skylinetemp",fragmentShader:"uniform sampler2D colorTexture;uniform sampler2D depthTexture;varying vec2 v_textureCoordinates;void main(void){float depth = czm_readDepth(depthTexture, v_textureCoordinates);vec4 color = texture2D(colorTexture, v_textureCoordinates);if(depth<1.0 - 0.000001){gl_FragColor = color;}else{gl_FragColor = vec4(1.0,0.0,0.0,1.0);}}"});var e=new Cesium.PostProcessStage({name:"czm_skylinetemp1",fragmentShader:"uniform sampler2D colorTexture;uniform sampler2D redTexture;uniform sampler2D silhouetteTexture;varying vec2 v_textureCoordinates;void main(void){vec4 redcolor=texture2D(redTexture, v_textureCoordinates);vec4 silhouetteColor = texture2D(silhouetteTexture, v_textureCoordinates);vec4 color = texture2D(colorTexture, v_textureCoordinates);if(redcolor.r == 1.0){gl_FragColor = mix(color, vec4(1.0,0.0,0.0,1.0), silhouetteColor.a);}else{gl_FragColor = color;}}",uniforms:{redTexture:ge.name,silhouetteTexture:t.name}});ge=new Cesium.PostProcessStageComposite({name:"czm_skyline",stages:[t,ge,e],inputPreviousStageTexture:!1,uniforms:t.uniforms}),_cesium.scene.postProcessStages.add(ge)}function me(){ge&&(_cesium.scene.postProcessStages.remove(ge),ge=null),u.a.Util.afterPickPosition(_cesium)}function _e(t){return new l.a((function(e,n){var i={destination:t.position,duration:3,easingFunction:Cesium.EasingFunction.EXPONENTIAL_IN_OUT,direction:t.direction,up:t.up,orientation:{heading:t.rote.heading||0,pitch:t.rote.pitch||0,roll:t.rote.roll||0},complete:function(){e()}};_cesium.camera.flyTo(i)}))}u.a.SkyAnalysis=function(t){var e=t||{},n=P.apply(void 0,arguments)||_cesium;this.config={points:{name:"观测点集合",type:Array,default:[],noConfig:!0}};var i=-1,r=isNaN(e.points)?this.config.points.default:e.points;Object.defineProperty(this,"points",{get:function(){return r},set:function(t){isNaN(t)||(r=t)},enumerable:!0}),this.addPoint=function(){var t=this.getStats(),e=t.up,n=t.direction,i=t.position,o=t.heading,s=t.pitch,a=t.roll,l={};l.position=i,l.direction=n,l.up=e,l.rote={heading:o,pitch:s,roll:a},r.push(l)},this.getStats=function(){return _cesium?{up:_cesium.camera.up.clone(),direction:_cesium.camera.direction.clone(),position:_cesium.camera.position.clone(),heading:_cesium.camera.heading,pitch:_cesium.camera.pitch,roll:_cesium.camera.roll}:null},this.getAllPoint=function(){return r},this.clearAllPoints=function(){r=[],me()},this.clearSkyLines=function(){ge&&me()},this.deleteSpecified=function(t){t===i&&this.clearSkyLines(),r.splice(t,1)},this.start=function(t){i=t,me(),_e(r[t]).then((function(t){ge||ye()}))},this.extract2D=function(){return new l.a((function(t,e){var i=function(){return ge.get(ge.length-1).outputTexture};if(ge)t(he(n,i()));else{ye();var r=n.scene.postRender.addEventListener((function(){r&&r(),r=null,setTimeout((function(){return t(he(n,i()))}),30)}))}}))},this.draw2D=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t&&t.length>0){var n=t[0].size,i=e.tipFunction||function(t){var e="";null!=t&&(e="<span>高程："+t[ue()(t)[0]][2].toFixed(1)+" 米</span>");return e};return this.clearDraw2D(e),fe(t.map((function(t){var e=t.pixels,n=t.points;t.size;return{pixelPoints:e,geoPoints:n}})),s()({skylineExtractSize:n},e,{onHover:function(t,e,n){de(n,t,i(e))}}))}},this.clearDraw2D=function(t){if(t&&t.canvas){var e=t.canvas;e.getContext("2d").clearRect(0,0,e.width,e.height),e.__mouse_move&&(e.removeEventListener("mousemove",e.__mouse_move),delete e.__mouse_move)}}};u.a.SkyAnalysis;var ve=n(116),xe=n.n(ve),Ce=n(117),we=n.n(Ce),be=Cesium.Color.fromBytes(44,50,132,204),Ee=new Cesium.Color(0,1,.699,1);function Ie(t){t=t||{},this._definitionChanged=new Cesium.Event,this._baseWaterColor=void 0,this._blendColor=void 0,this._normalMap=void 0,this._frequency=void 0,this._speed=void 0,this._amplitude=void 0,this.baseWaterColor=t.baseWaterColor,this.blendColor=t.blendColor,this.normalMap=t.normalMap,this.frequency=t.frequency,this.speed=t.speed,this.amplitude=t.amplitude}j()(Ie.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},baseWaterColor:Cesium.createPropertyDescriptor("baseWaterColor"),blendColor:Cesium.createPropertyDescriptor("blendColor"),normalMap:Cesium.createPropertyDescriptor("normalMap"),frequency:Cesium.createPropertyDescriptor("frequency"),speed:Cesium.createPropertyDescriptor("speed"),amplitude:Cesium.createPropertyDescriptor("amplitude")}),Ie.prototype.getType=function(t){return"Water"},Ie.prototype.getValue=function(t,e){return Cesium.defined(e)||(e={}),e.baseWaterColor=Cesium.Property.getValueOrClonedDefault(this._baseWaterColor,t,be,e.baseWaterColor),e.blendColor=Cesium.Property.getValueOrClonedDefault(this._blendColor,t,Ee,e.blendColor),e.normalMap=Cesium.Property.getValueOrDefault(this._normalMap,t,Sf3d.RelativePath+"assets/water_normal.jpg",e.normalMap),e.frequency=Cesium.Property.getValueOrDefault(this._frequency,t,500,e.frequency),e.animationSpeed=Cesium.Property.getValueOrDefault(this._speed,t,.01,e.animationSpeed),e.amplitude=Cesium.Property.getValueOrDefault(this._amplitude,t,10,e.amplitude),e},Ie.prototype.equals=function(t){return this===t||t instanceof Ie&&Cesium.Property.equals(this.baseWaterColor,t.baseWaterColor)&&Cesium.Property.equals(this.blendColor,t.blendColor)&&Cesium.Property.equals(this.normalMap==t.normalMap)&&this.frequency==t.frequency&&this.speed==t.speed&&this.amplitude==t.amplitude};var Pe=Ie,Ne=Cesium.Math.RADIANS_PER_DEGREE,Se=Cesium.Math.DEGREES_PER_RADIAN;u.a.FloodAnalysis=function(t){new Te("左键绘制,右键结束","marker-tip",_cesium).visible=!1;var e=null,n=null,i=null,r=null,o=[],a=null,l=null;this.config={maxHeight:{name:"最大淹没高度",type:u.a.PropertyType.Float,default:0},minHeight:{name:"最小淹没高度",type:u.a.PropertyType.Float,default:0},currentHeight:{name:"当前高度",type:u.a.PropertyType.Float,default:0},step:{name:"速度",type:u.a.PropertyType.Float,default:1}};var c=null==t.maxHeight?this.config.maxHeight.default:t.maxHeight;Object.defineProperty(this,"maxHeight",{get:function(){return c},set:function(t){isNaN(t)||(c=t)},enumerable:!0});var p=null==t.minHeight?this.config.minHeight.default:t.minHeight;Object.defineProperty(this,"minHeight",{get:function(){return p},set:function(t){isNaN(t)||(p=t)},enumerable:!0});var f=t.currentHeight?t.currentHeight:this.config.currentHeight.default;Object.defineProperty(this,"currentHeight",{get:function(){return f},set:function(t){isNaN(t)||(f=t)},enumerable:!0});var d=t.step?t.step:this.config.step.default;Object.defineProperty(this,"step",{get:function(){return d},set:function(t){isNaN(t)||(d=t)},enumerable:!0});var g=void 0;this.startDraw=function(){if(!_cesium)throw new Error("无cesium实列,请检查文件是否正常引用");i&&this.clear(),vt();var t=!0,e=_cesium;g&&g.destroy(),g=new Cesium.ScreenSpaceEventHandler(e.scene.canvas);var n=[],r=[],s=[],a=null;document.body.style.cursor="cross",g.setInputAction((function(i){if(!t)return!1;_t({position:[i.endPosition.x,i.endPosition.y],content:n.length>6?"<p>左键绘制</p><p>右键结束</p>":"<p>左键绘制</p><p>右键取消</p>"});var r=e.camera.getPickRay(i.endPosition);if(n.length>=3){var o=e.scene.globe.pick(r,e.scene);o&&(s=(new u.a.Point3d).fromCartesian(o).exportLngLatHeightArray())}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),g.setInputAction((function(r){if(!t)return!1;_t({position:[r.position.x,r.position.y],content:n.length>6?"<p>左键绘制</p><p>右键结束</p>":"<p>左键绘制</p><p>右键取消</p>"}),document.onmousemove=null;var o,l=e.camera.getPickRay(r.position),c=e.scene.globe.pick(l,e.scene),p=(new u.a.Point3d).fromCartesian(c);if(0==n.length)(o=n).push.apply(o,h()(p.exportLngLatHeightArray())),a=e.entities.add({position:n[n.length-1],polyline:{positions:new Cesium.CallbackProperty((function(){return Cesium.Cartesian3.fromDegreesArrayHeights(n.concat(s))}),!1),material:Cesium.Color.fromCssColorString("rgba(247,224,32,1)"),heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,width:2}});else if(3==n.length){var f;(f=n).push.apply(f,h()(p.exportLngLatHeightArray())),i=e.entities.add({polygon:{hierarchy:new Cesium.CallbackProperty((function(){return i&&i.hasConfirm?new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(n)):new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(n.concat(s)))}),!1),perPositionHeight:!1,material:Cesium.Color.fromCssColorString("rgba(247,224,32,0.5)")}}),vt(),e.entities.remove(a)}else{var d;(d=n).push.apply(d,h()(p.exportLngLatHeightArray())),n[n.length-1]=0}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),g.setInputAction((function(l){if(!t)return!1;if(document.onmousemove=null,g.destroy(),vt(),3===n.length)e.entities.remove(a);else if(6===n.length)e.entities.remove(i);else{var u=[];n.forEach((function(t,e){e%3==0&&u.push({lon:n[e],lat:n[e+1],hei:n[e+2]})})),o=u||[],r.push(n.concat([])),i.hasConfirm=!0,i.polygon.hierarchy=new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(n))}t=!1,n=[],r=[],s=[],a=null,g=null,document.body.style.cursor="default"}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},this.start=function(t){null==t?t=c:c=t,i&&(e||(e=_cesium.entities.add({polygon:{hierarchy:i.polygon.clone().hierarchy.getValue(),perPositionHeight:!1,height:new Cesium.CallbackProperty((function(){return p}),!1),extrudedHeight:new Cesium.CallbackProperty((function(){return f}),!1),material:Cesium.Color.fromBytes(64,157,253,150)}})),n||(n=_cesium.entities.add({polygon:{hierarchy:i.polygon.clone().hierarchy.getValue(),height:new Cesium.CallbackProperty((function(){return f}),!1),material:new Pe({baseWaterColor:Cesium.Color.fromBytes(64,157,253,255),speed:.03})}})),f>=t&&(f=0),y(t))},this.clear=function(){g&&(g.destroy(),g=null),this.stopAnalysis(),vt(),e&&(_cesium.entities.remove(e),e=null),n&&(_cesium.entities.remove(n),n=null),i&&(_cesium.entities.remove(i),i=null),this.removeHeightLabels()};var y=function t(){f>=c?r&&Me(r):(f=Math.min(c,f+d),r=Le(t))};function m(t,e){t&&l&&(_cesium.entities.remove(l),l=null),e&&a&&(_cesium.entities.remove(a),a=null)}this.stopAnalysis=function(){r&&Me(r)},this.countMeasure=function(){if(!o.length)throw new Error("无法获取到面的标记点,无法计算");for(var t=0,e=0;e<o.length-2;e++){var n=(e+1)%o.length,i=(e+2)%o.length,r=Re(o[e],o[n],o[i]);t+=Oe((new u.a.Point3d).fromLngLat(o[e].lon,o[e].lat,o[e].hei).exportCartesian(),(new u.a.Point3d).fromLngLat(o[n].lon,o[n].lat,o[n].hei).exportCartesian())*Oe((new u.a.Point3d).fromLngLat(o[n].lon,o[n].lat,o[n].hei).exportCartesian(),(new u.a.Point3d).fromLngLat(o[i].lon,o[i].lat,o[i].hei).exportCartesian())*Math.abs(Math.sin(r))}return t},this.calcVolume=function(){var t=c-p;return this.countMeasure()*t},this.addHeightLabel=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{label:{},point:{}};if(!t||!e)return null;m("min"===e,"max"===e);var i=_cesium.entities.add({position:t.exportCartesian(),point:s()({pixelSize:5,color:Cesium.Color.RED,disableDepthTestDistance:Number.POSITIVE_INFINITY,heightReference:Cesium.HeightReference.none},n.point),label:s()({text:"最"+("max"===e?"高":"低")+"点："+t.height.toFixed(2)+"米",font:"14px sans-serif",style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.WHITE,showBackground:!0,backgroundColor:Cesium.Color.BLACK.withAlpha(.5),backgroundPadding:new Cesium.Cartesian2(8,5),outlineColor:Cesium.Color.BLACK,outlineWidth:3,disableDepthTestDistance:Number.POSITIVE_INFINITY,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,pixelOffset:new Cesium.Cartesian2(3,-3)},n.label)});return i.tag="flood-height","max"===e?a=i:l=i,i},this.removeHeightLabels=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;void 0===t?m(!0,!0):"max"===t?m(!1,!0):"min"===t&&m(!0,!1)}};var Te=function(){function t(e,n,i){xe()(this,t);var r=document.createElement("div");r.id=n||"cursor-tip",r.className="cursor-tip-class",r.innerHTML=e,r.style.position="absolute",r.style.background="#fff",document.body.appendChild(r),this.ele=r,this._visible=!1,this._show=!0;var o=this;i instanceof Cesium.Viewer&&i.screenSpaceEventHandler.setInputAction((function(t){o.updatePosition(t.endPosition)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE)}return we()(t,[{key:"updatePosition",value:function(t){this.ele.style.left=t.x+10+"px",this.ele.style.top=t.y+10+"px"}},{key:"updateText",value:function(t){this.ele.innerHTML=t}},{key:"remove",value:function(){var t=document.getElementById(this.ele.id);t&&document.body.removeChild(t)}},{key:"visible",get:function(){return this._visible},set:function(t){return this._visible=t,this.ele.style.display=t?"block":"none",!0}},{key:"show",set:function(t){if(this._show=t,t)return this.ele.style.opacity=1,void(this.ele.style.visibility="visible");this.ele.style.opacity=0,this.ele.style.visibility="visible"},get:function(){return this._show}}]),t}(),Le=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},Me=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame||function(t){window.clearTimeout(t)},Oe=function(t,e){var n=Cesium.Cartographic.fromCartesian(t),i=Cesium.Cartographic.fromCartesian(e),r=new Cesium.EllipsoidGeodesic;r.setEndPoints(n,i);var o=r.surfaceDistance;return o=Math.sqrt(Math.pow(o,2)+Math.pow(i.height-n.height,2))},Re=function(t,e,n){var i=Ae(e,t)-Ae(e,n);return i<0&&(i+=360),i>180&&(i=360-i),i},Ae=function(t,e){var n=t.lat*Ne,i=t.lon*Ne,r=e.lat*Ne,o=e.lon*Ne,s=-Math.atan2(Math.sin(i-o)*Math.cos(r),Math.cos(n)*Math.sin(r)-Math.sin(n)*Math.cos(r)*Math.cos(i-o));return s<0&&(s+=2*Math.PI),s*=Se},De=(u.a.FloodAnalysis,n(13));function Fe(t,e,n){if(!Be(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&Ge(i),r&&je(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function ke(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Be(t){return!!t&&t.constructor===Object}function Ge(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!ke(t))throw new Error("bbox must only contain numbers")}))}function je(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function ze(t,e,n){if(null!==t)for(var i,r,o,s,a,l,u,c,h=0,p=0,f=t.type,d="FeatureCollection"===f,g="Feature"===f,y=d?t.features.length:1,m=0;m<y;m++){a=(c=!!(u=d?t.features[m].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var _=0;_<a;_++){var v=0,x=0;if(null!==(s=c?u.geometries[_]:u)){l=s.coordinates;var C=s.type;switch(h=!n||"Polygon"!==C&&"MultiPolygon"!==C?0:1,C){case null:break;case"Point":if(!1===e(l,p,m,v,x))return!1;p++,v++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===e(l[i],p,m,v,x))return!1;p++,"MultiPoint"===C&&v++}"LineString"===C&&v++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(r=0;r<l[i].length-h;r++){if(!1===e(l[i][r],p,m,v,x))return!1;p++}"MultiLineString"===C&&v++,"Polygon"===C&&x++}"Polygon"===C&&v++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for("MultiPolygon"===C&&(x=0),r=0;r<l[i].length;r++){for(o=0;o<l[i][r].length-h;o++){if(!1===e(l[i][r][o],p,m,v,x))return!1;p++}x++}v++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===ze(s.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Ue(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function qe(t,e){var n,i,r,o,s,a,l,u,c,h,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(n=0;n<g;n++){for(a=f?t.features[n].geometry:d?t.geometry:t,u=f?t.features[n].properties:d?t.properties:{},c=f?t.features[n].bbox:d?t.bbox:void 0,h=f?t.features[n].id:d?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,p,u,c,h))return!1;break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===e(o.geometries[i],p,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,u,c,h))return!1;p++}}function Ve(t,e){qe(t,(function(t,n,i,r,o){var s,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==e(Fe(t,i,{bbox:r,id:o}),n,0)&&void 0}switch(a){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(Fe({type:s,coordinates:u},i),n,l))return!1}}))}function He(t){return!!t&&t.constructor===Object}var Ye=function(t,e){if(!He(e=e||{}))throw new Error("options is invalid");var n=e.precision,i=e.coordinates,r=e.mutate;if(n=null==n||isNaN(n)?6:n,i=null==i||isNaN(i)?3:i,!t)throw new Error("<geojson> is required");if("number"!=typeof n)throw new Error("<precision> must be a number");if("number"!=typeof i)throw new Error("<coordinates> must be a number");!1!==r&&void 0!==r||(t=JSON.parse(JSON.stringify(t)));var o=Math.pow(10,n);return ze(t,(function(t){!function(t,e,n){t.length>n&&t.splice(n,t.length);for(var i=0;i<t.length;i++)t[i]=Math.round(t[i]*e)/e}(t,o,i)})),t};function Xe(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&t.length>=2&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function We(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Ke(t){if(!t)throw new Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw new Error("geojson must be a valid Feature or Geometry Object")}function Ze(t,e,n){if(!Qe(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&$e(i),r&&tn(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function Je(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Qe(t){return!!t&&t.constructor===Object}function $e(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!Je(t))throw new Error("bbox must only contain numbers")}))}function tn(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function en(t,e,n){if(!rn(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&on(i),r&&sn(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function nn(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function rn(t){return!!t&&t.constructor===Object}function on(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!nn(t))throw new Error("bbox must only contain numbers")}))}function sn(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function an(t){var e,n,i,r,o,s=We(t);if(2===s.length&&(e=s[0],n=s[1],e[0]!==n[0]||e[1]!==n[1]))return s;var a=[],l=s.length-1;a.push(s[0]);for(var u=1;u<l;u++)i=s[u-1],r=s[u],ln(i,o=s[u+1],r)||a.push(r);return a.push(o),a}function ln(t,e,n){var i=n[0],r=n[1],o=t[0],s=t[1],a=e[0],l=e[1],u=a-o,c=l-s;return 0===(i-o)*c-(r-s)*u&&(Math.abs(u)>=Math.abs(c)?u>0?o<=i&&i<=a:a<=i&&i<=o:c>0?s<=r&&r<=l:l<=r&&r<=s)}var un=function(t,e){var n="object"==typeof e?e.mutate:e;if(!t)throw new Error("geojson is required");var i=function(t,e){if(!t)throw new Error((e||"geojson")+" is required");if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error((e||"geojson")+" is invalid")}(t),r=[];switch(i){case"LineString":r=an(t);break;case"MultiLineString":case"Polygon":We(t).forEach((function(t){r.push(an(t))}));break;case"MultiPolygon":We(t).forEach((function(t){var e=[];t.forEach((function(t){e.push(an(t))})),r.push(e)}));break;case"Point":return t;case"MultiPoint":var o={};We(t).forEach((function(t){var e=t.join("-");o.hasOwnProperty(e)||(r.push(t),o[e]=!0)}));break;default:throw new Error(i+" geometry not supported")}return t.coordinates?!0===n?(t.coordinates=r,t):{type:i,coordinates:r}:!0===n?(t.geometry.coordinates=r,t):en({type:i,coordinates:r},t.properties,t.bbox,t.id)};var cn=function(t,e){var n=Ke(t),i=Ke(e);if(un(Ye(i,{precision:4})).coordinates[0].length<4)return null;if(un(Ye(n,{precision:4})).coordinates[0].length<4)return null;var r=new De.GeoJSONReader,o=r.read(Ye(n)),s=r.read(Ye(i)),a=De.OverlayOp.intersection(o,s);return a.isEmpty()?null:Ze((new De.GeoJSONWriter).write(a))};var hn=function(){for(var t=new De.GeoJSONReader,e=t.read(JSON.stringify(arguments[0].geometry)),n=1;n<arguments.length;n++)e=De.UnionOp.union(e,t.read(JSON.stringify(arguments[n].geometry)));var i=new De.GeoJSONWriter;return{type:"Feature",geometry:e=i.write(e),properties:arguments[0].properties}};function pn(t){var e=0;if(t&&t.length>0){e+=Math.abs(fn(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(fn(t[n]))}return e}function fn(t){var e,n,i,r,o,s,a=0,l=t.length;if(l>2){for(s=0;s<l;s++)s===l-2?(i=l-2,r=l-1,o=0):s===l-1?(i=l-1,r=0,o=1):(i=s,r=s+1,o=s+2),e=t[i],n=t[r],a+=(dn(t[o][0])-dn(e[0]))*Math.sin(dn(n[1]));a=6378137*a*6378137/2}return a}function dn(t){return t*Math.PI/180}var gn=function(t){return function(t,e,n){var i=n;return qe(t,(function(t,r,o,s,a){i=0===r&&void 0===n?t:e(i,t,r,o,s,a)})),i}(t,(function(t,e){return t+function t(e){var n,i=0;switch(e.type){case"Polygon":return pn(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=pn(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}}(e)}),0)};function yn(t,e,n){if(!_n(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&vn(i),r&&xn(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function mn(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function _n(t){return!!t&&t.constructor===Object}function vn(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!mn(t))throw new Error("bbox must only contain numbers")}))}function xn(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function Cn(t){switch(t.type){case"Polygon":return gn(t)>1?t:null;case"MultiPolygon":var e=[];if(Ve(t,(function(t){gn(t)>1&&e.push(t.geometry.coordinates)})),e.length)return{type:"MultiPolygon",coordinates:e}}}var wn=function(t,e){var n=Ke(t),i=Ke(e),r=t.properties||{};if(n=Cn(n),i=Cn(i),!n)return null;if(!i)return yn(n,r);var o=new De.GeoJSONReader,s=o.read(n),a=o.read(i),l=De.OverlayOp.difference(s,a);return l.isEmpty()?null:yn((new De.GeoJSONWriter).write(l),r)};function bn(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function En(t,e){return t<e?-1:t>e?1:0}var In=function(t,e,n,i,r){!function t(e,n,i,r,o){for(;r>i;){if(r-i>600){var s=r-i+1,a=n-i+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(a-s/2<0?-1:1),h=Math.max(i,Math.floor(n-a*u/s+c)),p=Math.min(r,Math.floor(n+(s-a)*u/s+c));t(e,n,h,p,o)}var f=e[n],d=i,g=r;for(bn(e,i,n),o(e[r],f)>0&&bn(e,i,r);d<g;){for(bn(e,d,g),d++,g--;o(e[d],f)<0;)d++;for(;o(e[g],f)>0;)g--}0===o(e[i],f)?bn(e,i,g):(g++,bn(e,g,r)),g<=n&&(i=g+1),n<=g&&(r=g-1)}}(t,e,n||0,i||t.length-1,r||En)};function Pn(t,e){if(!(this instanceof Pn))return new Pn(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function Nn(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function Sn(t,e){Tn(t,0,t.children.length,e,t)}function Tn(t,e,n,i,r){r||(r=kn(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],Ln(r,t.leaf?i(o):o);return r}function Ln(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Mn(t,e){return t.minX-e.minX}function On(t,e){return t.minY-e.minY}function Rn(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function An(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Dn(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Fn(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function kn(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Bn(t,e,n,i,r){for(var o,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=i||(o=e+Math.ceil((n-e)/i/2)*i,In(t,o,e,n,r),s.push(e,o,o,n))}Pn.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!Fn(t,e))return n;for(var r,o,s,a,l=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],Fn(t,a=e.leaf?i(s):s)&&(e.leaf?n.push(s):Dn(t,a)?this._all(s,n):l.push(s));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!Fn(t,e))return!1;for(var i,r,o,s,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],Fn(t,s=e.leaf?n(o):o)){if(e.leaf||Dn(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=kn([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,s=this.data,a=this.toBBox(t),l=[],u=[];s||l.length;){if(s||(s=l.pop(),i=l[l.length-1],n=u.pop(),o=!0),s.leaf&&-1!==(r=Nn(t,s.children,e)))return s.children.splice(r,1),l.push(s),this._condense(l),this;o||s.leaf||!Dn(s,a)?i?(n++,s=i.children[n],o=!1):s=null:(l.push(s),u.push(n),n=0,i=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:Mn,compareMinY:On,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,s=this._maxEntries;if(o<=s)return Sn(r=kn(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(r=kn([])).leaf=!1,r.height=i;var a,l,u,c,h=Math.ceil(o/s),p=h*Math.ceil(Math.sqrt(s));for(Bn(t,e,n,p,this.compareMinX),a=e;a<=n;a+=p)for(Bn(t,a,u=Math.min(a+p-1,n),h,this.compareMinY),l=a;l<=u;l+=h)c=Math.min(l+h-1,u),r.children.push(this._build(t,l,c,i-1));return Sn(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,s,a,l,u,c,h,p,f;i.push(e),!e.leaf&&i.length-1!==n;){for(c=h=1/0,r=0,o=e.children.length;r<o;r++)l=Rn(s=e.children[r]),p=t,f=s,(u=(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-l)<h?(h=u,c=l<c?l:c,a=s):u===h&&l<c&&(c=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),Ln(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),s=kn(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,Sn(n,this.toBBox),Sn(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=kn([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Sn(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,s,a,l,u,c,h,p,f,d,g,y;for(l=u=1/0,i=e;i<=n-e;i++)r=Tn(t,0,i,this.toBBox),o=Tn(t,i,n,this.toBBox),h=r,p=o,f=void 0,d=void 0,g=void 0,y=void 0,f=Math.max(h.minX,p.minX),d=Math.max(h.minY,p.minY),g=Math.min(h.maxX,p.maxX),y=Math.min(h.maxY,p.maxY),s=Math.max(0,g-f)*Math.max(0,y-d),a=Rn(r)+Rn(o),s<l?(l=s,c=i,u=a<u?a:u):s===l&&a<u&&(u=a,c=i);return c},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:Mn,r=t.leaf?this.compareMinY:On;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,s=this.toBBox,a=Tn(t,0,e,s),l=Tn(t,n-e,n,s),u=An(a)+An(l);for(r=e;r<n-e;r++)o=t.children[r],Ln(a,t.leaf?s(o):o),u+=An(a);for(r=n-e-1;r>=e;r--)o=t.children[r],Ln(l,t.leaf?s(o):o),u+=An(l);return u},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)Ln(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():Sn(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var Gn=Pn;function jn(t,e,n){if(null!==t)for(var i,r,o,s,a,l,u,c,h=0,p=0,f=t.type,d="FeatureCollection"===f,g="Feature"===f,y=d?t.features.length:1,m=0;m<y;m++){a=(c=!!(u=d?t.features[m].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var _=0;_<a;_++){var v=0,x=0;if(null!==(s=c?u.geometries[_]:u)){l=s.coordinates;var C=s.type;switch(h=!n||"Polygon"!==C&&"MultiPolygon"!==C?0:1,C){case null:break;case"Point":if(!1===e(l,p,m,v,x))return!1;p++,v++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===e(l[i],p,m,v,x))return!1;p++,"MultiPoint"===C&&v++}"LineString"===C&&v++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(r=0;r<l[i].length-h;r++){if(!1===e(l[i][r],p,m,v,x))return!1;p++}"MultiLineString"===C&&v++,"Polygon"===C&&x++}"Polygon"===C&&v++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for(x=0,r=0;r<l[i].length;r++){for(o=0;o<l[i][r].length-h;o++){if(!1===e(l[i][r][o],p,m,v,x))return!1;p++}x++}v++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===jn(s.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function zn(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function Un(t){var e=[t[0],t[1]],n=[t[0],t[3]],i=[t[2],t[3]];return{type:"Feature",bbox:t,properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],i,n,e]]}}}function qn(t){var e=[1/0,1/0,-1/0,-1/0];return jn(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}var Vn=function(t){var e=Gn(t);return e.insert=function(t){if(Array.isArray(t)){var e=t;(t=Un(e)).bbox=e}else t.bbox=t.bbox?t.bbox:qn(t);return Gn.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){var n=Un(t);n.bbox=t,e.push(n)})):zn(t,(function(t){t.bbox=t.bbox?t.bbox:qn(t),e.push(t)})),Gn.prototype.load.call(this,e)},e.remove=function(t){if(Array.isArray(t)){var e=t;(t=Un(e)).bbox=e}return Gn.prototype.remove.call(this,t)},e.clear=function(){return Gn.prototype.clear.call(this)},e.search=function(t){return{type:"FeatureCollection",features:Gn.prototype.search.call(this,this.toBBox(t))}},e.collides=function(t){return Gn.prototype.collides.call(this,this.toBBox(t))},e.all=function(){return{type:"FeatureCollection",features:Gn.prototype.all.call(this)}},e.toJSON=function(){return Gn.prototype.toJSON.call(this)},e.fromJSON=function(t){return Gn.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;return{minX:(e=t.bbox?t.bbox:Array.isArray(t)&&4===t.length?t:qn(t))[0],minY:e[1],maxX:e[2],maxY:e[3]}},e};function Hn(t,e,n){if(!Kn(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&Zn(i),r&&Jn(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function Yn(t,e,n){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!Wn(t[0][1])||!Wn(t[0][1]))throw new Error("coordinates must contain numbers");return Hn({type:"LineString",coordinates:t},e,n)}function Xn(t,e){if(!Kn(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");n&&Zn(n),i&&Jn(i);var r={type:"FeatureCollection"};return i&&(r.id=i),n&&(r.bbox=n),r.features=t,r}function Wn(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Kn(t){return!!t&&t.constructor===Object}function Zn(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!Wn(t))throw new Error("bbox must only contain numbers")}))}function Jn(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}var Qn=function(t){if(!t)throw new Error("geojson is required");var e=[];return Ve(t,(function(t){!function(t,e){var n=[],i=t.geometry;switch(i.type){case"Polygon":n=We(i);break;case"LineString":n=[We(i)]}n.forEach((function(n){(function(t,e){var n=[];return t.reduce((function(t,i){var r,o,s,a,l,u,c=Yn([t,i],e);return c.bbox=(o=i,s=(r=t)[0],a=r[1],l=o[0],u=o[1],[s<l?s:l,a<u?a:u,s>l?s:l,a>u?a:u]),n.push(c),i})),n})(n,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}(t,e)})),Xn(e)};function $n(t,e,n){if(!ii(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&ri(i),r&&oi(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function ti(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ni(t[0])||!ni(t[1]))throw new Error("coordinates must contain numbers");return $n({type:"Point",coordinates:t},e,n)}function ei(t,e){if(!ii(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");n&&ri(n),i&&oi(i);var r={type:"FeatureCollection"};return i&&(r.id=i),n&&(r.bbox=n),r.features=t,r}function ni(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function ii(t){return!!t&&t.constructor===Object}function ri(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!ni(t))throw new Error("bbox must only contain numbers")}))}function oi(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function si(t,e){var n=We(t),i=We(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==i.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=n[0][0],o=n[0][1],s=n[1][0],a=n[1][1],l=i[0][0],u=i[0][1],c=i[1][0],h=i[1][1],p=(h-u)*(s-r)-(c-l)*(a-o),f=(c-l)*(o-u)-(h-u)*(r-l),d=(s-r)*(o-u)-(a-o)*(r-l);if(0===p)return null;var g=f/p,y=d/p;return g>=0&&g<=1&&y>=0&&y<=1?ti([r+g*(s-r),o+g*(a-o)]):null}var ai=function(t,e){var n={},i=[];if("LineString"===t.type&&(t=$n(t)),"LineString"===e.type&&(e=$n(e)),"Feature"===t.type&&"Feature"===e.type&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var r=si(t,e);return r&&i.push(r),ei(i)}var o=Vn();return o.load(Qn(e)),Ue(Qn(t),(function(t){Ue(o.search(t),(function(e){var r=si(t,e);if(r){var o=We(r).join(",");n[o]||(n[o]=!0,i.push(r))}}))})),ei(i)};var li=function(t){var e=[1/0,1/0,-1/0,-1/0];return ze(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e};function ui(t,e,n){if(!pi(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&fi(i),r&&di(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function ci(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!hi(t[0])||!hi(t[1]))throw new Error("coordinates must contain numbers");return ui({type:"Point",coordinates:t},e,n)}function hi(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function pi(t){return!!t&&t.constructor===Object}function fi(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!hi(t))throw new Error("bbox must only contain numbers")}))}function di(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}var gi=function(t,e){if(!pi(e=e||{}))throw new Error("options is invalid");var n=e.properties;if(!t)throw new Error("geojson is required");var i=li(t);return ci([(i[0]+i[2])/2,(i[1]+i[3])/2],n)};function yi(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function mi(t){return!!t&&t.constructor===Object}function _i(t){var e={type:"Feature"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}})),e.properties=function t(e){var n={};return e?(Object.keys(e).forEach((function(i){var r=e[i];"object"==typeof r?null===r?n[i]=null:r.length?n[i]=r.map((function(t){return t})):n[i]=t(r):n[i]=r})),n):n}(t.properties),e.geometry=vi(t.geometry),e}function vi(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return vi(t)})),e):(e.coordinates=function t(e){if("object"!=typeof e[0])return e.slice();return e.map((function(e){return t(e)}))}(t.coordinates),e)}var xi=function(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return _i(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}})),e.features=t.features.map((function(t){return _i(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return vi(t);default:throw new Error("unknown GeoJSON type")}};function Ci(t,e,n){if(!mi(n=n||{}))throw new Error("options is invalid");var i=n.mutate;if(!t)throw new Error("geojson is required");return Array.isArray(t)&&yi(t[0])?t="mercator"===e?wi(t):bi(t):(!0!==i&&(t=xi(t)),ze(t,(function(t){var n="mercator"===e?wi(t):bi(t);t[0]=n[0],t[1]=n[1]}))),t}function wi(t){var e,n=Math.PI/180,i=6378137,r=20037508.342789244,o=[i*(Math.abs(t[0])<=180?t[0]:t[0]-360*((e=t[0])<0?-1:e>0?1:0))*n,i*Math.log(Math.tan(.25*Math.PI+.5*t[1]*n))];return o[0]>r&&(o[0]=r),o[0]<-r&&(o[0]=-r),o[1]>r&&(o[1]=r),o[1]<-r&&(o[1]=-r),o}function bi(t){var e=180/Math.PI,n=6378137;return[t[0]*e/n,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/n)))*e]}var Ei=function(){return new Ii};function Ii(){this.reset()}Ii.prototype={constructor:Ii,reset:function(){this.s=this.t=0},add:function(t){Ni(Pi,t,this.t),Ni(this,Pi.s,this.s),this.s?this.t+=Pi.t:this.s=Pi.t},valueOf:function(){return this.s}};var Pi=new Ii;function Ni(t,e,n){var i=t.s=e+n,r=i-e,o=i-r;t.t=e-o+(n-r)}var Si=1e-6,Ti=Math.PI,Li=Ti/2,Mi=Ti/4,Oi=2*Ti,Ri=180/Ti,Ai=Ti/180,Di=Math.abs,Fi=Math.atan,ki=Math.atan2,Bi=Math.cos,Gi=(Math.ceil,Math.exp),ji=(Math.floor,Math.log),zi=(Math.pow,Math.sin),Ui=(Math.sign,Math.sqrt),qi=Math.tan;function Vi(t){return t>1?0:t<-1?Ti:Math.acos(t)}function Hi(t){return t>1?Li:t<-1?-Li:Math.asin(t)}function Yi(){}function Xi(t,e){t&&Ki.hasOwnProperty(t.type)&&Ki[t.type](t,e)}var Wi={Feature:function(t,e){Xi(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)Xi(n[i].geometry,e)}},Ki={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Zi(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Zi(n[i],e,0)},Polygon:function(t,e){Ji(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Ji(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)Xi(n[i],e)}};function Zi(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function Ji(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Zi(t[n],e,1);e.polygonEnd()}var Qi=function(t,e){t&&Wi.hasOwnProperty(t.type)?Wi[t.type](t,e):Xi(t,e)};Ei(),Ei();function $i(t){return[ki(t[1],t[0]),Hi(t[2])]}function tr(t){var e=t[0],n=t[1],i=Bi(n);return[i*Bi(e),i*zi(e),zi(n)]}function er(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function nr(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function ir(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function rr(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function or(t){var e=Ui(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}Ei();var sr=function(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n};function ar(t,e){return[t>Ti?t-Oi:t<-Ti?t+Oi:t,e]}function lr(t,e,n){return(t%=Oi)?e||n?sr(cr(t),hr(e,n)):cr(t):e||n?hr(e,n):ar}function ur(t){return function(e,n){return[(e+=t)>Ti?e-Oi:e<-Ti?e+Oi:e,n]}}function cr(t){var e=ur(t);return e.invert=ur(-t),e}function hr(t,e){var n=Bi(t),i=zi(t),r=Bi(e),o=zi(e);function s(t,e){var s=Bi(e),a=Bi(t)*s,l=zi(t)*s,u=zi(e),c=u*n+a*i;return[ki(l*r-c*o,a*n-u*i),Hi(c*r+l*o)]}return s.invert=function(t,e){var s=Bi(e),a=Bi(t)*s,l=zi(t)*s,u=zi(e),c=u*r-l*o;return[ki(l*r+u*o,a*n+c*i),Hi(c*n-a*i)]},s}ar.invert=ar;function pr(t,e,n,i,r,o){if(n){var s=Bi(e),a=zi(e),l=i*n;null==r?(r=e+i*Oi,o=e-l/2):(r=fr(s,r),o=fr(s,o),(i>0?r<o:r>o)&&(r+=i*Oi));for(var u,c=r;i>0?c>o:c<o;c-=l)u=$i([s,-a*Bi(c),-a*zi(c)]),t.point(u[0],u[1])}}function fr(t,e){(e=tr(e))[0]-=t,or(e);var n=Vi(-e[1]);return((-e[2]<0?-n:n)+Oi-Si)%Oi}var dr=function(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:Yi,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},gr=function(t,e){return Di(t[0]-e[0])<Si&&Di(t[1]-e[1])<Si};function yr(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}var mr=function(t,e,n,i,r){var o,s,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],s=t[e];if(gr(i,s)){for(r.lineStart(),o=0;o<e;++o)r.point((i=t[o])[0],i[1]);r.lineEnd()}else a.push(n=new yr(i,t,null,!0)),l.push(n.o=new yr(i,null,n,!1)),a.push(n=new yr(s,t,null,!1)),l.push(n.o=new yr(s,null,n,!0))}})),a.length){for(l.sort(e),_r(a),_r(l),o=0,s=l.length;o<s;++o)l[o].e=n=!n;for(var u,c,h=a[0];;){for(var p=h,f=!0;p.v;)if((p=p.n)===h)return;u=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(o=0,s=u.length;o<s;++o)r.point((c=u[o])[0],c[1]);else i(p.x,p.n.x,1,r);p=p.n}else{if(f)for(u=p.p.z,o=u.length-1;o>=0;--o)r.point((c=u[o])[0],c[1]);else i(p.x,p.p.x,-1,r);p=p.p}u=(p=p.o).z,f=!f}while(!p.v);r.lineEnd()}}};function _r(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}var vr=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN};var xr,Cr;1===(xr=vr).length&&(Cr=xr,xr=function(t,e){return vr(Cr(t),e)});var wr=Array.prototype;wr.slice,wr.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var br=function(t){for(var e,n,i,r=t.length,o=-1,s=0;++o<r;)s+=t[o].length;for(n=new Array(s);--r>=0;)for(e=(i=t[r]).length;--e>=0;)n[--s]=i[e];return n};function Er(t,e,n,i){function r(r,o){return t<=r&&r<=n&&e<=o&&o<=i}function o(r,o,a,u){var c=0,h=0;if(null==r||(c=s(r,a))!==(h=s(o,a))||l(r,o)<0^a>0)do{u.point(0===c||3===c?t:n,c>1?i:e)}while((c=(c+a+4)%4)!==h);else u.point(o[0],o[1])}function s(i,r){return Di(i[0]-t)<Si?r>0?0:3:Di(i[0]-n)<Si?r>0?2:1:Di(i[1]-e)<Si?r>0?1:0:r>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var n=s(t,1),i=s(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var l,u,c,h,p,f,d,g,y,m,_,v=s,x=dr(),C={point:w,lineStart:function(){C.point=b,u&&u.push(c=[]);m=!0,y=!1,d=g=NaN},lineEnd:function(){l&&(b(h,p),f&&y&&x.rejoin(),l.push(x.result()));C.point=w,y&&v.lineEnd()},polygonStart:function(){v=x,l=[],u=[],_=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,r=u.length;n<r;++n)for(var o,s,a=u[n],l=1,c=a.length,h=a[0],p=h[0],f=h[1];l<c;++l)o=p,s=f,h=a[l],p=h[0],f=h[1],s<=i?f>i&&(p-o)*(i-s)>(f-s)*(t-o)&&++e:f<=i&&(p-o)*(i-s)<(f-s)*(t-o)&&--e;return e}(),n=_&&e,r=(l=br(l)).length;(n||r)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),r&&mr(l,a,e,o,s),s.polygonEnd());v=s,l=u=c=null}};function w(t,e){r(t,e)&&v.point(t,e)}function b(o,s){var a=r(o,s);if(u&&c.push([o,s]),m)h=o,p=s,f=a,m=!1,a&&(v.lineStart(),v.point(o,s));else if(a&&y)v.point(o,s);else{var l=[d=Math.max(-1e9,Math.min(1e9,d)),g=Math.max(-1e9,Math.min(1e9,g))],x=[o=Math.max(-1e9,Math.min(1e9,o)),s=Math.max(-1e9,Math.min(1e9,s))];!function(t,e,n,i,r,o){var s,a=t[0],l=t[1],u=0,c=1,h=e[0]-a,p=e[1]-l;if(s=n-a,h||!(s>0)){if(s/=h,h<0){if(s<u)return;s<c&&(c=s)}else if(h>0){if(s>c)return;s>u&&(u=s)}if(s=r-a,h||!(s<0)){if(s/=h,h<0){if(s>c)return;s>u&&(u=s)}else if(h>0){if(s<u)return;s<c&&(c=s)}if(s=i-l,p||!(s>0)){if(s/=p,p<0){if(s<u)return;s<c&&(c=s)}else if(p>0){if(s>c)return;s>u&&(u=s)}if(s=o-l,p||!(s<0)){if(s/=p,p<0){if(s>c)return;s>u&&(u=s)}else if(p>0){if(s<u)return;s<c&&(c=s)}return u>0&&(t[0]=a+u*h,t[1]=l+u*p),c<1&&(e[0]=a+c*h,e[1]=l+c*p),!0}}}}}(l,x,t,e,n,i)?a&&(v.lineStart(),v.point(o,s),_=!1):(y||(v.lineStart(),v.point(l[0],l[1])),v.point(x[0],x[1]),a||v.lineEnd(),_=!1)}d=o,g=s,y=a}return C}}var Ir=Ei(),Pr=function(t,e){var n=e[0],i=e[1],r=[zi(n),-Bi(n),0],o=0,s=0;Ir.reset();for(var a=0,l=t.length;a<l;++a)if(c=(u=t[a]).length)for(var u,c,h=u[c-1],p=h[0],f=h[1]/2+Mi,d=zi(f),g=Bi(f),y=0;y<c;++y,p=_,d=x,g=C,h=m){var m=u[y],_=m[0],v=m[1]/2+Mi,x=zi(v),C=Bi(v),w=_-p,b=w>=0?1:-1,E=b*w,I=E>Ti,P=d*x;if(Ir.add(ki(P*b*zi(E),g*C+P*Bi(E))),o+=I?w+b*Oi:w,I^p>=n^_>=n){var N=nr(tr(h),tr(m));or(N);var S=nr(r,N);or(S);var T=(I^w>=0?-1:1)*Hi(S[2]);(i>T||i===T&&(N[0]||N[1]))&&(s+=I^w>=0?1:-1)}}return(o<-Si||o<Si&&Ir<-Si)^1&s};Ei();var Nr=function(t){return t};Ei(),Ei();var Sr=1/0,Tr=Sr,Lr=-Sr,Mr=Lr;var Or={point:function(t,e){t<Sr&&(Sr=t);t>Lr&&(Lr=t);e<Tr&&(Tr=e);e>Mr&&(Mr=e)},lineStart:Yi,lineEnd:Yi,polygonStart:Yi,polygonEnd:Yi,result:function(){var t=[[Sr,Tr],[Lr,Mr]];return Lr=Mr=-(Tr=Sr=1/0),t}};function Rr(t){this._context=t}Rr.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Oi)}},result:Yi};Ei();function Ar(){this._string=[]}function Dr(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}Ar.prototype={_radius:4.5,_circle:Dr(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=Dr(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var Fr=function(t,e,n,i){return function(r,o){var s,a,l,u=e(o),c=r.invert(i[0],i[1]),h=dr(),p=e(h),f=!1,d={point:g,lineStart:m,lineEnd:_,polygonStart:function(){d.point=v,d.lineStart=x,d.lineEnd=C,a=[],s=[]},polygonEnd:function(){d.point=g,d.lineStart=m,d.lineEnd=_,a=br(a);var t=Pr(s,c);a.length?(f||(o.polygonStart(),f=!0),mr(a,Br,t,n,o)):t&&(f||(o.polygonStart(),f=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),f&&(o.polygonEnd(),f=!1),a=s=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function g(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&o.point(e,n)}function y(t,e){var n=r(t,e);u.point(n[0],n[1])}function m(){d.point=y,u.lineStart()}function _(){d.point=g,u.lineEnd()}function v(t,e){l.push([t,e]);var n=r(t,e);p.point(n[0],n[1])}function x(){p.lineStart(),l=[]}function C(){v(l[0][0],l[0][1]),p.lineEnd();var t,e,n,i,r=p.clean(),u=h.result(),c=u.length;if(l.pop(),s.push(l),l=null,c)if(1&r){if((e=(n=u[0]).length-1)>0){for(f||(o.polygonStart(),f=!0),o.lineStart(),t=0;t<e;++t)o.point((i=n[t])[0],i[1]);o.lineEnd()}}else c>1&&2&r&&u.push(u.pop().concat(u.shift())),a.push(u.filter(kr))}return d}};function kr(t){return t.length>1}function Br(t,e){return((t=t.x)[0]<0?t[1]-Li-Si:Li-t[1])-((e=e.x)[0]<0?e[1]-Li-Si:Li-e[1])}var Gr=Fr((function(){return!0}),(function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?Ti:-Ti,l=Di(o-n);Di(l-Ti)<Si?(t.point(n,i=(i+s)/2>0?Li:-Li),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),t.point(o,i),e=0):r!==a&&l>=Ti&&(Di(n-r)<Si&&(n-=r*Si),Di(o-a)<Si&&(o-=a*Si),i=function(t,e,n,i){var r,o,s=zi(t-n);return Di(s)>Si?Fi((zi(e)*(o=Bi(i))*zi(n)-zi(i)*(r=Bi(e))*zi(t))/(r*o*s)):(e+i)/2}(n,i,o,s),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),e=0),t.point(n=o,i=s),r=a},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}),(function(t,e,n,i){var r;if(null==t)r=n*Li,i.point(-Ti,r),i.point(0,r),i.point(Ti,r),i.point(Ti,0),i.point(Ti,-r),i.point(0,-r),i.point(-Ti,-r),i.point(-Ti,0),i.point(-Ti,r);else if(Di(t[0]-e[0])>Si){var o=t[0]<e[0]?Ti:-Ti;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])}),[-Ti,-Li]);var jr=function(t,e){var n=Bi(t),i=n>0,r=Di(n)>Si;function o(t,e){return Bi(t)*Bi(e)>n}function s(t,e,i){var r=[1,0,0],o=nr(tr(t),tr(e)),s=er(o,o),a=o[0],l=s-a*a;if(!l)return!i&&t;var u=n*s/l,c=-n*a/l,h=nr(r,o),p=rr(r,u);ir(p,rr(o,c));var f=h,d=er(p,f),g=er(f,f),y=d*d-g*(er(p,p)-1);if(!(y<0)){var m=Ui(y),_=rr(f,(-d-m)/g);if(ir(_,p),_=$i(_),!i)return _;var v,x=t[0],C=e[0],w=t[1],b=e[1];C<x&&(v=x,x=C,C=v);var E=C-x,I=Di(E-Ti)<Si;if(!I&&b<w&&(v=w,w=b,b=v),I||E<Si?I?w+b>0^_[1]<(Di(_[0]-x)<Si?w:b):w<=_[1]&&_[1]<=b:E>Ti^(x<=_[0]&&_[0]<=C)){var P=rr(f,(-d+m)/g);return ir(P,p),[_,$i(P)]}}}function a(e,n){var r=i?t:Ti-t,o=0;return e<-r?o|=1:e>r&&(o|=2),n<-r?o|=4:n>r&&(o|=8),o}return Fr(o,(function(t){var e,n,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,p){var f,d=[h,p],g=o(h,p),y=i?g?0:a(h,p):g?a(h+(h<0?Ti:-Ti),p):0;if(!e&&(u=l=g)&&t.lineStart(),g!==l&&(!(f=s(e,d))||gr(e,f)||gr(d,f))&&(d[0]+=Si,d[1]+=Si,g=o(d[0],d[1])),g!==l)c=0,g?(t.lineStart(),f=s(d,e),t.point(f[0],f[1])):(f=s(e,d),t.point(f[0],f[1]),t.lineEnd()),e=f;else if(r&&e&&i^g){var m;y&n||!(m=s(d,e,!0))||(c=0,i?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1])))}!g||e&&gr(e,d)||t.point(d[0],d[1]),e=d,l=g,n=y},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(n,i,r,o){pr(o,t,e,r,n,i)}),i?[0,-t]:[-Ti,t-Ti])};function zr(t){return function(e){var n=new Ur;for(var i in t)n[i]=t[i];return n.stream=e,n}}function Ur(){}function qr(t,e,n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),Qi(n,t.stream(Or));var s=Or.result(),a=Math.min(i/(s[1][0]-s[0][0]),r/(s[1][1]-s[0][1])),l=+e[0][0]+(i-a*(s[1][0]+s[0][0]))/2,u=+e[0][1]+(r-a*(s[1][1]+s[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([l,u])}function Vr(t,e,n){return qr(t,[[0,0],e],n)}Ur.prototype={constructor:Ur,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Hr=Bi(30*Ai),Yr=function(t,e){return+e?function(t,e){function n(i,r,o,s,a,l,u,c,h,p,f,d,g,y){var m=u-i,_=c-r,v=m*m+_*_;if(v>4*e&&g--){var x=s+p,C=a+f,w=l+d,b=Ui(x*x+C*C+w*w),E=Hi(w/=b),I=Di(Di(w)-1)<Si||Di(o-h)<Si?(o+h)/2:ki(C,x),P=t(I,E),N=P[0],S=P[1],T=N-i,L=S-r,M=_*T-m*L;(M*M/v>e||Di((m*T+_*L)/v-.5)>.3||s*p+a*f+l*d<Hr)&&(n(i,r,o,s,a,l,N,S,I,x/=b,C/=b,w,g,y),y.point(N,S),n(N,S,I,x,C,w,u,c,h,p,f,d,g,y))}}return function(e){var i,r,o,s,a,l,u,c,h,p,f,d,g={point:y,lineStart:m,lineEnd:v,polygonStart:function(){e.polygonStart(),g.lineStart=x},polygonEnd:function(){e.polygonEnd(),g.lineStart=m}};function y(n,i){n=t(n,i),e.point(n[0],n[1])}function m(){c=NaN,g.point=_,e.lineStart()}function _(i,r){var o=tr([i,r]),s=t(i,r);n(c,h,u,p,f,d,c=s[0],h=s[1],u=i,p=o[0],f=o[1],d=o[2],16,e),e.point(c,h)}function v(){g.point=y,e.lineEnd()}function x(){m(),g.point=C,g.lineEnd=w}function C(t,e){_(i=t,e),r=c,o=h,s=p,a=f,l=d,g.point=_}function w(){n(c,h,u,p,f,d,r,o,i,s,a,l,16,e),g.lineEnd=v,v()}return g}}(t,e):function(t){return zr({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)};var Xr=zr({point:function(t,e){this.stream.point(t*Ai,e*Ai)}});function Wr(t){return Kr((function(){return t}))()}function Kr(t){var e,n,i,r,o,s,a,l,u,c,h=150,p=480,f=250,d=0,g=0,y=0,m=0,_=0,v=null,x=Gr,C=null,w=Nr,b=.5,E=Yr(N,b);function I(t){return[(t=o(t[0]*Ai,t[1]*Ai))[0]*h+n,i-t[1]*h]}function P(t){return(t=o.invert((t[0]-n)/h,(i-t[1])/h))&&[t[0]*Ri,t[1]*Ri]}function N(t,r){return[(t=e(t,r))[0]*h+n,i-t[1]*h]}function S(){o=sr(r=lr(y,m,_),e);var t=e(d,g);return n=p-t[0]*h,i=f+t[1]*h,T()}function T(){return u=c=null,I}return I.stream=function(t){return u&&c===t?u:u=Xr(x(r,E(w(c=t))))},I.clipAngle=function(t){return arguments.length?(x=+t?jr(v=t*Ai,6*Ai):(v=null,Gr),T()):v*Ri},I.clipExtent=function(t){return arguments.length?(w=null==t?(C=s=a=l=null,Nr):Er(C=+t[0][0],s=+t[0][1],a=+t[1][0],l=+t[1][1]),T()):null==C?null:[[C,s],[a,l]]},I.scale=function(t){return arguments.length?(h=+t,S()):h},I.translate=function(t){return arguments.length?(p=+t[0],f=+t[1],S()):[p,f]},I.center=function(t){return arguments.length?(d=t[0]%360*Ai,g=t[1]%360*Ai,S()):[d*Ri,g*Ri]},I.rotate=function(t){return arguments.length?(y=t[0]%360*Ai,m=t[1]%360*Ai,_=t.length>2?t[2]%360*Ai:0,S()):[y*Ri,m*Ri,_*Ri]},I.precision=function(t){return arguments.length?(E=Yr(N,b=t*t),T()):Ui(b)},I.fitExtent=function(t,e){return qr(I,t,e)},I.fitSize=function(t,e){return Vr(I,t,e)},function(){return e=t.apply(this,arguments),I.invert=e.invert&&P,S()}}function Zr(t){return function(e,n){var i=Bi(e),r=Bi(n),o=t(i*r);return[o*r*zi(e),o*zi(n)]}}function Jr(t){return function(e,n){var i=Ui(e*e+n*n),r=t(i),o=zi(r),s=Bi(r);return[ki(e*o,i*s),Hi(i&&n*o/i)]}}var Qr=Zr((function(t){return Ui(2/(1+t))}));Qr.invert=Jr((function(t){return 2*Hi(t/2)}));var $r=Zr((function(t){return(t=Vi(t))&&t/zi(t)}));$r.invert=Jr((function(t){return t}));function to(t,e){return[t,ji(qi((Li+e)/2))]}to.invert=function(t,e){return[t,2*Fi(Gi(e))-Li]};function eo(t){var e,n,i,r=Wr(t),o=r.center,s=r.scale,a=r.translate,l=r.clipExtent,u=null;function c(){var o=Ti*s(),a=r(function(t){function e(e){return(e=t(e[0]*Ai,e[1]*Ai))[0]*=Ri,e[1]*=Ri,e}return t=lr(t[0]*Ai,t[1]*Ai,t.length>2?t[2]*Ai:0),e.invert=function(e){return(e=t.invert(e[0]*Ai,e[1]*Ai))[0]*=Ri,e[1]*=Ri,e},e}(r.rotate()).invert([0,0]));return l(null==u?[[a[0]-o,a[1]-o],[a[0]+o,a[1]+o]]:t===to?[[Math.max(a[0]-o,u),e],[Math.min(a[0]+o,n),i]]:[[u,Math.max(a[1]-o,e)],[n,Math.min(a[1]+o,i)]])}return r.scale=function(t){return arguments.length?(s(t),c()):s()},r.translate=function(t){return arguments.length?(a(t),c()):a()},r.center=function(t){return arguments.length?(o(t),c()):o()},r.clipExtent=function(t){return arguments.length?(null==t?u=e=n=i=null:(u=+t[0][0],e=+t[0][1],n=+t[1][0],i=+t[1][1]),c()):null==u?null:[[u,e],[n,i]]},c()}function no(t,e){return[t,e]}no.invert=no;function io(t,e){var n=Bi(e),i=Bi(t)*n;return[n*zi(t)/i,zi(e)/i]}io.invert=Jr(Fi);function ro(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),e*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}ro.invert=function(t,e){var n,i=e,r=25;do{var o=i*i,s=o*o;i-=n=(i*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-e)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(Di(n)>Si&&--r>0);return[t/(.8707+(o=i*i)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),i]};function oo(t,e){return[Bi(e)*zi(t),zi(e)]}oo.invert=Jr(Hi);function so(t,e){var n=Bi(e),i=1+Bi(t)*n;return[n*zi(t)/i,zi(e)/i]}so.invert=Jr((function(t){return 2*Fi(t)}));function ao(t,e){return[ji(qi((Li+e)/2)),-t]}ao.invert=function(t,e){return[-e,2*Fi(Gi(t))-Li]};var lo={meters:6371008.8,metres:6371008.8,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:6371008.8/1852,inches:6371008.8*39.37,yards:6371008.8/1.0936,feet:20902260.511392,radians:1,degrees:6371008.8/111325};function uo(t,e,n){if(!go(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&yo(i),r&&mo(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function co(t,e){if(!go(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");n&&yo(n),i&&mo(i);var r={type:"FeatureCollection"};return i&&(r.id=i),n&&(r.bbox=n),r.features=t,r}function ho(t,e){if(null==t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=lo[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t*n}function po(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=lo[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t/n}function fo(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function go(t){return!!t&&t.constructor===Object}function yo(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!fo(t))throw new Error("bbox must only contain numbers")}))}function mo(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function _o(t,e,n,i){var r,o=t.properties||{},s="Feature"===t.type?t.geometry:t;if("GeometryCollection"===s.type){var a=[];return qe(t,(function(t){var r=_o(t,e,n,i);r&&a.push(r)})),co(a)}var l=li(t),u=l[1]>50&&l[3]>50;r=u?{type:s.type,coordinates:vo(s.coordinates,Co(s))}:function(t,e){return Ci(t,"mercator",e)}(s);var c,h=(new De.GeoJSONReader).read(r),p=ho(po(e,n),"meters"),f=De.BufferOp.bufferOp(h,p);if(!function t(e){return Array.isArray(e[0])?t(e[0]):isNaN(e[0])}((f=(new De.GeoJSONWriter).write(f)).coordinates))return(c=u?{type:f.type,coordinates:xo(f.coordinates,Co(s))}:function(t,e){return Ci(t,"wgs84",e)}(f)).geometry?c:uo(c,o)}function vo(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return vo(t,e)}))}function xo(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return xo(t,e)}))}function Co(t){var e=gi(t).geometry.coordinates.reverse(),n=e.map((function(t){return-t}));return function(){var t=eo(ao),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}().center(e).rotate(n).scale(6371008.8)}var wo=function(t,e,n){var i=(n=n||{}).units,r=n.steps||64;if(!t)throw new Error("geojson is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof r)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");r=r||64,i=i||"kilometers";var o=[];switch(t.type){case"GeometryCollection":return qe(t,(function(t){var n=_o(t,e,i,r);n&&o.push(n)})),co(o);case"FeatureCollection":return Ue(t,(function(t){var n=_o(t,e,i,r);n&&Ue(n,(function(t){t&&o.push(t)}))})),co(o)}return _o(t,e,i,r)};function bo(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i,r=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),o="Feature"===(i=e).type?i.geometry:i,s=o.type,a=e.bbox,l=o.coordinates;if(a&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,a))return!1;"Polygon"===s&&(l=[l]);for(var u=!1,c=0;c<l.length&&!u;c++)if(Eo(r,l[c][0],n.ignoreBoundary)){for(var h=!1,p=1;p<l[c].length&&!h;)Eo(r,l[c][p],!n.ignoreBoundary)&&(h=!0),p++;h||(u=!0)}return u}function Eo(t,e,n){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var s=e[r][0],a=e[r][1],l=e[o][0],u=e[o][1];if(t[1]*(s-l)+a*(l-t[0])+u*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!n;a>t[1]!=u>t[1]&&t[0]<(l-s)*(t[1]-a)/(u-a)+s&&(i=!i)}return i}var Io=new Cesium.Cartographic,Po=function(t,e){var n=[t,e].map(To);return n.some((function(t){return!t||t.length<3}))?null:n.map((function(t){return ie([So(t)])}))},No=function(t){if(!t)return null;var e=t[0]&&t[0][0]&&t[0][0][0];return isNaN(e)?isNaN(e[0])?null:(t.forEach((function(t){return t.forEach((function(t){return So(t)}))})),oe(t)):(t.forEach((function(t){return So(t)})),ie(t))},So=function(t){if(t&&!(t.length<2))return!1===function(t){if(t&&!(t.length<2)){var e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]}}(t)&&t.push([t[0][0],t[0][1]]),t},To=function(t){if(!t)return null;var e=[],n=!0,i=!1,r=void 0;try{for(var o,s=m()(t);!(n=(o=s.next()).done);n=!0){var a=o.value,l=Lo(a);l&&e.push(l)}}catch(t){i=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw r}}return e},Lo=function(t){if(!t)return null;if(t instanceof Cesium.Cartesian3){var e=Cesium.Cartographic.fromCartesian(t,void 0,Io);return[180*e.longitude/Math.PI,180*e.latitude/Math.PI]}return t instanceof u.a.Point3d?t.exportLngLatArray():Array.isArray(t)?[t[0],t[1]]:null};u.a.geometryHelper={intersect:function(t,e){var n=Po(t,e),i=yt()(n,2),r=i[0],o=i[1],s=cn(r,o);return s?s.geometry:s},polygonsIntersect:function(t,e){var n=No(t),i=No(e),r=cn(n,i);return r?r.geometry:r},union:function(t,e){var n=Po(t,e),i=yt()(n,2),r=i[0],o=i[1],s=hn(r,o);return s?s.geometry:s},polygonsUnion:function(t,e){var n=No(t),i=No(e),r=hn(n,i);return r?r.geometry:r},difference:function(t,e){var n=Po(t,e),i=yt()(n,2),r=i[0],o=i[1],s=wn(r,o);return s?s.geometry:s},polygonsDifference:function(t,e){var n=No(t),i=No(e),r=wn(n,i);return r?r.geometry:r},lineIntersect:function(t,e){if(!t||!e)return null;var n=null,i=null;"polyline"===t.type?n=re(To(t.geometry)):"polygon"===t.type?n=ie([So(To(t.geometry))]):Array.isArray(t)&&(n=Array.isArray(t[0][0])?ie(t.map((function(t){return So(To(t))}))):re(To(t))),"polyline"===e.type?i=re(To(e.geometry)):"polygon"===e.type?i=ie([So(To(e.geometry))]):Array.isArray(e)&&(i=Array.isArray(e[0][0])?ie(e.map((function(t){return So(To(t))}))):re(To(e)));var r=ai(n,i);return r?r.features.map((function(t){return t.geometry.coordinates})):[]},isPointInPolygon:function(t,e){return!(!t||!e)&&bo(ne(t),No(e))},buffer:function(t,e){if(!t)return null;var n=Number(e);if(isNaN(n)||n<=0)return null;var i=null,r=t.type.toLowerCase();if("point"===r)i=ne(Lo(t.geometry));else if("polyline"===r)i=re(To(t.geometry));else{if("polygon"!==r)return null;i=ie([So(To(t.geometry))])}var o=wo(i,n,{units:"meters"});return o?o.geometry:o}};var Mo=u.a.geometryHelper,Oo=n(26),Ro=n.n(Oo),Ao=new Cesium.Cartesian3,Do=new Cesium.Cartesian3,Fo=new Cesium.Cartographic,ko=function(t,e,n,i){Cesium.Cartesian3.fromDegrees(e,n,1e4,null,Ao),Cesium.Cartesian3.normalize(Ao,Do),Cesium.Cartesian3.negate(Do,Do);var r=new Cesium.Ray(Ao,Do),o=t.scene.drillPickFromRay(r,1,i);if(o.length>0&&o[0].position){var s=o[0],a=(s.object,s.position);return Cesium.Cartographic.fromCartesian(a,null,Fo),Fo.height}return null},Bo=function(t,e,n){if(!t||!e||!n)return 0;var i=Cesium.Cartesian3.distance(t,e),r=Cesium.Cartesian3.distance(e,n),o=Cesium.Cartesian3.distance(n,t),s=(i+r+o)/2;return Math.sqrt(s*(s-i)*(s-r)*(s-o))},Go=function(t,e,n,i,r){if(!e)return null;n||(n=1);for(var o=e.map((function(t){return t.clone()})),s=(new Sf3d.Point3dCollection).fromLngLatHeightArray(o.map((function(t){return(new Sf3d.Point3d).fromCartesian(t).exportLngLatHeightArray()})).flat()).getBounds(),a=Cesium.Math.RADIANS_PER_DEGREE*(s.max.lng-s.min.lng+(s.max.lat-s.min.lat))/(2*n*10),l=Cesium.PolygonGeometry.fromPositions({positions:o,vertexFormat:Cesium.PerInstanceColorAppearance.FLAT_VERTEX_FORMAT,granularity:a}),u=Cesium.PolygonGeometry.createGeometry(l),c=u.indices,h=u.attributes.position,p={items:[],minHeight:Number.MAX_VALUE,maxHeight:Number.MIN_VALUE,avgHeight:0},f=new Cesium.Cartographic,d=0,g=0;g<c.length;g+=3){var y={},m=c[g],_=c[g+1],v=c[g+2],x=new Cesium.Cartesian3(h.values[3*m],u.attributes.position.values[3*m+1],h.values[3*m+2]);Cesium.Cartographic.fromCartesian(x,null,f);var C=ko(t,180*f.longitude/Math.PI,180*f.latitude/Math.PI,r),w=new Cesium.Cartesian3(h.values[3*_],u.attributes.position.values[3*_+1],h.values[3*_+2]);Cesium.Cartographic.fromCartesian(w,null,f);var b=ko(t,180*f.longitude/Math.PI,180*f.latitude/Math.PI,r),E=new Cesium.Cartesian3(h.values[3*v],u.attributes.position.values[3*v+1],h.values[3*v+2]);Cesium.Cartographic.fromCartesian(E,null,f);var I=ko(t,180*f.longitude/Math.PI,180*f.latitude/Math.PI,r);y.height=(C+b+I)/3,p.minHeight=Math.min(p.minHeight,C,b,I),p.maxHeight=Math.max(p.maxHeight,C,b,I),d+=y.height,i&&(y.area=Bo(x,w,E)),p.avgHeight=d/(c.length/3),p.items.push(y)}return p},jo=u.a.DigTool=function(t){var e=this;t=t||{};var n=this,i=n.map3d=E.apply(void 0,arguments)||_sf3d;n.viewer=P.apply(void 0,arguments)||_cesium,n.data={positions:null},n._ds=new Cesium.CustomDataSource,n.viewer.dataSources.add(n._ds),n._polygonEntity=null,n._lastResult=null,n._sampleRatio=t.sampleRatio||1,this.config={bottomAltitude:{name:"底部高程",type:u.a.PropertyType.Float,default:-3},wallTexture:{name:"墙壁纹理",type:u.a.PropertyType.Url,default:u.a.RelativePath+"assets/dig-wall.jpg"},bottomTexture:{name:"底面纹理",type:u.a.PropertyType.Url,default:u.a.RelativePath+"assets/dig-bottom.jpg"},boxColor:{name:"辅助盒颜色",type:u.a.PropertyType.Color,default:new u.a.Color(0,255,242,76.5)},planeColor:{name:"辅助基准面颜色",type:u.a.PropertyType.Color,default:new u.a.Color(0,255,0,76.5)},boxHelperVisible:{name:"辅助盒子可见性",type:u.a.PropertyType.Boolean,default:!1}};var r=t.bottomAltitude?t.bottomAltitude:this.config.bottomAltitude.default;Object.defineProperty(this,"bottomAltitude",{get:function(){return r},set:function(t){isNaN(t)||Ho(this,r=t)},enumerable:!0});var o=t.wallTexture||this.config.wallTexture.default;Object.defineProperty(this,"wallTexture",{get:function(){return o},set:function(t){o=t,this._eBj&&this._eBj.polygon.material._image.setValue(o)},enumerable:!0});var a=t.bottomTexture||this.config.bottomTexture.default;Object.defineProperty(this,"bottomTexture",{get:function(){return a},set:function(t){a=t,this._eDm&&this._eDm.polygon.material._image.setValue(a)},enumerable:!0});var c=t.boxColor||this.config.boxColor.default;Object.defineProperty(this,"boxColor",{get:function(){return c},set:function(t){t instanceof u.a.Color&&(c=t,this._eBox&&this._eBox.polygon.material.color.setValue(c.color.clone()))}});var h=t.planeColor||this.config.planeColor.default;Object.defineProperty(this,"planeColor",{get:function(){return h},set:function(t){t instanceof u.a.Color&&(h=t,this._ePlane&&this._ePlane.polygon.material.color.setValue(h.color.clone()))}}),Object.defineProperty(this,"boxHelperVisible",{get:function(){return!!this._eBox&&this._eBox.show},set:function(t){this._eBox&&(this._eBox.show=!!t,this._ePlane.show=!!t)}});var p=null;Object.defineProperty(this,"tilesets",{get:function(){return p},set:function(t){p=t}});var f=null,d=null;this._clearDraw=function(){null!=d&&(i.marktool.removeDrawnResultById(d),d=null)},this._clearPolygon=function(){null!=e._polygonEntity&&(e.viewer.entities.remove(e._polygonEntity),e._polygonEntity=null)},this.startDrawAndMeasure=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new l.a((function(r){null!=t&&(n.bottomAltitude=t),i.marktool.off("onPolygonDrawn",f),f=function(o){if(i.marktool.off("onPolygonDrawn",f),i.marktool.clear(),2===e){var s=n.calcDigFillVolume(o.data);n.createBoxHelper(o.data),n.boxHelperVisible=!0,r({points:o.data,bottomAlt:t,dig:s.dig,fill:s.fill})}else{n.createDig(o.data);s=n.calcDigFillVolume();r({points:o.data,bottomAlt:t,dig:s.dig,fill:s.fill})}},i.marktool.on("onPolygonDrawn",f),i.marktool.startDrawPolygon({clampToGround:!0})}))},this.startDraw=function(t){return new l.a((function(n,r){(t=t||{}).calcHeight=null==t.calcHeight||!0===t.calcHeight,e.stopDraw(),f=function(o){(i.marktool.off("onPolygonDrawn",f),d=o.drawId,e.data.positions=o.data,t.calcHeight)?e.calculateHeights(o.data,t).then((function(t){n(s()({points:o.data},t))})).catch((function(t){return r(t)})):n({points:o.data})},i.marktool.on("onPolygonDrawn",f),i.marktool.startDrawPolygon({clampToGround:!0})}))},this.stopDraw=function(){this._clearDraw(),i.marktool.off("onPolygonDrawn",f),i.marktool.finish()}};jo.prototype.setPolygon=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new l.a((function(i,r){t instanceof u.a.Point3dCollection&&t.points.length>=3?(e.clear(),e.data.positions=t,e._polygonEntity=e.viewer.entities.add({polygon:{perPositionHeight:!1,clampToGround:!0,hierarchy:t.exportCartesianArray(),material:n.color?n.color.color:new u.a.Color(1,0,0,.5).color}}),e.calculateHeights(t,n).then((function(e){i(s()({polygon:t},e))})).catch((function(t){return r(t)}))):r(new Error("多边形无效!"))}))},jo.prototype.calculate=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=(new Date).getTime();return new l.a((function(r,o){zo(e),Uo(e),qo(e),e._clearPolygon(),e._clearDraw();var s=e.data.positions;if(t=null==t||null==t?e.bottomAltitude:t,s){if(2===n){var a=e.calcDigFillVolume(s,t);qo(e),e.createBoxHelper(s),e.boxHelperVisible=!0,e._lastResult={dig:a.dig,fill:a.fill},r({points:s,bottomAlt:t,dig:a.dig,fill:a.fill})}else{e.createDig(s);a=e.calcDigFillVolume(s,t);e._lastResult={dig:a.dig,fill:a.fill},r({points:s,bottomAlt:t,dig:a.dig,fill:a.fill})}console.debug("calculate volume cost :",(new Date).getTime()-i,"ms")}else o(new Error("多边形未指定！"))}))},jo.prototype.export=function(t){var e=this._eBox||this._eDm;e.tag=Ft;var n={};n[e.id]=this.data.positions.points.flatMap((function(t){return t.exportLngLatHeightArray()}));var i=Wt([e],n,t);return i.features[0].properties=s()({},i.features[0].properties,{dig:this._lastResult.dig,fill:this._lastResult.fill,avgHeight:this.avgHeight,maxHeight:this.maxHeight,minHeight:this.minHeight}),i},jo.prototype.destroy=function(){var t=this;t._ds&&t.viewer.dataSources.add(t._ds),delete t._ds,delete t.data,delete t.viewer},jo.prototype.clear=function(){zo(this),Uo(this),qo(this),this._clearDraw(),this._clearPolygon(),this.data={positions:void 0}},jo.prototype.createDig=function(t){var e=this;if(t&&!(t.size<3)){for(var n=t.exportCartesianArray(),i=[],r=n.length,o=(new Cesium.Cartesian3,Ko(n)),s=0;s<r;s++){var a=(s+1)%r,l=n[s],c=n[a],h=Cesium.Cartesian3.midpoint(l,c,new Cesium.Cartesian3),p=Cesium.Cartesian3.normalize(h,new Cesium.Cartesian3),f=Cesium.Cartesian3.subtract(o?l:c,h,new Cesium.Cartesian3),d=Cesium.Cartesian3.cross(f,p,new Cesium.Cartesian3);Cesium.Cartesian3.normalize(d,d);var g=Cesium.Plane.getPointDistance(new Cesium.Plane(d,0),h);i.push(new Cesium.ClippingPlane(d,g))}e.viewer.scene.globe.clippingPlanes=new Cesium.ClippingPlaneCollection({planes:i,edgeWidth:0,enabled:!0});var y=Wo(n),m=Wo([n[r-1],n[0]]),_=y.concat(m).concat(y[0]);Vo(e,_,e.bottomAltitude);var v=e.clippingPolygon=new u.a.ClippingPolygon(e.map3d);v.trace=t,this.tilesets&&this.tilesets instanceof Array&&this.tilesets.forEach((function(t){t.setClippginPolygon(v)}))}},jo.prototype.calcDigFillVolume=function(t,e){var n={dig:0,fill:0,minHeight:0,avgHeight:0,maxHeight:0},i=t.exportCartesianArray(),r=null==e||null==e?this.bottomAltitude:e;if(!i||0==i.length)return n;var o=[];this._eBj&&o.push(this._eBj),this._eDm&&o.push(this._eDm),this._eBox&&o.push(this._eBox),this._ePlane&&o.push(this._ePlane);var s=Go(this.viewer,i,this._sampleRatio,!0,o);return s&&0!=s.items.length?(n.dig=Yo(s,r),n.fill=Xo(s,r),n.minHeight=this.minHeight=s.minHeight,n.maxHeight=this.maxHeight=s.maxHeight,n.avgHeight=this.avgHeight=s.avgHeight,n):n},jo.prototype.createBoxHelper=function(t,e){var n=this,i=t?t.exportCartesianArray():this.data.positions;if(null==e||(this.bottomAltitude=e),i&&0!=i.length){qo(this);var r=Math.min(this.minHeight||0,this.bottomAltitude),o=Math.max(this.maxHeight||0,this.bottomAltitude);this._eBox=this._ds.entities.add({polygon:{hierarchy:{positions:i},height:r,extrudedHeight:o,material:this.boxColor.color},show:this.boxHelperVisible}),this._ePlane=this._ds.entities.add({polygon:{hierarchy:{positions:i},height:new Cesium.CallbackProperty((function(){return n.bottomAltitude}),!1),material:this.planeColor.color},show:this.boxHelperVisible})}},jo.prototype.calculateHeights=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{terrainOnly:!1},i=(new Date).getTime();return new l.a((function(r,o){var s={maxHeight:0,minHeight:0,avgHeight:0},a=t||e.data.positions;if(a){var l=function(t){for(var e in t)t[e]<.001&&(t[e]=0);return t},c=a.exportCartesianArray();if(c)if(!0===n.terrainOnly){for(var h=c.map((function(t){return t.clone()})),p=Cesium.PolygonGeometry.fromPositions({positions:h,vertexFormat:Cesium.PerInstanceColorAppearance.FLAT_VERTEX_FORMAT,granularity:Math.PI/Math.pow(2,11)/1e3}),f=Cesium.PolygonGeometry.createGeometry(p),d=f.indices,g=f.attributes.position,y=[],m=0;m<d.length;m+=3){var _=d[m],v=new Cesium.Cartesian3(g.values[3*_],g.values[3*_+1],g.values[3*_+2]);y.push((new u.a.Point3d).fromCartesian(v))}Jo(e.viewer,y).then((function(t){var e=0;s.minHeight=Ro.a,s.maxHeight=dt.a,t.forEach((function(t){e+=t.height,s.maxHeight=Math.max(s.maxHeight,t.height),s.minHeight=Math.min(s.minHeight,t.height)})),s.avgHeight=e/t.length,r(s)})).catch((function(t){return o(t)}))}else{var x=[];e._eBj&&x.push(e._eBj),e._eDm&&x.push(e._eDm),e._eBox&&x.push(e._eBox),e._ePlane&&x.push(e._ePlane);var C=Go(e.viewer,c,e._sampleRatio,!1,x);s.maxHeight=C.maxHeight,s.minHeight=C.minHeight,s.avgHeight=C.avgHeight,r(l(s))}else r(l(s));console.debug("calculate heights cost :",(new Date).getTime()-i,"ms")}else o(new Error("多边形未指定！"))}))};var zo=function(t){t.viewer.scene.globe.clippingPlanes&&t.viewer.scene.globe.clippingPlanes.removeAll(),t.tilesets&&t.tilesets instanceof Array&&t.tilesets.forEach((function(t){t.setClippginPolygon(null)}))},Uo=function(t){t._ds&&(t._eBj&&t._ds.entities.remove(t._eBj),t._eBj=null,t._eDm&&t._ds.entities.remove(t._eDm),t._eDm=null)},qo=function(t){t._ds&&(t._eBox&&t._ds.entities.remove(t._eBox),t._eBox=null,t._ePlane&&t._ds.entities.remove(t._ePlane),t._ePlane=null)},Vo=function(t,e,n){if(e&&0!=e.length){var i=[];t._polygonPos=[],t._balt=[];var r=new Cesium.Cartographic,o=!0,s=!1,a=void 0;try{for(var l,u=m()(e);!(o=(l=u.next()).done);o=!0){var c=l.value;Cesium.Cartographic.fromCartesian(c,null,r);var h=ko(t.viewer,180*r.longitude/Math.PI,180*r.latitude/Math.PI);i.push(h),t._balt.push(n),t._polygonPos.push(Cesium.Cartesian3.fromRadians(r.longitude,r.latitude,n))}}catch(t){s=!0,a=t}finally{try{!o&&u.return&&u.return()}finally{if(s)throw a}}t._eBj=t._ds.entities.add({wall:{positions:e,maximumHeights:i,minimumHeights:new Cesium.CallbackProperty((function(){return t._balt}),!1),material:t.wallTexture}}),t._eDm=t._ds.entities.add({polygon:{hierarchy:new Cesium.CallbackProperty((function(){return{positions:t._polygonPos}}),!1),perPositionHeight:!0,material:t.bottomTexture}})}},Ho=function(t,e){var n=[],i=[],r=new Cesium.Cartographic;if(t._polygonPos){var o=!0,s=!1,a=void 0;try{for(var l,u=m()(t._polygonPos);!(o=(l=u.next()).done);o=!0){var c=l.value;Cesium.Cartographic.fromCartesian(c,null,r),n.push(Cesium.Cartesian3.fromRadians(r.longitude,r.latitude,e)),i.push(e)}}catch(t){s=!0,a=t}finally{try{!o&&u.return&&u.return()}finally{if(s)throw a}}}t._polygonPos=n,t._balt=i},Yo=function(t,e){if(!t)return 0;var n=t.items;return n&&0!=n.length?(e||(e=0),n.reduce((function(t,n){return t+(n.height>e?n.area*(n.height-e):0)}),0)):0},Xo=function(t,e){if(!t)return 0;var n=t.items;return n&&0!=n.length?(e||(e=0),n.reduce((function(t,n){return t+(n.height<e?n.area*(e-n.height):0)}),0)):0},Wo=function(t){if(t&&0!=t.length){var e=Cesium.PolylinePipeline.generateArc({positions:t,granularity:1e-6});if(e){for(var n=[],i=0;i<e.length;i+=3)n.push(Cesium.Cartesian3.unpack(e,i));return n}}},Ko=function(t){var e=new Cesium.Cartographic,n=[],i=!0,r=!1,o=void 0;try{for(var s,a=m()(t);!(i=(s=a.next()).done);i=!0){var l=s.value;Cesium.Cartographic.fromCartesian(l,null,e),n.push([180*e.longitude/Math.PI,180*e.latitude/Math.PI])}}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return Zo(n)},Zo=function(t){var e=0,n=1,i=null,r=null,o=t.length-1,s=t;t[0][0]==t[o][0]&&t[0][1]==t[o][1]||(s=t.concat([t[0]]));for(var a=s.length;n<a;)i=r||s[0],e+=((r=s[n])[0]-i[0])*(r[1]+i[1]),n++;return e>0},Jo=function(t,e){return new l.a((function(n,i){var r=t.scene.terrainProvider,o=[];if(r instanceof Cesium.CesiumTerrainProvider){for(var a=[],l=0,u=e.length;l<u;l++){var c=e[l];o.push(c.clone()),a.push(Cesium.Cartographic.fromDegrees(c.lng,c.lat))}Cesium.sampleTerrainMostDetailed(r,a).then((function(t){for(var e=0,n=t.length;e<n;++e)o[e].height=t[e].height;return o})).then((function(t){n(t)}),(function(t){i(t)}))}else{for(l=0,u=e.length;l<u;l++){c=e[l];o.push(s()({},c,{height:0}))}n(o)}}))},Qo=u.a.SightTool=function(t){t=t||{};var e=this,n=E.apply(void 0,arguments)||_sf3d;e.viewer=P.apply(void 0,arguments)||_cesium,e.data={},e._ds=new Cesium.CustomDataSource,e.viewer.dataSources.add(e._ds),this.config={width:{name:"线宽",type:u.a.PropertyType.Int,default:1},visibleColor:{name:"可见颜色",type:u.a.PropertyType.Color,default:new u.a.Color(0,255,0,255)},hiddenColor:{name:"不可见颜色",type:u.a.PropertyType.Color,default:new u.a.Color(255,0,0,255)}};var i=t.width?t.width:this.config.width.default;Object.defineProperty(this,"width",{get:function(){return i},set:function(t){isNaN(t)||(i=t,this.data._vl&&this.data._vl.polyline.width.setValue(i),this.data._hl&&this.data._hl.polyline.width.setValue(i))},enumerable:!0});var r=t.visibleColor?t.visibleColor:this.config.visibleColor.default;Object.defineProperty(this,"visibleColor",{get:function(){return r},set:function(t){t&&t.color instanceof Cesium.Color&&(r=t,this.data._vl&&this.data._vl.polyline.material.color.setValue(r.color))},enumerable:!0});var o=t.hiddenColor?t.hiddenColor:this.config.hiddenColor.default;Object.defineProperty(this,"hiddenColor",{get:function(){return o},set:function(t){t&&t.color instanceof Cesium.Color&&(o=t,this.data._hl&&this.data._hl.polyline.material.color.setValue(o.color))},enumerable:!0});var s=null;this.stopDraw=function(){n.marktool.off("onPolylineDrawn",s),n.marktool.finish()},this.startDraw=function(){return new l.a((function(t){n.marktool.off("onPolylineDrawn",s),s=function(e){n.marktool.off("onPolylineDrawn",s),n.marktool.clear();var i=e.data.getByIndex(0),r=e.data.getByIndex(1);i&&r&&t({start:i,end:r,result:sightTool.update(i,r,e.drawingEntities)})},n.marktool.on("onPolylineDrawn",s),n.marktool.startDrawPolyline({num:2})}))}};Qo.prototype.destroy=function(){var t=this;t.clear(),t._ds&&t.viewer.dataSources.add(t._ds),delete t._ds,delete t.data,delete t.viewer},Qo.prototype.clear=function(){this._ds&&this._ds.entities.removeAll(),delete this.data._vl,delete this.data._hl},Qo.prototype.update=function(t,e,n){return $o(this,t.point,e.point,{width:this.width,visibleColor:this.visibleColor,hiddenColor:this.hiddenColor},n||[]),this.data.ir<1?(new u.a.Point3d).fromCartesian(this.data.ip):null};var $o=function(t,e,n,i,r){t.data.sp=e,t.data.ep=n,t.data.ip=n.clone(),t.data._vl||(t.data._vl=t._ds.entities.add({polyline:{positions:new Cesium.CallbackProperty((function(){return[t.data.sp,t.data.ip]}),!1),width:i&&null!=i.width?i.width:1,material:i&&i.visibleColor&&i.visibleColor.color||Cesium.Color.fromBytes(0,255,0,255),clampToGround:!1}})),t.data._hl||(t.data._hl=t._ds.entities.add({polyline:{positions:new Cesium.CallbackProperty((function(){return[t.data.ip,t.data.ep]}),!1),width:i&&null!=i.width?i.width:1,material:i&&i.hiddenColor&&i.hiddenColor.color||Cesium.Color.fromBytes(255,0,0,255),clampToGround:!1}}));var o=Cesium.Cartesian3.distance(e,n);if(0!==o){var s=Cesium.Cartesian3.subtract(n,e,new Cesium.Cartesian3);Cesium.Cartesian3.normalize(s,s);var a=new Cesium.Ray(e,s);r=r.filter(Boolean).concat([t.data._vl,t.data._hl]);var l=t.viewer.scene.pickFromRay(a,r),u=null;if(l&&l.object&&l.position)(t.data.ir=Cesium.Cartesian3.distance(l.position,e)/o)<1&&(u=l.position);u&&(t.data.ip=u)}},ts=(u.a.HeightLimitTool=function(t){t=t||{};var e=this;e.viewer=P.apply(void 0,arguments)||_cesium,this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},height:{name:"限高",type:u.a.PropertyType.Float,default:null==t.height?90:t.height},color:{name:"颜色",type:u.a.PropertyType.Color,default:t.color||new u.a.Color(1,1,1,.4)},highlightColor:{name:"高亮颜色",type:u.a.PropertyType.Color,default:t.highlightColor||new u.a.Color(1,0,0,1)},trace:{name:"分析范围",type:u.a.PropertyType.Trace,default:t.trace instanceof u.a.Point3dCollection?t.trace:new u.a.Point3dCollection,noConfig:!0}},Object.defineProperty(this,"show",{get:function(){return!(!this.instance||!this.instance.show)},set:function(t){this.instance&&(this.instance.show=!!t)},enumerable:!0});var n=this.config.height.default;Object.defineProperty(this,"height",{get:function(){return n},set:function(t){isNaN(t)||(n=t,this.instance&&this.instance.polygon.extrudedHeight.setValue(n))},enumerable:!0});var i=this.config.color.default;Object.defineProperty(this,"color",{get:function(){return i},set:function(t){t instanceof u.a.Color&&(i=t,this.instance&&this.instance.polygon.material.color.setValue(i.color))},enumerable:!0});var r=this.config.highlightColor.default;Object.defineProperty(this,"highlightColor",{get:function(){return r},set:function(t){t instanceof u.a.Color&&(r=t,this._hlbox&&(this._hlbox.getGeometryInstanceAttributes(this.hlboxid).color=Cesium.ColorGeometryInstanceAttribute.toValue(r.color)))},enumerable:!0});var o=this.config.trace.default,s=o.exportCartesianArray();Object.defineProperty(this,"trace",{get:function(){return o},set:function(t){t instanceof u.a.Point3dCollection&&(s=(o=t).exportCartesianArray())},enumerable:!0}),this.instance=this.viewer.entities.add({polygon:{hierarchy:new Cesium.CallbackProperty((function(){return{positions:s}}),!1),material:i.color,perPositionHeight:!0,extrudedHeight:n}}),this.destroy=function(){this.clearHighlight(),this.instance&&this.viewer.entities.remove(this.instance),delete this.instance,delete this.ms},this.update=function(t){return this.clearHighlight(),this.analysis(t),this.highlight(),this.ms},this.analysis=function(t){if(s&&!(s.length<3))return this.ms=ts(e.viewer,s,n,t,[e.instance])},this.clearHighlight=function(){this._hlbox&&this.viewer.scene.primitives.remove(this._hlbox),this._hlbox=null},this.highlight=function(){this.ms.maxHeight>n&&(this.hlboxid=x(),this._hlbox=this.viewer.scene.primitives.add(new Cesium.ClassificationPrimitive({geometryInstances:new Cesium.GeometryInstance({geometry:new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(s),height:n,extrudedHeight:this.ms.maxHeight+10}),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(r.color),show:new Cesium.ShowGeometryInstanceAttribute(!0)},id:this.hlboxid}),classificationType:Cesium.ClassificationType.CESIUM_3D_TILE})))}},function(t,e,n,i,r){if(e&&!(e.length<3)){i||(i=50);for(var o=e.map((function(t){return t.clone()})),s=Cesium.PolygonGeometry.fromPositions({positions:o,vertexFormat:Cesium.PerInstanceColorAppearance.FLAT_VERTEX_FORMAT,granularity:157e-9*i}),a=Cesium.PolygonGeometry.createGeometry(s).attributes.position.values,l=new Cesium.Cartesian3,u=new Cesium.Cartesian3,c=new Cesium.Cartographic,h=[],p=-1/0,f=0;f<a.length;f+=3){Cesium.Cartesian3.fromElements(a[f],a[f+1],a[f+2],l),Cesium.Cartographic.fromCartesian(l,null,c),Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,1e4,null,l),Cesium.Cartesian3.normalize(l,u),Cesium.Cartesian3.negate(u,u);var d=new Cesium.Ray(l,u),g=t.scene.drillPickFromRay(d,null,r);if(g.length>0){var y=function(t){var e,i=t.object,r=t.position,o=(e=r,Cesium.Cartographic.fromCartesian(e,null,N),N.height);if(p=Math.max(o,p),!i||o<=n)return"continue";var s=null;if((s=i instanceof Cesium.Cesium3DTileFeature?i:i.id instanceof XE.Obj.Model?i.id:i)&&s._exd&&!1===s._exd.heightLimit)return"continue";var a=h.find((function(t){return t.feature===s}));a?a.height<o&&(a.height=o):h.push({feature:s,height:o})},_=!0,v=!1,x=void 0;try{for(var C,w=m()(g);!(_=(C=w.next()).done);_=!0)y(C.value)}catch(t){v=!0,x=t}finally{try{!_&&w.return&&w.return()}finally{if(v)throw x}}}}return{features:h,maxHeight:p}}}),es=function(t,e,n){var i=document.createElementNS("http://www.w3.org/2000/svg",t);for(var r in e){var o=e[r];null!=o&&i.setAttribute(r,o)}return n&&n.appendChild(i),i},ns=function(t,e,n,i,r){return es("svg",s()({width:t,height:e,viewBox:n},ls(i)),r)},is=function(t,e){return es("g",ls(t),e)},rs=function(t,e,n){var i=yt()(t[0],2),r=i[0],o=i[1],a=yt()(t[1],2);return function(t,e,n,i,r,o){return es("line",s()({x1:t,y1:e,x2:n,y2:i},ls(r)),o)}(r,o,a[0],a[1],e,n)},os=function(t,e,n){return function(t,e,n){return es("polyline",s()({points:t,fill:"rgb(0, 0, 0, 0)"},ls(e)),n)}(t.reduce((function(t,e){return""+t+e[0]+","+e[1]+" "}),"").trim(),e,n)},ss=function(t,e,n,i,r,o){return es("rect",s()({x:t,y:e,width:n,height:i},ls(r)),o)},as=function(t,e,n,i,r){var o=ls(i);cs(o),null==o["dominant-baseline"]&&(o["dominant-baseline"]="middle");var a=es("text",s()({x:t,y:e},o),r);return a.textContent=n,a},ls=function(t){var e=s()({},t);return us(e),e},us=function(t){var e=t.strokeWidth;null!=e&&(t["stroke-width"]=e),delete t.strokeWidth,null!=(e=t.stroke)?t.stroke=hs(e):delete t.stroke,null!=(e=t.fill)?t.fill=hs(e):delete t.fill,null!=(e=t.fontSize)&&(t["font-size"]=e),delete t.fontSize},cs=function(t){var e;null!=(e=t.textAnchor)&&(t["text-anchor"]=e)},hs=function(t){return"string"==typeof t?t:Array.isArray(t)?"rgb("+t.join(", ")+")":""},ps=180/Math.PI,fs=(u.a.SectionTool=function(t){var e=this;t=t||{};var n=this,i=n.map3d=E.apply(void 0,arguments)||_sf3d,r=n.viewer=P.apply(void 0,arguments)||_cesium;this.config={trace:{name:"位置",type:u.a.PropertyType.Trace,default:t.trace instanceof u.a.Point3dCollection?t.trace:new u.a.Point3dCollection,noConfig:!0}};var o=t.trace instanceof u.a.Point3dCollection?t.trace:this.config.trace.default;Object.defineProperty(this,"trace",{get:function(){return o},set:function(t){t instanceof u.a.Point3dCollection&&(o=t)},enumerable:!0});var s=function(t,e,n,i){var o=fs(t,n,i);if(!o)return null;var s=new Cesium.Cartographic;return o.map((function(t){Cesium.Cartographic.fromCartesian(t,null,s);var n=r.scene.globe.getHeight(s),i=r.scene.sampleHeight(s,e);return[t,s.longitude*ps,s.latitude*ps,i,n]}))},a=function(t){if(!t||0==t.length)return null;var e=[],n=1/0,i=-1/0,r=t[0][0],o=0,s=!0,a=!1,l=void 0;try{for(var u,c=m()(t);!(s=(u=c.next()).done);s=!0){var h=u.value,p=yt()(h,5),f=p[0],d=p[1],g=p[2],y=p[3],_=p[4];o+=Cesium.Cartesian3.distance(f,r),n=Math.min(n,y,_),i=Math.max(i,y,_),e.push({x:o,y:y,y2:_,data:{lon:d,lat:g,height:y,th:_}}),r=f}}catch(t){a=!0,l=t}finally{try{!s&&c.return&&c.return()}finally{if(a)throw l}}return 0==e.length?{minx:0,maxx:0,miny:0,maxy:0,ps:e}:{minx:0,maxx:e[e.length-1].x,miny:n,maxy:i,ps:e}};this.analysis=function(t,e){var n=s(o.exportCartesianArray(),null,t,e);this._ares=a(n)},this.render=function(t){if(this._ares)return ms(t,{data:this._ares})};var c=null;this.stopDraw=function(){i.marktool.off("onPolylineDrawn",c),i.marktool.finish()},this.startDraw=function(t,n,r){return new l.a((function(s){i.marktool.off("onPolylineDrawn",c),c=function(a){i.marktool.off("onPolylineDrawn",c),i.marktool.clear(),!a.data||a.data.size<2||(o=a.data,e.analysis(n,r),e._rres=e.render(t),s())},i.marktool.on("onPolylineDrawn",c),i.marktool.startDrawPolyline({clampToGround:!0})}))},this.clear=function(){e._rres&&"function"==typeof e._rres.destroy&&e._rres.destroy()}},function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!t||t.length<2)return null;var r=e;if(n>0){var o=t.reduce((function(e,n,i){return 0===i?e:e+Cesium.Cartesian3.distance(t[i-1],t[i])}),0);r=Math.ceil(o/n)}var s=Cesium.PolylinePipeline.generateArc({positions:t,granularity:157e-9*r});return s?Cesium.Cartesian3.unpackArray(s,i):null}),ds=[10,10,0,50],gs=[10,10],ys=[5,10],ms=function(t,e){var n=_s(t);return vs(n,e),{destroy:function(){n.mc.removeChild(n.rc)}}},_s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t||((t=document.createElement("div")).className="sf-m-secr-svgc sf-m-tsecr-svgc"),t.style.position="relative",e.mc=t;var n=e.rc=ns("100%","100%","0 0 1000 620",null,t);return e.g=is(null,n),e},vs=function(t,e){var n=e.data,i=n.minx,r=n.maxx,o=n.miny,s=n.maxy,a=n.ps;i==r&&(i-=1,r+=1),o==s&&(o-=1,s+=1);var l=(s-o)/4,u=t.g;ss.apply(void 0,h()(bs([0,620])).concat([1e3,620,{strokeWidth:3,stroke:"rgb(0, 0, 0)",fill:"rgb(255, 255, 255)"},u]));var c=3+ds[3],p=3+ds[2],f=617-ds[0];rs(Cs([c,p,c,f]),{strokeWidth:1,stroke:"rgb(0, 0, 0)"},u);for(var d=c+5,g=((f-=ys[1])-(p+=ys[0]))/4,y=p,m=o,_=0;_<5;_++)rs(Cs([c,y,d,y]),{strokeWidth:1,stroke:"rgb(0, 0, 0)"},u),as.apply(void 0,h()(bs([c-5,y])).concat([Es(m),{fontSize:11,textAnchor:"end"},u])),(y+=g)>f&&(y=f),(m+=l)>s&&(m=s);for(var v=c+gs[0],x=p,C=(997-ds[1]-gs[1]-v)/(r-i),w=(f-x)/(s-o),b=[],E=[],I=null,P=null,N=0,S=a.length;N<S;N++){var T=a[N],L=(T.x-i)*C+v,M=(Es(T.y,1)-o)*w+x,O=(Es(T.y2,1)-o)*w+x;b.push([L,O]),xs(M,O)?I&&(I.push([].concat(h()(P))),I=null):(I||(I=[[L,O]],E.push(I)),I.push([L,M]),P=[L,O])}os(ws(b),{strokeWidth:1,stroke:"rgb(0, 0, 0)"},u),E.forEach((function(t){t.length>1&&os(ws(t),{strokeWidth:1,stroke:"rgb(0, 0, 0)"},u)}))},xs=function(t,e){return Math.abs(t-e)<=.01},Cs=function(t){for(var e=[],n=0,i=t.length;n<i;n+=2)e.push([t[n],t[n+1]]);return ws(e)},ws=function(t){return t.map(bs)},bs=function(t){var e=yt()(t,2);return[e[0],620-e[1]]},Es=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Number(Number(t).toFixed(e))};u.a.Layer=function(t){t=t||{},u.a.Object.call(this,t.id);var e=this;this.config={name:{name:"名称",type:u.a.PropertyType.String,default:"未命名图层"},maxHeight:{name:"最大可见高度",type:u.a.PropertyType.Float,default:1/0},minHeight:{name:"最小可见高度",type:u.a.PropertyType.Float,default:0},ignoreManage:{name:"忽略托管可见性",type:u.a.PropertyType.Boolean,default:!1},north:{name:"最北端可见",type:u.a.PropertyType.Float,default:-90,range:[-90,90]},east:{name:"最东端可见",type:u.a.PropertyType.Float,default:180,range:[-180,180]},west:{name:"最西端可见",type:u.a.PropertyType.Float,default:-180,range:[-180,180]},south:{name:"最南端可见",type:u.a.PropertyType.Float,default:90,range:[-90,90]},readOnly:{name:"是否只读",type:u.a.PropertyType.Boolean,default:!1}},this.parentId=null,this.children=null,this.instances=Array.isArray(t.instances)?t.instances:[];var n=t.name?t.name:this.config.name.default;Object.defineProperty(this,"name",{get:function(){return n},set:function(t){t&&(n=t)},enumerable:!0});var i=!!t.ignoreManage;Object.defineProperty(this,"ignoreManage",{get:function(){return i},set:function(t){i=!!t},enumerable:!0});var r=isNaN(t.maxHeight)?this.config.maxHeight.default:t.maxHeight;Object.defineProperty(this,"maxHeight",{get:function(){return r},set:function(t){isNaN(t)||(r=t)},enumerable:!0});var o=isNaN(t.minHeight)?this.config.minHeight.default:t.minHeight;Object.defineProperty(this,"minHeight",{get:function(){return o},set:function(t){isNaN(t)||(o=t)},enumerable:!0});var s=isNaN(t.south)?this.config.south.default:t.south;Object.defineProperty(this,"south",{get:function(){return s},set:function(t){isNaN(t)||(s=t)},enumerable:!0});var a=isNaN(t.north)?this.config.north.default:t.north;Object.defineProperty(this,"north",{get:function(){return a},set:function(t){isNaN(t)||(a=t)},enumerable:!0});var l=isNaN(t.east)?this.config.east.default:t.east;Object.defineProperty(this,"east",{get:function(){return l},set:function(t){isNaN(t)||(l=t)},enumerable:!0});var c=isNaN(t.west)?this.config.west.default:t.west;Object.defineProperty(this,"west",{get:function(){return c},set:function(t){isNaN(t)||(c=t)},enumerable:!0});var h=!0===t.readOnly;Object.defineProperty(this,"readOnly",{get:function(){return h},set:function(t){h=!!t},enumerable:!0}),Object.defineProperty(this,"isRoot",{get:function(){return!e.parentId},enumerable:!0}),Object.defineProperty(this,"isFolder",{get:function(){return!!Array.isArray(e.children)},enumerable:!0}),this.hide=function(t){h&&Array.isArray(this.instances)&&(this.instances.forEach((function(t){t.hide()})),t||_sf3d.layerManager.emit({type:"onLayerHide",data:this.id}))},this.show=function(t){Array.isArray(this.instances)&&(this.instances.forEach((function(t){t.show()})),t||_sf3d.layerManager.emit({type:"onLayerShow",data:this.id}))},this.findLayer=function(t){if(this.id==t)return this;if(Array.isArray(this.children)){var e=null;try{this.children.forEach((function(n){if(e=n.findLayer(t))throw""}))}catch(t){}return e}},this.findInstance=function(t){var e=null;if(Array.isArray(this.instances)){if(e=this.instances.find((function(t){t.id})))return e;try{return this.children.forEach((function(n){var i=n.findInstance(t);if(i)throw e=i,""})),null}catch(t){return e}}},this.addLayer=function(t){this.children||(this.children=[]),this.children.push(t),t.parentId=this.id,_sf3d.layerManager.emit({type:"onLayerAdd",data:t})},this.addInstance=function(t){this.instances||(this.instances=[]),t instanceof u.a.Instance&&(t.layerId=this.id,this.instances.push(t)),_sf3d.layerManager.emit({type:"onInstanceAdd",data:t})},this.destroy=function(){Array.isArray(this.instances)&&this.instances.forEach((function(t){t.destroy()})),Array.isArray(this.children)&&this.children.forEach((function(t){t.destroy()}))},this.removeLayer=function(t){if(Array.isArray(this.children)){var e=this.children.findIndex((function(e){return e.id==t}));if(e>=0){var n=this.children[e];n.destroy(),this.children.splice(e,1),_sf3d.layerManager.emit({type:"onLayerRemove",data:n})}}},this.removeInstance=function(t){if(Array.isArray(this.instances)){var e=this.instances.findIndex((function(e){return e.id==t}));if(e>=0){var n=this.instances[e];n.destroy(),this.instances.splice(e,1),_sf3d.layerManager.emit({type:"onInstanceRemove",data:n})}}},this.traverseLayer=function(t){Array.isArray(this.children)&&this.children.forEach((function(e){t(e),e.traverseLayer(t)}))},this.traverseInstance=function(t){Array.isArray(this.instances)&&this.instances.forEach((function(e){t(e)})),Array.isArray(this.children)&&this.children.forEach((function(e){e.traverseInstance(t)}))},this.export=function(){var t=JSON.parse(bt()(this.config));for(var e in t)t[e].curValue=this[e];return t.id=this.id,t.parentId=this.parentId,t.children=null,Array.isArray(this.instances)&&this.instances.length>0&&(t.instances=[],this.instances.forEach((function(e){t.instances.push(e.export())}))),Array.isArray(this.children)&&this.children.length>0&&(t.children=[],this.children.forEach((function(e){t.children.push(e.export())}))),t}};u.a.Layer;u.a.LayerManager=function(t){var e=this;this.root=new u.a.Layer({name:"根节点"});var n=function(){var n=t.camera.getView();n&&e.root.traverseLayer((function(t){!t||!t.checked||t.ignoreVisibilityManage||isNaN(n.centerX)||isNaN(n.centerY)||isNaN(n.height)||(n.height>=t.minHeight&&n.height<=t.maxHeight&&function(t,e){return e.centerX>=t.west&&e.centerX<=t.east&&e.centerY>=t.south&&e.centerY<=t.north}(t,n)?t.show():t.hide())}))};t.camera.on("onCameraMoveEnd",n),this.destroy=function(){this.root=null,t.camera.off("onCameraMoveEnd",n)}},r()(u.a.LayerManager.prototype,u.a.EventManager.prototype);u.a.LayerManager;var Is=n(31),Ps=n.n(Is);u.a.AoiBuilding=function(t,e){var n=this,i=e||{},r=E.apply(void 0,arguments)||window._sf3d;n.aoiBuildingLayer=null;var o=null,s=i.oriHouseOrFloorColor instanceof u.a.Color?i.oriHouseOrFloorColor:(new u.a.Color).fromCss("rgba(3,119,198,1)"),a=i.highlightHouseOrFloorColor instanceof u.a.Color?i.highlightHouseOrFloorColor:(new u.a.Color).fromCss("rgba(0,255,255,1)"),c=i.classifyOriHouseOrFloorColor instanceof u.a.Color?i.classifyOriHouseOrFloorColor:(new u.a.Color).fromCss("rgba(255,255,255,0)"),p=i.classifyHighlightHouseOrFloorColor instanceof u.a.Color?i.classifyHighlightHouseOrFloorColor:(new u.a.Color).fromCss("rgba(255,143,38,0.5)");n.$axios=B.a.create({}),n.$axios.interceptors.response.use((function(t){return t.data})),this.curHouseOrFloorData=null;var f=function(t){var e=t.data.pickingResult;if(e&&e.primitive&&"house||floor"==e.primitive.tag){var i=e.id.split("_");i[3]!=n.curSelectHouseOrFloorId&&(n.buildings.setInstanceColor(e.id,e.primitive.highlightColor),x(i[4])),n.emit({type:"onHouseOrFloorHoverIn",data:{aoiId:i[0],buildId:i[1],unitId:i[2],houseId:i[3]}})}},d=function(t){var e=t.data.pickingResult;if(e&&e.primitive&&"house||floor"==e.primitive.tag){var i=e.id.split("_");i[3]!=n.curSelectHouseOrFloorId&&(n.buildings.setInstanceColor(e.id,e.primitive.oriColor),x()),n.emit({type:"onHouseOrFloorHoverOut",data:{aoiId:i[0],buildId:i[1],unitId:i[2],houseId:i[3]}})}},g=function(t){var e=t.data.pickingResult;if(e&&e.primitive&&"house||floor"==e.primitive.tag){var i=e.id.split("_");n.selectHouseOrFloor(i[3]),n.emit({type:"onHouseOrFloorClick",data:{aoiId:i[0],buildId:i[1],unitId:i[2],houseId:i[3]}})}},y=function(t){var e=t.data.pickingResult;if(e&&e.primitive&&"house||floor"==e.primitive.tag){var i=e.id.split("_");n.unSelectHouseOrFloor(),n.emit({type:"onHouseOrFloorClick",data:{aoiId:i[0],buildId:i[1],unitId:i[2],houseId:i[3]}})}};this.selectHouseOrFloor=function(t){n.curSelectHouseOrFloorId&&n.unSelectHouseOrFloor(n.curSelectHouseOrFloorId),n.curSelectHouseOrFloorId=t,n.buildings.getInstanceIds().filter((function(e){return e.split("_")[3]==t})).forEach((function(t){var e=n.buildings.getInstance(t);n.buildings.setInstanceColor(t,e.highlightColor)}))},this.unSelectHouseOrFloor=function(){var t=n.buildings.getInstanceIds().filter((function(t){return t.split("_")[3]==n.curSelectHouseOrFloorId}));n.curSelectHouseOrFloorId=null,t.forEach((function(t){var e=n.buildings.getInstance(t);n.buildings.setInstanceColor(t,e.oriColor)}))},this.focusOnHouseOrFloor=function(t){var e=[];return n.buildings.instance.forEach((function(n,i){var r=n._primitive._instanceIds[0].split("_");t==r[3]&&e.push(n._primitive._instanceIds[0])})),n.buildings.focus(e)};var m=function(t){var e=t.data.pickingResult;if(e&&e.primitive&&"house||floor"==e.primitive.tag){var i=e.id.split("_");n.buildings.focus(e.id),n.emit({type:"onHouseOrFloorDoubleClick",data:{aoiId:i[0],buildId:i[1],unitId:i[2],houseId:i[3]}})}};this.loadAoiBuilding=function(e,i,h){return new l.a((function(l,_){if(o!=i){C(),n.destroy(),o=i,r.on("onHoverIn",f),r.on("onHoverOut",d),r.on("onClickIn",g),r.on("onClickOut",y),r.on("onDoubleClick",m);var x=new FormData;x.append("build_id",i),x.append("adcode",e),n.$axios.post(t+"/build/houses",x,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){n.curHouseOrFloorData=t.data,n.aoiBuildingLayer=new u.a.Layer({name:"楼栋",id:"aoibuilding"});var e=null;Array.isArray(t.data.properties.houses.features)&&t.data.properties.houses.features.length>0?(e=t.data.properties.houses).features.forEach((function(t){t.properties.id=t.properties.aoi_id+"_"+t.properties.build_id+"_"+t.properties.unit_id+"_"+t.properties.house_id+"_"+t.properties.floor_num})):Array.isArray(t.data.properties.floors.features)&&t.data.properties.floors.features.length>0&&(e=t.data.properties.floors).features.forEach((function(t){t.properties.id=t.properties.aoi_id+"_"+t.properties.build_id+"_"+t.properties.unit_id+"_"+t.properties.floor_id+"_"+t.properties.floor_num}));var i=u.a.Util.GeoJson2Point3dCollection(e);i.forEach((function(e){var n;n=t.data.properties.units.features.find((function(t){return t.properties.unit_id==e.properties.unit_id})).properties.baseheight,e.maxHeight=n+e.properties.min_height+e.properties.floor_h,e.minHeight=n+e.properties.min_height,e.closeTop=!0,e.closeBottom=!0}));var o=1==h?s:c,f=1==h?a:p;n.buildings=new u.a.ExtrudedPolygons({traces:i,classify:1!=h,color:o,callback:function(){l()}}),n.aoiBuildingLayer.instances=[n.buildings],Array.isArray(n.buildings.instance)?n.buildings.instance.forEach((function(t){t.tag="house||floor",t.oriColor=o,t.highlightColor=f})):(n.buildings.instance.oriColor=o,n.buildings.instance.highlightColor=f,n.buildings.instance.tag="house||floor"),r.layerManager.root.addLayer(n.aoiBuildingLayer),n._floor_tag=v(t.data.properties)}))}else l()}))};var _=function(t,e){if(!(t.units.features.length<1)){var n=t.units.features[0].properties.unit_id,i=t.height,r=t.floors.features;if(r){r.sort((function(t,e){return parseInt(t.properties.floor_num)>parseInt(e.properties.floor_num)?-1:1}));var o=0;r.forEach((function(t){o+=Number(t.properties.floor_h)})),i=o}var s=t.radius||20,a=10*i,l=200*i/a,u=2*(200*s/l+200),c=2*(s+l),h=document.createElement("canvas");h.width=u,h.height=a;var p=h.getContext("2d");return r.forEach((function(t,r){if(t.properties.unit_id==n){var o="white";e==parseInt(t.properties.floor_num)&&(o="rgba(255,143,38,0.5)"),function(t,e,n,i){t.font="20px Helvetica",t.fillStyle=i,t.textAlign="left",t.textBaseline="middle",t.fillText(n,e[0],e[1]+15)}(p,[u-200,(i-(t.properties.min_height+t.properties.floor_h))/i*a],t.properties.floor_num+"F",o),function(t,e,n,i){t.beginPath(),t.moveTo(e[0],e[1]),t.lineTo(n[0],n[1]),t.strokeStyle="white",t.stroke(),t.closePath()}(p,[u/2,(i-(t.properties.min_height+t.properties.floor_h))/i*a+10*t.properties.floor_h/2],[u-200,(i-(t.properties.min_height+t.properties.floor_h))/i*a+10*t.properties.floor_h/2])}})),{canvas:h,planeWidth:c,planeHeight:i}}},v=function(t){var e,n=_(t),i=n.canvas,r=n.planeWidth,o=n.planeHeight,s=window._cesium.entities.add({show:!0,position:(e=Cesium.Cartesian3).fromDegrees.apply(e,h()(JSON.parse(t.center).coordinates).concat([o/2+t.units.features[0].properties.baseheight])),plane:{plane:new Cesium.Plane(new Cesium.Cartesian3(0,-1,0),0),dimensions:new Cesium.Cartesian2(r,o),material:new Cesium.ImageMaterialProperty({image:i,transparent:!0})}});return s.tag="floor_tag",s.extraData=t,s.orientation=new Cesium.CallbackProperty((function(){if(s.show)return Cesium.Transforms.headingPitchRollQuaternion(s.position._value,new Cesium.HeadingPitchRoll(_cesium.camera.heading,0,0))}),!1),s},x=function(t){var e=_(n._floor_tag.extraData,t).canvas;n._floor_tag.plane.material.image._value=e};function C(){null!==r&&(r=r||window._sf3d)}this.getSelection=function(){return{building:o}},this.destroy=function(t){C(),this.aoiBuildingLayer&&r&&r.layerManager.root.removeLayer(this.aoiBuildingLayer.id),n._floor_tag&&window._cesium.entities.remove(n._floor_tag),this.aoiBuildingLayer=null,this.curHouseOrFloorData=null,o=null,r&&(r.off("onHoverIn",f),r.off("onHoverOut",d),r.off("onClickIn",g),r.off("onClickOut",y),r.off("onDoubleClick",m)),!0===t&&(r=null)}},r()(u.a.AoiBuilding.prototype,u.a.EventManager.prototype);u.a.AoiBuilding;var Ns={meters:6371008.8,metres:6371008.8,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:6371008.8/1852,inches:6371008.8*39.37,yards:6371008.8/1.0936,feet:20902260.511392,radians:1,degrees:6371008.8/111325};function Ss(t,e){if(null==t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=Ns[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t*n}function Ts(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function Ls(t){return!!t&&t.constructor===Object}var Ms=function(t,e,n){if(!Ls(n=n||{}))throw new Error("options is invalid");var i=n.units,r=Xe(t),o=Xe(e),s=Ts(o[1]-r[1]),a=Ts(o[0]-r[0]),l=Ts(r[1]),u=Ts(o[1]),c=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(l)*Math.cos(u);return Ss(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),i)};u.a.Aoi=function(t,e){var n=this,i=e||{},r=E.apply(void 0,arguments)||window._sf3d;this.aoiLayer=null;var o=1,a=null,c=null,h=i.aoiOriColor instanceof u.a.Color?i.aoiOriColor:(new u.a.Color).fromCss("rgba(3,119,198,1)"),p=i.classifyAoiOriColor instanceof u.a.Color?i.classifyAoiOriColor:(new u.a.Color).fromCss("rgba(255,255,255,0.00001)"),f=i.classifyAoiHighlightColor instanceof u.a.Color?i.classifyAoiHighlightColor:(new u.a.Color).fromCss("rgba(255,143,38,0.5)"),d=i.highlightAoiColor instanceof u.a.Color?i.highlightAoiColor:(new u.a.Color).fromCss("rgba(0,255,255,1)"),g=i.wallColor instanceof u.a.Color?i.wallColor:(new u.a.Color).fromCss("#FF9500"),y=i.classifyWallColor instanceof u.a.Color?i.classifyWallColor:(new u.a.Color).fromCss("#FF9500"),m=i.groundColor instanceof u.a.Color?i.groundColor:(new u.a.Color).fromCss("rgba(255,143,38,0.5)"),_=i.classifyGroundColor instanceof u.a.Color?i.classifyGroundColor:(new u.a.Color).fromCss("rgba(255,255,255,0)"),v=i.roadColor instanceof u.a.Color?i.roadColor:(new u.a.Color).fromCss("#00ff58"),x=null;function C(){null!==r&&(r=r||window._sf3d)}n.$axios=B.a.create({}),n.$axios.interceptors.response.use((function(t){return t.data})),this.curAoiData=null,this.aoiBuilding=new u.a.AoiBuilding(t,e),this.getSelection=function(){return s()({aoi:c},this.aoiBuilding.getSelection())};var w=function(t){var e=t.data.pickingResult;if(e&&e.primitive&&"unit"==e.primitive.tag){var i=e.id.split("_");i[1]!=n.curHighlightBuildingId&&i[1]!=n._ignoreEffectBuilding&&n.buildings.setInstanceColor(e.id,e.primitive.highlightColor),n.emit({type:"onUnitHoverIn",data:{aoiId:i[0],buildId:i[1],unitId:i[2]}})}},b=function(t){var e=t.data.pickingResult;if(e&&e.primitive&&"unit"==e.primitive.tag){var i=e.id.split("_");r.lastHoverResult!=r.lastClickResult&&i[1]!=n.curHighlightBuildingId&&i[1]!=n._ignoreEffectBuilding&&n.buildings.setInstanceColor(e.id,e.primitive.oriColor),n.emit({type:"onUnitHoverOut",data:{aoiId:i[0],buildId:i[1],unitId:i[2]}})}};this.selectBuilding=function(t){return n.unSelectBuilding(),new l.a((function(e,i){n.aoiBuilding.loadAoiBuilding(a,t,o).then((function(){x=t;var i=n.buildings.getInstanceIds();Array.isArray(i)&&i.forEach((function(e){e.split("_")[1]==t&&n.buildings.setInstanceVisible(e,!1)})),setTimeout((function(){e()}),1e3)}))}))},this.highlightUnit=function(t){n.unHighlightUnit(),n.curHighlightUnitId=t;var e=n.buildings.getInstanceIds();Array.isArray(e)&&e.forEach((function(e){if(e.split("_")[2]==t){var i=1==o?d:f;n.buildings.setInstanceColor(e,i)}}))},this.unHighlightUnit=function(){var t=n.buildings.getInstanceIds();Array.isArray(t)&&t.forEach((function(t){if(t.split("_")[2]==n.curHighlightUnitId){var e=1==o?h:p;n.buildings.setInstanceColor(t,e)}})),n.curHighlightUnitId=null},this.highlightBuilding=function(t){n.unHighlightBuilding(),n.curHighlightBuildingId=t;var e=n.buildings.getInstanceIds();Array.isArray(e)&&e.forEach((function(e){if(e.split("_")[1]==t){var i=1==o?d:f;n.buildings.setInstanceColor(e,i)}}))},this.unHighlightBuilding=function(){var t=n.buildings.getInstanceIds();Array.isArray(t)&&t.forEach((function(t){if(t.split("_")[1]==n.curHighlightBuildingId){var e=1==o?h:p;n.buildings.setInstanceColor(t,e)}})),n.curHighlightBuildingId=null},this.loadBuildingDetails=function(t,e,i){n._ignoreEffectBuilding=e,n.curHighlightBuildingId=e,n.unHighlightBuilding(),n.aoiBuilding.loadAoiBuilding(t,e,i)},this.unSelectBuilding=function(){if(n.aoiBuilding.destroy(),n.buildings){var t=n.buildings.getInstanceIds();Array.isArray(t)&&t.forEach((function(t){t.split("_")[1]==x&&n.buildings.setInstanceVisible(t,!0)}))}x=null};var I=function(t){var e=t.data.pickingResult;if(e&&e.collection)if("unitname"==e.collection.tag){var i=e.id.split("_");n.emit({type:"onUnitNameClick",data:{aoiId:i[0],buildId:i[1],unitId:i[2]}}),n.buildings.getInstanceVisible(e.id)?n.selectBuilding(i[1]):n.unSelectBuilding(i[1])}else"poi"==e.collection.tag&&n.emit({type:"onPoiClick",data:{poiId:e.primitive.id,data:s()({},e.primitive.tag||{})}})},P=function(t){var e=t.data.pickingResult;if(e&&e.primitive&&"unit"==e.primitive.tag){n.buildings.setInstanceColor(e.id,e.primitive.highlightColor);var i=e.id.split("_"),r=!1;try{r=0===n.curAoiData.properties.units.features.length}catch(t){console.warn(t)}n.emit({type:"onUnitClick",data:{aoiId:i[0],buildId:i[1],unitId:i[2],bgBuildId:i[3],isUnFloorAndRoom:r}})}},N=function(t){var e=t.data.pickingResult;if(e&&e.primitive&&"unit"==e.primitive.tag){n.buildings.setInstanceColor(e.id,e.primitive.oriColor);var i=e.id.split("_");n.emit({type:"onUnitClick",data:{aoiId:i[0],buildId:i[1],unitId:i[2],bgBuildId:i[3]}})}},S=function(t){var e=t.data.pickingResult;if(e&&e.primitive&&"unit"==e.primitive.tag){var i=e.id.split("_");n.buildings.focus(e.id),n.emit({type:"onUnitDoubleClick",data:{aoiId:i[0],buildId:i[1],unitId:i[2]}}),n.buildings.getInstanceVisible(e.id)?n.selectBuilding(i[1]):n.unSelectBuilding(i[1])}},T=function(){C();var t=r.layerManager.root.findLayer("aoiflags");if(t){var e=t.instances[0];if(e)return e}return null},L=function(t){console.debug("highlightAoiFlag");var e=T();e&&e.select(t)},M=function(){console.debug("clearHighlightAoiFlag");var t=T();t&&t.clearSelect()};this.focusOnAoi=function(t){var e=[],i=n.buildings.getInstanceIds();Array.isArray(i)&&i.forEach((function(n){var i=n.split("_");t==i[0]&&e.push(n)})),n.buildings.focus(e)},this.focusOnBuilding=function(t){var e=[],i=n.buildings.getInstanceIds();return Array.isArray(i)&&i.forEach((function(n){var i=n.split("_");t==i[1]&&e.push(n)})),n.buildings.focus(e)},this.focusOnUnit=function(t){var e=[],i=n.buildings.getInstanceIds();return Array.isArray(i)&&i.forEach((function(n){var i=n.split("_");t==i[2]&&e.push(n)})),n.buildings.focus(e)},this.loadAoi=function(x,E,T){return new l.a((function(l,M){E!=c?(C(),n.destroy(),c=E,a=x,o=T,r.on("onHoverIn",w),r.on("onHoverOut",b),r.on("onClickIn",P),r.on("onClickOut",N),r.on("onDoubleClick",S),r.on("onClick",I),n.$axios.get(t+"/area/info?area_id="+c+"&adcode="+a).then((function(t){null==t.data&&M("未查到该AOI"),n.curAoiData=t.data,n.aoiLayer=new u.a.Layer({name:"小区",id:"aoi"}),r.layerManager.root.addLayer(n.aoiLayer);var o=u.a.Util.GeoJson2Point3dCollection(t.data)[0],a=t.data.properties?t.data.properties:t.data;L(E);var c=new u.a.Layer({name:"小区围墙-面",id:"aoiborders"});if(1==T){var x=new u.a.LineWall({traces:[o],color:g,intervalEl:2});c.instances=[x]}else{var C=new u.a.FlashWall({trace:o,color:y,wallHeight:15});c.instances=[C]}n.aoiLayer.addLayer(c);var w=new u.a.Layer({name:"小区地面",id:"aoigrounds"}),b=new u.a.Polygons({traces:[o],color:1==T?m:_,texture:""});if(w.instances=[b],n.aoiLayer.addLayer(w),a.road&&a.road.features.length>0){var I=new u.a.Layer({name:"小区道路",id:"aoiraods"}),P=u.a.Util.GeoJson2Point3dCollection(a.road),N=new u.a.PolyLines({traces:P,color:v,lineWidth:10,glowEnable:!0,breatheEnable:!0});I.instances=[N],n.aoiLayer.addLayer(I)}if(a.units.features.length>0){var S,O=new u.a.Layer({name:"小区单元标注",id:"aoiunitmarkers"}),R={type:"FeatureCollection",features:[]};(j=new u.a.Billboards((S={trace:function(t){a.units.features.forEach((function(e){var n=JSON.parse(e.properties.center);n.coordinates[2]=e.properties.height+t,R.features.push({geometry:n,properties:e.properties});var i=a.builds.features.find((function(t){return t.properties.build_id===e.properties.build_id})),r="";i&&(r=i.properties.bg_buildid),e.properties.id=e.properties.aoi_id+"_"+e.properties.build_id+"_"+e.properties.unit_id+"_"+r}));var e=u.a.Util.GeoJson2Point3dCollection(R)[0];return e.forEach((function(t){var e=t.properties.build_name+t.properties.unit_name;e.length>8&&(e=e.substr(0,8)+"..."),t.text=e})),e}(15),backgroundUrl:e.unitBackgroundUrl?e.unitBackgroundUrl:u.a.RelativePath+"assets/aoi/billboardbg.png",backgroundColor:(new u.a.Color).fromCss("rgba(0,0,0,1)"),showBackground:!0===e.showBackground},Ps()(S,"backgroundColor",e.backgroundColor?e.backgroundColor:new u.a.Color(0,0,0,1)),Ps()(S,"fontSize",isNaN(e.fontSize)?50:e.fontSize),Ps()(S,"near",isNaN(e.near)?200:e.near),Ps()(S,"nearScale",isNaN(e.nearScale)?.2:e.nearScale),Ps()(S,"far",isNaN(e.far)?3e3:e.far),Ps()(S,"farScale",isNaN(e.farScale)?0:e.farScale),Ps()(S,"line",i.line),S))).instance.forEach((function(t){t.tag="unitname"})),O.instances=[j],n.aoiLayer.addLayer(O),r.billboardsCDHelper&&O.instances.forEach((function(t){return r.billboardsCDHelper.bind(t)}))}if(a.poi.features.length>0&&(a.poi.features.forEach((function(t){t.properties.id=t.properties.poi_id})),(U=u.a.Util.GeoJson2Point3dCollection(a.poi)).length>0)){U[0].forEach((function(t){if("991400"==t.properties.poi_type?(i.showPoiText&&(t.text="出入口"),t.backgroundUrl=e.enterBackgroundUrl?e.enterBackgroundUrl:u.a.RelativePath+"assets/aoi/enter.png"):0==t.properties.poi_type.indexOf("1509")?(i.showPoiText&&(t.text="停车场"),t.backgroundUrl=e.parkingBackgroundUrl?e.parkingBackgroundUrl:u.a.RelativePath+"assets/aoi/parking.png"):0==t.properties.poi_type.indexOf("130504")?(i.showPoiText&&(t.text="消防栓"),t.backgroundUrl=e.fireBackgroundUrl?e.fireBackgroundUrl:u.a.RelativePath+"assets/aoi/fire.png"):i.showPoiText&&(t.text=t.properties.poi_name),t.text&&t.text.length>8){for(var r="",o=0;o<t.text.length;o++)r+=t.text.charAt(o),o%8==0&&0!=o&&o!=t.text.length-1&&(r+="\n");t.text=r}if(e.showPoiParticle){var s=(new u.a.Point3d).fromLngLat(t.properties.coord_x,t.properties.coord_y,0),a=new u.a.Particle({position:s,size:10}),l=new u.a.Layer({name:"POIPARTICLE",id:"poiparticle"});l.instances=[a],n.aoiLayer.addLayer(l)}}));var A=new u.a.Billboards({trace:U[0],showBackground:!0,fontSize:22,near:200,nearScale:.6,far:3e3,farScale:0,labelOffsetY:-47});A.instance.forEach((function(t){t.tag="poi";for(var e=0;e<t.length;e++){var n=t.get(e),i=U[0].points[e];n.tag=s()({},i)}}));var D=new u.a.Layer({name:"POI",id:"poi"});D.instances=[A],n.aoiLayer.addLayer(D),r.billboardsCDHelper&&D.instances.forEach((function(t){return r.billboardsCDHelper.bind(t)}))}if(a.units.features.length>0){a.units.features.forEach((function(t){var e=a.builds.features.find((function(e){return e.properties.build_id===t.properties.build_id})),n="";e&&(n=e.properties.bg_buildid),t.properties.id=t.properties.aoi_id+"_"+t.properties.build_id+"_"+t.properties.unit_id+"_"+n}));var F=new u.a.Layer({name:"小区单元楼栋",id:"units"});(U=u.a.Util.GeoJson2Point3dCollection(a.units)).forEach((function(t){t.maxHeight=t.properties.baseheight+t.properties.height,t.minHeight=t.properties.baseheight,t.closeTop=!0,t.closeBottom=!0}));var k=1==a.scenetype?h:p,B=1==a.scenetype?d:f;n.buildings=new u.a.ExtrudedPolygons({traces:U,classify:1!=a.scenetype,color:k,show:!0,callback:function(){l()}}),F.instances=[n.buildings],Array.isArray(n.buildings.instance)?n.buildings.instance.forEach((function(t){t.tag="unit",t.oriColor=k,t.highlightColor=B})):(n.buildings.instance.tag="unit",n.buildings.instance.oriColor=k,n.buildings.instance.highlightColor=B),n.aoiLayer.addLayer(F)}if(0==t.data.properties.units.features.length&&t.data.properties.builds.features.length>0){var G=new u.a.Layer({name:"小区楼栋标注",id:"aoibuildmarkers"});R={type:"FeatureCollection",features:[]};t.data.properties.builds.features.forEach((function(t){var e=JSON.parse(t.properties.center);e.coordinates[2]=t.properties.height+10,R.features.push({geometry:e,properties:t.properties}),t.properties.id=t.properties.aoi_id+"_"+t.properties.build_id+"__"+t.properties.bg_buildid}));var j,z=u.a.Util.GeoJson2Point3dCollection(R)[0];z.forEach((function(t){var e=t.properties.build_name;e.length>8&&(e=e.substr(0,8)+"..."),t.text=e})),(j=new u.a.Billboards({trace:z,backgroundUrl:e.unitBackgroundUrl?e.unitBackgroundUrl:u.a.RelativePath+"assets/aoi/billboardbg.png",showBackground:!1,fontSize:isNaN(e.fontSize)?50:e.fontSize,near:isNaN(e.near)?200:e.near,nearScale:isNaN(e.nearScale)?.2:e.nearScale,far:isNaN(e.far)?3e3:e.far,farScale:isNaN(e.farScale)?0:e.farScale,line:i.line})).instance.forEach((function(t){t.tag="buildname"})),G.instances=[j],n.aoiLayer.addLayer(G),r.billboardsCDHelper&&G.instances.forEach((function(t){return r.billboardsCDHelper.bind(t)}))}if(0==t.data.properties.units.features.length&&t.data.properties.builds.features.length>0){t.data.properties.builds.features.forEach((function(t){t.properties.id=t.properties.aoi_id+"_"+t.properties.build_id+"__"+t.properties.bg_buildid}));var U,q=new u.a.Layer({name:"小区楼栋",id:"builds"});(U=u.a.Util.GeoJson2Point3dCollection(t.data.properties.builds)).forEach((function(t){t.maxHeight=t.properties.height+5,t.minHeight=0,t.closeTop=!0,t.closeBottom=!0}));k=1==t.data.properties.scenetype?h:p,B=1==t.data.properties.scenetype?d:f;n.buildings=new u.a.ExtrudedPolygons({traces:U,classify:1!=t.data.properties.scenetype,color:k,show:!0,callback:function(){l()}}),q.instances=[n.buildings],Array.isArray(n.buildings.instance)?n.buildings.instance.forEach((function(t){t.tag="unit",t.oriColor=k,t.highlightColor=B})):(n.buildings.instance.tag="unit",n.buildings.instance.oriColor=k,n.buildings.instance.highlightColor=B),n.aoiLayer.addLayer(q)}}))):l()}))},this.changeUnitMarkerVisibleByAoiName=function(t,e){n.changeUnitMarkerVisible(e,(function(e){return!(!e||!e.properties)&&(e.properties.build_name+e.properties.unit_name).includes(t)}))},this.changeUnitMarkerVisibleByGeomAndName=function(t,e,i){n.changeUnitMarkerVisible(t,(function(t){var n=t.exportLngLatArray(),r=yt()(n,2),o=r[0],s=r[1],a=!0;if(e){var l=e.type,u=e.position;if("polygon"===l)a=bo(ne([o,s]),ie([F(u)]));else if("circle"===l){var c=yt()(u,3),h=c[0],p=c[1],f=c[2];a=Ms(ne([h,p]),ne([o,s]),{units:"meters"})<f}}var d=!0;return null!=i&&t&&t.properties&&null!=t.properties.aoi_name&&(d=(t.properties.build_name+t.properties.unit_name).includes(i)),a&&d}))},this.setUnitMarkerAllVisible=function(t){var e=O(),n=e&&e.instances&&e.instances[0];n&&n.setAllVisible(t)},this.setUnitMarkerVisible=function(t,e){var n=O(),i=n&&n.instances&&n.instances[0];i&&i.setVisible(t,e)},this.changeUnitMarkerVisible=function(t,e){var n=O(),i=n&&n.instances&&n.instances[0];i&&i.changeVisible(t,e)};var O=function(){return n.aoiLayer&&n.aoiLayer.findLayer("aoiunitmarkers")};this.destroy=function(t){var e=this;if(C(),this.aoiLayer&&r){if(r.billboardsCDHelper){["aoiunitmarkers","poi","aoibuildmarkers"].forEach((function(t){var n=e.aoiLayer.findLayer(t);n&&n.instances.forEach((function(t){return r.billboardsCDHelper.unbind(t)}))}))}r.layerManager.root.removeLayer(this.aoiLayer.id)}a=null,o=1,c=null,this.curAoiData=null,r&&(r.off("onHoverIn",w),r.off("onHoverOut",b),r.off("onClickIn",P),r.off("onClickOut",N),r.off("onDoubleClick",S),r.off("onClick",I),M()),this.aoiBuilding.destroy(t),!0===t&&(r=null)}},r()(u.a.Aoi.prototype,u.a.EventManager.prototype);u.a.Aoi;u.a.Aois=function(t,e){var n=this,i=E.apply(void 0,arguments)||window._sf3d;n.aoisLayer=null;var r=s()({},e||{});!1===r.showPoiText?r.showPoiText=!1:r.showPoiText=!0,this.aoi=new u.a.Aoi(t,r);var o=null;this.curCityData=null,n.$axios=B.a.create({}),n.$axios.interceptors.response.use((function(t){return t.data}));var a=function(t){var e=t.data.pickingResult;if(e&&e.collection&&"aoiflag"==e.collection.tag){var i,r,s=!0;if(n.aoi.curAoiData)if(e.id!=n.aoi.curAoiData.properties.aoi_id)n.aoi.destroy(),i=r=n.curCityData.find((function(t){return t.properties.aoi_id==e.id})),n.aoi.loadAoi(o,e.id,r.properties.scenetype);else s=!1,i=n.aoi.curAoiData,n.aoi.destroy();else i=r=n.curCityData.find((function(t){return t.properties.aoi_id==e.id})),n.aoi.loadAoi(o,e.id,r.properties.scenetype);var a={aoi_id:i.properties.aoi_id,bg_aoiid:i.properties.bg_aoiid,flag:s};n.emit({type:"onAoiFlagClick",data:a})}};function c(){null!==i&&(i=i||window._sf3d)}this.loadCityAois=function(e){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new l.a((function(l,h){if(c(),o!=e){o=e,i.on("onClick",a),n.aoisLayer=new u.a.Layer({name:"城市小区标牌",id:"aoiflags"});var p=new FormData;p.append("adcode",e),n.$axios.post(t+"/area/list",p,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){if(n.curCityData=t.data.features,n.curCityData){n.curCityData.forEach((function(t){t.properties.id=t.properties.aoi_id;var e=t.properties.height+Math.max(.2*t.properties.height,25);3==t.geometry.coordinates.length?t.geometry.coordinates[2]=e:2==t.geometry.coordinates.length&&t.geometry.coordinates.push(e)}));var e=t.data;if(s){var o=e.features.filter((function(t){return 2===t.properties.scenetype}));e={features:o,type:"FeatureCollection"}}var a=u.a.Util.GeoJson2Point3dCollection(e);if(n.aoisLayer.instances=[],a.length>0){a[0].forEach((function(t){var e=t.properties.aoi_name;if(e.length>8){var n=e.substr(0,8)+"...";t.text=n}else t.text=t.properties.aoi_name}));var c=new u.a.Billboards({trace:a[0],backgroundUrl:r.backgroundUrl?r.backgroundUrl:u.a.RelativePath+"assets/aoi/billboardbg.png",showBackground:!0===r.showBackground,backgroundColor:r.backgroundColor?r.backgroundColor:new u.a.Color(0,0,0,1),fontSize:isNaN(r.fontSize)?50:r.fontSize,near:isNaN(r.near)?500:r.near,nearScale:isNaN(r.nearScale)?.3:r.nearScale,far:isNaN(r.far)?2e4:r.far,farScale:isNaN(r.farScale)?0:r.farScale,line:r.line});c.instance.forEach((function(t){t.tag="aoiflag"})),n.aoisLayer.instances.push(c)}i.billboardsCDHelper&&n.aoisLayer.instances.forEach((function(t){return i.billboardsCDHelper.bind(t)})),i.layerManager.root.addLayer(n.aoisLayer)}l(t)}))}else l()}))},this.changeVisibleByAoiName=function(t,e){n.changeVisible(e,(function(e){return!(!e||!e.properties||null==e.properties.aoi_name)&&e.properties.aoi_name.includes(t)}))},this.changeVisibleByGeomAndName=function(t,e,i){n.changeVisible(t,(function(t){var n=t.exportLngLatArray(),r=yt()(n,2),o=r[0],s=r[1],a=!0;if(e){var l=e.type,u=e.position;if("polygon"===l)a=bo(ne([o,s]),ie([F(u)]));else if("circle"===l){var c=yt()(u,3),h=c[0],p=c[1],f=c[2];a=Ms(ne([h,p]),ne([o,s]),{units:"meters"})<f}}var d=!0;return null!=i&&t&&t.properties&&null!=t.properties.aoi_name&&(d=t.properties.aoi_name.includes(i)),a&&d}))},this.setAllVisible=function(t){var e=n.aoisLayer&&n.aoisLayer.instances&&n.aoisLayer.instances[0];e&&e.setAllVisible(t)},this.setVisible=function(t,e){var i=n.aoisLayer&&n.aoisLayer.instances&&n.aoisLayer.instances[0];i&&i.setVisible(t,e)},this.changeVisible=function(t,e){var i=n.aoisLayer&&n.aoisLayer.instances&&n.aoisLayer.instances[0];i&&i.changeVisible(t,e)},this.getSelection=function(){return this.aoi.getSelection()},this.destroy=function(t){c(),this.aoisLayer&&i&&(i.billboardsCDHelper&&n.aoisLayer.instances.forEach((function(t){return i.billboardsCDHelper.unbind(t)})),i.layerManager.root.removeLayer(this.aoisLayer.id)),o=null,this.curCityData=null,i&&i.off("onClick",a),this.aoi.destroy(t),!0===t&&(i=null)}},r()(u.a.Aois.prototype,u.a.EventManager.prototype);u.a.Aois;u.a.Instance=function(t){t=t||{},u.a.Object.call(this,t.id);var e=this;this.instance=t.instance,this.config={name:{name:"名称",type:u.a.PropertyType.String,default:"未命名实例"}},Object.defineProperty(this,"type",{get:function(){return e.instance.type},enumerable:!0});var n=t.name?t.name:this.config.name.default;Object.defineProperty(this,"name",{get:function(){return n},set:function(t){t&&(n=t)},enumerable:!0})},u.a.Instance.prototype.destroy=function(){this.instance.destroy()},u.a.Instance.prototype.show=function(){this.instance.show=!0},u.a.Instance.prototype.hide=function(){this.instance.show=!1},u.a.Instance.prototype.focus=function(){this.instance.focus()},u.a.Instance.prototype.isVisible=function(){return!!_this.instance&&_this.instance.show};u.a.Instance;u.a.BlurMask=function(t){t=t||{};var e=this;this.config={intense:{name:"强度",type:u.a.PropertyType.Int,default:3}};var n=isNaN(t.intense)?this.config.intense.default:t.intense;Object.defineProperty(this,"intense",{get:function(){return n},set:function(t){isNaN(t)||(n=t,e.destroy(),i())},enumerable:!0});var i=function(){var t="\n    #define Iterations "+n+"\nuniform sampler2D colorTexture;\nvec4 KawaseBlur(vec2 pixelSize, int iteration, vec2 halfSize, vec2 uv)\n{\n    vec2 dUV = (pixelSize * float(iteration)) + halfSize;\n    \n    vec2 texcoord = vec2(0);\n    \n    texcoord.x = uv.x - dUV.x;\n    texcoord.y = uv.y + dUV.y;\n    \n    vec4 color = texture2D(colorTexture, texcoord);\n\n    texcoord.x = uv.x + dUV.x;\n    texcoord.y = uv.y + dUV.y;\n    \n    color += texture2D(colorTexture, texcoord);\n\n    texcoord.x = uv.x - dUV.x;\n    texcoord.y = uv.y - dUV.y;\n    \n    color += texture2D(colorTexture, texcoord);\n    \n    texcoord.x = uv.x + dUV.x;\n    texcoord.y = uv.y - dUV.y;\n    \n    color += texture2D(colorTexture, texcoord);\n\n    color.rgb *= 0.25;\n    \n    return color;\n}\n\nvoid main(  )\n{\n\tvec2 uv = gl_FragCoord.xy / czm_viewport.zw;\n   \n    \n    vec2 pixelSize = vec2(1.0) / czm_viewport.zw;\n    vec2 halfSize = pixelSize / vec2(2.0);\n    \n    vec4 blurColor = vec4(0);\n\n  \n    for(int i = 1; i <= Iterations; i++)\n        {\n        \tblurColor =  KawaseBlur(pixelSize, i, halfSize, uv);\n        }\n\n    \n   \n        vec4 oriColor= texture2D(colorTexture, uv);\n       \n        float ratio=pow(abs(uv.y-0.5)/0.5,2.0);\n        gl_FragColor=ratio*blurColor+(1.0-ratio)*oriColor;\n      \n\n}";e.instance=_cesium.scene.postProcessStages.add(new Cesium.PostProcessStage({fragmentShader:t}))};i()},u.a.BlurMask.prototype.destroy=function(){this.instance&&_cesium.scene.postProcessStages.remove(this.instance)};u.a.BlurMask;u.a.WaterMask=function(t){t=t||{};var e=this;this.config={texture:{name:"水印纹理",type:u.a.PropertyType.String,default:u.a.RelativePath+"/assets/mask.png"},paddingWidth:{name:"间隔宽度",type:u.a.PropertyType.Int,default:100},paddingHeight:{name:"间隔高度",type:u.a.PropertyType.Int,default:100},imageSize:{name:"图片尺寸",type:u.a.PropertyType.Int,default:100},blendFactor:{name:"混合强度",type:u.a.PropertyType.Float,default:.3},color:{name:"混合颜色",type:u.a.PropertyType.Color,default:new u.a.Color}};var n=isNaN(t.texture)?this.config.texture.default:t.texture;Object.defineProperty(this,"texture",{get:function(){return n},set:function(t){n=t,e.destroy(),l()},enumerable:!0});var i=isNaN(t.paddingWidth)?this.config.paddingWidth.default:t.paddingWidth;Object.defineProperty(this,"paddingWidth",{get:function(){return i},set:function(t){isNaN(t)||(i=t,e.instance.uniforms.paddingWidth=i)},enumerable:!0});var r=isNaN(t.paddingHeight)?this.config.paddingHeight.default:t.paddingHeight;Object.defineProperty(this,"paddingHeight",{get:function(){return r},set:function(t){isNaN(t)||(r=t,e.instance.uniforms.paddingHeight=r)},enumerable:!0});var o=isNaN(t.imageSize)?this.config.imageSize.default:t.imageSize;Object.defineProperty(this,"imageSize",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.uniforms.maskWidth=o,e.instance.uniforms.maskHeight=parseInt(o*image.naturalHeight/image.naturalWidth))},enumerable:!0});var s=isNaN(t.blendFactor)?this.config.blendFactor.default:t.blendFactor;Object.defineProperty(this,"blendFactor",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.uniforms.ratio=s)},enumerable:!0});var a=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return a},set:function(t){t instanceof u.a.Color&&(a=t)},enumerable:!0});var l=function(){Cesium.Resource.createIfNeeded(n).fetchImage().then((function(t){var n=new Cesium.Texture({context:_cesium.scene.context,source:t});a.exportArray();e.instance=_cesium.scene.postProcessStages.add(new Cesium.PostProcessStage({fragmentShader:"\n                    uniform sampler2D colorTexture;\n                    uniform sampler2D maskTexture;\n                    uniform float ratio;\n                    uniform int maskWidth;\n                    uniform int maskHeight;\n                    uniform int paddingWidth;\n                    uniform int paddingHeight;\n                    uniform vec4 blendColor;\n                     \n                void main()\n                {\n                    gl_FragColor=texture2D(colorTexture,gl_FragCoord.xy/czm_viewport.zw);\n                \n                    float offsetX=mod(gl_FragCoord.x*1.0,float(maskWidth+paddingWidth));\n                    float offsetY=mod(gl_FragCoord.y*1.0,float(maskHeight+paddingHeight));\n                    float u=(offsetX-float(paddingWidth))/float(maskWidth);\n                    float v=(offsetY-float(paddingHeight))/float(maskHeight);\n                    if(offsetX>float(paddingWidth)&&offsetY>float(paddingHeight)){\n                        gl_FragColor=mix(gl_FragColor,texture2D(maskTexture,vec2(u,v))*blendColor,ratio);\n                    }\n                }",uniforms:{blendColor:function(){return a.color},ratio:s,maskTexture:n,maskWidth:parseInt(o),maskHeight:parseInt(o*t.naturalHeight/t.naturalWidth),paddingWidth:parseInt(i),paddingHeight:parseInt(r)}}))}))};l()},u.a.WaterMask.prototype.destroy=function(){this.instance&&_cesium.scene.postProcessStages.remove(this.instance)};u.a.WaterMask;u.a.BSCMask=function(t){t=t||{};var e=this;this.config={brightness:{name:"亮度",type:u.a.PropertyType.Float,default:0,range:[0,1],step:.01},contrast:{name:"对比度",type:u.a.PropertyType.Float,default:1,range:[1,5],step:.01},saturation:{name:"饱和度",type:u.a.PropertyType.Float,default:1,range:[1,5],step:.01}};var n=isNaN(t.brightness)?this.config.brightness.default:t.brightness;Object.defineProperty(this,"brightness",{get:function(){return n},set:function(t){isNaN(t)||(n=t,e.instance.uniforms.brightness=n)},enumerable:!0});var i=isNaN(t.saturation)?this.config.saturation.default:t.saturation;Object.defineProperty(this,"saturation",{get:function(){return i},set:function(t){isNaN(t)||(i=t,e.instance.uniforms.saturation=i)},enumerable:!0});var r=isNaN(t.contrast)?this.config.contrast.default:t.contrast;Object.defineProperty(this,"contrast",{get:function(){return r},set:function(t){isNaN(t)||(r=t,e.instance.uniforms.contrast=r)},enumerable:!0});e.instance=_cesium.scene.postProcessStages.add(new Cesium.PostProcessStage({fragmentShader:"\n        uniform sampler2D colorTexture;\n        mat4 brightnessMatrix( float brightness )\n        {\n            return mat4( 1, 0, 0, 0,\n                         0, 1, 0, 0,\n                         0, 0, 1, 0,\n                         brightness, brightness, brightness, 1 );\n        }\n        \n        mat4 contrastMatrix( float contrast )\n        {\n            float t = ( 1.0 - contrast ) / 2.0;\n            \n            return mat4( contrast, 0, 0, 0,\n                         0, contrast, 0, 0,\n                         0, 0, contrast, 0,\n                         t, t, t, 1 );\n        \n        }\n        \n        mat4 saturationMatrix( float saturation )\n        {\n            vec3 luminance = vec3( 0.3086, 0.6094, 0.0820 );\n            \n            float oneMinusSat = 1.0 - saturation;\n            \n            vec3 red = vec3( luminance.x * oneMinusSat );\n            red+= vec3( saturation, 0, 0 );\n            \n            vec3 green = vec3( luminance.y * oneMinusSat );\n            green += vec3( 0, saturation, 0 );\n            \n            vec3 blue = vec3( luminance.z * oneMinusSat );\n            blue += vec3( 0, 0, saturation );\n            \n            return mat4( red,     0,\n                         green,   0,\n                         blue,    0,\n                         0, 0, 0, 1 );\n        }\n        \n        uniform float brightness;\n        uniform float contrast ;\n        uniform float saturation;\n        \n        \n        void main(  )\n        {\n             vec4 color = texture2D( colorTexture, gl_FragCoord.xy/czm_viewport.zw );\n            \n            gl_FragColor = brightnessMatrix( brightness ) *\n                        contrastMatrix( contrast ) * \n                        saturationMatrix( saturation ) *\n                        color;\n        }",uniforms:{brightness:n,contrast:r,saturation:i}}))},u.a.BSCMask.prototype.destroy=function(){this.instance&&_cesium.scene.postProcessStages.remove(this.instance)};u.a.BSCMask;u.a.ColorMask=function(t){t=t||{};var e=this;this.config={intense:{name:"强度",type:u.a.PropertyType.Float,default:20},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color(0,0,0)}};var n=isNaN(t.intense)?this.config.intense.default:t.intense;Object.defineProperty(this,"intense",{get:function(){return n},set:function(t){isNaN(t)||(n=t,e.instance.uniforms.intense=n)},enumerable:!0});var i=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return i},set:function(t){t instanceof u.a.Color&&(i=t)},enumerable:!0});e.instance=_cesium.scene.postProcessStages.add(new Cesium.PostProcessStage({fragmentShader:"\n    uniform float intense;\n    uniform vec4 borderColor;\n    #define INTENSITY2 0.0\n    uniform sampler2D colorTexture;\n        void main(){\n        vec2 uv = gl_FragCoord.xy / czm_viewport.zw;\n        vec3 col = texture2D(colorTexture, uv).rgb;\n        \n        float vig = intense*uv.x * uv.y * (1.-uv.x)*(1.-uv.y);\n        vig = pow(vig, .1 + .6 * INTENSITY2);\n        col = mix(borderColor.rgb, col*vig, vig);\n        // Output to screen\n        gl_FragColor = vec4(col,1.0);\n    }",uniforms:{intense:n,borderColor:function(){return i.color}}}))},u.a.ColorMask.prototype.destroy=function(){this.instance&&_cesium.scene.postProcessStages.remove(this.instance)};u.a.ColorMask;u.a.GlitchMask=function(t){t=t||{};var e=this;this.config={range1:{name:"特效1发生概率范围",type:u.a.PropertyType.Float,default:.03,step:.01,range:[0,1]},range2:{name:"特效2发生概率范围",type:u.a.PropertyType.Float,default:.03,step:.01,range:[0,1]}};var n=isNaN(t.range1)?this.config.range1.default:t.range1;Object.defineProperty(this,"range1",{get:function(){return n},set:function(t){isNaN(t)||(n=t/2,e.instance.uniforms.range1=n)},enumerable:!0});var i=isNaN(t.range2)?this.config.range2.default:t.range2;Object.defineProperty(this,"range2",{get:function(){return i},set:function(t){isNaN(t)||(i=t/2,e.instance.uniforms.range2=i)},enumerable:!0});var r=null,o=function(){e.instance=_cesium.scene.postProcessStages.add(new Cesium.PostProcessStage({fragmentShader:"\n    uniform sampler2D colorTexture;\n    uniform sampler2D iChannel1;\n    uniform float range1;\n    uniform float range2;\n    void main(  )\n    {\n        float iTime=czm_frameNumber/60.0;\n        vec2 uv = gl_FragCoord.xy / czm_viewport.zw;\n        vec2 block = floor(gl_FragCoord.xy / vec2(16));\n        vec2 uv_noise = block / vec2(64);\n        uv_noise += floor(vec2(iTime) * vec2(1234.0, 3543.0)) / vec2(64);\n        \n        float block_thresh = pow(fract(iTime * 1236.0453), 2.0) * 0.2;\n        float line_thresh = pow(fract(iTime * 2236.0453), 3.0) * 0.7;\n        \n        vec2 uv_r = uv, uv_g = uv, uv_b = uv;\n\n        iTime=cos(iTime);\n    \n        // glitch some blocks and lines 抖动特效\n        if (texture2D(iChannel1, uv_noise).r < block_thresh ||\n            texture2D(iChannel1, vec2(uv_noise.y, 0.0)).g < line_thresh&&(fract(iTime)>0.0&&fract(iTime)<range1)) {\n    \n            vec2 dist = (fract(uv_noise) - 0.5) * 0.3;\n            uv_r += dist * 0.1;\n            uv_g += dist * 0.2;\n            uv_b += dist * 0.125;\n        }\n    \n        gl_FragColor.r = texture2D(colorTexture, uv_r).r;\n        gl_FragColor.g = texture2D(colorTexture, uv_g).g;\n        gl_FragColor.b = texture2D(colorTexture, uv_b).b;\n    \n    \n    \n\n        // interleave lines in some blocks\n        if (texture2D(iChannel1, uv_noise).g * 1.5 < block_thresh ||\n            texture2D(iChannel1, vec2(uv_noise.y, 0.0)).g * 2.5 < line_thresh&&fract(iTime)>0.5&&fract(iTime)<(0.5+range2)) {\n            float line = fract(gl_FragCoord.y / 3.0);\n            vec3 mask = vec3(3.0, 0.0, 0.0);\n            if (line > 0.333)\n                mask = vec3(0.0, 3.0, 0.0);\n            if (line > 0.666)\n                mask = vec3(0.0, 0.0, 3.0);\n            \n            gl_FragColor.xyz *= mask;\n        }\n    \n    }",uniforms:{iChannel1:r,range1:n,range2:i}}))};r?o():Cesium.Resource.createIfNeeded(u.a.RelativePath+"/assets/glitch.png").fetchImage().then((function(t){r=new Cesium.Texture({context:window._cesium.scene.context,source:t}),o()}))},u.a.GlitchMask.prototype.destroy=function(){_cesium.scene.postProcessStages.remove(this.instance)};u.a.GlitchMask;u.a.BloomMask=function(t){t=t||{};var e=this;this.config={bloomDelta:{name:"泛光Delta",default:3.5,type:u.a.PropertyType.Float,range:[0,5],step:.1},bloomSigma:{name:"泛光Sgima",default:3.78,type:u.a.PropertyType.Float,range:[0,10],step:.1},bloomStepSize:{name:"泛光StepSize",default:5,type:u.a.PropertyType.Float,range:[0,10],step:.1},bloomContrast:{name:"泛光Contrast",default:119,type:u.a.PropertyType.Int,range:[0,255],step:1},bloomBrightness:{name:"泛光Brightness",default:1,type:u.a.PropertyType.Float,range:[-5,5],step:.1}};var n=isNaN(t.bloomContrast)?this.config.bloomContrast.default:t.bloomContrast;Object.defineProperty(this,"bloomContrast",{get:function(){return n},set:function(t){n=isNaN(t)?e.config.bloomContrast.default:t,e.instance.uniforms.contrast=n},enumerable:!0});var i=isNaN(t.bloomBrightness)?this.config.bloomBrightness.default:t.bloomBrightness;Object.defineProperty(this,"bloomBrightness",{get:function(){return i},set:function(t){i=isNaN(t)?e.config.bloomBrightness.default:t,e.instance.uniforms.brightness=i},enumerable:!0});var r=isNaN(t.bloomDelta)?this.config.bloomDelta.default:t.bloomDelta;Object.defineProperty(this,"bloomDelta",{get:function(){return r},set:function(t){r=isNaN(t)?e.config.bloomDelta.default:t,e.instance.uniforms.delta=r},enumerable:!0});var o=isNaN(t.bloomSigma)?this.config.bloomSigma.default:t.bloomSigma;Object.defineProperty(this,"bloomSigma",{get:function(){return o},set:function(t){o=isNaN(t)?e.config.bloomSigma.default:t,e.instance.uniforms.sigma=o},enumerable:!0});var s=isNaN(t.bloomStepSize)?this.config.bloomStepSize.default:t.bloomStepSize;Object.defineProperty(this,"bloomStepSize",{get:function(){return s},set:function(t){s=isNaN(t)?e.config.bloomStepSize.default:t,e.instance.uniforms.stepSize=s},enumerable:!0}),this.instance=_cesium.scene.postProcessStages.bloom,this.instance.enabled=!0,this.instance.uniforms.contrast=n,this.instance.uniforms.brightness=i,this.instance.uniforms.delta=r,this.instance.uniforms.sigma=o,this.instance.uniforms.stepSize=s},u.a.BloomMask.prototype.destroy=function(){this.instance&&(this.instance.enabled=!1)};u.a.BloomMask;u.a.BrightnessMask=function(t){t=t||{};var e=this;this.config={brightness:{name:"亮度",default:1,type:u.a.PropertyType.Float}};var n=isNaN(t.brightness)?this.config.brightness.default:t.brightness;Object.defineProperty(this,"brightness",{get:function(){return n},set:function(t){n=isNaN(t)?e.config.brightness.default:t,e.instance.uniforms.brightness=n},enumerable:!0}),this.instance=_cesium.scene.postProcessStages.add(Cesium.PostProcessStageLibrary.createBrightnessStage()),this.instance.enabled=!0,this.instance.uniforms.brightness=n},u.a.BrightnessMask.prototype.destroy=function(){this.instance&&_cesium.scene.postProcessStages.remove(this.instance)};u.a.BrightnessMask;u.a.RGBMask=function(t){t=t||{};var e=this;this.config={mixColor:{name:"红色",type:u.a.PropertyType.Color,default:new u.a.Color(1,1,1,1)}};var n=t.mixColor instanceof u.a.Color?t.mixColor:this.config.mixColor.default;Object.defineProperty(this,"mixColor",{get:function(){return n},set:function(t){t instanceof u.a.Color&&(n=t)},enumerable:!0});e.instance=_cesium.scene.postProcessStages.add(new Cesium.PostProcessStage({fragmentShader:"\n    uniform vec4 mixColor;\n    uniform sampler2D colorTexture;\n    void main(  )\n    {\n      const float pi = 3.1415926;\n        vec2 uv = gl_FragCoord.xy / czm_viewport.zw;\n        vec3 color = texture2D(colorTexture, uv).rgb;    \n        gl_FragColor = vec4(pow(color, mixColor.rgb), 1.0); \n    \n    }",uniforms:{mixColor:function(){return n.color}}}))},u.a.RGBMask.prototype.destroy=function(){this.instance&&_cesium.scene.postProcessStages.remove(this.instance)};u.a.RGBMask;u.a.MagicMask=function(t){t=t||{};var e=this;this.config={factor1:{name:"参数1",type:u.a.PropertyType.Float,default:1,range:[0,5],step:.01},factor2:{name:"参数2",type:u.a.PropertyType.Float,default:1,range:[0,3],step:.01}};var n=isNaN(t.factor1)?this.config.factor1.default:t.factor1;Object.defineProperty(this,"factor1",{get:function(){return n},set:function(t){isNaN(t)||(n=t,e.instance.uniforms.factor1=n)},enumerable:!0});var i=isNaN(t.factor2)?this.config.factor2.default:t.factor2;Object.defineProperty(this,"factor2",{get:function(){return i},set:function(t){isNaN(t)||(i=t,e.instance.uniforms.factor2=i)},enumerable:!0});e.instance=_cesium.scene.postProcessStages.add(new Cesium.PostProcessStage({fragmentShader:"\n            #define M_PI 3.1415926535897932384626433832795\n            #define M_TWO_PI (2.0 * M_PI)\n            uniform float factor1;\n            uniform float factor2;\n            float rand(vec2 n) {\n                return fract(sin(dot(n, vec2(12.9898,12.1414))) * 83758.5453);\n            }\n            \n            float noise(vec2 n) {\n                const vec2 d = vec2(0.0, 1.0);\n                vec2 b = floor(n);\n                vec2 f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\n                return mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\n            }\n            \n            vec3 ramp(float t) {\n                return t <= .5 ? vec3( 1. - t * 1.4, .2, 1.05 ) / t : vec3( .3 * (1. - t) * 2., .2, 1.05 ) / t;\n            }\n            vec2 polarMap(vec2 uv, float shift, float inner) {\n            \n                uv = vec2(0.5) - uv;\n                \n                \n                float px = 1.0 - fract(atan(uv.y, uv.x) / 6.28 + 0.25) + shift;\n                float py = (sqrt(uv.x * uv.x + uv.y * uv.y) * (1.0 + inner * 2.0) - inner) * 2.0;\n                \n                return vec2(px, py);\n            }\n            float fire(vec2 n) {\n                return noise(n) + noise(n * 2.1) * .6 + noise(n * 5.4) * .42;\n            }\n            \n            float shade(vec2 uv, float t) {\n                uv.x += uv.y < .5 ? 23.0 + t * .035 : -11.0 + t * .03;    \n                uv.y = abs(uv.y - .5);\n                uv.x *= 35.0;\n                \n                float q = fire(uv - t * .013) / 2.0;\n                vec2 r = vec2(fire(uv + q / 2.0 + t - uv.x - uv.y), fire(uv + q - t));\n                \n                return pow((r.y + r.y) * max(.0, uv.y) + .1, 4.0);\n            }\n            \n            vec3 color(float grad) {\n                \n                float m2 =  factor2;\n                grad =sqrt( grad);\n                vec3 color = vec3(1.0 / (pow(vec3(0.5, 0.0, .1) + 2.61, vec3(2.0))));\n                vec3 color2 = color;\n                color = ramp(grad);\n                color /= (m2 + max(vec3(0), color));\n                \n                return color;\n            \n            }\n           \n    uniform sampler2D colorTexture;\n        void main(){\n        gl_FragColor = texture2D(colorTexture,   gl_FragCoord.xy / czm_viewport.zw);   \n        float m1 = factor1;\n        float iTime=czm_frameNumber/100.0;\n        float t = iTime;\n        vec2 uv = gl_FragCoord.xy / czm_viewport.ww;\n        float ff = 1.0 - uv.y;\n        uv.x -= (czm_viewport.z / czm_viewport.w - 1.0) / 2.0;\n        vec2 uv2 = uv;\n        uv2.y = 1.0 - uv2.y;\n           uv = polarMap(uv, 1.3, m1);\n           uv2 = polarMap(uv2, 1.9, m1);\n    \n        vec3 c1 = color(shade(uv, t)) * ff;\n        vec3 c2 = color(shade(uv2, t)) * (1.0 - ff);\n        \n        gl_FragColor *= vec4(c1 + c2, 1.0);\n    \n        \n    }",uniforms:{factor1:n,factor2:i}}))},u.a.MagicMask.prototype.destroy=function(){this.instance&&_cesium.scene.postProcessStages.remove(this.instance)};u.a.MagicMask,n(206);var Os=null,Rs=null,As=null,Ds=function(t,e,n){t[e],t[e]=n},Fs=function(t,e,n){null!=n&&t[e]!==n||delete t[e]};u.a.prototype.init=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this;Ds(window,"_sf3d",Os=this),this.config={transparent:{name:"背景透明",default:!0===n.transparent,type:u.a.PropertyType.Boolean,noConfig:!0},sun:{name:"太阳",default:!1,type:u.a.PropertyType.Boolean,value:this.sun},moon:{name:"月亮",default:!1,type:u.a.PropertyType.Boolean},fog:{name:"雾",default:!1,type:u.a.PropertyType.Boolean},snowEnable:{name:"下雪",default:!1,type:u.a.PropertyType.Boolean},snowEffect:{name:"积雪影响",default:.5,type:u.a.PropertyType.Float},resolutionScale:{name:"分辨率",default:1,type:u.a.PropertyType.Float},rainEnable:{name:"下雨",default:!1,type:u.a.PropertyType.Boolean},skyAtmosphere:{name:"天空大气",default:!1,type:u.a.PropertyType.Boolean},groundAtmosphere:{name:"地面大气",default:!1,type:u.a.PropertyType.Boolean},fxaa:{name:"抗锯齿",default:!0,type:u.a.PropertyType.Boolean,noConfig:!0},terrainDepth:{name:"地形深度",default:!1,type:u.a.PropertyType.Boolean,noConfig:!0},backgroundColor:{name:"背景色",default:new u.a.Color(0,0,0,0),type:u.a.PropertyType.Color,noConfig:!0},globeColor:{name:"地球颜色",default:new u.a.Color(0,0,0,0),type:u.a.PropertyType.Color,noConfig:!0},skyBox:{name:"天空盒",default:!0,type:u.a.PropertyType.Boolean},cloud:{name:"云层",default:!1,type:u.a.PropertyType.Boolean},stopMovePicking:{name:"停止移动拾取",default:!1,type:u.a.PropertyType.Boolean,noConfig:!0},globeTranslucency:{name:"地面透明度",default:1,type:u.a.PropertyType.Float},terrainAspect:{name:"地形坡向",default:!1,type:u.a.PropertyType.Boolean,noConfig:!0},terrainSlope:{name:"地形坡度",default:!1,type:u.a.PropertyType.Boolean,noConfig:!0},terrainContour:{name:"等高线",default:!1,type:u.a.PropertyType.Boolean,noConfig:!0}},Object.defineProperty(this,"util",{get:function(){return u.a.Util},enumerable:!1});var r=!0===n.rainEnable;Object.defineProperty(this,"rainEnable",{get:function(){return r},set:function(t){r=!!t,Rs.weather.rainPostProcess.enabled=r},enumerable:!0});var o=!0===n.snowEnable;Object.defineProperty(this,"snowEnable",{get:function(){return o},set:function(t){o=!!t,Rs.weather.snowPostProcess.enabled=o},enumerable:!0});var a=isNaN(n.snowEffect)?this.config.snowEffect.default:n.snowEffect;Object.defineProperty(this,"snowEffect",{get:function(){return a},set:function(t){isNaN(t)||(a=t,Rs.weather.snowPostProcess.snowEffect=a)},enumerable:!0});var c=isNaN(n.resolutionScale)?this.config.resolutionScale.default:n.resolutionScale;Object.defineProperty(this,"resolutionScale",{get:function(){return c},set:function(t){isNaN(t)||(c=t,As.resolutionScale=c)},enumerable:!0});var h=!0===n.moon;Object.defineProperty(this,"moon",{get:function(){return h},set:function(t){h=1==t,As.scene.moon.show=h},enumerable:!0});var p=!0===n.sun;Object.defineProperty(this,"sun",{get:function(){return p},set:function(t){p=1==t,As.scene.sun.show=p},enumerable:!0});var d=!0===n.fog;Object.defineProperty(this,"fog",{get:function(){return d},set:function(t){d=!!t,As.scene.fog.enabled=d},enumerable:!0});var g=!0===n.skyAtmosphere;Object.defineProperty(this,"skyAtmosphere",{get:function(){return g},set:function(t){g=!!t,As.scene.skyAtmosphere.show=g},enumerable:!0});var y=!0===n.groundAtmosphere;Object.defineProperty(this,"groundAtmosphere",{get:function(){return y},set:function(t){y=!!t,As.scene.globe.showGroundAtmosphere=y},enumerable:!0});var m=n.globeColor instanceof u.a.Color?n.globeColor:this.config.globeColor.default;Object.defineProperty(this,"globeColor",{get:function(){return m},set:function(t){m=t instanceof u.a.Color?t:i.config.globeColor.default,As.scene.globe.baseColor=m.color},enumerable:!0});var _=!1!==n.fxaa;Object.defineProperty(this,"fxaa",{get:function(){return _},set:function(t){_=!!t,As.scene.postProcessStages.fxaa.enabled=_},enumerable:!0});var v=!0===n.terrainDepth;Object.defineProperty(this,"terrainDepth",{get:function(){return this.viewer.scene.globe.depthTestAgainstTerrain},set:function(t){v=!!t,As.scene.globe.depthTestAgainstTerrain=v},enumerable:!0});var x=!1!==n.skyBox;Object.defineProperty(this,"skyBox",{get:function(){return x},set:function(t){x=!!t,As.scene.skyBox.show=x},enumerable:!0});var C=n.backgroundColor instanceof u.a.Color?n.backgroundColor:this.config.backgroundColor.default;Object.defineProperty(this,"backgroundColor",{get:function(){return C},set:function(t){C=t instanceof u.a.Color?t:this.config.backgroundColor.default,As.scene.backgroundColor=C.color},enumerable:!0});var w=isNaN(n.cloud)?this.config.cloud.default:n.cloud;Object.defineProperty(this,"cloud",{get:function(){return w},set:function(t){w=!!t,Rs.weather.cloud.enabled=w},enumerable:!0});var b=!0===n.stopMovePicking;Object.defineProperty(this,"stopMovePicking",{get:function(){return b},set:function(t){b=!!t},enumerable:!0});var E=!0===n.mouseDownMovePicking;Object.defineProperty(this,"mouseDownMovePicking",{get:function(){return E},set:function(t){E=!!t},enumerable:!0}),Object.defineProperty(this,"globeTranslucency",{get:function(){return As.scene.globe.translucency.frontFaceAlpha},set:function(t){var e=t>1?1:t<0?0:t;As.scene.globe.translucency.enabled=e<1,As.scene.globe.translucency.frontFaceAlpha=e,As.scene.globe.translucency.backFaceAlpha=e},enumerable:!0}),Object.defineProperty(this,"terrainAspect",{get:function(){return this.earth.terrainEffect.aspect.enabled},set:function(t){this.earth.terrainEffect.aspect.enabled=!!t},enumerable:!0}),Object.defineProperty(this,"terrainSlope",{get:function(){return this.earth.terrainEffect.slope.enabled},set:function(t){this.earth.terrainEffect.slope.enabled=!!t},enumerable:!0}),Object.defineProperty(this,"terrainContour",{get:function(){return this.earth.terrainEffect.contour.enabled},set:function(t){this.earth.terrainEffect.contour.enabled=!!t},enumerable:!0});var I=!1;Object.defineProperty(this,"mosaicEnable",{get:function(){return I},set:function(t){I=!!t,this.earth.postProcess.mosaic.enabled=I},enumerable:!0});var P=!1;Object.defineProperty(this,"nightVisionEnable",{get:function(){return P},set:function(t){P=!!t,this.earth.postProcess.nightVision.enabled=P},enumerable:!0});var N=!1;Object.defineProperty(this,"blackAndWhiteEnable",{get:function(){return N},set:function(t){N=!!t,this.earth.postProcess.blackAndWhite.enabled=N},enumerable:!0});var S,T,L,M=!1;Object.defineProperty(this,"depthOfFieldEnable",{get:function(){return M},set:function(t){M=!!t,this.earth.postProcess.depthOfField.enabled=M},enumerable:!0}),S=window,T=["xbsjEarthScriptUrl",[69,97,114,116,104,83,68,75,29256,26435,23436,20840,23646,20110,21271,20140,35199,37096,19990,30028,31185,25216,26377,38480,20844,21496].map((function(t){return String.fromCharCode(t)})).join("")],L=S.console.log,S.console.log=function(){var t=(arguments.length<=0?void 0:arguments[0])+"";T.some((function(e){return t.includes(e)}))||L.apply(void 0,arguments)};var O=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,i=0;return function(){for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];var a=+new Date;a-i>n&&(i=a,t.apply(e,o))}},R=!1;this.lastHoverResult=null,this.lastClickResult=null;var A=function(t,e){return t===e||!(!t.id||t.id!==e.id)},D=function(t){if(t){if(t.primitive&&t.primitive.hasOwnProperty("tag"))return t.primitive.tag;if(t.id instanceof Cesium.Entity&&t.id.hasOwnProperty("tag"))return t.id.tag;if(t.id instanceof Object&&t.id.hasOwnProperty("tag"))return t.id.tag}},F=function(t){try{if(t&&!b&&(E||!R)){var e=As.scene.pick(t.endPosition);e?i.lastHoverResult?A(i.lastHoverResult,e)||(i.emit({type:"onHoverOut",data:{pickingResult:i.lastHoverResult,event:t,tag:D(i.lastHoverResult)}}),i.lastHoverResult=e,i.emit({type:"onHoverIn",data:{pickingResult:e,event:t,tag:D(e)}})):(i.lastHoverResult=e,i.emit({type:"onHoverIn",data:{pickingResult:e,event:t,tag:D(e)}})):i.lastHoverResult&&(i.emit({type:"onHoverOut",data:{pickingResult:i.lastHoverResult,event:t,tag:D(i.lastHoverResult)}}),i.lastHoverResult=null)}}catch(t){console.error(t)}},k=function(t){try{if(B&&clearTimeout(B),t&&!G){try{i.emit({type:"onLeftClick",data:t})}catch(t){console.error(t)}var e=As.scene.pick(t.position);e?i.lastClickResult?A(i.lastClickResult,e)?(i.emit({type:"onClickOut",data:{pickingResult:i.lastClickResult,event:t,tag:D(i.lastClickResult)}}),i.lastClickResult=null):(i.emit({type:"onClickOut",data:{pickingResult:i.lastClickResult,event:t,tag:D(i.lastHoverResult)}}),i.lastClickResult=e,i.emit({type:"onClickIn",data:{pickingResult:e,event:t,tag:D(e)}})):(i.lastClickResult=e,i.emit({type:"onClickIn",data:{pickingResult:e,event:t,tag:D(e)}})):i.lastClickResult&&(i.emit({type:"onClickOut",data:{pickingResult:i.lastClickResult,event:t,tag:D(i.lastClickResult)}}),i.lastClickResult=null),i.emit({type:"onClick",data:{pickingResult:e,event:t,tag:D(e)}})}B=null}catch(t){console.error(t)}},B=null,G=null,j=function(t){try{if(B&&clearTimeout(B),t){var e=As.scene.pick(t.position);e&&(i.emit({type:"onLeftDoubleClick",data:{pickingResult:e,event:t}}),i.emit({type:"onDoubleClick",data:{pickingResult:e,event:t}}))}G=null}catch(t){console.error(t)}};this.container=t instanceof XE.Earth?t._viewer.container:document.getElementById(t),this.container||(this.container=document.body);var z=document.createElement("div");return z.id="toolTip-"+this.container.getAttribute("id"),z.style.position="absolute",z.style.padding="5px",z.style["background-color"]="rgba(0, 0, 0, 0.5)",z.style.color="#fff",z.style.display="none",z.style["pointer-events"]="none",this.container.parentNode.insertBefore(z,this.container.nextSibling),new l.a((function(e,r){XE.ready().then((function(){try{var o=s()({shouldAnimate:!0,animation:!1,geocoder:!1,homeButton:!1,sceneModePicker:!1,baseLayerPicker:!1,fullscreenButton:!1,navigationHelpButton:!1,timeline:!1,fulllscreenButtond:!1,selectionIndicator:!1,vrButton:!1,infoBox:!1},n.customParams||{});i.config.transparent.default&&(o.orderIndependentTranslucency=!1,o.contextOptions={webgl:{alpha:!0}}),i.earth=Rs=t instanceof XE.Earth?t:new XE.Earth(i.container,o),Ds(window,"_earthsdk",Rs),i.viewer=As=Rs.czm.viewer,Ds(window,"_cesium",As),i.camera=new u.a.Camera(i,n),n.minHeight&&(i.camera.minHeight=n.minHeight),n.maxHeight&&(i.camera.maxHeight=n.maxHeight),i.marktool=new u.a.MarkTool(i),i.measuretool=new u.a.MeasureTool(i),i.routerecorder=new u.a.RouteRecorder(i),i.layerManager=new u.a.LayerManager(i),i.domMarkerManager=new u.a.DomMarkerManager(i),i.animateManager=new u.a.AnimateManager(i),As.cesiumWidget.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),i.geometryHelper=Mo,As.scene.moon.show=h,As.scene.sun.show=p,As.scene.fog.enabled=d,As.scene.skyAtmosphere.show=g,As.scene.globe.showGroundAtmosphere=y,As.scene.globe.baseColor=m.color,As.scene.postProcessStages.fxaa.enabled=_,As.scene.globe.depthTestAgainstTerrain=v,As.scene.skyBox.show=x,As.scene.backgroundColor=C.color,Rs.weather.cloud.enabled=w,Rs.sceneTree.root={children:!1===n.addDefaultImagery?[]:[{czmObject:{name:"默认离线影像",xbsjType:"Imagery",xbsjImageryProvider:{createTileMapServiceImageryProvider:{url:XE.HTML.cesiumDir+"Assets/Textures/NaturalEarthII",fileExtension:"jpg"},type:"createTileMapServiceImageryProvider"}}}]},Rs.camera.immersion.enabled=!1,As.scene.preRender.addEventListener((function(){f.a.update(),i.emit({type:"onEachFrame"})}));var a=new Cesium.ScreenSpaceEventHandler(As.canvas);a.setInputAction((function(t){B=setTimeout((function(){k(t)}),200)}),Cesium.ScreenSpaceEventType.LEFT_CLICK),a.setInputAction((function(t){R=!0,i.emit({type:"onLeftDown",data:t})}),Cesium.ScreenSpaceEventType.LEFT_DOWN),a.setInputAction((function(t){G=setTimeout((function(){j(t)}),100)}),Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),a.setInputAction((function(t){R=!1,i.emit({type:"onLeftUp",data:t})}),Cesium.ScreenSpaceEventType.LEFT_UP),a.setInputAction((function(t){i.emit({type:"onRightClick",data:t})}),Cesium.ScreenSpaceEventType.RIGHT_CLICK),a.setInputAction((function(t){R=!0,i.emit({type:"onRightDown",data:t})}),Cesium.ScreenSpaceEventType.RIGHT_DOWN),a.setInputAction((function(t){R=!1,i.emit({type:"onRightUp",data:t})}),Cesium.ScreenSpaceEventType.RIGHT_UP),a.setInputAction(O((function(t){F(t),i.emit({type:"onMouseMove",data:t})})),Cesium.ScreenSpaceEventType.MOUSE_MOVE),a.setInputAction((function(t){i.emit({type:"onMiddleClick",data:t})}),Cesium.ScreenSpaceEventType.MIDDLE_CLICK),a.setInputAction((function(t){R=!0,i.emit({type:"onMiddleDown",data:t})}),Cesium.ScreenSpaceEventType.MIDDLE_DOWN),a.setInputAction((function(t){R=!1,i.emit({type:"onMiddleUp",data:t})}),Cesium.ScreenSpaceEventType.MIDDLE_UP),a.setInputAction((function(t){i.emit({type:"onScroll",data:t})}),Cesium.ScreenSpaceEventType.WHEEL),e()}catch(t){console.error(t),r()}}))}))},u.a.prototype.restoreContext=function(){window._earthsdk=this.earth,window._cesium=this.viewer,window._sf3d=this};var ks=new Cesium.Cartographic;u.a.prototype.endPickPosition=function(){u.a.Util.afterPickPosition(this.viewer),this._pph&&this._pph.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK)},u.a.prototype.beginPickPosition=function(t){var e=this;e.endPickPosition(),u.a.Util.beforePickingPosition(this.viewer);var n=e.viewer;e._pph||(e._pph=new Cesium.ScreenSpaceEventHandler(n.scene.canvas)),e._pph.setInputAction((function(e){var i=n.scene.pickPosition(e.position);if(i||(i=n.scene.globe.pick(n.camera.getPickRay(e.position),n.scene)),i&&"function"==typeof t){var r=Cesium.Cartographic.fromCartesian(i,null,ks);t({position:i,longitude:180*r.longitude/Math.PI,latitude:180*r.latitude/Math.PI,height:r.height,terrainHeight:n.scene.globe.getHeight(r)})}}),Cesium.ScreenSpaceEventType.LEFT_CLICK)},u.a.prototype.endPick=function(){this._ph&&this._ph.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK)},u.a.prototype.beginPick=function(t){var e=this;e.endPick();var n=e.viewer;e._ph||(e._ph=new Cesium.ScreenSpaceEventHandler(n.scene.canvas)),e._ph.setInputAction((function(i){var r=n.scene.pick(i.position);if(r){e.endPick();var o=n.scene.pickPosition(i.position);if(o||(o=n.scene.globe.pick(n.camera.getPickRay(i.position),n.scene)),o&&"function"==typeof t){var s=Cesium.Cartographic.fromCartesian(o,null,ks);t(r,{position:o,longitude:180*s.longitude/Math.PI,latitude:180*s.latitude/Math.PI,height:s.height,terrainHeight:n.scene.globe.getHeight(s)})}}}),Cesium.ScreenSpaceEventType.LEFT_CLICK)},u.a.prototype.screenToCartesian=function(t,e){var n=this.viewer,i=new Cesium.Cartesian2(t,e),r=n.scene.pickPosition(i);return r||(r=n.scene.globe.pick(n.camera.getPickRay(i),n.scene)),r};var Bs=new Cesium.Cartographic;u.a.prototype.toTerrainCartesian=function(t){var e=this.viewer,n=Cesium.Cartographic.fromCartesian(t,null,Bs),i=e.scene.globe.getHeight(n);return Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,i,e.scene.globe.ellipsoid)},u.a.prototype.getResolution=function(){var t=this.viewer,e=t.camera;return Math.tan(e.frustum.fovy/2)*e.positionCartographic.height*2/t.canvas.height},u.a.prototype.updateSkyBoxOnGround=function(t){var e=this.earth.weather.skyBox;if(e)for(var n in e.skyBoxOnGround=!0,t)e[n]=t[n]},u.a.prototype.destroy=function(){try{Fs(window,"_earthsdk",Rs),Fs(window,"_cesium",As),Fs(window,"_sf3d",Os),Rs.destroy()}catch(t){console.error(t)}this.emit({type:"onDestroy"})},u.a.prototype.export=function(){for(var t in this.config)this.config[t].curValue=this[t];return{scene:this.config,root:this.layerManager.root.export()}},r()(u.a.prototype,u.a.EventManager.prototype),window.Sf3d=u.a;var Gs=u.a;u.a.MapTile=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this,n="<<<SFMAP_V4.0_DEFAULT_LAYER_URL>>>";n.indexOf("<<<")<0&&0!==n.indexOf("http")&&(n=window.location.protocol+n),this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},url:{name:"地址",type:u.a.PropertyType.Url,default:0===n.length||0===n.indexOf("<<<")?"https://server.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}":n},brightness:{name:"亮度",type:u.a.PropertyType.Float,default:1,step:.1},minimumLevel:{name:"最小级别",type:u.a.PropertyType.Int,step:1,default:0},maximumLevel:{name:"最大级别",step:1,type:u.a.PropertyType.Int,default:24},zIndex:{name:"层级高度",step:1,type:u.a.PropertyType.Int,default:0,noConfig:!0},srcCoordType:{name:"源类型",type:u.a.PropertyType.Dictionary,options:[{key:"WGS84",value:"WGS84"},{key:"GCJ02",value:"GCJ02"}],default:"WGS84"},dstCoordType:{name:"目标类型",type:u.a.PropertyType.Dictionary,options:[{key:"WGS84",value:"WGS84"},{key:"GCJ02",value:"GCJ02"}],default:"WGS84"},east:{name:"东",range:[-180,180],type:u.a.PropertyType.Float,default:180},south:{name:"南",range:[-90,90],type:u.a.PropertyType.Float,default:-90},west:{name:"西",range:[-180,180],type:u.a.PropertyType.Float,default:-180},north:{name:"北",range:[-90,90],type:u.a.PropertyType.Float,default:90},alpha:{name:"透明度",type:u.a.PropertyType.Float,default:1},contrast:{name:"对比度",type:u.a.PropertyType.Float,default:1},gamma:{name:"gamma",type:u.a.PropertyType.Float,default:1},hue:{name:"色域",type:u.a.PropertyType.Float,default:0},saturation:{name:"饱和度",type:u.a.PropertyType.Float,default:1}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,e.instance.show=i},enumerable:!0});var r=t.url||this.config.url.default;Object.defineProperty(this,"url",{get:function(){return r},set:function(t){t&&(r=t,e.instance.xbsjImageryProvider.XbsjImageryProvider.url=r)},enumerable:!0});var o=isNaN(t.brightness)?this.config.brightness.default:t.brightness;Object.defineProperty(this,"brightness",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.brightness=o)},enumerable:!0});var s=isNaN(t.alpha)?this.config.alpha.default:t.alpha;Object.defineProperty(this,"alpha",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.alpha=s)},enumerable:!0});var a=isNaN(t.contrast)?this.config.contrast.default:t.contrast;Object.defineProperty(this,"contrast",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.contrast=a)},enumerable:!0});var l=isNaN(t.gamma)?this.config.gamma.default:t.gamma;Object.defineProperty(this,"gamma",{get:function(){return l},set:function(t){isNaN(t)||(l=t,e.instance.gamma=l)},enumerable:!0});var c=isNaN(t.hue)?this.config.hue.default:t.hue;Object.defineProperty(this,"hue",{get:function(){return c},set:function(t){isNaN(t)||(c=t,e.instance.hue=c)},enumerable:!0});var h=isNaN(t.saturation)?this.config.saturation.default:t.saturation;Object.defineProperty(this,"saturation",{get:function(){return h},set:function(t){isNaN(t)||(h=t,e.instance.saturation=h)},enumerable:!0});var p=isNaN(t.minimumLevel)?this.config.minimumLevel.default:t.minimumLevel;Object.defineProperty(this,"minimumLevel",{get:function(){return p},set:function(t){isNaN(t)||(p=t,e.instance.xbsjImageryProvider.XbsjImageryProvider.minimumLevel=p)},enumerable:!0});var f=isNaN(t.maximumLevel)?this.config.maximumLevel.default:t.maximumLevel;Object.defineProperty(this,"maximumLevel",{get:function(){return f},set:function(t){isNaN(t)||(f=t,e.instance.xbsjImageryProvider.XbsjImageryProvider.maximumLevel=f)},enumerable:!0});var d=isNaN(t.zIndex)?this.config.zIndex.default:t.zIndex;Object.defineProperty(this,"zIndex",{get:function(){return d},set:function(t){isNaN(t)||(d=t,e.instance.zIndex=d)},enumerable:!0});var g=t.srcCoordType||this.config.srcCoordType.default;Object.defineProperty(this,"srcCoordType",{get:function(){return g},set:function(t){t&&(g=t,e.instance.xbsjImageryProvider.XbsjImageryProvider.srcCoordType=g)},enumerable:!0});var y=t.dstCoordType||this.config.dstCoordType.default;Object.defineProperty(this,"dstCoordType",{get:function(){return y},set:function(t){t&&(y=t,e.instance.xbsjImageryProvider.XbsjImageryProvider.dstCoordType=y)},enumerable:!0});var m=isNaN(t.east)?this.config.east.default:t.east;Object.defineProperty(this,"east",{get:function(){return m},set:function(t){isNaN(t)||(m=t,e.instance.xbsjImageryProvider.XbsjImageryProvider.rectangle[2]=Cesium.Math.toRadians(m))},enumerable:!0});var _=isNaN(t.south)?this.config.south.default:t.south;Object.defineProperty(this,"south",{get:function(){return _},set:function(t){isNaN(t)||(_=t,e.instance.xbsjImageryProvider.XbsjImageryProvider.rectangle[1]=Cesium.Math.toRadians(_))},enumerable:!0});var v=isNaN(t.north)?this.config.north.default:t.north;Object.defineProperty(this,"north",{get:function(){return v},set:function(t){isNaN(t)||(v=t,e.instance.xbsjImageryProvider.XbsjImageryProvider.rectangle[3]=Cesium.Math.toRadians(v))},enumerable:!0});var x=isNaN(t.west)?this.config.west.default:t.west;Object.defineProperty(this,"west",{get:function(){return x},set:function(t){isNaN(t)||(x=t,e.instance.xbsjImageryProvider.XbsjImageryProvider.rectangle[0]=Cesium.Math.toRadians(x))},enumerable:!0}),this.instance=new XE.Obj.Imagery(I.apply(void 0,arguments)||_earthsdk),this.instance.xbsjFromJSON({xbsjType:"Imagery",xbsjGuid:this.id,brightness:o,hue:c,"saturation ":h,alpha:s,contrast:a,gamma:l,xbsjImageryProvider:{XbsjImageryProvider:{url:r,srcCoordType:g,dstCoordType:y,maximumLevel:f,minimumLevel:p,rectangle:[Cesium.Math.toRadians(x),Cesium.Math.toRadians(_),Cesium.Math.toRadians(m),Cesium.Math.toRadians(v)],"xbsjZIndex ":d}}})},u.a.MapTile.prototype=new u.a.Element,u.a.MapTile.prototype.type="MapTile";u.a.MapTile;u.a.Billboard3d=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},textureLeft:{name:"左边框纹理",type:u.a.PropertyType.String,default:null},textureRight:{name:"右边框纹理",type:u.a.PropertyType.String,default:null},textureMiddle:{name:"中间纹理",type:u.a.PropertyType.String,default:null},heading:{name:"航向角",type:u.a.PropertyType.Float,default:0},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},width:{name:"宽度",type:u.a.PropertyType.Float,default:10},text:{name:"文本",type:u.a.PropertyType.String,default:"这是一段测试文本"},fontColor:{name:"字体颜色",type:u.a.PropertyType.Color,default:new u.a.Color},fontSize:{name:"字体大小",type:u.a.PropertyType.String,default:30},faceCamera:{name:"朝向相机",type:u.a.PropertyType.Boolean,default:!1}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.textureLeft||this.config.textureLeft.default;Object.defineProperty(this,"textureLeft",{get:function(){return i},set:function(t){i=t,u.a.AssetManager.getImage([i,o,r]).then((function(t){g=t;var n=d();e.instance.plane.material.image=n}))},enumerable:!0});var r=t.textureRight||this.config.textureRight.default;Object.defineProperty(this,"textureRight",{get:function(){return r},set:function(t){r=t,u.a.AssetManager.getImage([i,o,r]).then((function(t){g=t;var n=d();e.instance.plane.material.image=n}))},enumerable:!0});var o=t.textureMiddle||this.config.textureMiddle.default;Object.defineProperty(this,"textureMiddle",{get:function(){return o},set:function(t){o=t,u.a.AssetManager.getImage([i,o,r]).then((function(t){g=t;var n=d();e.instance.plane.material.image=n}))},enumerable:!0});var s=isNaN(t.heading)?this.config.heading.default:t.heading;Object.defineProperty(this,"heading",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.plane.plane._value.normal.x=Cesium.Math.toRadians(s))},enumerable:!0});var a=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return a},set:function(t){t instanceof u.a.Point3d&&(a=t)},enumerable:!0});var l=isNaN(t.width)?this.config.width.default:t.width;Object.defineProperty(this,"width",{get:function(){return l},set:function(t){isNaN(t)||(l=t)},enumerable:!0});var c=t.text||this.config.text.default;Object.defineProperty(this,"text",{get:function(){return c},set:function(t){if(t){c=t;var n=d();e.instance.plane.material.image=n}},enumerable:!0});var h=t.fontColor||this.config.fontColor.default;Object.defineProperty(this,"fontColor",{get:function(){return h},set:function(t){if(t instanceof u.a.Color){h=t;var n=d();e.instance.plane.material.image=n}},enumerable:!0});var p=isNaN(t.fontSize)?this.config.fontSize.default:t.fontSize;Object.defineProperty(this,"fontSize",{get:function(){return p},set:function(t){if(!isNaN(t)){p=t;var n=d();e.instance.plane.material.image=n}},enumerable:!0});var f=!0===t.faceCamera;Object.defineProperty(this,"faceCamera",{get:function(){return f},set:function(t){f=!!t},enumerable:!0});var d=function(){var t=200,e=document.createElement("canvas");e.width=28+t,e.height=74;var n=e.getContext("2d");n.font=p+"px Helvetica";var i=n.measureText(c).width+50;return t=Math.max(i,t),e.width=28+t,g[0]&&n.drawImage(g[0],0,0,14,74),g[1]&&n.drawImage(g[1],14,0,t,74),g[2]&&n.drawImage(g[2],14+t,0,14,74),n.font=p+"px Helvetica",n.fillStyle=h.exportCss(!0),n.textAlign="center",n.textBaseline="middle",n.fillText(c,e.width/2,e.height/2),e},g=null;u.a.AssetManager.getImage([i,o,r]).then((function(i){g=i;var r=d();e.instance=_cesium.entities.add({id:a.id,show:n,position:new Cesium.CallbackProperty((function(){return a.exportCartesian()})),plane:{plane:new Cesium.Plane(new Cesium.Cartesian3(0,-1,Cesium.Math.toRadians(s)),0),dimensions:new Cesium.CallbackProperty((function(){return new Cesium.Cartesian2(l,l*r.height/r.width)})),material:new Cesium.ImageMaterialProperty({image:r,transparent:!0})}}),e.instance.orientation=new Cesium.CallbackProperty((function(){if(e.instance.show&&f)return Cesium.Transforms.headingPitchRollQuaternion(a.exportCartesian(),new Cesium.HeadingPitchRoll(_cesium.camera.heading,0,0))}),!1),"function"==typeof t.callback&&t.callback()}))},u.a.Billboard3d.prototype=new u.a.Element,u.a.Billboard3d.prototype.type="Billboard3d";u.a.Billboard3d;function js(t,e){var n=u.a.Util.sampleHeight({lng:t.lng,lat:t.lat,wholeScene:!1,objectsToExclude:[]});return n=void 0===n||n<0?e/2:n<e?n:Math.max(e-(n-e),0)}function zs(t,e,n,i){var r=t[2];if(r&&r.instance){r.destroy();var o=[];e.forEach((function(t){var e=t.line?t.line:n.line;if(e){var r=t.exportLngLatHeightArray(),s=yt()(r,3),a=s[0],l=s[1],c=s[2],h=0;h=null!=e.balt?e.balt:e.height>0?c-e.height:js(t,c);var p=new u.a.Point3dCollection(t.id);if(i){var f=i(t,h,c);p.fromLngLatHeightArray([a,l,f.balt,a,l,f.alt])}else p.fromLngLatHeightArray([a,l,h,a,l,c]);o.push(p)}})),t[2]=new u.a.PolyLines(s()({traces:o},n.line,{clampToGround:!1}))}}u.a.Billboards=function(t){t=t||{},u.a.Element.call(this,t.id);this.option=t,this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},fontSize:{name:"字体大小",type:u.a.PropertyType.Int,default:30},maxCharPerRow:{name:"每行最大字数",type:u.a.PropertyType.Int,default:10},backgroundOffsetX:{name:"背景偏移量横向",type:u.a.PropertyType.Int,default:0},backgroundOffsetY:{name:"背景偏移量纵向",type:u.a.PropertyType.Int,default:0},labelOffsetX:{name:"标签偏移量横向",type:u.a.PropertyType.Int,default:0},labelOffsetY:{name:"标签偏移量纵向",type:u.a.PropertyType.Int,default:0},backgroundUrl:{name:"背景图片路径",type:u.a.PropertyType.String,noConfig:!0,default:""},showBackground:{name:"显示背景颜色",type:u.a.PropertyType.Boolean,default:!1},backgroundColor:{name:"背景颜色",type:u.a.PropertyType.Color,default:new u.a.Color(0,0,0,1)},near:{name:"近阈值",type:u.a.PropertyType.Float,default:100},nearScale:{name:"近缩放比例",type:u.a.PropertyType.Float,default:1},far:{name:"远阈值",type:u.a.PropertyType.Float,default:1e4},farScale:{name:"远缩放比例",type:u.a.PropertyType.Float,default:0},trace:{name:"轨迹",type:u.a.PropertyType.Trace,default:t.trace instanceof u.a.Point3dCollection?t.trace:new u.a.Point3dCollection,noConfig:!0}};var e=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return e},set:function(t){e=!!t,v._billboards.forEach((function(t){t.show=e})),x._labels.forEach((function(t){t.show=e})),w&&(w.show=e)},enumerable:!0});var n=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return n},set:function(t){t instanceof u.a.Color&&(n=t,x._labels.forEach((function(t){t.fillColor=n.color})))},enumerable:!0});var i=isNaN(t.fontSize)?this.config.fontSize.default:t.fontSize;Object.defineProperty(this,"fontSize",{get:function(){return i},set:function(t){isNaN(t)||(i=t,x._labels.forEach((function(t){t.font=i+"px Helvetica"})))},enumerable:!0});var r=isNaN(t.maxCharPerRow)?this.config.maxCharPerRow.default:t.maxCharPerRow;Object.defineProperty(this,"maxCharPerRow",{get:function(){return r},set:function(t){!isNaN(t)&&t>=1&&(r=t,x._labels.forEach((function(t){var e="";t.oriText||(t.oriText=t.text);for(var n=0;n<t.oriText.length;n++)e+=t.oriText.charAt(n),(n+1)%r==0&&0!=n&&n!=t.oriText.length-1&&(e+="\n");t.text=e})))},enumerable:!0});var o=isNaN(t.backgroundOffsetX)?this.config.backgroundOffsetX.default:t.backgroundOffsetX;Object.defineProperty(this,"backgroundOffsetX",{get:function(){return o},set:function(t){isNaN(t)||(o=t,v._billboards.forEach((function(t){t.pixelOffset=new Cesium.Cartesian2(o,a)})))},enumerable:!0});var a=isNaN(t.backgroundOffsetY)?this.config.backgroundOffsetY.default:t.backgroundOffsetY;Object.defineProperty(this,"backgroundOffsetY",{get:function(){return a},set:function(t){isNaN(t)||(a=t,v._billboards.forEach((function(t){t.pixelOffset=new Cesium.Cartesian2(o,a)})))},enumerable:!0});var l=isNaN(t.labelOffsetX)?this.config.labelOffsetX.default:t.labelOffsetX;Object.defineProperty(this,"labelOffsetX",{get:function(){return l},set:function(t){if(!isNaN(t)){l=t;for(var e=0;e<x.length;e++)x.get(e).pixelOffset=new Cesium.Cartesian2(l,c)}},enumerable:!0});var c=isNaN(t.labelOffsetY)?this.config.labelOffsetY.default:t.labelOffsetY;Object.defineProperty(this,"labelOffsetY",{get:function(){return c},set:function(t){if(!isNaN(t)){c=t;for(var e=0;e<x.length;e++)x.get(e).pixelOffset=new Cesium.Cartesian2(l,c)}},enumerable:!0});var h=t.backgroundUrl||this.config.backgroundUrl.default,p=t.pointBgUrl;Object.defineProperty(this,"backgroundUrl",{get:function(){return h},set:function(t){h=t,v._billboards.forEach((function(t){t.backgroundUrl=h}))},enumerable:!0});var f=!0===t.showBackground;Object.defineProperty(this,"showBackground",{get:function(){return f},set:function(t){f=!!t;for(var e=0;e<x.length;e++)x.get(e).showBackground=f},enumerable:!0});var d=t.backgroundColor instanceof u.a.Color?t.backgroundColor:this.config.backgroundColor.default;Object.defineProperty(this,"backgroundColor",{get:function(){return d},set:function(t){if(t instanceof u.a.Color){d=t;for(var e=0;e<x.length;e++)x.get(e).backgroundColor=d.color}},enumerable:!0});var g=isNaN(t.near)?this.config.near.default:t.near;Object.defineProperty(this,"near",{get:function(){return g},set:function(t){isNaN(t)||(g=t,v._billboards.forEach((function(t){t.scaleByDistance.near=g})),x._labels.forEach((function(t){t.scaleByDistance.near=g})))},enumerable:!0});var y=isNaN(t.nearScale)?this.config.nearScale.default:t.nearScale;Object.defineProperty(this,"nearScale",{get:function(){return y},set:function(t){isNaN(t)||(y=t,v._billboards.forEach((function(t){t.scaleByDistance.nearValue=y})),x._labels.forEach((function(t){t.scaleByDistance.nearValue=y})))},enumerable:!0});var m=isNaN(t.far)?this.config.far.default:t.far;Object.defineProperty(this,"far",{get:function(){return m},set:function(t){isNaN(t)||(m=t,v._billboards.forEach((function(t){t.scaleByDistance.far=m})),x._labels.forEach((function(t){t.scaleByDistance.far=m})))},enumerable:!0});var _=isNaN(t.farScale)?this.config.farScale.default:t.farScale;Object.defineProperty(this,"farScale",{get:function(){return _},set:function(t){isNaN(t)||(_=t,v._billboards.forEach((function(t){t.scaleByDistance.farValue=_})),x._labels.forEach((function(t){t.scaleByDistance.farValue=_})))},enumerable:!0});var v=_cesium.scene.primitives.add(new Cesium.BillboardCollection),x=_cesium.scene.primitives.add(new Cesium.LabelCollection),C=[];this.config.trace.default.forEach((function(r){var s=r.line?r.line:t.line;if(s){var w=r.exportLngLatHeightArray(),b=yt()(w,3),E=b[0],I=b[1],P=b[2],N=0;N=null!=s.balt?s.balt:s.height>0?P-s.height:js(r,P);var S=new u.a.Point3dCollection(r.id);S.fromLngLatHeightArray([E,I,N,E,I,P]),C.push(S)}var T=t.hasOwnProperty("horizontalOrigin")?t.horizontalOrigin:Cesium.HorizontalOrigin.CENTER,L=t.hasOwnProperty("verticalOrigin")?t.verticalOrigin:Cesium.VerticalOrigin.CENTER,M=t.hasOwnProperty("scale")?t.scale:1,O=t.hasOwnProperty("heightReference")?t.heightReference:Cesium.HeightReference.NONE;try{var R=r.backgroundUrl?r.backgroundUrl:h,A=t.backgroundEyeOffset||new Cesium.Cartesian3(0,0,-1);if(R){var D={position:r.exportCartesian(),show:e,image:R,color:new Cesium.Color(1,1,1,f?d.color.alpha:1),id:r.id,scale:M,scaleByDistance:new Cesium.NearFarScalar(g,y,m,_),pixelOffset:new Cesium.Cartesian2(o,a),pixelOffsetScaleByDistance:new Cesium.NearFarScalar(g,y,m,_),eyeOffset:A,horizontalOrigin:T,verticalOrigin:L,heightReference:O};(t.backgroundDisableDepth||t.billboardDisableDepth)&&(D.disableDepthTestDistance=t.backgroundDisableDepth||t.billboardDisableDepth),v.add(D)}if(p){var F={position:r.exportCartesian(),show:e,image:p,id:r.id,scale:M,scaleByDistance:new Cesium.NearFarScalar(g,y,m,_),pixelOffset:new Cesium.Cartesian2(o,a+50),pixelOffsetScaleByDistance:new Cesium.NearFarScalar(g,y,m,_),eyeOffset:A,horizontalOrigin:T,verticalOrigin:L,heightReference:O};t.billboardDisableDepth&&(F.disableDepthTestDistance=t.billboardDisableDepth),v.add(F)}}catch(t){console.error(t)}if(r.text){A=t.labelEyeOffset||new Cesium.Cartesian3(0,0,-10);var k={position:r.exportCartesian(),show:e,font:i+"px Helvetica",id:r.id,scale:M,text:r.text,showBackground:f,backgroundColor:d.color,backgroundPadding:new Cesium.Cartesian2(7,5),style:Cesium.LabelStyle.FILL,fillColor:n.color,pixelOffset:new Cesium.Cartesian2(l,c),pixelOffsetScaleByDistance:new Cesium.NearFarScalar(g,y,m,_),eyeOffset:A,scaleByDistance:new Cesium.NearFarScalar(g,y,m,_),horizontalOrigin:T,verticalOrigin:L,heightReference:O};(t.labelDisableDepth||t.billboardDisableDepth)&&(k.disableDepthTestDistance=t.labelDisableDepth||t.billboardDisableDepth),x.add(k)}}));var w=new u.a.PolyLines(s()({traces:C},t.line,{clampToGround:!1}));this.instance=[v,x,w],this._selected=[]},u.a.Billboards.prototype=new u.a.Element,u.a.Billboards.prototype.applyTag=function(t){var e=this.instance,n=yt()(e,3),i=n[0],r=n[1],o=n[2];i.tag=t,r.tag=t,o&&o.applyTag(t),this.config.trace.default.points.forEach((function(e,n){var o=i.get(n),s=r.get(n);o&&(o.tag=e.tag||t),s&&(s.tag=e.tag||t)}))},u.a.Billboards.prototype.updateBillboard=function(t){var e=this.instance[0]._billboards.find((function(e){return e.id==t.id})),n=this.instance[1]._labels.find((function(e){return e.id==t.id})),i=this.instance[2].instance&&this.instance[2].instance.getGeometryInstanceAttributes(t.id);if(!0!==t.show&&!1!==t.show||(e&&(e.show=t.show),n&&(n.show=t.show),i&&(i.show=Cesium.ShowGeometryInstanceAttribute.toValue(t.show,i.show))),t.position instanceof u.a.Point3d&&(e&&(e.position=t.position.exportCartesian()),n&&(n.position=t.position.exportCartesian())),null!=t.scale){var r=parseFloat(t.scale);e._oldScale=e._oldScale||e.scale,n._oldScale=n._oldScale||n.scale,e.scale=r*e._oldScale,n.scale=r*n._oldScale}},u.a.Billboards.prototype.setAllVisible=function(t){var e=this;this.instance[0]._billboards.forEach((function(e){e.show=t})),this.instance[1]._labels.forEach((function(e){e.show=t})),this.instance[2]&&this.instance[2].instance&&this.config.trace.default.forEach((function(n){var i=e.instance[2].instance.getGeometryInstanceAttributes(n.id);i&&(i.show=Cesium.ShowGeometryInstanceAttribute.toValue(t,i.show))}))},u.a.Billboards.prototype.setVisible=function(t,e){var n=this;this.config.trace.default.forEach((function(i,r){if(e(i,r)){var o=n.instance[0]._billboards.find((function(t){return t.id==i.id}));o&&(o.show=t);var s=n.instance[1]._labels.find((function(t){return t.id==i.id}));s&&(s.show=t)}}));var i=this.instance[2];i&&i.setVisible(t,e)},u.a.Billboards.prototype.changeVisible=function(t,e){var n=this;this.config.trace.default.forEach((function(i,r){var o=e(i,r)?t:!t,s=n.instance[0]._billboards.find((function(t){return t.id==i.id}));s&&(s.show=o);var a=n.instance[1]._labels.find((function(t){return t.id==i.id}));a&&(a.show=o);var l=n.instance[2].instance&&n.instance[2].instance.getGeometryInstanceAttributes(i.id);l&&(l.show=Cesium.ShowGeometryInstanceAttribute.toValue(o,l.show))}))},u.a.Billboards.prototype.select=function(t,e){if(e=e||{},!(this._selected.indexOf(t)>=0)){var n=e.scaleRatio||1.5,i={};i.id=t,i.scale=n;var r=this.config.trace.default.points.find((function(e){return e.id===t})),o=r.height*n;if(r){var s=_cesium.scene.globe.getHeight(Cesium.Cartographic.fromCartesian(r.exportCartesian()))||0;o=(r.height-s)*n+s,i.position=(new u.a.Point3d).fromLngLat(r.lng,r.lat,o)}this.updateBillboard(i),zs(this.instance,this.config.trace.default,this.option,(function(e,n,i){return e.id===t?{alt:o,balt:n}:{alt:i,balt:n}})),this._selected.push(t)}},u.a.Billboards.prototype.clearSelect=function(){var t=this;this._selected.forEach((function(e){var n={};n.id=e,n.scale=1;var i=t.config.trace.default.points.find((function(t){return t.id===e}));i&&(n.position=i.clone()),t.updateBillboard(n)})),zs(this.instance,this.config.trace.default,this.option),this._selected.splice(0,this._selected.length)},u.a.Billboards.prototype.isSelected=function(t){return this._selected.indexOf(t)>=0},u.a.Billboards.prototype.type="Billboards";u.a.Billboards;function Us(){}function qs(t,e){return Math.abs((t[0]+t[2])/2-(e[0]+e[2])/2)<(t[2]+e[2]-t[0]-e[0])/2&&Math.abs((t[1]+t[3])/2-(e[1]+e[3])/2)<(t[3]+e[3]-t[1]-e[1])/2}function Vs(t){t=t||{},this._bounds=[0,0,0,0],this._alternatives=[],this._passed=[],this._unpassed=[],t.debugger=Sf3d.debugCollisionDeteck||!1,!0===t.debugger&&(this._debugger=new Hs,this._debugger.enable())}function Hs(t){this._map3d=t||window.map3d}function Ys(t,e){return t.findIndex((function(t){return e===t||t.id===e.id}))}function Xs(t){Us.call(this),this.binder=t,this.dirty=!1}function Ws(){this._records=[],this._showIds={},this._hiddenIds={}}Us.prototype.priority=function(t){},Us.prototype.bounds=function(t){},Vs.prototype.setBounds=function(t){this._bounds=t},Vs.prototype.push=function(t){this._alternatives.push(t)},Vs.prototype.apply=function(t){var e=this,n=this._bounds,i=[];this._unpassed=[];var r=[[],[]];this._passed=this._alternatives.sort((function(e,n){return n.priority(t)-e.priority(t)})).filter((function(o){var s=o.bounds(t);return qs(n,s)?i.find((function(t){return qs(t,s)}))?(e._unpassed.push(o),r[1].push(s),!1):(i.push(s),r[0].push(s),!0):(e._unpassed.push(o),r[1].push(s),!1)})),this._alternatives.splice(0,this._alternatives.length),this._debugger&&this._debugger.update(r)},Vs.prototype.passed=function(){return this._passed},Vs.prototype.unpassed=function(){return this._unpassed},Vs.prototype.reset=function(){this._alternatives.splice(0,this._alternatives.length),this._unpassed.splice(0,this._unpassed.length),this._passed.splice(0,this._passed.length)},Vs.prototype.destroy=function(){this.reset(),this._debugger&&this._debugger.disable()},Hs.prototype.enable=function(){var t=this._map3d.viewer,e=document.createElement("canvas");this.canvas=e,e.width=t.canvas.width,e.height=t.canvas.height,e.style.position="absolute",e.style["pointer-events"]="none",document.body.appendChild(e)},Hs.prototype.disable=function(){this.canvas&&(this.canvas.remove(),this.canvas=null)},Hs.prototype.update=function(t){if(this.canvas){var e=this.canvas.getContext("2d");e.lineWidth=2,e.clearRect(0,0,this.canvas.width,this.canvas.height),e.strokeStyle="#00ff00",t[0].forEach((function(t){e.strokeRect(t[0],t[1],t[2]-t[0],t[3]-t[1])})),e.strokeStyle="#ff0000",t[1].forEach((function(t){e.strokeRect(t[0],t[1],t[2]-t[0],t[3]-t[1])}))}},Xs.prototype=new Us,Xs.prototype.priority=function(t){t.map3d;var e=t.camera,n=this.binder,i=n.billboard;if(n.billboards.isSelected(i.id))return Ro.a;var r=e.distanceToBoundingSphere(new Cesium.BoundingSphere(i.position,2))||1;return(this.binder.billboard.scale||1)/r},Xs.prototype.bounds=function(t){var e=t.map3d,n=t.camera,i=t.bounds,r=this.binder,o=r.billboards,s=r.billboard,a=s.computeScreenSpacePosition(e.viewer.scene);if(void 0===a)return this.dirty=!0,i;var l=Cesium.Billboard.getScreenSpaceBoundingBox(s,a);if(isNaN(l.x))return this.dirty=!0,i;this.dirty=!1;var u=n.distanceToBoundingSphere(new Cesium.BoundingSphere(s.position,2)),c=1,h=[(c=u<o.near?o.nearScale:u>o.far?1:o.nearScale+(o.farScale-o.nearScale)*(u-o.near)/(o.far-u))*l.width,c*l.height];return[a.x-h[0]/2,a.y-h[1]/2,a.x+h[0]/2,a.y+h[1]/2]},Xs.prototype.show=function(t){var e=this.binder,n=e.id,i=e.billboards;e.billboard;i.setVisible(!0,(function(t){return t.id===n}))},Xs.prototype.hide=function(t){var e=this.binder,n=e.id,i=e.billboards;e.billboard;i.setVisible(!1,(function(t){return t.id===n}))},Ws.prototype.recordShow=function(t){this._showIds[t]=!0,this._hiddenIds[t]=!1},Ws.prototype.recordHide=function(t){this._showIds[t]=!1,this._hiddenIds[t]=!0},Ws.prototype.isHidden=function(t){return this._hiddenIds[t]},u.a.BillboardsCDHelper=function(t){t=t||{};var e=this;this._map3d=t.map,this._collisionDeteck=new Vs,this._recorder=new Ws,this._billboardsList=[],this._wrapperCache={},this._updating=!1,this._dirtyTimer=null,this._onCameraChange=function(){try{e._requestUpdate()}catch(t){console.debug(t)}},this._excludeIds=[],Object.defineProperty(this,"excludeIds",{get:function(){return this._excludeIds},enumerable:!0})},u.a.BillboardsCDHelper.prototype.enable=function(){this._map3d.viewer.camera.changed.addEventListener(this._onCameraChange),this._requestUpdate()},u.a.BillboardsCDHelper.prototype.disable=function(){this._map3d.viewer.camera.changed.removeEventListener(this._onCameraChange),this._billboardsToWrappers().forEach((function(t){return t.show()}))},u.a.BillboardsCDHelper.prototype.bind=function(t){Ys(this._billboardsList,t)<0&&(this._billboardsList.push(t),this._requestUpdate())},u.a.BillboardsCDHelper.prototype.unbind=function(t){var e=Ys(this._billboardsList,t);e>=0&&(this._billboardsList.splice(e,1),this._requestUpdate())},u.a.BillboardsCDHelper.prototype.hasBind=function(t){return Ys(this._billboardsList,t)>=0},u.a.BillboardsCDHelper.prototype.reset=function(){this.billboardsList.splice(0,this.billboardsList.length),this._dirtyTimer&&(window.clearTimeout(this._dirtyTimer),this._dirtyTimer=null),this._update=!1,this._collisionDeteck.reset()},u.a.BillboardsCDHelper.prototype._requestUpdate=function(){var t=this;!1===this._updating&&(this._updating=!0,l.a.resolve().then((function(){t._update(),t._updating=!1})))},u.a.BillboardsCDHelper.prototype._billboardsToWrappers=function(t){return this._billboardsList.map((function(e){return(e.instance[0]._billboards||[]).filter(t||Boolean).map((function(t){return new Xs({id:t.id,groupId:e.id,billboards:e,billboard:t})}))})).flat()},u.a.BillboardsCDHelper.prototype._update=function(){var t=this,e=this._map3d.viewer.camera,n=e.frustum.computeCullingVolume(e.positionWC,e.directionWC,e.upWC),i=this._billboardsToWrappers((function(e){if(t._excludeIds.indexOf(e.id)>=0)return!1;var i=n.computeVisibility(new Cesium.BoundingSphere(e.position,10));return i===Cesium.Intersect.INSIDE||i===Cesium.Intersect.INTERSECTING}));i.forEach((function(e){return t._collisionDeteck.push(e)}));var r=[0,0,this._map3d.viewer.canvas.width,this._map3d.viewer.canvas.height];this._collisionDeteck.setBounds(r);var o={map3d:this._map3d,camera:e,bounds:r,recorder:this._recorder};this._collisionDeteck.apply(o),this._collisionDeteck.unpassed().forEach((function(t){return t.hide(o)})),this._collisionDeteck.passed().map((function(t){return t.show(o)})),this._collisionDeteck.reset(),i.findIndex((function(t){return t.dirty}))>=0&&(this._dirtyTimer&&(window.clearTimeout(this._dirtyTimer),this._dirtyTimer=null),this._dirtyTimer=setTimeout((function(){t._requestUpdate()}),1e3/60))},u.a.Polygons=function(t){t=t||{};var e=E.apply(void 0,arguments)||_sf3d;u.a.Element.call(this,t.id);var n=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,0,0,1)},texture:{name:"纹理",type:u.a.PropertyType.String,default:""},height:{name:"高度",type:u.a.PropertyType.Int,default:0,noConfig:!0},perPositionHeight:{name:"是否每个点使用自有高度",type:u.a.PropertyType.Boolean,default:!1,noConfig:!0},repeatX:{name:"纹理重复x",type:u.a.PropertyType.Int,default:1},repeatY:{name:"纹理重复y",type:u.a.PropertyType.Int,default:1},twinkling:{name:"是否闪烁",type:u.a.PropertyType.Boolean,default:!1},twinklingType:{name:"闪烁类型",type:u.a.PropertyType.Dictionary,options:[{key:"跳跃闪烁",value:1},{key:"渐变闪烁",value:2}],default:1},twinklingSpeed:{name:"闪烁速度",type:u.a.PropertyType.Float,default:1},twinklingLimit:{name:"闪烁次数",type:u.a.PropertyType.Float,default:-1},breathPower:{name:"呼吸强度",type:u.a.PropertyType.Float,default:.2},clampToGround:{name:"贴地",type:u.a.PropertyType.Boolean,default:!1,noConfig:!0},traces:{name:"轨迹",type:u.a.PropertyType.Array,default:Array.isArray(t.traces)?t.traces:[],noConfig:!0},classificationType:{name:"分类类型",type:u.a.PropertyType.Dictionary,options:[{key:"地形和3dtiles",value:Cesium.ClassificationType.BOTH},{key:"地形",value:Cesium.ClassificationType.TERRAIN},{key:"3dtiles",value:Cesium.ClassificationType.CESIUM_3D_TILE}],default:Cesium.ClassificationType.BOTH,noConfig:!0}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,n.instance.show=i},enumerable:!0});var r=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return r},set:function(t){t instanceof u.a.Color&&(r=t,n.instance.appearance.material.uniforms.color=r.color)},enumerable:!0});var o=t.texture?t.texture:this.config.texture.default;Object.defineProperty(this,"texture",{get:function(){return o},set:function(t){o=t,n.instance.appearance.material.uniforms.image=o},enumerable:!0});var s=isNaN(t.height)?0:t.height;Object.defineProperty(this,"height",{get:function(){return s},set:function(t){isNaN(t)||(s=t)},enumerable:!0});var a=!0===t.perPositionHeight;Object.defineProperty(this,"perPositionHeight",{get:function(){return a},set:function(t){a=!!t},enumerable:!0});var l=isNaN(t.repeatX)?this.config.repeatX.default:t.repeatX;Object.defineProperty(this,"repeatX",{get:function(){return l},set:function(t){isNaN(t)||(l=t,n.instance.appearance.material.uniforms.repeat.x=l)},enumerable:!0});var c=isNaN(t.repeatY)?this.config.repeatY.default:t.repeatY;Object.defineProperty(this,"repeatY",{get:function(){return c},set:function(t){isNaN(t)||(c=t,n.instance.appearance.material.uniforms.repeat.y=c)},enumerable:!0});var h=!0===t.twinkling;Object.defineProperty(this,"twinkling",{get:function(){return h},set:function(t){h!==!!t&&(h=!!t,n.instance.appearance.material.uniforms.startFrameNum=e.viewer.scene.frameState.frameNumber,n.instance.appearance.material.uniforms.twinkling=h?1:-1)},enumerable:!0});var p=isNaN(t.twinklingType)?this.config.twinklingType.default:t.twinklingType;Object.defineProperty(this,"twinklingType",{get:function(){return p},set:function(t){isNaN(t)||(p=t,n.instance.appearance.material.uniforms.twinklingType=p)},enumerable:!0});var f=isNaN(t.breathPower)?this.config.breathPower.default:t.breathPower;Object.defineProperty(this,"breathPower",{get:function(){return f},set:function(t){isNaN(t)||(f=t,n.instance.appearance.material.uniforms.breathPower=f)},enumerable:!0});var d=isNaN(t.twinklingSpeed)?this.config.twinklingSpeed.default:t.twinklingSpeed;Object.defineProperty(this,"twinklingSpeed",{get:function(){return d},set:function(t){isNaN(t)||(d=t,n.instance.appearance.material.uniforms.twinklingSpeed=d)},enumerable:!0});var g=isNaN(t.twinklingLimit)?this.config.twinklingLimit.default:t.twinklingLimit;Object.defineProperty(this,"twinklingLimit",{get:function(){return g},set:function(t){isNaN(t)||(g=t,n.instance.appearance.material.uniforms.startFrameNum=e.viewer.scene.frameState.frameNumber,n.instance.appearance.material.uniforms.twinklingLimit=g)},enumerable:!0});var y=!!t.clampToGround;Object.defineProperty(this,"clampToGround",{get:function(){return y},set:function(t){y=!!t},enumerable:!0});var m=isNaN(t.classificationType)?this.config.classificationType.default:t.classificationType;function _(){var t={fabric:{type:"ImageTwinkle",uniforms:{image:o||"",color:r.color,repeat:new Cesium.Cartesian2(l,c),twinkling:h?1:-1,twinklingType:p,twinklingSpeed:d,twinklingLimit:g,startFrameNum:e.viewer.scene.frameState.frameNumber,timestamp:Math.round(1e4*Math.random()),breathPower:f},source:"\n            float HALF_PI = 1.5707963267948966;\n            czm_material czm_getMaterial(czm_materialInput materialInput)\n            {\n                czm_material material = czm_getDefaultMaterial(materialInput);\n                vec2 st = materialInput.st;\n                float framePassed = czm_frameNumber - startFrameNum;\n                vec4 imageColor = texture2D(image, fract(repeat * st));\n                material.diffuse = imageColor.rgb * color.rgb;\n                material.alpha = imageColor.a * color.a;\n                if (twinkling > 0.0) {\n                    if (twinklingType == 1.0) {// 跳跃闪烁\n                        float duration = 10.0;\n                        if (twinklingLimit < 0.0 \n                            || (twinklingLimit > 0.0 && framePassed < (twinklingLimit + 1.0)*duration/twinklingSpeed)) {\n                            float ratio = step(duration/2.0, mod(czm_frameNumber * twinklingSpeed + timestamp, duration));\n                            material.alpha = material.alpha * ratio;\n                            material.emission = ratio*vec3(breathPower);\n                        }\n                    } else if(twinklingType == 2.0) {\n                        float duration = 100.0;\n                        if (twinklingLimit < 0.0 \n                            || (twinklingLimit > 0.0 && framePassed < (twinklingLimit + 1.0)*duration/twinklingSpeed)) {\n                            float value = mod((czm_frameNumber * twinklingSpeed + timestamp)/duration, 1.0)/0.5;\n                            float ratio = 1.0;\n                            if (value < 1.0) {\n                                ratio= 1.0 - sin(value* HALF_PI);\n                            } else {\n                                ratio= sin(mod(value, 1.0)* HALF_PI);\n                            }\n                            material.alpha = material.alpha * clamp(ratio, 0.7, 1.0);\n                            material.emission = breathPower*vec3(smoothstep(0.0, 1.0, ratio));\n                        }\n                    }\n                }\n                return material;\n            }\n            "}};return new Cesium.Material(t)}if(Object.defineProperty(this,"classificationType",{get:function(){return m},set:function(t){isNaN(t)||(m=t,this.instance.classificationType=m)},enumerable:!0}),this.config.traces.default){var v=[];this.config.traces.default.forEach((function(t){if(t instanceof u.a.Point3dCollection){var e=[];Array.isArray(t.holes)&&t.holes.forEach((function(t){var n=a?t.exportCartesianArray():t.exportCartesianArrayWithoutHeight();e.push(new Cesium.PolygonHierarchy(n))}));var n=a?t.exportCartesianArray():t.exportCartesianArrayWithoutHeight();v.push(new Cesium.GeometryInstance({id:t.id,geometry:new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(n,e),vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,height:a?0:s,perPositionHeight:a})}))}}));var x=_();y?(this.instance=new Cesium.GroundPrimitive({show:i,geometryInstances:v,appearance:new Cesium.EllipsoidSurfaceAppearance({}),classificationType:isNaN(t.classificationType)?Cesium.ClassificationType.BOTH:t.classificationType}),this.instance.appearance.material=x,_cesium.scene.groundPrimitives.add(this.instance)):(this.instance=new Cesium.Primitive({show:i,geometryInstances:v,appearance:new Cesium.MaterialAppearance({MaterialSupport:Cesium.MaterialAppearance.MaterialSupport.ALL,flat:!0})}),this.instance.appearance.material=x,_cesium.scene.primitives.add(this.instance))}},u.a.Polygons.prototype=new u.a.Element,u.a.Polygons.prototype.type="Polygons";u.a.Polygons;u.a.FlashWall=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},speed:{name:"速度",type:u.a.PropertyType.Float,default:1},wallHeight:{name:"高度",type:u.a.PropertyType.Float,default:1e4},texture:{name:"纹理",type:u.a.PropertyType.String,default:""},trace:{name:"轨迹",type:u.a.PropertyType.Trace,default:t.trace instanceof u.a.Point3dCollection?t.trace:new u.a.Point3dCollection,noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return i},set:function(t){if(t instanceof u.a.Color){i=t,(a=document.createElement("canvas")).width=20,a.height=20;var n=a.getContext("2d"),r=n.createLinearGradient(0,20,0,0),o=i.export255Array();r.addColorStop(0,"rgba("+o[0]+","+o[1]+","+o[2]+",1)"),r.addColorStop(1,"rgba("+o[0]+","+o[1]+","+o[2]+",0)"),n.fillStyle=r,n.fillRect(0,0,20,20),e.instance.wall.material.image=s||a}},enumerable:!0});var r=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return r},set:function(t){isNaN(t)||(r=t)},enumerable:!0});var o=isNaN(t.wallHeight)?this.config.wallHeight.default:t.wallHeight;Object.defineProperty(this,"wallHeight",{get:function(){return o},set:function(t){isNaN(t)||(o=t,f=[],p.forEach((function(t){f.push(t+o)})),e.instance.wall.maximumHeights=f)},enumerable:!0});var s=t.texture?t.texture:this.config.texture.default;if(Object.defineProperty(this,"texture",{get:function(){return s},set:function(t){s=t,e.instance.wall.material.image=s||a},enumerable:!0}),this.config.trace.default){var a=document.createElement("canvas");a.width=20,a.height=20;var l=a.getContext("2d"),c=l.createLinearGradient(0,20,0,0),h=i.export255Array();c.addColorStop(0,"rgba("+h[0]+","+h[1]+","+h[2]+",1)"),c.addColorStop(1,"rgba("+h[0]+","+h[1]+","+h[2]+",0)"),l.fillStyle=c,l.fillRect(0,0,20,20);var p=[];this.config.trace.default.points.forEach((function(t){p.push(t.exportLngLatHeightArray()[2])}));var f=[];p.forEach((function(t){f.push(t+o)})),this.instance=_cesium.entities.add({show:n,id:this.config.trace.default.id,wall:{positions:Cesium.Cartesian3.fromDegreesArray(this.config.trace.default.exportLngLatArray()),maximumHeights:f,minimumHeights:p,material:new Cesium.ImageMaterialProperty({image:s||a})}}),this.instance.wall.material.color=new Cesium.CallbackProperty((function(t,e){var n=.5*Math.abs(Math.sin((new Date).getTime()/500*r))+.1;return i.color.withAlpha(n)}),!1)}},u.a.FlashWall.prototype=new u.a.Element,u.a.FlashWall.prototype.type="FlashWall";u.a.FlashWall;u.a.CylinderImage=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d(0,0,0),noConfig:!0},texture:{name:"纹理",type:u.a.PropertyType.Url,default:u.a.RelativePath+"assets/cylinderimage.png"},imageWidth:{name:"图片宽度",type:u.a.PropertyType.Int,default:512,range:[0,1024]},imageHeight:{name:"图片高度",type:u.a.PropertyType.Int,default:256,range:[0,1024]},radius:{name:"半径",type:u.a.PropertyType.Float,default:10},segments:{name:"分段",type:u.a.PropertyType.Int,default:30},speed:{name:"速度",type:u.a.PropertyType.Float,default:1},cw:{name:"顺时针",type:u.a.PropertyType.Boolean,default:!1}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return i},set:function(t){t instanceof u.a.Point3d&&(i=t,e.instance.position=i.exportRadianHeightArray())},enumerable:!0});var r=t.texture||this.config.texture.default;Object.defineProperty(this,"texture",{get:function(){return r},set:function(t){t&&(r=t,e.instance.evalString="\n                Cesium.Resource.createIfNeeded('"+r+"').fetchImage().then(function(image) {\n                    p.canvasWidth = "+o+";\n                    p.canvasHeight = "+s+";\n  \n                    p.drawCanvas(ctx => {\n                        ctx.clearRect(0, 0, p.canvasWidth,p.canvasHeight);\n                        ctx.drawImage(image, 0, 0);\n                    });\n                });\n            ")},enumerable:!0});var o=isNaN(t.imageWidth)?this.config.imageWidth.default:t.imageWidth;Object.defineProperty(this,"imageWidth",{get:function(){return o},set:function(t){isNaN(t)||(o=t,f=XE.Obj.CustomPrimitive.Geometry.createCylinder(a,a,2*Math.PI*a*s/o,l),e.instance.positions=f.positions,e.instance.sts=f.sts,e.instance.indices=f.indices,e.instance.evalString="\n                Cesium.Resource.createIfNeeded('"+r+"').fetchImage().then(function(image) {\n                    p.canvasWidth = "+o+";\n                    p.canvasHeight = "+s+";\n  \n                    p.drawCanvas(ctx => {\n                        ctx.clearRect(0, 0, p.canvasWidth,p.canvasHeight);\n                        ctx.drawImage(image, 0, 0);\n                    });\n                });\n            ")},enumerable:!0});var s=isNaN(t.imageHeight)?this.config.imageHeight.default:t.imageHeight;Object.defineProperty(this,"imageHeight",{get:function(){return s},set:function(t){isNaN(t)||(s=t,f=XE.Obj.CustomPrimitive.Geometry.createCylinder(a,a,2*Math.PI*a*s/o,l),e.instance.positions=f.positions,e.instance.sts=f.sts,e.instance.indices=f.indices,e.instance.evalString="\n                Cesium.Resource.createIfNeeded('"+r+"').fetchImage().then(function(image) {\n                    p.canvasWidth = "+o+";\n                    p.canvasHeight = "+s+";\n  \n                    p.drawCanvas(ctx => {\n                        ctx.clearRect(0, 0, p.canvasWidth,p.canvasHeight);\n                        ctx.drawImage(image, 0, 0);\n                    });\n                });\n            ")},enumerable:!0});var a=isNaN(t.radius)?this.config.radius.default:t.radius;Object.defineProperty(this,"radius",{get:function(){return a},set:function(t){isNaN(t)||(a=t,f=XE.Obj.CustomPrimitive.Geometry.createCylinder(a,a,2*Math.PI*a*s/o,l),e.instance.positions=f.positions,e.instance.sts=f.sts,e.instance.indices=f.indices)},enumerable:!0});var l=isNaN(t.segments)?this.config.segments.default:t.segments;Object.defineProperty(this,"segments",{get:function(){return l},set:function(t){isNaN(t)||(l=t,f=XE.Obj.CustomPrimitive.Geometry.createCylinder(a,a,2*Math.PI*a*s/o,l),e.instance.positions=f.positions,e.instance.sts=f.sts,e.instance.indices=f.indices)},enumerable:!0});var c=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return c},set:function(t){isNaN(t)||(c=t,e.instance.preUpdateEvalString="\n                if (typeof p.dAngle === 'undefined') p.dAngle = 360.0;\n                if("+h+"){\n                  p.dAngle += "+c+";\n                  if (p.dAngle > 360.0) {\n                      p.dAngle = 0.0;\n                  }\n                }else{\n                  p.dAngle -= "+c+";\n                  if (p.dAngle < 0.0) {\n                      p.dAngle = 360.0;\n                  }\n                }\n                p.rotation[0] = p.dAngle / 180.0 * Math.PI;\n            ")},enumerable:!0});var h=!!t.cw;Object.defineProperty(this,"cw",{get:function(){return h},set:function(t){h=!!t,e.instance.preUpdateEvalString="\n            if (typeof p.dAngle === 'undefined') p.dAngle = 360.0;\n            if("+h+"){\n              p.dAngle += "+c+";\n              if (p.dAngle > 360.0) {\n                  p.dAngle = 0.0;\n              }\n            }else{\n              p.dAngle -= "+c+";\n              if (p.dAngle < 0.0) {\n                  p.dAngle = 360.0;\n              }\n            }\n            p.rotation[0] = p.dAngle / 180.0 * Math.PI;\n        "},enumerable:!0});var p=XE.Obj.CustomPrimitive.getRenderState(!0,!0);p.cull.enabled=!1;var f=XE.Obj.CustomPrimitive.Geometry.createCylinder(a,a,2*Math.PI*a*s/o,l),d="\n              Cesium.Resource.createIfNeeded('"+r+"').fetchImage().then(function(image) {\n                  p.canvasWidth = "+o+";\n                  p.canvasHeight = "+s+";\n\n                  p.drawCanvas(ctx => {\n                      ctx.clearRect(0, 0, p.canvasWidth,p.canvasHeight);\n                      ctx.drawImage(image, 0, 0);\n                  });\n              });\n          ",g="\n              if (typeof p.dAngle === 'undefined') p.dAngle = 360.0;\n              if("+h+"){\n                p.dAngle += "+c+";\n                if (p.dAngle > 360.0) {\n                    p.dAngle = 0.0;\n                }\n              }else{\n                p.dAngle -= "+c+";\n                if (p.dAngle < 0.0) {\n                    p.dAngle = 360.0;\n                }\n              }\n              p.rotation[0] = p.dAngle / 180.0 * Math.PI;\n          ";this.instance=new XE.Obj.CustomPrimitive(I.apply(void 0,arguments)||_earthsdk),this.instance.xbsjFromJSON({xbsjGuid:i.id,evalString:d,preUpdateEvalString:g,position:i.exportRadianHeightArray(),positions:f.positions,sts:f.sts,indices:f.indices,renderState:p})},u.a.CylinderImage.prototype=new u.a.Element,u.a.CylinderImage.prototype.type="CylinderImage";u.a.CylinderImage;u.a.DigPolygon=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},wallTexture:{name:"墙壁纹理",type:u.a.PropertyType.Url,default:u.a.RelativePath+"assets/dig-wall.jpg"},bottomTexture:{name:"底面纹理",type:u.a.PropertyType.Url,default:u.a.RelativePath+"assets/dig-bottom.jpg"},wallTextureHeight:{name:"墙壁纹理高度",type:u.a.PropertyType.Float,default:10},bottomTextureHeight:{name:"底面纹理高度",type:u.a.PropertyType.Float,default:10},depth:{name:"开挖深度",type:u.a.PropertyType.Float,default:-20},trace:{name:"轨迹",type:u.a.PropertyType.Trace,default:t.trace instanceof u.a.Point3dCollection?t.trace:new u.a.Point3dCollection,noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.wallTexture||this.config.wallTexture.default;Object.defineProperty(this,"wallTexture",{get:function(){return i},set:function(t){i=t,e.instance.wallImageUrl=i},enumerable:!0});var r=t.bottomTexture||this.config.bottomTexture.default;Object.defineProperty(this,"bottomTexture",{get:function(){return r},set:function(t){r=t,e.instance.bottomImageUrl=r},enumerable:!0});var o=isNaN(t.wallTextureHeight)?this.config.wallTextureHeight.default:t.wallTextureHeight;Object.defineProperty(this,"wallTextureHeight",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.wallImageHeight=o)},enumerable:!0});var s=isNaN(t.bottomTextureHeight)?this.config.bottomTextureHeight.default:t.bottomTextureHeight;Object.defineProperty(this,"bottomTextureHeight",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.bottomImageHeight=s)},enumerable:!0});var a=isNaN(t.depth)?this.config.depth.default:t.depth;if(Object.defineProperty(this,"depth",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.height=a)},enumerable:!0}),this.config.trace.default){var l=I.apply(void 0,arguments)||_earthsdk;l.terrainEffect.depthTest=!0,this.instance=new XE.Obj.CutSurface(l),this.instance.xbsjFromJSON({xbsjType:"CutSurface",positions:this.config.trace.default.exportRadianArray(),sampledDistance:10,wallImageHeight:o,bottomImageHeight:s,bottomImageWidthScale:1,wallImageWidthScale:1,wallImageUrl:i,bottomImageUrl:r,height:a,show:n}),this.instance.applyTerrain()}},u.a.DigPolygon.prototype=new u.a.Element,u.a.DigPolygon.prototype.type="DigPolygon",u.a.DigPolygon.prototype.destroy=function(){this.instance.creating=!0,this.instance.applyTerrain(),this.instance.destroy()};u.a.DigPolygon;u.a.FlattenPolygon=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},height:{name:"高度",type:u.a.PropertyType.Float,default:0},showHelper:{name:"边框",type:u.a.PropertyType.Boolean,default:!0},traces:{name:"轨迹",type:u.a.PropertyType.Traces,default:Array.isArray(t.traces)?t.traces:[],noConfig:!0},target:{name:"待压平物体",type:u.a.TilesetModel,default:null,noConfig:!0},gltfTargets:{name:"待压平单体模型",type:Array,default:[],noConfig:!0},polygonFillColor:{name:"压平面填充色",type:u.a.PropertyType.Color,default:new u.a.Color(1,1,0,1)},polygonLineColor:{name:"压平面边线颜色",type:u.a.PropertyType.Color,default:new u.a.Color(0,.5,0,1)}};var n=!1!==t.enabled;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.enabled=n},enumerable:!0});var i=t.target?t.target:this.config.target.default;Object.defineProperty(this,"target",{get:function(){return i},set:function(t){(i=t)&&i.setFlattenId(this.instance.xbsjGuid)},enumerable:!0});var r=t.gltfTargets?t.gltfTargets:this.config.gltfTargets.default;this.gltfTargets=new Proxy(r,{get:function(t,e){return t[e]},set:function(t,e,n,i){return t[e]=n,"length"!==e&&c(),!0}});var o=isNaN(t.height)?this.config.height.default:t.height;Object.defineProperty(this,"height",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.polygons.forEach((function(t){t.height=o})),p())},enumerable:!0});var s=!1!==t.showHelper;Object.defineProperty(this,"showHelper",{get:function(){return s},set:function(t){s=!!t,e.instance.polygons.forEach((function(t){t.showHelper=s}))},enumerable:!0});var a=t.polygonFillColor instanceof u.a.Color?t.polygonFillColor:this.config.polygonFillColor.default;Object.defineProperty(this,"polygonFillColor",{get:function(){return a},set:function(t){a=t,e.instance.polygons.forEach((function(t){t._polygon.color=a.exportArray()}))},enumerable:!0});var l=t.polygonLineColor instanceof u.a.Color?t.polygonLineColor:this.config.polygonLineColor.default;function c(){if(r.length>0){var t=e.config.traces.default.map((function(t){var e=t.exportLngLatArray().map((function(t,e,n){if(e%2==0)return[t,n[e+1]]})).filter(Boolean);return e[0].join(",")!=e[e.length-1].join(",")&&e.push([].concat(h()(e[0]))),pt.polygon([e])}));r.forEach((function(n){var i=n.instance._primitive.boundingSphere.radius/(Math.PI*Cesium.Ellipsoid.WGS84.radii.x/180),r=n.position.exportLngLatArray(),o=pt.polygon([[[r[0]-i,r[1]-i],[r[0]+i,r[1]-i],[r[0]+i,r[1]+i],[r[0]-i,r[1]+i],[r[0]-i,r[1]-i]]]);t.find((function(t){return pt.booleanOverlap(t,o)}))&&(n.flat(),e._flatModels.push(n),e._flatModelHeights[n.id]||(e._flatModelHeights[n.id]=n.position.height))})),p()}}function p(){e._flatModels.forEach((function(t){return t.position=(new u.a.Point3d).fromLngLat(t.position.lng,t.position.lat,o)}))}if(Object.defineProperty(this,"polygonLineColor",{get:function(){return l},set:function(t){l=t,e.instance.polygons.forEach((function(t){t._polygon.outline.color=l.exportArray()}))},enumerable:!0}),this._flatModels=[],this._flatModelHeights={},this.config.traces.default){var f={xbsjType:"FlattenedPolygonCollection",polygons:[],enabled:n};this.config.traces.default.forEach((function(t){t instanceof u.a.Point3dCollection&&f.polygons.push({positions:t.exportRadianArray(),height:o,showHelper:s})})),this.instance=new XE.Obj.FlattenedPolygonCollection(I.apply(void 0,arguments)||_earthsdk),i&&i.setFlattenId(this.instance.xbsjGuid),this.instance.xbsjFromJSON(f),this.instance.polygons&&(this.instance.polygons,this.instance.polygons.forEach((function(t){t._polygon.color=a.exportArray(),t._polygon.outline.color=l.exportArray()}))),c()}},u.a.FlattenPolygon.prototype=new u.a.Element,u.a.FlattenPolygon.prototype.type="FlattenPolygon",u.a.FlattenPolygon.prototype.destroy=function(){var t=this;this.showHelper=!1,this.gltfTargets.forEach((function(e){e.unflat(),t._flatModelHeights.hasOwnProperty(e.id)&&(e.position=(new u.a.Point3d).fromLngLat(e.position.lng,e.position.lat,t._flatModelHeights.hasOwnProperty[e.id]))})),this.gltfTargets=[],this._flatModels=[],this._flatModelHeights={},u.a.Element.prototype.destroy.call(this)};u.a.FlattenPolygon;u.a.FloatingPyramid=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},floatingRange:{name:"浮动范围",type:u.a.PropertyType.Float,default:20},scale:{name:"缩放比例",type:u.a.PropertyType.Float,default:1},scaleHeight:{name:"高度缩放比例",type:u.a.PropertyType.Float,default:1},floatingSpeed:{name:"浮动速度",type:u.a.PropertyType.Float,default:1},rotateSpeed:{name:"旋转速度",type:u.a.PropertyType.Float,default:1},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return i},set:function(t){t instanceof u.a.Color&&(i=t,e.instance.color=i.exportArray())},enumerable:!0});var o=isNaN(t.floatingRange)?this.config.floatingRange.default:t.floatingRange;Object.defineProperty(this,"floatingRange",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.preUpdateEvalString=p())},enumerable:!0});var s=isNaN(t.scale)?this.config.scale.default:t.scale;Object.defineProperty(this,"scale",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.scale=[s,s,a])},enumerable:!0});var a=isNaN(t.scaleHeight)?this.config.scaleHeight.default:t.scaleHeight;Object.defineProperty(this,"scaleHeight",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.scale=[s,s,a])},enumerable:!0});var l=isNaN(t.floatingSpeed)?this.config.floatingSpeed.default:t.floatingSpeed;Object.defineProperty(this,"floatingSpeed",{get:function(){return l},set:function(t){isNaN(t)||(l=t,e.instance.preUpdateEvalString=p())},enumerable:!0});var c=isNaN(t.rotateSpeed)?this.config.rotateSpeed.default:t.rotateSpeed;Object.defineProperty(this,"rotateSpeed",{get:function(){return c},set:function(t){isNaN(t)||(c=t,e.instance.preUpdateEvalString=p())},enumerable:!0});var h=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return h},set:function(t){t instanceof u.a.Point3d&&(h=t,e.instance.position=h.exportRadianHeightArray(),e.instance.preUpdateEvalString=p())},enumerable:!0});var p=function(){return"\n                if (typeof p.dAngle === 'undefined') p.dAngle = 0.0;\n                p.dAngle += 10.0*"+c+";\n                if (p.dAngle > 360.0) {\n                    p.dAngle = 0.0;\n                }\n                p.rotation[0] = p.dAngle / 180.0 * Math.PI;\n    \n                if (typeof p.dt === 'undefined') p.dt = 0.0;\n                p.dt += 0.01*"+l+";\n                if (p.dt > 1.0) p.dt = 0.0;\n                p.position[2] = "+h.exportRadianHeightArray()[2]+" + "+o+" * Math.sin(p.dt*Math.PI*2.0);"},f="\n    if (typeof p.dAngle === 'undefined') p.dAngle = 0.0;\n    p.dAngle += 10.0*"+c+";\n    if (p.dAngle > 360.0) {\n        p.dAngle = 0.0;\n    }\n    p.rotation[0] = p.dAngle / 180.0 * Math.PI;\n\n    if (typeof p.dt === 'undefined') p.dt = 0.0;\n    p.dt += 0.01*"+l+";\n    if (p.dt > 1.0) p.dt = 0.0;\n    p.position[2] = "+h.exportRadianHeightArray()[2]+" + "+o+" * Math.sin(p.dt*Math.PI*2.0);",d={preUpdateEvalString:f,position:h.exportRadianHeightArray(),scale:[s,s,a],positions:[1,0,1.5,0,1,1.5,-1,0,1.5,0,-1,1.5,0,0,0],indices:[0,1,1,2,2,3,3,0,0,4,1,4,2,4,3,4],renderState:XE.Obj.CustomPrimitive.getRenderState(!0,!0),xbsjGuid:h.id},g=r()({},d,{indices:[0,1,4,1,2,4,2,3,4,3,0,4],color:i.exportArray()});this.instance=new XE.Obj.CustomPrimitive(I.apply(void 0,arguments)||_earthsdk),this.instance.xbsjFromJSON(g)},u.a.FloatingPyramid.prototype=new u.a.Element,u.a.FloatingPyramid.prototype.type="FloatingPyramid";u.a.FloatingPyramid;u.a.FrustumModel=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},near:{name:"近平面",type:u.a.PropertyType.Float,default:.1,range:[0,100]},far:{name:"远平面",type:u.a.PropertyType.Float,default:50},fov:{name:"FOV",type:u.a.PropertyType.Float,default:Math.PI/3,range:[0,180]},heading:{name:"航向角",type:u.a.PropertyType.Float,default:0,range:[-180,180]},pitch:{name:"俯仰角",type:u.a.PropertyType.Float,default:0,range:[-90,90]},roll:{name:"翻滚角度",type:u.a.PropertyType.Float,default:0,range:[-180,180]},aspect:{name:"宽高比",type:u.a.PropertyType.Float,default:1.3}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return i},set:function(t){t instanceof u.a.Point3d&&(i=t,e.instance._camera.position=i.exportCartesian())},enumerable:!0});var r=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return r},set:function(t){t instanceof u.a.Color&&(r=t,e.instance._color=r.color)},enumerable:!0});var o=isNaN(t.near)?this.config.near.default:t.near;Object.defineProperty(this,"near",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance._camera.frustum.near=o)},enumerable:!0});var s=isNaN(t.far)?this.config.far.default:t.far;Object.defineProperty(this,"far",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance._camera.frustum.far=s)},enumerable:!0});var a=isNaN(t.fov)?this.config.fov.default:t.fov;Object.defineProperty(this,"fov",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance._camera.frustum.fov=Cesium.Math.toRadians(a))},enumerable:!0});var l=isNaN(t.heading)?this.config.heading.default:t.heading;Object.defineProperty(this,"heading",{get:function(){return l},set:function(t){isNaN(t)||(l=Cesium.Math.toRadians(t),e.instance._camera.setView({orientation:{heading:l,pitch:c,roll:h}}))},enumerable:!0});var c=isNaN(t.pitch)?this.config.pitch.default:t.pitch;Object.defineProperty(this,"pitch",{get:function(){return c},set:function(t){isNaN(t)||(c=Cesium.Math.toRadians(t),e.instance._camera.setView({orientation:{heading:l,pitch:c,roll:h}}))},enumerable:!0});var h=isNaN(t.roll)?this.config.roll.default:t.roll;Object.defineProperty(this,"roll",{get:function(){return h},set:function(t){isNaN(t)||(h=Cesium.Math.toRadians(t),e.instance._camera.setView({orientation:{heading:l,pitch:c,roll:h}}))},enumerable:!0});var p=isNaN(t.aspect)?this.config.aspect.default:t.aspect;Object.defineProperty(this,"aspect",{get:function(){return p},set:function(t){isNaN(t)||(p=t,e.instance._camera.frustum.aspectRatio=p)},enumerable:!0});var f=new Cesium.Camera(_cesium.scene);f.position=i.exportCartesian(),f.direction=Cesium.Cartesian3.negate(Cesium.Cartesian3.UNIT_Z,new Cesium.Cartesian3),f.up=Cesium.Cartesian3.clone(Cesium.Cartesian3.UNIT_Y),f.frustum.fov=a,f.frustum.near=o,f.frustum.far=s,this.instance=new Cesium.DebugCameraPrimitive({id:i.id,camera:f,show:n,color:r.color}),_cesium.scene.primitives.add(this.instance)},u.a.FrustumModel.prototype=new u.a.Element,u.a.FrustumModel.prototype.type="FrustumModel";u.a.FrustumModel;function Ks(t,e,n,i,r){return t.entities.add({name:e,polyline:{positions:[n,i],width:20,arcType:Cesium.ArcType.NONE,material:new Cesium.PolylineArrowMaterialProperty(r)}})}function Zs(t,e){t.__debugAxisEntities&&(t.__debugAxisEntities.forEach((function(t){return e.entities.remove(t)})),t.__debugAxisEntities=null)}function Js(t,e){Zs(t,e);var n=t.primitive,i=n.boundingSphere,r=(new Sf3d.Point3d).fromLngLatHeightArray(t.position.lng,t.position.lat,t.position.height+i.radius/2).exportCartesian(),o=Qs(n),s=2*i.radius,a=Cesium.Cartesian3.add(r,Cesium.Cartesian3.multiplyByScalar(o.X,s,new Cesium.Cartesian3),new Cesium.Cartesian3),l=Cesium.Cartesian3.add(r,Cesium.Cartesian3.multiplyByScalar(o.Y,s,new Cesium.Cartesian3),new Cesium.Cartesian3),u=Cesium.Cartesian3.add(r,Cesium.Cartesian3.multiplyByScalar(o.Z,s,new Cesium.Cartesian3),new Cesium.Cartesian3),c=[Ks(e,"X",r,a,Cesium.Color.RED),Ks(e,"Y",r,l,Cesium.Color.GREEN),Ks(e,"Z",r,u,Cesium.Color.BLUE)];t.__debugAxisEntities=c}function Qs(t){var e={X:new Cesium.Cartesian3,Y:new Cesium.Cartesian3,Z:new Cesium.Cartesian3,UP:new Cesium.Cartesian3,FORWARD:new Cesium.Cartesian3},n=Cesium.Cartesian3.ZERO,i=Cesium.Cartesian3.UNIT_X,r=Cesium.Cartesian3.UNIT_Y,o=Cesium.Cartesian3.UNIT_Z,s=Cesium.Matrix4.multiplyByPoint(t.modelMatrix,n,new Cesium.Cartesian3);e.X=Cesium.Cartesian3.normalize(Cesium.Cartesian3.subtract(Cesium.Matrix4.multiplyByPoint(t.modelMatrix,i,new Cesium.Cartesian3),s,new Cesium.Cartesian3),new Cesium.Cartesian3),e.Y=Cesium.Cartesian3.normalize(Cesium.Cartesian3.subtract(Cesium.Matrix4.multiplyByPoint(t.modelMatrix,r,new Cesium.Cartesian3),s,new Cesium.Cartesian3),new Cesium.Cartesian3),e.Z=Cesium.Cartesian3.normalize(Cesium.Cartesian3.subtract(Cesium.Matrix4.multiplyByPoint(t.modelMatrix,o,new Cesium.Cartesian3),s,new Cesium.Cartesian3),new Cesium.Cartesian3);var a={};return a[Cesium.Axis.X]="X",a[Cesium.Axis.Y]="Y",a[Cesium.Axis.Z]="Z",e.UP=e[a[t.upAxis]],e.FORWARD=e[a[t.forwardAxis]],e}function $s(t,e){var n=Cesium.Cartesian3.fromDegrees(t.lng,t.lat);return Cesium.Matrix4.multiplyByPoint(e,n,new Cesium.Cartesian3(0,0,0))}function ta(t){return"void main() {\n        a_position1.x = "+("x"===t?"0.0":"a_position.x")+";\n        a_position1.y = "+("y"===t?"0.0":"a_position.y")+";\n        a_position1.z = "+("z"===t?"0.0":"a_position.z")+";\n        gltf_flat_main();\n    } "}function ea(t){try{var e=t.gltf;if("Z_UP"===(e.nodes[e.scenes[e.scene].nodes[0]].name+"").toUpperCase())return"z"}catch(t){}return"y"}function na(t){return t.gltf.animations||[]}u.a.GltfModel=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this,n=E.apply(void 0,arguments)||_sf3d;e.viewer=n.viewer,this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},url:{name:"路径",type:u.a.PropertyType.Url,default:null},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},heading:{name:"航向角",type:u.a.PropertyType.Float,default:0},pitch:{name:"俯仰角",type:u.a.PropertyType.Float,default:0},roll:{name:"翻滚角",type:u.a.PropertyType.Float,default:0},rotationEdit:{name:"角度编辑",type:u.a.PropertyType.Boolean,default:!1},positionEdit:{name:"位置编辑",type:u.a.PropertyType.Boolean,default:!1},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},scale:{name:"缩放",type:u.a.PropertyType.Float,default:1},allowPicking:{name:"是否允许拾取",type:u.a.PropertyType.Boolean,default:!1!==t.allowPicking,noConfig:!0},debugShowModelAxis:{name:"是否显示模型本地坐标系",type:u.a.PropertyType.Boolean,default:!1}},Object.defineProperty(this,"primitive",{get:function(){return this.instance?this.instance._primitive:null}});var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,e.instance.show=i},enumerable:!0});var r=t.url||this.config.url.default;Object.defineProperty(this,"url",{get:function(){return r},set:function(t){t&&(r=t,e.instance.url=r)},enumerable:!0});var o=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return o},set:function(t){t instanceof u.a.Point3d&&(o=t,e.instance.xbsjPosition=o.exportRadianHeightArray(),!0===e.debugShowModelAxis&&Js(e,e.viewer))},enumerable:!0});var s=Cesium.Math.toRadians(isNaN(t.heading)?this.config.heading.default:t.heading);Object.defineProperty(this,"heading",{get:function(){return Cesium.Math.toDegrees(s)},set:function(t){isNaN(t)||(s=Cesium.Math.toRadians(t),e.instance.xbsjRotation[0]=s,!0===e.debugShowModelAxis&&Js(e,e.viewer))},enumerable:!0});var a=Cesium.Math.toRadians(isNaN(t.pitch)?this.config.pitch.default:t.pitch);Object.defineProperty(this,"pitch",{get:function(){return Cesium.Math.toDegrees(a)},set:function(t){isNaN(t)||(a=Cesium.Math.toRadians(t),e.instance.xbsjRotation[1]=a)},enumerable:!0});var l=Cesium.Math.toRadians(isNaN(t.roll)?this.config.roll.default:t.roll);Object.defineProperty(this,"roll",{get:function(){return Cesium.Math.toDegrees(l)},set:function(t){isNaN(t)||(l=Cesium.Math.toRadians(t),e.instance.xbsjRotation[2]=l)},enumerable:!0});var c=!!t.rotationEdit;Object.defineProperty(this,"rotationEdit",{get:function(){return c},set:function(t){c=!!t,e.instance.rotationEditing=c},enumerable:!0});var h=!!t.positionEdit;Object.defineProperty(this,"positionEdit",{get:function(){return h},set:function(t){h=!!t,e.instance.positionEditing=h},enumerable:!0});var p=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return p},set:function(t){t instanceof u.a.Color&&(p=t,e.instance.color=p.exportArray())},enumerable:!0});var f=isNaN(t.scale)?this.config.scale.default:t.scale;Object.defineProperty(this,"scale",{get:function(){return f},set:function(t){isNaN(t)||(f=t,e.instance.scale=f)},enumerable:!0});var d=!!t.debugShowModelAxis;Object.defineProperty(this,"debugShowModelAxis",{get:function(){return d},set:function(t){d!==t&&(!0===(d=!!t)?Js(e,e.viewer):Zs(e,e.viewer))},enumerable:!0});var g=!1!==t.incrementallyLoadTextures,y=void 0===t.heightReference?Cesium.HeightReference.NONE:t.heightReference;this.instance=new XE.Obj.Model(I.apply(void 0,arguments)||_earthsdk);var m=Cesium.Transforms.headingPitchRollToFixedFrame(o.exportCartesian(),new Cesium.HeadingPitchRoll(0,0,0));this.instance.xbsjFromJSON({xbsjType:"Model",xbsjGuid:o.id,url:r,scale:f,color:p.exportArray(),xbsjPosition:o.exportRadianHeightArray(),xbsjRotation:[0,0,0],rotationEditing:!1,positionEditing:!1,allowPicking:this.config.allowPicking.default,incrementallyLoadTextures:g}),this.instance._primitive.modelMatrix=m,this.instance.xbsjGuid=this.id,this.instance._primitive.guid=this.id,Cesium.when(this.instance._primitive.readyPromise).then((function(){if(e.instance.xbsjRotation[0]=s,e.instance.xbsjRotation[1]=a,e.instance.xbsjRotation[2]=l,e.instance.show=i,e.instance.rotationEdit=c,e.instance.positionEdit=h,e.instance.scale=f,e.instance._primitive.heightReference=y,"function"==typeof t.complete)try{t.complete()}catch(t){console.error(t)}!0===d&&Js(e,e.viewer)})).otherwise((function(){"function"==typeof t.error&&t.error()}))},u.a.GltfModel.prototype=new u.a.Element,u.a.GltfModel.prototype.type="GltfModel",u.a.GltfModel.prototype.focus=function(t){try{t=t||{};var e={boundingSphere:this.instance._primitive._nodeCommands[0].command._boundingVolume};r()(e,t),_sf3d.camera.focusOnSphere(e)}catch(t){console.error(t)}},u.a.GltfModel.prototype.updateTextures=function(t,e){var n=this.instance._primitive;return new l.a((function(i,r){if(n)if(t.length>0&&e.length===t.length){var o=n._rendererResources.textures,s=ue()(o).length,a=[];t.forEach((function(t,n){if(t<s){var i=function t(e,n){return new l.a((function(i,r){n instanceof Image?(e.copyFrom(n),e.generateMipmap(),i()):"[object String]"===Object.prototype.toString.call(n)&&Cesium.Resource.fetchImage({url:n}).then((function(n){t(e,n).then((function(){i()})).catch((function(t){r(t)}))})).otherwise((function(t){r(t)}))}))}(o[t],e[n]);a.push(i)}})),l.a.all(a).then((function(){i()})).catch((function(t){r(t)}))}else i();else r(new Error("model not ready!"))}))},u.a.GltfModel.prototype.getOriginalTextureInfo=function(){var t=[],e=this.instance._primitive;return e&&(t=e.gltf.images.map((function(t){return{name:t.name,uri:t.uri}}))),t},u.a.GltfModel.prototype.rotateNode=function(t,e,n){var i=this.instance._primitive.getNode(t);if(Cesium.defined(i)){var r=n&&3===n.length?new(Function.prototype.bind.apply(Cesium.Cartesian3,[null].concat(h()(n)))):Cesium.Cartesian3.UNIT_X,o=new Cesium.CallbackProperty((function(t,n){return Cesium.Quaternion.fromAxisAngle(r,Cesium.Math.toRadians(e),n)})),s=new Cesium.NodeTransformationProperty({rotation:o}),a=Cesium.Matrix4.fromTranslationRotationScale(s.getValue(),new Cesium.Matrix4);i.matrix=Cesium.Matrix4.multiply(i.originalMatrix,a,a)}},u.a.GltfModel.prototype.setClippginPolygon=function(t){var e=this.instance._primitive;if(null==t)e.clippingPlanes=new Cesium.ClippingPlaneCollection({planes:[]});else{var n=t.instance.map((function(n){var i=n._se.map((function(t){return{lng:180*t.longitude/Math.PI,lat:180*t.latitude/Math.PI}}));return t.clipInner||(i=i.reverse()),function(t,e,n){var i=$s(t,n),r=$s(e,n),o=new Cesium.Cartesian3(0,0,10),s=Cesium.Cartesian3.subtract(r,i,new Cesium.Cartesian3),a=Cesium.Cartesian3.cross(s,o,new Cesium.Cartesian3);a=Cesium.Cartesian3.normalize(a,a);var l=Cesium.Plane.fromPointNormal(i,a);return Cesium.ClippingPlane.fromPlane(l)}(i[0],i[1],function(t){var e,n=t.modelMatrix;e=n&&n.equals(Cesium.Matrix4.IDENTITY)||!n?Cesium.Transforms.eastNorthUpToFixedFrame(t.boundingSphere.boundingSphere.center):Cesium.Matrix4.fromArray(n);return Cesium.Matrix4.inverseTransformation(e,new Cesium.Matrix4)}(e))}));e.clippingPlanes=new Cesium.ClippingPlaneCollection({planes:n,unionClippingRegions:!t.clipInner})}},u.a.GltfModel.prototype.flat=function(t){var e=this.instance._primitive;t=t||ea(e),this._flatAxis=t,e._vertexShaderLoaded=function(e,n){return function(t,e){return t.indexOf("gltf_flat_main")<0&&(t=(t=(t=(t=Cesium.ShaderSource.replaceMain(t,"gltf_flat_main")).replace("attribute vec3 a_position;","attribute vec3 temp_aposition;\nvarying vec3 temp_aposition1;")).replace(/a\_position/g,"a_position1")).replace(/temp\_aposition/g,"a_position"),t+=ta(e)),t}(e,t)},e._shouldRegenerateShaders=!0,this._oldModelMatrix=Cesium.Matrix4.clone(e.modelMatrix,new Cesium.Matrix4),e.modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this.position.exportCartesian(),Cesium.Ellipsoid.WGS84,new Cesium.Matrix4)},u.a.GltfModel.prototype.unflat=function(){var t=this.instance._primitive,e=this._flatAxis||ea(t);t._vertexShaderLoaded=function(t,n){return function(t,e){return t=(t=t.replace(ta(e),"")).replace("gltf_flat_main","main")}(t,e)},t._shouldRegenerateShaders=!0,this._oldModelMatrix&&(t.modelMatrix=this._oldModelMatrix,this._oldModelMatrix=void 0)},u.a.GltfModel.prototype.startAnimation=function(t){var e=this.instance._primitive;if(0===na(e).length)throw new Error("no animation in model!");return e.activeAnimations.add(s()({index:0,loop:Cesium.ModelAnimationLoop.REPEAT},t||{}))},u.a.GltfModel.prototype.stopAnimation=function(t){var e=this.instance._primitive;if(0===na(e).length)throw new Error("no animation in model!");void 0===t?e.activeAnimations.removeAll():t instanceof Cesium.ModelAnimation&&e.activeAnimations.contains(t)&&e.activeAnimations.remove(t)},u.a.GltfModel.prototype.getModelAxisInCartesian=function(){return Qs(this.primitive)},u.a.GltfModel.prototype.getModelForwardAxisInCartesian=function(){return Qs(this.primitive).FORWARD},u.a.GltfModel.prototype.getModelUpAxisInCartesian=function(){return Qs(this.primitive).UP};u.a.GltfModel;u.a.VerticalPlate=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},texture:{name:"纹理",type:u.a.PropertyType.Url,default:u.a.RelativePath+"assets/cylinderimage.png"},width:{name:"宽度",type:u.a.PropertyType.Float,default:30},height:{name:"高度",type:u.a.PropertyType.Float,default:30},heading:{name:"航向角",type:u.a.PropertyType.Float,default:0},faceCamera:{name:"朝向相机",type:u.a.PropertyType.Boolean,default:!1}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return i},set:function(t){t instanceof u.a.Point3d&&(i=t,e.instance.position=i.exportCartesian())},enumerable:!0});var r=t.texture?t.texture:this.config.texture.default;Object.defineProperty(this,"texture",{get:function(){return r},set:function(t){t&&(r=t,e.instance.plane.material.image=canvas)},enumerable:!0});var o=isNaN(t.width)?this.config.width.default:t.width;Object.defineProperty(this,"width",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.plane.dimensions=new Cesium.Cartesian2(o,s))},enumerable:!0});var s=isNaN(t.height)?this.config.height.default:t.height;Object.defineProperty(this,"height",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.plane.dimensions=new Cesium.Cartesian2(o,s))},enumerable:!0});var a=isNaN(t.heading)?this.config.heading.default:t.heading;Object.defineProperty(this,"heading",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.orientation=l?new Cesium.CallbackProperty((function(){if(e.instance.show)return Cesium.Transforms.headingPitchRollQuaternion(e.instance.position._value,new Cesium.HeadingPitchRoll(_cesium.camera.heading,0,0))}),!1):Cesium.Transforms.headingPitchRollQuaternion(e.instance.position._value,new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(a),0,0)))},enumerable:!0});var l=!0===t.faceCamera;Object.defineProperty(this,"faceCamera",{get:function(){return l},set:function(t){l=!!t,e.instance.orientation=l?new Cesium.CallbackProperty((function(){if(e.instance.show)return Cesium.Transforms.headingPitchRollQuaternion(e.instance.position._value,new Cesium.HeadingPitchRoll(_cesium.camera.heading,0,0))}),!1):Cesium.Transforms.headingPitchRollQuaternion(e.instance.position._value,new Cesium.HeadingPitchRoll(a,0,0))},enumerable:!0}),this.instance=_cesium.entities.add({show:n,position:i.exportCartesian(),id:i.id,plane:{plane:new Cesium.Plane(new Cesium.Cartesian3(0,-1,0),0),dimensions:new Cesium.Cartesian2(o,s),material:new Cesium.ImageMaterialProperty({image:r,transparent:!0})}}),e.instance.orientation=l?new Cesium.CallbackProperty((function(){if(e.instance.show)return Cesium.Transforms.headingPitchRollQuaternion(e.instance.position._value,new Cesium.HeadingPitchRoll(_cesium.camera.heading,0,0))}),!1):Cesium.Transforms.headingPitchRollQuaternion(e.instance.position._value,new Cesium.HeadingPitchRoll(a,0,0))},u.a.VerticalPlate.prototype=new u.a.Element,u.a.VerticalPlate.prototype.type="VerticalPlate";u.a.VerticalPlate;u.a.LineWall=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},startEl:{name:"起始高度",type:u.a.PropertyType.Float,default:0,noConfig:!0},intervalEl:{name:"间隔高度",type:u.a.PropertyType.Float,default:5,noConfig:!0},lineCount:{name:"线条个数",type:u.a.PropertyType.Float,default:8,noConfig:!0},lineWidth:{name:"线宽",type:u.a.PropertyType.Float,default:10,noConfig:!0},breathSpeed:{name:"呼吸速度",type:u.a.PropertyType.Float,default:1},traces:{name:"轨迹",type:u.a.PropertyType.Array,default:Array.isArray(t.traces)?t.traces:[],noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.polylines.show=n},enumerable:!0});var i=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return i},set:function(t){t instanceof u.a.Color&&(i=t,e.polylines.color=i)},enumerable:!0});var r=isNaN(t.startEl)?this.config.startEl.default:t.startEl;Object.defineProperty(this,"startEl",{get:function(){return startEl},set:function(t){isNaN(t)||(r=t)},enumerable:!0});var o=isNaN(t.intervalEl)?this.config.intervalEl.default:t.intervalEl;Object.defineProperty(this,"intervalEl",{get:function(){return o},set:function(t){isNaN(t)||(o=t)},enumerable:!0});var s=isNaN(t.lineCount)?this.config.lineCount.default:t.lineCount;Object.defineProperty(this,"lineCount",{get:function(){return s},set:function(t){isNaN(t)||(s=t)},enumerable:!0});var a=isNaN(t.lineWidth)?this.config.lineWidth.default:t.lineWidth;Object.defineProperty(this,"lineWidth",{get:function(){return a},set:function(t){isNaN(t)||(a=t)},enumerable:!0});var l=isNaN(t.breathSpeed)?this.config.breathSpeed.default:t.breathSpeed;if(Object.defineProperty(this,"breathSpeed",{get:function(){return l},set:function(t){isNaN(t)||(l=t,e.polylines.breathSpeed=l)},enumerable:!0}),this.config.traces.default){for(var c=[],h=0;h<s;h++)this.config.traces.default.forEach((function(t){var e=t.clone();c.push(e.applyHeight(r+o*h))}));this.polylines=new u.a.PolyLines({traces:c,show:n,glowPower:.1,glowEnable:!0,breathEnable:!0,breathSpeed:l,breathDelay:h/s,lineWidth:a,color:i}),this.instance=this.polylines.instance}},u.a.LineWall.prototype=new u.a.Element,u.a.LineWall.prototype.type="LineWall",u.a.LineWall.prototype.destroy=function(){this.polylines=null,u.a.Element.prototype.destroy.call(this)};u.a.LineWall;u.a.FlowWall=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},cw:{name:"顺时针",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},speed:{name:"速度",type:u.a.PropertyType.Float,default:1},wallHeight:{name:"高度",type:u.a.PropertyType.Float,default:1e4},texture:{name:"纹理",type:u.a.PropertyType.String,default:u.a.RelativePath+"assets/flow.png"},trace:{name:"轨迹",type:u.a.PropertyType.Trace,default:t.trace instanceof u.a.Point3dCollection?t.trace:new u.a.Point3dCollection,noConfig:!0},repeat:{name:"重复",type:u.a.PropertyType.Float,default:5},horizontal:{name:"水平流动",type:u.a.PropertyType.Boolean,default:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=!1!==t.horizontal;Object.defineProperty(this,"horizontal",{get:function(){return i},set:function(t){i=!!t,e.instance.wall.material.horizontal=i},enumerable:!0});var r=!1!==t.cw;Object.defineProperty(this,"cw",{get:function(){return r},set:function(t){r=!!t,e.instance.wall.material.cw=r},enumerable:!0});var o=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return o},set:function(t){t instanceof u.a.Color&&(o=t,e.instance.wall.material.color=o.color)},enumerable:!0});var s=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.wall.material.duration=5e3/s)},enumerable:!0});var a=isNaN(t.wallHeight)?this.config.wallHeight.default:t.wallHeight;Object.defineProperty(this,"wallHeight",{get:function(){return a},set:function(t){isNaN(t)||(a=t,p=[],h.forEach((function(t){p.push(t+a)})),e.instance.wall.maximumHeights=p)},enumerable:!0});var l=t.texture?t.texture:this.config.texture.default;Object.defineProperty(this,"texture",{get:function(){return l},set:function(t){l=t,e.instance.wall.material.image=l},enumerable:!0});var c=isNaN(t.repeat)?this.config.repeat.default:t.repeat;if(Object.defineProperty(this,"repeat",{get:function(){return c},set:function(t){isNaN(t)||(c=t,e.instance.wall.material.repeat=c)},enumerable:!0}),this.config.trace.default){var h=[];this.config.trace.default.points.forEach((function(t){h.push(t.exportLngLatHeightArray()[2])}));var p=[];h.forEach((function(t){p.push(t+a)})),this.instance=_cesium.entities.add({id:this.config.trace.default.id,show:n,wall:{positions:Cesium.Cartesian3.fromDegreesArray(this.config.trace.default.exportLngLatArray()),maximumHeights:p,minimumHeights:h,material:new Cesium.PolylineTrailLinkMaterialProperty({cw:r,image:l,repeat:c,color:o.color,duration:5e3/s,horizontal:i})}})}},u.a.FlowWall.prototype=new u.a.Element,u.a.FlowWall.prototype.type="FlowWall";u.a.FlowWall;u.a.OdLines=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;e.map3d=E.apply(void 0,arguments)||_sf3d;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},width:{name:"线宽",type:u.a.PropertyType.Float,default:2},intense:{name:"深度",type:u.a.PropertyType.Float,default:1},speed:{name:"速度",type:u.a.PropertyType.Float,default:1},play:{name:"播放",type:u.a.PropertyType.Boolean,default:!0},curve:{name:"是否为折线",type:u.a.PropertyType.Boolean,default:!1},traces:{name:"轨迹",type:u.a.PropertyType.Array,default:Array.isArray(t.traces)?t.traces:[],noConfig:!0},heightRatio:{name:"尾迹曲率",type:u.a.PropertyType.Float,default:1}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return i},set:function(t){t instanceof u.a.Color&&(i=t,e.instance.data.forEach((function(t){t.color=i.exportArray()})))},enumerable:!0});var r=isNaN(t.width)?this.config.width.default:t.width;Object.defineProperty(this,"width",{get:function(){return r},set:function(t){isNaN(t)||(r=t,e.instance.data.forEach((function(t){t.width=r})))},enumerable:!0});var o=isNaN(t.intense)?this.config.intense.default:t.intense;Object.defineProperty(this,"intense",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.color=[1,1,1,o])},enumerable:!0});var s=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.data.forEach((function(t){t.duration=10/s})))},enumerable:!0});var a=!1!==t.play;Object.defineProperty(this,"play",{get:function(){return a},set:function(t){a=!!t,e.instance.playing=a},enumerable:!0});var l=!0===t.curve;Object.defineProperty(this,"curve",{get:function(){return l},set:function(t){l=!!t,e.instance.data=p()},enumerable:!0});var c=isNaN(t.heightRatio)?this.config.heightRatio.default:t.heightRatio;Object.defineProperty(this,"heightRatio",{get:function(){return c},set:function(t){isNaN(t)||(c=t,l&&e.instance.data.forEach((function(t){t.heightRatio=c})))},enumerable:!0});var h=[Ro.a,Ro.a,dt.a,dt.a];this._extent=h;var p=function(){var t=[];return l?e.config.traces.default.forEach((function(e){t.push({width:isNaN(e.width)?r:e.width,startPos:e.getByIndex(0).exportRadianHeightArray(),endPos:e.getByIndex(e.size-1).exportRadianHeightArray(),startTime:3*Math.random(),duration:10/s,heightRatio:c,color:e.color instanceof u.a.Color?e.color.exportArray():i.exportArray()});var n=e.getBounds();h[0]=Math.min(h[0],n.min.lng),h[1]=Math.min(h[1],n.min.lat),h[2]=Math.max(h[2],n.max.lng),h[3]=Math.max(h[3],n.max.lat)})):e.config.traces.default.forEach((function(e){for(var n=e.exportRadianHeightArray(),o=[],a=0;a<n.length;a+=3)o.push([n[a],n[a+1],n[a+2]]);t.push({positions:o,width:isNaN(e.width)?r:e.width,startTime:3*Math.random(),duration:10/s,color:e.color instanceof u.a.Color?e.color.exportArray():i.exportArray()});var l=e.getBounds();h[0]=Math.min(h[0],l.min.lng),h[1]=Math.min(h[1],l.min.lat),h[2]=Math.max(h[2],l.max.lng),h[3]=Math.max(h[3],l.max.lat)})),t};this.config.traces.default&&(this.instance=new XE.Obj.ODLines(I.apply(void 0,arguments)||_earthsdk),this.instance.color=[1,1,1,o],this.instance.show=n,this.instance.data=p(),this.instance.playing=a)},u.a.OdLines.prototype=new u.a.Element,u.a.OdLines.prototype.type="OdLines",u.a.OdLines.prototype.focus=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pitch:-90},e=(new u.a.Point3dCollection).fromLngLatArray(this._extent);return t.boundingSphere=e.exportBoundingSphere(),this.map3d.camera.focusOnSphere(t)};u.a.OdLines;u.a.PolyLines=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},glowEnable:{name:"启用发光",type:u.a.PropertyType.Boolean,default:!1},glowPower:{name:"强度",type:u.a.PropertyType.Float,default:.25},breathEnable:{name:"启用",type:u.a.PropertyType.Boolean,default:!1},breathSpeed:{name:"速度",type:u.a.PropertyType.Float,default:1},breathDelay:{name:"呼吸延迟",type:u.a.PropertyType.Float,default:1},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},lineWidth:{name:"线宽",type:u.a.PropertyType.Float,default:10,noConfig:!0},clampToGround:{name:"贴地",type:u.a.PropertyType.Boolean,default:!1,noConfig:!0},traces:{name:"轨迹",type:u.a.PropertyType.Array,default:Array.isArray(t.traces)?t.traces:[],noConfig:!0},allowPicking:{name:"是否允许拾取",type:u.a.PropertyType.Boolean,default:!0===t.allowPicking,noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance&&(e.instance.show=n)},enumerable:!0});var i=!!t.glowEnable;Object.defineProperty(this,"glowEnable",{get:function(){return i},set:function(t){(i=!!t)?(e.instance.appearance.material=Cesium.Material.fromType(Cesium.Material.PolylineGlowType),e.instance.appearance.material.uniforms.glowPower=r,e.instance.appearance.material.uniforms.color=l.color):(e.instance.appearance.material=Cesium.Material.fromType("Color"),e.instance.appearance.material.uniforms.color=l.color)},enumerable:!0});var r=isNaN(t.glowPower)?this.config.glowPower.default:t.glowPower;Object.defineProperty(this,"glowPower",{get:function(){return r},set:function(t){!isNaN(t)&&i&&(r=t,e.instance.appearance.material.uniforms.glowPower=r)},enumerable:!0});var o=!!t.breathEnable;Object.defineProperty(this,"breathEnable",{get:function(){return o},set:function(t){i&&((o=!!t)?_cesium.scene.preUpdate.addEventListener(d):_cesium.scene.preUpdate.removeEventListener(d))},enumerable:!0});var s=isNaN(t.breathSpeed)?this.config.breathSpeed.default:t.breathSpeed;Object.defineProperty(this,"breathSpeed",{get:function(){return s},set:function(t){!isNaN(t)&&i&&(s=t)},enumerable:!0});var a=isNaN(t.breathDelay)?this.config.breathDelay.default:t.breathDelay;Object.defineProperty(this,"breathDelay",{get:function(){return a},set:function(t){isNaN(t)||(a=t)},enumerable:!0});var l=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return l},set:function(t){t instanceof u.a.Color&&(l=t,e.instance.appearance.material.uniforms.color=l.color)},enumerable:!0});var c=isNaN(t.lineWidth)?this.config.lineWidth.default:t.lineWidth;Object.defineProperty(this,"lineWidth",{get:function(){return c},set:function(t){isNaN(t)||(c=t)},enumerable:!0});var h=!!t.clampToGround;Object.defineProperty(this,"clampToGround",{get:function(){return h},set:function(t){h=!!t},enumerable:!0});var p=!0===t.allowPicking;Object.defineProperty(this,"allowPicking",{get:function(){return p},set:function(t){p=!!t},enumerable:!0});var f=!1!==t.releaseGeometryInstances,d=function(){e.instance.appearance.material.uniforms.glowPower=o?Math.sin((new Date).getTime()/500*s+Math.PI/a)/20+r:r};if(this.config.traces.default){var g=[];this.config.traces.default.forEach((function(t){var e={positions:t.exportCartesianArray(),width:c};g.push(new Cesium.GeometryInstance({id:t.id,geometry:h?new Cesium.GroundPolylineGeometry(e):new Cesium.PolylineGeometry(e),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(l.color),show:new Cesium.ShowGeometryInstanceAttribute(!0)}}))}));var y,m=null;i?((m=Cesium.Material.fromType(Cesium.Material.PolylineGlowType)).uniforms.glowPower=r,m.uniforms.color=l.color):(m=Cesium.Material.fromType("Color")).uniforms.color=l.color,y=t.appearance?t.appearance:new Cesium.PolylineMaterialAppearance({material:m}),g.length>0&&(h?(this.instance=new Cesium.GroundPolylinePrimitive({geometryInstances:g,appearance:y,show:n,allowPicking:p,releaseGeometryInstances:f,classificationType:t.classificationType}),_cesium.scene.groundPrimitives.add(this.instance)):(this.instance=new Cesium.Primitive({geometryInstances:g,appearance:y,show:n,allowPicking:p,releaseGeometryInstances:f}),_cesium.scene.primitives.add(this.instance)),o&&_cesium.scene.preUpdate.addEventListener(d))}this.setVisible=function(t,e){var n=this;if(this.instance){var i=function(){n.config.traces.default.filter((function(t){return e(t)})).forEach((function(e){var i=n.instance.getGeometryInstanceAttributes(e.id);i&&(i.show=Cesium.ShowGeometryInstanceAttribute.toValue(t,i.show))}))};!0===this.instance.ready?i():this.instance.readyPromise.then(i)}}},u.a.PolyLines.prototype=new u.a.Element,u.a.PolyLines.prototype.type="PolyLines";u.a.PolyLines;u.a.RadarCircle=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},texture:{name:"纹理",type:u.a.PropertyType.Url,default:u.a.RelativePath+"assets/radarcircle.png"},radius:{name:"半径",type:u.a.PropertyType.Float,default:10},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},speed:{name:"速度",type:u.a.PropertyType.Float,default:1},cw:{name:"顺时针",type:u.a.PropertyType.Boolean,default:!1}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return i},set:function(t){t instanceof u.a.Point3d&&(i=t,e.instance.position=i.exportRadianHeightArray())},enumerable:!0});var r=t.texture||this.config.texture.default;Object.defineProperty(this,"texture",{get:function(){return r},set:function(t){t&&(r=t,e.instance.evalString="\n                Cesium.Resource.createIfNeeded('"+r+"').fetchImage().then(function(image) {\n                    p._ctx_image = image;\n                });\n            ")},enumerable:!0});var o=isNaN(t.radius)?this.config.radius.default:t.radius;Object.defineProperty(this,"radius",{get:function(){return o},set:function(t){t&&(o=t,e.instance.width=o,e.instance.height=o)},enumerable:!0});var s=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return s},set:function(t){t instanceof u.a.Color&&(s=t,e.instance.color=s.exportArray())},enumerable:!0});var a=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.preUpdateEvalString=p())},enumerable:!0});var l=!!t.cw;Object.defineProperty(this,"cw",{get:function(){return l},set:function(t){l=!!t,e.instance.preUpdateEvalString=p()},enumerable:!0});var c="\n     Cesium.Resource.createIfNeeded('"+r+"').fetchImage().then(function(image) {\n         p._ctx_image = image;\n     });\n ",h="\n     if (typeof p.dAngle === 'undefined') p.dAngle = 360.0;\n     if("+l+"){\n        p.dAngle -= "+a+";\n        if (p.dAngle < 0.0) {\n            p.dAngle = 360.0;\n        }\n     }else{\n        p.dAngle += "+a+';\n        if (p.dAngle > 360.0) {\n            p.dAngle = 0.0;\n        }\n     }\n    \n     const rotation = p.dAngle / 180.0 * Math.PI;\n\n     p.drawCanvas(ctx => {\n         ctx.clearRect(0, 0, 512, 512);\n\n         ctx.beginPath();\n         ctx.strokeStyle = "rgb(128, 128, 128)";\n         ctx.lineWidth = 1;\n         ctx.arc(256, 256, 250, 0, Math.PI*2, true);\n         ctx.stroke();\n\n         if (p._ctx_image) {\n             ctx.save();\n             ctx.translate(256, 256);\n             ctx.rotate(rotation);\n             ctx.translate(-256, -256);\n             ctx.drawImage(p._ctx_image, 0, 0);\n             ctx.restore();\n         }\n     });\n ',p=function(){return"\n     if (typeof p.dAngle === 'undefined') p.dAngle = 360.0;\n     if("+l+"){\n        p.dAngle -= "+a+";\n        if (p.dAngle < 0.0) {\n            p.dAngle = 360.0;\n        }\n     }else{\n        p.dAngle += "+a+';\n        if (p.dAngle > 360.0) {\n            p.dAngle = 0.0;\n        }\n     }\n    \n     const rotation = p.dAngle / 180.0 * Math.PI;\n\n     p.drawCanvas(ctx => {\n         ctx.clearRect(0, 0, 512, 512);\n\n         ctx.beginPath();\n         ctx.strokeStyle = "rgb(128, 128, 128)";\n         ctx.lineWidth = 1;\n         ctx.arc(256, 256, 250, 0, Math.PI*2, true);\n         ctx.stroke();\n\n         if (p._ctx_image) {\n             ctx.save();\n             ctx.translate(256, 256);\n             ctx.rotate(rotation);\n             ctx.translate(-256, -256);\n             ctx.drawImage(p._ctx_image, 0, 0);\n             ctx.restore();\n         }\n     });\n '},f={evalString:c,xbsjGuid:i.id,preUpdateEvalString:h,position:i.exportRadianHeightArray(),width:o,height:o,canvasWidth:512,canvasHeight:512,color:s.exportArray()};this.instance=new XE.Obj.CustomGroundRectangle(I.apply(void 0,arguments)||_earthsdk),this.instance.xbsjFromJSON(f)},u.a.RadarCircle.prototype=new u.a.Element,u.a.RadarCircle.prototype.type="RadarCircle";u.a.RadarCircle;u.a.RadiationWave=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},radius:{name:"半径",type:u.a.PropertyType.Float,default:1e3},height:{name:"高度",type:u.a.PropertyType.Float,default:100},speed:{name:"速度",type:u.a.PropertyType.Float,default:1},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=isNaN(t.radius)?this.config.radius.default:t.radius;Object.defineProperty(this,"radius",{get:function(){return i},set:function(t){isNaN(t)||(i=t,e.instance.preUpdateEvalString=p())},enumerable:!0});var r=isNaN(t.height)?this.config.height.default:t.height;Object.defineProperty(this,"height",{get:function(){return r},set:function(t){isNaN(t)||(r=t,e.instance.preUpdateEvalString=p())},enumerable:!0});var o=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.preUpdateEvalString=p())},enumerable:!0});var s=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return s},set:function(t){t instanceof u.a.Color&&(s=t,e.instance.color=s.exportArray())},enumerable:!0});var a=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return a},set:function(t){t instanceof u.a.Point3d&&(a=t,e.instance.position=a.exportRadianHeightArray())},enumerable:!0});var l=XE.Obj.CustomPrimitive.Geometry.createCylinder(1,1,1,30),c=XE.Obj.CustomPrimitive.getRenderState(!0,!0);c.cull.enabled=!1;var h="\n              p.canvasWidth = 1;\n              p.canvasHeight = 256;\n              p.drawCanvas(ctx => {\n                  ctx.clearRect(0, 0, 1, 256);\n\n                  var lingrad2 = ctx.createLinearGradient(0,0,0,256);\n                  lingrad2.addColorStop(0, 'rgba(255,255,255,0)');\n                  lingrad2.addColorStop(1, 'rgba(255,255,255,0.5)');\n\n                  ctx.fillStyle = lingrad2;\n                  ctx.fillRect(0, 0, 1, 256);\n              }); \n          ",p=function(){return"\n              if (typeof p.dt === 'undefined') p.dt = 0.0;\n              p.dt += 0.01 * 0.3*"+o+";\n              if (p.dt > 1.0) {\n                  p.dt = 0.0;\n              }\n\n              const b = (1.0-Math.cos(p.dt*Math.PI*2.0))*0.5;\n              p.scale[0] = p.scale[1] = "+i+" * (1.0-Math.cos(p.dt*Math.PI))*0.5;\n              p.scale[2] = "+r+" * b;\n              p.color[3] = 2.0 * b;\n          "},f="\n              if (typeof p.dt === 'undefined') p.dt = 0.0;\n              p.dt += 0.01 * 0.3*"+o+";\n              if (p.dt > 1.0) {\n                  p.dt = 0.0;\n              }\n\n              const b = (1.0-Math.cos(p.dt*Math.PI*2.0))*0.5;\n              p.scale[0] = p.scale[1] = "+i+" * (1.0-Math.cos(p.dt*Math.PI))*0.5;\n              p.scale[2] = "+r+" * b;\n              p.color[3] = 2.0 * b;\n          ";this.instance=new XE.Obj.CustomPrimitive(I.apply(void 0,arguments)||_earthsdk),this.instance.xbsjFromJSON({evalString:h,xbsjGuid:a.id,preUpdateEvalString:f,position:a.exportRadianHeightArray(),scale:[1,1,1],positions:l.positions,sts:l.sts,indices:l.indices,renderState:c,canvasWidth:1,canvasHeight:256,color:s.exportArray()})},u.a.RadiationWave.prototype=new u.a.Element,u.a.RadiationWave.prototype.type="RadiationWave";u.a.RadiationWave;u.a.ReflectionPolygons=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},baseColor:{name:"基础颜色",type:u.a.PropertyType.Color,default:new u.a.Color},blendColor:{name:"混合颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,1,1,1)},clampToGround:{name:"贴地",type:u.a.PropertyType.Boolean,default:!1},height:{name:"高度",type:u.a.PropertyType.Float,default:0},trace:{name:"轨迹",type:u.a.PropertyType.Trace,default:t.trace instanceof u.a.Point3dCollection?t.trace:new u.a.Point3dCollection,noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.baseColor instanceof u.a.Color?t.baseColor:this.config.baseColor.default;Object.defineProperty(this,"baseColor",{get:function(){return i},set:function(t){t instanceof u.a.Color&&(i=t,e.instance.baseWaterColor=i.exportArray())},enumerable:!0});var r=t.blendColor instanceof u.a.Color?t.blendColor:this.config.blendColor.default;Object.defineProperty(this,"blendColor",{get:function(){return r},set:function(t){t instanceof u.a.Color&&(r=t,e.instance.blendColor=r.exportArray())},enumerable:!0});var o=!!t.clampToGround;Object.defineProperty(this,"clampToGround",{get:function(){return o},set:function(t){o=!!t,e.instance.ground=o},enumerable:!0});var s=isNaN(t.height)?this.config.height.default:t.height;Object.defineProperty(this,"height",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.height=s)},enumerable:!0}),this.instance=new XE.Obj.Water(I.apply(void 0,arguments)||_earthsdk),this.instance.xbsjFromJSON({xbsjType:"Water",xbsjGuid:this.config.trace.default.id,positions:this.config.trace.default.exportRadianArray(),height:s,frequency:0,animationSpeed:0,amplitude:0,specularIntensity:0,velocity:[0,0],baseWaterColor:i.exportArray(),blendColor:r.exportArray(),outline:!1,ground:o})},u.a.ReflectionPolygons.prototype=new u.a.Element,u.a.ReflectionPolygons.prototype.type="ReflectionPolygons";u.a.ReflectionPolygons;u.a.RotateImage=function(t){var e;t=t||{},u.a.Element.call(this,t.id);var n=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d(0,0,0),noConfig:!0},texture:{name:"纹理",type:u.a.PropertyType.Url,default:u.a.RelativePath+"assets/cylinderimage.png"},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},speed:{name:"速度",type:u.a.PropertyType.Float,default:1},cw:{name:"顺时针",type:u.a.PropertyType.Boolean,default:!0},radius:{name:"半径",type:u.a.PropertyType.Float,default:10},height:{name:"高度",type:u.a.PropertyType.Float,default:0}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,n.instance.show=i},enumerable:!0});var r=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return r},set:function(t){t instanceof u.a.Point3d&&(r=t,n.instance.position=r.exportRadianHeightArray())},enumerable:!0});var o=t.texture||this.config.texture.default;Object.defineProperty(this,"texture",{get:function(){return o},set:function(t){t&&(o=t)},enumerable:!0});var s=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return s},set:function(t){t instanceof u.a.Color&&(s=t,n.instance.rectangle.material.color=s.color)},enumerable:!0});var a=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return a},set:function(t){isNaN(t)||(a=t)},enumerable:!0});var l=isNaN(t.radius)?this.config.radius.default:t.radius;Object.defineProperty(this,"radius",{get:function(){return l},set:function(t){if(!isNaN(t)){var e;l=t;var i=pt.transformTranslate(f,l*Math.sqrt(2),45,{units:"meters"}),r=pt.transformTranslate(f,l*Math.sqrt(2),225,{units:"meters"});n.instance.rectangle.coordinates=(e=Cesium.Rectangle).fromDegrees.apply(e,h()(r.geometry.coordinates).concat(h()(i.geometry.coordinates)))}},enumerable:!0});var c=isNaN(t.cw)?this.config.cw.default:t.cw;Object.defineProperty(this,"cw",{get:function(){return c},set:function(t){c=!!t},enumerable:!0});var p=isNaN(t.height)?this.config.height.default:t.height;Object.defineProperty(this,"height",{get:function(){return p},set:function(t){isNaN(t)||(p=t,n.instance.rectangle.height=p)},enumerable:!0});var f=pt.point(r.exportLngLatArray()),d=pt.transformTranslate(f,l*Math.sqrt(2),45,{units:"meters"}),g=pt.transformTranslate(f,l*Math.sqrt(2),225,{units:"meters"}),y=0;this.instance=_cesium.entities.add({id:r.id,rectangle:{coordinates:(e=Cesium.Rectangle).fromDegrees.apply(e,h()(g.geometry.coordinates).concat(h()(d.geometry.coordinates))),classificationType:Cesium.ClassificationType.BOTH,material:new Cesium.ImageMaterialProperty({image:o,transparent:!0,color:s.color}),rotation:new Cesium.CallbackProperty((function(){return y+=(c?1:-1)*a/1e3}),!1),stRotation:new Cesium.CallbackProperty((function(){return y+=(c?1:-1)*a/1e3}),!1)}})},u.a.RotateImage.prototype=new u.a.Element,u.a.RotateImage.prototype.type="RotateImage";u.a.RotateImage;u.a.ScaleImage=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d(0,0,0),noConfig:!0},texture:{name:"纹理",type:u.a.PropertyType.Url,default:u.a.RelativePath+"assets/scaleimage.png"},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},radius:{name:"半径",type:u.a.PropertyType.Float,default:10},speed:{name:"速度",type:u.a.PropertyType.Float,default:1},height:{name:"高度",type:u.a.PropertyType.Float,default:0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return i},set:function(t){t instanceof u.a.Point3d&&(i=t)},enumerable:!0});var r=t.texture||this.config.texture.default;Object.defineProperty(this,"texture",{get:function(){return r},set:function(t){t&&(r=t,e.instance.polygon.material.image.setValue(r))},enumerable:!0});var o=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return o},set:function(t){t instanceof u.a.Color&&(o=t)},enumerable:!0});var s=isNaN(t.radius)?this.config.radius.default:t.radius;Object.defineProperty(this,"radius",{get:function(){return s},set:function(t){isNaN(t)||(s=t)},enumerable:!0});var a=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return a},set:function(t){isNaN(t)||(a=t)},enumerable:!0});var l=isNaN(t.height)?this.config.height.default:t.height;Object.defineProperty(this,"height",{get:function(){return l},set:function(t){isNaN(t)||(l=t,e.instance.polygon.height=l)},enumerable:!0}),this.instance=_cesium.entities.add({id:i.id,polygon:{hierarchy:new Cesium.CallbackProperty((function(){var t=(new Date).getTime()/1e3*a,e=t%Math.PI,n=0;n=e>Math.PI/2&&e<Math.PI?Math.abs(Math.sin(t-Math.PI/2)):Math.abs(Math.sin(t));var r=pt.point(i.exportLngLatArray()),o=pt.transformTranslate(r,s*n*Math.sqrt(2),45,{units:"meters"}),l=pt.transformTranslate(r,s*n*Math.sqrt(2),135,{units:"meters"}),u=pt.transformTranslate(r,s*n*Math.sqrt(2),225,{units:"meters"}),c=pt.transformTranslate(r,s*n*Math.sqrt(2),315,{units:"meters"});return new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArray([].concat(h()(u.geometry.coordinates),h()(l.geometry.coordinates),h()(o.geometry.coordinates),h()(c.geometry.coordinates))))}),!1),heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,classificationType:Cesium.ClassificationType.BOTH,material:new Cesium.ImageMaterialProperty({image:r,transparent:!0,color:new Cesium.CallbackProperty((function(){var t=(new Date).getTime()/1e3*a,e=t%Math.PI,n=0;n=e>Math.PI/2&&e<Math.PI?Math.abs(Math.cos(t-Math.PI/2)):Math.abs(Math.cos(t));var i=o.exportArray();return new Cesium.Color(i[0],i[1],i[2],n)}),!1)})}})},u.a.ScaleImage.prototype=new u.a.Element,u.a.ScaleImage.prototype.type="ScaleImage";u.a.ScaleImage;u.a.ScaleSemiSphere=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,1,1,1)},radius:{name:"半径",type:u.a.PropertyType.Float,default:10},speed:{name:"速度",type:u.a.PropertyType.Float,default:1},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return i},set:function(t){t instanceof u.a.Color&&(i=t)},enumerable:!0});var r=isNaN(t.radius)?this.config.radius.default:t.radius;Object.defineProperty(this,"radius",{get:function(){return r},set:function(t){isNaN(t)||(r=t)},enumerable:!0});var o=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return o},set:function(t){t&&(o=t)},enumerable:!0});var s=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return s},set:function(t){t instanceof u.a.Point3d&&(s=t,e.instance.position=s.exportCartesian())},enumerable:!0}),this.instance=_cesium.entities.add({position:s.exportCartesian(),id:s.id,ellipsoid:{radii:new Cesium.CallbackProperty((function(){var t=(new Date).getTime()/1e3*o,e=t%Math.PI,n=0;return n=e>Math.PI/2&&e<Math.PI?Math.abs(Math.sin(t-Math.PI/2)):Math.abs(Math.sin(t)),new Cesium.Cartesian3(r*n,r*n,r*n)}),!1),material:i.color,maximumCone:Cesium.Math.toRadians(90)}}),this.instance.ellipsoid.material.color=new Cesium.CallbackProperty((function(){var t=(new Date).getTime()/1e3*o,e=t%Math.PI,n=0;n=e>Math.PI/2&&e<Math.PI?Math.abs(Math.cos(t-Math.PI/2)):Math.abs(Math.cos(t));var r=i.exportArray();return new Cesium.Color(r[0],r[1],r[2],n/2)}),!1)},u.a.ScaleSemiSphere.prototype=new u.a.Element,u.a.ScaleSemiSphere.prototype.type="ScaleSemiSphere";u.a.ScaleSemiSphere;u.a.Terrain=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},url:{name:"地址",type:u.a.PropertyType.String,default:null},waterMask:{name:"水面",type:u.a.PropertyType.Boolean,default:!1,noConfig:!0},vertexNormal:{name:"地形光照",type:u.a.PropertyType.Boolean,default:!1,noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.url||this.config.url.default;Object.defineProperty(this,"url",{get:function(){return i},set:function(t){i=t,e.instance.url=i},enumerable:!0});var r=!1!==t.waterMask;Object.defineProperty(this,"waterMask",{get:function(){return r},set:function(t){r=!!t,e.instance.requestWaterMask=r},enumerable:!0});var o=!1!==t.vertexNormal;Object.defineProperty(this,"vertexNormal",{get:function(){return o},set:function(t){o=!!t,e.instance.requestVertexNormals=o},enumerable:!0}),this.instance=new XE.Obj.Terrain(I.apply(void 0,arguments)||_earthsdk),this.instance.xbsjFromJSON({show:n,xbsjType:"Terrain",xbsjTerrainProvider:{type:"XbsjCesiumTerrainProvider",XbsjCesiumTerrainProvider:{url:i,requestVertexNormals:o,requestWaterMask:r}}})},u.a.Terrain.prototype=new u.a.Element,u.a.Terrain.prototype.type="Terrain",u.a.Terrain.prototype.destroy=function(){_cesium.terrainProvider=null};u.a.Terrain;var ia={};function ra(t,e){return e.map((function(e){return t.replace(/\{s\}/g,e)})).concat(t)}function oa(t,e){if(/^.*(\{s\}).*$/.test(t)&&e&&e.length>0){var n=ra(t,e),i={subdomains:e,subdomainCount:e.length,index:0};return n.forEach((function(t){ia[t]=i})),!0}return!1}function sa(t){return ia[t]||null}function aa(t,e,n){if(/^.*(\{s\}).*$/.test(t)&&e&&e.subdomains){var i=e.index;return!0===n&&e.index++,t.replace(/\{s\}/g,e.subdomains[i%e.subdomainCount])}return t}Cesium.Cesium3DTileset.loadJson=function(t){var e,n=Cesium.Resource.createIfNeeded(t);if(e=n.url,ia.hasOwnProperty(e)){var i=sa(n.url);n._url=aa(n.url,i,!1)}return n.fetchJson()};var la=Cesium.Cesium3DTile.prototype.requestContent;Cesium.Cesium3DTile.prototype.requestContent=function(){if(this.hasEmptyContent)return!1;var t=sa(this._contentResource.request.url);return this._contentResource.url=aa(this._contentResource.url,t,!0),la.call(this)},u.a.TilesetModel=function(t){var e=this;t=t||{},u.a.Element.call(this,t.id);var n=this;this._option=t,this._url=t.url,this._subdomains=t.subdomains,oa(t.url,t.subdomains),this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},url:{name:"路径",type:u.a.PropertyType.Url,default:null},position:{name:"位置",type:u.a.PropertyType.Position,default:null,noConfig:!0},heading:{name:"航向角",type:u.a.PropertyType.Float,default:0},pitch:{name:"俯仰角",type:u.a.PropertyType.Float,default:0},roll:{name:"翻滚角",type:u.a.PropertyType.Float,default:0},rotationEdit:{name:"角度编辑",type:u.a.PropertyType.Boolean,default:!1},positionEdit:{name:"位置编辑",type:u.a.PropertyType.Boolean,default:!1},scale:{name:"缩放",type:u.a.PropertyType.Float,default:1},useOriginTransform:{name:"使用原始变换",type:u.a.PropertyType.Boolean,default:!0},style:{name:"样式代码",type:u.a.PropertyType.String,default:null,noConfig:!0},shader:{name:"自定义shader代码",type:u.a.PropertyType.String,default:t.shader?t.shader:null,noConfig:!0},maximumScreenSpaceError:{name:"最小显示像素",type:u.a.PropertyType.Int,default:16},maximumMemoryUsage:{name:"可用内存",type:u.a.PropertyType.Int,default:512}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,n.instance.show=i},enumerable:!0});var r=t.url||this.config.url.default;Object.defineProperty(this,"url",{get:function(){return r},set:function(t){t&&(r=t,n.instance.url=r)},enumerable:!0});var o=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){var t;return(t=new u.a.Point3d).fromRadian.apply(t,h()(n.instance.xbsjPosition))},set:function(t){t instanceof u.a.Point3d&&(o=t,n.instance.xbsjPosition=o.exportRadianHeightArray())},enumerable:!0}),Object.defineProperty(this,"rotation",{get:function(){return n.instance.xbsjRotation}});var s=Cesium.Math.toRadians(isNaN(t.heading)?this.config.heading.default:t.heading);Object.defineProperty(this,"heading",{get:function(){return Cesium.Math.toDegrees(s)},set:function(t){isNaN(t)||(s=Cesium.Math.toRadians(t),n.instance.xbsjRotation[0]=s)},enumerable:!0});var a=Cesium.Math.toRadians(isNaN(t.pitch)?this.config.pitch.default:t.pitch);Object.defineProperty(this,"pitch",{get:function(){return Cesium.Math.toDegrees(a)},set:function(t){isNaN(t)||(a=Cesium.Math.toRadians(t),n.instance.xbsjRotation[1]=a)},enumerable:!0});var l=Cesium.Math.toRadians(isNaN(t.roll)?this.config.roll.default:t.roll);Object.defineProperty(this,"roll",{get:function(){return Cesium.Math.toDegrees(l)},set:function(t){isNaN(t)||(l=Cesium.Math.toRadians(t),n.instance.xbsjRotation[2]=l)},enumerable:!0});var c=!!t.rotationEdit;Object.defineProperty(this,"rotationEdit",{get:function(){return c},set:function(t){c=!!t,n.instance.rotationEditing=c},enumerable:!0});var p=!!t.positionEdit;Object.defineProperty(this,"positionEdit",{get:function(){return p},set:function(t){p=!!t,n.instance.positionEditing=p},enumerable:!0});var f=isNaN(t.scale)?this.config.scale.default:t.scale;Object.defineProperty(this,"scale",{get:function(){return f},set:function(t){isNaN(t)||(f=t,n.instance.xbsjScale=[f,f,f])},enumerable:!0});var d=t.hasOwnProperty("useOriginTransform")?!1!==t.useOriginTransform:this.config.useOriginTransform.default;Object.defineProperty(this,"useOriginTransform",{get:function(){return d},set:function(t){d=!!t,n.instance.xbsjUseOriginTransform=d},enumerable:!0});var g=t.style?t.style:this.config.style.default;Object.defineProperty(this,"style",{get:function(){return g},set:function(t){t&&(g=t,n.instance.xbsjStyle=g)},enumerable:!0});var y=isNaN(t.maximumScreenSpaceError)?this.config.maximumScreenSpaceError.default:t.maximumScreenSpaceError;Object.defineProperty(this,"maximumScreenSpaceError",{get:function(){return y},set:function(t){isNaN(t)||(n.instance.maximumScreenSpaceError=y)},enumerable:!0});var m=isNaN(t.maximumMemoryUsage)?this.config.maximumMemoryUsage.default:t.maximumMemoryUsage;Object.defineProperty(this,"maximumMemoryUsage",{get:function(){return m},set:function(t){isNaN(t)||(n.instance.maximumMemoryUsage=m)},enumerable:!0}),this.setFlattenId=function(t){this.instance&&(this.instance.xbsjFlattenGuid=t)},this.setClippingPlane=function(t){this.instance&&(this.instance.xbsjClippingPlanes.planes.length=0,t&&this.instance.xbsjClippingPlanes.planes.push(t))},this.setClippginPolygon=function(t){var e=this;this.instance&&(this.instance.xbsjClippingPlanes.planes.length=0,t&&(this.instance.xbsjClippingPlanes.unionClippingRegions=!t.clipInner,t.getClippingIds().forEach((function(t){return e.instance.xbsjClippingPlanes.planes.push(t)}))))},this.instance=new XE.Obj.Tileset(I.apply(void 0,arguments)||_earthsdk);var _={xbsjType:"Tileset",url:r,xbsjRotation:[s,a,l],xbsjScale:[f,f,f],rotationEditing:c,positionEditing:p,xbsjUseOriginTransform:d,maximumMemoryUsage:m,maximumScreenSpaceError:y};o&&(_.xbsjPosition=o.exportRadianHeightArray(),_.xbsjGuid=o.id),g&&(_.xbsjStyle=g),this.config.shader.default&&(_.xbsjCustomShader=this.config.shader.default),this.instance.xbsjFromJSON(_),this.instance.xbsjGuid=this.id,this.instance._tileset.guid=this.id,isNaN(t.colorBlendMode)||(this.instance._tileset.colorBlendMode=t.colorBlendMode),isNaN(t.colorBlendAmount)||(this.instance._tileset.colorBlendAmount=t.colorBlendAmount),this.instance._tileset.allTilesLoaded.addEventListener((function(){e.emit({type:"allTilesLoaded",data:null})}))},u.a.TilesetModel.prototype=new u.a.Element,u.a.TilesetModel.prototype.type="TilesetModel",r()(u.a.TilesetModel.prototype,u.a.EventManager.prototype),u.a.TilesetModel.prototype.focus=function(){this.instance.flyTo()},u.a.TilesetModel.prototype.applyTag=function(t){this.instance&&(this.instance.tag=t,this.instance._tileset.tag=t,this.instance._tileset.sf3dObject=this,this.instance.sf3dObject=this)},u.a.TilesetModel.prototype.destroy=function(){var t,e;t=this._url,e=this._subdomains,/^.*(\{s\}).*$/.test(t)&&e&&e.length>0&&ra(t,e).forEach((function(t){ia[t]=null,delete ia[t]})),u.a.Element.prototype.destroy.call(this)},u.a.TilesetModel._subdomainMap=ia;u.a.TilesetModel;u.a.WhiteModel=function(t){t=t||{},u.a.TilesetModel.call(this,t);var e=this;this.config={enableEnvMap:{name:"启用环境贴图",type:u.a.PropertyType.Boolean,default:!0},envMapUrl:{name:"环境贴图url",type:u.a.PropertyType.String,default:t.envMapUrl?t.envMapUrl:u.a.RelativePath+"/assets/envmap.jpg"},envMapBlendFactor:{name:"envmap混合度",type:u.a.PropertyType.Float,default:.2},enableFlash:{name:"启用闪烁",type:u.a.PropertyType.Boolean,default:!0},flashFrequency:{name:"闪烁频率",type:u.a.PropertyType.Float,default:120},enableBreath:{name:"启用呼吸",type:u.a.PropertyType.Boolean,default:!0},breathFrequency:{name:"呼吸频率",type:u.a.PropertyType.Float,default:120},enableGradient:{name:"启用渐变",type:u.a.PropertyType.Boolean,default:!0},extraHeight:{name:"额外高度",type:u.a.PropertyType.Float,default:0},heightRange:{name:"高度范围",type:u.a.PropertyType.Float,default:100},glowRange:{name:"发光范围",type:u.a.PropertyType.Float,default:100}};var n=!1!==t.enableEnvMap;Object.defineProperty(this,"enableEnvMap",{get:function(){return n},set:function(t){n=!!t,e.destroy(),d()},enumerable:!0});var i=t.envMapUrl?t.envMapUrl:this.config.envMapUrl.default;Object.defineProperty(this,"envMapUrl",{get:function(){return i},set:function(t){i=t,e.destroy(),d()},enumerable:!0});var r=isNaN(t.envMapBlendFactor)?this.config.envMapBlendFactor.default:t.envMapBlendFactor;Object.defineProperty(this,"envMapBlendFactor",{get:function(){return r},set:function(t){isNaN(t)||(r=t,e.destroy(),d())},enumerable:!0});var o=!1!==t.enableFlash;Object.defineProperty(this,"enableFlash",{get:function(){return o},set:function(t){o=!!t,e.destroy()},enumerable:!0});var s=isNaN(t.flashFrequency)?this.config.flashFrequency.default:t.flashFrequency;Object.defineProperty(this,"flashFrequency",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.destroy(),d())},enumerable:!0});var a=!1!==t.enableBreath;Object.defineProperty(this,"enableBreath",{get:function(){return a},set:function(t){a=!!t,e.destroy(),d()},enumerable:!0});var l=isNaN(t.breathFrequency)?this.config.breathFrequency.default:t.breathFrequency;Object.defineProperty(this,"breathFrequency",{get:function(){return l},set:function(t){isNaN(t)||(l=t,e.destroy(),d())},enumerable:!0});var c=!1!==t.enableGradient;Object.defineProperty(this,"enableGradient",{get:function(){return c},set:function(t){c=!!t,e.destroy(),d()},enumerable:!0});var h=isNaN(t.extraHeight)?this.config.extraHeight.default:t.extraHeight;Object.defineProperty(this,"extraHeight",{get:function(){return h},set:function(t){isNaN(t)||(h=t,e.destroy(),d())},enumerable:!0});var p=isNaN(t.glowRange)?this.config.glowRange.default:t.glowRange;Object.defineProperty(this,"glowRange",{get:function(){return p},set:function(t){isNaN(t)||(p=t,e.destroy(),d())},enumerable:!0});var f=isNaN(t.heightRange)?this.config.heightRange.default:t.heightRange;Object.defineProperty(this,"heightRange",{get:function(){return f},set:function(t){isNaN(t)||(f=t,e.destroy(),d())},enumerable:!0});var d=function(){t.shader={vsHeader:"varying vec3 v_position;",vsBody:"v_position=(czm_model*vec4(a_position,1.0)).xyz;",fsHeader:"\n            //空间坐标转角坐标系\n            varying vec3 v_position;\n                vec3 to_sphere(vec3 P){\n                    float r=sqrt(P.x*P.x+P.y*P.y+P.z*P.z);\n                    // float theta=atan(P.y,(P.x+1E-18));\n                    float theta=acos(P.x/sqrt(r*r-P.z*P.z));\n                    float phi=acos(P.z/r);\n                    return vec3(r,phi,theta);\n                }\n            ",fsBody:"\n                //PI\n                float PI=3.1415926;\n                //混合强度\n                float blend="+r.toFixed(3)+";\n                //基础高度\n                float _baseHeight = 0.0; \n                //高程范围\n                float _heightRange = "+f.toFixed(3)+"; \n                //发光范围\n                float _glowRange = "+p.toFixed(3)+"; \n                //闪烁频次\n                float flash="+s.toFixed(3)+";\n                //呼吸频次\n                float breath="+l.toFixed(3)+";\n                //亮度\n                float brightness="+h.toFixed(3)+";\n                "+(n?"\n                //环境贴图\n        vec3 inVector=v_position-czm_viewerPositionWC;\n        vec3 reflection=normalize(inVector-2.0*dot(inVector,v_normal)*v_normal);\n        vec3 sphereCoord=to_sphere(reflection);\n        gl_FragColor=(1.0-blend)*gl_FragColor+blend*texture2D(u_xbsjCustomTexture,vec2(sphereCoord.z/PI,sphereCoord.y/PI));\n        ":"")+(c?"\n        //渐变特效\n        float vtxf_a11 = "+(a?"fract(czm_frameNumber / breath) * PI * 2.0;":"0.0;")+"\n        float vtxf_a12 = (v_elevationPos.z - _baseHeight+brightness) / _heightRange + sin(vtxf_a11) * 0.1;\n        gl_FragColor *= vec4(vtxf_a12, vtxf_a12, vtxf_a12, 1.0);\n        ":"")+(o?"\n        //闪烁特效\n        float vtxf_a13 = fract(czm_frameNumber / flash);\n        float vtxf_h = clamp((v_elevationPos.z - _baseHeight+brightness) / _glowRange, 0.0, 1.0);\n        vtxf_a13 = abs(vtxf_a13 - 0.5) * 2.0;\n        float vtxf_diff = step(0.005, abs(vtxf_h - vtxf_a13));\n        gl_FragColor.rgb += gl_FragColor.rgb * (1.0 - vtxf_diff);\n        ":"")};var i,d=new u.a.TilesetModel(t);e.instance=d.instance;var y=window._cesium.scene.context;i=Cesium.defined(g.internalFormat)?new Cesium.Texture({context:y,pixelFormat:g.internalFormat,width:g.naturalWidth,height:g.naturalHeight,source:{arrayBufferView:g.bufferView}}):new Cesium.Texture({context:y,source:g}),e.instance.xbsjCustomTexture=i},g=null;Cesium.Resource.createIfNeeded(i).fetchImage().then((function(t){g=t,d()}))},u.a.WhiteModel.prototype=new u.a.Element,u.a.WhiteModel.prototype.type="WhiteModel",u.a.WhiteModel.prototype.focus=function(){this.instance.flyTo()};u.a.WhiteModel;u.a.TerrainModel=function(t){t=t||{},u.a.TilesetModel.call(this,t);var e=this;this.config={lightIntense:{name:"光照强度",type:u.a.PropertyType.Float,default:2},heightRange:{name:"高度范围",type:u.a.PropertyType.Float,default:800},discardHeight:{name:"剪裁高度",type:u.a.PropertyType.Float,default:0},enableNormal:{name:"启用法线光照",type:u.a.PropertyType.Boolean,default:!0}};var n=isNaN(t.lightIntense)?this.config.lightIntense.default:t.lightIntense;Object.defineProperty(this,"lightIntense",{get:function(){return n},set:function(t){isNaN(t)||(n=t,e.destroy(),s())},enumerable:!0});var i=isNaN(t.discardHeight)?this.config.discardHeight.default:t.discardHeight;Object.defineProperty(this,"discardHeight",{get:function(){return i},set:function(t){isNaN(t)||(i=t,e.destroy(),s())},enumerable:!0});var r=isNaN(t.heightRange)?this.config.heightRange.default:t.heightRange;Object.defineProperty(this,"heightRange",{get:function(){return r},set:function(t){isNaN(t)||(r=t,e.destroy(),s())},enumerable:!0});var o=!1!==t.enableNormal;Object.defineProperty(this,"enableNormal",{get:function(){return o},set:function(t){o=!!t||falfse,e.destroy(),s()},enumerable:!0});var s=function(){t.shader={fsBody:"\n                vec4 light=vec4(1.0,1.0,1.0,"+n.toFixed(3)+");\n                if(v_elevationPos.z<=0.1){\n                    gl_FragColor.rgb=vec3(0.1,0.15,0.2);\n                }else {\n                    if(v_elevationPos.z<"+i.toFixed(3)+"){\n                        discard;\n                    }else{\n                        float ratio= (v_elevationPos.z)/"+r.toFixed(3)+";\n                        if (ratio > 1.0 )\n                        ratio = 1.0;\n                        float grn_ratio = ratio;\n                        float red_ratio = ratio * ratio;\n                  \n                        gl_FragColor.rgb +=  red_ratio * vec3(0.9,0.0,0)+ grn_ratio * vec3(0,0.85,0) + vec3(0.1,0.15,0.2);\n                        if("+o+"){\n                            float dotRes=dot(normalize(light.xyz),v_normal);\n                            float angle=acos(dotRes);\n                            gl_FragColor.rgb*=angle/3.1415926*light.a;\n                        }\n                    }\n                }\n        "};var s=new u.a.TilesetModel(t);e.instance=s.instance};s()},u.a.TerrainModel.prototype=new u.a.Element,u.a.TerrainModel.prototype.type="TerrainModel",u.a.TerrainModel.prototype.focus=function(){this.instance.flyTo()};u.a.TerrainModel;u.a.WaterModel=function(t){t=t||{},u.a.TilesetModel.call(this,t);var e=this;this.config={enableEnvMap:{name:"启用环境贴图",type:u.a.PropertyType.Boolean,default:!0},envMapUrl:{name:"环境贴图url",type:u.a.PropertyType.String,default:t.envMapUrl?t.envMapUrl:u.a.RelativePath+"/assets/sky.png"},envMapBlendFactor:{name:"envmap混合度",type:u.a.PropertyType.Float,default:.2},color1:{name:"颜色1",type:u.a.PropertyType.Color,default:new u.a.Color(.4,.6,1)},color2:{name:"颜色2",type:u.a.PropertyType.Color,default:new u.a.Color(.1,.2,1)}};var n=!1!==t.enableEnvMap;Object.defineProperty(this,"enableEnvMap",{get:function(){return n},set:function(t){n=!!t,e.destroy(),a()},enumerable:!0});var i=t.envMapUrl?t.envMapUrl:this.config.envMapUrl.default;Object.defineProperty(this,"envMapUrl",{get:function(){return i},set:function(t){i=t,e.destroy(),a()},enumerable:!0});var r=isNaN(t.envMapBlendFactor)?this.config.envMapBlendFactor.default:t.envMapBlendFactor;Object.defineProperty(this,"envMapBlendFactor",{get:function(){return r},set:function(t){isNaN(t)||(r=t,e.destroy(),a())},enumerable:!0});var o=t.color instanceof u.a.Color?t.color1:this.config.color1.default;Object.defineProperty(this,"color1",{get:function(){return o},set:function(t){t instanceof u.a.Color&&(o=t,e.destroy(),a())},enumerable:!0});var s=t.color2 instanceof u.a.Color?t.color2:this.config.color2.default;Object.defineProperty(this,"color2",{get:function(){return s},set:function(t){t instanceof u.a.Color&&(s=t,e.destroy(),a())},enumerable:!0});var a=function(){var n=o.exportArray(),i=s.exportArray();t.shader={vsHeader:"varying vec3 v_position; ",vsBody:"v_position=(czm_model*vec4(a_position,1.0)).xyz;",fsHeader:"\n            //空间坐标转角坐标系\n            varying vec3 v_position;\n                vec3 to_sphere(vec3 P){\n                    float r=sqrt(P.x*P.x+P.y*P.y+P.z*P.z);\n                    float theta=acos(P.x/sqrt(r*r-P.z*P.z));\n                    float phi=acos(P.z/r);\n                    return vec3(r,phi,theta);\n                }\n                float random(float x) {\n\n                    return fract(sin(x) * 10000.);\n                          \n                }\n                \n                float noise(vec2 p) {\n                \n                    return random(p.x + p.y * 10000.);\n                            \n                }\n                \n                vec2 sw(vec2 p) { return vec2(floor(p.x), floor(p.y)); }\n                vec2 se(vec2 p) { return vec2(ceil(p.x), floor(p.y)); }\n                vec2 nw(vec2 p) { return vec2(floor(p.x), ceil(p.y)); }\n                vec2 ne(vec2 p) { return vec2(ceil(p.x), ceil(p.y)); }\n                \n                float smoothNoise(vec2 p) {\n                \n                    vec2 interp = smoothstep(0., 1., fract(p));\n                    float s = mix(noise(sw(p)), noise(se(p)), interp.x);\n                    float n = mix(noise(nw(p)), noise(ne(p)), interp.x);\n                    return mix(s, n, interp.y);\n                        \n                }\n                \n                float fractalNoise(vec2 p) {\n                \n                    float x = 0.;\n                    x += smoothNoise(p      );\n                    x += smoothNoise(p * 2. ) / 2.;\n                    x += smoothNoise(p * 4. ) / 4.;\n                    x += smoothNoise(p * 8. ) / 8.;\n                    x += smoothNoise(p * 16.) / 16.;\n                    x /= 1. + 1./2. + 1./4. + 1./8. + 1./16.;\n                    return x;\n                            \n                }\n                \n                float movingNoise(vec2 p) {\n                 \n                    float x = fractalNoise(p + czm_frameNumber/50.0);\n                    float y = fractalNoise(p - czm_frameNumber/50.0);\n                    return fractalNoise(p + vec2(x, y));   \n                    \n                }\n                \n                // call this for water noise function\n                float nestedNoise(vec2 p) {\n                    \n                    float x = movingNoise(p);\n                    float y = movingNoise(p + 100.);\n                    return movingNoise(p + vec2(x, y));\n                    \n                }\n            ",fsBody:"\n                vec2 uv = v_texcoord_0;\n                float n = nestedNoise(uv );\n                gl_FragColor = vec4(mix(vec3("+n[0].toFixed(2)+","+n[1].toFixed(2)+","+n[2].toFixed(2)+"), vec3("+i[0].toFixed(2)+","+i[1].toFixed(2)+","+i[2].toFixed(2)+"), n), 1.0);\n                //PI\n                float PI=3.1415926;\n                //混合强度\n                float blend="+r.toFixed(3)+";\n                \n               \n        vec3 inVector=v_position-czm_viewerPositionWC;\n        vec3 reflection=normalize(inVector-2.0*dot(inVector,v_normal)*v_normal);\n        vec3 sphereCoord=to_sphere(reflection);\n        gl_FragColor=(1.0-blend)*gl_FragColor+blend*texture2D(u_xbsjCustomTexture,vec2(sphereCoord.z/PI,sphereCoord.y/PI));\n        "};var a,c=new u.a.TilesetModel(t);e.instance=c.instance;var h=window._cesium.scene.context;a=Cesium.defined(l.internalFormat)?new Cesium.Texture({context:h,pixelFormat:l.internalFormat,width:l.naturalWidth,height:l.naturalHeight,source:{arrayBufferView:l.bufferView}}):new Cesium.Texture({context:h,source:l}),e.instance.xbsjCustomTexture=a},l=null;Cesium.Resource.createIfNeeded(i).fetchImage().then((function(t){l=t,a()}))},u.a.WaterModel.prototype=new u.a.Element,u.a.WaterModel.prototype.type="WaterModel",u.a.WaterModel.prototype.focus=function(){this.instance.flyTo()};u.a.WaterModel;u.a.VideoProjection=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},url:{name:"路径",type:u.a.PropertyType.String,default:u.a.RelativePath+"assets/video.webm"},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},near:{name:"近平面",type:u.a.PropertyType.Float,default:.1,range:[0,100]},far:{name:"远平面",type:u.a.PropertyType.Float,default:50,range:[0,1e3]},fovV:{name:"水平Fov",type:u.a.PropertyType.Float,default:Math.PI/3,range:[0,180]},fovH:{name:"垂直Fov",type:u.a.PropertyType.Float,default:Math.PI/3,range:[0,180]},heading:{name:"航向角",type:u.a.PropertyType.Float,default:0,range:[-180,180]},pitch:{name:"俯仰角",type:u.a.PropertyType.Float,default:0,range:[-90,90]},roll:{name:"翻滚角度",type:u.a.PropertyType.Float,default:0,range:[-180,180]},showHelper:{name:"显示边框",type:u.a.PropertyType.Boolean,default:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.url?t.url:this.config.url.default;Object.defineProperty(this,"url",{get:function(){return i},set:function(t){t&&(i=t,e.instance.videoUrl=i)},enumerable:!0});var r=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return r},set:function(t){t instanceof u.a.Point3d&&(r=t,e.instance.position=r.exportRadianHeightArray())},enumerable:!0});var o=isNaN(t.near)?this.config.near.default:t.near;Object.defineProperty(this,"near",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.near=o)},enumerable:!0});var s=isNaN(t.far)?this.config.far.default:t.far;Object.defineProperty(this,"far",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.far=s)},enumerable:!0});var a=isNaN(t.fovV)?this.config.fovV.default:t.fovV;Object.defineProperty(this,"fovV",{get:function(){return a},set:function(t){isNaN(t)||(a=Cesium.Math.toRadians(t),e.instance.fovV=a)},enumerable:!0});var l=isNaN(t.fovH)?this.config.fovH.default:t.fovH;Object.defineProperty(this,"fovH",{get:function(){return l},set:function(t){isNaN(t)||(l=Cesium.Math.toRadians(t),e.instance.fovH=l)},enumerable:!0});var c=isNaN(t.heading)?this.config.heading.default:t.heading;Object.defineProperty(this,"heading",{get:function(){return c},set:function(t){isNaN(t)||(c=Cesium.Math.toRadians(t),e.instance.rotation[0]=c)},enumerable:!0});var h=isNaN(t.pitch)?this.config.pitch.default:t.pitch;Object.defineProperty(this,"pitch",{get:function(){return h},set:function(t){isNaN(t)||(h=Cesium.Math.toRadians(t),e.instance.rotation[1]=h)},enumerable:!0});var p=isNaN(t.roll)?this.config.roll.default:t.roll;Object.defineProperty(this,"roll",{get:function(){return p},set:function(t){isNaN(t)||(p=Cesium.Math.toRadians(t),e.instance.rotation[2]=p)},enumerable:!0});var f=!1!==t.showHelper;Object.defineProperty(this,"showHelper",{get:function(){return f},set:function(t){f=!!t,e.instance.showHelper=f},enumerable:!0}),this.instance=new XE.Obj.CameraVideo(I.apply(void 0,arguments)||_earthsdk),this.instance.xbsjFromJSON({show:n,xbsjGuid:r.id,xbsjType:"CameraVideo",videoUrl:i,position:r.exportRadianHeightArray(),rotation:[c,h,p],far:s,near:o,fovV:a,fovH:l,showHelper:f})},u.a.VideoProjection.prototype=new u.a.Element,u.a.VideoProjection.prototype.type="VideoProjection";u.a.VideoProjection;u.a.Viewshed=function(t,e){var n=this;t=t||{},u.a.Element.call(this,t.id);var i=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},twoPostionsEditing:{name:"拖动",type:u.a.PropertyType.Boolean,default:!0},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},near:{name:"近平面",type:u.a.PropertyType.Float,default:.1,range:[0,100]},far:{name:"远平面",type:u.a.PropertyType.Float,default:50,range:[0,1e3]},fovV:{name:"水平Fov",type:u.a.PropertyType.Float,default:Math.PI/3,range:[0,180]},fovH:{name:"垂直Fov",type:u.a.PropertyType.Float,default:Math.PI/3,range:[0,180]},heading:{name:"航向角",type:u.a.PropertyType.Float,default:0,range:[-180,180]},pitch:{name:"俯仰角",type:u.a.PropertyType.Float,default:0,range:[-90,90]},roll:{name:"翻滚角度",type:u.a.PropertyType.Float,default:0,range:[-180,180]},showHelper:{name:"显示边框",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color}};var r=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return r},set:function(t){return r=!!t,i.instance.show=r,!0},enumerable:!0});var o=!1!==t.twoPostionsEditing;Object.defineProperty(this,"twoPostionsEditing",{get:function(){return o},set:function(t){return o=!!t,i.instance.twoPostionsEditing=o,!0},enumerable:!0});var s=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return s},set:function(t){if(t instanceof u.a.Point3d)return s=t,i.instance.position=s.exportRadianHeightArray(),!0},enumerable:!0});var a=isNaN(t.near)?this.config.near.default:t.near;Object.defineProperty(this,"near",{get:function(){return a},set:function(t){if(!isNaN(t))return a=t,i.instance.near=a,!0},enumerable:!0});var l=isNaN(t.far)?this.config.far.default:t.far;Object.defineProperty(this,"far",{get:function(){return l},set:function(t){if(!isNaN(t))return l=t,i.instance.far=l,i.instance.viewDistance=l,!0},enumerable:!0});var c=isNaN(t.fovV)?this.config.fovV.default:t.fovV;Object.defineProperty(this,"fovV",{get:function(){return c},set:function(t){if(!isNaN(t))return c=Cesium.Math.toRadians(t),i.instance.fovV=c,!0},enumerable:!0});var p=isNaN(t.fovH)?this.config.fovH.default:t.fovH;Object.defineProperty(this,"fovH",{get:function(){return p},set:function(t){if(!isNaN(t))return p=Cesium.Math.toRadians(t),i.instance.fovH=p,!0},enumerable:!0});var f=isNaN(t.heading)?this.config.heading.default:t.heading;Object.defineProperty(this,"heading",{get:function(){return f},set:function(t){if(!isNaN(t))return f=Cesium.Math.toRadians(t),i.instance.rotation[0]=f,!0},enumerable:!0});var d=isNaN(t.pitch)?this.config.pitch.default:t.pitch;Object.defineProperty(this,"pitch",{get:function(){return d},set:function(t){if(!isNaN(t))return d=Cesium.Math.toRadians(t),i.instance.rotation[1]=d,!0},enumerable:!0});var g=isNaN(t.roll)?this.config.roll.default:t.roll;Object.defineProperty(this,"roll",{get:function(){return g},set:function(t){if(!isNaN(t))return g=Cesium.Math.toRadians(t),i.instance.rotation[2]=g,!0},enumerable:!0});var y=!1!==t.showHelper;Object.defineProperty(this,"showHelper",{get:function(){return y},set:function(t){return y=!!t,i.instance._viewshed._debugCameraPrimitive.show=y,!0},enumerable:!0});var m=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return m},set:function(t){if(t instanceof u.a.Color)return m=t,i.instance._viewshed._debugCameraPrimitive._lineColor=m.color,!0},enumerable:!0});var _={czmObject:{twoPostionsEditing:!0,positionEditing:!0,rotationEditing:!0,id:s.id,xbsjType:"Viewshed",name:"视域分析",position:s.exportRadianHeightArray(),rotation:[f,d,g],near:a,far:l,fovV:c,fovH:p},enabled:!0};this.instance=new XE.Obj.Viewshed(I.apply(void 0,arguments)||_earthsdk),this.instance.xbsjFromJSON(_),XE.MVVM.watch((function(){var t;s=(t=new u.a.Point3d).fromRadian.apply(t,h()(n.instance.position)),a=n.instance.near,l=n.instance.far,p=Cesium.Math.toDegrees(n.instance.fovH),c=Cesium.Math.toDegrees(n.instance.fovV),"function"==typeof e&&e({position:s.exportLngLatHeightArray(),near:a,far:l,fovV:c,fovH:p})}))},u.a.Viewshed.prototype=new u.a.Element,u.a.Viewshed.prototype.type="Viewshed";u.a.Viewshed;u.a.WaterPolygons=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},color:{name:"基础颜色",type:u.a.PropertyType.Color,default:(new u.a.Color).fromCss("rgba(44,50,132,0.8)")},frequency:{name:"频率",type:u.a.PropertyType.Float,default:500,range:[0,1e3],step:100},height:{name:"高度",type:u.a.PropertyType.Int,default:0,noConfig:!0},speed:{name:"速度",type:u.a.PropertyType.Float,default:.01,range:[0,1],step:.01},clampToGround:{name:"贴地",type:u.a.PropertyType.Boolean,default:!1,noConfig:!0},amplitude:{name:"振幅",type:u.a.PropertyType.Float,default:10,range:[0,100],step:1},traces:{name:"轨迹",type:u.a.PropertyType.Array,default:Array.isArray(t.traces)?t.traces:[],noConfig:!0},normalMap:{name:"法线贴图",type:u.a.PropertyType.String,default:u.a.RelativePath+"assets/water_normal.jpg",noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return i},set:function(t){t instanceof u.a.Color&&(i=t,e.instance.appearance.material.uniforms.baseWaterColor=i.color)},enumerable:!0});var r=!!t.clampToGround;Object.defineProperty(this,"clampToGround",{get:function(){return r},set:function(t){r=!!t},enumerable:!0});var o=isNaN(t.height)?0:t.height;Object.defineProperty(this,"height",{get:function(){return o},set:function(t){isNaN(t)||(o=t)},enumerable:!0});var s=isNaN(t.frequency)?this.config.frequency.default:t.frequency;Object.defineProperty(this,"frequency",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.appearance.material.uniforms.frequency=s)},enumerable:!0});var a=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.appearance.material.uniforms.animationSpeed=a)},enumerable:!0});var l=t.normalMap?t.normalMap:this.config.normalMap.default;Object.defineProperty(this,"normalMap",{get:function(){return l},set:function(t){t&&(l=t,e.instance.appearance.material.uniforms.normalMap=l)},enumerable:!0});var c=isNaN(t.amplitude)?this.config.amplitude.default:t.amplitude;if(Object.defineProperty(this,"amplitude",{get:function(){return c},set:function(t){isNaN(t)||(c=t,e.instance.appearance.material.uniforms.amplitude=c)},enumerable:!0}),this.config.traces.default){var h=[];this.config.traces.default.forEach((function(t){t instanceof u.a.Point3dCollection&&h.push(new Cesium.GeometryInstance({id:t.id,geometry:new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(t.exportCartesianArray()),vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,height:o})}))})),r?(this.instance=new Cesium.GroundPrimitive({show:n,geometryInstances:h,appearance:new Cesium.EllipsoidSurfaceAppearance({aboveGround:!0,material:new Cesium.Material({fabric:{type:"Water",uniforms:{baseWaterColor:i.color,normalMap:l,frequency:s,animationSpeed:a,amplitude:c}}})})}),_cesium.scene.groundPrimitives.add(this.instance)):(this.instance=new Cesium.Primitive({show:n,geometryInstances:h,appearance:new Cesium.EllipsoidSurfaceAppearance({aboveGround:!0,material:new Cesium.Material({fabric:{type:"Water",uniforms:{baseWaterColor:i.color,normalMap:l,frequency:s,animationSpeed:a,amplitude:c}}})})}),_cesium.scene.primitives.add(this.instance))}},u.a.WaterPolygons.prototype=new u.a.Element,u.a.WaterPolygons.prototype.type="WaterPolygons";u.a.WaterPolygons;u.a.WaterWaveCircle=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},radius:{name:"半径",type:u.a.PropertyType.Float,default:10},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},speed:{name:"速度",type:u.a.PropertyType.Float,default:1},waveCount:{name:"波纹数",type:u.a.PropertyType.Int,default:3}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return i},set:function(t){t instanceof u.a.Point3d&&(i=t,e.instance.position.setValue(i.exportCartesian()))},enumerable:!0});var r=isNaN(t.radius)?this.config.radius.default:t.radius;Object.defineProperty(this,"radius",{get:function(){return r},set:function(t){t&&(r=t,e.instance.width=r,e.instance.height=r,e.instance.ellipse.semiMinorAxis=r,e.instance.ellipse.semiMajorAxis=r)},enumerable:!0});var o=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return o},set:function(t){t instanceof u.a.Color&&(o=t,e.instance.ellipse.material.color=o.color)},enumerable:!0});var s=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return s},set:function(t){t&&(s=t,e.instance.ellipse.material.duration=1e3/s)},enumerable:!0});var a=isNaN(t.waveCount)?3:t.waveCount;Object.defineProperty(this,"waveCount",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.ellipse.material.count=a)},enumerable:!0}),this.instance=_cesium.entities.add({position:i.exportCartesian(),id:i.id,ellipse:{semiMinorAxis:r,semiMajorAxis:r,material:new Cesium.CircleWaveMaterialProperty({duration:1e3/s,gradient:0,color:o.color,count:a})}})},u.a.WaterWaveCircle.prototype=new u.a.Element,u.a.WaterWaveCircle.prototype.type="WaterWaveCircle";u.a.WaterWaveCircle;u.a.Particle=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},texture:{name:"纹理",type:u.a.PropertyType.Url,default:u.a.RelativePath+"assets/particle.png"},size:{name:"尺寸",type:u.a.PropertyType.Int,default:25},position:{name:"坐标",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},emissionRate:{name:"生成速率",type:u.a.PropertyType.Float,default:5},speed:{name:"粒子速度",type:u.a.PropertyType.Float,default:1},particleLife:{name:"粒子生命周期",type:u.a.PropertyType.Float,default:5},emitterType:{name:"发射器类型",type:u.a.PropertyType.Dictionary,default:"Sphere",options:[{key:"Sphere",value:"Sphere"},{key:"Box",value:"Box"},{key:"Cone",value:"Cone"},{key:"Circle",value:"Circle"}]},emitterSize:{name:"发射器尺寸",type:u.a.PropertyType.Float,default:5},emitterAngle:{name:"发射器角度",type:u.a.PropertyType.Float,default:0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.texture||this.config.texture.default;Object.defineProperty(this,"texture",{get:function(){return i},set:function(t){t&&(i=t,e.instance.image=i)},enumerable:!0});var r=isNaN(t.size)?this.config.size.default:t.size;Object.defineProperty(this,"size",{get:function(){return r},set:function(t){isNaN(t)||(r=t,e.instance.minimumImageSize=new Cesium.Cartesian2(r,r),e.instance.maximumImageSize=new Cesium.Cartesian2(r,r))},enumerable:!0});var o=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return o},set:function(t){if(t instanceof u.a.Point3d){o=t;var n=new Cesium.Matrix4;e.instance.modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(o.exportCartesian(),void 0,n)}},enumerable:!0});var s=isNaN(t.emissionRate)?this.config.emissionRate.default:t.emissionRate;Object.defineProperty(this,"emissionRate",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.emissionRate=s)},enumerable:!0});var a=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.maximumSpeed=a,e.instance.minimumSpeed=a)},enumerable:!0});var l=isNaN(t.particleLife)?this.config.particleLife.default:t.particleLife;Object.defineProperty(this,"particleLife",{get:function(){return l},set:function(t){isNaN(t)||(l=t,e.instance.maximumParticleLife=l,e.instance.minimumParticleLife=l)},enumerable:!0});var c=t.emitterType?t.emitterType:this.config.emitterType.default;Object.defineProperty(this,"emitterType",{get:function(){return c},set:function(t){c=t,f()},enumerable:!0});var h=isNaN(t.emitterSize)?this.config.emitterSize.default:t.emitterSize;Object.defineProperty(this,"emitterSize",{get:function(){return h},set:function(t){isNaN(t)||(h=t,f())},enumerable:!0});var p=isNaN(t.emitterAngle)?this.config.emitterAngle.default:t.emitterAngle;Object.defineProperty(this,"emitterAngle",{get:function(){return p},set:function(t){isNaN(t)||(p=t,f())},enumerable:!0});var f=function(){switch(c){case"Sphere":e.instance.emitter=new Cesium.SphereEmitter(h);break;case"Box":e.instance.emitter=new Cesium.BoxEmitter(new Cesium.Cartesian3(h,h,h));break;case"Circle":e.instance.emitter=new Cesium.CircleEmitter(h);break;case"Cone":e.instance.emitter=new Cesium.ConeEmitter(Cesium.Math.toRadians(p))}},d=new Cesium.Matrix4,g=null;switch(c){case"Sphere":g=new Cesium.SphereEmitter(h);break;case"Box":g=new Cesium.BoxEmitter(new Cesium.Cartesian3(h,h,h));break;case"Circle":g=new Cesium.CircleEmitter(h);break;case"Cone":g=new Cesium.ConeEmitter(Cesium.Math.toRadians(p))}this.instance=_cesium.scene.primitives.add(new Cesium.ParticleSystem({show:n,image:i,modelMatrix:Cesium.Transforms.eastNorthUpToFixedFrame(o.exportCartesian(),void 0,d),startColor:Cesium.Color.WHITE.withAlpha(1),endColor:Cesium.Color.WHITE.withAlpha(0),startScale:1,endScale:1,lifetime:10,particleLife:l,speed:a,imageSize:new Cesium.Cartesian2(r,r),emissionRate:s,emitter:g})),this.instance.id=o.id},u.a.Particle.prototype=new u.a.Element,u.a.Particle.prototype.type="Particle";u.a.Particle;u.a.Fire=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;e.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},position:{name:"坐标",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},particleLife:{name:"粒子生命周期",type:u.a.PropertyType.Float,default:1},speed:{name:"粒子速度",type:u.a.PropertyType.Float,default:1},size:{name:"尺寸",type:u.a.PropertyType.Int,default:25},emissionRate:{name:"生成速率",type:u.a.PropertyType.Float,default:200}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return i},set:function(t){if(t instanceof u.a.Point3d){i=t;var n=new Cesium.Matrix4;e.instance.modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(i.exportCartesian(),void 0,n)}},enumerable:!0});var r=isNaN(t.particleLife)?this.config.particleLife.default:t.particleLife;Object.defineProperty(this,"particleLife",{get:function(){return r},set:function(t){isNaN(t)||(r=t,e.instance.maximumParticleLife=r,e.instance.minimumParticleLife=r)},enumerable:!0});var o=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.maximumSpeed=o,e.instance.minimumSpeed=o)},enumerable:!0});var s=isNaN(t.size)?this.config.size.default:t.size;Object.defineProperty(this,"size",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.minimumImageSize=new Cesium.Cartesian2(s,s),e.instance.maximumImageSize=new Cesium.Cartesian2(s,s))},enumerable:!0});var a=isNaN(t.emissionRate)?this.config.emissionRate.default:t.emissionRate;Object.defineProperty(this,"emissionRate",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.emissionRate=a)},enumerable:!0});var l=new Cesium.Cartesian3,c=new Cesium.Matrix4;this.instance=_cesium.scene.primitives.add(new Cesium.ParticleSystem({show:n,image:u.a.RelativePath+"assets/fire.png",startColor:Cesium.Color.WHITE.withAlpha(.3),endColor:Cesium.Color.WHITE.withAlpha(0),startScale:1,endScale:3,lifetime:20,particleLife:r,speed:o,imageSize:new Cesium.Cartesian2(s,s),emissionRate:a,emitter:new Cesium.ConeEmitter(Cesium.Math.toRadians(30)),modelMatrix:Cesium.Transforms.eastNorthUpToFixedFrame(i.exportCartesian(),void 0,c),updateCallback:function(t,e){Cesium.Cartesian3.normalize(t.position,l),Cesium.Cartesian3.negate(l,l),Cesium.Cartesian3.multiplyByScalar(l,-5*e,l),Cesium.Cartesian3.add(t.velocity,l,t.velocity)}})),this.instance.id=i.id},u.a.Fire.prototype=new u.a.Element,u.a.Fire.prototype.type="Fire";u.a.Fire;u.a.Smoke=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;e.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},position:{name:"坐标",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},particleLife:{name:"粒子生命周期",type:u.a.PropertyType.Float,default:1},speed:{name:"粒子速度",type:u.a.PropertyType.Float,default:.5},size:{name:"尺寸",type:u.a.PropertyType.Int,default:25},emissionRate:{name:"生成速率",type:u.a.PropertyType.Float,default:100},startColor:{name:"起始颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,1,1,.6)},endColor:{name:"终止颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,1,1,0)}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return i},set:function(t){if(t instanceof u.a.Point3d){i=t;var n=new Cesium.Matrix4;e.instance.modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(i.exportCartesian(),void 0,n)}},enumerable:!0});var r=isNaN(t.particleLife)?this.config.particleLife.default:t.particleLife;Object.defineProperty(this,"particleLife",{get:function(){return r},set:function(t){isNaN(t)||(r=t,e.instance.maximumParticleLife=r,e.instance.minimumParticleLife=r)},enumerable:!0});var o=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.maximumSpeed=o,e.instance.minimumSpeed=o)},enumerable:!0});var s=isNaN(t.size)?this.config.size.default:t.size;Object.defineProperty(this,"size",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.minimumImageSize=new Cesium.Cartesian2(s,s),e.instance.maximumImageSize=new Cesium.Cartesian2(s,s))},enumerable:!0});var a=isNaN(t.emissionRate)?this.config.emissionRate.default:t.emissionRate;Object.defineProperty(this,"emissionRate",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.emissionRate=a)},enumerable:!0});var l=t.startColor instanceof u.a.Color?t.startColor:this.config.startColor.default;Object.defineProperty(this,"startColor",{get:function(){return l},set:function(t){t instanceof u.a.Color&&(l=t,this.instance&&(this.instance.startColor=new(Function.prototype.bind.apply(Cesium.Color,[null].concat(h()(l.exportArray()))))))},enumerable:!0});var c=t.endColor instanceof u.a.Color?t.endColor:this.config.endColor.default;Object.defineProperty(this,"endColor",{get:function(){return c},set:function(t){t instanceof u.a.Color&&(c=t,this.instance&&(this.instance.endColor=new(Function.prototype.bind.apply(Cesium.Color,[null].concat(h()(c.exportArray()))))))},enumerable:!0});var p=new Cesium.Cartesian3,f=new Cesium.Matrix4;this.instance=_cesium.scene.primitives.add(new Cesium.ParticleSystem({show:n,image:u.a.RelativePath+"assets/smoke.png",startColor:new(Function.prototype.bind.apply(Cesium.Color,[null].concat(h()(l.exportArray())))),endColor:new(Function.prototype.bind.apply(Cesium.Color,[null].concat(h()(c.exportArray())))),startScale:1,endScale:3,lifetime:20,particleLife:r,speed:o,imageSize:new Cesium.Cartesian2(s,s),emissionRate:a,emitter:new Cesium.SphereEmitter(.1),modelMatrix:Cesium.Transforms.eastNorthUpToFixedFrame(i.exportCartesian(),void 0,f),updateCallback:function(t,e){Cesium.Cartesian3.normalize(t.position,p),Cesium.Cartesian3.negate(p,p),Cesium.Cartesian3.multiplyByScalar(p,-5*e,p),Cesium.Cartesian3.add(t.velocity,p,t.velocity)}})),this.instance.id=i.id},u.a.Smoke.prototype=new u.a.Element,u.a.Smoke.prototype.type="Smoke";u.a.Smoke;u.a.FlowCorridor=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},texture:{name:"纹理",type:u.a.PropertyType.String,default:u.a.RelativePath+"assets/flow.png"},cw:{name:"顺时针",type:u.a.PropertyType.Boolean,default:!0},width:{name:"宽度",type:u.a.PropertyType.Float,default:isNaN(t.width)?100:t.width,noConfig:!0},height:{name:"高度",type:u.a.PropertyType.Float,default:isNaN(t.height)?100:t.height},speed:{name:"速度",type:u.a.PropertyType.Float,default:1},repeat:{name:"重复",type:u.a.PropertyType.Float,default:1},traces:{name:"轨迹",type:u.a.PropertyType.Array,default:Array.isArray(t.traces)?t.traces:[],noConfig:!0},horizontal:{name:"水平流动",type:u.a.PropertyType.Boolean,default:!0},allowPicking:{name:"是否允许拾取",type:u.a.PropertyType.Boolean,default:!1!==t.allowPicking,noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=!1!==t.horizontal;Object.defineProperty(this,"horizontal",{get:function(){return i},set:function(t){i=!!t,e.instance.appearance.material.uniforms.horizontal=i},enumerable:!0});var r=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return r},set:function(t){t instanceof u.a.Color&&(r=t,e.instance.appearance.material.uniforms.color=r.color)},enumerable:!0});var o=t.texture?t.texture:this.config.texture.default;Object.defineProperty(this,"texture",{get:function(){return o},set:function(t){o=t,e.instance.appearance.material.uniforms.image=o},enumerable:!0});var s=!1!==t.cw;Object.defineProperty(this,"cw",{get:function(){return s},set:function(t){s=!!t,e.instance.appearance.material.uniforms.cw=s},enumerable:!0});var a=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.appearance.material.uniforms.speed=a)},enumerable:!0});var l=isNaN(t.repeat)?this.config.repeat.default:t.repeat;Object.defineProperty(this,"repeat",{get:function(){return l},set:function(t){isNaN(t)||(l=t,e.instance.appearance.material.uniforms.repeat=l)},enumerable:!0});var c=Cesium.Material.fromType("PolylineTrailLink");c.uniforms.image=o,c.uniforms.color=r.color,c.uniforms.cw=s,c.uniforms.speed=a,c.uniforms.repeat=l;var h=new Cesium.EllipsoidSurfaceAppearance({material:c}),p=[];e.config.traces.default.forEach((function(t){var n={positions:t.exportCartesianArray(),width:e.config.width.default,height:e.config.height.default,cornerType:Cesium.CornerType.MITERED};p.push(new Cesium.GeometryInstance({id:t.id,geometry:new Cesium.CorridorGeometry(n)}))})),this.instance=_cesium.scene.primitives.add(new Cesium.Primitive({geometryInstances:p,appearance:h,allowPicking:e.config.allowPicking.default}))},u.a.FlowCorridor.prototype=new u.a.Element,u.a.FlowCorridor.prototype.type="FlowCorridor";u.a.FlowCorridor;u.a.FlowPolyLine=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},texture:{name:"纹理",type:u.a.PropertyType.String,default:u.a.RelativePath+"assets/flow.png"},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color},width:{name:"宽度",type:u.a.PropertyType.Float,default:10,noConfig:!0},repeat:{name:"纹理重复次数",type:u.a.PropertyType.Int,default:1},speed:{name:"速度",type:u.a.PropertyType.Float,default:1},cw:{name:"顺时针",type:u.a.PropertyType.Boolean,default:!0},clampToGround:{name:"贴地",type:u.a.PropertyType.Boolean,default:!1,noConfig:!0},traces:{name:"轨迹",type:u.a.PropertyType.Array,default:Array.isArray(t.traces)?t.traces:[],noConfig:!0},allowPicking:{name:"是否允许拾取",type:u.a.PropertyType.Boolean,default:!1!==t.allowPicking,noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.texture?t.texture:this.config.texture.default;Object.defineProperty(this,"texture",{get:function(){return i},set:function(t){i=t,e.instance.appearance.material.uniforms.image=i},enumerable:!0});var r=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return r},set:function(t){t instanceof u.a.Color&&(r=t,e.instance.appearance.material.uniforms.color=r.color)},enumerable:!0});var o=isNaN(t.width)?this.config.width.default:t.width;Object.defineProperty(this,"width",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.polyline.width=o)},enumerable:!0});var s=isNaN(t.repeat)?this.config.repeat.default:t.repeat;Object.defineProperty(this,"repeat",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.appearance.material.uniforms.repeat=s)},enumerable:!0});var a=isNaN(t.speed)?this.config.speed.default:t.speed;Object.defineProperty(this,"speed",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.appearance.material.uniforms.speed=a)},enumerable:!0});var l=!1!==t.cw;Object.defineProperty(this,"cw",{get:function(){return l},set:function(t){l=!!t,e.instance.appearance.material.uniforms.cw=l},enumerable:!0});var c=!!t.clampToGround;Object.defineProperty(this,"clampToGround",{get:function(){return c},set:function(t){c=!!t,e.instance.polyline.clampToGround=c},enumerable:!0});var h=Cesium.Material.fromType("PolylineTrailLink");h.uniforms.image=i,h.uniforms.color=r.color,h.uniforms.cw=l,h.uniforms.speed=a,h.uniforms.repeat=s;var p=new Cesium.PolylineMaterialAppearance({material:h}),f=[];e.config.traces.default.forEach((function(t){var e={positions:t.exportCartesianArray(),width:o};f.push(new Cesium.GeometryInstance({id:t.id,geometry:c?new Cesium.GroundPolylineGeometry(e):new Cesium.PolylineGeometry(e)}))})),this.instance=c?_cesium.scene.groundPrimitives.add(new Cesium.GroundPolylinePrimitive({geometryInstances:f,appearance:p,allowPicking:e.config.allowPicking.default})):_cesium.scene.primitives.add(new Cesium.Primitive({geometryInstances:f,appearance:p,allowPicking:e.config.allowPicking.default}))},u.a.FlowPolyLine.prototype=new u.a.Element,u.a.FlowPolyLine.prototype.type="FlowPolyLine";u.a.FlowPolyLine;u.a.DomMarker=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this,n=e.map3d=E.apply(void 0,arguments)||_sf3d;e.instance=[],this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},offsetX:{name:"横向偏移",type:u.a.PropertyType.Int,default:0},offsetY:{name:"纵向偏移",type:u.a.PropertyType.Int,default:0},position:{name:"坐标",type:u.a.PropertyType.Position,default:t.position instanceof u.a.Point3d?t.position:new u.a.Point3d,noConfig:!0},near:{name:"近阈值",type:u.a.PropertyType.Float,default:100},nearScale:{name:"近缩放比例",type:u.a.PropertyType.Float,default:1},far:{name:"远阈值",type:u.a.PropertyType.Float,default:1e4},farScale:{name:"远缩放比例",type:u.a.PropertyType.Float,default:0}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,e.instance.show=i},enumerable:!0});var r=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return r},set:function(t){t instanceof u.a.Point3d&&(r=t,e.instance.xyz=r)},enumerable:!0});var o=isNaN(t.offsetX)?this.config.offsetX.default:t.offsetX;Object.defineProperty(this,"offsetX",{get:function(){return o},set:function(t){isNaN(t)||(o=t,e.instance.offset=[o,s])},enumerable:!0});var s=isNaN(t.offsetY)?this.config.offsetY.default:t.offsetY;Object.defineProperty(this,"offsetY",{get:function(){return s},set:function(t){isNaN(t)||(s=t,e.instance.offset=[o,s])},enumerable:!0});var a=isNaN(t.near)?this.config.near.default:t.near;Object.defineProperty(this,"near",{get:function(){return a},set:function(t){isNaN(t)||(a=t,e.instance.near=a)},enumerable:!0});var l=isNaN(t.nearScale)?this.config.nearScale.default:t.nearScale;Object.defineProperty(this,"nearScale",{get:function(){return l},set:function(t){isNaN(t)||(l=t,e.instance.nearScale=_nearScaler)},enumerable:!0});var c=isNaN(t.far)?this.config.far.default:t.far;Object.defineProperty(this,"far",{get:function(){return c},set:function(t){isNaN(t)||(c=t,e.instance.far=c)},enumerable:!0});var h=isNaN(t.farScale)?this.config.farScale.default:t.farScale;Object.defineProperty(this,"farScale",{get:function(){return h},set:function(t){isNaN(t)||(h=t,e.instance.farScale=h)},enumerable:!0}),this.independent=!!t.independent,this.instance=t.dom?t.dom:document.createElement("div"),this.instance.style.position="absolute",this.instance.style.transformOrigin=-o+"px "+-s+"px",this.instance.xyz=t.position,this.instance.id=t.position.id,this.instance.show=i,this.instance.offset=[o,s],this.instance.near=a,this.instance.far=c,this.instance.nearScale=l,this.instance.farScale=h;var p=this.instance.style.transform||"";/^.*(translate\([^\)]*\)).*$/.test(p)&&(this.instance.__translate=/^.*(translate\([^\)]*\)).*$/.exec(p)[1]),n.domMarkerManager.add(this.instance,this.independent)},u.a.DomMarker.prototype=new u.a.Element,u.a.DomMarker.prototype.type="DomMarker",u.a.DomMarker.prototype.destroy=function(){this.map3d&&this.map3d.domMarkerManager.remove(this.instance.id,this.independent),this.map3d=null};u.a.DomMarker;u.a.ExtrudedPolygons=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,0,0,1)},translucent:{name:"透明启用",type:u.a.PropertyType.Boolean,default:!1},classify:{name:"classify",type:u.a.PropertyType.Boolean,default:!1,noConfig:!0},traces:{name:"轨迹",type:u.a.PropertyType.Array,default:Array.isArray(t.traces)?t.traces:[],noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance._instanceIds.forEach((function(t){e.setInstanceVisible(t,n)}))},enumerable:!0});var i=!0===t.translucent;Object.defineProperty(this,"translucent",{get:function(){return i},set:function(t){i=!!t,e.instance.appearance.translucent=i},enumerable:!0});var r=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return r},set:function(t){t instanceof u.a.Color&&(r=t,e.instance._instanceIds.forEach((function(t){e.setInstanceColor(t,r)})))},enumerable:!0});var o=!!t.classify;if(Object.defineProperty(this,"classify",{get:function(){return o},set:function(t){o=!!t},enumerable:!0}),this.config.traces.default)if(o){this.instance=[];var s=[];this.config.traces.default.forEach((function(t){if(t instanceof u.a.Point3dCollection){var i=new Cesium.ClassificationPrimitive({geometryInstances:new Cesium.GeometryInstance({id:t.id,geometry:new Cesium.PolygonGeometry({vertexFormat:Cesium.PerInstanceColorAppearance.VERTEX_FORMAT,polygonHierarchy:new Cesium.PolygonHierarchy(t.exportCartesianArrayWithoutHeight()),extrudedHeight:isNaN(t.maxHeight)?10:t.maxHeight,height:isNaN(t.minHeight)?0:t.minHeight,closeTop:!0,closeBottom:!0}),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(r.color),show:new Cesium.ShowGeometryInstanceAttribute(n)}}),classificationType:Cesium.ClassificationType.CESIUM_3D_TILE});s.push(i.readyPromise),e.instance.push(i)}})),l.a.all(s).then((function(e){t&&"function"==typeof t.callback&&t.callback(e)})),this.instance.forEach((function(t){_cesium.scene.primitives.add(t)}))}else{var a=[];this.config.traces.default.forEach((function(t){t instanceof u.a.Point3dCollection&&a.push(new Cesium.GeometryInstance({id:t.id,geometry:new Cesium.PolygonGeometry({vertexFormat:Cesium.PerInstanceColorAppearance.VERTEX_FORMAT,polygonHierarchy:new Cesium.PolygonHierarchy(t.exportCartesianArrayWithoutHeight()),extrudedHeight:isNaN(t.maxHeight)?10:t.maxHeight,height:isNaN(t.minHeight)?0:t.minHeight,closeTop:!0===t.closeTop,closeBottom:!0===t.closeBottom}),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(r.color),show:new Cesium.ShowGeometryInstanceAttribute(n)}}))})),this.instance=new Cesium.Primitive({geometryInstances:a,appearance:new Cesium.PerInstanceColorAppearance({flat:!1,translucent:i})}),this.instance.readyPromise.then((function(e){t&&"function"==typeof t.callback&&t.callback(e)})),_cesium.scene.primitives.add(this.instance)}},u.a.ExtrudedPolygons.prototype=new u.a.Element,u.a.ExtrudedPolygons.prototype.setInstanceColor=function(t,e){if(e instanceof u.a.Color){var n=null;if((n=Array.isArray(this.instance)?this.instance.find((function(e){return e._primitive._instanceIds[0]==t})):this.instance)&&n.getGeometryInstanceAttributes(t)){var i=e.export255Array(!0);n.getGeometryInstanceAttributes(t).color=i}}},u.a.ExtrudedPolygons.prototype.setInstanceVisible=function(t,e){var n=null;(n=Array.isArray(this.instance)?this.instance.find((function(e){return e._primitive._instanceIds[0]==t})):this.instance).getGeometryInstanceAttributes(t)&&(n.getGeometryInstanceAttributes(t).show=Cesium.ShowGeometryInstanceAttribute.toValue(!!e))},u.a.ExtrudedPolygons.prototype.getInstanceIds=function(){var t=[];return Array.isArray(this.instance)?this.instance.forEach((function(e){t.push(e._primitive._instanceIds[0])})):t=this.instance._instanceIds,t},u.a.ExtrudedPolygons.prototype.getInstanceVisible=function(t){var e=null;return!!(e=Array.isArray(this.instance)?this.instance.find((function(e){return e._primitive._instanceIds[0]==t})):this.instance).getGeometryInstanceAttributes(t)&&!!e.getGeometryInstanceAttributes(t).show[0]},u.a.ExtrudedPolygons.prototype.getInstance=function(t){return Array.isArray(this.instance)?this.instance.find((function(e){return e._primitive._instanceIds[0]==t})):this.instance},u.a.ExtrudedPolygons.prototype.focus=function(t){var e=this;if(Array.isArray(t)||(t=[t]),!(t.length<1)){var n=[],i=null;if(Array.isArray(this.instance)){var r=this.instance.filter((function(e){return t.findIndex((function(t){return t==e._primitive._instanceIds[0]}))>=0})),o=[];r.forEach((function(t){o.push(t._primitive._boundingSpheres[0])})),i=Cesium.BoundingSphere.fromBoundingSpheres(o)}else{this.instance._instanceIds.forEach((function(e,i){t.indexOf(e)>=0&&n.push(i)}));o=[];n.forEach((function(t){o.push(e.instance._instanceBoundingSpheres[t])})),i=Cesium.BoundingSphere.fromBoundingSpheres(o)}return i.radius*=1.4,_sf3d.camera.focusOnSphere({boundingSphere:i,pitch:-30})}},u.a.ExtrudedPolygons.prototype.type="ExtrudedPolygons";u.a.ExtrudedPolygons;var ua=n(118),ca=n.n(ua);u.a.HeatMap=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},width:{name:"canvas宽度",type:u.a.PropertyType.Int,default:isNaN(t.width)?600:t.width,noConfig:!0},blur:{name:"模糊",type:u.a.PropertyType.Float,default:.75},radius:{name:"半径",type:u.a.PropertyType.Float,default:10},minOpacity:{name:"最小透明度",type:u.a.PropertyType.Float,default:0},maxOpacity:{name:"最大透明度",type:u.a.PropertyType.Float,default:.5},minValue:{name:"最小值",type:u.a.PropertyType.Float,default:0},maxValue:{name:"最大值",type:u.a.PropertyType.Float,default:100},gradient:{name:"梯度",type:u.a.PropertyType.Object,default:t.gradient?t.gradient:null,noConfig:!0},trace:{name:"轨迹",type:u.a.PropertyType.Positions,default:new u.a.Point3dCollection,noConfig:!0},offset:{name:"偏移量",type:u.a.PropertyType.Float,default:isNaN(t.offset)?.01:t.offset},data:{name:"数据",type:u.a.PropertyType.Array,default:t.data||[],noConfig:!0},sizeInMeter:{name:"sizeInMeter",type:u.a.PropertyType.Boolean,default:!1!==t.sizeInMeter},maxRadiusFactor:{name:"maxRadiusFactor",type:u.a.PropertyType.Float,default:t.maxRadiusFactor||.2,noConfig:!0},visibleRange:{name:"可见范围",type:u.a.PropertyType.Array,default:t.visibleRange||[0,Number.MAX_VALUE],noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=isNaN(t.blur)?this.config.blur.default:t.blur;Object.defineProperty(this,"blur",{get:function(){return i},set:function(t){isNaN(t)||(i=t,L.configure({blur:i}),g())},enumerable:!0});var r=isNaN(t.radius)?this.config.radius.default:t.radius;Object.defineProperty(this,"radius",{get:function(){return r},set:function(t){isNaN(t)||(r=t,L.configure({radius:r}),N())},enumerable:!0});var o=isNaN(t.minOpacity)?this.config.minOpacity.default:t.minOpacity;Object.defineProperty(this,"minOpacity",{get:function(){return o},set:function(t){isNaN(t)||(o=t,L.configure({minOpacity:o}),g())},enumerable:!0});var s=isNaN(t.maxOpacity)?this.config.maxOpacity.default:t.maxOpacity;Object.defineProperty(this,"maxOpacity",{get:function(){return s},set:function(t){isNaN(t)||(s=t,L.configure({maxOpacity:s}),g())},enumerable:!0});var a=isNaN(t.minValue)?this.config.minValue.default:t.minValue;Object.defineProperty(this,"minValue",{get:function(){return a},set:function(t){isNaN(t)||(a=t,g())},enumerable:!0});var l=isNaN(t.maxValue)?this.config.maxValue.default:t.maxValue;Object.defineProperty(this,"maxValue",{get:function(){return l},set:function(t){isNaN(t)||(l=t,g())},enumerable:!0});var c=t.trace instanceof u.a.Point3dCollection?t.trace:this.config.trace.default;Object.defineProperty(this,"trace",{get:function(){return c},set:function(t){if(t instanceof u.a.Point3dCollection){c=t;var e=[];t.forEach((function(t){var n=t.exportLngLatArray(),i=yt()(n,2),r=i[0],o=i[1];e.push({lon:r,lat:o,value:t.value})})),this.data=e}},enumerable:!0});var p=this.config.data.default;Object.defineProperty(this,"data",{get:function(){return p},set:function(t){Array.isArray(t)&&(p=t,P())},enumerable:!0});var f=this.config.sizeInMeter.default;Object.defineProperty(this,"sizeInMeter",{get:function(){return f},set:function(t){f=!!t,N()}});var d=this.config.visibleRange.default;Object.defineProperty(this,"visibleRange",{get:function(){return[].concat(h()(d))},set:function(t){if(t&&Array.isArray(t)&&(d[0]=t[0],d[1]=t[1],this.instance&&this.instance.rectangle)){var e=new Cesium.DistanceDisplayCondition(d[0],d[1]);this.instance.rectangle.distanceDisplayCondition=new Cesium.ConstantProperty(e)}}});var g=function(){e.instance&&(e.instance.rectangle.material.image=T.children[0])},y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;return Math.max(1,f?t:Math.min(t*S(),E))},_=null,v=1/0,x=1/0,C=-1/0,w=-1/0,E=10,I=1,P=function(){!function(){v=1/0,x=1/0,C=-1/0,w=-1/0;var t=!0,n=!1,i=void 0;try{for(var r,o=m()(p);!(t=(r=o.next()).done);t=!0){var s=r.value,a=s.lon,l=s.lat;s.value;v>a&&(v=a),x>l&&(x=l),C<a&&(C=a),w<l&&(w=l)}}catch(t){n=!0,i=t}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}var u=e.config.offset.default,c=((v-=u)+(C+=u))/2,h=((x-=u)+(w+=u))/2,f=D(v,h,0,C,h,0),d=D(c,x,0,c,w,0);I=d/f,isNaN(I)&&(I=1)}();var t=e.config.width.default,n=Math.floor(e.config.width.default*I);T.style.width=t+"px",T.style.height=n+"px",L._renderer.setDimensions(t,n);var i=e.config.maxRadiusFactor.default;E=Math.min(t*i,n*i),L._store._cfgRadius=y();var r=p||[],o=e.config.width.default,s=Math.floor(e.config.width.default*I),u=C-v,c=w-x,h=[];r.forEach((function(t){var e=t.lon,n=t.lat,i=t.value;h.push({x:Math.floor(o*(e-v)/u),y:Math.floor(s*(w-n)/c),value:isNaN(i)?0:i})})),_=h,e.instance&&e.instance.rectangle.coordinates.setValue(Cesium.Rectangle.fromDegrees(v,x,C,w)),L.setData({max:l,min:a,data:h}),g()},N=function(){L._store._cfgRadius=y(),L.setData({max:l,min:a,data:_}),g()},T=null,L=null;if(p){(T=document.createElement("div")).style.display="none",T.style.width=e.config.width.default+"px",T.style.height=Math.floor(e.config.width.default)+"px",document.body.appendChild(T);var M={container:T,radius:r,maxOpacity:s,minOpacity:o,blur:i};e.config.gradient.default&&(M.gradient=e.config.gradient.default),L=ca.a.create(M),P(),this.instance=window._cesium.entities.add({show:n,rectangle:{coordinates:Cesium.Rectangle.fromDegrees(v,x,C,w),material:new Cesium.ImageMaterialProperty({image:T.children[0],transparent:!0}),distanceDisplayCondition:new(Function.prototype.bind.apply(Cesium.DistanceDisplayCondition,[null].concat(h()(d)))),heightReference:Cesium.HeightReference.CLAMP_TO_GROUND}});var O=r,R=_cesium.scene.camera.changed.addEventListener(b((function(){var t=y();(function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;return Math.abs(t-e)<=n})(t,O,.01)||(O=t,N())}),100));this.destroy=function(){R(),u.a.Element.prototype.destroy.call(this)}}},u.a.HeatMap.prototype=new u.a.Element,u.a.HeatMap.prototype.type="HeatMap";u.a.HeatMap;u.a.HeatMap3d=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},rows:{name:"行数",type:u.a.PropertyType.Int,default:100,noConfig:!0},cols:{name:"列数",type:u.a.PropertyType.Int,default:100,noConfig:!0},border:{name:"边界",type:u.a.PropertyType.Point3dCollection,default:null,noConfig:!0},lineWidth:{name:"线宽",type:u.a.PropertyType.Int,default:1,noConfig:!0},trace:{name:"数据",type:u.a.PropertyType.Point3dCollection,default:null,noConfig:!0},interpolationFactor:{name:"插值因数",type:u.a.PropertyType.Int,default:5,noConfig:!0},baseHeight:{name:"基础高度",type:u.a.PropertyType.Float,default:0,noConfig:!0},heightFactor:{name:"高度系数",type:u.a.PropertyType.Float,default:20,noConfig:!0},colorRange:{name:"颜色范围",type:u.a.PropertyType.Int,default:15,noConfig:!0},opacity:{name:"透明度",type:u.a.PropertyType.Float,default:1,noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.border instanceof u.a.Point3dCollection?t.border:this.config.border.default;Object.defineProperty(this,"border",{get:function(){return i},set:function(t){t instanceof u.a.Point3dCollection&&(i=t)},enumerable:!0});var r=t.trace instanceof u.a.Point3dCollection?t.trace:this.config.trace.default;Object.defineProperty(this,"trace",{get:function(){return r},set:function(t){t instanceof u.a.Point3dCollection&&(r=t)},enumerable:!0});var o=isNaN(t.opacity)?this.config.opacity.default:t.opacity;Object.defineProperty(this,"opacity",{get:function(){return o},set:function(t){isNaN(t)||(o=t)},enumerable:!0});var s=isNaN(t.rows)?this.config.rows.default:t.rows;Object.defineProperty(this,"rows",{get:function(){return s},set:function(t){isNaN(t)||(s=t)},enumerable:!0});var a=isNaN(t.colorRange)?this.config.colorRange.default:t.colorRange;Object.defineProperty(this,"colorRange",{get:function(){return a},set:function(t){isNaN(t)||(a=t)},enumerable:!0});var l=isNaN(t.baseHeight)?this.config.baseHeight.default:t.baseHeight;Object.defineProperty(this,"baseHeight",{get:function(){return l},set:function(t){isNaN(t)||(l=t)},enumerable:!0});var c=isNaN(t.heightFactor)?this.config.heightFactor.default:t.heightFactor;Object.defineProperty(this,"heightFactor",{get:function(){return c},set:function(t){isNaN(t)||(c=t)},enumerable:!0});var h=isNaN(t.interpolationFactor)?this.config.interpolationFactor.default:t.interpolationFactor;Object.defineProperty(this,"interpolationFactor",{get:function(){return h},set:function(t){isNaN(t)||(h=t)},enumerable:!0});var p=isNaN(t.cols)?this.config.cols.default:t.cols;Object.defineProperty(this,"cols",{get:function(){return p},set:function(t){isNaN(t)||(p=t)},enumerable:!0});var f=isNaN(t.lineWidth)?this.config.lineWidth.default:t.lineWidth;Object.defineProperty(this,"lineWidth",{get:function(){return f},set:function(t){isNaN(t)||(f=t)},enumerable:!0});var d=null,g=null,y=null,m=null,_=null,v=null,x=null,C=0,w=0,b=function(t,e){var n=g[0]+e*_,o=g[1]+(s-t)*m,a=function(t){var e=0,n=0;try{r.forEach((function(i){if(i.equal(t))throw t.value;var r=1/Math.pow(i.distanceTo(t),2);n+=r,e+=r*i.value}))}catch(t){return console.warn(t),t}return e/n}((new u.a.Point3d).fromLngLat(n,o)),h=(new u.a.Point3d).fromLngLat(n,o,l+(a-C)*c);return i?i.isPointInside(h)?h:null:h},E=function(){for(var t=[],e=0;e<s;e++){for(var n=[],i=0;i<p;i++)n.push(b(e,i));t.push(n)}return t},I=function(){for(var t=[],e=0;e<s;e++){(i=[]).row=e;for(var n=0;n<p;n++){(r=v[e][n])instanceof u.a.Point3d?(i.push(r),n==p-1&&i.length>=2&&t.push(i)):(i.length>=2&&t.push(i),(i=[]).row=e)}}for(e=0;e<p;e++){var i=[];for(n=0;n<s;n++){var r;(r=v[n][e])instanceof u.a.Point3d?(i.push(r),n==s-1&&i.length>=2&&t.push(i)):(i.length>=2&&t.push(i),i=[])}}console.warn(t);var f=[];return t.forEach((function(t){for(var e=[],n=0;n<t.length;n++)e.push(n);var i=new Cesium.CatmullRomSpline({times:e,points:t.map((function(t){return t.exportCartesian()}))}),r=h,s=new u.a.Point3dCollection;for(n=0;n<t.length;n++)for(var p=0;p<r;p++){var d=n+1/r*p,g=(new u.a.Point3d).fromCartesian(i.evaluate(d)),y=(g.exportLngLatHeightArray()[2]-l)/c+C;g.color=u.a.Util.calcColorByRange(a,parseInt((y-C)/(w-C)*a),o),s.addPoint3d(g)}f.push(s)})),f},P=function(){if(x){var t=[];x.forEach((function(e){var n=[];e.forEach((function(t){n.push(t.color.color)})),t.push(new Cesium.GeometryInstance({geometry:new Cesium.PolylineGeometry({positions:e.exportCartesianArray(),colors:n,colorsPerVertex:!0,vertexFormat:Cesium.PolylineColorAppearance.VERTEX_FORMAT,width:f})}))})),e.instance=_cesium.scene.primitives.add(new Cesium.Primitive({show:n,geometryInstances:t,appearance:new Cesium.PolylineColorAppearance}))}};this.exportStaticData=function(){var t=[];return x.forEach((function(e){var n=[];e.forEach((function(t){var e=t.exportLngLatHeightArray(),i=t.color.exportArray();n.push([e[0],e[1],e[2],i[0],i[1],i[2]])})),t.push(n)})),t},this.importStaticData=function(t){var e=[];t.forEach((function(t){var n=new u.a.Point3dCollection;t.forEach((function(t){var e=(new u.a.Point3d).fromLngLat(t[0],t[1],t[2]),i=new u.a.Color(t[3],t[4],t[5]);e.color=i,n.addPoint3d(e)})),e.push(n)})),x=e,P()},function(){try{d=i?i.getBounds():r.getBounds();var t=[];r.forEach((function(e){t.push(e.value)})),C=Math.min.apply(Math,t),w=Math.max.apply(Math,t),g=d.min.exportLngLatArray(),y=d.max.exportLngLatArray(),m=(y[1]-g[1])/s,_=(y[0]-g[0])/p,v=E(),x=I()}catch(t){}}(),P()},u.a.HeatMap3d.prototype=new u.a.Element,u.a.HeatMap3d.prototype.type="HeatMap3d";u.a.HeatMap3d;var ha=u.a.ClippingPlane=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;e.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!1!==t.show},enabled:{name:"启用",type:u.a.PropertyType.Boolean,default:!1!==t.enabled},position:{name:"位置",type:u.a.PropertyType.Array,default:t.position||[0,0,0],noConfig:!0},rotation:{name:"姿态",type:u.a.PropertyType.Array,default:t.rotation||[0,0,0],noConfig:!0},positionEditing:{name:"启用",type:u.a.PropertyType.Boolean,default:!!t.positionEditing},rotationEditing:{name:"启用",type:u.a.PropertyType.Boolean,default:!!t.rotationEditing}},Object.defineProperty(this,"show",{get:function(){return this.instance.show},set:function(t){this.instance.show=!!t},enumerable:!0}),Object.defineProperty(this,"enabled",{get:function(){return this.instance.enabled},set:function(t){this.instance.enabled=!!t},enumerable:!0}),Object.defineProperty(this,"position",{get:function(){return M(this.instance.position)},set:function(t){t&&Array.isArray(t)&&3==t.length&&(this.instance.position=O(t))},enumerable:!0}),Object.defineProperty(this,"rotation",{get:function(){return T(this.instance.rotation)},set:function(t){t&&Array.isArray(t)&&3==t.length&&(this.instance.rotation=L(t))},enumerable:!0}),Object.defineProperty(this,"positionEditing",{get:function(){return this.instance.positionEditing},set:function(t){this.instance.positionEditing=!!t},enumerable:!0}),Object.defineProperty(this,"rotationEditing",{get:function(){return this.instance.rotationEditing},set:function(t){this.instance.rotationEditing=!!t},enumerable:!0}),Object.defineProperty(this,"guid",{get:function(){return this.instance.guid},enumerable:!0}),this.instance=new XE.Obj.ClippingPlane(I.apply(void 0,arguments)||_earthsdk),this.show=this.config.show.default,this.enabled=this.config.enabled.default,this.position=this.config.position.default,this.rotation=this.config.rotation.default,this.positionEditing=this.config.positionEditing.default,this.rotationEditing=this.config.rotationEditing.default};ha.prototype=new u.a.Element,ha.prototype.type="ClippingPlane";var pa=new Cesium.EllipsoidGeodesic,fa=u.a.ClippingPolygon=function(t){t=t||{},u.a.Element.call(this,t.id);var e=E.apply(void 0,arguments)||_sf3d,n=I.apply(void 0,arguments)||_earthsdk,i=this;i.config={enabled:{name:"启用",type:u.a.PropertyType.Boolean,default:!1!==t.enabled},clipInner:{name:"裁剪内部",type:u.a.PropertyType.Boolean,default:!1!==t.clipInner},minHeight:{name:"底部高程",type:u.a.PropertyType.Float,default:null==t.minHeight?-1/0:t.minHeight},maxHeight:{name:"顶部高程",type:u.a.PropertyType.Float,default:null==t.maxHeight?1/0:t.maxHeight},trace:{name:"位置",type:u.a.PropertyType.Trace,default:t.trace instanceof u.a.Point3dCollection?t.trace:new u.a.Point3dCollection,noConfig:!0}};var r=i.config.enabled.default;Object.defineProperty(this,"enabled",{get:function(){return r},set:function(t){r=!!t,this.instance.forEach((function(t){t.enabled=r}))},enumerable:!0});var o=i.config.clipInner.default;Object.defineProperty(this,"clipInner",{get:function(){return o},set:function(t){o=!!t,c&&h(c)}});var s=i.config.minHeight.default;Object.defineProperty(this,"minHeight",{get:function(){return s},set:function(t){null==t||isNaN(t)||(s=t,h(c))}});var a=i.config.maxHeight.default;Object.defineProperty(this,"maxHeight",{get:function(){return a},set:function(t){null==t||isNaN(t)||(a=t,h(c))}});var c=t.trace instanceof u.a.Point3dCollection?t.trace:this.config.trace.default;Object.defineProperty(this,"trace",{get:function(){return c},set:function(t){t instanceof u.a.Point3dCollection&&h(c=t)},enumerable:!0}),i.instance=[];var h=function(t){for(var e=t.map((function(t){return t.exportCartesian()})),l=0,u=e.length-1;i.instance.length>e.length;){i.instance.pop().destroy()}var c=isFinite(s),h=isFinite(a);if(i.instance.length=e.length+(c?1:0)+(h?1:0),0!==e.length){var f=ga(e);for(o||(f=!f);l<u;l++)i.instance[l]=p(i.instance[l],e[l],e[l+1],f);if(i.instance[u]=p(i.instance[u],e[u],e[0],f),c||h){var d=t.exportCenter().exportRadianHeightArray(),g=u;if(c){g++;var y=i.instance[g];y||((y=new XE.Obj.ClippingPlane(n)).show=!1,y.enabled=r,i.instance[g]=y),y.position=[d[0],d[1],s],y.rotation=[0,o?-Math.PI/2:Math.PI/2,0]}if(h){g++;var m=i.instance[g];m||((m=new XE.Obj.ClippingPlane(n)).show=!1,m.enabled=r,i.instance[g]=m),m.position=[d[0],d[1],a],m.rotation=[0,o?Math.PI/2:-Math.PI/2,0]}}}},p=function(t,e,i,o){return t||((t=new XE.Obj.ClippingPlane(n)).show=!1,t.enabled=r),da(t,e,i,o),t};h(c),this.getClippingIds=function(){return i.instance.map((function(t){return t.guid}))};var f=null;this.stopDraw=function(){e.marktool.off("onPolygonDrawn",f),e.marktool.finish()},this.startDraw=function(t){return new l.a((function(n){e.marktool.off("onPolygonDrawn",f),f=function(r){e.marktool.off("onPolygonDrawn",f),e.marktool.clear(),i.trace=r.data,t&&t.forEach((function(t){t.setClippginPolygon(i)})),n()},e.marktool.on("onPolygonDrawn",f),e.marktool.startDrawPolygon({clampToGround:!0})}))}},da=function(t,e,n,i){var r=Cesium.Cartographic.fromCartesian(e),o=Cesium.Cartographic.fromCartesian(n);i?pa.setEndPoints(o,r):pa.setEndPoints(r,o),t.position=[(r.longitude+o.longitude)/2,(r.latitude+o.latitude)/2,(r.height+o.height)/2],t.rotation=[(pa.startHeading+pa.endHeading)/2,0,0],t._se=[r,o]},ga=function(t){var e=new Cesium.Cartographic,n=[],i=!0,r=!1,o=void 0;try{for(var s,a=m()(t);!(i=(s=a.next()).done);i=!0){var l=s.value;Cesium.Cartographic.fromCartesian(l,null,e),n.push([180*e.longitude/Math.PI,180*e.latitude/Math.PI])}}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return ya(n)},ya=function(t){var e=0,n=1,i=null,r=null,o=t.length-1,s=t;t[0][0]==t[o][0]&&t[0][1]==t[o][1]||(s=t.concat([t[0]]));for(var a=s.length;n<a;)i=r||s[0],e+=((r=s[n])[0]-i[0])*(r[1]+i[1]),n++;return e>0};fa.prototype=new u.a.Element,fa.prototype.type="ClippingPolygon";var ma=fa,_a={meters:6371008.8,metres:6371008.8,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:6371008.8/1852,inches:6371008.8*39.37,yards:6371008.8/1.0936,feet:20902260.511392,radians:1,degrees:6371008.8/111325};function va(t,e,n){if(!Ia(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&Pa(i),r&&Na(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function xa(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ea(t[0])||!Ea(t[1]))throw new Error("coordinates must contain numbers");return va({type:"Point",coordinates:t},e,n)}function Ca(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=_a[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t/n}function wa(t){if(null==t)throw new Error("radians is required");return 180*(t%(2*Math.PI))/Math.PI}function ba(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function Ea(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Ia(t){return!!t&&t.constructor===Object}function Pa(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!Ea(t))throw new Error("bbox must only contain numbers")}))}function Na(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}var Sa=function(t,e,n,i){if(!Ia(i=i||{}))throw new Error("options is invalid");var r=i.units,o=i.properties,s=Xe(t),a=ba(s[0]),l=ba(s[1]),u=ba(n),c=Ca(e,r),h=Math.asin(Math.sin(l)*Math.cos(c)+Math.cos(l)*Math.sin(c)*Math.cos(u));return xa([wa(a+Math.atan2(Math.sin(u)*Math.sin(c)*Math.cos(l),Math.cos(c)-Math.sin(l)*Math.sin(h))),wa(h)],o)},Ta=(u.a.ClippingBox=function(t){var e=this;t=t||{};var n=E.apply(void 0,arguments)||_sf3d,i=(I.apply(void 0,arguments)||_earthsdk,n.viewer),r=this;r.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!1!==t.show},enabled:{name:"启用",type:u.a.PropertyType.Boolean,default:!1!==t.enabled},position:{name:"位置",type:u.a.PropertyType.Array,default:t.position||[0,0,0],noConfig:!0},heading:{name:"朝向角",type:u.a.PropertyType.Float,default:t.heading||0},size:{name:"尺寸",type:u.a.PropertyType.Array,default:t.size instanceof Array?t.size:[100,100],noConfig:!0},minHeight:{name:"底部高程",type:u.a.PropertyType.Float,default:null==t.minHeight?0:t.minHeight},maxHeight:{name:"顶部高程",type:u.a.PropertyType.Float,default:null==t.maxHeight?200:t.maxHeight},clipInner:{name:"裁剪内部",type:u.a.PropertyType.Boolean,default:!!t.clipInner},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,1,1,.5)},lineWidth:{name:"边框线宽",type:u.a.PropertyType.Int,default:null==t.lineWidth||isNaN(t.lineWidth)?1:t.lineWidth},lineColor:{name:"边框线颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,0,0,1)}},Object.defineProperty(this,"show",{get:function(){return this.instance.show},set:function(t){this.instance.show=!!t},enumerable:!0}),Object.defineProperty(this,"enabled",{get:function(){return this._cp.enabled},set:function(t){this._cp.enabled=t},enumerable:!0});var o=this.config.position.default;Object.defineProperty(this,"position",{get:function(){return o},set:function(t){t&&Array.isArray(t)&&3==t.length&&(o=t,g())},enumerable:!0});var s=this.config.heading.default;Object.defineProperty(this,"heading",{get:function(){return s},set:function(t){isNaN(t)||(s=t||0,g())},enumerable:!0});var a=this.config.size.default;Object.defineProperty(this,"size",{get:function(){return a},set:function(t){t&&Array.isArray(t)&&2==t.length&&(a=t,g())},enumerable:!0});var l=r.config.minHeight.default;Object.defineProperty(this,"minHeight",{get:function(){return l},set:function(t){null==t||isNaN(t)||(l=t,this.instance.polygon.height.setValue(l),this._cp.minHeight=l)}});var c=r.config.maxHeight.default;Object.defineProperty(this,"maxHeight",{get:function(){return c},set:function(t){null==t||isNaN(t)||(c=t,this.instance.polygon.extrudedHeight.setValue(c),this._cp.maxHeight=c)}});var h=this.config.clipInner.default;Object.defineProperty(this,"clipInner",{get:function(){return h},set:function(t){h=!!t,this._cp.clipInner=h}});var p=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return p},set:function(t){t instanceof u.a.Color&&(p=t,this.instance.polygon.material.color.setValue(p.color))},enumerable:!0});var f=this.config.lineWidth.default;Object.defineProperty(this,"lineWidth",{get:function(){return f},set:function(t){null==t||isNaN(t)||(f=t,this.instance.polygon.outlineWidth.setValue(f))},enumerable:!0});var d=t.lineColor instanceof u.a.Color?t.lineColor:this.config.lineColor.default;Object.defineProperty(this,"lineColor",{get:function(){return d},set:function(t){t instanceof u.a.Color&&(d=t,this.instance.polygon.outlineColor.setValue(d.color))},enumerable:!0});var g=function(){var t=Ta(o[0],o[1],a[0],a[1],s)||[];e.instance.polygon.hierarchy.setValue(new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArray(t.flat()))),e._cp.trace=(new u.a.Point3dCollection).fromLngLatArray(t.flat())},y=Ta(o[0],o[1],a[0],a[1],s)||[];this.instance=i.entities.add({polygon:{hierarchy:{positions:Cesium.Cartesian3.fromDegreesArray(y.flat())},height:l,extrudedHeight:c,material:p.color,outline:!0,outlineWidth:f,outlineColor:d.color}}),this._cp=new ma({enabled:this.config.enabled.default,clipInner:h,minHeight:l,maxHeight:c,trace:(new u.a.Point3dCollection).fromLngLatArray(y.flat())},n),this.getClippingIds=function(){return r._cp.getClippingIds()},this.destroy=function(){i.entities.remove(this.instance),this.instance=null,this._cp.destroy()}},function(t,e,n,i,r){if(n<=0||i<=0)return null;var o=180*Math.atan2(i,n)/Math.PI,s=Math.sqrt(n*n+i*i)/2;return[La(t,e,90-o+r,s),La(t,e,o-90+r,s),La(t,e,-90-o+r,s),La(t,e,90+o+r,s)]}),La=function(t,e,n,i){var r=Sa(ne([t,e]),.001*i,n);return r&&r.geometry.coordinates||null},Ma=[255,255,255],Oa=u.a.GeologyDrilling=function(t){t=t||{},u.a.Element.call(this,t.id),this.viewer=P.apply(void 0,arguments)||_cesium;var e=this;this.create=function(t,n){if(!t)return 0;var i=n.legend,r=[],o=180,s=90,a=-180,l=-90,c=-100,p=!0,f=!1,d=void 0;try{for(var g,y=m()(t.entries());!(p=(g=y.next()).done);p=!0){var _=g.value,v=yt()(_,2),x=(v[0],v[1]);if(x.position){var C=yt()(x.position,3),w=C[0],b=C[1],E=C[2],I=x.radius,P=x.layers,N=E,S=!0,T=!1,L=void 0;try{for(var M,O=m()(P);!(S=(M=O.next()).done);S=!0){var R=M.value,A=R.key,D=(R.name,R.height),F=new Cesium.CylinderGeometry({length:D,topRadius:I,bottomRadius:I,slice:64,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL}),k=N-D/2,B=Ra(i,A).map((function(t){return t/255})),G=new Cesium.GeometryInstance({geometry:F,modelMatrix:Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(w,b,k)),attributes:{color:new(Function.prototype.bind.apply(Cesium.ColorGeometryInstanceAttribute,[null].concat(h()(B),[1])))},id:x});r.push(G),N-=D}}catch(t){T=!0,L=t}finally{try{!S&&O.return&&O.return()}finally{if(T)throw L}}o=Math.min(o,w),a=Math.max(a,w),s=Math.min(s,b),l=Math.max(l,b),c=Math.max(c,E)}}}catch(t){f=!0,d=t}finally{try{!p&&y.return&&y.return()}finally{if(f)throw d}}var j=(o+a)/2,z=(s+l)/2;e.instance=new Cesium.Primitive({geometryInstances:r,appearance:new Cesium.PerInstanceColorAppearance({translucent:!1})}),e.viewer.scene.primitives.add(e.instance),e.position=(new u.a.Point3d).fromLngLat(j,z,c)}};Oa.prototype=new u.a.Element,Oa.prototype.type="GeologyDrilling";var Ra=function(t,e){if(!t)return Ma;var n=t.find((function(t){return t.key===e}));return n?n.color:Ma},Aa=u.a.Plane=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this,n=P.apply(void 0,arguments)||_cesium;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},image:{name:"图片路径",type:u.a.PropertyType.String,default:null},heading:{name:"航向角",type:u.a.PropertyType.Float,default:0},position:{name:"位置",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},width:{name:"宽度",type:u.a.PropertyType.Float,default:24},height:{name:"高度",type:u.a.PropertyType.Float,default:24},sizeInMeter:{name:"sizeInMeter",type:u.a.PropertyType.Boolean,default:!1!==t.sizeInMeter}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){e.instance.show=i=!!t},enumerable:!0});var r=t.image||this.config.image.default;Object.defineProperty(this,"image",{get:function(){return r},set:function(t){r=t,e.instance.plane.material.image.setValue(r)},enumerable:!0});var o=isNaN(t.heading)?this.config.heading.default:t.heading;Object.defineProperty(this,"heading",{get:function(){return o},set:function(t){isNaN(t)||(o=t,h())},enumerable:!0});var s=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return s},set:function(t){t instanceof u.a.Point3d&&(s=t,h())},enumerable:!0});var a=isNaN(t.width)?this.config.width.default:t.width;Object.defineProperty(this,"width",{get:function(){return a},set:function(t){isNaN(t)||(a=t)},enumerable:!0});var l=isNaN(t.height)?this.config.height.default:t.height;Object.defineProperty(this,"height",{get:function(){return l},set:function(t){isNaN(t)||(l=t)},enumerable:!0});var c=this.config.sizeInMeter.default;Object.defineProperty(this,"sizeInMeter",{get:function(){return c},set:function(t){c=!!t}});var h=function(){var t=new Cesium.HeadingPitchRoll(o*Math.PI/180,0,0),n=Cesium.Transforms.headingPitchRollQuaternion(s.exportCartesian(),t);e.instance.orientation.setValue(n)};e.instance=n.entities.add({id:s.id,show:i,position:new Cesium.CallbackProperty((function(){return s.exportCartesian()})),orientation:Cesium.Transforms.headingPitchRollQuaternion(s.exportCartesian(),new Cesium.HeadingPitchRoll(o*Math.PI/180,0,0)),plane:{plane:new Cesium.Plane(new Cesium.Cartesian3(0,0,1),0),dimensions:new Cesium.CallbackProperty((function(){var t=c?1:S()||0;return new Cesium.Cartesian2(a*t||0,l*t||0)})),material:new Cesium.ImageMaterialProperty({image:e.image,transparent:!0})}})};Aa.prototype=new u.a.Element,Aa.prototype.type="Plane";var Da=[[0,[243,179,179]],[.29,[255,128,128]],[.5,[255,112,112]],[.71,[243,84,84]],[.87,[247,55,55]],[.91,[255,0,0]]],Fa=u.a.SlopePolygon=function(t){var e=this;t=t||{},u.a.Element.call(this,t.id);var n=E.apply(void 0,arguments)||_sf3d;I.apply(void 0,arguments)||_earthsdk;this.viewer=n.viewer;var i=this,r=i._em=new V({viewer:n.viewer}),o=null;i.config={lineWidth:{name:"线宽",type:u.a.PropertyType.Int,default:t.lineWidth||10,noConfig:!0},step:{name:"颜色",type:u.a.PropertyType.Array,default:t.step instanceof Array?t.step:Da,noConfig:!0},trace:{name:"位置",type:u.a.PropertyType.Trace,default:t.trace instanceof u.a.Point3dCollection?t.trace:new u.a.Point3dCollection,noConfig:!0},lineAspect:{name:"箭头方向",type:u.a.PropertyType.Boolean,default:!0}};var s=this.config.lineWidth.default;Object.defineProperty(this,"lineWidth",{get:function(){return s},set:function(t){isNaN(t)||(s=t)},enumerable:!0});var a=this.config.trace.default;Object.defineProperty(this,"trace",{get:function(){return a},set:function(t){t instanceof u.a.Point3dCollection&&(a=t)},enumerable:!0});var c=t.hasOwnProperty("lineAspect")?!1!==t.lineAspect:this.config.lineAspect.default;Object.defineProperty(this,"lineAspect",{get:function(){return c},set:function(t){c=1==t},enumerable:!0}),this.clear=function(){d(),ka(this)},this.destroy=function(){n.off("onClickIn",h),n.off("onClickOut",p),this._em&&this._em.destroy(),delete this._em,delete this.viewer},this.update=function(t,e){a&&Ba(this,a.exportCartesianArray(),t,e,this.lineAspect)};var h=function(t){t.data.pickingResult.id&&r.contains(t.data.pickingResult.id)&&(console.log(t),g(t.data.pickingResult.id.exd))},p=function(t){t.data.pickingResult.id&&r.contains(t.data.pickingResult.id)&&d()};n.on("onClickIn",h),n.on("onClickOut",p);var f=null;this.stopDraw=function(){n.marktool.off("onPolygonDrawn",f),n.marktool.finish()},this.startDraw=function(t,i){return new l.a((function(r){n.marktool.off("onPolygonDrawn",f),f=function(o){n.marktool.off("onPolygonDrawn",f),n.marktool.clear(),a=o.data,(null==t||isNaN(t))&&(t=Math.pow(a.getArea(),.5)/20|0),e.update(t,i),r()},n.marktool.on("onPolygonDrawn",f),n.marktool.startDrawPolygon({clampToGround:!0})}))};var d=function(){o&&o.destroy(),o=null},g=function(t){d();var e=document.createElement("div");e.innerHTML=y(t),o=new u.a.DomMarker({position:t.point,dom:e,farScale:1})},y=function(t){var e=Number(t.slope.toFixed(2)),n=Number((180*Math.atan2(t.height,t.distance)/Math.PI).toFixed(1)),i=t.heading;return i<0&&(i+=2*Math.PI),'\n    <div style="padding: 10px;border-radius: 6px;background: rgba(0,0,0,0.5);color: #eee;box-shadow: 3px 3px 3px 0px rgb(0, 0, 0, 0.5);">\n      <div>坡度: '+e+"</div>\n      <div>坡角: "+n+"°</div>\n      <div>坡向: "+Number((180*i/Math.PI).toFixed(1))+"°</div>\n    </div>\n    "}},ka=function(t){t._em&&t._em.clear()},Ba=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments[4];if(e&&!(e.length<3)){n||(n=50);var o=t.viewer,s=e.map((function(t){return t.clone()})),a=Cesium.PolygonGeometry.fromPositions({positions:s,vertexFormat:Cesium.PerInstanceColorAppearance.FLAT_VERTEX_FORMAT,granularity:157e-9*n}),l=Cesium.PolygonGeometry.createGeometry(a),c=l.attributes.position.values,p=l.indices,f=new Cesium.Cartographic;ka(t),t._em.beginAdd();for(var d=0;d<p.length;d+=3){var g,y=p[d],m=p[d+1],_=p[d+2],v=new Cesium.Cartesian3(c[3*y],c[3*y+1],c[3*y+2]);Cesium.Cartographic.fromCartesian(v,null,f);var x=[180*f.longitude/Math.PI,180*f.latitude/Math.PI],C=o.scene.globe.getHeight(f);x.push(C);var w=new Cesium.Cartesian3(c[3*m],c[3*m+1],c[3*m+2]);Cesium.Cartographic.fromCartesian(w,null,f);var b=[180*f.longitude/Math.PI,180*f.latitude/Math.PI],E=o.scene.globe.getHeight(f);b.push(E);var I=new Cesium.Cartesian3(c[3*_],c[3*_+1],c[3*_+2]);Cesium.Cartographic.fromCartesian(I,null,f);var P=[180*f.longitude/Math.PI,180*f.latitude/Math.PI],N=o.scene.globe.getHeight(f);P.push(N);var S=[x,b,P];r?S.sort((function(t,e){return t[2]-e[2]})):S.sort((function(t,e){return e[2]-t[2]}));var T=[S[0],S[2]].flat(),L=S[2][2]-S[0][2];Cesium.Cartesian3.fromDegrees(S[0][0],S[0][1],0,null,v),Cesium.Cartesian3.fromDegrees(S[2][0],S[2][1],0,null,w);var M=Cesium.Cartesian3.distance(v,w),O=L/M,R=qa.apply(void 0,h()(T)),A=(new u.a.Point3d).fromLngLat(S[2][0],S[2][1],S[2][2]),D=Ga(O,t.config.step.default),F=t._em.add({polyline:{positions:Cesium.Cartesian3.fromDegreesArrayHeights(T),width:10,material:new Cesium.PolylineArrowMaterialProperty((g=Cesium.Color).fromBytes.apply(g,h()(D).concat([255]))),clampToGround:!0}});F.exd={height:L,distance:M,slope:O,heading:R,point:A},d+=3*i}t._em.endAdd()}},Ga=function(t,e){for(var n=e.length-1;n>=0;n--){var i=yt()(e[n],2),r=i[0],o=i[1];if(t>=r)return o}return e[0][1]},ja=new Cesium.EllipsoidGeodesic,za=new Cesium.Cartographic,Ua=new Cesium.Cartographic,qa=function(t,e,n,i,r,o){return Cesium.Cartographic.fromDegrees(t,e,n,za),Cesium.Cartographic.fromDegrees(i,r,o,Ua),za&&Ua?(ja.setEndPoints(za,Ua),(ja.startHeading+ja.endHeading)/2):0};Fa.prototype=new u.a.Element,Fa.prototype.type="SlopePolygon";function Va(t,e,n,i,r){var o;return n?((o=Cesium.Material.fromType(Cesium.Material.PolylineOutlineType)).uniforms.color=t.color,o.uniforms.outlineColor=i.color,o.uniforms.outlineWidth=r):(o=Cesium.Material.fromType("Color")).uniforms.color=t.color,o}u.a.TwinkleLine=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.instance=null,this._time=null,this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,1,1,1)},lineWidth:{name:"线宽",type:u.a.PropertyType.Float,default:3,noConfig:!0},outlineEnable:{name:"是否描边",type:u.a.PropertyType.Boolean,default:!1},outlineColor:{name:"描边颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,1,1,1)},outlineWidth:{name:"描边宽度",type:u.a.PropertyType.Float,default:1},twinkleColor:{name:"闪烁颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,1,1,0)},duration:{name:"闪烁持续时长（秒）",type:u.a.PropertyType.Float,default:Ro.a},frequence:{name:"闪烁频率（次每分钟）",type:u.a.PropertyType.Float,default:180},twinkleEffect:{name:"闪烁效果",type:u.a.PropertyType.Dictionary,options:[{key:"跳跃闪烁",value:1},{key:"渐变闪烁",value:2}],default:1},clampToGround:{name:"贴地",type:u.a.PropertyType.Boolean,default:!1,noConfig:!0},traces:{name:"轨迹",type:u.a.PropertyType.Array,default:Array.isArray(t.traces)?t.traces:[],noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance.show=n},enumerable:!0});var i=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return i},set:function(t){t instanceof u.a.Color&&(i=t,e.instance.appearance.material.uniforms.color=i.color,v(i,c))},enumerable:!0});var r=isNaN(t.lineWidth)?this.config.lineWidth.default:parseFloat(t.lineWidth);Object.defineProperty(this,"lineWidth",{get:function(){return r},set:function(t){isNaN(t)||(r=parseFloat(t))},enumerable:!0});var o=!0===t.outlineEnable;Object.defineProperty(this,"outlineEnable",{get:function(){return o},set:function(t){o=!!t,e.instance.appearance.material=Va(i,c,o,s,a)},enumerable:!0});var s=t.outlineColor instanceof u.a.Color?t.outlineColor:this.config.outlineColor.default;Object.defineProperty(this,"outlineColor",{get:function(){return s},set:function(t){t instanceof u.a.Color&&(s=t,o&&(e.instance.appearance.material.uniforms.outlineColor=s.color))},enumerable:!0});var a=isNaN(t.outlineWidth)?this.config.outlineWidth.default:parseFloat(t.outlineWidth);Object.defineProperty(this,"outlineWidth",{get:function(){return a},set:function(t){isNaN(t)||(a=parseFloat(t),o&&(e.instance.appearance.material.uniforms.outlineWidth=a))},enumerable:!0});var l=!!t.clampToGround;Object.defineProperty(this,"clampToGround",{get:function(){return l},set:function(t){l=!!t},enumerable:!0});var c=t.twinkleColor instanceof u.a.Color?t.twinkleColor:this.config.twinkleColor.default;Object.defineProperty(this,"twinkleColor",{get:function(){return c},set:function(t){t instanceof u.a.Color&&v(i,c=t)},enumerable:!0});var h=isNaN(t.duration)?this.config.duration.default:parseFloat(t.duration);Object.defineProperty(this,"duration",{get:function(){return h},set:function(t){isNaN(t)||(h=parseFloat(t),e._time=null)},enumerable:!0});var p=isNaN(t.frequence)?this.config.frequence.default:parseFloat(t.frequence);Object.defineProperty(this,"frequence",{get:function(){return p},set:function(t){isNaN(t)||(p=parseFloat(t),e._time=null)},enumerable:!0});var f=isNaN(t.twinkleEffect)?1:parseInt(t.twinkleEffect);Object.defineProperty(this,"twinkleEffect",{get:function(){return f},set:function(t){isNaN(t)||(f=parseInt(t))},enumerable:!0});var d,g,y,m,_=t.allowPicking||!1;function v(t,n){var i=document.createElement("canvas");i.width=100,i.height=1;var r=i.getContext("2d"),o=r.createLinearGradient(0,0,100,0),s=t.export255Array(),a=n.export255Array();return o.addColorStop(0,"rgba("+s[0]+","+s[1]+","+s[2]+","+t.a+")"),o.addColorStop(1,"rgba("+a[0]+","+a[1]+","+a[2]+","+n.a+")"),r.fillStyle=o,r.fillRect(0,0,100,1),e._texture=i,i}if(e.removeTwinkleListener=null,e._texture=null,this.config.traces.default){var x=(d=this.config.traces.default,g=i,y=r,m=l,d.map((function(t){var e={positions:t.exportCartesianArray(),width:y};return new Cesium.GeometryInstance({id:t.id,geometry:m?new Cesium.GroundPolylineGeometry(e):new Cesium.PolylineGeometry(e),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(g.color),show:new Cesium.ShowGeometryInstanceAttribute(!0)}})}))),C=function(t,e,n,i,r){var o=Va(t,e,n,i,r);return new Cesium.PolylineMaterialAppearance({material:o})}(i,c);x.length>0&&(this.instance=function(t,e,n,i,r){var o=null;i?(o=new Cesium.GroundPolylinePrimitive({geometryInstances:t,appearance:e,show:n,allowPicking:r}),_cesium.scene.groundPrimitives.add(o)):(o=new Cesium.Primitive({geometryInstances:t,appearance:e,show:n,allowPicking:r}),_cesium.scene.primitives.add(o));return o}(x,C,n,l,_),e.removeTwinkleListener&&(e.removeTwinkleListener(),e.removeTwinkleListener=null),e.removeTwinkleListener=_cesium.scene.preUpdate.addEventListener(function(){var t=this.instance.appearance.material;if(null==this._time)return this._time=performance.now(),void(t.uniforms.color=i.color);var e=performance.now()-this._time;if(e/1e3>=h)t.uniforms.color=i.color;else{var n=6e4/p;switch(f){case 1:var r=Math.floor(e/n);t.uniforms.color=[i,c][r%2].color;break;case 2:var o=this._texture;o||(o=v(i,c));var s=e%n/n,a=o.getContext("2d").getImageData(10*Math.floor(10*s),0,1,1).data;t.uniforms.color=new u.a.Color(a[0],a[1],a[2],a[3]/255).color}}}.bind(this)))}},u.a.TwinkleLine.prototype=new u.a.Element,u.a.TwinkleLine.prototype.type="TwinkleLine",u.a.TwinkleLine.prototype.destroy=function(){this.removeTwinkleListener&&(this.removeTwinkleListener(),this.removeTwinkleListener=null),u.a.Element.prototype.destroy.call(this)};u.a.TwinkleLine;u.a.WakeFlame=function(t){var e=this;t=t||{},u.a.Element.call(this,t.id);var n=this;n.viewer=P.apply(void 0,arguments)||_cesium,n.earthsdk=I.apply(void 0,arguments)||_earthsdk,n.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},position:{name:"坐标",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},type:{name:"类型",type:u.a.PropertyType.Float,default:1},rotationEdit:{name:"角度编辑",type:u.a.PropertyType.Boolean,default:!1},positionEdit:{name:"位置编辑",type:u.a.PropertyType.Boolean,default:!1},emissionRate:{name:"生成速率",type:u.a.PropertyType.Float,default:30},particleSize:{name:"粒子尺寸",type:u.a.PropertyType.Int,default:15},particleNumber:{name:"粒子数量",type:u.a.PropertyType.Float,default:100},particleLife:{name:"粒子的存在时间",type:u.a.PropertyType.Float,default:.8},radius:{name:"半径",type:u.a.PropertyType.Float,default:30},rotate:{name:"弧度",type:u.a.PropertyType.Float,default:.01},height:{name:"高度",type:u.a.PropertyType.Float,default:50}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,this.instance&&(this.instance.show=i)},enumerable:!0});var r=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return r},set:function(t){t instanceof u.a.Point3d&&(r=t,this.instance&&(this.instance.position=r.exportRadianHeightArray()))},enumerable:!0});var o=t.type?t.type:this.config.type.default;Object.defineProperty(this,"type",{get:function(){return o},set:function(t){this.instance&&o!==t&&(1===(o=t)?this.instance.toBeCometTail():this.instance.toBeRocketThruster())},enumerable:!0});var s=!!t.rotationEdit;Object.defineProperty(this,"rotationEdit",{get:function(){return s},set:function(t){s=!!t,this.instance&&(this.instance.rotationEditing=s)},enumerable:!0});var a=!!t.positionEdit;Object.defineProperty(this,"positionEdit",{get:function(){return a},set:function(t){a=!!t,this.instance&&(this.instance.positionEditing=a)},enumerable:!0});var l=isNaN(t.emissionRate)?this.config.emissionRate.default:t.emissionRate;Object.defineProperty(this,"emissionRate",{get:function(){return l},set:function(t){l=t,this.instance&&(this.instance.emissionRate=l)},enumerable:!0});var c=isNaN(t.particleSize)?this.config.particleSize.default:t.particleSize;Object.defineProperty(this,"particleSize",{get:function(){return c},set:function(t){c=t,this.instance&&(this.instance.particleSize=c)},enumerable:!0});var h=isNaN(t.particleNumber)?this.config.particleNumber.default:t.particleNumber;Object.defineProperty(this,"particleNumber",{get:function(){return h},set:function(t){h=t,this.instance&&(this.instance.particleNumber=h)},enumerable:!0});var p=isNaN(t.particleLife)?this.config.particleLife.default:t.particleLife;Object.defineProperty(this,"particleLife",{get:function(){return p},set:function(t){p=t,this.instance&&(this.instance.particleLife=p)},enumerable:!0});var f=isNaN(t.radius)?this.config.radius.default:t.radius;Object.defineProperty(this,"radius",{get:function(){return f},set:function(t){f=t,this.instance&&(this.instance.radius=f)},enumerable:!0});var d=isNaN(t.rotate)?this.config.rotate.default:t.rotate;Object.defineProperty(this,"rotate",{get:function(){return d},set:function(t){d=t,this.instance&&(this.instance.rotate=d)},enumerable:!0});var g=isNaN(t.height)?this.config.height.default:t.height;Object.defineProperty(this,"height",{get:function(){return g},set:function(t){g=t,this.instance&&(this.instance.height=g)},enumerable:!0}),u.a.Util.xePlotReady().then((function(){var t={position:r.exportRadianHeightArray(),positionEditing:a,rotationEditing:s,emissionRate:l,particleSize:c,particleNumber:h,particleLife:p,radius:f,rotate:d,height:g},i=new XE.Obj.Plots.ParticleSystemTails(n.earthsdk);i.xbsjFromJSON(t),e.instance=i,e.emit({type:"load",data:null})}))},u.a.WakeFlame.prototype=new u.a.Element,u.a.WakeFlame.prototype.type="WakeFlame",r()(u.a.WakeFlame.prototype,u.a.EventManager.prototype);u.a.WakeFlame;u.a.Fountain=function(t){var e=this;t=t||{},u.a.Element.call(this,t.id);var n=this;n.viewer=P.apply(void 0,arguments)||_cesium,n.earthsdk=I.apply(void 0,arguments)||_earthsdk,n.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},position:{name:"坐标",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},rotationEdit:{name:"角度编辑",type:u.a.PropertyType.Boolean,default:!1},positionEdit:{name:"位置编辑",type:u.a.PropertyType.Boolean,default:!1},texture:{name:"材质",type:u.a.PropertyType.String,default:u.a.RelativePath+"assets/smoke.png",noConfig:!0},emissionRate:{name:"生成速率",type:u.a.PropertyType.Float,default:150},particleSize:{name:"粒子尺寸",type:u.a.PropertyType.Int,default:10},particleLife:{name:"粒子的存在时间",type:u.a.PropertyType.Float,default:2},gravity:{name:"重力加速度",type:u.a.PropertyType.Float,default:-10},minimumSpeed:{name:"粒子的最小初速度",type:u.a.PropertyType.Float,default:15},maximumSpeed:{name:"粒子的最大初速度",type:u.a.PropertyType.Float,default:20},startScale:{name:"粒子的初始比例",type:u.a.PropertyType.Float,default:1},endScale:{name:"粒子的结束比例",type:u.a.PropertyType.Float,default:5}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,this.instance&&(this.instance.show=i)},enumerable:!0});var r=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return r},set:function(t){t instanceof u.a.Point3d&&(r=t,this.instance&&(this.instance.position=r.exportRadianHeightArray()))},enumerable:!0});var o=!!t.rotationEdit;Object.defineProperty(this,"rotationEdit",{get:function(){return o},set:function(t){o=!!t,this.instance&&(this.instance.rotationEditing=o)},enumerable:!0});var s=!!t.positionEdit;Object.defineProperty(this,"positionEdit",{get:function(){return s},set:function(t){s=!!t,this.instance&&(this.instance.positionEditing=s)},enumerable:!0});var a=t.texture?t.texture:this.config.texture.default;Object.defineProperty(this,"texture",{get:function(){return a},set:function(t){a=t,this.instance&&(this.instance.image=a)},enumerable:!0});var l=isNaN(t.emissionRate)?this.config.emissionRate.default:t.emissionRate;Object.defineProperty(this,"emissionRate",{get:function(){return l},set:function(t){l=t,this.instance&&(this.instance.emissionRate=l)},enumerable:!0});var c=isNaN(t.particleSize)?this.config.particleSize.default:t.particleSize;Object.defineProperty(this,"particleSize",{get:function(){return c},set:function(t){c=t,this.instance&&(this.instance.particleSize=c)},enumerable:!0});var h=isNaN(t.particleLife)?this.config.particleLife.default:t.particleLife;Object.defineProperty(this,"particleLife",{get:function(){return h},set:function(t){h=t,this.instance&&(this.instance.particleLife=h)},enumerable:!0});var p=isNaN(t.gravity)?this.config.gravity.default:t.gravity;Object.defineProperty(this,"gravity",{get:function(){return p},set:function(t){p=t,this.instance&&(this.instance.gravity=p)},enumerable:!0});var f=isNaN(t.minimumSpeed)?this.config.minimumSpeed.default:t.minimumSpeed;Object.defineProperty(this,"minimumSpeed",{get:function(){return f},set:function(t){f=t,this.instance&&(this.instance.minimumSpeed=f)},enumerable:!0});var d=isNaN(t.maximumSpeed)?this.config.maximumSpeed.default:t.maximumSpeed;Object.defineProperty(this,"maximumSpeed",{get:function(){return d},set:function(t){d=t,this.instance&&(this.instance.maximumSpeed=d)},enumerable:!0});var g=isNaN(t.startScale)?this.config.startScale.default:t.startScale;Object.defineProperty(this,"startScale",{get:function(){return g},set:function(t){g=t,this.instance&&(this.instance.startScale=g,this.instance._particleSystem.startScale=g)},enumerable:!0});var y=isNaN(t.endScale)?this.config.endScale.default:t.endScale;Object.defineProperty(this,"endScale",{get:function(){return y},set:function(t){y=t,this.instance&&(this.instance.endScale=y,this.instance._particleSystem.endScale=y)},enumerable:!0}),u.a.Util.xePlotReady().then((function(){var t={position:r.exportRadianHeightArray(),positionEditing:s,rotationEditing:o,emitterType:"CircleEmitter",emitterRadius:.1,emitterAngle:1,radiusdisabled:!1,angledisabled:!0,image:a},i=new XE.Obj.Plots.ParticleSystem(n.earthsdk);i.xbsjFromJSON(t),i.toBeFountain(),i.rotation=[0,0,0],i.emissionRate=l,i.particleSize=c,i.gravity=p,i.minimumSpeed=f,i.maximumSpeed=d,i.minimumParticleLife=h,i.maximumParticleLife=h,i.startScale=g,i.endScale=y,i.startColor=[1,1,1,1],i.endColor=[1,1,1,0],e.instance=i,e.emit({type:"load",data:null})}))},u.a.Fountain.prototype=new u.a.Element,u.a.Fountain.prototype.type="Fountain",r()(u.a.Fountain.prototype,u.a.EventManager.prototype);u.a.Fountain;u.a.Explosion=function(t){var e=this;t=t||{},u.a.Element.call(this,t.id);var n=this;n.viewer=P.apply(void 0,arguments)||_cesium,n.earthsdk=I.apply(void 0,arguments)||_earthsdk,n.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},position:{name:"坐标",type:u.a.PropertyType.Position,default:new u.a.Point3d,noConfig:!0},rotationEdit:{name:"角度编辑",type:u.a.PropertyType.Boolean,default:!1},positionEdit:{name:"位置编辑",type:u.a.PropertyType.Boolean,default:!1},texture:{name:"材质",type:u.a.PropertyType.String,default:u.a.RelativePath+"assets/fire.png",noConfig:!0},emissionRate:{name:"生成速率",type:u.a.PropertyType.Float,default:1,noConfig:!0},particleSize:{name:"粒子尺寸",type:u.a.PropertyType.Int,default:80},particleLife:{name:"粒子的存在时间",type:u.a.PropertyType.Float,default:3},minimumSpeed:{name:"粒子的最小初速度",type:u.a.PropertyType.Float,default:0},maximumSpeed:{name:"粒子的最大初速度",type:u.a.PropertyType.Float,default:2},startScale:{name:"粒子的初始比例",type:u.a.PropertyType.Float,default:1,noConfig:!0},endScale:{name:"粒子的结束比例",type:u.a.PropertyType.Float,default:10,noConfig:!0}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,this.instance&&(this.instance.show=i)},enumerable:!0});var r=t.position instanceof u.a.Point3d?t.position:this.config.position.default;Object.defineProperty(this,"position",{get:function(){return r},set:function(t){t instanceof u.a.Point3d&&(r=t,this.instance&&(this.instance.position=r.exportRadianHeightArray()))},enumerable:!0});var o=!!t.rotationEdit;Object.defineProperty(this,"rotationEdit",{get:function(){return o},set:function(t){o=!!t,this.instance&&(this.instance.rotationEditing=o)},enumerable:!0});var s=!!t.positionEdit;Object.defineProperty(this,"positionEdit",{get:function(){return s},set:function(t){s=!!t,this.instance&&(this.instance.positionEditing=s)},enumerable:!0});var a=t.texture?t.texture:this.config.texture.default;Object.defineProperty(this,"texture",{get:function(){return a},set:function(t){a=t,this.instance&&(this.instance.image=a)},enumerable:!0});var l=isNaN(t.emissionRate)?this.config.emissionRate.default:t.emissionRate;Object.defineProperty(this,"emissionRate",{get:function(){return l},set:function(t){l=t,this.instance&&(this.instance.emissionRate=l)},enumerable:!0});var c=isNaN(t.particleSize)?this.config.particleSize.default:t.particleSize;Object.defineProperty(this,"particleSize",{get:function(){return c},set:function(t){c=t,this.instance&&(this.instance.particleSize=c)},enumerable:!0});var h=isNaN(t.particleLife)?this.config.particleLife.default:t.particleLife;Object.defineProperty(this,"particleLife",{get:function(){return h},set:function(t){h=t,this.instance&&(this.instance.particleLife=h)},enumerable:!0});var p=isNaN(t.minimumSpeed)?this.config.minimumSpeed.default:t.minimumSpeed;Object.defineProperty(this,"minimumSpeed",{get:function(){return p},set:function(t){p=t,this.instance&&(this.instance.minimumSpeed=p)},enumerable:!0});var f=isNaN(t.maximumSpeed)?this.config.maximumSpeed.default:t.maximumSpeed;Object.defineProperty(this,"maximumSpeed",{get:function(){return f},set:function(t){f=t,this.instance&&(this.instance.maximumSpeed=f)},enumerable:!0});var d=isNaN(t.startScale)?this.config.startScale.default:t.startScale;Object.defineProperty(this,"startScale",{get:function(){return d},set:function(t){d=t,this.instance&&(this.instance.startScale=d)},enumerable:!0});var g=isNaN(t.endScale)?this.config.endScale.default:t.endScale;Object.defineProperty(this,"endScale",{get:function(){return g},set:function(t){g=t,this.instance&&(this.instance.endScale=g)},enumerable:!0}),u.a.Util.xePlotReady().then((function(){var t={position:r.exportRadianHeightArray(),positionEditing:s,rotationEditing:o,startColor:[1,0,0,1],endColor:[1,1,1,0],radiusdisabled:!1,angledisabled:!0,image:a},i=new XE.Obj.Plots.ParticleSystem(n.earthsdk);i.xbsjFromJSON(t),i.toBeFountain(),i.rotation=[0,0,0],i.emissionRate=l,i.particleSize=c,i.gravity=.2,i.minimumSpeed=p,i.maximumSpeed=f,i.minimumParticleLife=h,i.maximumParticleLife=h,i.startScale=d,i.endScale=g,i.emitterAngle=1,i.startColor=[1,1,1,1],i.endColor=[1,1,1,0],i._particleSystem.bursts=[new Cesium.ParticleBurst({time:1,minimum:20,maximum:40}),new Cesium.ParticleBurst({time:1.5,minimum:40,maximum:80}),new Cesium.ParticleBurst({time:3,minimum:50,maximum:100})],i._particleSystem.lifetime=4,i._particleSystem.emitter=new Cesium.ConeEmitter(Cesium.Math.toRadians(45)),e.instance=i,e.emit({type:"load",data:null})}))},u.a.Explosion.prototype=new u.a.Element,u.a.Explosion.prototype.type="Explosion",r()(u.a.Explosion.prototype,u.a.EventManager.prototype);u.a.Explosion;var Ha={fillStyle:"rgba(55, 50, 250, 0.8)",shadowColor:"rgba(255, 250, 50, 1)",shadowBlur:20,max:100,size:50,label:{show:!0,fillStyle:"white",shadowColor:"yellow",font:"16px Arial",shadowBlur:10},globalAlpha:.5,gradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},draw:"honeycomb"};u.a.HoneyComb=function(t){var e=this;t=t||{},u.a.Element.call(this,t.id);var n=this;n.viewer=P.apply(void 0,arguments)||_cesium,n.earthsdk=I.apply(void 0,arguments)||_earthsdk,this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},data:{name:"数据",type:u.a.PropertyType.Array,default:[],noConfig:!0}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,n.instance&&(i?n.instance.show():n.instance.hide())},enumerable:!0});var r=null,o=null,a=t.data instanceof Array?t.data:this.config.data.default;function l(){r=new u.a.Point3dCollection;var t=[];a&&a.length>0&&(t=a.map((function(t){return r.addPoint3d((new u.a.Point3d).fromLngLat(t.lng,t.lat,t.height||0)),{geometry:{type:"Point",coordinates:[t.lng,t.lat]},count:t.value}}))),null==o?o=new mapv.DataSet(t):o.set(t)}Object.defineProperty(this,"data",{get:function(){return a},set:function(t){a=t,l(),n.instance&&n.instance.update({data:o})},enumerable:!0}),Object.defineProperty(this,"traces",{get:function(){return[r]},enumerable:!0});var c=u.a.Util.DeepProxy(s()({},Ha,t.style||{}),b((function(t,e){e.target,e.key,e.value;n.instance&&n.instance.update({options:h()})}),0)),h=function(){return JSON.parse(bt()(c))};Object.defineProperty(this,"style",{get:function(){return c},enumerable:!0});var p=!1;u.a.Util.mapvReady().then((function(){!0!==e._destroyed&&(l(),p&&e.focus(),n.instance=mapv.cesiumMapLayer(e.viewer,o,h()),!1===i&&n.instance.hide(),e.emit({type:"load",data:null}))})),this._clear=function(){n.instance&&n.instance.destroy(),n.instance=null};var f=void 0;this.focus=function(t){!0===p?(u.a.Element.prototype.focus.call(e,t||f),p=!1):(p=!0,f=s()({},t))},this.destroy=function(){e._clear(),a=null,c=null,r=null,_mapvData=null,e._destroyed=!0}},u.a.HoneyComb.prototype=new u.a.Element,u.a.HoneyComb.prototype.type="HoneyComb",r()(u.a.HoneyComb.prototype,u.a.EventManager.prototype);u.a.HoneyComb;var Ya={fillStyle:"rgba(0, 200, 255, 1.0)",shadowColor:"rgba(0, 200, 255, 1.0)",shadowBlur:0,globalCompositeOperation:"lighter",size:5,draw:"simple"};u.a.Splashes=function(t){var e=this;t=t||{},u.a.Element.call(this,t.id);var n=this;n.viewer=P.apply(void 0,arguments)||_cesium,n.earthsdk=I.apply(void 0,arguments)||_earthsdk,this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},data:{name:"数据",type:u.a.PropertyType.Array,default:[],noConfig:!0}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,n.instance&&(i?n.instance.show():n.instance.hide())},enumerable:!0});var r=null,o=null,a=t.data instanceof Array?t.data:this.config.data.default;function l(){r=new u.a.Point3dCollection;var t=[];a&&a.length>0&&(t=a.map((function(t){return r.addPoint3d((new u.a.Point3d).fromLngLat(t.lng,t.lat,t.height||0)),{geometry:{type:"Point",coordinates:[t.lng,t.lat]},count:t.value}}))),null==o?o=new mapv.DataSet(t):o.set(t)}Object.defineProperty(this,"data",{get:function(){return a},set:function(t){a=t,l(),n.instance&&n.instance.update({data:o})},enumerable:!0}),Object.defineProperty(this,"traces",{get:function(){return[r]},enumerable:!0});var c=u.a.Util.DeepProxy(s()({},Ya,t.style||{}),b((function(t,e){e.target,e.key,e.value;n.instance&&n.instance.update({options:h()})}),0)),h=function(){return JSON.parse(bt()(c))};Object.defineProperty(this,"style",{get:function(){return c},enumerable:!0});var p=!1;u.a.Util.mapvReady().then((function(){!0!==e._destroyed&&(l(),p&&e.focus(),n.instance=mapv.cesiumMapLayer(e.viewer,o,h()),!1===i&&n.instance.hide(),e.emit({type:"load",data:null}))})),this._clear=function(){n.instance&&n.instance.destroy(),n.instance=null};var f=void 0;this.focus=function(t){!0===p?(u.a.Element.prototype.focus.call(e,t||f),p=!1):(p=!0,f=s()({},t))},this.destroy=function(){e._clear(),a=null,c=null,r=null,_mapvData=null,e._destroyed=!0}},u.a.Splashes.prototype=new u.a.Element,u.a.Splashes.prototype.type="Splashes",r()(u.a.Splashes.prototype,u.a.EventManager.prototype);u.a.Splashes;var Xa=n(48),Wa=n.n(Xa),Ka=n(77),Za=n.n(Ka);u.a.WindField=function(t){var e=this;t=t||{},u.a.Element.call(this,t.id);var n=this;n.viewer=P.apply(void 0,arguments)||_cesium,this.instance=null,this._time=null,this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},globalAlpha:{name:"透明度",type:u.a.PropertyType.Float,default:.9},velocityScale:{name:"风速的比例",type:u.a.PropertyType.Float,default:.04},lineWidth:{name:"绘制粒子的线宽",type:u.a.PropertyType.Float,default:1},colorScale:{name:"颜色rgb数组",type:u.a.PropertyType.Array,default:["rgb(36,104, 180)","rgb(60,157, 194)","rgb(128,205,193 )","rgb(151,218,168 )","rgb(198,231,181)","rgb(238,247,217)","rgb(255,238,159)","rgb(252,217,125)","rgb(255,182,100)","rgb(252,150,75)","rgb(250,112,52)","rgb(245,64,32)","rgb(237,45,28)","rgb(220,24,32)","rgb(180,0,35)"],noConfig:!0}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,this.instance&&(!0===i?(!1===this.instance.wind.starting&&this.instance.wind.start(),this.instance.canvas.style.visibility="visible"):(!0===this.instance.wind.starting&&this.instance.wind.stop(),this.instance.canvas.style.visibility="hidden"))},enumerable:!0});var r=isNaN(t.globalAlpha)?this.config.globalAlpha.default:t.globalAlpha;Object.defineProperty(this,"globalAlpha",{get:function(){return r},set:function(t){isNaN(t)||(r=t,n.instance&&n.instance.wind&&n.instance.wind.setOptions(s()({},n.instance.wind.getOptions(),{globalAlpha:r})))},enumerable:!0});var o=isNaN(t.velocityScale)?this.config.velocityScale.default:t.velocityScale;Object.defineProperty(this,"velocityScale",{get:function(){return o},set:function(t){isNaN(t)||(o=t,n.instance&&n.instance.wind&&n.instance.wind.setOptions(s()({},n.instance.wind.getOptions(),{velocityScale:o})))},enumerable:!0});var a=isNaN(t.lineWidth)?this.config.lineWidth.default:t.lineWidth;Object.defineProperty(this,"lineWidth",{get:function(){return a},set:function(t){isNaN(t)||(a=t,n.instance&&n.instance.wind&&n.instance.wind.setOptions(s()({},n.instance.wind.getOptions(),{lineWidth:a})))},enumerable:!0});var c,h=isNaN(t.colorScale)?this.config.colorScale.default:t.colorScale;function p(){return new l.a((function(t,e){if(window.Windy)t(Window.CesiumWind);else{var n=document.createElement("script");n.setAttribute("src",u.a.RelativePath+"thirdparty/misc/cesium-wind.js"),n.setAttribute("type","text/javascript"),document.body.append(n),n.onload=function(){t(window.CesiumWind)}}}))}function f(t){var e,n=this;return new l.a((e=Za()(Wa.a.mark((function e(i,r){var o,s;return Wa.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=10;break}return e.next=3,fetch(t);case 3:return o=e.sent,e.next=6,o.json();case 6:s=e.sent,i(s),e.next=11;break;case 10:i(t);case 11:case"end":return e.stop()}}),e,n)}))),function(t,n){return e.apply(this,arguments)}))}Object.defineProperty(this,"colorScale",{get:function(){return h},set:function(t){isNaN(t)||(h=t,n.instance&&n.instance.wind&&n.instance.wind.setOptions(s()({},n.instance.wind.getOptions(),{colorScale:h})))},enumerable:!0}),p().then((c=Za()(Wa.a.mark((function s(l){var u,c,p;return Wa.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return u=n.viewer,s.next=3,f(t.data);case 3:if(c=s.sent,!0!==e._destroyed){s.next=6;break}return s.abrupt("return");case 6:p={colorScale:h,frameRate:16,maxAge:90,globalAlpha:r,velocityScale:o,paths:2e3,lineWidth:a},n.instance=new l.WindLayer(c,{windOptions:p}),n.instance.addTo(u),!1===i&&(!0===n.instance.wind.starting&&n.instance.wind.stop(),n.instance.canvas.style.visibility="hidden"),e.emit({type:"load",data:null});case 11:case"end":return s.stop()}}),s,e)}))),function(t){return c.apply(this,arguments)}))},u.a.WindField.prototype=new u.a.Element,u.a.WindField.prototype.type="WindField",u.a.WindField.prototype.destroy=function(){this.instance&&this.instance.remove(),this._destroyed=!0,u.a.Element.prototype.destroy.call(this)},r()(u.a.WindField.prototype,u.a.EventManager.prototype);u.a.WindField;u.a.Building3D=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this,n=e.viewer=P.apply(void 0,arguments)||_cesium;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},fill:{name:"是否填充",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,0,0,1)},outline:{name:"是否描边",type:u.a.PropertyType.Boolean,default:!1},outlineColor:{name:"描边颜色",type:u.a.PropertyType.Color,default:new u.a.Color(1,1,0,1)},height:{name:"高度",type:u.a.PropertyType.Float,default:100,noConfig:!0}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,this.dataSource&&(this.dataSource.show=i)},enumerable:!0});var r=!1!==t.fill;Object.defineProperty(this,"fill",{get:function(){return r},set:function(t){r=!!t,this.dataSource&&h(this.dataSource.entities.values)},enumerable:!0});var o=t.color||this.config.color.default;Object.defineProperty(this,"color",{get:function(){return o},set:function(t){t instanceof u.a.Color&&(o=t,this.dataSource&&h(this.dataSource.entities.values))},enumerable:!0});var s=!0===t.outline;Object.defineProperty(this,"outline",{get:function(){return s},set:function(t){s=!!t,this.dataSource&&h(this.dataSource.entities.values)},enumerable:!0});var a=t.outlineColor||this.config.outlineColor.default;Object.defineProperty(this,"outlineColor",{get:function(){return a},set:function(t){t instanceof u.a.Color&&(a=t,this.dataSource&&h(this.dataSource.entities.values))},enumerable:!0});var l=t.height||this.config.height.default;Object.defineProperty(this,"height",{get:function(){return l},set:function(t){"number"==typeof t&&(l=t,this.dataSource&&h(this.dataSource.entities.values))},enumerable:!0});var c={clampToGround:!0};function h(t){var e=o instanceof Function?o:function(){return o},n=a instanceof Function?a:function(){return a},i=l instanceof Function?l:function(){return l};t.forEach((function(t){var o=t.properties;t.tag="bulding3d",t.polygon.fill=r,t.polygon.material=Cesium.Color.fromCssColorString("rgb("+e(o).export255Array().join(",")+")"),t.polygon.extrudedHeight=i(o),t.polygon.outline=s,t.polygon.outlineColor=Cesium.Color.fromCssColorString("rgb("+n(o).export255Array().join(",")+")")}))}this.dataSource=null;var p=Cesium.GeoJsonDataSource.load(t.data,c);p.then((function(t){e.dataSource=t,t.show=i;try{h(t.entities.values)}catch(t){console.error(t)}n.dataSources.add(t),e.emit({type:"load",data:null})}))},u.a.Building3D.prototype=new u.a.Element,u.a.Building3D.prototype.focus=function(){this.dataSource&&this.viewer.zoomTo(this.dataSource.entities)},u.a.Building3D.prototype.destroy=function(){this.dataSource&&(this.viewer.dataSources.remove(this.dataSource),this.dataSource=null),u.a.Element.property.destroy.call(this)},u.a.Building3D.prototype.type="Building3D",r()(u.a.Building3D.prototype,u.a.EventManager.prototype);u.a.Building3D;u.a.TerrainClipping=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this,n=e.viewer=P.apply(void 0,arguments)||_cesium,i=E.apply(void 0,arguments)||_sf3d;this.config={digDepth:{name:"开挖深度",type:u.a.PropertyType.Float,default:5},wallTexture:{name:"墙壁纹理",type:u.a.PropertyType.Url,default:u.a.RelativePath+"assets/dig-wall.jpg"},bottomTexture:{name:"底面纹理",type:u.a.PropertyType.Url,default:u.a.RelativePath+"assets/dig-bottom.jpg"},digType:{name:"开挖类型",type:u.a.PropertyType.Dictionary,options:[{key:"深度开挖",value:1},{key:"底部挖平",value:2}],default:2}},this._sampleRatio=t.sampleRatio||1;var r=t.digDepth?t.digDepth:this.config.digDepth.default;Object.defineProperty(this,"digDepth",{get:function(){return r},set:function(t){isNaN(t)||(r=t,this._points&&this._update(this._points,r))},enumerable:!0});var o=t.wallTexture||this.config.wallTexture.default;Object.defineProperty(this,"wallTexture",{get:function(){return o},set:function(t){o=t,this._wallEntity&&this._wallEntity.wall.material.image.setValue(o)},enumerable:!0});var a=t.bottomTexture||this.config.bottomTexture.default;Object.defineProperty(this,"bottomTexture",{get:function(){return a},set:function(t){a=t,this._wallEntity&&this._bottomEntity.polygon.material.image.setValue(a)},enumerable:!0});var c=t.digType?t.digType:this.config.digType.default;Object.defineProperty(this,"digType",{get:function(){return c},set:function(t){isNaN(t)||1!==(t=Math.floor(parseFloat(t)))&&2!==t||t===c||(c=t,this._points&&this._update(this._points,r))},enumerable:!0});var p=t.lerpRatio||1,f=this,d=null,g=null;this._points=null,this._wallEntity=null,this._bottomEntity=null,this.startDraw=function(t){var e=this;return new l.a((function(o,s){(t=t||{}).calculateVolume=null!=t.calculateVolume&&1==t.calculateVolume,e.clear(),e._depthTestAgainstTerrain=n.scene.globe.depthTestAgainstTerrain,n.scene.globe.depthTestAgainstTerrain=!0,i.marktool.off("onPolygonDrawn",d),d=function(e){g=e.drawId,i.marktool.off("onPolygonDrawn",d),f._points=e.data,f._update(f._points,r,t).then((function(t){o(t)})),i.marktool.removeDrawnResultById(g),g=null},i.marktool.on("onPolygonDrawn",d),i.marktool.startDrawPolygon({clampToGround:!0})}))},this.clear=function(){g&&i.marktool.removeDrawnResultById(g),g=null,this._clearEntities(),n.scene.globe.clippingPlanes=null,f._points=null,n.scene.globe.depthTestAgainstTerrain=!!this._depthTestAgainstTerrain},this._clearEntities=function(){this._wallEntity&&n.entities.remove(this._wallEntity),this._bottomEntity&&n.entities.remove(this._bottomEntity),this._wallEntity=null,this._bottomEntity=null};var y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,i=e.positions,r=e.sampleRatio,o=e.entities,s=(e.minHeights,e.digType),a=e.digDepth,l=0,u=i.exportCartesianArray(),c=[].concat(h()(o)),p=Go(n,u,r,!0,c);if(!p||0==p.items.length)return l;if(1===s)l=p.items.reduce((function(t,e){return t+e.area*a}),0);else{var f=Number.MAX_VALUE;p.items.forEach((function(t){f=Math.min(f,t.height)})),f-=a,l=p.items.reduce((function(t,e){return t+e.area*(e.height-f)}),0)}return l};this._update=function(t,e,i){var r=this;return new l.a((function(o,a){var l=t.points.map((function(t){return t.exportCartesian()})),u=r._createClippingPlanes(l);n.scene.globe.clippingPlanes=u,r._updateBottomAndWall(l,e,t).then((function(n){null!=i&&i.calculateVolume?o(s()({volume:y(s()({},n,{digDepth:e,digType:r._digType,positions:t,sampleRatio:r._sampleRatio}))},n)):o(s()({},n))}))}))},this._createClippingPlanes=function(t){for(var e=t.length,n=t,i=[],r=_(n),o=0;o<e;o++){var s=(o+1)%e,a=n[o],l=n[s],u=Cesium.Cartesian3.midpoint(a,l,new Cesium.Cartesian3),c=Cesium.Cartesian3.normalize(u,new Cesium.Cartesian3),h=Cesium.Cartesian3.subtract(r?a:l,u,new Cesium.Cartesian3),p=Cesium.Cartesian3.cross(h,c,new Cesium.Cartesian3);Cesium.Cartesian3.normalize(p,p);var f=Cesium.Plane.getPointDistance(new Cesium.Plane(p,0),u);i.push(new Cesium.ClippingPlane(p,f))}return new Cesium.ClippingPlaneCollection({planes:i})};var _=function(t){var e=new Cesium.Cartographic,n=[],i=!0,r=!1,o=void 0;try{for(var s,a=m()(t);!(i=(s=a.next()).done);i=!0){var l=s.value;Cesium.Cartographic.fromCartesian(l,null,e),n.push([180*e.longitude/Math.PI,180*e.latitude/Math.PI])}}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return v(n)},v=function(t){var e=0,n=1,i=null,r=null,o=t.length-1,s=t;t[0][0]==t[o][0]&&t[0][1]==t[o][1]||(s=t.concat([t[0]]));for(var a=s.length;n<a;)i=r||s[0],e+=((r=s[n])[0]-i[0])*(r[1]+i[1]),n++;return e>0},x=function(t,e){if(t&&0!=t.length){var n=Cesium.PolylinePipeline.generateArc({positions:t,granularity:e});if(n){for(var i=[],r=0;r<n.length;r+=3)i.push(Cesium.Cartesian3.unpack(n,r));return i}}},C=function(t,e){return new l.a((function(n,i){var r=t.scene.terrainProvider,o=[];if(r instanceof Cesium.CesiumTerrainProvider){for(var s=[],a=0,l=e.length;a<l;a++){var u=e[a];s.push(Cesium.Cartographic.fromCartesian(u))}Cesium.sampleTerrainMostDetailed(r,s).then((function(t){for(var e=0,n=t.length;e<n;++e)o[e]=t[e].height;return o})).then((function(t){n(t)}),(function(t){i(t)}))}else{for(a=0,l=e.length;a<l;a++)o.push(0);n(o)}}))};this._updateBottomAndWall=function(t,e,i){return new l.a((function(r,o){var s=t.length,a=i.exportBoundingSphere(),l=Cesium.Math.RADIANS_PER_DEGREE/111e3*(a.radius/100)/p,u=x(t,l),h=x([t[s-1],t[0]],l),d=u.concat(h).concat(u[0]);console.debug(" lerp granularity & count ",l,d.length),C(n,d).then((function(t){f._clearEntities();var i=new Cesium.Cartographic,o=[],s=[],a=Number.MAX_VALUE,l=d.map((function(e,n){Cesium.Cartographic.fromCartesian(e,null,i);var r=i.clone();return r.height=t[n],a=Math.min(r.height,a),r})),u=void 0;1===c?u=l.map((function(t){return s.push(t.height),o.push(t.height-e),Cesium.Cartesian3.fromRadians(t.longitude,t.latitude,t.height-e)})):(a-=e,u=l.map((function(t){return s.push(t.height),o.push(a),Cesium.Cartesian3.fromRadians(t.longitude,t.latitude,a)}))),f._bottomEntity=n.entities.add({polygon:{hierarchy:new Cesium.CallbackProperty((function(){return{positions:u}}),!1),perPositionHeight:!0,material:f.bottomTexture}}),f._wallEntity=n.entities.add({wall:{positions:u,maximumHeights:s,minimumHeights:o,material:f.wallTexture}}),r({entities:[f._bottomEntity,f._wallEntity],positions:u,maxHeights:s,minHeights:o})})).catch((function(t){return o(t)}))}))},this.destroy=function(){this.clear()}},r()(u.a.TerrainClipping.prototype,u.a.EventManager.prototype);u.a.TerrainClipping;u.a.ITailedLabel=function(t){t=t||{},this._option=t,this._isAdded=!1,this._show=!1!==t.show},j()(u.a.ITailedLabel.prototype,{show:{get:function(){return this._show},set:function(t){this._show!==!!t&&(this._show=!!t,this.onToggleShow(this._show))}}}),u.a.ITailedLabel.prototype.getId=function(){return this._option.id},u.a.ITailedLabel.prototype.isAdded=function(){return this._isAdded},u.a.ITailedLabel.prototype.onAdd=function(t){},u.a.ITailedLabel.prototype.add=function(t){return!1===this._isAdded&&(this.onAdd(t),this._isAdded=!0,!0)},u.a.ITailedLabel.prototype.onRemove=function(t){},u.a.ITailedLabel.prototype.remove=function(t){return!0===this._isAdded&&(this.onRemove(t),this._isAdded=!1,!0)},u.a.ITailedLabel.prototype.onCameraChange=function(t){},u.a.ITailedLabel.prototype.onToggleShow=function(t){},u.a.ITailedLabel.prototype.updateStyle=function(t){},u.a.ITailedLabel.prototype.getElements=function(){},u.a.ITailedLabel.prototype.getBoundingSphere=function(){},u.a.ITailedLabel.prototype.fadeIn=function(){},u.a.ITailedLabel.prototype.fadeOut=function(){},u.a.ITailedLabel.prototype.getFadingState=function(){},u.a.ITailedLabel.prototype.finishFading=function(){},u.a.ITailedLabel.prototype.getType=function(){},u.a.ITailedLabel.prototype.equals=function(t){},u.a.ITailedLabel.prototype.clone=function(){},u.a.ITailedLabel.prototype.destroy=function(){};u.a.ITailedLabel;var Ja={BLOCK:"block"},Qa={NONE:-1,FADING_IN:1,FADING_OUT:2,FADED_IN:11,FADED_OUT:12},$a={fadeOpacity:0,duration:1e3,sizeScale:.3,heading:0,label:{show:!0,fontSize:20,fontFamily:"微软雅黑",padding:[20,10,20,10],color:"rgba(255.0, 255.0, 255.0, 1.0)",background:"#FF0000",textSpacing:5},content:{show:!0,fontSize:16,fontFamily:"微软雅黑",padding:[30,5,30,5],color:"rgba(255.0, 255.0, 255.0, 1.0)",background:"#0A0A0A",textSpacing:5},tail:{show:!0,length:100,width:3},anchor:{show:!0,image:"",sizeInMeters:!0,scale:1,width:30,height:30}},tl={sizeScale:.3,labelContentSpacing:15,minHeightRatio:1.8,facingCamera:!0,fadeInout:{duration:1e3,fadeOpacity:0,pixelThreshold:80,padding:[.2,.05,.05,.05]},label:{show:!0,fontSize:20,fontFamily:"微软雅黑",fontWeight:"normal",padding:[20,10,20,10],color:"rgba(255,255,255,1)",background:"rgb(255,0,0)",textSpacing:5,text:""},content:{show:!0,fontSize:14,fontFamily:"黑体",fontWeight:"normal",padding:[30,5,10,1],color:"rgba(255,255,255,1)",background:"rgba(0, 0, 0, 0.0)",textSpacing:2,text:""},tail:{show:!0,width:3,color:new Cesium.Color(1,1,1,1),gapColor:new Cesium.Color(1,1,1,0),dashLength:8,startColor:new Cesium.Color(1,1,1,1),endColor:new Cesium.Color(1,1,1,.4),drawWithCanvas:!1}};function el(t,e){return t.find((function(t){return t.getId&&t.getId()===e}))}function nl(t,e){return t.findIndex((function(t){return t.getId&&t.getId()===e}))>=0}function il(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n}function rl(t){var e=function(t){var e={size:{width:0,height:0},labelSize:{width:0,height:0,widthArr:[],heightArr:[]},contentSize:{width:0,height:0,widthArr:[],heightArr:[]},contentRenderSize:{width:0,height:0}},n=il(100,100).getContext("2d");n.textAlign="left",n.textBaseline="top";var i=t.label;n.font=i.fontSize+"px "+i.fontFamily,e.labelSize=ol(n,i.text,{padding:i.padding,textSpacing:i.textSpacing});var r=t.content;n.font=r.fontSize+"px "+r.fontFamily,e.contentSize=ol(n,r.text,{padding:r.padding,textSpacing:r.textSpacing});var o=t.heightScaleRange||[1.2,1.4];if(e.contentRenderSize.height=Math.min(Math.max(e.contentSize.height,e.labelSize.height*o[0]),e.labelSize.height*o[1]),e.contentSize.height>e.contentRenderSize.height){var s=Math.ceil(sl(e.contentSize.height,r.padding)/sl(e.contentRenderSize.height,r.padding)),a=al(e.contentSize.width,r.padding);e.contentRenderSize.width=a*s+r.textSpacing*(s-1)+r.padding[1]+r.padding[3],e.contentRenderSize.columnCount=s}else e.contentRenderSize.width=e.contentSize.width;return e.size.width=e.labelSize.width+e.contentRenderSize.width,e.size.height=Math.max(e.labelSize.height,e.contentRenderSize.height),e}(t),n=e.size,i=il(n.width,n.height),r=i.getContext("2d");return t.reverseX&&(r.translate(n.width,0),r.scale(-1,1)),function(t,e){var n=e.reverseX,i=e.estimatedSize,r=e.padding,o=i.contentRenderSize,s=i.labelSize;t.fillStyle=""+e.background;var a=Math.floor((o.height-s.height)/2);!0===n?t.fillRect(o.width,a,s.width,s.height):t.fillRect(0,a,s.width,s.height);t.font=e.fontSize+"px "+e.fontFamily,t.fillStyle=""+e.color,t.textAlign="center",t.textBaseline="top";var l=(!0===n?o.width:0)+r[3]+al(s.width,r)/2,u=a+r[0];e.text.split("").forEach((function(n,i){t.fillText(n,l,u),u+=s.heightArr[i]+e.textSpacing}))}(r,s()({},t.label,{reverseX:t.reverseX,estimatedSize:e})),function(t,e){var n=e.reverseX,i=e.estimatedSize,r=e.padding,o=i.contentSize,s=i.contentRenderSize,a=i.labelSize;t.fillStyle=""+e.background,!0===n?t.fillRect(0,0,s.width,s.height):t.fillRect(a.width,0,s.width,s.height);t.font=e.fontSize+"px "+e.fontFamily,t.fillStyle=""+e.color,t.textAlign="center",t.textBaseline="top";var l=(!0===n?0:a.width)+r[3]+o.maxTextWidth/2,u=s.height>o.height?Math.floor((s.height-o.height)/2)+r[0]:r[0],c=u,h=s.height-r[2];e.text.split("").forEach((function(n,i){c+o.heightArr[i]>=h&&(l+=e.textSpacing+o.maxTextWidth,c=u),t.fillText(n,l,c),c+=o.heightArr[i]+e.textSpacing}))}(r,s()({},t.content,{reverseX:t.reverseX,estimatedSize:e})),t.reverseX&&(r.translate(n.width,0),r.scale(-1,1)),i}function ol(t,e,n){var i={width:0,height:0,widthArr:[],heightArr:[],columnCount:1,maxTextWidth:0,maxTextHeight:0},r=n.padding,o=n.textSpacing,s=e.split("");return s.forEach((function(e){var r=t.measureText(e),o=r.width,s=n.fontSize||r.fontBoundingBoxDescent;i.widthArr.push(o),i.heightArr.push(s),i.maxTextWidth=Math.max(i.maxTextWidth,o),i.maxTextHeight=Math.max(i.maxTextHeight,s),i.height+=s})),i.width=Math.round(i.maxTextWidth+r[1]+r[3]),i.height=Math.round(i.height+o*(s.length-1)+r[0]+r[2]),i}function sl(t,e){return t-e[0]-e[2]}function al(t,e){return t-e[1]-e[3]}function ll(t,e){var n,i=new Cesium.Cartesian3,r=new Cesium.Matrix4,o=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(Cesium.Cartesian3.fromDegrees(t[0],t[1],0),Cesium.Cartesian3.fromDegrees(t[0],t[1],1),i),i),s=Cesium.Cartesian3.multiplyByScalar(o,e||0,i);return Cesium.Matrix4.fromTranslation(s,r),Cesium.Matrix4.multiplyByTranslation(r,(n=Cesium.Cartesian3).fromDegrees.apply(n,h()(t)),r),Cesium.Matrix4.getTranslation(r,i),i}function ul(t,e){return e=e||50/t[0],[t[0]*e,t[1]*e]}function cl(t,e,n){n=n||{};var i=!1,r=t.viewer,o=r.camera,s=r.scene,a=[r.canvas.width,r.canvas.height],l=s.cartesianToCanvasCoordinates(e.center),u=n.padding||new Array(4).fill(0);if(l){var c=[l.x/a[0],l.y/a[1]];if(c[0]<=u[3]||c[0]>=1-u[1]||c[1]<=u[0]||c[1]>=1-u[2])return!1}var h=n.pixelCountThreshold||2,p=n.distance2Camera||o.distanceToBoundingSphere(e),f=o.getPixelSize(e,s.drawingBufferWidth,s.drawingBufferHeight),d=2*e.radius/f;if(p>o.frustum.far||p<0)i=!1;else if(d<h)i=!1;else{var g=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC).computeVisibility(e);g!==Cesium.Intersect.INSIDE&&g!==Cesium.Intersect.INTERSECTING||(i=!0)}return i}u.a.SimpleTailedLabel=function(t){var e,n;e=$a,n=t,t=s()({},e,n,{label:s()({},e.label,n.label),content:s()({},e.content,n.content),tail:s()({},e.tail,n.tail),anchor:s()({},e.anchor,n.anchor)}),u.a.ITailedLabel.call(this,t),this._opacity=1,this.initialize()},u.a.SimpleTailedLabel.prototype=new u.a.ITailedLabel,u.a.SimpleTailedLabel.prototype.type="SimpleTailedLabel",u.a.SimpleTailedLabel.prototype.initialize=function(){var t=this._option,e=t.position,n=this;if(!0===t.label.show){var i=rl(s()({},t,{reverseX:!1})),r=rl(s()({},t,{reverseX:!0}));this._textures=[i.toDataURL(),r.toDataURL()];var o=ul([i.width,i.height],t.sizeScale);this._label=function(t){var e=new Cesium.Cartesian3(0,-1,0),n=ll(t.position,t.dimensions);return new Cesium.Entity({show:!0,position:n,id:t.id,plane:{plane:new Cesium.Plane(e,0),dimensions:new(Function.prototype.bind.apply(Cesium.Cartesian2,[null].concat(h()(t.dimensions)))),material:new Cesium.PlaneMaterialProperty(s()({},t))},properties:{bId:t.id,btype:"tl-label"}})}({id:this.getId(),position:[e.lng,e.lat,e.height+o[1]/2],heading:t.heading,dimensions:o,texture:this._textures[0],duration:t.duration,fadeOpacity:t.fadeOpacity})}var a=function(t){var e,n,i=void 0,r=void 0;return!0===t.tail.show&&(i=new Cesium.Entity({polyline:{positions:[(e=Cesium.Cartesian3).fromDegrees.apply(e,h()(t.position)),Cesium.Cartesian3.fromDegrees(t.position[0],t.position[1],t.position[2]+t.tail.length*t.sizeScale)],width:t.tail.width||2,material:t.tail.material},properties:{bId:t.id,btype:"tl-tail"}})),!0===t.anchor.show&&(r=new Cesium.Entity({position:(n=Cesium.Cartesian3).fromDegrees.apply(n,h()(t.position)),billboard:s()({},t.anchor,{width:t.anchor.width*t.sizeScale,height:t.anchor.height*t.sizeScale}),properties:{bId:t.id,btype:"tl-anchor"}})),{anchor:r,tail:i}}({id:this.getId(),position:e.exportLngLatHeightArray(),sizeScale:t.sizeScale,tail:s()({},t.tail,{material:new Cesium.Color(1,1,1,.5)}),anchor:s()({},t.anchor,{color:new Cesium.CallbackProperty((function(){return new Cesium.Color(1,1,1,n._opacity)}),!1)})});this._tail=a.tail,this._anchor=a.anchor},u.a.SimpleTailedLabel.prototype.onAdd=function(t){var e=t.viewer;this._tail&&e.entities.add(this._tail),this._anchor&&e.entities.add(this._anchor),this._label&&e.entities.add(this._label)},u.a.SimpleTailedLabel.prototype.onRemove=function(t){var e=t.viewer;this._tail&&e.entities.remove(this._tail),this._anchor&&e.entities.remove(this._anchor),this._label&&e.entities.remove(this._label)},u.a.SimpleTailedLabel.prototype.onCameraChange=function(t){this._label&&(this._label.plane.material.texture=this._textures[t.facing?0:1])},u.a.SimpleTailedLabel.prototype.onToggleShow=function(t){this.getElements().forEach((function(e){return e.show=t}))},u.a.SimpleTailedLabel.prototype.getElements=function(){return[this._label,this._tail,this._anchor].filter(Boolean)},u.a.SimpleTailedLabel.prototype.fadeIn=function(){this._label&&(this._label.plane.material.showState=1),this._tail&&!0===this._option.tail.show&&(this._tail.show=!0),this._anchor&&!0===this._option.anchor.show&&(this._anchor.show=!0),this._opacity=1},u.a.SimpleTailedLabel.prototype.fadeOut=function(){this._label&&(this._label.plane.material.showState=-1),this._opacity=this._option.fadeOpacity},u.a.SimpleTailedLabel.prototype.finishFading=function(){this._label};var hl=u.a.SimpleTailedLabel;function pl(t){var e=function(t){var e={size:{width:0,height:0},labelSize:{width:0,height:0,widthArr:[],heightArr:[]},contentSize:{width:0,height:0,widthArr:[],heightArr:[]}},n=il(100,100).getContext("2d");n.textAlign="left",n.textBaseline="top";var i=t.label;n.font=i.fontSize+"px "+i.fontFamily,e.labelSize=ol(n,i.text,{padding:i.padding,textSpacing:i.textSpacing,fontSize:i.fontSize});var r=t.content;return n.font=r.fontSize+"px "+r.fontFamily,e.contentSize=ol(n,r.text,{padding:r.padding,textSpacing:r.textSpacing,fontSize:r.fontSize}),e.size.width=Math.round(2*(e.labelSize.width+t.labelContentSpacing)),e.size.height=Math.round(Math.max(Math.max(e.labelSize.height,e.contentSize.height),e.labelSize.height*t.minHeightRatio)),e}(t);r()(t.estimatedSize,e);var n=e.size,i=il(n.width,n.height),o=i.getContext("2d");return function(t,e,n){var i=e.size,r=e.labelSize,o=n.label;t.fillStyle=""+o.background,t.fillRect(0,i.height-r.height,r.width,r.height),t.font=o.fontWeight+" "+o.fontSize+"px "+o.fontFamily,t.fillStyle=""+o.color,t.textAlign="center",t.textBaseline="bottom";var s=r.maxTextWidth/2+o.padding[3],a=i.height-o.padding[2];o.text.split("").reverse().forEach((function(e){t.fillText(e,s,a),a-=r.maxTextHeight+o.textSpacing}))}(o,e,{label:t.label}),function(t,e,n){var i=e.size,r=e.labelSize,o=e.contentSize,s=n.content;t.fillStyle=""+s.background,t.fillRect(r.width+n.labelContentSpacing,0,o.width,o.height);t.font=s.fontWeight+" "+s.fontSize+"px "+s.fontFamily,t.fillStyle=""+s.color,t.textAlign="center",t.textBaseline="bottom",t.rotate(90*Math.PI/180);var a=i.height-o.maxTextHeight/2-s.padding[2]-Math.max(0,(i.height-o.height)/2),l=-(r.width+s.padding[3]+n.labelContentSpacing);s.text.split("").reverse().forEach((function(e){t.fillText(e,a,l),a-=o.maxTextHeight+s.textSpacing})),t.rotate(270*Math.PI/180)}(o,e,{content:t.content,labelContentSpacing:t.labelContentSpacing}),!0===t.tail.drawWithCanvas&&function(t,e,n){var i=e.size,r=e.labelSize;e.contentSize;t.lineWidth=n.width,t.strokeStyle="rgba(255,255,255,1)",t.beginPath(),t.beginPath(),t.setLineDash([8,8]),t.moveTo(r.width+n.labelContentSpacing,i.height),t.lineTo(r.width+n.labelContentSpacing,0),t.stroke()}(o,e,{width:t.tail.width,labelContentSpacing:t.labelContentSpacing}),i}function fl(t,e){var n=new Cesium.Cartesian3(0,-1,0),i=new Cesium.Plane(n,0),r=ll(e.position,e.anchorX-e.dimensions[0]/2);return new Cesium.Entity({show:!0,position:r,id:e.id,plane:{plane:new Cesium.CallbackProperty((function(){var e,r,o,s,a,l,u,c,h;return i.normal=(e=n,r=-t.camera.heading,o=new Cesium.Cartesian3,s=new Cesium.Cartesian3(0,0,0),a=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Z,r),l=Cesium.Matrix3.fromQuaternion(a),u=Cesium.Matrix4.fromRotationTranslation(l),c=Cesium.Cartesian3.subtract(e,s,new Cesium.Cartesian3),h=Cesium.Matrix4.multiplyByPoint(u,c,o),Cesium.Cartesian3.normalize(Cesium.Cartesian3.subtract(h,s,o),o),o),i}),!e.facingCamera),dimensions:new(Function.prototype.bind.apply(Cesium.Cartesian2,[null].concat(h()(e.dimensions)))),material:new Cesium.PlaneMaterialProperty(s()({},e))},properties:{bId:e.id,btype:"tl-label"}})}u.a.SimpleBlockLabel=function(t){var e,n;e=tl,n=t,t=s()({},e,n,{fadeInout:s()({},e.fadeInout,n.fadeInout),label:s()({},e.label,n.label),content:s()({},e.content,n.content),tail:s()({},e.tail,n.tail)}),u.a.ITailedLabel.call(this,t),this._opacity=1,this._boundingSphere=null,this.initialize()},u.a.SimpleBlockLabel.prototype=new u.a.ITailedLabel,u.a.SimpleBlockLabel.prototype.type="SimpleBlockLabel",u.a.SimpleBlockLabel.prototype.getType=function(){return Ja.BLOCK},u.a.SimpleBlockLabel.prototype.getFadingState=function(){var t=this._label.plane.material;switch(t.showState){case-1:return t._progress<1?Qa.FADING_OUT:Qa.FADED_OUT;case 0:return Qa.NONE;case 1:return t._progress<1?Qa.FADING_IN:Qa.FADED_IN}},u.a.SimpleBlockLabel.prototype.initialize=function(){var t=this._option,e=t.position,n=0,i=[1,1];if(!0===t.label.show){var r={},o=pl(s()({},t,{estimatedSize:r}));this.estimatedSize=r,this._textures=[o.toDataURL()];var a=(i=ul([o.width,o.height],t.sizeScale))[0]*(r.labelSize.width+t.labelContentSpacing)/r.size.width;n=r.labelSize.height/r.size.height,this._label=fl(_cesium,{id:this.getId(),position:[e.lng,e.lat,e.height+i[1]/2],heading:t.heading,dimensions:i,anchorX:a,texture:this._textures[0],duration:t.fadeInout.duration,fadeOpacity:t.fadeInout.fadeOpacity,facingCamera:t.facingCamera});var l=i[1]*r.labelSize.height/r.size.height;this._boundingSphere=new Cesium.BoundingSphere(Cesium.Cartesian3.fromDegrees(e.lng,e.lat,e.height),l)}!0===t.tail.show&&!1===t.tail.drawWithCanvas&&(this._tail=function(t){var e=t.position,n=t.dimensions,i=t.labelHeightRatio,r=t.tail;return new Cesium.Entity({polyline:{positions:[e.exportCartesian(),Cesium.Cartesian3.fromDegrees(e.lng,e.lat,e.height+n[1])],width:r.width,material:new Cesium.PolylineGradientMaterialProperty({color:r.color,gapColor:r.gapColor,dashLength:r.dashLength,startColor:r.startColor,endColor:r.endColor,dashStartPosition:i}),zIndex:1},properties:{bId:t.id,btype:"tl-tail"}})}(s()({},t,{dimensions:i,labelHeightRatio:n})))},u.a.SimpleBlockLabel.prototype.onAdd=function(t){var e=t.viewer;this._label&&e.entities.add(this._label),this._tail&&e.entities.add(this._tail)},u.a.SimpleBlockLabel.prototype.onRemove=function(t){var e=t.viewer;this._label&&e.entities.remove(this._label),this._tail&&e.entities.remove(this._tail)},u.a.SimpleBlockLabel.prototype.onCameraChange=function(t){if(this._tail){var e=this._tail.polyline,n=this._option.tail.width,i=e.width.getValue(),r=function(t,e,n,i){var r=n/i.radius;if(r<=2)return t;var o=1/Math.sqrt(r,2),s=Math.max(1,Math.min(t*o,t));return Math.abs(s-e)>.5?s:e}(n,i,t.distanceToCamera,this._boundingSphere);r!==i&&e.width.setValue(r)}},u.a.SimpleBlockLabel.prototype.onToggleShow=function(t){this.getElements().forEach((function(e){return e.show=t}))},u.a.SimpleBlockLabel.prototype.getElements=function(){return[this._label,this._tail].filter(Boolean)},u.a.ITailedLabel.prototype.getBoundingSphere=function(){return this._boundingSphere},u.a.SimpleBlockLabel.prototype.fadeIn=function(t){t=t||{},this._label&&(isNaN(t.duration)||(this._label.plane.material.duration=t.duration),this._label.plane.material.showState=1),this._tail&&(this._tail.polyline.material.showState=1),this._opacity=1},u.a.SimpleBlockLabel.prototype.fadeOut=function(t){t=t||{},this._label&&(isNaN(t.duration)||(this._label.plane.material.duration=t.duration),this._label.plane.material.showState=-1),this._tail&&(this._tail.polyline.material.showState=-1),this._opacity=this._option.fadeInout.fadeOpacity},u.a.SimpleBlockLabel.prototype.finishFading=function(){this._label};var dl=u.a.SimpleBlockLabel,gl={simple:function(t){return new hl(t)},block:function(t){return new dl(t)}};function yl(t,e){var n=gl[t||"simple"];if(n)return n(e)}function ml(t){Us.call(this),this.binder=t,this.dirty=!1}ml.prototype=new Us,ml.prototype.priority=function(t){t.map3d;var e=t.camera,n=this.binder.label;return 1e3/(e.distanceToBoundingSphere(n.getBoundingSphere())||1)},ml.prototype.bounds=function(t){var e=t.map3d,n=t.camera,i=(t.bounds,this.binder.label),r=e.viewer.scene,o=i._option.position,s=i._label.plane.dimensions.getValue(),a=r.cartesianToCanvasCoordinates(o.exportCartesian(),new Cesium.Cartesian2),l=n.getPixelSize(new Cesium.BoundingSphere(o.exportCartesian(),1),r.drawingBufferWidth,r.drawingBufferHeight),u=e.viewer.camera.pitch,c=i.estimatedSize,h=c.labelSize,p=c.size,f=s.x/l,d=Math.cos(Math.abs(u))*s.y/l,g=h.width/p.width,y=h.height/p.height;return[a.x-f/2-g*f,a.y-d*y,a.x+f/2,a.y]},ml.prototype.target=function(){return this.binder.label};var _l=void 0;function vl(){return _l=_l||new Vs}function xl(t){return t.map((function(t){var e={label:t};if(t.getType()===Ja.BLOCK)return new ml(e)})).filter(Boolean)}u.a.TailedLabels=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this,n=e.map3d=E.apply(void 0,arguments)||_sf3d,i=e.viewer=P.apply(void 0,arguments)||_cesium;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},autoFadeEnable:{name:"自动淡入淡出",type:u.a.PropertyType.Boolean,default:!0},collisionDeteck:{name:"碰撞检测",type:u.a.PropertyType.Boolean,default:!0}};var r=[],o=[],a=[],c=!1!==t.show&&this.config.show.default;Object.defineProperty(this,"show",{get:function(){return c},set:function(t){c!==!!t&&(c=!!t,this.labels.forEach((function(t){return t.show=c})))},enumerable:!0}),Object.defineProperty(this,"labels",{get:function(){return[].concat(r).concat(o)},enumerable:!0});var p=!1!==t.autoFadeEnable&&this.config.autoFadeEnable.default;Object.defineProperty(this,"autoFadeEnable",{get:function(){return p},set:function(t){p!==!!t&&(p=!!t)},enumerable:!0});var f=!1!==t.collisionDeteck&&this.config.collisionDeteck.default;function d(t){if(t.data&&t.data.pickingResult&&t.data.pickingResult.id){var e=t.data.pickingResult.id;if(e.properties&&e.properties.bId&&e.properties.btype&&"tl-label"===e.properties.btype.getValue())return e.properties.bId.getValue()}}function g(t){var n=d(t);void 0!==n&&(el(r,n)&&e.emit({type:"select",data:{id:n}}))}function y(t){var n=d(t);void 0!==n&&(el(r,n)&&e.emit({type:"unselect",data:{id:n}}))}Object.defineProperty(this,"collisionDeteck",{get:function(){return f},set:function(t){f!==!!t&&(f=!!t,this._requestUpdate())},enumerable:!0}),this.addListeners=function(){var t=this;this._cameraChangeListenerRemover=i.camera.changed.addEventListener((function(e){t._onCameraChanged()})),n.on("onClickIn",g),n.on("onClickOut",y)},this.removeListeners=function(){this._cameraChangeListenerRemover&&(this._cameraChangeListenerRemover(),this._cameraChangeListenerRemover=null),n.off("onClickIn",g),n.off("onClickOut",y)},this.addListeners(),this.addLabels=function(e){var n=this,u=function(t){var e=t.filter((function(t){return a.findIndex((function(e){return e.id===t.id}))>=0})).filter((function(t){return!nl(r,t.id)})).map((function(t){return yl(t.type,s()({},t))}));o=o.concat(e)},c=this;return a=a.concat(e.filter((function(t){return!nl(r,t.id)})).filter((function(t){return a.findIndex((function(e){return e.id===t.id}))<0}))),new l.a((function(r,o){var s=e.map((function(t,e){var n;return(n=Cesium.Cartographic).fromDegrees.apply(n,h()(t.position.exportLngLatArray()))})),a=i.scene.terrainProvider;if(!1!==t.sampleHeightsFromTerrain&&a){var l=function(){Cesium.sampleTerrainMostDetailed(a,s).then((function(t){t.forEach((function(t,n){var i=e[n];i.position.height=t.height||i.position.height||0})),u(e),c.updateOnDataChange(),r()}),(function(t){console.debug("sample terrain failed!",t),u(e),c.updateOnDataChange(),r()}))};!0===a.ready?(console.debug("sample terrain heights rightnow!"),l()):a.readyPromise.then((function(){console.debug("sample terrain heights on terrainProvider readyPromise!"),l()}))}else console.debug("no terrain heights!"),u(e),n.updateOnDataChange(),r()}))},this.removeLabels=function(t){},this.updateOnDataChange=function(){o.forEach((function(t){t.add(n),t.show=c,r.push(t)})),o.splice(0),this._requestUpdate()},this.focus=function(t){},this.clear=function(){r.forEach((function(t){t.remove(n),t.destroy()})),o.splice(0),r.splice(0),a.splice(0)},this._onCameraChanged=function(){this._requestUpdate()};var m=!1;this._requestUpdate=function(){var t=this;!1===m&&(m=!0,l.a.resolve().then((function(){t._update(),m=!1})))};var _={};this._update=function(){try{!0===f?this._updateWithCollisionDeteck():!0===p&&this._updateWidthAutoFade()}catch(t){console.warn("update tailed labels failed !")}},this._updateWithCollisionDeteck=function(){var t=[],e=[],o=[];r.forEach((function(e){var r=e._option.fadeInout,s=e.getBoundingSphere(),a=i.camera.distanceToBoundingSphere(s);cl(n,s,{pixelCountThreshold:r.pixelThreshold,padding:r.padding,distanceToCamera:a})?o.push(e):t.push(e)}));var s=vl();xl(o).forEach((function(t){return s.push(t)}));var a=[0,0,i.canvas.width,i.canvas.height];s.setBounds(a);var l={map3d:n,camera:i.camera,bounds:a};s.apply(l),s.unpassed().forEach((function(e){return t.push(e.target())})),s.passed().forEach((function(t){return e.push(t.target())})),s.reset(),p?(t.filter((function(t){return[Qa.FADING_OUT,Qa.FADED_OUT].indexOf(t.getFadingState())<0})).forEach((function(t){return t.fadeOut()})),e.filter((function(t){return[Qa.FADING_IN,Qa.FADED_IN].indexOf(t.getFadingState())<0})).forEach((function(t){return t.fadeIn()}))):(t.forEach((function(t){return t.show=!1})),e.forEach((function(t){return t.show=!0})))},this._updateWidthAutoFade=function(){r.forEach((function(t){var e=t.getId(),r=t._option.fadeInout,o=_.hasOwnProperty(e)?_[e]:void 0,s=t.getBoundingSphere(),a=i.camera.distanceToBoundingSphere(s),l=cl(n,s,{pixelCountThreshold:r.pixelThreshold,padding:r.padding,distanceToCamera:a});l?void 0!==o&&!1!==o||t.fadeIn():void 0!==o&&!0!==o||t.fadeOut(),_[e]=l;try{t.onCameraChange({distanceToCamera:a})}catch(t){console.error(t)}}))},this.destroy=function(){this.clear(),this.removeListeners(),u.a.Element.prototype.destroy.call(this)}},r()(u.a.TailedLabels,Ja),u.a.TailedLabels.prototype=new u.a.Element,r()(u.a.TailedLabels.prototype,u.a.EventManager.prototype),u.a.TailedLabels.prototype.type="TailedLabels",u.a.DashPolyLines=function(t){t=t||{},u.a.Element.call(this,t.id);var e=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},gapColor:{name:"虚线颜色",type:u.a.PropertyType.Color,default:new u.a.Color(0,0,0,0)},dashLength:{name:"虚线长度",type:u.a.PropertyType.Float,default:16},dashPattern:{name:"虚线样式",type:u.a.PropertyType.Float,default:255},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color(255,255,255,1)},lineWidth:{name:"线宽",type:u.a.PropertyType.Float,default:2,noConfig:!0},clampToGround:{name:"贴地",type:u.a.PropertyType.Boolean,default:!1,noConfig:!0},traces:{name:"轨迹",type:u.a.PropertyType.Array,default:Array.isArray(t.traces)?t.traces:[],noConfig:!0},allowPicking:{name:"是否允许拾取",type:u.a.PropertyType.Boolean,default:!0===t.allowPicking,noConfig:!0}};var n=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return n},set:function(t){n=!!t,e.instance&&(e.instance.show=n)},enumerable:!0});var i=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return i},set:function(t){t instanceof u.a.Color&&(i=t,e.instance.appearance.material.uniforms.color=i.color)},enumerable:!0});var r=isNaN(t.lineWidth)?this.config.lineWidth.default:t.lineWidth;Object.defineProperty(this,"lineWidth",{get:function(){return r},set:function(t){isNaN(t)||(r=t)},enumerable:!0});var o=!!t.clampToGround;Object.defineProperty(this,"clampToGround",{get:function(){return o},set:function(t){o=!!t},enumerable:!0});var s=!0===t.allowPicking;Object.defineProperty(this,"allowPicking",{get:function(){return s},set:function(t){s=!!t},enumerable:!0});var a=t.gapColor instanceof u.a.Color?t.gapColor:this.config.gapColor.default;Object.defineProperty(this,"gapColor",{get:function(){return a},set:function(t){t instanceof u.a.Color&&(a=t,e.instance.appearance.material.uniforms.gapColor=a.color)},enumerable:!0});var l=isNaN(t.dashLength)?this.config.dashLength.default:t.dashLength;Object.defineProperty(this,"dashLength",{get:function(){return l},set:function(t){isNaN(t)||(l=t,e.instance.appearance.material.uniforms.dashLength=l)},enumerable:!0});var c=isNaN(t.dashPattern)?this.config.dashPattern.default:t.dashPattern;if(Object.defineProperty(this,"dashPattern",{get:function(){return c},set:function(t){isNaN(t)||(c=t,e.instance.appearance.material.uniforms.dashPattern=c)},enumerable:!0}),this.config.traces.default){var h=[];this.config.traces.default.forEach((function(t){var e={positions:t.exportCartesianArray(),width:r};h.push(new Cesium.GeometryInstance({id:t.id,geometry:o?new Cesium.GroundPolylineGeometry(e):new Cesium.PolylineGeometry(e),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(i.color),show:new Cesium.ShowGeometryInstanceAttribute(!0)}}))}));var p,f=Cesium.Material.fromType(Cesium.Material.PolylineDashType);f.uniforms.color=i.color,f.uniforms.gapColor=a.color,f.uniforms.dashLength=l,f.uniforms.dashPattern=c,p=new Cesium.PolylineMaterialAppearance({material:f}),h.length>0&&(o?(this.instance=new Cesium.GroundPolylinePrimitive({geometryInstances:h,appearance:p,show:n,allowPicking:s}),_cesium.scene.groundPrimitives.add(this.instance)):(this.instance=new Cesium.Primitive({geometryInstances:h,appearance:p,show:n,allowPicking:s}),_cesium.scene.primitives.add(this.instance)))}},u.a.DashPolyLines.prototype=new u.a.Element,u.a.DashPolyLines.prototype.type="DashPolyLines";u.a.DashPolyLines;var Cl={floorPropertyName:"floor",selectOffset:[0,-100,0],duration:300};u.a.TilesetModelBuildingFloor=function(t){t=t||{},u.a.Element.call(this,t.id);var e=E.apply(void 0,arguments)||_sf3d,n=null,i=null,r=s()({},Cl),o=null;function a(){r=s()({},Cl),n=null,i&&(i.destroy(),i=null),o&&(o(),o=null)}function c(t){var e=s()({},t._option,{url:t.url});return new u.a.TilesetModel(e)}function p(t,e,n){t.instance._tileset.style=!0===n?new Cesium.Cesium3DTileStyle({show:{conditions:[["${feature['"+r.floorPropertyName+"']} === "+e,"true"],["true","false"]]}}):new Cesium.Cesium3DTileStyle({show:{conditions:[["${feature['"+r.floorPropertyName+"']} === "+e,"false"],["true","true"]]}})}function f(t,e){t.instance._tileset.style=new Cesium.Cesium3DTileStyle({show:{conditions:[["true",""+e]]}})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,n=e.map3d,i=e.tileset,r=e.xyz,s=e.duration,a=e.reverse,u=void 0!==a&&a;return new l.a((function(t,e){s=s||150;var a=[new Cesium.Cartesian3(0,0,0),new(Function.prototype.bind.apply(Cesium.Cartesian3,[null].concat(h()(r))))],l=new Cesium.LinearSpline({times:[0,1],points:!0===u?a.reverse():a}),c=i.instance._tileset,p=(new Date).getTime(),f=0,d=1/(s/(1e3/90));o=n.viewer.scene.postUpdate.addEventListener((function(){var e=((new Date).getTime()-p)/s;if(!(e-f<d))if((f=e)>=.999)g(c,[a[1].x,a[1].y,a[1].z]),o&&(o(),o=null),t();else{var n=l.evaluate(f);g(c,[n.x,n.y,n.z])}}))}))}function g(t,e){var n=t.boundingSphere,i=Cesium.Cartographic.fromCartesian(n.center),r=Cesium.Cartesian3.fromRadians(i.longitude,i.latitude,0),o=Cesium.Cartesian3.fromDegrees(0,0,0).x,s=Cesium.Cartesian3.fromRadians(i.longitude+e[0]/o,i.latitude+e[1]/o,e[2]),a=Cesium.Cartesian3.subtract(s,r,new Cesium.Cartesian3);t.modelMatrix=Cesium.Matrix4.fromTranslation(a)}this.bind=function(t,e){return new l.a((function(o,l){a(),n=t,r=s()({},Cl,e||{}),(i=c(n)).applyTag({type:"buildingfloor",parent:t.id,parentTag:t.instance.tag}),i.instance._tileset.readyPromise.then((function(){f(i,!1),o()}),(function(t){l(t)}))}))},this.unbind=function(){a()},this.readyPromise=function(){return new l.a((function(t,e){n&&i?i.instance._tileset.ready?t():i.instance._tileset.readyPromise.then(t).reject(e):e(new Error("not bind yet!"))}))};var y=r.selectOffset,m=void 0;this.selectFloor=function(t,o){return new l.a((function(a,l){if(n&&i){var u=s()({},r,o||{});y=u.selectOffset,m=t,p(n,t,!1),p(i,t,!0),d({map3d:e,tileset:i,xyz:u.selectOffset,duration:u.duration}).then(a).catch(l)}else l(new Error("not bind yet!"))}))},this.unSelectFloor=function(t){return new l.a((function(o,a){if(n&&i)if(null!=m){var l=s()({},r,t||{}),u=function(){f(i,!1),f(n,!0),o()};d({map3d:e,tileset:i,xyz:y,duration:l.duration,reverse:!0}).then(u).catch(u),y=r.selectOffset,m=void 0}else o();else o()}))},this.clearSelection=function(){this.unSelectFloor()},this.destroy=function(){this.clearSelection(),this.unbind()},this.transformToSelectFloorPosition=function(t,e){var n=(e=e||{}).selectOffset||y;if(n){var i=Cesium.Cartesian3.fromDegrees(0,0,0).x,r=t.clone();return r.lng+=Cesium.Math.DEGREES_PER_RADIAN*n[0]/i,r.lat+=Cesium.Math.DEGREES_PER_RADIAN*n[1]/i,r.height+=n[2],r}}};u.a.TilesetModelBuildingFloor;u.a.MaskPolygon=function(t){var e=this;t=t||{},u.a.Element.call(this,t.id);var n=this;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},color:{name:"颜色",type:u.a.PropertyType.Color,default:new u.a.Color(0,0,0,.7)},traces:{name:"轨迹",type:u.a.PropertyType.Array,default:Array.isArray(t.traces)?t.traces:[],noConfig:!0}};var i=!1!==t.show;Object.defineProperty(this,"show",{get:function(){return i},set:function(t){i=!!t,n.instance.show=i},enumerable:!0});var r=t.color instanceof u.a.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return r},set:function(t){t instanceof u.a.Color&&(r=t,n.instance.polygon.material=r.color)},enumerable:!0}),this.config.traces.default&&this.config.traces.default.forEach((function(t){t instanceof u.a.Point3dCollection&&(e.instance=_cesium.entities.add({polygon:{hierarchy:{positions:Cesium.Cartesian3.fromDegreesArray([62,42,85,14,136,14,148,60]),holes:[{positions:t.exportCartesianArrayWithoutHeight()}]},material:r.color,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND}}))}))},u.a.MaskPolygon.prototype=new u.a.Element,u.a.MaskPolygon.prototype.type="MaskPolygon";u.a.MaskPolygon;u.a.CameraControl=function(t){t=t||{},this.viewer=t.viewer,this.flags={looking:!1,moveForward:!1,moveBackward:!1,moveUp:!1,moveDown:!1,moveLeft:!1,moveRight:!1,rotateLeft:!1,rotateRight:!1,routeUp:!1,routeDown:!1},this.config={collision:{name:"碰撞检测",type:u.a.PropertyType.Boolean,default:!1},speed:{name:"速度倍速",type:u.a.PropertyType.Float,default:1}};var e=t.hasOwnProperty("collision")?1==t.collision:this.config.collision.default;Object.defineProperty(this,"collision",{get:function(){return e},set:function(t){e=!!t}});var n=t.speed||this.config.speed.default;Object.defineProperty(this,"speed",{get:function(){return n},set:function(t){n=t}}),this.initial()},u.a.CameraControl.prototype.initial=function(){var t=this;this.keydown=function(e){if(e.key){var n=e.key;switch(n=n.toLowerCase()){case"w":t.flags.moveForward=!0;break;case"s":t.flags.moveBackward=!0;break;case"z":t.flags.moveUp=!0;break;case"c":t.flags.moveDown=!0;break;case"d":t.flags.moveRight=!0;break;case"a":t.flags.moveLeft=!0;break;case"q":t.flags.rotateLeft=!0;break;case"e":t.flags.rotateRight=!0;break;case"arrowup":t.flags.routeUp=!0;break;case"arrowdown":t.flags.routeDown=!0;break;case"arrowleft":t.flags.rotateLeft=!0;break;case"arrowright":t.flags.rotateRight=!0}e.preventDefault()}},this.keyup=function(e){if(e.key){var n=e.key;switch(n=n.toLowerCase()){case"w":t.flags.moveForward=!1;break;case"s":t.flags.moveBackward=!1;break;case"z":t.flags.moveUp=!1;break;case"c":t.flags.moveDown=!1;break;case"d":t.flags.moveRight=!1;break;case"a":t.flags.moveLeft=!1;break;case"q":t.flags.rotateLeft=!1;break;case"e":t.flags.rotateRight=!1;break;case"arrowup":t.flags.routeUp=!1;break;case"arrowdown":t.flags.routeDown=!1;break;case"arrowleft":t.flags.rotateLeft=!1;break;case"arrowright":t.flags.rotateRight=!1}}},document.addEventListener("keydown",t.keydown,!1),document.addEventListener("keyup",t.keyup,!1),t.controlCamera()},u.a.CameraControl.prototype.controlCamera=function(){var t=this,e=this.viewer,n=e.scene.globe.ellipsoid,i=this.flags,r=Math.PI/250*this.speed,o=function(o){var s=e.camera,a=n.cartesianToCartographic(s.position).height,l=Math.max(a/200,.4)*t.speed,u=l/5;if(i.moveForward){var c=new Cesium.Ray(e.camera.position,e.camera.direction);if(t.collision&&Sl(e,c))return i.moveForward=!1,!1;var h=e.camera.heading,p=e.camera.pitch,f=e.camera.position,d=new Cesium.Cartesian3(0,l,0);d=bl(d,-h);var g=Il(f,d);e.camera.setView({destination:g,orientation:{heading:h,pitch:p,roll:0}})}if(i.moveBackward){c=new Cesium.Ray(e.camera.position,Cesium.Cartesian3.negate(e.camera.direction,new Cesium.Cartesian3));if(t.collision&&Sl(e,c))return i.moveBackward=!1,!1;var y=e.camera.heading,m=e.camera.pitch,_=e.camera.position,v=new Cesium.Cartesian3(0,-l,0);v=bl(v,-y);var x=Il(_,v);e.camera.setView({destination:x,orientation:{heading:y,pitch:m,roll:0}})}if(i.moveUp){var C=e.camera.heading,w=e.camera.pitch,b=e.camera.position,E=El(b,l/2);e.camera.setView({destination:E,orientation:{heading:C,pitch:w,roll:0}})}if(i.moveDown){var I=e.camera.heading,P=e.camera.pitch,N=e.camera.position,S=El(N,-l/2);e.camera.setView({destination:S,orientation:{heading:I,pitch:P,roll:0}})}if(i.moveLeft){c=new Cesium.Ray(e.camera.position,Cesium.Cartesian3.negate(e.camera.right,new Cesium.Cartesian3));if(t.collision&&Sl(e,c))return i.moveLeft=!1,!1;s.moveLeft(u)}if(i.moveRight){c=new Cesium.Ray(e.camera.position,e.camera.right);if(t.collision&&Sl(e,c))return i.moveRight=!1,!1;s.moveRight(u)}if(i.rotateLeft){var T=e.camera.heading,L=e.camera.pitch,M=e.camera.position;e.camera.setView({destination:M,orientation:{heading:T-r,pitch:L,roll:0}})}if(i.rotateRight){var O=e.camera.heading,R=e.camera.pitch,A=e.camera.position;e.camera.setView({destination:A,orientation:{heading:O+r,pitch:R,roll:0}})}i.routeUp&&s.lookUp(r),i.routeDown&&s.lookDown(r)};e.clock.onTick.addEventListener(o),this.clockfunction=o},u.a.CameraControl.prototype.destroy=function(){var t=this.viewer;null!=this.clockfunction&&t.clock.onTick.removeEventListener(this.clockfunction),document.removeEventListener("keyup",this.keyup),document.removeEventListener("keydown",this.keydown)};var wl=function(t){return Cesium.Cartographic.fromCartesian(t)},bl=function(t,e){var n=Math.cos(e)*t.x-Math.sin(e)*t.y,i=Math.sin(e)*t.x+Math.cos(e)*t.y;return new Cesium.Cartesian3(n,i,t.z)},El=function(t,e){var n=wl(t);return n.height+=e,Nl(n)},Il=function(t,e){return Pl(t,[e])[0]},Pl=function(t,e){for(var n=wl(t),i=n.longitude,r=n.latitude,o=[],s=0;s<e.length;s++){var a=e[s],l=-Math.sin(i)*a.x-Math.sin(r)*Math.cos(i)*a.y+Math.cos(r)*Math.cos(i)*a.z,u=Math.cos(i)*a.x-Math.sin(r)*Math.sin(i)*a.y+Math.cos(r)*Math.sin(i)*a.z,c=Math.cos(r)*a.y+Math.sin(r)*a.z;o.push(new Cesium.Cartesian3(l+t.x,u+t.y,c+t.z))}return o},Nl=function(t){return Cesium.Ellipsoid.WGS84.cartographicToCartesian(t)},Sl=function(t,e){var n=t.scene.pickFromRay(e);if(n&&n.hasOwnProperty("object")&&n.object instanceof Cesium.Cesium3DTileFeature&&Cesium.Cartesian3.distance(t.camera.position,n.position)<1){n.object.color;return n.object.color=Cesium.Color.fromRandom(),setTimeout((function(){n.object.color=Cesium.Color.WHITE}),500),!0}return!1};u.a.VectorPoi=function(t){var e=this;t=t||{},u.a.Element.call(this,t.id);var n=this;this.labels=_cesium.scene.primitives.add(new Cesium.LabelCollection),this.billboards=_cesium.scene.primitives.add(new Cesium.BillboardCollection),this.instance=[this.labels,this.billboards];var i={1:45454474,2:22657210,3:11293699,4:5629451,5:2806052,6:1398703,7:697196,8:347524,9:173226,10:86346,11:43040,12:21453,13:10693,14:5330,15:2657,16:1324,17:660,18:329,19:164,20:81,21:40,22:20},r={1e5:1009,100100:1009,100101:1009,100102:1009,100103:1009,100104:1009,100105:1009,100200:1009,100201:1009,11e4:1105,110001:1105,110002:1105,110003:1105,110004:1105,110005:1105,110100:1104,110101:1104,110102:1038,110103:1104,110104:1037,110105:1104,110106:1104,110200:1105,110201:1105,110202:1105,110203:1105,110204:1013,110205:1013,110206:1013,110207:1013,110208:1012,110209:1012,110210:1012,12e4:1005,120100:1005,120200:1005,120201:1005,120202:1005,120203:1005,120300:1006,120301:1006,120302:1006,120303:1006,120304:1006,120305:1006,120306:1006,13e4:1003,130100:1003,130101:1003,130102:1003,130103:1003,130104:1003,130105:1003,130106:1003,130107:1003,130200:1003,130201:1003,130202:1003,130300:1003,130400:1003,130401:1003,130402:1003,130403:1003,130404:1003,130405:1003,130406:1003,130407:1003,130408:1003,130409:1003,130500:1003,130501:1043,130502:1003,130503:1003,130504:1003,130505:1003,130506:1003,130600:1003,130601:1003,130602:1003,130603:1003,130604:1003,130605:1003,130606:1003,130700:1003,130701:1003,130702:1003,130703:1003,14e4:1011,140100:1013,140101:1013,140102:1013,140200:1013,140201:1013,140300:1013,140400:1013,140500:1035,140600:1013,140700:1013,140800:1013,140900:1013,141e3:1011,141100:1001,141101:1001,141102:1001,141103:1001,141104:1001,141105:1001,141200:1011,141201:1010,141202:1011,141203:1011,141204:1011,141205:1011,141206:1011,141207:1001,141300:1010,141400:1011,141500:1011,15e4:1001,150100:1001,150101:1001,150102:1001,150104:1023,150105:1001,150106:1023,150107:1001,150108:1001,150200:1026,150201:1001,150202:1001,150203:1001,150204:1001,150205:1001,150206:1001,150207:1001,150208:1001,150209:1001,150210:1026,150211:1001,150300:1036,150301:1036,150302:1036,150303:1036,150304:1036,150305:1036,150306:1036,150307:1036,150400:1025,150401:1025,150402:1025,150403:1025,150500:5025,150501:13e3,150600:5025,150700:1024,150701:1024,150702:1024,150703:1024,150704:1024,150705:1024,150706:1024,150800:1024,150900:1031,150903:1031,150904:1031,150905:1031,150906:1031,150907:1031,150908:1031,150909:1031,151e3:1003,151001:1003,151002:1003,151003:1003,151100:1001,151200:1036,151300:1001,151400:1001,151401:1001,151402:1001,151403:1001,151404:1001,151405:1001,16e4:1001,160100:1042,160101:1042,160102:1042,160103:1042,160104:7200,160105:7201,160106:7202,160107:7203,160108:7204,160109:7205,160110:7206,160111:7207,160112:7208,160113:7209,160114:1042,160115:7210,160117:7211,160118:7212,160119:1042,160120:7213,160121:1042,160122:1042,160123:1042,160124:1042,160125:1042,160126:1042,160127:1042,160128:1042,160129:1042,160130:1042,160131:1042,160132:1042,160133:1042,160134:1042,160135:1042,160136:1042,160137:1042,160138:1042,160139:7214,160140:1042,160141:1042,160142:1042,160143:1042,160144:1042,160145:1042,160146:1042,160147:1042,160148:1042,160149:1042,160150:1042,160151:1042,160152:1042,160200:1042,160300:1055,160301:1055,160302:1055,160303:1055,160304:1055,160305:1055,160306:1055,160307:1055,160308:1055,160309:1055,160310:1055,160311:1055,160312:1055,160314:1055,160315:1055,160316:1055,160317:1055,160318:1055,160319:1055,160320:1055,160321:1055,160322:1055,160323:1055,160324:1055,160325:1055,160326:1055,160327:1055,160328:1055,160329:1055,160330:1055,160331:1055,160332:1055,160333:1055,160334:1055,160335:1055,160336:1055,160337:1055,160338:1055,160339:1055,160340:1055,160341:1055,160342:1055,160343:1055,160344:1055,160345:1055,160346:1055,160347:1055,160348:1055,160349:1055,160400:1001,160401:1001,160402:1001,160403:1001,160404:1001,160405:1001,160406:1001,160407:1001,160408:1001,160409:1001,160410:1001,160500:1001,160501:1001,160600:1001,17e4:1005,170100:1005,170200:1005,170201:1005,170202:1005,170203:1005,170204:1005,170205:1005,170206:1005,170207:1005,170208:1005,170209:1005,170300:1005,170301:1005,170302:1005,170400:1005,170401:1005,170402:1005,170403:1005,170404:1005,170405:1005,170406:1005,170407:1005,170408:1005,18e4:1001,180100:1001,180101:1001,180102:1001,180103:1001,180104:1001,180200:1030,180201:1030,180202:1030,180203:1030,180300:1029,180301:1029,180302:1029,180400:1002,190304:1027,190305:1028,190308:1027,190309:1028,2e5:1001,200100:1001,200200:1001,200300:1059,200301:1059,200302:1059,200303:1059,200304:1059,200400:1001,97e4:8004,99e4:8004,991e3:8004,991001:8004,991400:8004,991401:8004,991500:8004,991600:8004,991601:8004,"010000":1039,"010100":1041,"010101":7400,"010102":7401,"010103":1041,"010104":1041,"010105":1041,"010107":1041,"010108":1041,"010109":1041,"010110":1041,"010111":1041,"010112":1041,"010200":1041,"010300":1041,"010400":1039,"010401":1039,"010500":1039,"010600":1039,"010700":1039,"010800":1039,"010900":1039,"010901":1039,"011000":1039,"011100":1072,"011101":1072,"011102":1072,"020000":1039,"020100":1039,"020101":1039,"020102":1039,"020103":1039,"020104":1039,"020105":1039,"020106":1039,"020200":1039,"020201":1039,"020202":1039,"020203":1039,"020300":1039,"020301":1039,"020400":1039,"020401":1039,"020402":1039,"020403":1039,"020404":1039,"020405":1039,"020406":1039,"020407":1039,"020408":1039,"020600":1039,"020601":1039,"020602":1039,"020700":1039,"020701":1039,"020702":1039,"020703":1039,"020800":1039,"020900":1039,"020904":1039,"020905":1039,"021000":1039,"021001":1039,"021002":1039,"021003":1039,"021004":1039,"021100":1039,"021200":1039,"021201":1039,"021202":1039,"021203":1039,"021300":1039,"021301":1039,"021400":1039,"021401":1039,"021500":1039,"021501":1039,"021600":1039,"021601":1039,"021602":1039,"021700":1039,"021701":1039,"021702":1039,"021800":1039,"021802":1039,"021803":1039,"021804":1039,"021900":1039,"022000":1039,"022100":1039,"022200":1039,"022300":1039,"022301":1039,"022400":1039,"022500":1039,"022501":1039,"022502":1039,"022600":1039,"022700":1039,"022800":1039,"022900":1039,"023000":1039,"023100":1039,"023200":1039,"023300":1039,"023301":1039,"023400":1039,"023500":1039,"025000":1039,"025100":1039,"025200":1039,"025300":1039,"025400":1039,"025500":1039,"025600":1039,"025700":1039,"025800":1039,"025900":1039,"026000":1039,"026100":1039,"026200":1039,"026300":1039,"029900":1039,"030000":1040,"030100":1040,"030200":1040,"030201":1040,"030202":1040,"030203":1040,"030204":1040,"030205":1040,"030206":1040,"030300":1040,"030301":1040,"030302":1040,"030303":1040,"030400":1040,"030401":1040,"030500":1040,"030501":1040,"030502":1040,"030503":1040,"030504":1040,"030505":1040,"030506":1040,"030507":1040,"030508":1040,"030700":1040,"030701":1040,"030702":1040,"030800":1040,"030801":1040,"030802":1040,"030803":1040,"030900":1040,"031000":1040,"031004":1040,"031005":1040,"031100":1040,"031101":1040,"031102":1040,"031103":1040,"031104":1040,"031200":1040,"031300":1040,"031301":1040,"031302":1040,"031303":1040,"031400":1040,"031401":1040,"031500":1040,"031501":1040,"031600":1040,"031601":1040,"031700":1040,"031701":1040,"031702":1040,"031800":1040,"031801":1040,"031802":1040,"031900":1040,"031902":1040,"031903":1040,"031904":1040,"032000":1040,"032100":1040,"032200":1040,"032300":1040,"032400":1040,"032401":1040,"032500":1040,"032600":1040,"032601":1040,"032602":1040,"032700":1040,"032800":1040,"032900":1040,"033000":1040,"033100":1040,"033200":1040,"033300":1040,"033400":1040,"033401":1040,"033500":1040,"033600":1040,"035000":1040,"035100":1040,"035200":1040,"035300":1040,"035400":1040,"035500":1040,"035600":1040,"035700":1040,"035800":1040,"035900":1040,"036000":1040,"036100":1040,"036200":1040,"036300":1040,"039900":1040,"040000":1113,"040100":1113,"040101":1113,"040200":1113,"040201":1113,"050000":1019,"050100":1019,"050101":1019,"050102":1019,"050103":1019,"050104":1019,"050105":1019,"050106":1019,"050107":1019,"050108":1019,"050109":1019,"050110":1019,"050111":1019,"050112":1019,"050113":1019,"050114":1019,"050115":1019,"050116":1019,"050117":1019,"050118":1019,"050119":1019,"050120":1019,"050121":1019,"050122":1019,"050123":1019,"050200":1019,"050201":1019,"050202":1019,"050203":1019,"050204":1019,"050205":1019,"050206":1019,"050207":1019,"050208":1019,"050209":1019,"050210":1019,"050211":1019,"050212":1019,"050213":1019,"050214":1019,"050215":1019,"050216":1019,"050217":1019,"050300":1115,"050301":1115,"050302":1115,"050303":1115,"050304":1115,"050305":1115,"050306":1115,"050307":1115,"050308":1115,"050309":1115,"050310":1115,"050311":1115,"050312":1115,"050313":1115,"050314":1115,"050400":1019,"050500":1019,"050501":1019,"050502":1019,"050503":1019,"050504":1019,"050600":1019,"050700":1019,"050800":1019,"050900":1019,"060000":1068,"060100":1068,"060101":1068,"060102":1068,"060103":1068,"060200":1092,"060201":1092,"060202":1092,"060203":1092,"060204":1092,"060205":1092,"060206":1092,"060207":1092,"060300":1092,"060301":1092,"060302":1092,"060303":1092,"060304":1092,"060305":1092,"060306":1092,"060307":1092,"060308":1092,"060400":1092,"060401":1092,"060402":1092,"060403":1092,"060404":1092,"060405":1092,"060406":1092,"060407":1092,"060408":1092,"060409":1092,"060411":1092,"060413":1092,"060414":1092,"060415":1092,"060416":1092,"060417":1092,"060418":1092,"060419":1092,"060420":1092,"060421":1092,"060422":1092,"060500":1092,"060501":1092,"060502":1092,"060600":1092,"060601":1092,"060602":1092,"060603":1092,"060604":1092,"060605":1092,"060606":1092,"060700":1092,"060701":1092,"060702":1092,"060703":1092,"060704":1092,"060705":1092,"060706":1092,"060800":1092,"060900":1092,"060901":1092,"060902":1092,"060903":1092,"060904":1092,"060905":1092,"060906":1092,"060907":1092,"061000":1092,"061001":1092,"061100":1092,"061101":1092,"061102":1092,"061103":1092,"061104":1092,"061200":1092,"061201":1092,"061202":1092,"061203":1092,"061204":1092,"061205":1092,"061206":1092,"061207":1092,"061208":1092,"061209":1092,"061210":1092,"061211":1092,"061212":1092,"061213":1092,"061214":1092,"061300":1092,"061301":1092,"061302":1092,"061400":1092,"061401":1092,"070000":1001,"070100":1001,"070200":1001,"070201":1001,"070202":1001,"070203":1001,"070300":1001,"070301":1001,"070302":1001,"070303":1001,"070304":1001,"070305":1001,"070306":1001,"070400":1063,"070401":1063,"070500":1001,"070501":1001,"070502":1001,"070503":1001,"070600":1064,"070601":1066,"070603":1067,"070604":1065,"070605":1064,"070606":1064,"070607":1064,"070608":1064,"070609":1064,"070610":1064,"070611":1064,"070700":1001,"070701":1001,"070702":1001,"070703":1001,"070704":1001,"070705":1001,"070706":1001,"070800":1001,"070900":1001,"071000":1001,"071100":1001,"071200":1001,"071300":1001,"071400":1001,"071500":1001,"071600":1001,"071700":1001,"071800":1001,"071801":1001,"071900":1001,"071901":1001,"071902":1001,"071903":1001,"072000":1001,"072001":1001,"072101":1001,"080000":1001,"080100":1124,"080101":1124,"080102":1124,"080103":1124,"080104":1124,"080105":1124,"080106":1124,"080107":1124,"080108":1124,"080109":1124,"080110":1124,"080111":1124,"080112":1124,"080113":1124,"080114":1124,"080115":1124,"080116":1124,"080117":1124,"080118":1124,"080119":1124,"080200":1016,"080201":1016,"080202":1016,"080300":1001,"080301":1001,"080302":1061,"080303":1001,"080304":1001,"080305":1001,"080306":1001,"080307":1001,"080308":1001,"080400":1012,"080401":1012,"080402":1012,"080500":1012,"080501":1073,"080502":1012,"080503":1012,"080504":1012,"080505":1073,"080600":1060,"080601":1060,"080602":1013,"080603":1013,"090000":1032,"090100":1032,"090101":1032,"090102":1032,"090200":1032,"090201":1032,"090202":1032,"090203":1032,"090204":1032,"090205":1032,"090206":1032,"090207":1032,"090208":1032,"090209":1032,"090210":1032,"090211":1032,"090300":1032,"090400":1032,"090500":1032,"090600":1057,"090601":1057,"090602":1057,"090700":1033,"090701":1033,"090702":1033,190108:1005,190306:1005,190403:1005},o=[],s=["120300","120301","120302"];n.$axios=B.a.create({}),n.$axios.interceptors.response.use((function(t){return t.data})),this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},url:{name:"wfs服务",type:u.a.PropertyType.String,default:""},collision:{name:"碰撞检测",type:u.a.PropertyType.Boolean,default:!1},scale:{name:"缩放",type:u.a.PropertyType.Float,default:1}};var a=t.hasOwnProperty("show")?!!t.show:this.config.show.default;Object.defineProperty(this,"show",{get:function(){return a},set:function(t){a=!!t,n.instance.forEach((function(t){t.show=a}))},enumerable:!0});var l=t.url;Object.defineProperty(this,"url",{get:function(){return l},set:function(t){l=!!t},enumerable:!0});var c=t.hasOwnProperty("scale")?t.scale:this.config.scale.default;Object.defineProperty(this,"scale",{get:function(){return c},set:function(t){if(c=t,this.instance&&this.instance.length>1&&this.instance[1]instanceof Cesium.BillboardCollection)for(var e=0;e<this.instance[1]._billboards.length;e++)this.instance[1]._billboards[e].scale=t},enumerable:!0}),this._onCameraChange=function(){if(e.show){var t={};if(Cesium.Math.toDegrees(_cesium.camera.pitch)<-25){var n=!0,i=!1,r=void 0;try{for(var s,a=m()(o);!(n=(s=a.next()).done);n=!0){var l=s.value;l[0].show=!0,l[1].show=!0}}catch(t){i=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}}else{for(var u=0;u<_cesium._container.clientWidth/100;u++)for(var c=0;c<_cesium._container.clientHeight/100;c++)t[u+"_"+c]=!1;var h=_cesium.camera,p=h.frustum.computeCullingVolume(h.positionWC,h.directionWC,h.upWC),f=!0,d=!1,g=void 0;try{for(var y,_=m()(o);!(f=(y=_.next()).done);f=!0){var v=y.value;v[0].show=!0,v[1].show=!0}}catch(t){d=!0,g=t}finally{try{!f&&_.return&&_.return()}finally{if(d)throw g}}for(var x=o.filter((function(t){var e=t[0],n=new Cesium.BoundingSphere(t[0].position,10),i=p.computeVisibility(n),r=_cesium.camera.distanceToBoundingSphere(n);return e.distance=r,(i===Cesium.Intersect.INSIDE||i===Cesium.Intersect.INTERSECTING)&&r>=e.distanceDisplayCondition.near&&r<=e.distanceDisplayCondition.far})).sort((function(t,e){return t[0].distance-e[0].distance})),C=.2*_cesium._container.clientHeight/100,w=0;w<x.length;w++){var b=x[w],E=Cesium.SceneTransforms.wgs84ToDrawingBufferCoordinates(_cesium.scene,b[0].position);if(!(!E||isNaN(E.x)||isNaN(E.y)||E.x<0||E.y<0||E.x>_cesium._container.clientWidth||E.y>_cesium._container.clientHeight)){var I=parseInt(E.x/100),P=parseInt(E.y/100);P>C&&!t[I+"_"+P]?(t[I+"_"+P]=!0,b[0].show=!0,b[1].show=!0):(b[0].show=!1,b[1].show=!1)}}}}};var h=t.hasOwnProperty("collision")?1==t.collision:this.config.collision.default;Object.defineProperty(this,"collision",{get:function(){return h},set:function(t){h!=t&&((h=!!t)?_cesium.camera.changed.addEventListener(this._onCameraChange):_cesium.camera.changed.removeEventListener(this._onCameraChange))}});this.destroy=function(){this.instance.forEach((function(t){_cesium.scene.primitives.remove(t),t.destroy()})),this.collision&&_cesium.camera.changed.removeEventListener(this._onCameraChange),this.instance=[]},n.$axios.get(this.url).then((function(t){t.features.forEach((function(t){var n=t,a=Cesium.Cartesian3.fromDegrees(t.properties.x,t.properties.y,(t.properties.z||0)+2);if(!s.includes(n.properties.poi_type)||"AOI"!=n.properties.exttype){var l=function(t){t.width,t.width;var e=t.name||"",n=t.font||"bold 13px 微软雅黑",i=t.strokeStyle||"#000033",r=t.fillStyle||"#FFF",o=(t.lineWidth,t.showBackground,t.backgroundColor,document.createElement("canvas"));if(e.includes("^")){var s=e.split("^");o.width=15*Math.max(s[0].length,s[1].length)}else o.width=15*e.length;o.height=40;var a=o.getContext("2d");if(a.lineWidth=2,a.font=n,e.includes("^")){s=e.split("^");a.strokeStyle=i,a.strokeText(s[0],2,o.height/3),a.fillStyle=r,a.fillText(s[0],2,o.height/3),a.strokeStyle=i,a.strokeText(s[1],2,2*o.height/3),a.fillStyle=r,a.fillText(s[1],2,2*o.height/3)}else a.strokeStyle=i,a.strokeText(e,2,o.height/2),a.fillStyle=r,a.fillText(e,2,o.height/2);return o}({name:t.properties.name_r,font:"14px Microsoft Yahei",strokeStyle:"#000033",fillStyle:"#FFF"}),c=e.billboards.add({position:a,image:l,scale:e.scale,pixelOffset:new Cesium.Cartesian2(0,0),distanceDisplayCondition:new Cesium.DistanceDisplayCondition(i[t.properties.far],i[t.properties.final_zoom])});c.properties=n.properties;var h=t.properties.name_r.includes("^")?new Cesium.Cartesian2(0,-30):new Cesium.Cartesian2(0,-20);_cesium._container.clientWidth>4500&&(h=t.properties.name_r.includes("^")?new Cesium.Cartesian2(0,-55):new Cesium.Cartesian2(0,-40));var p=e.billboards.add({position:a,image:u.a.RelativePath+"assets/poi/"+r[t.properties.poi_type.toString()]+".png",scale:.5*e.scale,pixelOffset:h,distanceDisplayCondition:new Cesium.DistanceDisplayCondition(i[t.properties.far],i[t.properties.final_zoom])});p.properties=n.properties,t.properties.final_zoom<15&&(c.disableDepthTestDistance=1e6,p.disableDepthTestDistance=1e6),p.qname=t.properties.name_r,o.push([c,p])}})),e.collision?(_cesium.camera.changed.addEventListener(e._onCameraChange),e._onCameraChange()):_cesium.camera.changed.removeEventListener(e._onCameraChange)}))},u.a.VectorPoi.prototype=new u.a.Element,u.a.VectorPoi.prototype.type="VectorPoi";u.a.VectorPoi;!function(){var t=window.Cesium,e=t.BoxGeometry,n=t.Cartesian3,i=t.defaultValue,r=t.defined,o=t.destroyObject,s=t.DeveloperError,a=t.GeometryPipeline,l=t.Matrix3,u=t.Matrix4,c=t.Transforms,h=t.VertexFormat,p=t.BufferUsage,f=t.CubeMap,d=t.DrawCommand,y=t.loadCubeMap,m=t.RenderState,_=t.VertexArray,v=t.BlendingState,x=t.SceneMode,C=t.ShaderProgram,w=t.ShaderSource;function b(t){this.sources=t.sources,this._sources=void 0,this.show=i(t.show,!0),this._command=new d({modelMatrix:u.clone(u.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0,this.nearGround=t.nearGround}t.defined(t.Matrix4.getRotation)||(t.Matrix4.getRotation=t.Matrix4.getMatrix3);new l;b.prototype.update=function(t,i){var o=this;if(this.show&&(t.mode===x.SCENE3D||t.mode===x.MORPHING)&&t.passes.render){var d=t.context;if(this._sources!==this.sources){this._sources=this.sources;var b=this.sources;if(!(r(b.positiveX)&&r(b.negativeX)&&r(b.positiveY)&&r(b.negativeY)&&r(b.positiveZ)&&r(b.negativeZ)))throw new s("this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");if(g()(b.positiveX)!==g()(b.negativeX)||g()(b.positiveX)!==g()(b.positiveY)||g()(b.positiveX)!==g()(b.negativeY)||g()(b.positiveX)!==g()(b.positiveZ)||g()(b.positiveX)!==g()(b.negativeZ))throw new s("this.sources properties must all be the same type.");"string"==typeof b.positiveX?y(d,this._sources).then((function(t){o._cubeMap=o._cubeMap&&o._cubeMap.destroy(),o._cubeMap=t})):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new f({context:d,source:b}))}var E=this._command;if(E.modelMatrix=c.eastNorthUpToFixedFrame(t.camera._positionWC),!r(E.vertexArray)){E.uniformMap={u_cubeMap:function(){return o._cubeMap},u_rotateMatrix:function(){return o.nearGround?(E.modelMatrix=c.eastNorthUpToFixedFrame(t.camera._positionWC),u.getMatrix3(E.modelMatrix,new l)):l.IDENTITY}};var I=e.createGeometry(e.fromDimensions({dimensions:new n(2,2,2),vertexFormat:h.POSITION_ONLY})),P=this._attributeLocations=a.createAttributeLocations(I);E.vertexArray=_.fromGeometry({context:d,geometry:I,attributeLocations:P,bufferUsage:p._DRAW}),E.renderState=m.fromCache({blending:v.ALPHA_BLEND})}if(!r(E.shaderProgram)||this._useHdr!==i){var N=new w({defines:[i?"HDR":""],sources:["uniform samplerCube u_cubeMap;\n    varying vec3 v_texCoord;\n    void main()\n    {\n    vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));\n    gl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\n    }\n    "]});E.shaderProgram=C.fromCache({context:d,vertexShaderSource:"\n    attribute vec3 position;\n    uniform mat3 u_rotateMatrix;\n    varying vec3 v_texCoord;\n    \n    void main()\n    {\n        vec3 p = czm_viewRotation * u_rotateMatrix * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n        gl_Position = czm_projection * vec4(p, 1.0);\n        v_texCoord = position.xyz;\n    }\n    ",fragmentShaderSource:N,attributeLocations:this._attributeLocations}),this._useHdr=i}if(r(this._cubeMap))return E}},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){var t=this._command;return t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),o(this)},window.Cesium.GroundSkyBox=b}();function Tl(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[.4,.8],i=n[0]+(n[1]-n[0])*(t-e[0])/(e[1]-e[0]);return i}function Ll(t,e){return new l.a((function(n,i){var r=Cesium.Model.fromGltf(e);t.scene.primitives.add(r),r.readyPromise.then((function(){n(r)}),(function(t){i(t)}))}))}function Ml(t,e,n){if(!Dl(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&Fl(i),r&&kl(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function Ol(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Al(t[0])||!Al(t[1]))throw new Error("coordinates must contain numbers");return Ml({type:"Point",coordinates:t},e,n)}function Rl(t,e){if(!Dl(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");n&&Fl(n),i&&kl(i);var r={type:"FeatureCollection"};return i&&(r.id=i),n&&(r.bbox=n),r.features=t,r}function Al(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Dl(t){return!!t&&t.constructor===Object}function Fl(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!Al(t))throw new Error("bbox must only contain numbers")}))}function kl(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function Bl(t){if(Dl(t)&&(t=t.bbox),t&&!Array.isArray(t))throw new Error("bbox is invalid");return t?function(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}(t):[360*jl(),180*jl()]}function Gl(t,e){if(!Dl(e=e||{}))throw new Error("options is invalid");var n=e.bbox;null==t&&(t=1);for(var i=[],r=0;r<t;r++)i.push(Ol(Bl(n)));return Rl(i)}function jl(){return Math.random()-.5}function zl(t,e){if(!ql(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");n&&Vl(n),i&&Hl(i);var r={type:"FeatureCollection"};return i&&(r.id=i),n&&(r.bbox=n),r.features=t,r}function Ul(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function ql(t){return!!t&&t.constructor===Object}function Vl(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!Ul(t))throw new Error("bbox must only contain numbers")}))}function Hl(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}var Yl=function(t,e){if(!t)throw new Error("featurecollection is required");if(null==e)throw new Error("num is required");if("number"!=typeof e)throw new Error("num must be a number");return zl(function(t,e){var n,i,r=t.slice(0),o=t.length,s=o-e;for(;o-- >s;)i=Math.floor((o+1)*Math.random()),n=r[i],r[i]=r[o],r[o]=n;return r.slice(s)}(t.features,e))};function Xl(t){var e=s()({},t),n=e.trace;if(n instanceof u.a.Point3dCollection){e.count=n.points.length;var i=1e8,r=0;n.points.forEach((function(t){i=Math.min(i,t.height),r=Math.max(r,t.height)})),e.heightRange=[i,r];var o=n.getBounds();e.bounds=[o.min.lng,o.min.lat,o.max.lng,o.max.lat]}return e}var Wl=function(){return(new Date).getTime()};function Kl(){return Wl()/1e3}function Zl(t){var e,n;return"[object Array]"===Object.prototype.toString.call(t)?(n=Cesium.Math).randomBetween.apply(n,h()(t)):(e=Cesium.Math).randomBetween.apply(e,arguments)}function Jl(t,e,n){for(var i=t[2]-t[0],r=t[3]-t[1],o=100*e/13,s=[],a=0;a<3;a++)for(var l=0;l<3;l++){var c=[t[0]+i*l/3,t[1]+r*a/3,t[0]+i*(l+1)/3,t[1]+r*(a+1)/3],p=a===Math.floor(1.5)?5*o:o,f=Gl(Math.round(p),{bbox:c});s=s.concat(f.features)}return Yl({features:s},e).features.map((function(t){var e,i=Zl(n);return(e=new u.a.Point3d).fromLngLat.apply(e,h()(t.geometry.coordinates.concat(i)))}))}window.performance&&(Wl=function(){return window.performance.now()});var Ql=Cesium.Cartesian3.fromDegrees(0,0,0).x*Math.PI/180;function $l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.distance,n=t.direction,i=t.currentPosition,r=e/Ql,o=new Cesium.Cartesian3,s=new(Function.prototype.bind.apply(Cesium.Cartesian3,[null].concat(h()(i.exportLngLatHeightArray())))),a=Cesium.Cartesian3.normalize(new Cesium.Cartesian3(n[0],n[1],0),o),l=Cesium.Cartesian3.multiplyByScalar(a,r,o);Cesium.Cartesian3.add(s,l,o);var c=(new u.a.Point3d).fromLngLat(o.x,o.y,i.height);return c}function tu(t,e){var n=ou(e),i=n.center,r=n.radius;return su(t.exportLngLatArray(),i)<=r}function eu(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:option,e=t.viewer,n=t.bounds,i=t.distanceMoved,r=t.moveDirection,o=t.currentPositions,s=t.dirtyStepCounters,a=t.updateOpacity,l=void 0!==a&&a,c=t.considerTerrain,h=void 0!==c&&c,p=t.opacityRange,f=void 0===p?[0,1]:p,d=t.updateScale,g=void 0!==d&&d,y=t.originalScales,m=void 0===y?[]:y;return o.map((function(t,o){var a=void 0,c=(new u.a.Point3d).fromCartesian(e.camera.position),p=Cesium.Cartesian3.distance(e.camera.position,t.exportCartesian());if(tu(t,n)){var d=p<1e5?5:50,y=(s[o]||0)+i;y>=d?(tu(a=$l({distance:y,direction:r,currentPosition:t}),n)||(a=ru(n,a)),s[o]=0):(s[o]=s[o]||0,s[o]+=i)}else a=ru(n,t);var _=m[o];return!0===g&&(_=nu({viewer:e,scale:m[o],cameraPosition:c,cloudPosition:a||t})),{position:a,opacity:!0===l?iu({viewer:e,position:t,distanceToCamera:p,opacityRange:f,scale:_,considerTerrain:h}):f[1],scale:_}}))}function nu(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:option,e=t.viewer,n=t.scale,i=t.cameraPosition,r=t.cloudPosition;if(i.height<r.height){var o=Cesium.Cartesian3.distance(e.camera.position,r.exportCartesian());return new Cesium.Cartesian2(n.x,n.y*au(o))}return new Cesium.Cartesian2(n.x,n.y)}function iu(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:option,e=t.viewer,n=t.position,i=t.distanceToCamera,r=t.opacityRange,o=(t.scale,t.considerTerrain),s=void 0!==o&&o;if(e.camera.positionCartographic.height>=n.height)return r[1];if(!0===s){var a=e.scene,l=new Cesium.Cartesian3,u=e.camera.getPixelSize(new Cesium.BoundingSphere(n.exportCartesian(),5),a.drawingBufferWidth,a.drawingBufferHeight),c=Cesium.Cartesian3.fromDegrees(n.lng,n.lat,n.height-10*u);Cesium.Cartesian3.subtract(c,e.camera.position,l),Cesium.Cartesian3.normalize(l,l);var h=new Cesium.Ray(e.camera.position,l),p=e.scene.globe.pick(h,e.scene);if(p)return r[0]}return null==i&&(i=Cesium.Cartesian3.distance(e.camera.position,n.exportCartesian())),i<=1e5?r[1]:r[0]+au(i)*(r[1]-r[0])}function ru(t,e){var n=ou(t),i=n.center,r=n.radius,o=su(i,e.exportLngLatArray()),s=Math.min(.99,o/r);return(new u.a.Point3d).fromLngLat(i[0]-s*(e.lng-i[0]),i[1]-s*(e.lat-i[1]),e.height)}function ou(t){return{center:[(t[0]+t[2])/2,(t[1]+t[3])/2],radius:su([t[0],t[1]],[t[2],t[3]])/2}}function su(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function au(t){var e=1;return t>1e5&&(e=Math.min((t-1e5)/9e5,1),e=1-Math.sin(e*Math.PI/2)),e}window.ratioWithDistance=au,u.a.FlatClouds=function(t){var e=void 0;if(e=b(t=Xl(t||{})))throw new Error(e);u.a.Element.call(this,t.id);var n=E.apply(void 0,arguments)||window._sf3d,i=n.viewer;this.option=s()({},t);var r=[],o=[],a=[],c=void 0;this.config={show:{name:"显示",type:u.a.PropertyType.Boolean,default:!0},models:{name:"层云的gltf模型url数组",type:u.a.PropertyType.Array,default:[u.a.RelativePath+"assets/gltf/flatcloud/flatcloud1.gltf",u.a.RelativePath+"assets/gltf/flatcloud/flatcloud2.gltf"],noConfig:!0},scale:{name:"缩放比例",type:u.a.PropertyType.Float,default:5e4},count:{name:"显示",type:u.a.PropertyType.Float,default:50},heightRange:{name:"高度范围",type:u.a.PropertyType.Array,default:[9e3,1e4],noConfig:!0},moveEnabled:{name:"是否移动",type:u.a.PropertyType.Boolean,default:!1},moveDirection:{name:"移动方向",type:u.a.PropertyType.Array,default:[.5,.5],noConfig:!0},moveSpeed:{name:"移动速度",type:u.a.PropertyType.Float,default:300}};var h=t.trace||null,p=!1!==t.show&&this.config.show.default;Object.defineProperty(this,"show",{get:function(){return p},set:function(t){p=!!t,r.forEach((function(t){return t.show=p}))},enumerable:!0});var f=t.models||this.config.models.default,d=isNaN(t.scale)?this.config.scale.default:t.scale;Object.defineProperty(this,"scale",{get:function(){return d},set:function(t){isNaN(t)||(d=t,r.forEach((function(t){return t.scale=d})))},enumerable:!0});var g=isNaN(t.count)?this.config.count.default:t.count;Object.defineProperty(this,"count",{get:function(){return g},set:function(t){isNaN(t)||(g=t,N(),I())},enumerable:!0});var y=t.bounds;Object.defineProperty(this,"bounds",{get:function(){return y},set:function(t){t&&(y=t,N(),I())},enumerable:!0});var m=t.heightRange||this.config.heightRange.default;Object.defineProperty(this,"heightRange",{get:function(){return m},set:function(t){t&&(m=t,N(),I())},enumerable:!0});var _=!0===t.moveEnabled||this.config.moveEnabled.default;Object.defineProperty(this,"moveEnabled",{get:function(){return _},set:function(t){_!=!!t&&(!0===(_=!!t)?(S(),T()):S())},enumerable:!0});var v=t.moveDirection||this.config.moveDirection.default;Object.defineProperty(this,"moveDirection",{get:function(){return v},set:function(t){t&&(v=t)},enumerable:!0});var x=isNaN(t.moveSpeed)?this.config.moveSpeed.default:t.moveSpeed;Object.defineProperty(this,"moveSpeed",{get:function(){return x},set:function(t){isNaN(t)||(x=t)},enumerable:!0}),Object.defineProperty(this,"clouds",{get:function(){return r},enumerable:!1});var C=void 0,w=[];function b(t){return t?t.bounds?null:"option.bounds 不能为空！":"option 不能为空！"}function I(){return new l.a((function(t,e){P(f).then((function(e){!0===_&&(S(),T()),t()}))}))}function P(e){return new l.a((function(n,u){var c=null===h?Jl(y,g,m):h.points;o=c,a=c.map((function(t){return t.clone()}));var p=c.map((function(n){var r=e[Math.round(Zl([0,e.length-1]))],o=s()({url:r,minimumPixelSize:128,scale:d,allowPicking:!1,incrementallyLoadTextures:!0,color:new Cesium.Color(1,1,1,Tl(n.height,m))},t.model||{});return o.modelMatrix=Cesium.Transforms.headingPitchRollToFixedFrame(n.exportCartesian(),new Cesium.HeadingPitchRoll),Ll(i,o)}));l.a.all(p).then((function(t){r=t,n(t)}),(function(t){u(t)}))}))}function N(){S(),r.forEach((function(t){i.scene.primitives.remove(t)})),r.splice(0,r.length),a.splice(0,a.length),o.splice(0,o.length),w.splice(0,w.length)}function S(){c&&c()}function T(){C=Kl(),w=new Array(r.length).fill(0),c=i.scene.postUpdate.addEventListener((function(t,e){try{L({secondsOfDay:Kl()})}catch(t){console.error(t)}}))}function L(t){var e=(t.secondsOfDay+86400-C)%86400;C=t.secondsOfDay;var i=e*x,s=eu({viewer:n.viewer,bounds:y,moveDirection:v,distanceMoved:i,originalPositions:o,currentPositions:a,dirtyStepCounters:w});r.forEach((function(t,e){var n=s[e].position;n&&(t.modelMatrix=Cesium.Transforms.headingPitchRollToFixedFrame(n.exportCartesian(),new Cesium.HeadingPitchRoll),a[e]=n)}))}I(),this.destroy=function(){N()}},u.a.FlatClouds.prototype=new u.a.Element,r()(u.a.FlatClouds.prototype,u.a.EventManager.prototype),u.a.FlatClouds.prototype.type="FlatClouds";var lu=n(119),uu={CUMULUS:0,validate:function(t){return t===uu.CUMULUS}},cu=n.n(lu)()(uu),hu=Cesium,pu=hu.Cartesian2,fu=hu.Cartesian3,du=hu.Check,gu=hu.Color,yu=hu.defaultValue,mu=hu.defined;function _u(t,e){if(t=yu(t,yu.EMPTY_OBJECT),this._show=yu(t.show,!0),this._position=fu.clone(yu(t.position,fu.ZERO)),!mu(t.scale)&&mu(t.maximumSize))this._maximumSize=fu.clone(t.maximumSize),this._scale=new pu(this._maximumSize.x,this._maximumSize.y);else{this._scale=pu.clone(yu(t.scale,new pu(20,12)));var n=new fu(this._scale.x,this._scale.y,Math.min(this._scale.x,this._scale.y)/1.5);this._maximumSize=fu.clone(yu(t.maximumSize,n))}this._slice=yu(t.slice,-1),this._color=gu.clone(yu(t.color,gu.WHITE)),this._brightness=yu(t.brightness,1),this._cloudCollection=e,this._index=-1}var vu=_u.SHOW_INDEX=0,xu=_u.POSITION_INDEX=1,Cu=_u.SCALE_INDEX=2,wu=_u.MAXIMUM_SIZE_INDEX=3,bu=_u.SLICE_INDEX=4,Eu=_u.BRIGHTNESS_INDEX=5,Iu=_u.COLOR_INDEX=6;function Pu(t,e){var n=t._cloudCollection;mu(n)&&(n._updateCloud(t,e),t._dirty=!0)}_u.NUMBER_OF_PROPERTIES=7,j()(_u.prototype,{show:{get:function(){return this._show},set:function(t){du.typeOf.bool("value",t),this._show!==t&&(this._show=t,Pu(this,vu))}},position:{get:function(){return this._position},set:function(t){du.typeOf.object("value",t);var e=this._position;fu.equals(e,t)||(fu.clone(t,e),Pu(this,xu))}},scale:{get:function(){return this._scale},set:function(t){du.typeOf.object("value",t);var e=this._scale;pu.equals(e,t)||(pu.clone(t,e),Pu(this,Cu))}},maximumSize:{get:function(){return this._maximumSize},set:function(t){du.typeOf.object("value",t);var e=this._maximumSize;fu.equals(e,t)||(fu.clone(t,e),Pu(this,wu))}},color:{get:function(){return this._color},set:function(t){du.typeOf.object("value",t);var e=this._color;gu.equals(e,t)||(gu.clone(t,e),Pu(this,Iu))}},slice:{get:function(){return this._slice},set:function(t){du.typeOf.number("value",t),this._slice!==t&&(this._slice=t,Pu(this,bu))}},brightness:{get:function(){return this._brightness},set:function(t){du.typeOf.number("value",t),this._brightness!==t&&(this._brightness=t,Pu(this,Eu))}}}),_u.prototype._destroy=function(){this._cloudCollection=void 0};var Nu,Su=_u,Tu=Cesium,Lu=Tu.BlendingState,Mu=Tu.Buffer,Ou=Tu.BufferUsage,Ru=Tu.Cartesian3,Au=Tu.Check,Du=Tu.Color,Fu=Tu.ComputeCommand,ku=Tu.ComponentDatatype,Bu=Tu.defaultValue,Gu=Tu.defined,ju=Tu.destroyObject,zu=Tu.DeveloperError,Uu=Tu.DrawCommand,qu=Tu.EncodedCartesian3,Vu=Tu.IndexDatatype,Hu=Tu.Pass,Yu=Tu.PixelDatatype,Xu=Tu.PixelFormat,Wu=Tu.RenderState,Ku=Tu.Sampler,Zu=Tu.ShaderSource,Ju=Tu.ShaderProgram,Qu=Tu.Texture,$u=Tu.TextureMagnificationFilter,tc=Tu.TextureMinificationFilter,ec=Tu.TextureWrap,nc=Tu.VertexArray,ic=Tu.VertexArrayFacade,rc=Tu.WebGLConstants,oc=new Ru,sc={positionHighAndScaleX:0,positionLowAndScaleY:1,packedAttribute0:2,packedAttribute1:3,color:4},ac={direction:0,positionHighAndScaleX:1,positionLowAndScaleY:2,packedAttribute0:3,packedAttribute1:4,color:5},lc=Su.SHOW_INDEX,uc=Su.POSITION_INDEX,cc=Su.SCALE_INDEX,hc=Su.MAXIMUM_SIZE_INDEX,pc=Su.SLICE_INDEX,fc=Su.BRIGHTNESS_INDEX,dc=Su.NUMBER_OF_PROPERTIES,gc=Su.COLOR_INDEX;function yc(t){t=Bu(t,Bu.EMPTY_OBJECT),this._clouds=[],this._cloudsToUpdate=[],this._cloudsToUpdateIndex=0,this._cloudsRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(dc),this._noiseTexture=void 0,this._textureSliceWidth=128,this._noiseTextureRows=4,this.noiseDetail=Bu(t.noiseDetail,16),this.noiseOffset=Ru.clone(Bu(t.noiseOffset,Ru.ZERO)),this._loading=!1,this._ready=!1;var e=this;this._uniforms={u_noiseTexture:function(){return e._noiseTexture},u_noiseTextureDimensions:mc(e),u_noiseDetail:function(){return e.noiseDetail}},this._vaNoise=void 0,this._spNoise=void 0,this._spCreated=!1,this._sp=void 0,this._rs=void 0,this.show=Bu(t.show,!0),this._colorCommands=[],this.debugBillboards=Bu(t.debugBillboards,!1),this._compiledDebugBillboards=!1,this.debugEllipsoids=Bu(t.debugEllipsoids,!1),this._compiledDebugEllipsoids=!1}function mc(t){return function(){return oc.x=t._textureSliceWidth,oc.y=t._noiseTextureRows,oc.z=1/t._noiseTextureRows,oc}}function _c(t){for(var e=t.length,n=0;n<e;++n)t[n]&&t[n]._destroy()}function vc(t){if(t._cloudsRemoved){t._cloudsRemoved=!1;for(var e=[],n=t._clouds,i=n.length,r=0,o=0;r<i;++r){var s=n[r];Gu(s)&&(n._index=o++,e.push(s))}t._clouds=e}}j()(yc.prototype,{length:{get:function(){return vc(this),this._clouds.length}}}),yc.prototype.add=function(t){t=Bu(t,Bu.EMPTY_OBJECT);var e,n=Bu(t.cloudType,cu.CUMULUS);if(!cu.validate(n))throw new zu("invalid cloud type");return n===cu.CUMULUS&&((e=new Su(t,this))._index=this._clouds.length,this._clouds.push(e),this._createVertexArray=!0),e},yc.prototype.remove=function(t){return!!this.contains(t)&&(this._clouds[t._index]=void 0,this._cloudsRemoved=!0,this._createVertexArray=!0,t._destroy(),!0)},yc.prototype.removeAll=function(){_c(this._clouds),this._clouds=[],this._cloudsToUpdate=[],this._cloudsToUpdateIndex=0,this._cloudsRemoved=!1,this._createVertexArray=!0},yc.prototype._updateCloud=function(t,e){t._dirty||(this._cloudsToUpdate[this._cloudsToUpdateIndex++]=t),++this._propertiesChanged[e]},yc.prototype.contains=function(t){return Gu(t)&&t._cloudCollection===this},yc.prototype.get=function(t){return Au.typeOf.number("index",t),vc(this),this._clouds[t]};var xc,Cc=new Float32Array([-1,-1,1,-1,1,1,-1,1]),wc=new Uint16Array([0,1,2,0,2,3]);function bc(t){var e=t.cache.cloudCollection_indexBufferBatched;if(Gu(e))return e;for(var n=new Uint16Array(98298),i=0,r=0;i<98298;i+=6,r+=4)n[i]=r,n[i+1]=r+1,n[i+2]=r+2,n[i+3]=r,n[i+4]=r+2,n[i+5]=r+3;return(e=Mu.createIndexBuffer({context:t,typedArray:n,usage:Ou.STATIC_DRAW,indexDatatype:Vu.UNSIGNED_SHORT})).vertexArrayDestroyable=!1,t.cache.cloudCollection_indexBufferBatched=e,e}function Ec(t){var e=t.cache.cloudCollection_indexBufferInstanced;return Gu(e)||((e=Mu.createIndexBuffer({context:t,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:Ou.STATIC_DRAW,indexDatatype:Vu.UNSIGNED_SHORT})).vertexArrayDestroyable=!1,t.cache.cloudCollection_indexBufferInstanced=e),e}function Ic(t){var e=t.cache.cloudCollection_vertexBufferInstanced;return Gu(e)||((e=Mu.createVertexBuffer({context:t,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:Ou.STATIC_DRAW})).vertexArrayDestroyable=!1,t.cache.cloudCollection_vertexBufferInstanced=e),e}var Pc=new qu;function Nc(t,e,n,i){var r,o=n[Nu.positionHighAndScaleX],s=n[Nu.positionLowAndScaleY],a=i.position;qu.fromCartesian(a,Pc);var l=i.scale,u=Pc.high,c=Pc.low;t._instanced?(o(r=i._index,u.x,u.y,u.z,l.x),s(r,c.x,c.y,c.z,l.y)):(o((r=4*i._index)+0,u.x,u.y,u.z,l.x),o(r+1,u.x,u.y,u.z,l.x),o(r+2,u.x,u.y,u.z,l.x),o(r+3,u.x,u.y,u.z,l.x),s(r+0,c.x,c.y,c.z,l.y),s(r+1,c.x,c.y,c.z,l.y),s(r+2,c.x,c.y,c.z,l.y),s(r+3,c.x,c.y,c.z,l.y))}function Sc(t,e,n,i){var r,o=n[Nu.packedAttribute0],s=i.show,a=i.brightness;t._instanced?o(r=i._index,s,a,0,0):(o((r=4*i._index)+0,s,a,0,0),o(r+1,s,a,1,0),o(r+2,s,a,1,1),o(r+3,s,a,0,1))}function Tc(t,e,n,i){var r,o=n[Nu.packedAttribute1],s=i.maximumSize,a=i.slice;t._instanced?o(r=i._index,s.x,s.y,s.z,a):(o((r=4*i._index)+0,s.x,s.y,s.z,a),o(r+1,s.x,s.y,s.z,a),o(r+2,s.x,s.y,s.z,a),o(r+3,s.x,s.y,s.z,a))}function Lc(t,e,n,i){var r,o=n[Nu.color],s=i.color,a=Du.floatToByte(s.red),l=Du.floatToByte(s.green),u=Du.floatToByte(s.blue),c=Du.floatToByte(s.alpha);t._instanced?o(r=i._index,a,l,u,c):(o((r=4*i._index)+0,a,l,u,c),o(r+1,a,l,u,c),o(r+2,a,l,u,c),o(r+3,a,l,u,c))}function Mc(t,e,n,i){Nc(t,0,n,i),Sc(t,0,n,i),Tc(t,0,n,i),Lc(t,0,n,i)}function Oc(t,e,n,i){var r=t,o=r._textureSliceWidth,s=r._noiseTextureRows;if(o/s<1||o%s!=0)throw new zu("noiseTextureRows must evenly divide textureSliceWidth");var a=e.context;r._vaNoise=function(t){var e=Mu.createVertexBuffer({context:t,typedArray:Cc,usage:Ou.STATIC_DRAW}),n=Mu.createIndexBuffer({context:t,typedArray:wc,usage:Ou.STATIC_DRAW,indexDatatype:Vu.UNSIGNED_SHORT}),i=[{index:0,vertexBuffer:e,componentsPerAttribute:2,componentDatatype:ku.FLOAT}];return new nc({context:t,attributes:i,indexBuffer:n})}(a),r._spNoise=Ju.fromCache({context:a,vertexShaderSource:n,fragmentShaderSource:i,attributeLocations:{position:0}});var l=r.noiseDetail,u=r.noiseOffset;r._noiseTexture=new Qu({context:a,width:o*o/s,height:o*s,pixelDatatype:Yu.UNSIGNED_BYTE,pixelFormat:Xu.RGBA,sampler:new Ku({wrapS:ec.REPEAT,wrapT:ec.REPEAT,minificationFilter:tc.NEAREST,magnificationFilter:$u.NEAREST})});var c=new Fu({vertexArray:r._vaNoise,shaderProgram:r._spNoise,outputTexture:r._noiseTexture,uniformMap:{u_noiseTextureDimensions:mc(r),u_noiseDetail:function(){return l},u_noiseOffset:function(){return u}},persists:!1,owner:t,postExecute:function(t){r._ready=!0,r._loading=!1}});e.commandList.push(c),r._loading=!0}function Rc(t,e){var n=t,i=e.context;n._createVertexArray=!1,n._vaf=n._vaf&&n._vaf.destroy();var r=t._clouds,o=r.length;if(o>0){n._vaf=function(t,e,n){var i=[{index:Nu.positionHighAndScaleX,componentsPerAttribute:4,componentDatatype:ku.FLOAT,usage:Ou.STATIC_DRAW},{index:Nu.positionLowAndScaleY,componentsPerAttribute:4,componentDatatype:ku.FLOAT,usage:Ou.STATIC_DRAW},{index:Nu.packedAttribute0,componentsPerAttribute:4,componentDatatype:ku.FLOAT,usage:Ou.STATIC_DRAW},{index:Nu.packedAttribute1,componentsPerAttribute:4,componentDatatype:ku.FLOAT,usage:Ou.STATIC_DRAW},{index:Nu.color,componentsPerAttribute:4,componentDatatype:ku.UNSIGNED_BYTE,normalize:!0,usage:Ou.STATIC_DRAW}];return n&&i.push({index:Nu.direction,componentsPerAttribute:2,componentDatatype:ku.FLOAT,vertexBuffer:Ic(t)}),new ic(t,i,n?e:4*e,n)}(i,o,n._instanced);var s,a=n._vaf.writers;for(s=0;s<o;++s){Mc(t,0,a,r[s])}n._vaf.commit(xc(i))}}var Ac=[];yc.prototype.update=function(t){if(vc(this),this.show){var e=this.debugBillboards||this.debugEllipsoids;this._ready=!!e||Gu(this._noiseTexture),this._ready||this._loading||e||Oc(this,t,"uniform vec3 u_noiseTextureDimensions;\nattribute vec2 position;\n\nvarying vec2 v_position;\n\nvoid main()\n{\n    gl_Position = vec4(position, 0.1, 1.0);\n\n    float textureSliceWidth = u_noiseTextureDimensions.x;\n    float noiseTextureRows = u_noiseTextureDimensions.y;\n    float inverseNoiseTextureRows = u_noiseTextureDimensions.z;\n    vec2 transformedPos = (position * 0.5) + vec2(0.5);\n    transformedPos *= textureSliceWidth;\n    transformedPos.x *= textureSliceWidth * inverseNoiseTextureRows;\n    transformedPos.y *= noiseTextureRows;\n    v_position = transformedPos;\n}\n","uniform vec3 u_noiseTextureDimensions;\nuniform float u_noiseDetail;\nuniform vec3 u_noiseOffset;\nvarying vec2 v_position;\n\nfloat textureSliceWidth = u_noiseTextureDimensions.x;\nfloat inverseNoiseTextureRows = u_noiseTextureDimensions.z;\n\nfloat wrap(float value, float rangeLength) {\n    if(value < 0.0) {\n        float absValue = abs(value);\n        float modValue = mod(absValue, rangeLength);\n        return mod(rangeLength - modValue, rangeLength);\n    }\n    return mod(value, rangeLength);\n}\n\nvec3 wrapVec(vec3 value, float rangeLength) {\n    return vec3(wrap(value.x, rangeLength),\n                wrap(value.y, rangeLength),\n                wrap(value.z, rangeLength));\n}\n\nvec3 random3(vec3 p) {\n    float dot1 = dot(p, vec3(127.1, 311.7, 932.8));\n    float dot2 = dot(p, vec3(269.5, 183.3, 421.4));\n    return fract(vec3(sin(dot1 - dot2), cos(dot1 * dot2), dot1 * dot2));\n}\n\n// Frequency corresponds to cell size.\n// The higher the frequency, the smaller the cell size.\nvec3 getWorleyCellPoint(vec3 centerCell, vec3 offset, float freq) {\n    vec3 cell = centerCell + offset;\n    cell = wrapVec(cell, textureSliceWidth / u_noiseDetail);\n    cell += floor(u_noiseOffset / u_noiseDetail);\n    vec3 p = offset + random3(cell);\n    return p;\n}\n\nfloat worleyNoise(vec3 p, float freq) {\n    vec3 centerCell = floor(p * freq);\n    vec3 pointInCell = fract(p * freq);\n    float shortestDistance = 1000.0;\n\n    for(float z = -1.0; z <= 1.0; z++) {\n        for(float y = -1.0; y <= 1.0; y++) {\n            for(float x = -1.0; x <= 1.0; x++) {\n                vec3 offset = vec3(x, y, z);\n                vec3 point = getWorleyCellPoint(centerCell, offset, freq);\n\n                float distance = length(pointInCell - point);\n                if(distance < shortestDistance) {\n                    shortestDistance = distance;\n                }\n            }\n        }\n    }\n\n    return shortestDistance;\n}\n\nconst float MAX_FBM_ITERATIONS = 10.0;\n\nfloat worleyFBMNoise(vec3 p, float octaves, float scale) {\n    float noise = 0.0;\n    float freq = 1.0;\n    float persistence = 0.625;\n    for(float i = 0.0; i < MAX_FBM_ITERATIONS; i++) {\n        if(i >= octaves) {\n            break;\n        }\n\n        noise += worleyNoise(p * scale, freq * scale) * persistence;\n        persistence *= 0.5;\n        freq *= 2.0;\n    }\n    return noise;\n}\n\nvoid main() {\n    float x = mod(v_position.x, textureSliceWidth);\n    float y = mod(v_position.y, textureSliceWidth);\n    float sliceRow = floor(v_position.y / textureSliceWidth);\n    float z = floor(v_position.x / textureSliceWidth) + sliceRow * inverseNoiseTextureRows * textureSliceWidth;\n\n    vec3 position = vec3(x, y, z);\n    position /= u_noiseDetail;\n    float worley0 = clamp(worleyFBMNoise(position, 3.0, 1.0), 0.0, 1.0);\n    float worley1 = clamp(worleyFBMNoise(position, 3.0, 2.0), 0.0, 1.0);\n    float worley2 = clamp(worleyFBMNoise(position, 3.0, 3.0), 0.0, 1.0);\n    gl_FragColor = vec4(worley0, worley1, worley2, 1.0);\n}\n"),this._instanced=t.context.instancedArrays,Nu=this._instanced?ac:sc,xc=this._instanced?Ec:bc;var n=this._clouds.length,i=this._cloudsToUpdate,r=this._cloudsToUpdateIndex;this._createVertexArray?Rc(this,t):r>0&&function(t,e){var n=e.context,i=t,r=i._clouds.length,o=i._cloudsToUpdate,s=i._cloudsToUpdateIndex,a=i._propertiesChanged,l=Ac;l.length=0,(a[uc]||a[cc])&&l.push(Nc),(a[lc]||a[fc])&&l.push(Sc),(a[hc]||a[pc])&&l.push(Tc),a[gc]&&l.push(Lc);var u,c,h,p=l.length,f=i._vaf.writers;if(s/r>.1){for(u=0;u<s;++u)for((c=o[u])._dirty=!1,h=0;h<p;++h)l[h](t,e,f,c);i._vaf.commit(xc(n))}else{for(u=0;u<s;++u){for((c=o[u])._dirty=!1,h=0;h<p;++h)l[h](t,e,f,c);i._instanced?i._vaf.subCommit(c._index,1):i._vaf.subCommit(4*c._index,4)}i._vaf.endSubCommits()}i._cloudsToUpdateIndex=0}(this,t),r>1.5*n&&(i.length=n),!Gu(this._vaf)||!Gu(this._vaf.va)||!this._ready&!e||(this._spCreated&&this.debugBillboards===this._compiledDebugBillboards&&this.debugEllipsoids===this._compiledDebugEllipsoids||function(t,e,n,i){var r=e.context,o=t,s=new Zu({defines:[],sources:[n]});o._instanced&&s.defines.push("INSTANCED");var a=new Zu({defines:[],sources:[i]});o.debugBillboards&&a.defines.push("DEBUG_BILLBOARDS"),o.debugEllipsoids&&a.defines.push("DEBUG_ELLIPSOIDS"),o._sp=Ju.replaceCache({context:r,shaderProgram:o._sp,vertexShaderSource:s,fragmentShaderSource:a,attributeLocations:Nu}),o._rs=Wu.fromCache({depthTest:{enabled:!0,func:rc.LESS},depthMask:!1,blending:Lu.ALPHA_BLEND}),o._spCreated=!0,o._compiledDebugBillboards=o.debugBillboards,o._compiledDebugEllipsoids=o.debugEllipsoids}(this,t,"#ifdef INSTANCED\nattribute vec2 direction;\n#endif\nattribute vec4 positionHighAndScaleX;\nattribute vec4 positionLowAndScaleY;\nattribute vec4 packedAttribute0;\nattribute vec4 packedAttribute1;\nattribute vec4 color;\n\nvarying vec2 v_offset;\nvarying vec3 v_maximumSize;\nvarying vec4 v_color;\nvarying float v_slice;\nvarying float v_brightness;\n\nvoid main() {\n    // Unpack attributes.\n    vec3 positionHigh = positionHighAndScaleX.xyz;\n    vec3 positionLow = positionLowAndScaleY.xyz;\n    vec2 scale = vec2(positionHighAndScaleX.w, positionLowAndScaleY.w);\n\n    float show = packedAttribute0.x;\n    float brightness = packedAttribute0.y;\n    vec2 coordinates = packedAttribute0.wz;\n    vec3 maximumSize = packedAttribute1.xyz;\n    float slice = packedAttribute1.w;\n\n#ifdef INSTANCED\n    vec2 dir = direction;\n#else\n    vec2 dir = coordinates;\n#endif\n\n    vec2 offset = dir - vec2(0.5, 0.5);\n    vec2 scaledOffset = scale * offset;\n    vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\n    vec4 positionEC = czm_modelViewRelativeToEye * p;\n    positionEC.xy += scaledOffset;\n    \n    positionEC.xyz *= show;\n    gl_Position = czm_projection * positionEC;\n\n    v_offset = offset;\n    v_maximumSize = maximumSize;\n    v_color = color;\n    v_slice = slice;\n    v_brightness = brightness;\n}\n","uniform sampler2D u_noiseTexture;\nuniform vec3 u_noiseTextureDimensions;\nuniform float u_noiseDetail;\nvarying vec2 v_offset;\nvarying vec3 v_maximumSize;\nvarying vec4 v_color;\nvarying float v_slice;\nvarying float v_brightness;\n\nfloat wrap(float value, float rangeLength) {\n    if(value < 0.0) {\n        float absValue = abs(value);\n        float modValue = mod(absValue, rangeLength);\n        return mod(rangeLength - modValue, rangeLength);\n    }\n    return mod(value, rangeLength);\n}\n\nvec3 wrapVec(vec3 value, float rangeLength) {\n    return vec3(wrap(value.x, rangeLength),\n                wrap(value.y, rangeLength),\n                wrap(value.z, rangeLength));\n}\n\nfloat textureSliceWidth = u_noiseTextureDimensions.x;\nfloat noiseTextureRows = u_noiseTextureDimensions.y;\nfloat inverseNoiseTextureRows = u_noiseTextureDimensions.z;\n\nfloat textureSliceWidthSquared = textureSliceWidth * textureSliceWidth;\nvec2 inverseNoiseTextureDimensions = vec2(noiseTextureRows / textureSliceWidthSquared,\n                                          inverseNoiseTextureRows / textureSliceWidth);\n\nvec2 voxelToUV(vec3 voxelIndex) {\n    vec3 wrappedIndex = wrapVec(voxelIndex, textureSliceWidth);\n    float column = mod(wrappedIndex.z, textureSliceWidth * inverseNoiseTextureRows);\n    float row = floor(wrappedIndex.z / textureSliceWidth * noiseTextureRows);\n\n    float xPixelCoord = wrappedIndex.x + column * textureSliceWidth;\n    float yPixelCoord = wrappedIndex.y + row * textureSliceWidth;\n    return vec2(xPixelCoord, yPixelCoord) * inverseNoiseTextureDimensions;\n}\n\n// Interpolate a voxel with its neighbor (along the positive X-axis)\nvec4 lerpSamplesX(vec3 voxelIndex, float x) {\n    vec2 uv0 = voxelToUV(voxelIndex);\n    vec2 uv1 = voxelToUV(voxelIndex + vec3(1.0, 0.0, 0.0));\n    vec4 sample0 = texture2D(u_noiseTexture, uv0);\n    vec4 sample1 = texture2D(u_noiseTexture, uv1);\n    return mix(sample0, sample1, x);\n}\n\nvec4 sampleNoiseTexture(vec3 position) {\n    vec3 recenteredPos = position + vec3(textureSliceWidth / 2.0);\n    vec3 lerpValue = fract(recenteredPos);\n    vec3 voxelIndex = floor(recenteredPos);\n\n    vec4 xLerp00 = lerpSamplesX(voxelIndex, lerpValue.x);\n    vec4 xLerp01 = lerpSamplesX(voxelIndex + vec3(0.0, 0.0, 1.0), lerpValue.x);\n    vec4 xLerp10 = lerpSamplesX(voxelIndex + vec3(0.0, 1.0, 0.0), lerpValue.x);\n    vec4 xLerp11 = lerpSamplesX(voxelIndex + vec3(0.0, 1.0, 1.0), lerpValue.x);\n\n    vec4 yLerp0 = mix(xLerp00, xLerp10, lerpValue.y);\n    vec4 yLerp1 = mix(xLerp01, xLerp11, lerpValue.y);\n    return mix(yLerp0, yLerp1, lerpValue.z);\n}\n\n// Intersection with a unit sphere with radius 0.5 at center (0, 0, 0).\nbool intersectSphere(vec3 origin, vec3 dir, float slice,\n                     out vec3 point, out vec3 normal) {\n    float A = dot(dir, dir);\n    float B = dot(origin, dir);\n    float C = dot(origin, origin) - 0.25;\n    float discriminant = (B * B) - (A * C);\n    if(discriminant < 0.0) {\n        return false;\n    }\n    float root = sqrt(discriminant);\n    float t = (-B - root) / A;\n    if(t < 0.0) {\n        t = (-B + root) / A;\n    }\n    point = origin + t * dir;\n\n    if(slice >= 0.0) {\n        point.z = (slice / 2.0) - 0.5;\n        if(length(point) > 0.5) {\n            return false;\n        }\n    }\n\n    normal = normalize(point);\n    point -= czm_epsilon2 * normal;\n    return true;\n}\n\n// Transforms the ray origin and direction into unit sphere space,\n// then transforms the result back into the ellipsoid's space.\nbool intersectEllipsoid(vec3 origin, vec3 dir, vec3 center, vec3 scale, float slice,\n                        out vec3 point, out vec3 normal) {\n    if(scale.x <= 0.01 || scale.y < 0.01 || scale.z < 0.01) {\n        return false;\n    }\n\n    vec3 o = (origin - center) / scale;\n    vec3 d = dir / scale;\n    vec3 p, n;\n    bool intersected = intersectSphere(o, d, slice, p, n);\n    if(intersected) {\n        point = (p * scale) + center;\n        normal = n;\n    }\n    return intersected;\n}\n\n// Assume that if phase shift is being called for octave i,\n// the frequency is of i - 1. This saves us from doing extra\n// division / multiplication operations.\nvec2 phaseShift2D(vec2 p, vec2 freq) {\n    return (czm_pi / 2.0) * sin(freq.yx * p.yx);\n}\n\nvec2 phaseShift3D(vec3 p, vec2 freq) {\n    return phaseShift2D(p.xy, freq) + czm_pi * vec2(sin(freq.x * p.z));\n}\n\n// The cloud texture function derived from Gardner's 1985 paper,\n// \"Visual Simulation of Clouds.\"\n// https://www.cs.drexel.edu/~david/Classes/Papers/p297-gardner.pdf\nconst float T0    = 0.6;  // contrast of the texture pattern\nconst float k     = 0.1;  // computed to produce a maximum value of 1\nconst float C0    = 0.8;  // coefficient\nconst float FX0   = 0.6;  // frequency X\nconst float FY0   = 0.6;  // frequency Y\nconst int octaves = 5;\n\nfloat T(vec3 point) {\n    vec2 sum = vec2(0.0);\n    float Ci = C0;\n    vec2 FXY = vec2(FX0, FY0);\n    vec2 PXY = vec2(0.0);\n    for(int i = 1; i <= octaves; i++) {\n        PXY = phaseShift3D(point, FXY);\n        Ci *= 0.707;\n        FXY *= 2.0;\n        vec2 sinTerm = sin(FXY * point.xy + PXY);\n        sum += Ci * sinTerm + vec2(T0);\n    }\n    return k * sum.x * sum.y;\n}\n\nconst float a = 0.5;  // fraction of surface reflection due to ambient or scattered light,\nconst float t = 0.4;  // fraction of texture shading\nconst float s = 0.25; // fraction of specular reflection\n\nfloat I(float Id, float Is, float It) {\n    return (1.0 - a) * ((1.0 - t) * ((1.0 - s) * Id + s * Is) + t * It) + a;\n}\n\nconst vec3 lightDir = normalize(vec3(0.2, -1.0, 0.7));\n\nvec4 drawCloud(vec3 rayOrigin, vec3 rayDir, vec3 cloudCenter, vec3 cloudScale, float cloudSlice,\n               float brightness) {\n    vec3 cloudPoint, cloudNormal;\n    if(!intersectEllipsoid(rayOrigin, rayDir, cloudCenter, cloudScale, cloudSlice,\n                            cloudPoint, cloudNormal)) {\n        return vec4(0.0);\n    }\n\n    float Id = clamp(dot(cloudNormal, -lightDir), 0.0, 1.0);  // diffuse reflection\n    float Is = max(pow(dot(-lightDir, -rayDir), 2.0), 0.0);   // specular reflection\n    float It = T(cloudPoint);                                 // texture function\n    float intensity = I(Id, Is, It);\n    vec3 color = vec3(intensity * clamp(brightness, 0.1, 1.0));\n\n    vec4 noise = sampleNoiseTexture(u_noiseDetail * cloudPoint);\n    float W = noise.x;\n    float W2 = noise.y;\n    float W3 = noise.z;\n\n    // The dot product between the cloud's normal and the ray's direction is greatest\n    // in the center of the ellipsoid's surface. It decreases towards the edge.\n    // Thus, it is used to blur the areas leading to the edges of the ellipsoid,\n    // so that no harsh lines appear.\n\n    // The first (and biggest) layer of worley noise is then subtracted from this.\n    // The final result is scaled up so that the base cloud is not too translucent.\n    float ndDot = clamp(dot(cloudNormal, -rayDir), 0.0, 1.0);\n    float TR = pow(ndDot, 3.0) - W; // translucency\n    TR *= 1.3;\n\n    // Subtracting the second and third layers of worley noise is more complicated.\n    // If these layers of noise were simply subtracted from the current translucency,\n    // the shape derived from the first layer of noise would be completely deleted.\n    // The erosion of this noise should thus be constricted to the edges of the cloud.\n    // However, because the edges of the ellipsoid were already blurred away, mapping\n    // the noise to (1.0 - ndDot) will have no impact on most of the cloud's appearance.\n    // The value of (0.5 - ndDot) provides the best compromise.\n    float minusDot = 0.5 - ndDot;\n\n    // Even with the previous calculation, subtracting the second layer of wnoise\n    // erode too much of the cloud. The addition of it, however, will detailed\n    // volume to the cloud. As long as the noise is only added and not subtracted,\n    // the results are aesthetically pleasing.\n\n    // The minusDot product is mapped in a way that it is larger at the edges of\n    // the ellipsoid, so a subtraction and min operation are used instead of\n    // an addition and max one.\n    TR -= min(minusDot * W2, 0.0);\n\n    // The third level of worley noise is subtracted from the result, with some\n    // modifications. First, a scalar is added to minusDot so that the noise\n    // starts affecting the shape farther away from the center of the ellipsoid's\n    // surface. Then, it is scaled down so its impact is not too intense.\n    TR -= 0.8 * (minusDot + 0.25) * W3;\n\n    // The texture function's shading does not correlate with the shape of the cloud\n    // produced by the layers of noise, so an extra shading scalar is calculated.\n    // The darkest areas of the cloud are assigned to be where the noise erodes\n    // the cloud the most. This is then interpolated based on the translucency\n    // and the diffuse shading term of that point in the cloud.\n    float shading = mix(1.0 - 0.8 * W * W, 1.0, Id * TR);\n\n    // To avoid values that are too dark, this scalar is increased by a small amount\n    // and clamped so it never goes to zero.\n    shading = clamp(shading + 0.2, 0.3, 1.0);\n\n    // Finally, the contrast of the cloud's color is increased.\n    vec3 finalColor = mix(vec3(0.5), shading * color, 1.15);\n    return vec4(finalColor, clamp(TR, 0.0, 1.0)) * v_color;\n}\n\nvoid main() {\n#ifdef DEBUG_BILLBOARDS\n    gl_FragColor = vec4(0.0, 0.5, 0.5, 1.0);\n#endif\n    // To avoid calculations with high values,\n    // we raycast from an arbitrarily smaller space.\n    vec2 coordinate = v_maximumSize.xy * v_offset;\n\n    vec3 ellipsoidScale = 0.82 * v_maximumSize;\n    vec3 ellipsoidCenter = vec3(0.0);\n\n    float zOffset = max(ellipsoidScale.z - 10.0, 0.0);\n    vec3 eye = vec3(0, 0, -10.0 - zOffset);\n    vec3 rayDir = normalize(vec3(coordinate, 1.0) - eye);\n    vec3 rayOrigin = eye;\n#ifdef DEBUG_ELLIPSOIDS\n    vec3 point, normal;\n    if(intersectEllipsoid(rayOrigin, rayDir, ellipsoidCenter, ellipsoidScale, v_slice,\n                          point, normal)) {\n        gl_FragColor = v_brightness * v_color;\n    }\n#else\n#ifndef DEBUG_BILLBOARDS\n    vec4 cloud = drawCloud(rayOrigin, rayDir,\n                           ellipsoidCenter, ellipsoidScale, v_slice, v_brightness);\n    if(cloud.w < 0.01) {\n        discard;\n    }\n    gl_FragColor = cloud;\n#endif\n#endif\n}\n"),function(t,e){var n=t,i=e.passes,r=n._uniforms,o=e.commandList;if(i.render){var s=n._colorCommands,a=n._vaf.va,l=a.length;s.length=l;for(var u=0;u<l;u++){var c=s[u];Gu(c)||(c=s[u]=new Uu),c.pass=Hu.TRANSLUCENT,c.owner=t,c.uniformMap=r,c.count=a[u].indicesCount,c.vertexArray=a[u].va,c.shaderProgram=n._sp,c.renderState=n._rs,n._instanced&&(c.count=6,c.instanceCount=n._clouds.length),o.push(c)}}}(this,t))}},yc.prototype.isDestroyed=function(){return!1},yc.prototype.destroy=function(){return this._noiseTexture=this._noiseTexture&&this._noiseTexture.destroy(),this._sp=this._sp&&this._sp.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),_c(this._clouds),ju(this)};var Dc=yc;function Fc(t){var e=Zl(15e3,2e4)*t,n=e/2-Zl(0,e/4);return new Cesium.Cartesian2(e,n)}function kc(){var t=Zl(5,20),e=Zl(1.5,2.1),n=Zl(5,20);return new Cesium.Cartesian3(e*n,n,t)}Sf3d.CumulusClouds=function(t){var e=void 0;if(e=T(t=Xl(t||{})))throw new Error(e);Sf3d.Element.call(this,t.id);var n=E.apply(void 0,arguments)||window._sf3d,i=n.viewer;this.option=s()({},t),this.config={show:{name:"显示",type:Sf3d.PropertyType.Boolean,default:!0},scale:{name:"缩放比例",type:Sf3d.PropertyType.Float,default:1},count:{name:"显示",type:Sf3d.PropertyType.Float,default:50},heightRange:{name:"高度范围",type:Sf3d.PropertyType.Array,default:[5e3,6e3],noConfig:!0},color:{name:"颜色",type:Sf3d.PropertyType.Color,default:new Sf3d.Color(255,255,255,.9)},brightness:{name:"亮度",type:Sf3d.PropertyType.Float,default:1},moveEnabled:{name:"是否移动",type:Sf3d.PropertyType.Boolean,default:!1},moveDirection:{name:"移动方向",type:Sf3d.PropertyType.Array,default:[.5,.5],noConfig:!0},moveSpeed:{name:"移动速度",type:Sf3d.PropertyType.Float,default:300}};var r=t.trace||null,o=!1!==t.show&&this.config.show.default;Object.defineProperty(this,"show",{get:function(){return o},set:function(t){o=!!t,v.show=o},enumerable:!0});var a=isNaN(t.scale)?this.config.scale.default:t.scale;Object.defineProperty(this,"scale",{get:function(){return a},set:function(t){if(!isNaN(t)&&t!=a){a=t;for(var e=0;e<v.length;e++){v.get(e).scale=Fc(a)}}},enumerable:!0});var u=isNaN(t.count)?this.config.count.default:t.count;Object.defineProperty(this,"count",{get:function(){return u},set:function(t){isNaN(t)||(u=t,M(),L())},enumerable:!0});var c=t.bounds;Object.defineProperty(this,"bounds",{get:function(){return c},set:function(t){t&&(c=t,M(),L())},enumerable:!0});var p=t.heightRange||this.config.heightRange.default;Object.defineProperty(this,"heightRange",{get:function(){return p},set:function(t){t&&(p=t,M(),L())},enumerable:!0});var f=t.color instanceof Sf3d.Color?t.color:this.config.color.default;Object.defineProperty(this,"color",{get:function(){return f},set:function(t){if(t instanceof Sf3d.Color){f=t;for(var e=0;e<v.length;e++)v.get(e).color=f.color}},enumerable:!0});var d=t.brightness||this.config.brightness.default;Object.defineProperty(this,"brightness",{get:function(){return d},set:function(t){if(!isNaN(t)&&d!=t){d=t;for(var e=0;e<v.length;e++)v.get(e).brightness=d}},enumerable:!0});var g=!0===t.moveEnabled||this.config.moveEnabled.default;Object.defineProperty(this,"moveEnabled",{get:function(){return g},set:function(t){g!=!!t&&(!0===(g=!!t)?(O(),R()):O())},enumerable:!0});var y=t.moveDirection||this.config.moveDirection.default;Object.defineProperty(this,"moveDirection",{get:function(){return y},set:function(t){t&&(y=t)},enumerable:!0});var m=isNaN(t.moveSpeed)?this.config.moveSpeed.default:t.moveSpeed;Object.defineProperty(this,"moveSpeed",{get:function(){return m},set:function(t){isNaN(t)||(m=t)},enumerable:!0});var _=t.sliceRange||[.3,.7],v=new Dc({noiseDetail:8});i.scene.primitives.add(v),window.cloudCollection=v;var x=[],C=[],w=[],b=void 0,I=void 0,P=[.2,f.a],N=[],S=void 0;function T(t){return t?t.bounds?null:"option.bounds 不能为空！":"option 不能为空！"}function L(){return new l.a((function(t,e){var n=null===r?Jl(c,u,p):r.points,o=(new Sf3d.Point3d).fromCartesian(i.camera.position);x=n,w=n.map((function(t){return t.clone()})),n.map((function(t){var e=Fc(a),n=nu({viewer:i,scale:e,cameraPosition:o,cloudPosition:t});v.add({position:t.exportCartesian(),scale:n,maximumSize:kc(),slice:Zl.apply(void 0,h()(_)),color:new Cesium.Color(f.r,f.g,f.b,iu({viewer:i,position:t,opacityRange:P,scale:n}))}),C.push(e)})),!0===g&&(O(),R()),I=i.camera.changed.addEventListener((function(){try{D()}catch(t){console.error(t)}})),t()}))}function M(){O(),I&&I(),I=null,v.removeAll(),w.splice(0,w.length),x.splice(0,x.length),C.splice(0,C.length),N.splice(0,N.length)}function O(){b&&b(),b=null}function R(){S=Kl(),N=new Array(v.length).fill(0),b=i.scene.postUpdate.addEventListener((function(t,e){try{A({secondsOfDay:Kl()})}catch(t){console.error(t)}}))}function A(e){var i=(e.secondsOfDay+86400-S)%86400;S=e.secondsOfDay;var r=i*m,o=eu({viewer:n.viewer,bounds:c,moveDirection:y,distanceMoved:r,originalPositions:x,currentPositions:w,dirtyStepCounters:N,updateOpacity:!0,opacityRange:P,updateScale:!0,originalScales:C,considerTerrain:!!t.considerTerrain});v._clouds.forEach((function(t,e){var n=o[e],i=n.position,r=n.scale,s=n.opacity;i&&(t.position=i.exportCartesian(),t.scale=r,w[e]=i),Math.abs(t.color.alpha-s)>.05&&(t.color=new Cesium.Color(t.color.red,t.color.green,t.color.blue,s))}))}function D(){if(!1===g){var t=(new Sf3d.Point3d).fromCartesian(i.camera.position);v._clouds.forEach((function(e,n){e.scale=nu({viewer:i,scale:C[n],cameraPosition:t,cloudPosition:w[n]})}))}}L(),this.destroy=function(){M(),i.scene.primitives.remove(v)}},Sf3d.CumulusClouds.prototype=new Sf3d.Element,r()(Sf3d.CumulusClouds.prototype,Sf3d.EventManager.prototype),Sf3d.CumulusClouds.prototype.type="CumulusClouds";var Bc="moveforward",Gc="movebackward",jc="moveleft",zc="moveright",Uc="rotateleft",qc="rotateright";function Vc(t,e){var n=e.moveForwardKey,i=(e.moveBackwardKey,e.moveLeftKey,e.moveRightKey,e.rotateLeftKey),r=e.rotateRightKey;switch(t){case n.charCodeAt(0):return Bc;case i.charCodeAt(0):return Uc;case r.charCodeAt(0):return qc;default:return}}function Hc(t){return t[Bc]}function Yc(t){return 1e3*t.viewer.clock.currentTime.secondsOfDay}function Xc(t){var e=t.gltfModel,n=t.modelAxisVectors,i=t.flags,r=t.distance,o=t.forwardAixs,s=t.leftAxis,a=t.heightOffset,l=t.objectsToExclude,c=void 0===l?[]:l;c.push(e.primitive);var h=e.position,p=(e.instance._primitive,Cesium.Cartesian3.fromDegrees(0,0,0).x),f=new Cesium.Cartesian3,d=new Cesium.Cartesian2,g=Wc(i,n,o,s),y=Cesium.Cartesian3.add(e.position.exportCartesian(),Cesium.Cartesian3.multiplyByScalar(g,1,f),f),m=(new u.a.Point3d).fromCartesian(y),_=new Cesium.Cartesian2(h.lng,h.lat),v=new Cesium.Cartesian2(m.lng,m.lat),x=Cesium.Cartesian2.normalize(Cesium.Cartesian2.subtract(v,_,d),d),C=Cesium.Math.toDegrees(r/p),w=Cesium.Cartesian2.add(_,Cesium.Cartesian2.multiplyByScalar(x,C,d),d),b=u.a.Util.sampleHeight({lng:w.x,lat:w.y,wholeScene:!0,objectsToExclude:c});e.position=(new u.a.Point3d).fromLngLat(w.x,w.y,b+a)}function Wc(t,e,n,i){return!0===t[Bc]?e[n]:!0===t[Gc]?Cesium.Cartesian3.negate(e[n],new Cesium.Cartesian3):!0===t[jc]?e[i]:!0===t[zc]?Cesium.Cartesian3.negate(e[i],new Cesium.Cartesian3):new Cartesian3(0,0,0)}function Kc(t){return t[Uc]||t[qc]}function Zc(t){var e=t.flags,n=t.angle,i=t.gltfModel;return!0===e[Uc]?i.heading-n:i.heading+n}function Jc(t,e){var n=e._model,i=e._option,r=n.instance._primitive.boundingSphere,o=n.position.clone();o.height+=r.radius;var s=t.camera.heading,a=t.camera.pitch,l=i.followDistance||10*n.instance._primitive.boundingSphere.radius;t.viewer.camera.lookAt(o.exportCartesian(),new Cesium.HeadingPitchRange(Cesium.Math.toRadians(s),Cesium.Math.toRadians(a),l))}function Qc(t,e){var n=e._model,i=e._option,r=n.position.clone(),o=n.getModelAxisInCartesian()[i.forwardAixs],s=new Cesium.Cartesian3;Cesium.Cartesian3.add(r.exportCartesian(),Cesium.Cartesian3.multiplyByScalar(o,10,s),s);var a=(new u.a.Point3d).fromCartesian(s);var l=new Cesium.Cartesian2(0,1),c=new Cesium.Cartesian2(a.lng-r.lng,a.lat-r.lat),h=Cesium.Cartesian2.angleBetween(l,c);c.x<0&&(h=2*Math.PI-h);var p=Cesium.Math.toDegrees(h),f=n.instance._primitive.boundingSphere;r.height+=f.radius;var d=isNaN(i.followPitch)?t.viewer.camera.pitch:i.followPitch,g=i.followDistance||10*n.instance._primitive.boundingSphere.radius;t.viewer.camera.lookAt(r.exportCartesian(),new Cesium.HeadingPitchRange(Cesium.Math.toRadians(p),Cesium.Math.toRadians(d),g))}u.a.RoleController=function(t){t=s()({moveForwardKey:"W",forwardAixs:"X",leftAxis:"Y",rotateLeftKey:"A",rotateRightKey:"D",follow:!0,followDistance:!1,followHeading:0,followPitch:-20},t||{}),u.a.Element.call(this,t.id);var e=this,n=this.map3d=E.apply(void 0,arguments)||_sf3d,i=e.viewer=n.viewer;this._option=t,this._model=void 0,this.config={enabled:{name:"是否激活",type:u.a.PropertyType.Boolean,default:!1},moveSpeed:{name:"移动速度",type:u.a.PropertyType.Float,default:3},rotateSpeed:{name:"旋转速度",type:u.a.PropertyType.Float,default:100}};var r=!!t.enabled;Object.defineProperty(this,"enabled",{get:function(){return r},set:function(t){r!==t&&(!0===(r=!!t)?p():f())}});var o=isNaN(t.moveSpeed)?this.config.moveSpeed.default:t.moveSpeed;Object.defineProperty(this,"moveSpeed",{get:function(){return o},set:function(t){o=t}});var a=isNaN(t.rotateSpeed)?this.config.rotateSpeed.default:t.rotateSpeed;Object.defineProperty(this,"rotateSpeed",{get:function(){return a},set:function(t){a=t}});var l={},c=Yc(n),h=Yc(n);function p(){document.addEventListener("keydown",d,!1),document.addEventListener("keyup",g,!1),i.clock.onTick.addEventListener(y),e._moving=!1,e._rotating=!1}function f(){document.removeEventListener("keydown",d,!1),document.removeEventListener("keyup",g,!1),i.clock.onTick.removeEventListener(y),this._clear()}function d(i){var r=Vc(i.keyCode,t);if(void 0!==r){l[r]=!0,c=Yc(n),h=Yc(n);var o={};o[r]=!0;var s=e._moving,a=e._rotating;Hc(o)&&!1===e._moving?e._moving=!0:Kc(o)&&!1===e._rotating&&(e._rotating=!0),(e._moving||e._rotating)&&!1===s&&!1===a&&e.emit({type:"onAnimationStart",data:{keyCode:i.keyCode,moving:e._moving,rotating:e._rotating}})}}function g(n){var i=Vc(n.keyCode,t);if(void 0!==i){l[i]=!1;var r={};r[i]=!0;var o=e._moving,s=e._rotating;Hc(r)&&!0===e._moving?e._moving=!1:Kc(r)&&!0===e._rotating&&(e._rotating=!1),e._moving||e._rotating||!o&&!s||e.emit({type:"onAnimationEnd",data:{keyCode:n.keyCode}})}}function y(){try{var r=Yc(n),s=void 0,u=e._model,p=!1,f=!1,d=a*(r-h)/1e3;Kc(l)&&d>=.001&&(u.heading=Zc({angle:d,flags:l,gltfModel:u}),h=r,f=!0);var g=o*(r-c)/1e3;Hc(l)&&g>=.01&&(s=u.getModelAxisInCartesian(),Xc({viewer:i,gltfModel:u,flags:l,distance:g,objectsToExclude:t.objectsToExclude,forwardAixs:t.forwardAixs,leftAxis:t.leftAxis,modelAxisVectors:s,heightOffset:e._heightOffset}),c=r,p=!0),t.follow&&(f||p)&&(e._lockForward?Qc(n,e):Jc(n,e))}catch(t){console.error(t)}}e._moving=!1,e._rotating=!1,e._lockForward=!1,e._heightOffset=0,this._clear=function(){for(var t in l)delete l[t];e._moving=!1,e._rotateSpeed=!1,e._heightOffset=0,n.viewer.scene.camera.lookAtTransform(Cesium.Matrix4.IDENTITY)}},u.a.RoleController.prototype=new u.a.Element,u.a.RoleController.prototype.type="RoleController",u.a.RoleController.prototype.bindModel=function(t,e){this._model=t,e&&null!=e.heightOffset&&(this._heightOffset=e.heightOffset)},u.a.RoleController.prototype.unbindModel=function(t){this._model===t&&(this._model=void 0,this._clear())},u.a.RoleController.prototype.lockForward=function(){this._lockForward=!0,Qc(this.map3d,this)},u.a.RoleController.prototype.unlockForward=function(){this._lockForward=!1},u.a.RoleController.prototype.destroy=function(){this.map3d=null,this._model&&(this._model=void 0,this._clear()),u.a.Element.prototype.destroy.call(this)},r()(u.a.RoleController.prototype,u.a.EventManager.prototype);u.a.RoleController;function $c(t){t=t||{},this._definitionChanged=new Cesium.Event,this.speed=isNaN(t.speed)?.5:t.speed,this.alpha=isNaN(t.alpha)?.5:t.alpha}j()($c.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}}}),$c.prototype.getType=function(t){return Cesium.Material.PolygonFlashMaterialType},$c.prototype.getValue=function(t,e){return Cesium.defined(e)||(e={}),e.alpha=this.alpha,e.speed=this.speed,e},$c.prototype.equals=function(t){return this===t||t instanceof $c&&this.speed==t.speed&&this.alpha==t.alpha},Cesium.Material.PolygonFlashMaterialType="PolygonFlashMaterial",Cesium.Material.PolygonFlashSource="\nvec4 permute(vec4 x){\n    return mod(((x*34.0)+1.0)*x, 289.0);\n}\nvec4 taylorInvSqrt(vec4 r){\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v){ \nconst vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\nconst vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n\nvec3 i  = floor(v + dot(v, C.yyy) );\nvec3 x0 =   v - i + dot(i, C.xxx) ;\n\n\nvec3 g = step(x0.yzx, x0.xyz);\nvec3 l = 1.0 - g;\nvec3 i1 = min( g.xyz, l.zxy );\nvec3 i2 = max( g.xyz, l.zxy );\n\n\nvec3 x1 = x0 - i1 + 1.0 * C.xxx;\nvec3 x2 = x0 - i2 + 2.0 * C.xxx;\nvec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\n\ni = mod(i, 289.0 ); \nvec4 p = permute( permute( permute( \n     i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\nfloat n_ = 1.0/7.0; \nvec3  ns = n_ * D.wyz - D.xzx;\n\nvec4 j = p - 49.0 * floor(p * ns.z *ns.z); \n\nvec4 x_ = floor(j * ns.z);\nvec4 y_ = floor(j - 7.0 * x_ );   \n\nvec4 x = x_ *ns.x + ns.yyyy;\nvec4 y = y_ *ns.x + ns.yyyy;\nvec4 h = 1.0 - abs(x) - abs(y);\n\nvec4 b0 = vec4( x.xy, y.xy );\nvec4 b1 = vec4( x.zw, y.zw );\n\nvec4 s0 = floor(b0)*2.0 + 1.0;\nvec4 s1 = floor(b1)*2.0 + 1.0;\nvec4 sh = -step(h, vec4(0.0));\n\nvec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\nvec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\nvec3 p0 = vec3(a0.xy,h.x);\nvec3 p1 = vec3(a0.zw,h.y);\nvec3 p2 = vec3(a1.xy,h.z);\nvec3 p3 = vec3(a1.zw,h.w);\n\n\nvec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\np0 *= norm.x;\np1 *= norm.y;\np2 *= norm.z;\np3 *= norm.w;\n\nvec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\nm = m * m;\nreturn 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) );\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n    vec4 colorImage;\n\n    vec2 uv = st;\n    float scale = .2;\n    float rate = 5.0;\n    \n    float t = czm_frameNumber/100.0/rate*speed;\n    \n    float result = 0.0;\n    for (float i = 0.0; i < 5.0; i++){\n        result += snoise(vec3((uv.x*2.0)/scale, (uv.y)/scale, t*2.0))/pow(2.0, i);\n        scale /= 2.0;\n    }\n    result = (result + 1.0)/4.0;\n    result += .5;\n    \n    result = pow(result, 2.0);\n    float g = pow(result, 4.0);\n    colorImage = vec4(0, g, result, 1.0);\n\n    material.alpha = alpha;\n    material.diffuse = colorImage.rgb;\n    return material;\n\n}",Cesium.Material._materialCache.addMaterial(Cesium.Material.PolygonFlashMaterialType,{fabric:{type:Cesium.Material.PolygonFlashMaterialType,uniforms:{speed:10,alpha:.5},source:Cesium.Material.PolygonFlashSource},translucent:function(t){return!0}}),Cesium.PolygonFlashMaterialProperty=$c;function th(t){t=t||{},this._definitionChanged=new Cesium.Event,this.color=t.color instanceof Cesium.Color?t.color:Cesium.Color.WHITE,this.speed=isNaN(t.speed)?1:t.speed,this.alpha=isNaN(t.alpha)?1:t.alpha,this.lineWidth=isNaN(t.lineWidth)?.01:t.lineWidth}j()(th.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color")}),th.prototype.getType=function(t){return Cesium.Material.PolygonGridMaterialType},th.prototype.getValue=function(t,e){return Cesium.defined(e)||(e={color:this.color,speed:this.speed,alpha:this.alpha,lineWidth:this.lineWidth}),e},th.prototype.equals=function(t){return this===t||t instanceof th&&Cesium.Property.equals(this.color,t.color)&&this.speed==t.speed&&this.speed==t.alpha&&this.lineWidth==t.lineWidth},Cesium.Material.PolygonGridMaterialType="PolygonGridMaterial",Cesium.Material.PolygonGridSource="\n float iTime=czm_frameNumber/50.0;\nvec2 rand2(in vec2 p)\n{\n\treturn fract(vec2(sin(p.x * 591.32 + p.y * 154.077), cos(p.x * 391.32 + p.y * 49.077)));\n}\n\nfloat voronoi(in vec2 x)\n{\n\tvec2 p = floor(x);\n\tvec2 f = fract(x);\n\tfloat minDistance = 1.;\n    \n\tfor(int j = -1; j <= 1; j ++)\n\t{\n\t\tfor(int i = -1; i <= 1; i ++)\n\t\t{\n\t\t\tvec2 b = vec2(i, j);\n            vec2 rand = .5 + .5 * sin(iTime*speed  + 12. * rand2(p + b));\n\t\t\tvec2 r = vec2(b) - f + rand;\n\t\t\tminDistance = min(minDistance, length(r));\n\t\t}\n\t}\n\treturn minDistance;\n}\n\n\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 uv = materialInput.st;\n\n    vec4 colorImage;\n   float val = pow(voronoi(uv * 8.) * 1.25, 7.) * 2.;\n   vec2 grid = step(mod(uv, .1), vec2(lineWidth));    \n\n   colorImage += val * (grid.x + grid.y)*color;\n\n    material.diffuse = colorImage.rgb;\n    material.alpha=alpha;\n    return material;\n\n}",Cesium.Material._materialCache.addMaterial(Cesium.Material.PolygonGridMaterialType,{fabric:{type:Cesium.Material.PolygonGridMaterialType,uniforms:{speed:1,color:Cesium.Color.WHITE,alpha:.5,lineWidth:.01},source:Cesium.Material.PolygonGridSource},translucent:function(t){return!0}}),Cesium.PolygonGridMaterialProperty=th;function eh(t){t=t||{},this._definitionChanged=new Cesium.Event,this._color=void 0,this._colorSubscription=void 0,this.color=t.color,this.duration=Cesium.defaultValue(t.duration,1e3),this.count=Cesium.defaultValue(t.count,2),this.count<=0&&(this.count=1),this.gradient=Cesium.defaultValue(t.gradient,.1),this.gradient<0?this.gradient=0:this.gradient>1&&(this.gradient=1),this._time=performance.now()}j()(eh.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color")}),eh.prototype.getType=function(t){return Cesium.Material.CircleWaveMaterialType},eh.prototype.getValue=function(t,e){return Cesium.defined(e)||(e={}),e.color=Cesium.Property.getValueOrClonedDefault(this._color,t,Cesium.Color.WHITE,e.color),e.time=(performance.now()-this._time)/this.duration,e.count=this.count,e.gradient=1+10*(1-this.gradient),e},eh.prototype.equals=function(t){return this===t||t instanceof eh&&Cesium.Property.equals(this.color,t.color)&&this.count==t.count&&this.gradient==t.gradient&&this.duration==t.duration},Cesium.Material.CircleWaveMaterialType="CircleWaveMaterial",Cesium.Material.CircleWaveSource="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material=czm_getDefaultMaterial(materialInput);\nmaterial.diffuse=1.5*color.rgb;\nvec2 st=materialInput.st;\nvec3 str=materialInput.str;\nfloat dis=distance(st,vec2(0.5,0.5));\nfloat per=fract(time);\nif(abs(str.z)>0.001){\ndiscard;\n}\nif(dis>0.5){\ndiscard;\n}else{\nfloat perDis=0.5/count;\nfloat disNum;\nfloat bl=.0;\nfor(int i=0;i<=999;i++){\nif(float(i)<=count){\ndisNum=perDis*float(i)-dis+per/count;\nif(disNum>0.0){\nif(disNum<perDis){\nbl=1.0-disNum/perDis;\n}\nelse if(disNum-perDis<perDis){\nbl=1.0-abs(1.0-disNum/perDis);\n}\nmaterial.alpha=pow(bl,gradient);\n}\n}\n}\n}\nreturn material;\n}",Cesium.Material._materialCache.addMaterial(Cesium.Material.CircleWaveMaterialType,{fabric:{type:Cesium.Material.CircleWaveMaterialType,uniforms:{color:new Cesium.Color(1,1,1,1),time:1,count:1,gradient:.1},source:Cesium.Material.CircleWaveSource},translucent:function(t){return!0}}),Cesium.CircleWaveMaterialProperty=eh;function nh(t){t=t||{},this._definitionChanged=new Cesium.Event,this._color=void 0,this._colorSubscription=void 0,this.color=t.color,this.duration=isNaN(t.duration)?1:t.duration,this._time=performance.now(),this.repeat=isNaN(t.repeat)?1:t.repeat,this.cw=!1!==t.cw,this.image=t.image,this.horizontal=!1!==t.horizontal,this.timeOffset=isNaN(t.timeOffset)?0:t.timeOffset}j()(nh.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color")}),nh.prototype.getType=function(t){return Cesium.Material.PolylineTrailLinkType},nh.prototype.getValue=function(t,e){return Cesium.defined(e)||(e={}),e.color=Cesium.Property.getValueOrClonedDefault(this._color,t,Cesium.Color.WHITE,e.color),e.image=this.image,e.repeat=this.repeat,e.speed=5e3/this.duration,e.cw=this.cw,e.horizontal=this.horizontal,e.timeOffset=this.timeOffset,e},nh.prototype.equals=function(t){return this===t||t instanceof nh&&Cesium.Property.equals(this.color,t.color)&&this.image==t.image&&this.repeat==t.repeat&&this.speed==t.speed&&this.cw==t.cw&&this.horizontal==t.horizontal&&this.timeOffset==t.timeOffset},Cesium.Material.PolylineTrailLinkType="PolylineTrailLink",Cesium.Material.PolylineTrailLinkImage=u.a.RelativePath+"/assets/flowline.png",Cesium.Material.PolylineTrailLinkSource="czm_material czm_getMaterial(czm_materialInput materialInput)\n\n{\n    float newTime=czm_frameNumber/1000.0*speed+timeOffset;\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n    vec4 colorImage;\n\n    if(horizontal){\n        float v=fract((cw?(st.s - newTime):(st.s+newTime))*repeat);\n\n     colorImage = texture2D(image, vec2(v, st.t)); \n    }else{\n        float v=fract((cw?(st.t - newTime):(st.t+newTime))*repeat);\n\n        colorImage = texture2D(image, vec2(st.s, v)); \n    }\n\n    material.alpha = colorImage.a * color.a;\n\n    material.diffuse = (colorImage.rgb + color.rgb) / 2.0; \n\n    return material;\n\n}",Cesium.Material._materialCache.addMaterial(Cesium.Material.PolylineTrailLinkType,{fabric:{type:Cesium.Material.PolylineTrailLinkType,uniforms:{color:new Cesium.Color(1,1,1,1),image:Cesium.Material.PolylineTrailLinkImage,repeat:1,cw:!0,horizontal:!0,speed:1,timeOffset:0},source:Cesium.Material.PolylineTrailLinkSource},translucent:function(t){return!0}}),Cesium.PolylineTrailLinkMaterialProperty=nh;function ih(t){t=t||{},this._definitionChanged=new Cesium.Event,this._color=void 0,this._colorSubscription=void 0,this.color=t.color instanceof Cesium.Color?t.color:Cesium.Color.RED,this.alphaPower=isNaN(t.alphaPower)?2:t.alphaPower,this._time=performance.now(),this.intense=isNaN(t.intense)?1:t.intense}j()(ih.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color")}),ih.prototype.getType=function(t){return Cesium.Material.PolylineFlashType},ih.prototype.getValue=function(t,e){return Cesium.defined(e)||(e={}),e.color=Cesium.Property.getValueOrClonedDefault(this._color,t,Cesium.Color.WHITE,e.color),e.time=performance.now(),e.alphaPower=this.alphaPower,e.intense=this.intense,e},ih.prototype.equals=function(t){return this===t||t instanceof ih&&Cesium.Property.equals(this.color,t.color)&&this.intense==t.intense&&this.alphaPower==t.alphaPower},Cesium.Material.PolylineFlashType="PolylineFlash",Cesium.Material.PolylineFlashSource="\nvec3 random3(vec3 c) {\n\tfloat j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n\tvec3 r;\n\tr.z = fract(512.0*j);\n\tj *= .125;\n\tr.x = fract(512.0*j);\n\tj *= .125;\n\tr.y = fract(512.0*j);\n\treturn r-0.5;\n}\n\n/* skew constants for 3d simplex functions */\nconst float F3 =  0.3333333;\nconst float G3 =  0.1666667;\n\n/* 3d simplex noise */\nfloat simplex3d(vec3 p) {\n\t /* 1. find current tetrahedron T and it's four vertices */\n\t /* s, s+i1, s+i2, s+1.0 - absolute skewed (integer) coordinates of T vertices */\n\t /* x, x1, x2, x3 - unskewed coordinates of p relative to each of T vertices*/\n\t \n\t /* calculate s and x */\n\t vec3 s = floor(p + dot(p, vec3(F3)));\n\t vec3 x = p - s + dot(s, vec3(G3));\n\t \n\t /* calculate i1 and i2 */\n\t vec3 e = step(vec3(0.0), x - x.yzx);\n\t vec3 i1 = e*(1.0 - e.zxy);\n\t vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t \t\n\t /* x1, x2, x3 */\n\t vec3 x1 = x - i1 + G3;\n\t vec3 x2 = x - i2 + 2.0*G3;\n\t vec3 x3 = x - 1.0 + 3.0*G3;\n\t \n\t /* 2. find four surflets and store them in d */\n\t vec4 w, d;\n\t \n\t /* calculate surflet weights */\n\t w.x = dot(x, x);\n\t w.y = dot(x1, x1);\n\t w.z = dot(x2, x2);\n\t w.w = dot(x3, x3);\n\t \n\t /* w fades from 0.6 at the center of the surflet to 0.0 at the margin */\n\t w = max(0.6 - w, 0.0);\n\t \n\t /* calculate surflet components */\n\t d.x = dot(random3(s), x);\n\t d.y = dot(random3(s + i1), x1);\n\t d.z = dot(random3(s + i2), x2);\n\t d.w = dot(random3(s + 1.0), x3);\n\t \n\t /* multiply d by w^4 */\n\t w *= w;\n\t w *= w;\n\t d *= w;\n\t \n\t /* 3. return the sum of the four surflets */\n\t return dot(d, vec4(52.0));\n}\n\nfloat noise(vec3 m) {\n    return   0.5333333*simplex3d(m)\n\t\t\t+0.2666667*simplex3d(2.0*m)\n\t\t\t+0.1333333*simplex3d(4.0*m)\n\t\t\t+0.0666667*simplex3d(8.0*m);\n}\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nuniform vec4 color;\nuniform float intense;\nuniform float alphaPower;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n\n{\n   \n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st;\n    vec2 uv=st;\n\n    uv = uv * 2. -1.;  \n \n  vec2 p = gl_FragCoord.xy/500.0;\n  vec3 p3 = vec3(p, time*0.4);    \n    \n  float intensity = noise(vec3(p3*12.0+12.0));\n                          \n  float t = clamp((uv.x * -uv.x * 0.16) + 0.15, 0., 1.);                         \n  float y = abs(intensity * -t + uv.y/5.);\n    \n  float g = pow(y, 0.2);\n                          \n  vec3 col = color.rgb*intense;\n  col = col * -g + col;                    \n  col = col * col;\n  col = col * col;\n  float v=rgb2hsv(col).z;\n//   material.alpha = pow(v,alphaPower); \n  material.diffuse = col;    \n  return material;\n\n\n}",Cesium.Material._materialCache.addMaterial(Cesium.Material.PolylineFlashType,{fabric:{type:Cesium.Material.PolylineFlashType,uniforms:{time:0,color:Cesium.Color.RED,intense:2,alphaPower:2},source:Cesium.Material.PolylineFlashSource},translucent:function(t){return!0}}),Cesium.PolylineFlashMaterialProperty=ih;function rh(t){t=t||{},this._definitionChanged=new Cesium.Event,this._color=void 0,this._colorSubscription=void 0,this.color=t.color instanceof Cesium.Color?t.color:Cesium.Color.RED,this.alphaPower=isNaN(t.alphaPower)?2:t.alphaPower,this._time=performance.now(),this.intense=isNaN(t.intense)?1:t.intense,this.image=t.image}j()(rh.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color")}),rh.prototype.getType=function(t){return Cesium.Material.PolylineFireType},rh.prototype.getValue=function(t,e){return Cesium.defined(e)||(e={}),e.color=Cesium.Property.getValueOrClonedDefault(this._color,t,Cesium.Color.WHITE,e.color),e.time=performance.now(),e.alphaPower=this.alphaPower,e.image=this.image,e.intense=this.intense,e},rh.prototype.equals=function(t){return this===t||t instanceof rh&&Cesium.Property.equals(this.color,t.color)&&this.intense==t.intense&&this.alphaPower==t.alphaPower},Cesium.Material.PolylineFireType="PolylineFire",Cesium.Material.PolylineFireSource="\n#define S(v) smoothstep(pixels,0.,v)\n#define transition 0.5\n#define rot(a) mat2(C=cos(a),S=-sin(a),-S,C)\n#define rand(co) fract(sin(mod(dot(co ,vec2(12.9898,78.233)),3.14))*43758.5453)\n#define f(uv) texture2D(image,uv)\nconst highp float pi = 3.141592653589793;\nuniform vec4 color;\nuniform float alphaPower;\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n\n{\n    vec2 u=gl_FragCoord.xy;\n    vec2 iResolution=czm_viewport.zw;\n    float iTime=czm_frameNumber;\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 uv = (2.*u-iResolution.xy)/iResolution.y;\n  \n    if(uv.y<0.){\n\t\tuv.y+=iTime/2./iResolution.x*512.;\n    }else{\n\t\tuv.y-=iTime/2./iResolution.x*512.;\n\t}\n \t\n    float C,S,dist = length(2.*fract(uv)-1.), \n          r = rand(floor(uv));\n\t\n    //  vec2 uv2=u/iResolution.xy*2.-1.;\n    vec2 uv2=materialInput.st*2.-1.;\n     uv2.x*=iResolution.x/iResolution.y;\n    \n    uv2*=mix(f((uv+r) * rot(pi*r*2.)), \n            f(uv * rot(pi-1.)), \n            smoothstep(1.-transition,.93, dist)).rg/2.;\n\n    \n    float pixels=2./iResolution.y;\n    \n    \n\n\n    material.diffuse+=color.rgb*S(abs(uv2.y));\n    float v=rgb2hsv(color.rgb).z;\n    material.alpha=pow(v,alphaPower);\n    return material;\n\n\n}",Cesium.Material._materialCache.addMaterial(Cesium.Material.PolylineFireType,{fabric:{type:Cesium.Material.PolylineFireType,uniforms:{time:0,color:Cesium.Color.RED,intense:2,alphaPower:2,image:u.a.RelativePath+"/assets/noise.jpg"},source:Cesium.Material.PolylineFireSource},translucent:function(t){return!0}}),Cesium.PolylineFireMaterialProperty=rh;function oh(t){t=t||{},this._definitionChanged=new Cesium.Event,this._duration=t.duration||1e3,this._texture=t.texture,this._fadeOpacity=t.fadeOpacity>=0?t.fadeOpacity:.15,this._time=void 0,this._showState=void 0,this.showState=0,this._progress=0}j()(oh.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},texture:{get:function(){return this._texture},set:function(t){this._texture=t}},showState:{get:function(){return this._showState},set:function(t){this._showState=t,this._time=performance.now()}},duration:{get:function(){return this._duration},set:function(t){this._duration=t}}}),oh.prototype.getType=function(t){return Cesium.Material.PlaneMaterialPropertyType},oh.prototype.getValue=function(t,e){return Cesium.defined(e)||(e={}),e.texture=this._texture||"",e.progress=0===this._duration?1:(performance.now()-this._time)/this._duration,e.showState=this._showState,e.fadeOpacity=this._fadeOpacity,this._progress=e.progress,e},oh.prototype.equals=function(t){return this===t||t instanceof oh&&this._texture===t._texture&&this._showState===t._showState&&this._duration==t._duration&&this._fadeOpacity===t._fadeOpacity},Cesium.Material.PlaneMaterialPropertyType="PlaneMaterialProperty",Cesium.Material.PlaneMaterialSource="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material=czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st;\n    vec4 colorImage = texture2D(texture, vec2(st.s, st.t)); \n    // material.diffuse = colorImage.rgb;\n    material.emission = colorImage.rgb;\n    // slide\n    // if (showState !=0.0 && progress < 1.0) {\n    //     float progressRuntime = sin(1.5707963 * mod(1.0 + progress*showState, 1.0));\n    //     float sliderDistance = abs(st.t - progressRuntime);\n    //     if (sliderDistance < sliderThickness) {\n    //         float ratio =  0.3*(1.0 - sliderDistance/sliderThickness) + 0.7;\n    //         material.diffuse = sliderColor.rgb;\n    //         material.alpha = max(ratio, fadeOpacity);\n    //     } else if(st.t > progressRuntime) {\n    //         material.alpha = (1.0 - st.t)/2.0;\n    //     }\n    // } else if (showState == -1.0) {\n    //     material.alpha = fadeOpacity;\n    // }\n    // blink\n    if (colorImage.a > 0.0) {\n        if (showState !=0.0 && progress < 1.0) {\n            float progressRuntime = 0.0;\n            if (showState < 0.0) {\n                progressRuntime = cos(1.5707963 * progress);\n            } else {\n                progressRuntime = sin(1.5707963 * progress);\n            }\n            material.alpha = progressRuntime;\n        } else if (showState == -1.0) {\n            material.alpha = fadeOpacity;\n        }\n        material.alpha *= colorImage.a;\n    } else {\n        material.alpha = 0.0;\n    }\n    return material;\n}",Cesium.Material._materialCache.addMaterial(Cesium.Material.PlaneMaterialPropertyType,{fabric:{type:Cesium.Material.PlaneMaterialPropertyType,uniforms:{showState:0,progress:0,texture:"",sliderColor:new Cesium.Color(1,1,1,1),sliderThickness:.003,fadeOpacity:.2},source:Cesium.Material.PlaneMaterialSource},translucent:function(t){return!0}}),Cesium.PlaneMaterialProperty=oh;function sh(t){t=t||{},this._definitionChanged=new Cesium.Event,this.color=t.color||new Cesium.Color(1,0,1,1),this.gapColor=t.gapColor||new Cesium.Color(1,1,1,0),this.dashLength=t.dashLength||16,this.dashPattern=t.dashPattern||255,this.dashStartPosition=t.dashStartPosition||0,this.startColor=t.startColor||new Cesium.Color(1,0,1,1),this.endColor=t.endColor||new Cesium.Color(1,0,1,0),this._showState=0}j()(sh.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},showState:{get:function(){return this._showState},set:function(t){this._showState=t}}}),sh.prototype.getType=function(t){return Cesium.Material.PolylineGradientMaterialPropertyType},sh.prototype.getValue=function(t,e){return Cesium.defined(e)||(e={}),e.color=this.color,e.gapColor=this.gapColor,e.dashLength=this.dashLength,e.dashPattern=this.dashPattern,e.dashStartPosition=this.dashStartPosition,e.startColor=this.startColor,e.endColor=this.endColor,e.showState=this._showState,e},sh.prototype.equals=function(t){return this===t},Cesium.Material.PolylineGradientMaterialPropertyType="PolylineGradientMaterial",Cesium.Material.PolylineGradientMaterialSource="\n    uniform vec4 color;\n    uniform vec4 gapColor;\n    uniform float dashLength;\n    uniform float dashPattern;\n    varying float v_polylineAngle;\n\n    const float maskLength = 16.0;\n\n    mat2 rotate(float rad) {\n        float c = cos(rad);\n        float s = sin(rad);\n        return mat2(\n            c, s,\n            -s, c\n        );\n    }\n\n    czm_material czm_getMaterial(czm_materialInput materialInput)\n    {\n        czm_material material = czm_getDefaultMaterial(materialInput);\n        vec2 st = materialInput.st;\n        if (showState < 0.0) {\n            material.alpha = 0.0;\n        } else {\n            // 使用余弦函数\n            float blendAlpha = cos(st.s*1.570796)*(startColor.a - endColor.a) + endColor.a;\n            if (st.s < dashStartPosition) {// 实线部分\n                material.alpha = color.a * blendAlpha;\n                material.diffuse = color.rgb;\n            } else {// 虚线部分\n                vec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\n                // Get the relative position within the dash from 0 to 1\n                float dashPosition = fract(pos.x / (dashLength * czm_pixelRatio));\n                // Figure out the mask index.\n                float maskIndex = floor(dashPosition * maskLength);\n                // Test the bit mask.\n                float maskTest = floor(dashPattern / pow(2.0, maskIndex));\n                vec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;\n                if (fragColor.a < 0.005) {   // matches 0/255 and 1/255\n                    discard;\n                }\n                fragColor = czm_gammaCorrect(fragColor);\n                material.emission = fragColor.rgb;\n                material.alpha = fragColor.a * blendAlpha;\n            }\n        }\n        return material;\n    }\n",Cesium.Material._materialCache.addMaterial(Cesium.Material.PolylineGradientMaterialPropertyType,{fabric:{type:Cesium.Material.PolylineGradientMaterialPropertyType,uniforms:{color:new Cesium.Color(1,0,1,1),gapColor:new Cesium.Color(1,0,1,0),startColor:new Cesium.Color(1,0,1,1),endColor:new Cesium.Color(1,0,1,0),dashLength:16,dashPattern:255,dashStartPosition:.5,showState:0},source:Cesium.Material.PolylineGradientMaterialSource},translucent:function(t){return!0}}),Cesium.PolylineGradientMaterialProperty=sh;function ah(t){t=t||{},this._definitionChanged=new Cesium.Event}j()(ah.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}}}),ah.prototype.getType=function(t){return Cesium.Material.StrokedWallMaterialType},ah.prototype.getValue=function(t,e){return Cesium.defined(e)||(e={}),e},ah.prototype.equals=function(t){return this===t||t instanceof ah&&this.speed==t.speed&&this.alpha==t.alpha},Cesium.Material.StrokedWallMaterialType="StrokedWall",Cesium.Material.StrokedWallSource="\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st;\n    vec4 colorImage = vec4(1.0);\n\n    material.alpha = colorImage.a;\n    material.diffuse = colorImage.rgb;\n    if (st.t > 0.99 || st.t<0.01) {\n        material.alpha = 1.0;\n        material.emission = vec3(0.5);\n    }\n    return material;\n\n}",Cesium.Material._materialCache.addMaterial(Cesium.Material.StrokedWallMaterialType,{fabric:{type:Cesium.Material.StrokedWallMaterialType,uniforms:{},source:Cesium.Material.StrokedWallSource},translucent:function(t){return!0}}),Cesium.StrokedWallMaterialProperty=ah;var lh=window.Sf3d,uh=window.SFMap;function ch(){return window.Sf3d=lh,window.SFMap=uh,this}window.Sf3d=Gs,window.SFMap||(window.SFMap=Gs)}]);
//# sourceMappingURL=sfmap.core.min.js.map